{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.37687955827467023, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0001, "total_loss": 6.537378220331101, "policy_loss": -0.003307020047029096, "vf_loss": 6.540290604697334, "vf_explained_var": 0.009445910983615451, "kl": 0.0019732116566350062, "entropy": 1.608212012904031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7631290830790051, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 0.0001, "total_loss": 8.348475668165419, "policy_loss": -0.004848466678300784, "vf_loss": 8.352742702241928, "vf_explained_var": 0.0024501424933236742, "kl": 0.002907465989257963, "entropy": 1.6074887744964115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 241.554199344885, "num_env_steps_trained_throughput_per_sec": 241.554199344885, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 33118.871, "restore_workers_time_ms": 0.017, "training_step_time_ms": 33118.734, "sample_time_ms": 1334.415, "learn_time_ms": 31742.2, "learn_throughput": 252.03, "synch_weights_time_ms": 34.135}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 1, "trial_id": "cdf01_00000", "date": "2024-08-20_10-21-46", "timestamp": 1724129506, "time_this_iter_s": 33.15145516395569, "time_total_s": 33.15145516395569, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e65e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 33.15145516395569, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 76.62083333333334, "ram_util_percent": 79.35625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.105080421529119, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.0001, "total_loss": 4.945610259071229, "policy_loss": -0.007187848353374099, "vf_loss": 4.952458262821985, "vf_explained_var": 0.057660918008713494, "kl": 0.003398366315855929, "entropy": 1.603476909985618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.404087863696946, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 0.0001, "total_loss": 7.21705994076199, "policy_loss": -0.008693791653901812, "vf_loss": 7.22539462891836, "vf_explained_var": 0.016400100030596294, "kl": 0.0035911033736117553, "entropy": 1.5990197951831515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 252.03107798469395, "episode_reward_min": -27.959737974083225, "episode_reward_mean": 91.72075344279415, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -489.19743397012223, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.45233748212124, "predator_policy": 566.3645782105427}, "policy_reward_mean": {"prey_policy": -93.23586367641578, "predator_policy": 139.09624039781283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0000000000002, 55.40000000000024, 119.19786691046795, 38.10000000000027, 188.09999999999923, 174.38025217378654, 99.16389181710234, 92.69999999999885, 70.19999999999999, 80.99999999999987, 50.3000000000003, 21.357036005680627, 23.900000000000055, 206.19999999999948, 25.800000000000093, 197.892260381018, 38.900000000000176, 85.4349168958534, 115.99999999999977, 146.69999999999936, 36.90000000000004, 93.89600087839358, 153.29999999999936, 103.99999999999982, 69.75534867483651, 101.29999999999964, 84.2999999999993, 121.00000000000017, 69.42758678609306, 252.03107798469395, 86.52072716119497, 41.300000000000175, 119.89653537561856, 48.01995145398333, 161.59578845909098, 23.065668713635773, -19.06901841607342, 114.27014949576687, 119.00000000000007, 94.10000000000008, 71.42240878723999, 33.35315274304848, 245.49847468825905, -27.959737974083225, 211.69999999999985, 131.5335760819267, 30.13738685850244, 53.821098674330514, 69.19999999999983, 36.40000000000025, 63.10000000000042, 113.79824931160374, 53.03353568062192, 64.01597338221973, 148.53988111274305, 126.46732969375107, 175.3999999999996, 48.31558704412775, -27.18288116180164, 33.0000000000002, 39.80000000000031, 76.69999999999985, 89.99924943419265, 178.34502591678353, 219.79999999999964, 86.56333348717018, 212.99999999999983, 45.25071542651111, 70.17290440542415, 89.4329435374679, 43.40000000000027, 27.500000000000128], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.217670113124424, -101.63362411446255, -27.056201350814213, -235.7016768610366, -90.66473322378305, -142.19856625835067, -173.25330989146502, 13.42429098463748, 24.375140023154472, 130.64856243283012, -32.77204251016291, 1.986176784567244, -3.7314530519042575, 24.433965035269008, -22.71023804334926, -32.150680471080754, -324.47158613647173, -138.00069747742415, -62.91280605457016, 45.40947288794522, -274.13193379391623, 45.200000000000244, -324.6673781216329, -80.53508148605817, -93.23171220783819, -145.24987352504547, 180.45233748212124, -157.64209289579938, -218.63446981774425, -118.0282138860831, -261.0087071734464, 67.05540647338748, -124.5619840712312, 0.3084093641973031, -139.9808239998098, -48.41274504027255, -86.80222053290913, -51.19669885996537, -150.11132021804056, 93.28629277709936, -139.44491427689317, -157.67680519334203, -60.97618842085951, -257.81523670450497, -232.49205895289282, 135.4072433935896, -217.99800479835076, 42.82997993498125, 11.567122506835524, -188.44006802067003, -79.17327946538035, -27.370022346193533, -43.01250419565031, -141.08325326242314, 6.3281251110865355, -179.29868784511694, -254.53942080125466, -178.43178460529035, 0.6748307621040581, -126.24861927528059, -45.79684304466651, -73.6891293834952, -54.22703792121494, -5.1391285432227125, 9.899325704927344, -105.54833390151393, -3.4901715146390595, -87.07846141000033, -39.42917953391522, -71.87591237762075, -128.43586128790105, -117.74204740276761, -59.68098595385791, -221.3522158578936, -364.3630626815311, 52.08011578646283, 27.95462525638187, -74.1422298916205, -38.51441885337797, -21.790464615190118, 30.27615225194002, -224.53810400828226, -101.4013663946606, -40.046403071660926, -269.87928660906084, 103.01832586086078, -227.1656502274477, -372.87106174826584, 103.67691449222156, -249.17635136793825, -243.0932681430055, -31.778916777165406, -269.59251644398, -155.9837727625883, -118.3124011694789, -139.1893228781658, 45.10385100205177, -405.6995569882395, 20.000000000000014, -52.61886859020731, -84.96873234880809, 16.00968559014073, -79.00051448793029, -301.7858548932153, -232.11831783602256, -147.12347238936542, -489.19743397012223, -7.271100597989779, -13.706386668844418, 14.007706409804149, -208.37838161431992, -13.06943053196106, -178.2173334629611, 143.94327567088092, -275.1606751711249, -62.81547915497145, -288.18424555855466, -346.2728370984213, -84.04038236542507, 17.30559949212078, 6.359000548749567, -83.5280823025171, -40.14684383725284, -177.15223288714566, -37.04757439967248, -214.8372230412897, 64.85498245727503, 3.0970137194107967, -1.4188396954218083, 93.46696403934459, -12.187045144674412, -245.89408480790712, 66.17790045893133, 80.1283113097754, -139.87176870439856, -190.95410326934436, 33.84764837919051, -115.05895428943278, -96.25930577203451, -22.679435085797444, -297.7033974587581, -14.711432062727168, -184.90655256824076, -156.01328983127343], "policy_predator_policy_reward": [137.76947884355405, 8.646475157783946, 47.45620135081446, 270.70167686103656, 150.81661538131442, 201.24455101128694, 183.85330989146476, 14.075709015362492, 17.616454187771392, 15.459843356244077, 79.7547705346079, 125.4113473647747, 32.87201635165305, 45.58936348208544, 54.310238043349486, 93.25068047108091, 333.77158613647225, 198.90069747742385, 93.06445648401898, 5.438876682605255, 279.23193379391637, 0.0, 181.57426519690574, 244.98523041646527, 107.63171220783761, 154.74987352504527, 162.2896392960461, 21.100116117631224, 230.43446981774363, 132.02821388608254, 228.2772168449903, 163.56834423608663, 144.96198407123072, 18.191590635802687, 100.81951137070233, 173.00897456523336, 186.20222053290908, 67.79669885996536, 180.01132021804, 23.513707222900376, 168.64491427689313, 165.37680519334214, 53.94981734916383, 358.73760865459417, 239.1920589528924, 11.192756606410137, 228.4980047983503, 50.67002006501883, 112.33091025097812, 134.29738393769256, 39.866427753311875, 167.9768740582616, 268.3957574580736, 0.0, 81.67187488891334, 212.29868784511706, 124.87187271201086, 377.52691948062636, 222.6042576539104, 155.00060884396024, 90.42257901559407, 115.58412057376266, 68.32703792121505, 32.339128543222905, 66.34030745956233, 149.20523611264292, 38.24208897987212, 100.34649539875025, 101.87203180881642, 171.02884856181046, 59.390027969288205, 209.85354943501582, 32.695960617801276, 229.2682227778758, 358.97559596691656, 67.57750042391967, 32.84537474361827, 132.34222989162006, 84.21441885337812, 70.19046461519022, 30.356027683019832, 235.32833286056209, 135.295657397806, 39.505264811563364, 198.460235908689, 213.89919952777066, 566.3645782105427, 5.7123957910871725, 43.42308550777847, 313.77635136793907, 150.99905358030574, 255.4067074217919, 351.50116078272816, 104.21251528234251, 10.770335025882062, 300.55248769609244, 19.69614899794843, 410.0995569882404, 0.0, 69.01886859020733, 110.06873234880717, 21.99031440985922, 224.99406299443223, 269.59055569831736, 314.9089616076284, 117.36636429838113, 512.1803710438463, 48.30413690648587, 117.4645821921661, 30.773979179617445, 82.96377082191921, 264.9513710181131, 180.85590923509773, 28.818148556982084, 206.91246732481238, 179.37927404541145, 442.1642977996412, 165.10990369553383, 97.34038236542445, 2.3944005078791983, 19.340999451250404, 97.6280823025169, 57.64684383725305, 236.35223288714542, 147.163607175573, 194.72043969958204, 47.73765447051595, 62.65537526958186, 63.51883969542187, 64.2330359606554, 90.75037863184492, 253.8940848079067, 47.73746732947427, 18.95632090181904, 177.67792094649462, 198.39866645375844, 22.98810886576266, 128.39610144990317, 161.6619710447727, 46.709713350527565, 309.2033974587588, 46.61143206272722, 201.10655256824026, 167.31328983127304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.275118535798972, "mean_inference_ms": 3.488055991946954, "mean_action_processing_ms": 1.554224484387752, "mean_env_wait_ms": 1.1152395061405698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004510250356462266, "StateBufferConnector_ms": 0.012593136893378364, "ViewRequirementAgentConnector_ms": 0.10237147410710652}, "num_episodes": 72, "episode_return_max": 252.03107798469395, "episode_return_min": -27.959737974083225, "episode_return_mean": 91.72075344279415, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 268.5618992391522, "num_env_steps_trained_throughput_per_sec": 268.5618992391522, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 31453.593, "restore_workers_time_ms": 0.029, "training_step_time_ms": 31453.474, "sample_time_ms": 1273.151, "learn_time_ms": 30150.524, "learn_throughput": 265.335, "synch_weights_time_ms": 22.983}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 2, "trial_id": "cdf01_00000", "date": "2024-08-20_10-22-18", "timestamp": 1724129538, "time_this_iter_s": 29.82843804359436, "time_total_s": 62.97989320755005, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e8e040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 62.97989320755005, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 33.902173913043484, "ram_util_percent": 74.7130434782609}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0690585750909078, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 5.579682501535567, "policy_loss": -0.010750816656010492, "vf_loss": 5.5900841803777785, "vf_explained_var": 0.08048051756525797, "kl": 0.006982815492115367, "entropy": 1.5859318436138214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5653170312207842, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 7.148845948113335, "policy_loss": -0.009604177378221519, "vf_loss": 7.158191251754761, "vf_explained_var": 0.025005050594844515, "kl": 0.005177497593379644, "entropy": 1.581137029519157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 252.03107798469395, "episode_reward_min": -27.959737974083225, "episode_reward_mean": 91.72075344279415, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -489.19743397012223, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.45233748212124, "predator_policy": 566.3645782105427}, "policy_reward_mean": {"prey_policy": -93.23586367641578, "predator_policy": 139.09624039781283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.0000000000002, 55.40000000000024, 119.19786691046795, 38.10000000000027, 188.09999999999923, 174.38025217378654, 99.16389181710234, 92.69999999999885, 70.19999999999999, 80.99999999999987, 50.3000000000003, 21.357036005680627, 23.900000000000055, 206.19999999999948, 25.800000000000093, 197.892260381018, 38.900000000000176, 85.4349168958534, 115.99999999999977, 146.69999999999936, 36.90000000000004, 93.89600087839358, 153.29999999999936, 103.99999999999982, 69.75534867483651, 101.29999999999964, 84.2999999999993, 121.00000000000017, 69.42758678609306, 252.03107798469395, 86.52072716119497, 41.300000000000175, 119.89653537561856, 48.01995145398333, 161.59578845909098, 23.065668713635773, -19.06901841607342, 114.27014949576687, 119.00000000000007, 94.10000000000008, 71.42240878723999, 33.35315274304848, 245.49847468825905, -27.959737974083225, 211.69999999999985, 131.5335760819267, 30.13738685850244, 53.821098674330514, 69.19999999999983, 36.40000000000025, 63.10000000000042, 113.79824931160374, 53.03353568062192, 64.01597338221973, 148.53988111274305, 126.46732969375107, 175.3999999999996, 48.31558704412775, -27.18288116180164, 33.0000000000002, 39.80000000000031, 76.69999999999985, 89.99924943419265, 178.34502591678353, 219.79999999999964, 86.56333348717018, 212.99999999999983, 45.25071542651111, 70.17290440542415, 89.4329435374679, 43.40000000000027, 27.500000000000128], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.217670113124424, -101.63362411446255, -27.056201350814213, -235.7016768610366, -90.66473322378305, -142.19856625835067, -173.25330989146502, 13.42429098463748, 24.375140023154472, 130.64856243283012, -32.77204251016291, 1.986176784567244, -3.7314530519042575, 24.433965035269008, -22.71023804334926, -32.150680471080754, -324.47158613647173, -138.00069747742415, -62.91280605457016, 45.40947288794522, -274.13193379391623, 45.200000000000244, -324.6673781216329, -80.53508148605817, -93.23171220783819, -145.24987352504547, 180.45233748212124, -157.64209289579938, -218.63446981774425, -118.0282138860831, -261.0087071734464, 67.05540647338748, -124.5619840712312, 0.3084093641973031, -139.9808239998098, -48.41274504027255, -86.80222053290913, -51.19669885996537, -150.11132021804056, 93.28629277709936, -139.44491427689317, -157.67680519334203, -60.97618842085951, -257.81523670450497, -232.49205895289282, 135.4072433935896, -217.99800479835076, 42.82997993498125, 11.567122506835524, -188.44006802067003, -79.17327946538035, -27.370022346193533, -43.01250419565031, -141.08325326242314, 6.3281251110865355, -179.29868784511694, -254.53942080125466, -178.43178460529035, 0.6748307621040581, -126.24861927528059, -45.79684304466651, -73.6891293834952, -54.22703792121494, -5.1391285432227125, 9.899325704927344, -105.54833390151393, -3.4901715146390595, -87.07846141000033, -39.42917953391522, -71.87591237762075, -128.43586128790105, -117.74204740276761, -59.68098595385791, -221.3522158578936, -364.3630626815311, 52.08011578646283, 27.95462525638187, -74.1422298916205, -38.51441885337797, -21.790464615190118, 30.27615225194002, -224.53810400828226, -101.4013663946606, -40.046403071660926, -269.87928660906084, 103.01832586086078, -227.1656502274477, -372.87106174826584, 103.67691449222156, -249.17635136793825, -243.0932681430055, -31.778916777165406, -269.59251644398, -155.9837727625883, -118.3124011694789, -139.1893228781658, 45.10385100205177, -405.6995569882395, 20.000000000000014, -52.61886859020731, -84.96873234880809, 16.00968559014073, -79.00051448793029, -301.7858548932153, -232.11831783602256, -147.12347238936542, -489.19743397012223, -7.271100597989779, -13.706386668844418, 14.007706409804149, -208.37838161431992, -13.06943053196106, -178.2173334629611, 143.94327567088092, -275.1606751711249, -62.81547915497145, -288.18424555855466, -346.2728370984213, -84.04038236542507, 17.30559949212078, 6.359000548749567, -83.5280823025171, -40.14684383725284, -177.15223288714566, -37.04757439967248, -214.8372230412897, 64.85498245727503, 3.0970137194107967, -1.4188396954218083, 93.46696403934459, -12.187045144674412, -245.89408480790712, 66.17790045893133, 80.1283113097754, -139.87176870439856, -190.95410326934436, 33.84764837919051, -115.05895428943278, -96.25930577203451, -22.679435085797444, -297.7033974587581, -14.711432062727168, -184.90655256824076, -156.01328983127343], "policy_predator_policy_reward": [137.76947884355405, 8.646475157783946, 47.45620135081446, 270.70167686103656, 150.81661538131442, 201.24455101128694, 183.85330989146476, 14.075709015362492, 17.616454187771392, 15.459843356244077, 79.7547705346079, 125.4113473647747, 32.87201635165305, 45.58936348208544, 54.310238043349486, 93.25068047108091, 333.77158613647225, 198.90069747742385, 93.06445648401898, 5.438876682605255, 279.23193379391637, 0.0, 181.57426519690574, 244.98523041646527, 107.63171220783761, 154.74987352504527, 162.2896392960461, 21.100116117631224, 230.43446981774363, 132.02821388608254, 228.2772168449903, 163.56834423608663, 144.96198407123072, 18.191590635802687, 100.81951137070233, 173.00897456523336, 186.20222053290908, 67.79669885996536, 180.01132021804, 23.513707222900376, 168.64491427689313, 165.37680519334214, 53.94981734916383, 358.73760865459417, 239.1920589528924, 11.192756606410137, 228.4980047983503, 50.67002006501883, 112.33091025097812, 134.29738393769256, 39.866427753311875, 167.9768740582616, 268.3957574580736, 0.0, 81.67187488891334, 212.29868784511706, 124.87187271201086, 377.52691948062636, 222.6042576539104, 155.00060884396024, 90.42257901559407, 115.58412057376266, 68.32703792121505, 32.339128543222905, 66.34030745956233, 149.20523611264292, 38.24208897987212, 100.34649539875025, 101.87203180881642, 171.02884856181046, 59.390027969288205, 209.85354943501582, 32.695960617801276, 229.2682227778758, 358.97559596691656, 67.57750042391967, 32.84537474361827, 132.34222989162006, 84.21441885337812, 70.19046461519022, 30.356027683019832, 235.32833286056209, 135.295657397806, 39.505264811563364, 198.460235908689, 213.89919952777066, 566.3645782105427, 5.7123957910871725, 43.42308550777847, 313.77635136793907, 150.99905358030574, 255.4067074217919, 351.50116078272816, 104.21251528234251, 10.770335025882062, 300.55248769609244, 19.69614899794843, 410.0995569882404, 0.0, 69.01886859020733, 110.06873234880717, 21.99031440985922, 224.99406299443223, 269.59055569831736, 314.9089616076284, 117.36636429838113, 512.1803710438463, 48.30413690648587, 117.4645821921661, 30.773979179617445, 82.96377082191921, 264.9513710181131, 180.85590923509773, 28.818148556982084, 206.91246732481238, 179.37927404541145, 442.1642977996412, 165.10990369553383, 97.34038236542445, 2.3944005078791983, 19.340999451250404, 97.6280823025169, 57.64684383725305, 236.35223288714542, 147.163607175573, 194.72043969958204, 47.73765447051595, 62.65537526958186, 63.51883969542187, 64.2330359606554, 90.75037863184492, 253.8940848079067, 47.73746732947427, 18.95632090181904, 177.67792094649462, 198.39866645375844, 22.98810886576266, 128.39610144990317, 161.6619710447727, 46.709713350527565, 309.2033974587588, 46.61143206272722, 201.10655256824026, 167.31328983127304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.275118535798972, "mean_inference_ms": 3.488055991946954, "mean_action_processing_ms": 1.554224484387752, "mean_env_wait_ms": 1.1152395061405698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004510250356462266, "StateBufferConnector_ms": 0.012593136893378364, "ViewRequirementAgentConnector_ms": 0.10237147410710652}, "num_episodes": 0, "episode_return_max": 252.03107798469395, "episode_return_min": -27.959737974083225, "episode_return_mean": 91.72075344279415, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 269.3988759497896, "num_env_steps_trained_throughput_per_sec": 269.3988759497896, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 30867.646, "restore_workers_time_ms": 0.024, "training_step_time_ms": 30867.442, "sample_time_ms": 1281.479, "learn_time_ms": 29555.826, "learn_throughput": 270.674, "synch_weights_time_ms": 23.638}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 3, "trial_id": "cdf01_00000", "date": "2024-08-20_10-22-48", "timestamp": 1724129568, "time_this_iter_s": 29.72118902206421, "time_total_s": 92.70108222961426, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317ed2160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 92.70108222961426, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 31.297619047619055, "ram_util_percent": 75.42142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3284634666310415, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 4.914956118946984, "policy_loss": -0.010257630377623533, "vf_loss": 4.924846352849688, "vf_explained_var": 0.10926993517648606, "kl": 0.007347689325020866, "entropy": 1.564225955614968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 2205.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.547029706883052, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 6.429329074375213, "policy_loss": -0.01321837451708104, "vf_loss": 6.442060621201046, "vf_explained_var": 0.05577337136344304, "kl": 0.009736101693915627, "entropy": 1.5451700725252666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 2205.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 232.93481775370887, "episode_reward_min": -27.18288116180164, "episode_reward_mean": 91.79087829201683, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -489.19743397012223, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 152.70067110192008, "predator_policy": 512.1803710438463}, "policy_reward_mean": {"prey_policy": -73.14621861387542, "predator_policy": 119.04165775988382}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.69999999999985, 131.5335760819267, 30.13738685850244, 53.821098674330514, 69.19999999999983, 36.40000000000025, 63.10000000000042, 113.79824931160374, 53.03353568062192, 64.01597338221973, 148.53988111274305, 126.46732969375107, 175.3999999999996, 48.31558704412775, -27.18288116180164, 33.0000000000002, 39.80000000000031, 76.69999999999985, 89.99924943419265, 178.34502591678353, 219.79999999999964, 86.56333348717018, 212.99999999999983, 45.25071542651111, 70.17290440542415, 89.4329435374679, 43.40000000000027, 27.500000000000128, 87.40000000000015, 90.7690499654461, 33.52636094078188, 64.10000000000008, -9.19484880126067, 29.200000000000145, 61.40000000000025, 135.7249390900713, 115.99999999999972, 160.0999505561611, 110.89999999999935, 14.040461039592122, 216.14239285846307, 62.4000000000004, 106.99999999999908, 232.93481775370887, 188.2999999999995, 193.1062945884615, 60.5000000000001, 44.99999999999999, 32.50000000000021, 52.60000000000002, 49.03877960912586, 87.30000000000017, 161.69999999999965, 158.75619895422517, 42.20000000000016, 45.90000000000022, 107.91871439534587, 111.42809421885178, 168.5590845837054, 38.70000000000006, 56.40000000000025, 49.40000000000006, 116.9999999999996, 119.54461527093612, 70.60170198779988, 43.00000000000033, 72.826050030076, 69.19999999999999, 78.01465813311222, 99.78161772489861, 156.26447580778134, 42.20000000000036, 80.5000000000001, 162.2999999999994, 114.5091071350713, 16.562942122665664, 79.95469773115278, 42.800000000000026, 135.99999999999903, 130.96248542391993, 56.40000000000046, 41.85575782445833, 84.06171301199379, 37.51044124671482, 159.69999999999996, 38.68534107706812, 83.59999999999903, 82.09999999999954, 133.39999999999986, 128.5995889373053, 93.8999999999999, 171.29999999999956, 37.10000000000018, 134.8057680089918, 110.29999999999932, 69.6315495057813, 157.09999999999957, 11.134486144146598, 100.18663343955788, 142.69999999999928], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [103.67691449222156, -249.17635136793825, -243.0932681430055, -31.778916777165406, -269.59251644398, -155.9837727625883, -118.3124011694789, -139.1893228781658, 45.10385100205177, -405.6995569882395, 20.000000000000014, -52.61886859020731, -84.96873234880809, 16.00968559014073, -79.00051448793029, -301.7858548932153, -232.11831783602256, -147.12347238936542, -489.19743397012223, -7.271100597989779, -13.706386668844418, 14.007706409804149, -208.37838161431992, -13.06943053196106, -178.2173334629611, 143.94327567088092, -275.1606751711249, -62.81547915497145, -288.18424555855466, -346.2728370984213, -84.04038236542507, 17.30559949212078, 6.359000548749567, -83.5280823025171, -40.14684383725284, -177.15223288714566, -37.04757439967248, -214.8372230412897, 64.85498245727503, 3.0970137194107967, -1.4188396954218083, 93.46696403934459, -12.187045144674412, -245.89408480790712, 66.17790045893133, 80.1283113097754, -139.87176870439856, -190.95410326934436, 33.84764837919051, -115.05895428943278, -96.25930577203451, -22.679435085797444, -297.7033974587581, -14.711432062727168, -184.90655256824076, -156.01328983127343, 36.31161593573344, -3.738830742701769, -43.402665634162126, -65.53772245812613, -25.04544005161106, -138.07053734582414, -156.09273823388855, -93.72006958637715, -268.5204665527669, -143.30647171530183, 14.786409746293591, -209.40467698934688, -192.90101160340922, -26.964059918418776, -64.47594035922866, 99.28398326352553, 4.339086341582081, -150.1525487619254, 86.8483542681375, -9.238594375102233, -32.113537396042126, -6.5670179237815764, -251.8122508918625, -184.7447553862491, 105.97426896564701, -87.02343693551799, -10.706511203429384, 8.41263482634105, -98.86627242642531, 87.58187726279272, -107.1041002565835, 88.79084130358152, -63.30030972694177, 136.20000778537968, 152.70067110192008, -30.47696112306346, -108.22649576009373, -252.1300653535489, -303.7111001096052, -168.9527045548648, -130.00568382466813, -33.12056418453174, -174.6240680400777, -299.4519693741637, -102.29992708756002, -170.70601676488985, -159.38664741968543, -118.07737730077801, -28.999515745646214, 18.407674441805927, -26.76753179274027, 38.82763000097576, -86.34121903371651, -102.5283768676583, -14.844793395343501, -5.901376919147264, 53.96140414060616, -53.304830871934435, 69.02755964207739, -150.9346368844384, 78.2269299384088, -42.478292885631305, -195.29720330477187, -53.43057818112311, -92.04042461637873, 13.818557754802065, -164.2037781309636, 1.7810725846829, -46.24462527731762, 33.92214703116865, 2.817227668412057, -165.44329615538325, -2.088470772122733, -135.86340581006306, -10.1813844875465, -28.007957046472786, -15.549929800350194, -183.0821394041183, -117.49002536858224, -129.39246567071044, 12.444787458331694, -346.4758594704032, -56.5000193835457, 1.986978630393763, -117.8907263446002, 29.839501114413245, -117.95718611758667, 21.311316609898075, -28.60107394845157, -9.075961046711164, 37.91230342280566, 71.27885946646904, -235.7612981403997, -9.40593644248402, -193.67379098096097, -317.66300862799966, -12.31564188665977, -36.12755281408803, -189.31898829944902, -88.47346696585224, -42.821507747950754, 64.76108354097158, 39.69068629529669, -85.35251687092985, 17.272176177343358, 20.985408776295273, -123.60327534224209, -26.924428386122933, -107.18623480449361, -229.63266161911145, -50.77616707797269, -3.1234803481720195, -40.342419362307446, -10.979191479883205, -153.13012977282608, -243.6689747126896, -76.4819656461798, -27.108550176390587, 44.90269517810041, -132.35363865012027, -24.725362875694465, -51.58880304393257, 17.37408578255473, 4.308447951389011, -59.85545698231584, -59.47031718911569, 113.15097703741671, -46.60746271286499, -72.54845761664758, 3.7115335817051798, -166.02322268045262, 58.98611767818282, 13.038512259107987, -98.63171509244452, -82.03911143377643, -118.94709531636477, 75.83793114732435, -91.24177219043915, -88.73512963042742, -56.17025791429689, -39.56333002060874, -140.60255172659228, -3.2692511135901583, 36.230541772702765], "policy_predator_policy_reward": [43.42308550777847, 313.77635136793907, 150.99905358030574, 255.4067074217919, 351.50116078272816, 104.21251528234251, 10.770335025882062, 300.55248769609244, 19.69614899794843, 410.0995569882404, 0.0, 69.01886859020733, 110.06873234880717, 21.99031440985922, 224.99406299443223, 269.59055569831736, 314.9089616076284, 117.36636429838113, 512.1803710438463, 48.30413690648587, 117.4645821921661, 30.773979179617445, 82.96377082191921, 264.9513710181131, 180.85590923509773, 28.818148556982084, 206.91246732481238, 179.37927404541145, 442.1642977996412, 165.10990369553383, 97.34038236542445, 2.3944005078791983, 19.340999451250404, 97.6280823025169, 57.64684383725305, 236.35223288714542, 147.163607175573, 194.72043969958204, 47.73765447051595, 62.65537526958186, 63.51883969542187, 64.2330359606554, 90.75037863184492, 253.8940848079067, 47.73746732947427, 18.95632090181904, 177.67792094649462, 198.39866645375844, 22.98810886576266, 128.39610144990317, 161.6619710447727, 46.709713350527565, 309.2033974587588, 46.61143206272722, 201.10655256824026, 167.31328983127304, 23.188384064266533, 31.638830742701714, 100.32262833112497, 99.38680972660973, 58.050187174551255, 138.59215116366587, 197.90885475740515, 116.00395306285958, 199.7340836806735, 202.89800578613432, 4.7135902537063625, 219.10467698934633, 151.84642845807556, 129.4186430637524, 79.17594035922885, 21.740955826546465, 179.26682665286356, 82.54663576747917, 38.92440617685077, 43.56578448627569, 142.00923670008683, 7.571318619736905, 339.51936381057163, 111.07810350713125, 152.44661760837064, 44.744943219963645, 22.934570225368315, 41.759306151720075, 111.9662724264254, 6.318122737206802, 82.24796883752146, 169.00010786918966, 79.00030972694138, 36.399992214620326, 26.7226553287587, 44.15992928084703, 146.7264957600933, 274.13006535354896, 214.1094778263341, 303.5543268381352, 145.90568382466796, 49.72056418453172, 186.11221709606127, 340.5638203181804, 100.15495891130388, 221.88976455027066, 215.08664741968548, 149.6773773007778, 46.29951574564619, 125.99232555819404, 114.17799470194745, 32.51810604404345, 99.1412190337159, 131.92837686765836, 5.764198979819607, 60.88197133467123, 19.287058196599187, 87.97508293007644, 10.90615909981356, 182.4290123613991, 36.234725870750296, 96.57572166017822, 216.69720330477193, 70.73057818112297, 64.9242156433774, 69.69765121819877, 142.06205330202798, 69.76065224425261, 62.04462527731784, 67.27785296883143, 86.86281263126814, 195.30787112663964, 156.78730164363677, 51.766276926348766, 61.962819451312484, 19.226522082706722, 87.01067604039915, 184.44744319414528, 129.39002536858158, 186.69246567071022, 311.6441802478937, 100.40154989729216, 140.92470426794708, 13.369954210104208, 171.4592094149975, 72.85649162297058, 131.85718611758588, 6.988683390101961, 78.2836761696106, 39.89335882555202, 12.687696577194444, 40.42114053353096, 191.28635198393226, 168.38998973402232, 192.87975263328036, 335.0199890983463, 28.682567771627564, 99.71532466027242, 206.71898829944877, 113.87346696585142, 63.62150774795101, 50.43891645902837, 50.89147021376934, 125.73284578578397, 7.100122587054905, 11.042292459306559, 161.19016971281965, 31.193291840002832, 248.98111542393508, 171.899494011663, 31.02729301642178, 60.38279565643761, 119.04241936230719, 91.979191479883, 337.7096015114182, 97.77484405116465, 161.24393445887534, 25.9465813636942, 26.69730482189964, 142.8536386501197, 127.02536287569436, 82.68880304393272, 36.7596321207351, 70.15742308262709, 138.25545698231548, 74.9703171891153, 12.1490229625833, 92.60746271286507, 89.048457616647, 16.888466418294794, 235.42715887915276, 6.415714132108872, 70.16148774089207, 125.73171509244388, 127.41933682776643, 143.19841942815614, 76.55755952599657, 95.94628151711773, 77.48526529497279, 78.55460839389825, 223.3909735439278, 56.96154164283097, 66.45524841807743, 43.28346092281017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409566113185636, "mean_inference_ms": 3.597115303265239, "mean_action_processing_ms": 1.5959097668448021, "mean_env_wait_ms": 1.1494227226894853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004426717758178711, "StateBufferConnector_ms": 0.01724839210510254, "ViewRequirementAgentConnector_ms": 0.1402674913406372}, "num_episodes": 72, "episode_return_max": 232.93481775370887, "episode_return_min": -27.18288116180164, "episode_return_mean": 91.79087829201683, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 270.41823388123095, "num_env_steps_trained_throughput_per_sec": 270.41823388123095, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 30546.694, "restore_workers_time_ms": 0.026, "training_step_time_ms": 30546.518, "sample_time_ms": 1346.011, "learn_time_ms": 29172.904, "learn_throughput": 274.227, "synch_weights_time_ms": 22.18}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 4, "trial_id": "cdf01_00000", "date": "2024-08-20_10-23-18", "timestamp": 1724129598, "time_this_iter_s": 29.587854862213135, "time_total_s": 122.28893709182739, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e55f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 122.28893709182739, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 30.354761904761908, "ram_util_percent": 76.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1508043212550028, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 3.6054811625253587, "policy_loss": -0.011448639401397299, "vf_loss": 3.616224087230743, "vf_explained_var": 0.0850092401580205, "kl": 0.014114324763622357, "entropy": 1.5548214683457027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.772728309957754, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 6.426628229353163, "policy_loss": -0.008020759615603657, "vf_loss": 6.434226403917585, "vf_explained_var": 0.046446407692773, "kl": 0.008451751548371191, "entropy": 1.5383276271441626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 232.93481775370887, "episode_reward_min": -27.18288116180164, "episode_reward_mean": 91.79087829201683, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -489.19743397012223, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 152.70067110192008, "predator_policy": 512.1803710438463}, "policy_reward_mean": {"prey_policy": -73.14621861387542, "predator_policy": 119.04165775988382}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.69999999999985, 131.5335760819267, 30.13738685850244, 53.821098674330514, 69.19999999999983, 36.40000000000025, 63.10000000000042, 113.79824931160374, 53.03353568062192, 64.01597338221973, 148.53988111274305, 126.46732969375107, 175.3999999999996, 48.31558704412775, -27.18288116180164, 33.0000000000002, 39.80000000000031, 76.69999999999985, 89.99924943419265, 178.34502591678353, 219.79999999999964, 86.56333348717018, 212.99999999999983, 45.25071542651111, 70.17290440542415, 89.4329435374679, 43.40000000000027, 27.500000000000128, 87.40000000000015, 90.7690499654461, 33.52636094078188, 64.10000000000008, -9.19484880126067, 29.200000000000145, 61.40000000000025, 135.7249390900713, 115.99999999999972, 160.0999505561611, 110.89999999999935, 14.040461039592122, 216.14239285846307, 62.4000000000004, 106.99999999999908, 232.93481775370887, 188.2999999999995, 193.1062945884615, 60.5000000000001, 44.99999999999999, 32.50000000000021, 52.60000000000002, 49.03877960912586, 87.30000000000017, 161.69999999999965, 158.75619895422517, 42.20000000000016, 45.90000000000022, 107.91871439534587, 111.42809421885178, 168.5590845837054, 38.70000000000006, 56.40000000000025, 49.40000000000006, 116.9999999999996, 119.54461527093612, 70.60170198779988, 43.00000000000033, 72.826050030076, 69.19999999999999, 78.01465813311222, 99.78161772489861, 156.26447580778134, 42.20000000000036, 80.5000000000001, 162.2999999999994, 114.5091071350713, 16.562942122665664, 79.95469773115278, 42.800000000000026, 135.99999999999903, 130.96248542391993, 56.40000000000046, 41.85575782445833, 84.06171301199379, 37.51044124671482, 159.69999999999996, 38.68534107706812, 83.59999999999903, 82.09999999999954, 133.39999999999986, 128.5995889373053, 93.8999999999999, 171.29999999999956, 37.10000000000018, 134.8057680089918, 110.29999999999932, 69.6315495057813, 157.09999999999957, 11.134486144146598, 100.18663343955788, 142.69999999999928], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [103.67691449222156, -249.17635136793825, -243.0932681430055, -31.778916777165406, -269.59251644398, -155.9837727625883, -118.3124011694789, -139.1893228781658, 45.10385100205177, -405.6995569882395, 20.000000000000014, -52.61886859020731, -84.96873234880809, 16.00968559014073, -79.00051448793029, -301.7858548932153, -232.11831783602256, -147.12347238936542, -489.19743397012223, -7.271100597989779, -13.706386668844418, 14.007706409804149, -208.37838161431992, -13.06943053196106, -178.2173334629611, 143.94327567088092, -275.1606751711249, -62.81547915497145, -288.18424555855466, -346.2728370984213, -84.04038236542507, 17.30559949212078, 6.359000548749567, -83.5280823025171, -40.14684383725284, -177.15223288714566, -37.04757439967248, -214.8372230412897, 64.85498245727503, 3.0970137194107967, -1.4188396954218083, 93.46696403934459, -12.187045144674412, -245.89408480790712, 66.17790045893133, 80.1283113097754, -139.87176870439856, -190.95410326934436, 33.84764837919051, -115.05895428943278, -96.25930577203451, -22.679435085797444, -297.7033974587581, -14.711432062727168, -184.90655256824076, -156.01328983127343, 36.31161593573344, -3.738830742701769, -43.402665634162126, -65.53772245812613, -25.04544005161106, -138.07053734582414, -156.09273823388855, -93.72006958637715, -268.5204665527669, -143.30647171530183, 14.786409746293591, -209.40467698934688, -192.90101160340922, -26.964059918418776, -64.47594035922866, 99.28398326352553, 4.339086341582081, -150.1525487619254, 86.8483542681375, -9.238594375102233, -32.113537396042126, -6.5670179237815764, -251.8122508918625, -184.7447553862491, 105.97426896564701, -87.02343693551799, -10.706511203429384, 8.41263482634105, -98.86627242642531, 87.58187726279272, -107.1041002565835, 88.79084130358152, -63.30030972694177, 136.20000778537968, 152.70067110192008, -30.47696112306346, -108.22649576009373, -252.1300653535489, -303.7111001096052, -168.9527045548648, -130.00568382466813, -33.12056418453174, -174.6240680400777, -299.4519693741637, -102.29992708756002, -170.70601676488985, -159.38664741968543, -118.07737730077801, -28.999515745646214, 18.407674441805927, -26.76753179274027, 38.82763000097576, -86.34121903371651, -102.5283768676583, -14.844793395343501, -5.901376919147264, 53.96140414060616, -53.304830871934435, 69.02755964207739, -150.9346368844384, 78.2269299384088, -42.478292885631305, -195.29720330477187, -53.43057818112311, -92.04042461637873, 13.818557754802065, -164.2037781309636, 1.7810725846829, -46.24462527731762, 33.92214703116865, 2.817227668412057, -165.44329615538325, -2.088470772122733, -135.86340581006306, -10.1813844875465, -28.007957046472786, -15.549929800350194, -183.0821394041183, -117.49002536858224, -129.39246567071044, 12.444787458331694, -346.4758594704032, -56.5000193835457, 1.986978630393763, -117.8907263446002, 29.839501114413245, -117.95718611758667, 21.311316609898075, -28.60107394845157, -9.075961046711164, 37.91230342280566, 71.27885946646904, -235.7612981403997, -9.40593644248402, -193.67379098096097, -317.66300862799966, -12.31564188665977, -36.12755281408803, -189.31898829944902, -88.47346696585224, -42.821507747950754, 64.76108354097158, 39.69068629529669, -85.35251687092985, 17.272176177343358, 20.985408776295273, -123.60327534224209, -26.924428386122933, -107.18623480449361, -229.63266161911145, -50.77616707797269, -3.1234803481720195, -40.342419362307446, -10.979191479883205, -153.13012977282608, -243.6689747126896, -76.4819656461798, -27.108550176390587, 44.90269517810041, -132.35363865012027, -24.725362875694465, -51.58880304393257, 17.37408578255473, 4.308447951389011, -59.85545698231584, -59.47031718911569, 113.15097703741671, -46.60746271286499, -72.54845761664758, 3.7115335817051798, -166.02322268045262, 58.98611767818282, 13.038512259107987, -98.63171509244452, -82.03911143377643, -118.94709531636477, 75.83793114732435, -91.24177219043915, -88.73512963042742, -56.17025791429689, -39.56333002060874, -140.60255172659228, -3.2692511135901583, 36.230541772702765], "policy_predator_policy_reward": [43.42308550777847, 313.77635136793907, 150.99905358030574, 255.4067074217919, 351.50116078272816, 104.21251528234251, 10.770335025882062, 300.55248769609244, 19.69614899794843, 410.0995569882404, 0.0, 69.01886859020733, 110.06873234880717, 21.99031440985922, 224.99406299443223, 269.59055569831736, 314.9089616076284, 117.36636429838113, 512.1803710438463, 48.30413690648587, 117.4645821921661, 30.773979179617445, 82.96377082191921, 264.9513710181131, 180.85590923509773, 28.818148556982084, 206.91246732481238, 179.37927404541145, 442.1642977996412, 165.10990369553383, 97.34038236542445, 2.3944005078791983, 19.340999451250404, 97.6280823025169, 57.64684383725305, 236.35223288714542, 147.163607175573, 194.72043969958204, 47.73765447051595, 62.65537526958186, 63.51883969542187, 64.2330359606554, 90.75037863184492, 253.8940848079067, 47.73746732947427, 18.95632090181904, 177.67792094649462, 198.39866645375844, 22.98810886576266, 128.39610144990317, 161.6619710447727, 46.709713350527565, 309.2033974587588, 46.61143206272722, 201.10655256824026, 167.31328983127304, 23.188384064266533, 31.638830742701714, 100.32262833112497, 99.38680972660973, 58.050187174551255, 138.59215116366587, 197.90885475740515, 116.00395306285958, 199.7340836806735, 202.89800578613432, 4.7135902537063625, 219.10467698934633, 151.84642845807556, 129.4186430637524, 79.17594035922885, 21.740955826546465, 179.26682665286356, 82.54663576747917, 38.92440617685077, 43.56578448627569, 142.00923670008683, 7.571318619736905, 339.51936381057163, 111.07810350713125, 152.44661760837064, 44.744943219963645, 22.934570225368315, 41.759306151720075, 111.9662724264254, 6.318122737206802, 82.24796883752146, 169.00010786918966, 79.00030972694138, 36.399992214620326, 26.7226553287587, 44.15992928084703, 146.7264957600933, 274.13006535354896, 214.1094778263341, 303.5543268381352, 145.90568382466796, 49.72056418453172, 186.11221709606127, 340.5638203181804, 100.15495891130388, 221.88976455027066, 215.08664741968548, 149.6773773007778, 46.29951574564619, 125.99232555819404, 114.17799470194745, 32.51810604404345, 99.1412190337159, 131.92837686765836, 5.764198979819607, 60.88197133467123, 19.287058196599187, 87.97508293007644, 10.90615909981356, 182.4290123613991, 36.234725870750296, 96.57572166017822, 216.69720330477193, 70.73057818112297, 64.9242156433774, 69.69765121819877, 142.06205330202798, 69.76065224425261, 62.04462527731784, 67.27785296883143, 86.86281263126814, 195.30787112663964, 156.78730164363677, 51.766276926348766, 61.962819451312484, 19.226522082706722, 87.01067604039915, 184.44744319414528, 129.39002536858158, 186.69246567071022, 311.6441802478937, 100.40154989729216, 140.92470426794708, 13.369954210104208, 171.4592094149975, 72.85649162297058, 131.85718611758588, 6.988683390101961, 78.2836761696106, 39.89335882555202, 12.687696577194444, 40.42114053353096, 191.28635198393226, 168.38998973402232, 192.87975263328036, 335.0199890983463, 28.682567771627564, 99.71532466027242, 206.71898829944877, 113.87346696585142, 63.62150774795101, 50.43891645902837, 50.89147021376934, 125.73284578578397, 7.100122587054905, 11.042292459306559, 161.19016971281965, 31.193291840002832, 248.98111542393508, 171.899494011663, 31.02729301642178, 60.38279565643761, 119.04241936230719, 91.979191479883, 337.7096015114182, 97.77484405116465, 161.24393445887534, 25.9465813636942, 26.69730482189964, 142.8536386501197, 127.02536287569436, 82.68880304393272, 36.7596321207351, 70.15742308262709, 138.25545698231548, 74.9703171891153, 12.1490229625833, 92.60746271286507, 89.048457616647, 16.888466418294794, 235.42715887915276, 6.415714132108872, 70.16148774089207, 125.73171509244388, 127.41933682776643, 143.19841942815614, 76.55755952599657, 95.94628151711773, 77.48526529497279, 78.55460839389825, 223.3909735439278, 56.96154164283097, 66.45524841807743, 43.28346092281017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.409566113185636, "mean_inference_ms": 3.597115303265239, "mean_action_processing_ms": 1.5959097668448021, "mean_env_wait_ms": 1.1494227226894853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004426717758178711, "StateBufferConnector_ms": 0.01724839210510254, "ViewRequirementAgentConnector_ms": 0.1402674913406372}, "num_episodes": 0, "episode_return_max": 232.93481775370887, "episode_return_min": -27.18288116180164, "episode_return_mean": 91.79087829201683, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 277.5855392188514, "num_env_steps_trained_throughput_per_sec": 277.5855392188514, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 30201.347, "restore_workers_time_ms": 0.024, "training_step_time_ms": 30201.197, "sample_time_ms": 1297.849, "learn_time_ms": 28877.72, "learn_throughput": 277.03, "synch_weights_time_ms": 21.029}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 5, "trial_id": "cdf01_00000", "date": "2024-08-20_10-23-47", "timestamp": 1724129627, "time_this_iter_s": 28.856420278549194, "time_total_s": 151.1453573703766, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e8e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 151.1453573703766, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 29.995121951219517, "ram_util_percent": 75.43658536585366}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.213695427113109, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 4.533476912029206, "policy_loss": -0.013092624216103957, "vf_loss": 4.545969578954908, "vf_explained_var": 0.14700909465078324, "kl": 0.011999105277275718, "entropy": 1.474549260782817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 3465.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5538701672875692, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 6.200624815622965, "policy_loss": -0.00826707115574252, "vf_loss": 6.208555712018694, "vf_explained_var": 0.07114995500398061, "kl": 0.006724314369995906, "entropy": 1.474147107298412, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 3465.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 249.29999999999976, "episode_reward_min": 11.134486144146598, "episode_reward_mean": 113.53428557988458, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -319.73036299913355, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 164.68633309026615, "predator_policy": 337.7096015114182}, "policy_reward_mean": {"prey_policy": -25.192964053204513, "predator_policy": 81.96010684314687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.5000000000001, 162.2999999999994, 114.5091071350713, 16.562942122665664, 79.95469773115278, 42.800000000000026, 135.99999999999903, 130.96248542391993, 56.40000000000046, 41.85575782445833, 84.06171301199379, 37.51044124671482, 159.69999999999996, 38.68534107706812, 83.59999999999903, 82.09999999999954, 133.39999999999986, 128.5995889373053, 93.8999999999999, 171.29999999999956, 37.10000000000018, 134.8057680089918, 110.29999999999932, 69.6315495057813, 157.09999999999957, 11.134486144146598, 100.18663343955788, 142.69999999999928, 148.8991137077653, 55.622249828028885, 94.49999999999935, 138.59999999999962, 68.70000000000036, 147.3788799309099, 87.5967243683551, 79.79999999999994, 160.29678824934018, 36.50000000000028, 153.86955295643546, 158.59999999999974, 60.96124955257532, 77.89999999999942, 204.9999999999994, 129.72485539911042, 240.4928603116016, 216.99473159830805, 99.30616096027921, 28.300000000000125, 78.317422479506, 184.47434220808827, 45.132233047033964, 57.28442811202936, 147.09999999999945, 135.79999999999922, 84.75225612462702, 70.65987469140802, 84.81878760724781, 109.98003882336614, 114.79999999999984, 132.10350416593636, 98.99724375442108, 102.91131744523898, 134.46927464825262, 71.09999999999997, 82.09999999999968, 170.59961132386528, 172.88742795641647, 203.1083579701561, 92.16920214209773, 95.29138808629389, 117.89999999999968, 138.18224640043084, 30.790708459037557, 101.41528616315519, 192.59999999999903, 125.11780037062078, 164.85654240321168, 68.00000000000018, 203.59263175666862, 81.50000000000003, 39.4746674193533, 121.99999999999972, 154.80178492018067, 121.7185063282863, 119.69999999999871, 122.89999999999978, 211.30070735571866, 75.59999999999971, 203.17125194873634, 117.79999999999846, 143.89999999999958, 175.79515713126258, 27.700000000000102, 52.500000000000206, 171.99999999999946, 249.29999999999976, 186.26778388420252, 19.30000000000001, 151.89999999999952, 166.78309439008618], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.60107394845157, -9.075961046711164, 37.91230342280566, 71.27885946646904, -235.7612981403997, -9.40593644248402, -193.67379098096097, -317.66300862799966, -12.31564188665977, -36.12755281408803, -189.31898829944902, -88.47346696585224, -42.821507747950754, 64.76108354097158, 39.69068629529669, -85.35251687092985, 17.272176177343358, 20.985408776295273, -123.60327534224209, -26.924428386122933, -107.18623480449361, -229.63266161911145, -50.77616707797269, -3.1234803481720195, -40.342419362307446, -10.979191479883205, -153.13012977282608, -243.6689747126896, -76.4819656461798, -27.108550176390587, 44.90269517810041, -132.35363865012027, -24.725362875694465, -51.58880304393257, 17.37408578255473, 4.308447951389011, -59.85545698231584, -59.47031718911569, 113.15097703741671, -46.60746271286499, -72.54845761664758, 3.7115335817051798, -166.02322268045262, 58.98611767818282, 13.038512259107987, -98.63171509244452, -82.03911143377643, -118.94709531636477, 75.83793114732435, -91.24177219043915, -88.73512963042742, -56.17025791429689, -39.56333002060874, -140.60255172659228, -3.2692511135901583, 36.230541772702765, -91.81708431064361, 99.99829669725997, 12.76812456019829, 2.02595802994324, -46.824298124417076, 61.58060875333528, -24.337038768312986, 71.6382072095104, 22.111043546158236, -1.2565760763452918, -19.413157408888488, 56.799530803492466, -49.2062071234247, 13.194976428112135, -53.869523109986694, -175.53580906470881, 19.855694835686315, -115.18931905752075, -17.968712751831692, -203.0237443278861, -128.49114355293347, 14.853899914196433, 17.352956130948836, 51.56322913912115, -83.92162291606573, -34.31415580188616, 21.33471778120229, 3.455910994259404, 43.75861809563525, 79.73005390833947, 6.1609476756070425, 54.70618159595736, 113.96039836965161, 65.27146221943934, 131.51226501050587, -41.976328033139815, -56.49520913720147, -63.823076316652504, -86.12831386446648, -43.56863591247924, 34.49685506207849, -124.35164239817806, -64.26429799332246, -28.439815267321507, -23.286838583129853, -21.96807944714893, -40.679264677365715, -28.315746689553617, 19.036530727473288, 100.60445103922066, 93.95948468700006, -17.3539050653527, -42.363891848214244, -257.0837673812338, 13.238403110812213, -75.22652386048706, -46.044170224818444, -92.96180154819761, -137.46267445322206, -124.88504406400472, 20.000000000000014, 87.24534508792145, -37.92066018609589, 14.33126417861821, -29.068206818732122, 17.64878278982229, -35.214623565204555, 21.82728563610351, 73.32615023214933, 14.001843419349926, -40.1731423522161, 34.188473299198584, 17.678351272734066, -216.58052183547332, 16.335458885297935, -11.582834179695753, -31.320310706564626, 11.04880326674773, 64.68011552474125, -29.084218916637752, -69.08002073667981, 0.036968160250790305, -260.93712004490055, 78.83165166190263, 23.59935545410339, -6.680256492997254, -96.28958754172231, -18.753720074833517, -179.1320525503806, -183.5501478321119, 50.92608573158142, -22.23247988681951, 72.44549514028613, 81.1444377348577, -63.40544787560758, 69.09522468793128, -99.20482392032969, 107.43564532154633, 33.60065833062851, 3.173199014734102, 47.77015766444136, 63.410669433834734, -0.09725975652748992, -29.370413343825184, -0.8587661226160759, -127.8200046802631, 5.155306730925108, 2.076677565993454, -67.55634745612826, 19.856533533781576, -96.80356254790614, 23.270540154519175, 10.348336900139635, 80.40662156043672, -62.1768708130844, 38.87172354408262, 164.68633309026615, -111.37439679402746, 4.480475364455824, -77.7198006043432, 61.82326823853593, 61.332424814150855, 41.480764415778275, 43.89893025487979, -234.57811791244555, 90.1076539705212, 8.44259909758854, 71.7548559777733, -137.75509671102378, -41.634400233269744, 2.511747135904623, -43.1968935937545, 147.85051912114227, -10.556060676778015, 64.23737767490917, 146.19128729087961, -9.819086702486459, 47.6390118978101, -91.4438079343946, -319.73036299913355, -54.137633885673985, 89.58217936503817, -154.6608809013979, 104.47895037442876], "policy_predator_policy_reward": [78.2836761696106, 39.89335882555202, 12.687696577194444, 40.42114053353096, 191.28635198393226, 168.38998973402232, 192.87975263328036, 335.0199890983463, 28.682567771627564, 99.71532466027242, 206.71898829944877, 113.87346696585142, 63.62150774795101, 50.43891645902837, 50.89147021376934, 125.73284578578397, 7.100122587054905, 11.042292459306559, 161.19016971281965, 31.193291840002832, 248.98111542393508, 171.899494011663, 31.02729301642178, 60.38279565643761, 119.04241936230719, 91.979191479883, 337.7096015114182, 97.77484405116465, 161.24393445887534, 25.9465813636942, 26.69730482189964, 142.8536386501197, 127.02536287569436, 82.68880304393272, 36.7596321207351, 70.15742308262709, 138.25545698231548, 74.9703171891153, 12.1490229625833, 92.60746271286507, 89.048457616647, 16.888466418294794, 235.42715887915276, 6.415714132108872, 70.16148774089207, 125.73171509244388, 127.41933682776643, 143.19841942815614, 76.55755952599657, 95.94628151711773, 77.48526529497279, 78.55460839389825, 223.3909735439278, 56.96154164283097, 66.45524841807743, 43.28346092281017, 107.34301719191724, 33.37488412923134, 0.9518919482910753, 39.87627528959584, 65.02429812441729, 14.719391246664781, 50.3900643792644, 40.90876717953833, 44.8028704212104, 3.042662108976712, 62.648605349053696, 47.34390118725343, 101.48969316307756, 22.11826190059052, 100.66952310998668, 208.5358090647087, 155.197220030302, 100.43319244087263, 34.76871275183194, 222.72374432788584, 141.20838228308358, 126.29841431208915, 33.947043869051306, 55.73677086087888, 76.64466965410806, 102.55235861641822, 2.065282218797759, 51.04408900574059, 25.241381904364847, 56.26994609166043, 41.781520071850636, 27.076206055696346, 41.960805746446766, 19.300193976064396, 79.96323889517004, 47.495555725772405, 128.4348825029554, 91.18956391117771, 98.82831386446581, 59.16863591247923, 16.023616635942297, 152.14859317966375, 83.21215614263626, 193.96629932609582, 60.43933950267715, 29.947811574635445, 102.35633627212323, 23.92310320682556, 11.663469272526708, 15.795548960779222, 24.4405153129997, 34.75390506535293, 132.24840347650562, 251.9515118775701, 86.3681258757977, 46.27986956528435, 36.66375193589199, 187.16100744437296, 207.04165918673817, 165.28609815385474, 0.0, 7.554654912078547, 25.336934741625146, 130.3559654317891, 64.97287734288525, 45.44379044044648, 100.99107638278093, 15.30757899155924, 35.86951192923111, 11.27176906752305, 68.3697495959266, 8.714919457091218, 49.92969197030307, 231.07247859243603, 43.19184442064601, 122.65514219761745, 111.42031070656463, 81.73862468966888, 109.13101167906355, 58.381449682989775, 118.89700717830507, 42.31524754022073, 274.5043409357289, 2.892515533562998, 32.1006445458968, 68.88025649299732, 128.90330709666847, 124.32224692031873, 158.71495980423524, 234.75794903729366, 15.032524608384163, 57.689155710010894, 35.434345871558776, 3.575721253296935, 80.83158555877917, 38.59643799951766, 112.65076963346173, 43.974951368533304, 9.799341669371518, 21.42680098526587, 10.956083160649765, 81.45572149774311, 27.897259756527497, 83.07041334382518, 9.648403489827638, 158.50503473240457, 13.744693269074858, 101.0233224340066, 93.59966040415202, 108.90193843837514, 167.5035625479058, 27.747966173767878, 22.35166309986041, 6.593378439562596, 106.17846986880728, 40.02667740019387, 65.58141262976274, 92.4073584297172, 14.719524635544142, 134.11980060434294, 17.720190525267817, 62.29536837078171, 21.219235584221916, 11.201069745120392, 244.17811791244523, 44.192346029478685, 42.43529244986983, 53.16240960603119, 63.03830480284067, 144.05119214145293, 16.18825286409534, 76.99689359375434, 5.649480878857692, 29.056060676778166, 12.162622325090801, 26.70871270912042, 132.19380205431318, 16.25405663456651, 104.54380793439398, 325.9303629991343, 75.18686708595469, 41.26858743468103, 193.05557975176526, 23.90944516529011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.474433922330599, "mean_inference_ms": 3.6240795461027413, "mean_action_processing_ms": 1.5975979148769324, "mean_env_wait_ms": 1.1547718778867202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003935694694519043, "StateBufferConnector_ms": 0.018645524978637695, "ViewRequirementAgentConnector_ms": 0.13423216342926025}, "num_episodes": 72, "episode_return_max": 249.29999999999976, "episode_return_min": 11.134486144146598, "episode_return_mean": 113.53428557988458, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 268.74349839765534, "num_env_steps_trained_throughput_per_sec": 268.74349839765534, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 30129.151, "restore_workers_time_ms": 0.022, "training_step_time_ms": 30129.009, "sample_time_ms": 1328.884, "learn_time_ms": 28774.138, "learn_throughput": 278.027, "synch_weights_time_ms": 21.756}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 6, "trial_id": "cdf01_00000", "date": "2024-08-20_10-24-17", "timestamp": 1724129657, "time_this_iter_s": 29.8106369972229, "time_total_s": 180.9559943675995, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e63940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 180.9559943675995, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 36.3093023255814, "ram_util_percent": 75.5627906976744}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3132933517770162, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 5.865690759628538, "policy_loss": -0.009801773779049871, "vf_loss": 5.87502202306475, "vf_explained_var": 0.10082950686651562, "kl": 0.009409332684530427, "entropy": 1.4161828873649476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 4095.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.378095015410393, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 7.334506728914049, "policy_loss": -0.011952073935655847, "vf_loss": 7.345919226086329, "vf_explained_var": 0.046624016383337595, "kl": 0.010792291770514335, "entropy": 1.4342769959616282, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 4095.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 249.29999999999976, "episode_reward_min": 11.134486144146598, "episode_reward_mean": 113.53428557988458, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -319.73036299913355, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 164.68633309026615, "predator_policy": 337.7096015114182}, "policy_reward_mean": {"prey_policy": -25.192964053204513, "predator_policy": 81.96010684314687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.5000000000001, 162.2999999999994, 114.5091071350713, 16.562942122665664, 79.95469773115278, 42.800000000000026, 135.99999999999903, 130.96248542391993, 56.40000000000046, 41.85575782445833, 84.06171301199379, 37.51044124671482, 159.69999999999996, 38.68534107706812, 83.59999999999903, 82.09999999999954, 133.39999999999986, 128.5995889373053, 93.8999999999999, 171.29999999999956, 37.10000000000018, 134.8057680089918, 110.29999999999932, 69.6315495057813, 157.09999999999957, 11.134486144146598, 100.18663343955788, 142.69999999999928, 148.8991137077653, 55.622249828028885, 94.49999999999935, 138.59999999999962, 68.70000000000036, 147.3788799309099, 87.5967243683551, 79.79999999999994, 160.29678824934018, 36.50000000000028, 153.86955295643546, 158.59999999999974, 60.96124955257532, 77.89999999999942, 204.9999999999994, 129.72485539911042, 240.4928603116016, 216.99473159830805, 99.30616096027921, 28.300000000000125, 78.317422479506, 184.47434220808827, 45.132233047033964, 57.28442811202936, 147.09999999999945, 135.79999999999922, 84.75225612462702, 70.65987469140802, 84.81878760724781, 109.98003882336614, 114.79999999999984, 132.10350416593636, 98.99724375442108, 102.91131744523898, 134.46927464825262, 71.09999999999997, 82.09999999999968, 170.59961132386528, 172.88742795641647, 203.1083579701561, 92.16920214209773, 95.29138808629389, 117.89999999999968, 138.18224640043084, 30.790708459037557, 101.41528616315519, 192.59999999999903, 125.11780037062078, 164.85654240321168, 68.00000000000018, 203.59263175666862, 81.50000000000003, 39.4746674193533, 121.99999999999972, 154.80178492018067, 121.7185063282863, 119.69999999999871, 122.89999999999978, 211.30070735571866, 75.59999999999971, 203.17125194873634, 117.79999999999846, 143.89999999999958, 175.79515713126258, 27.700000000000102, 52.500000000000206, 171.99999999999946, 249.29999999999976, 186.26778388420252, 19.30000000000001, 151.89999999999952, 166.78309439008618], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.60107394845157, -9.075961046711164, 37.91230342280566, 71.27885946646904, -235.7612981403997, -9.40593644248402, -193.67379098096097, -317.66300862799966, -12.31564188665977, -36.12755281408803, -189.31898829944902, -88.47346696585224, -42.821507747950754, 64.76108354097158, 39.69068629529669, -85.35251687092985, 17.272176177343358, 20.985408776295273, -123.60327534224209, -26.924428386122933, -107.18623480449361, -229.63266161911145, -50.77616707797269, -3.1234803481720195, -40.342419362307446, -10.979191479883205, -153.13012977282608, -243.6689747126896, -76.4819656461798, -27.108550176390587, 44.90269517810041, -132.35363865012027, -24.725362875694465, -51.58880304393257, 17.37408578255473, 4.308447951389011, -59.85545698231584, -59.47031718911569, 113.15097703741671, -46.60746271286499, -72.54845761664758, 3.7115335817051798, -166.02322268045262, 58.98611767818282, 13.038512259107987, -98.63171509244452, -82.03911143377643, -118.94709531636477, 75.83793114732435, -91.24177219043915, -88.73512963042742, -56.17025791429689, -39.56333002060874, -140.60255172659228, -3.2692511135901583, 36.230541772702765, -91.81708431064361, 99.99829669725997, 12.76812456019829, 2.02595802994324, -46.824298124417076, 61.58060875333528, -24.337038768312986, 71.6382072095104, 22.111043546158236, -1.2565760763452918, -19.413157408888488, 56.799530803492466, -49.2062071234247, 13.194976428112135, -53.869523109986694, -175.53580906470881, 19.855694835686315, -115.18931905752075, -17.968712751831692, -203.0237443278861, -128.49114355293347, 14.853899914196433, 17.352956130948836, 51.56322913912115, -83.92162291606573, -34.31415580188616, 21.33471778120229, 3.455910994259404, 43.75861809563525, 79.73005390833947, 6.1609476756070425, 54.70618159595736, 113.96039836965161, 65.27146221943934, 131.51226501050587, -41.976328033139815, -56.49520913720147, -63.823076316652504, -86.12831386446648, -43.56863591247924, 34.49685506207849, -124.35164239817806, -64.26429799332246, -28.439815267321507, -23.286838583129853, -21.96807944714893, -40.679264677365715, -28.315746689553617, 19.036530727473288, 100.60445103922066, 93.95948468700006, -17.3539050653527, -42.363891848214244, -257.0837673812338, 13.238403110812213, -75.22652386048706, -46.044170224818444, -92.96180154819761, -137.46267445322206, -124.88504406400472, 20.000000000000014, 87.24534508792145, -37.92066018609589, 14.33126417861821, -29.068206818732122, 17.64878278982229, -35.214623565204555, 21.82728563610351, 73.32615023214933, 14.001843419349926, -40.1731423522161, 34.188473299198584, 17.678351272734066, -216.58052183547332, 16.335458885297935, -11.582834179695753, -31.320310706564626, 11.04880326674773, 64.68011552474125, -29.084218916637752, -69.08002073667981, 0.036968160250790305, -260.93712004490055, 78.83165166190263, 23.59935545410339, -6.680256492997254, -96.28958754172231, -18.753720074833517, -179.1320525503806, -183.5501478321119, 50.92608573158142, -22.23247988681951, 72.44549514028613, 81.1444377348577, -63.40544787560758, 69.09522468793128, -99.20482392032969, 107.43564532154633, 33.60065833062851, 3.173199014734102, 47.77015766444136, 63.410669433834734, -0.09725975652748992, -29.370413343825184, -0.8587661226160759, -127.8200046802631, 5.155306730925108, 2.076677565993454, -67.55634745612826, 19.856533533781576, -96.80356254790614, 23.270540154519175, 10.348336900139635, 80.40662156043672, -62.1768708130844, 38.87172354408262, 164.68633309026615, -111.37439679402746, 4.480475364455824, -77.7198006043432, 61.82326823853593, 61.332424814150855, 41.480764415778275, 43.89893025487979, -234.57811791244555, 90.1076539705212, 8.44259909758854, 71.7548559777733, -137.75509671102378, -41.634400233269744, 2.511747135904623, -43.1968935937545, 147.85051912114227, -10.556060676778015, 64.23737767490917, 146.19128729087961, -9.819086702486459, 47.6390118978101, -91.4438079343946, -319.73036299913355, -54.137633885673985, 89.58217936503817, -154.6608809013979, 104.47895037442876], "policy_predator_policy_reward": [78.2836761696106, 39.89335882555202, 12.687696577194444, 40.42114053353096, 191.28635198393226, 168.38998973402232, 192.87975263328036, 335.0199890983463, 28.682567771627564, 99.71532466027242, 206.71898829944877, 113.87346696585142, 63.62150774795101, 50.43891645902837, 50.89147021376934, 125.73284578578397, 7.100122587054905, 11.042292459306559, 161.19016971281965, 31.193291840002832, 248.98111542393508, 171.899494011663, 31.02729301642178, 60.38279565643761, 119.04241936230719, 91.979191479883, 337.7096015114182, 97.77484405116465, 161.24393445887534, 25.9465813636942, 26.69730482189964, 142.8536386501197, 127.02536287569436, 82.68880304393272, 36.7596321207351, 70.15742308262709, 138.25545698231548, 74.9703171891153, 12.1490229625833, 92.60746271286507, 89.048457616647, 16.888466418294794, 235.42715887915276, 6.415714132108872, 70.16148774089207, 125.73171509244388, 127.41933682776643, 143.19841942815614, 76.55755952599657, 95.94628151711773, 77.48526529497279, 78.55460839389825, 223.3909735439278, 56.96154164283097, 66.45524841807743, 43.28346092281017, 107.34301719191724, 33.37488412923134, 0.9518919482910753, 39.87627528959584, 65.02429812441729, 14.719391246664781, 50.3900643792644, 40.90876717953833, 44.8028704212104, 3.042662108976712, 62.648605349053696, 47.34390118725343, 101.48969316307756, 22.11826190059052, 100.66952310998668, 208.5358090647087, 155.197220030302, 100.43319244087263, 34.76871275183194, 222.72374432788584, 141.20838228308358, 126.29841431208915, 33.947043869051306, 55.73677086087888, 76.64466965410806, 102.55235861641822, 2.065282218797759, 51.04408900574059, 25.241381904364847, 56.26994609166043, 41.781520071850636, 27.076206055696346, 41.960805746446766, 19.300193976064396, 79.96323889517004, 47.495555725772405, 128.4348825029554, 91.18956391117771, 98.82831386446581, 59.16863591247923, 16.023616635942297, 152.14859317966375, 83.21215614263626, 193.96629932609582, 60.43933950267715, 29.947811574635445, 102.35633627212323, 23.92310320682556, 11.663469272526708, 15.795548960779222, 24.4405153129997, 34.75390506535293, 132.24840347650562, 251.9515118775701, 86.3681258757977, 46.27986956528435, 36.66375193589199, 187.16100744437296, 207.04165918673817, 165.28609815385474, 0.0, 7.554654912078547, 25.336934741625146, 130.3559654317891, 64.97287734288525, 45.44379044044648, 100.99107638278093, 15.30757899155924, 35.86951192923111, 11.27176906752305, 68.3697495959266, 8.714919457091218, 49.92969197030307, 231.07247859243603, 43.19184442064601, 122.65514219761745, 111.42031070656463, 81.73862468966888, 109.13101167906355, 58.381449682989775, 118.89700717830507, 42.31524754022073, 274.5043409357289, 2.892515533562998, 32.1006445458968, 68.88025649299732, 128.90330709666847, 124.32224692031873, 158.71495980423524, 234.75794903729366, 15.032524608384163, 57.689155710010894, 35.434345871558776, 3.575721253296935, 80.83158555877917, 38.59643799951766, 112.65076963346173, 43.974951368533304, 9.799341669371518, 21.42680098526587, 10.956083160649765, 81.45572149774311, 27.897259756527497, 83.07041334382518, 9.648403489827638, 158.50503473240457, 13.744693269074858, 101.0233224340066, 93.59966040415202, 108.90193843837514, 167.5035625479058, 27.747966173767878, 22.35166309986041, 6.593378439562596, 106.17846986880728, 40.02667740019387, 65.58141262976274, 92.4073584297172, 14.719524635544142, 134.11980060434294, 17.720190525267817, 62.29536837078171, 21.219235584221916, 11.201069745120392, 244.17811791244523, 44.192346029478685, 42.43529244986983, 53.16240960603119, 63.03830480284067, 144.05119214145293, 16.18825286409534, 76.99689359375434, 5.649480878857692, 29.056060676778166, 12.162622325090801, 26.70871270912042, 132.19380205431318, 16.25405663456651, 104.54380793439398, 325.9303629991343, 75.18686708595469, 41.26858743468103, 193.05557975176526, 23.90944516529011]}, "sampler_perf": {"mean_raw_obs_processing_ms": 4.474433922330599, "mean_inference_ms": 3.6240795461027413, "mean_action_processing_ms": 1.5975979148769324, "mean_env_wait_ms": 1.1547718778867202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003935694694519043, "StateBufferConnector_ms": 0.018645524978637695, "ViewRequirementAgentConnector_ms": 0.13423216342926025}, "num_episodes": 0, "episode_return_max": 249.29999999999976, "episode_return_min": 11.134486144146598, "episode_return_mean": 113.53428557988458, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 64.11647342542729, "num_env_steps_trained_throughput_per_sec": 64.11647342542729, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 43649.703, "restore_workers_time_ms": 0.032, "training_step_time_ms": 43649.524, "sample_time_ms": 1677.881, "learn_time_ms": 40503.97, "learn_throughput": 197.512, "synch_weights_time_ms": 1334.647}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 7, "trial_id": "cdf01_00000", "date": "2024-08-20_10-26-26", "timestamp": 1724129786, "time_this_iter_s": 129.70162200927734, "time_total_s": 310.65761637687683, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5292ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 310.65761637687683, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 82.13157894736842, "ram_util_percent": 83.77543859649121}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 303.6086147789987, "episode_reward_min": 7.797628076460489, "episode_reward_mean": 104.5832593051645, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -356.6089311182715, "predator_policy": 1.0834286169457368}, "policy_reward_max": {"prey_policy": 178.82635607979822, "predator_policy": 360.1856395922119}, "policy_reward_mean": {"prey_policy": -59.851329129919165, "predator_policy": 112.14295878250141}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.790708459037557, 101.41528616315519, 192.59999999999903, 125.11780037062078, 164.85654240321168, 68.00000000000018, 203.59263175666862, 81.50000000000003, 39.4746674193533, 121.99999999999972, 154.80178492018067, 121.7185063282863, 119.69999999999871, 122.89999999999978, 211.30070735571866, 75.59999999999971, 203.17125194873634, 117.79999999999846, 143.89999999999958, 175.79515713126258, 27.700000000000102, 52.500000000000206, 171.99999999999946, 249.29999999999976, 186.26778388420252, 19.30000000000001, 151.89999999999952, 166.78309439008618, 124.60734452994922, 64.70369025652987, 70.9140373421458, 89.63087891743533, 86.40000000000013, 115.49096358562059, 51.972334703109624, 49.72043597469394, 141.09444921626203, 128.60049636526924, 7.797628076460489, 126.89786930134107, 189.51475220484028, 36.9097153137074, 55.903788862942264, 215.7231845686572, 117.90146010272706, 61.800000000000175, 71.04334681777325, 66.59520460143253, 55.20000000000023, 112.94887264125117, 115.92591194971996, 196.7698342709188, 81.32761277567039, 120.01180628389633, 113.703498643395, 85.5999999999998, 59.97666940672473, 39.40000000000016, 37.10790533589471, 34.300000000000225, 37.37589090604171, 77.0587829326253, 160.65471515661565, 63.56639072033001, 42.68354521824107, 32.20288885184667, 252.4999999999993, 132.20164207785663, 170.1999999999995, 9.485251134230854, 37.90000000000013, 160.64576783797023, 69.4933794858983, 149.49999999999963, 53.40172616890727, 33.114077160850876, 22.899999999999977, 103.37215537707891, 145.3999999999996, 70.09252842905806, 126.23952411031561, 102.62843552456364, 65.51568945151737, 303.6086147789987, 45.00000000000039, 136.7057035249798, 113.94348310570703, 82.80000000000003, 68.79396490060822, 125.68731850704114, 61.82757769611523, 117.0125948539122, 206.99999999999935, 71.07407823852301, 133.84495840593823, 54.0367535203286, 23.87663808798562, 89.29306168024252, 61.95403798784045, 116.45514010539941], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-179.1320525503806, -183.5501478321119, 50.92608573158142, -22.23247988681951, 72.44549514028613, 81.1444377348577, -63.40544787560758, 69.09522468793128, -99.20482392032969, 107.43564532154633, 33.60065833062851, 3.173199014734102, 47.77015766444136, 63.410669433834734, -0.09725975652748992, -29.370413343825184, -0.8587661226160759, -127.8200046802631, 5.155306730925108, 2.076677565993454, -67.55634745612826, 19.856533533781576, -96.80356254790614, 23.270540154519175, 10.348336900139635, 80.40662156043672, -62.1768708130844, 38.87172354408262, 164.68633309026615, -111.37439679402746, 4.480475364455824, -77.7198006043432, 61.82326823853593, 61.332424814150855, 41.480764415778275, 43.89893025487979, -234.57811791244555, 90.1076539705212, 8.44259909758854, 71.7548559777733, -137.75509671102378, -41.634400233269744, 2.511747135904623, -43.1968935937545, 147.85051912114227, -10.556060676778015, 64.23737767490917, 146.19128729087961, -9.819086702486459, 47.6390118978101, -91.4438079343946, -319.73036299913355, -54.137633885673985, 89.58217936503817, -154.6608809013979, 104.47895037442876, -130.94538381740853, -68.01239673694865, -16.021381449767468, -201.01580467441244, -60.62414590428601, -262.7969935462307, 42.8138382577975, -147.863841015652, -96.28750873691675, -110.3353203127102, -167.34742387916253, 79.63606509313962, -273.8378349587138, -58.53224498108428, -74.13536697524466, -165.97904681486136, 34.8778222398177, -33.81730698024321, -131.12566409977944, 3.680922151134478, -356.6089311182715, -60.352309368821835, -240.9364742038289, -14.03613915445294, 135.3929415098099, -126.98076163535366, -97.66237463033919, -169.12717150370656, -42.41161302892006, -66.99357001381267, 46.332775481389604, 81.22958249010793, 5.042190737620064, -32.03009728637812, 21.779814896170123, -92.25677802155668, -105.71124670537618, -144.71026821818407, 14.448400210063967, -98.90024470744551, -44.87668603538329, 19.182911621249108, -166.77281294363712, -75.31551226509649, -79.86980665408699, -109.36463479402964, 144.99780673511705, -44.76282129512399, -83.00703797419865, -78.12363931835719, 70.21906423017175, -55.708730859496356, -87.41562322461571, 40.765735520877165, -31.16544422463106, -33.42653157668315, -78.01991932057197, -220.50828152698787, -214.19236869817516, 1.6042722243884269, -275.34587680369106, -13.572574690113195, -6.627180879860866, -39.825442695591065, -58.293380517440184, -153.92229973768636, 4.709009525953687, -144.03120308086253, -287.1061335683272, 88.01682961246144, -276.76360714330013, -265.46910945697164, -215.9502211534791, -66.60642682715338, -268.2908290653232, -72.7964460196048, 16.580935610558974, 178.82635607979822, 39.83926421367166, -136.8266421501593, -35.238665367888906, 132.34435776712945, -212.9660921016756, -108.51637037368543, -88.37902747728853, -69.674258410665, -183.42124362689728, 69.6941661023676, -151.05380230471997, -274.5741899299696, -102.6527419425584, -38.84163949031132, -182.23730496370538, -112.49519833403575, -28.389482609696465, -247.1737012180231, -188.5606521124897, -205.45883979300297, -185.96586193247995, 51.342427084104926, 123.11670421870946, 1.224551472821149, 7.669643457281125, -123.53450981628865, -276.49159005095584, -10.559003834856535, -112.7966598620979, -158.2235895634366, -81.41242866601831, -270.9520000877687, 168.78703064981462, 30.029216134505972, 21.291730709871295, -24.278336645526423, 43.2514510390258, -135.07596452224576, -58.6657615365917, -176.76987194297467, -112.5121451800021, -33.53226098767427, -131.170105128518, -96.70397647713459, -208.45587001647112, 60.659254823423844, 0.056041099280305984, -305.9318894968549, -137.5140482213597, -17.105487948189804, 123.6938012188869, 56.37117787177278, -237.440142931253, -72.23462073410425, -90.6933805183368, -38.78785404806865, 17.595409273343957, -81.88085280708935, -131.27412068148442, -133.84585745206653, -13.1602005496104, -143.6353860429619, -123.80695824858586, -194.21714029930357, -20.525997369585898, -87.90035010990725], "policy_predator_policy_reward": [158.71495980423524, 234.75794903729366, 15.032524608384163, 57.689155710010894, 35.434345871558776, 3.575721253296935, 80.83158555877917, 38.59643799951766, 112.65076963346173, 43.974951368533304, 9.799341669371518, 21.42680098526587, 10.956083160649765, 81.45572149774311, 27.897259756527497, 83.07041334382518, 9.648403489827638, 158.50503473240457, 13.744693269074858, 101.0233224340066, 93.59966040415202, 108.90193843837514, 167.5035625479058, 27.747966173767878, 22.35166309986041, 6.593378439562596, 106.17846986880728, 40.02667740019387, 65.58141262976274, 92.4073584297172, 14.719524635544142, 134.11980060434294, 17.720190525267817, 62.29536837078171, 21.219235584221916, 11.201069745120392, 244.17811791244523, 44.192346029478685, 42.43529244986983, 53.16240960603119, 63.03830480284067, 144.05119214145293, 16.18825286409534, 76.99689359375434, 5.649480878857692, 29.056060676778166, 12.162622325090801, 26.70871270912042, 132.19380205431318, 16.25405663456651, 104.54380793439398, 325.9303629991343, 75.18686708595469, 41.26858743468103, 193.05557975176526, 23.90944516529011, 177.56810639143012, 145.99701869287586, 190.4659571242846, 91.27491925642487, 201.82999379083248, 192.50518300182947, 15.055153456762497, 179.6257282185272, 215.45145998515088, 77.5713690644755, 163.1945008656339, 40.00782150600917, 303.23783495871396, 81.10457968419333, 76.65038566998568, 213.18446409481396, 13.845314229952304, 126.18861972673626, 254.9618096969684, 1.0834286169457368, 360.1856395922119, 64.57322897134229, 253.13647420382856, 128.73400845579425, 15.084353581535474, 166.01821874884843, 88.49847134383417, 215.20079010391876, 79.5990224890352, 85.70994941663884, 61.03922489657084, 27.12160170058898, 44.560862028026584, 100.32850462345883, 62.96506150190927, 69.31190162347745, 166.96004875136944, 154.5048129899637, 38.41968271816995, 112.62736638064382, 68.57668603538319, 12.317088378750904, 195.68598886246764, 159.35120898751723, 208.6934390840874, 96.46691431374909, 43.365121409700336, 53.169727421226426, 95.4940960742049, 146.96419399402035, 42.76127318007661, 62.74019973314543, 113.63192355411732, 46.721462793016514, 114.01915712556053, 36.17281867575383, 157.72587798606986, 200.77899226821467, 228.49236869817506, 23.4957277756116, 297.6098057729993, 28.41655105669916, 24.727180879860942, 56.02544269559129, 80.05982350249668, 169.53174765867115, 183.21720130881812, 33.16377517871633, 269.30412033296716, 90.43989877951515, 291.66360714330074, 314.1355001773014, 79.32820545841899, 245.91198774045412, 123.33254691517004, 249.95761702160394, 46.61906438944099, 10.473643920201788, 69.69706621284907, 159.4919538014953, 52.23866536788915, 20.85564223287058, 114.17135973990435, 216.79635386968658, 10.445269079474043, 185.50801680847903, 162.2208029697667, 112.15204239273368, 198.94718233660407, 296.174189383984, 188.7527419425582, 102.24163949031086, 199.4538778855854, 148.6803515810621, 198.13991442278962, 110.53734656578042, 200.76065211248942, 216.15883979300278, 203.49194448864716, 34.50364573680754, 3.683295781290547, 17.375448527178808, 2.278293368206654, 183.6791014198587, 240.91744579706014, 172.37267219906798, 339.6694009537751, 33.97928399632296, 263.9418278863917, 153.93829031891198, 64.41751080964048, 40.37485718503754, 2.00802310465231, 45.97858283100305, 53.78427167170819, 174.7459453364917, 116.87505823768646, 232.5040583475876, 173.4121451800019, 55.432260987674525, 154.87010512851762, 141.79794137774283, 233.37038519462877, 40.11354850546087, 43.56430332767075, 324.13912276601883, 49.298084232568904, 222.33404679089298, 17.183275893101115, 9.751745016239392, 167.37899013175135, 213.36985177212838, 146.9725533578841, 116.3536396144605, 62.1775403238759, 56.14465673019717, 236.31527359674, 52.68134262479573, 26.464085746783397, 219.6245625260319, 202.053215994832, 177.92492054089752, 80.66796697645525, 144.2135206084376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.468191042759615, "mean_inference_ms": 5.380738533267808, "mean_action_processing_ms": 79.68876746131983, "mean_env_wait_ms": 1.7390473875160075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005145430564880371, "StateBufferConnector_ms": 0.024428248405456543, "ViewRequirementAgentConnector_ms": 0.14155101776123047}, "num_episodes": 72, "episode_return_max": 303.6086147789987, "episode_return_min": 7.797628076460489, "episode_return_mean": 104.5832593051645, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 45912.36, "restore_workers_time_ms": 5.001, "training_step_time_ms": 45886.063, "sample_time_ms": 9154.785, "learn_time_ms": 40503.97, "learn_throughput": 197.512, "synch_weights_time_ms": 1334.647}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 8, "trial_id": "cdf01_00000", "date": "2024-08-20_10-28-16", "timestamp": 1724129896, "time_this_iter_s": 104.89932799339294, "time_total_s": 415.5569443702698, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317ed2160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 415.5569443702698, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 60.13506493506493, "ram_util_percent": 84.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2523278818244026, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 4.0867309350816035, "policy_loss": -0.009590982432876314, "vf_loss": 4.09588067418053, "vf_explained_var": 0.12093696452322461, "kl": 0.008825113314866672, "entropy": 1.402989929630643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7231666905066323, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 7.424851415270851, "policy_loss": -0.00795310560192558, "vf_loss": 7.4324319256676565, "vf_explained_var": 0.06649751019856287, "kl": 0.00745203554841405, "entropy": 1.4514792336357965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 303.6086147789987, "episode_reward_min": 7.797628076460489, "episode_reward_mean": 104.23458161366601, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -356.6089311182715, "predator_policy": 1.0834286169457368}, "policy_reward_max": {"prey_policy": 178.82635607979822, "predator_policy": 360.1856395922119}, "policy_reward_mean": {"prey_policy": -65.4230653732638, "predator_policy": 117.54035618009682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.4746674193533, 121.99999999999972, 154.80178492018067, 121.7185063282863, 119.69999999999871, 122.89999999999978, 211.30070735571866, 75.59999999999971, 203.17125194873634, 117.79999999999846, 143.89999999999958, 175.79515713126258, 27.700000000000102, 52.500000000000206, 171.99999999999946, 249.29999999999976, 186.26778388420252, 19.30000000000001, 151.89999999999952, 166.78309439008618, 124.60734452994922, 64.70369025652987, 70.9140373421458, 89.63087891743533, 86.40000000000013, 115.49096358562059, 51.972334703109624, 49.72043597469394, 141.09444921626203, 128.60049636526924, 7.797628076460489, 126.89786930134107, 189.51475220484028, 36.9097153137074, 55.903788862942264, 215.7231845686572, 117.90146010272706, 61.800000000000175, 71.04334681777325, 66.59520460143253, 55.20000000000023, 112.94887264125117, 115.92591194971996, 196.7698342709188, 81.32761277567039, 120.01180628389633, 113.703498643395, 85.5999999999998, 59.97666940672473, 39.40000000000016, 37.10790533589471, 34.300000000000225, 37.37589090604171, 77.0587829326253, 160.65471515661565, 63.56639072033001, 42.68354521824107, 32.20288885184667, 252.4999999999993, 132.20164207785663, 170.1999999999995, 9.485251134230854, 37.90000000000013, 160.64576783797023, 69.4933794858983, 149.49999999999963, 53.40172616890727, 33.114077160850876, 22.899999999999977, 103.37215537707891, 145.3999999999996, 70.09252842905806, 126.23952411031561, 102.62843552456364, 65.51568945151737, 303.6086147789987, 45.00000000000039, 136.7057035249798, 113.94348310570703, 82.80000000000003, 68.79396490060822, 125.68731850704114, 61.82757769611523, 117.0125948539122, 206.99999999999935, 71.07407823852301, 133.84495840593823, 54.0367535203286, 23.87663808798562, 89.29306168024252, 61.95403798784045, 116.45514010539941, 94.55555459107231, 134.80825502311, 111.2999999999991, 212.1571547935248, 125.29999999999978, 109.21270690942262, 69.7445222992459, 75.92700638647123], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-0.8587661226160759, -127.8200046802631, 5.155306730925108, 2.076677565993454, -67.55634745612826, 19.856533533781576, -96.80356254790614, 23.270540154519175, 10.348336900139635, 80.40662156043672, -62.1768708130844, 38.87172354408262, 164.68633309026615, -111.37439679402746, 4.480475364455824, -77.7198006043432, 61.82326823853593, 61.332424814150855, 41.480764415778275, 43.89893025487979, -234.57811791244555, 90.1076539705212, 8.44259909758854, 71.7548559777733, -137.75509671102378, -41.634400233269744, 2.511747135904623, -43.1968935937545, 147.85051912114227, -10.556060676778015, 64.23737767490917, 146.19128729087961, -9.819086702486459, 47.6390118978101, -91.4438079343946, -319.73036299913355, -54.137633885673985, 89.58217936503817, -154.6608809013979, 104.47895037442876, -130.94538381740853, -68.01239673694865, -16.021381449767468, -201.01580467441244, -60.62414590428601, -262.7969935462307, 42.8138382577975, -147.863841015652, -96.28750873691675, -110.3353203127102, -167.34742387916253, 79.63606509313962, -273.8378349587138, -58.53224498108428, -74.13536697524466, -165.97904681486136, 34.8778222398177, -33.81730698024321, -131.12566409977944, 3.680922151134478, -356.6089311182715, -60.352309368821835, -240.9364742038289, -14.03613915445294, 135.3929415098099, -126.98076163535366, -97.66237463033919, -169.12717150370656, -42.41161302892006, -66.99357001381267, 46.332775481389604, 81.22958249010793, 5.042190737620064, -32.03009728637812, 21.779814896170123, -92.25677802155668, -105.71124670537618, -144.71026821818407, 14.448400210063967, -98.90024470744551, -44.87668603538329, 19.182911621249108, -166.77281294363712, -75.31551226509649, -79.86980665408699, -109.36463479402964, 144.99780673511705, -44.76282129512399, -83.00703797419865, -78.12363931835719, 70.21906423017175, -55.708730859496356, -87.41562322461571, 40.765735520877165, -31.16544422463106, -33.42653157668315, -78.01991932057197, -220.50828152698787, -214.19236869817516, 1.6042722243884269, -275.34587680369106, -13.572574690113195, -6.627180879860866, -39.825442695591065, -58.293380517440184, -153.92229973768636, 4.709009525953687, -144.03120308086253, -287.1061335683272, 88.01682961246144, -276.76360714330013, -265.46910945697164, -215.9502211534791, -66.60642682715338, -268.2908290653232, -72.7964460196048, 16.580935610558974, 178.82635607979822, 39.83926421367166, -136.8266421501593, -35.238665367888906, 132.34435776712945, -212.9660921016756, -108.51637037368543, -88.37902747728853, -69.674258410665, -183.42124362689728, 69.6941661023676, -151.05380230471997, -274.5741899299696, -102.6527419425584, -38.84163949031132, -182.23730496370538, -112.49519833403575, -28.389482609696465, -247.1737012180231, -188.5606521124897, -205.45883979300297, -185.96586193247995, 51.342427084104926, 123.11670421870946, 1.224551472821149, 7.669643457281125, -123.53450981628865, -276.49159005095584, -10.559003834856535, -112.7966598620979, -158.2235895634366, -81.41242866601831, -270.9520000877687, 168.78703064981462, 30.029216134505972, 21.291730709871295, -24.278336645526423, 43.2514510390258, -135.07596452224576, -58.6657615365917, -176.76987194297467, -112.5121451800021, -33.53226098767427, -131.170105128518, -96.70397647713459, -208.45587001647112, 60.659254823423844, 0.056041099280305984, -305.9318894968549, -137.5140482213597, -17.105487948189804, 123.6938012188869, 56.37117787177278, -237.440142931253, -72.23462073410425, -90.6933805183368, -38.78785404806865, 17.595409273343957, -81.88085280708935, -131.27412068148442, -133.84585745206653, -13.1602005496104, -143.6353860429619, -123.80695824858586, -194.21714029930357, -20.525997369585898, -87.90035010990725, -19.772529722032232, -290.25814388154305, -82.792197769874, -39.97311021514635, -107.02683410121435, -21.66926055246342, -45.401622307454986, 19.940806034243014, -54.017397531812065, -40.168213934714444, -25.265997670687174, -85.18182602008099, -138.70215328205364, -52.021927749816186, 18.61293213916798, -198.64082420920383], "policy_predator_policy_reward": [9.648403489827638, 158.50503473240457, 13.744693269074858, 101.0233224340066, 93.59966040415202, 108.90193843837514, 167.5035625479058, 27.747966173767878, 22.35166309986041, 6.593378439562596, 106.17846986880728, 40.02667740019387, 65.58141262976274, 92.4073584297172, 14.719524635544142, 134.11980060434294, 17.720190525267817, 62.29536837078171, 21.219235584221916, 11.201069745120392, 244.17811791244523, 44.192346029478685, 42.43529244986983, 53.16240960603119, 63.03830480284067, 144.05119214145293, 16.18825286409534, 76.99689359375434, 5.649480878857692, 29.056060676778166, 12.162622325090801, 26.70871270912042, 132.19380205431318, 16.25405663456651, 104.54380793439398, 325.9303629991343, 75.18686708595469, 41.26858743468103, 193.05557975176526, 23.90944516529011, 177.56810639143012, 145.99701869287586, 190.4659571242846, 91.27491925642487, 201.82999379083248, 192.50518300182947, 15.055153456762497, 179.6257282185272, 215.45145998515088, 77.5713690644755, 163.1945008656339, 40.00782150600917, 303.23783495871396, 81.10457968419333, 76.65038566998568, 213.18446409481396, 13.845314229952304, 126.18861972673626, 254.9618096969684, 1.0834286169457368, 360.1856395922119, 64.57322897134229, 253.13647420382856, 128.73400845579425, 15.084353581535474, 166.01821874884843, 88.49847134383417, 215.20079010391876, 79.5990224890352, 85.70994941663884, 61.03922489657084, 27.12160170058898, 44.560862028026584, 100.32850462345883, 62.96506150190927, 69.31190162347745, 166.96004875136944, 154.5048129899637, 38.41968271816995, 112.62736638064382, 68.57668603538319, 12.317088378750904, 195.68598886246764, 159.35120898751723, 208.6934390840874, 96.46691431374909, 43.365121409700336, 53.169727421226426, 95.4940960742049, 146.96419399402035, 42.76127318007661, 62.74019973314543, 113.63192355411732, 46.721462793016514, 114.01915712556053, 36.17281867575383, 157.72587798606986, 200.77899226821467, 228.49236869817506, 23.4957277756116, 297.6098057729993, 28.41655105669916, 24.727180879860942, 56.02544269559129, 80.05982350249668, 169.53174765867115, 183.21720130881812, 33.16377517871633, 269.30412033296716, 90.43989877951515, 291.66360714330074, 314.1355001773014, 79.32820545841899, 245.91198774045412, 123.33254691517004, 249.95761702160394, 46.61906438944099, 10.473643920201788, 69.69706621284907, 159.4919538014953, 52.23866536788915, 20.85564223287058, 114.17135973990435, 216.79635386968658, 10.445269079474043, 185.50801680847903, 162.2208029697667, 112.15204239273368, 198.94718233660407, 296.174189383984, 188.7527419425582, 102.24163949031086, 199.4538778855854, 148.6803515810621, 198.13991442278962, 110.53734656578042, 200.76065211248942, 216.15883979300278, 203.49194448864716, 34.50364573680754, 3.683295781290547, 17.375448527178808, 2.278293368206654, 183.6791014198587, 240.91744579706014, 172.37267219906798, 339.6694009537751, 33.97928399632296, 263.9418278863917, 153.93829031891198, 64.41751080964048, 40.37485718503754, 2.00802310465231, 45.97858283100305, 53.78427167170819, 174.7459453364917, 116.87505823768646, 232.5040583475876, 173.4121451800019, 55.432260987674525, 154.87010512851762, 141.79794137774283, 233.37038519462877, 40.11354850546087, 43.56430332767075, 324.13912276601883, 49.298084232568904, 222.33404679089298, 17.183275893101115, 9.751745016239392, 167.37899013175135, 213.36985177212838, 146.9725533578841, 116.3536396144605, 62.1775403238759, 56.14465673019717, 236.31527359674, 52.68134262479573, 26.464085746783397, 219.6245625260319, 202.053215994832, 177.92492054089752, 80.66796697645525, 144.2135206084376, 139.1500986722446, 265.4361295224028, 131.2830338199643, 126.29052918816551, 142.56349310981176, 97.43260154386527, 223.88571079857954, 13.732260268157312, 73.55166288719067, 145.93394857933558, 175.57051929408132, 44.09001130610997, 77.09513150672288, 183.37347182439197, 37.63628616459538, 218.31861229191202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.030683767968803, "mean_inference_ms": 5.614815610749645, "mean_action_processing_ms": 87.35113171512803, "mean_env_wait_ms": 1.8339217559328527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005469799041748047, "StateBufferConnector_ms": 0.029386043548583984, "ViewRequirementAgentConnector_ms": 0.17045891284942627}, "num_episodes": 8, "episode_return_max": 303.6086147789987, "episode_return_min": 7.797628076460489, "episode_return_mean": 104.23458161366601, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 193.89792132246734, "num_env_steps_trained_throughput_per_sec": 193.89792132246734, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 45396.128, "restore_workers_time_ms": 4.743, "training_step_time_ms": 45371.621, "sample_time_ms": 8835.2, "learn_time_ms": 39809.8, "learn_throughput": 200.956, "synch_weights_time_ms": 1169.782}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 9, "trial_id": "cdf01_00000", "date": "2024-08-20_10-28-58", "timestamp": 1724129938, "time_this_iter_s": 41.316797971725464, "time_total_s": 456.87374234199524, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e8e160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 456.87374234199524, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 66.46499999999999, "ram_util_percent": 83.51666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1890974666864154, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 6.812566966859121, "policy_loss": -0.012333698108393167, "vf_loss": 6.824055199396042, "vf_explained_var": 0.09599498179223802, "kl": 0.016908745814050365, "entropy": 1.1350044952498541, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 5355.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4456495319567029, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 8.143169042799208, "policy_loss": -0.009615611709609983, "vf_loss": 8.152288975791325, "vf_explained_var": 0.05707613854181199, "kl": 0.00991404131009259, "entropy": 1.243259306748708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 5355.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 357.4217219253362, "episode_reward_min": 3.7473633599667475, "episode_reward_mean": 120.05393734330617, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -372.0652235636663, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.6, "predator_policy": 381.0426006750775}, "policy_reward_mean": {"prey_policy": -67.62925781890313, "predator_policy": 127.65622649055621}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.4933794858983, 149.49999999999963, 53.40172616890727, 33.114077160850876, 22.899999999999977, 103.37215537707891, 145.3999999999996, 70.09252842905806, 126.23952411031561, 102.62843552456364, 65.51568945151737, 303.6086147789987, 45.00000000000039, 136.7057035249798, 113.94348310570703, 82.80000000000003, 68.79396490060822, 125.68731850704114, 61.82757769611523, 117.0125948539122, 206.99999999999935, 71.07407823852301, 133.84495840593823, 54.0367535203286, 23.87663808798562, 89.29306168024252, 61.95403798784045, 116.45514010539941, 94.55555459107231, 134.80825502311, 111.2999999999991, 212.1571547935248, 125.29999999999978, 109.21270690942262, 69.7445222992459, 75.92700638647123, 84.29360242609658, 151.19999999999962, 180.4933466715516, 154.2835737394542, 50.74798850715523, 101.90317912270712, 185.44580958787643, 152.56023057631077, 59.65480268833385, 81.52466260999387, 183.8999999999991, 85.2955215524174, 153.90095399026967, 197.82421232642267, 222.45271712710934, 74.79999999999984, 30.200000000000074, 165.8000000000001, 357.4217219253362, 96.42880065505447, 171.43183710239657, 137.99660256326098, 93.89277876616976, 172.13380278081405, 172.2999999999997, 203.50233973607695, 31.50617904338985, 96.10937847607785, 211.18091336872172, 28.196545290727464, 129.99999999999966, 93.69999999999996, 183.19576509745727, 88.6999999999993, 93.22127435733883, 186.39017283774754, 177.4470549029544, 62.67366927097001, 172.3706556197135, 3.7473633599667475, 44.55707926064649, 155.97626000586487, 35.700000000000244, 180.49999999999991, 87.29338919745646, 87.4073552285424, 131.52672192606053, 187.4999999999993, 88.83803437554508, 297.4000000000002, 51.900000000000425, 127.34684143287336, 127.48031226683749, 103.79999999999934, 87.41659143700365, 325.2324397313568, 41.00000000000027, 136.5177095645122, 168.6423293246679, 79.23947463173322, 195.68721643259633, 125.20156670166811, 75.62631562872981, 96.1999999999993], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-151.05380230471997, -274.5741899299696, -102.6527419425584, -38.84163949031132, -182.23730496370538, -112.49519833403575, -28.389482609696465, -247.1737012180231, -188.5606521124897, -205.45883979300297, -185.96586193247995, 51.342427084104926, 123.11670421870946, 1.224551472821149, 7.669643457281125, -123.53450981628865, -276.49159005095584, -10.559003834856535, -112.7966598620979, -158.2235895634366, -81.41242866601831, -270.9520000877687, 168.78703064981462, 30.029216134505972, 21.291730709871295, -24.278336645526423, 43.2514510390258, -135.07596452224576, -58.6657615365917, -176.76987194297467, -112.5121451800021, -33.53226098767427, -131.170105128518, -96.70397647713459, -208.45587001647112, 60.659254823423844, 0.056041099280305984, -305.9318894968549, -137.5140482213597, -17.105487948189804, 123.6938012188869, 56.37117787177278, -237.440142931253, -72.23462073410425, -90.6933805183368, -38.78785404806865, 17.595409273343957, -81.88085280708935, -131.27412068148442, -133.84585745206653, -13.1602005496104, -143.6353860429619, -123.80695824858586, -194.21714029930357, -20.525997369585898, -87.90035010990725, -19.772529722032232, -290.25814388154305, -82.792197769874, -39.97311021514635, -107.02683410121435, -21.66926055246342, -45.401622307454986, 19.940806034243014, -54.017397531812065, -40.168213934714444, -25.265997670687174, -85.18182602008099, -138.70215328205364, -52.021927749816186, 18.61293213916798, -198.64082420920383, -210.67854827897975, 4.504684315416037, -187.92824603974992, 68.41593644227824, 120.34663215237507, -139.43347316660262, 1.778676460141197, -51.411342245205205, -78.60419381646093, -209.11630208007801, -119.77121701726816, -54.0164257301906, -29.972740358011933, 94.42314397108005, -286.4934023068077, -32.19691937215842, -161.7055687055262, -96.6263329083707, -118.16601628135606, -281.96290301438034, 160.92854427397407, -4.747078397956544, -24.5302202033529, -95.2457895703927, -234.12898922136387, 26.63763957902829, 116.92731330988153, -35.308776552374255, 83.53611433052964, 47.517285565164855, -87.6526438885658, 53.98838450854716, -20.1460952411409, -262.9393439077733, -86.82670256790209, 57.031656039808624, 21.568078166698854, 194.6, 23.71419802603752, -188.9853624487015, 38.89200264181676, -61.174324909356876, -136.89188076782983, 45.88404617519194, -79.97159074741776, -196.42260432396452, 92.78760324466461, -198.70884858644777, -61.61122712047317, 79.28509754996884, -277.94506543763373, 110.46849963251906, -171.8872234877449, -175.8373472767032, 30.383948214919055, -87.37697536504918, -370.0193088688482, 70.11891150444372, -117.88886739946946, -190.93075609930588, 40.9582033740743, -6.203352739705354, 23.35122045306266, -25.067850156864758, 25.169750548969844, -149.6509192972143, -76.92102554421635, -155.69146649959768, -83.49979384089342, -120.4889629317862, 72.97297983795713, -67.46618992450195, -22.420621914455005, 73.31200301750226, -254.9629822325797, -37.12473839876784, 113.83900916332806, -217.1120704627918, -267.456331473904, -267.94909933674575, -372.0652235636663, -36.14446538802524, 102.65564311340316, -141.8918419975791, -61.667798146635505, 5.091514868503957, 52.311313955574036, -144.75417778218863, 42.93908305266052, -191.61801909115763, -111.20811905333137, -126.61653898945806, -114.35799729624136, 27.233890277915773, 131.79313131994164, -19.08194165481735, -169.90639089745213, -7.052984832982936, 140.9064837008133, 113.79814400491763, 1.062881216919583, 20.000000000000014, -83.21122953961074, 55.36521490474008, -151.00612891209101, 48.80249207367105, -41.69753109366186, -24.879164028312914, -237.16524338975103, -76.15993247819505, 123.39250145107023, -79.81537079330164, -96.74696858221881, -16.058237233401655, -162.06815111009135, 29.37417437241131, 88.49546869969204, -70.62339425361446, -151.1678087294182, 19.150915302916612, -174.6066000339365, 86.89486112812396, -2.445670186751732, -274.5562299227507, -45.653691687705056, -243.16505433672165, 16.41548001268734, -104.46671813579906], "policy_predator_policy_reward": [198.94718233660407, 296.174189383984, 188.7527419425582, 102.24163949031086, 199.4538778855854, 148.6803515810621, 198.13991442278962, 110.53734656578042, 200.76065211248942, 216.15883979300278, 203.49194448864716, 34.50364573680754, 3.683295781290547, 17.375448527178808, 2.278293368206654, 183.6791014198587, 240.91744579706014, 172.37267219906798, 339.6694009537751, 33.97928399632296, 263.9418278863917, 153.93829031891198, 64.41751080964048, 40.37485718503754, 2.00802310465231, 45.97858283100305, 53.78427167170819, 174.7459453364917, 116.87505823768646, 232.5040583475876, 173.4121451800019, 55.432260987674525, 154.87010512851762, 141.79794137774283, 233.37038519462877, 40.11354850546087, 43.56430332767075, 324.13912276601883, 49.298084232568904, 222.33404679089298, 17.183275893101115, 9.751745016239392, 167.37899013175135, 213.36985177212838, 146.9725533578841, 116.3536396144605, 62.1775403238759, 56.14465673019717, 236.31527359674, 52.68134262479573, 26.464085746783397, 219.6245625260319, 202.053215994832, 177.92492054089752, 80.66796697645525, 144.2135206084376, 139.1500986722446, 265.4361295224028, 131.2830338199643, 126.29052918816551, 142.56349310981176, 97.43260154386527, 223.88571079857954, 13.732260268157312, 73.55166288719067, 145.93394857933558, 175.57051929408132, 44.09001130610997, 77.09513150672288, 183.37347182439197, 37.63628616459538, 218.31861229191202, 179.25875614713155, 111.20871024252871, 208.537794695833, 62.17451490163844, 136.47784927059755, 63.10233841518184, 77.76016600979507, 126.15607351472309, 185.99021429888575, 152.47827010480708, 120.49685138187316, 155.19397048829305, 120.99540597480843, 0.0, 90.20795158019965, 381.0426006750775, 210.68719950788946, 107.29950479434032, 146.5837666856559, 335.06981522007436, 0.9737885918075672, 26.744745532174797, 84.07606333333794, 120.9954679928245, 314.21299897406703, 47.17930465853859, 1.6968990165411473, 114.50877655237407, 45.5532193295124, 45.846097901902596, 95.11557619813838, 13.348683181880503, 41.946095241141045, 271.3393439077752, 139.42670256790186, 56.16834396019145, 109.94193039589886, 31.311713362738338, 189.38117049941513, 72.31879457830378, 112.49042432576243, 81.22373504417429, 177.60657651411046, 51.39786064178852, 148.08275206642483, 222.2042217711274, 36.50043386988289, 241.55461425271426, 84.6497256976982, 69.97640387280597, 268.38434128312406, 102.59456425806847, 362.89182896249275, 16.33892084534464, 8.822602972163674, 144.27980265404426, 246.12404067225947, 264.9572700608668, 131.9173787014471, 205.09879008805535, 65.54179662592577, 29.703352739705466, 53.14877954693748, 42.267850156865, 170.30876885911596, 137.36816498658575, 107.02102554421555, 214.2914664995973, 144.31752471845363, 152.89250641156403, 38.696526708236256, 142.18685621605616, 32.997905937037096, 93.55776786287083, 137.8000604148258, 216.96132948749062, 39.42848002669877, 236.21523689247834, 277.47985258462893, 261.6729415859872, 380.06522356366617, 72.70154464867177, 19.267409709721825, 175.94504918031896, 89.2362535508241, 3.0400297273074157, 50.28868604442599, 222.65417778218847, 30.355592570221148, 205.616732665733, 155.5667326915425, 169.66528057978832, 176.3271483904777, 42.32368055390862, 35.50686868005829, 39.281941654817594, 173.0825293290509, 92.7148807769286, 7.093516299186621, 35.60185599508242, 30.837118783080406, 0.0, 85.55347060476039, 69.63938546298318, 181.35001991840463, 48.33392918685265, 75.69688170179806, 94.67981342017634, 223.03624736572786, 177.705519939221, 162.32260636665222, 119.33270270693625, 119.14696858221839, 34.6582372334019, 92.7903281482209, 176.42135815397137, 91.89232362535014, 58.877931253240625, 113.04987590246827, 98.2064921557661, 179.05307640585747, 104.34587893255116, 110.05946667509262, 292.14400013607826, 230.50522133337176, 133.93984031978405, 43.352681023913505, 140.89855709919755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.58042676367809, "mean_inference_ms": 6.728418420199079, "mean_action_processing_ms": 95.58514240043459, "mean_env_wait_ms": 2.157617960998456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011177301406860352, "StateBufferConnector_ms": 0.05651092529296875, "ViewRequirementAgentConnector_ms": 0.27296602725982666}, "num_episodes": 64, "episode_return_max": 357.4217219253362, "episode_return_min": 3.7473633599667475, "episode_return_mean": 120.05393734330617, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 247.8442338618745, "num_env_steps_trained_throughput_per_sec": 247.8442338618745, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 44084.35, "restore_workers_time_ms": 4.271, "training_step_time_ms": 44062.252, "sample_time_ms": 8097.839, "learn_time_ms": 38805.37, "learn_throughput": 206.157, "synch_weights_time_ms": 1044.008}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 10, "trial_id": "cdf01_00000", "date": "2024-08-20_10-29-31", "timestamp": 1724129971, "time_this_iter_s": 32.30179834365845, "time_total_s": 489.1755406856537, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a529e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 489.1755406856537, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 48.60217391304347, "ram_util_percent": 83.15652173913045}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6096426934476882, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 6.063883648221455, "policy_loss": -0.00866416734717195, "vf_loss": 6.071897253914485, "vf_explained_var": 0.12959070044850546, "kl": 0.013011589746583056, "entropy": 1.1212831794269502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 5985.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5148763695879588, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 7.5296312074812635, "policy_loss": -0.006776422079622982, "vf_loss": 7.536005844388689, "vf_explained_var": 0.06748725090708052, "kl": 0.00803635353636526, "entropy": 1.249935650068616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 5985.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 325.2324397313568, "episode_reward_min": 3.7473633599667475, "episode_reward_mean": 113.17712673924267, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -494.46564633830405, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.2, "predator_policy": 497.0662236764479}, "policy_reward_mean": {"prey_policy": -114.61680928607657, "predator_policy": 171.20537265569794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [177.4470549029544, 62.67366927097001, 172.3706556197135, 3.7473633599667475, 44.55707926064649, 155.97626000586487, 35.700000000000244, 180.49999999999991, 87.29338919745646, 87.4073552285424, 131.52672192606053, 187.4999999999993, 88.83803437554508, 297.4000000000002, 51.900000000000425, 127.34684143287336, 127.48031226683749, 103.79999999999934, 87.41659143700365, 325.2324397313568, 41.00000000000027, 136.5177095645122, 168.6423293246679, 79.23947463173322, 195.68721643259633, 125.20156670166811, 75.62631562872981, 96.1999999999993, 141.28880125590933, 29.060903871057093, 98.06134732595007, 28.891460983781883, 165.00369207417333, 199.95792059714836, 35.36437673509116, 44.329993929057494, 131.53857393930414, 45.94764290315369, 72.09162014279704, 100.1533724894573, 232.04086608961381, 62.93327343661519, 106.93558058924894, 142.6864217786645, 31.628177705986005, 49.69764026501469, 63.806041581483655, 164.50634150200298, 79.49154866445495, 94.83184658195775, 105.34212832360967, 142.02478486610784, 49.66634494645647, 31.06678009143149, 128.5376906039142, 132.099939596012, 8.77398630227338, 145.19375427354265, 55.6678655012614, 113.88271842661555, 81.97138608307716, 53.90107143806574, 178.69999999999973, 160.09999999999954, 41.267531316522735, 151.25329336302056, 41.171572493526426, 139.4999999999996, 159.0971438681653, 145.19999999999965, 63.731782797246105, 116.78801082568023, 65.66250436040053, 144.43890316546137, 319.4000000000009, 140.59999999999994, 76.96076197631315, 142.18611620952194, 145.81714760822777, 74.55114065606709, 89.08543645208474, 132.69999999999993, 272.1689328547976, 25.18042876721072, 49.46632220280198, 172.84861801020546, 79.39988984671403, 44.004371382021546, 115.23823469607399, 79.82366120232959, 134.86589595054772, 20.536878938582916, 229.38203591925193, 229.10109833542276, 42.380593673799154, 155.56823989731177, 149.4999999999994, 73.42112318546171, 139.6999999999993, 154.3107287755085], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.420621914455005, 73.31200301750226, -254.9629822325797, -37.12473839876784, 113.83900916332806, -217.1120704627918, -267.456331473904, -267.94909933674575, -372.0652235636663, -36.14446538802524, 102.65564311340316, -141.8918419975791, -61.667798146635505, 5.091514868503957, 52.311313955574036, -144.75417778218863, 42.93908305266052, -191.61801909115763, -111.20811905333137, -126.61653898945806, -114.35799729624136, 27.233890277915773, 131.79313131994164, -19.08194165481735, -169.90639089745213, -7.052984832982936, 140.9064837008133, 113.79814400491763, 1.062881216919583, 20.000000000000014, -83.21122953961074, 55.36521490474008, -151.00612891209101, 48.80249207367105, -41.69753109366186, -24.879164028312914, -237.16524338975103, -76.15993247819505, 123.39250145107023, -79.81537079330164, -96.74696858221881, -16.058237233401655, -162.06815111009135, 29.37417437241131, 88.49546869969204, -70.62339425361446, -151.1678087294182, 19.150915302916612, -174.6066000339365, 86.89486112812396, -2.445670186751732, -274.5562299227507, -45.653691687705056, -243.16505433672165, 16.41548001268734, -104.46671813579906, -54.88538773014614, -74.71932446214163, -401.5267764526991, -80.04329820983611, -23.885664034318083, -84.4701906196223, -58.185523387645055, -361.68614137605465, -16.923720110384604, -363.1688432482374, 116.74841243919542, 36.131010889649126, -332.81037212734327, -34.96494019219616, -201.488764618637, -182.19256334268584, 63.909850219958244, -365.0790291708364, -225.52459276282565, -306.2820571224968, -494.46564633830405, 55.29843064129801, 46.03638750740718, -427.4231192434228, 70.01871938500723, -313.35757280033374, -374.8637165236328, -180.11441332372937, -217.59113984029165, -402.2717395508761, -242.81405859601563, 57.103923855653896, -294.8143777971645, -89.47024813281159, 26.51981174973917, -362.255828928863, -53.38764249427696, -222.65537824782177, -72.89622387252464, -142.12585852836838, -85.773135459941, -204.90311841671803, -309.2168331780403, -41.82829096885334, -370.83616123085295, -109.53609827170085, 82.72839890248581, -317.54083871205233, -341.7857921353168, 1.3679102283894888, -228.5210111182673, -23.52249851314869, -325.1377433639991, 62.69761185914534, -230.14748499312583, -243.68051533456713, -346.82354401060024, -329.88136122260863, -82.81274235697478, -300.6875273888526, -340.8128149387962, -221.40349508831315, -215.74351209091267, 46.48741942444794, -101.07587699892426, -238.5923080126146, -250.21357036477892, -245.79544944059157, 40.074014286644086, 111.96163212955774, 63.59345491220471, -36.56018036289157, -31.626108387875306, -169.59149017950477, 20.15986708317378, -404.4326283900974, -156.54587341159333, -347.03013897898643, -2.0831579934989986, 48.04832342676559, 93.12633459492682, -141.54925535775635, 28.5356321226637, -96.4285463471524, -276.39117565939085, -154.95921929506312, 36.093207516415085, -13.464202093065644, -331.6227016711472, 2.8328952366895876, -216.56202513371247, 25.054690049013594, 171.2, 141.48129122363596, -300.04007825739666, 125.00449977878783, -182.3799908481287, -292.68990707658656, 43.735103230369, -342.45853231040877, 17.207312126367405, -191.50287840031874, -186.66518921494458, -234.97534672422424, -205.6662195192392, 20.828192216974255, -269.9668777089922, -43.70822194605757, -1.6126687286375514, -44.4130328415755, 4.025834806475734, -453.6597066083411, -440.9439495590625, -37.662832976053195, 73.17345154665506, -330.7411900233156, -379.5341763153901, -35.242681103818626, -159.35086809048877, -342.18755912878487, -103.65725014418771, -87.70677364712621, -455.4702491976197, 69.74882573430467, 65.00144977509228, -241.87409937019663, 10.26735082812422, -409.305258680992, -7.836008736689886, -6.053665351416484, 132.95730931895255, 32.312484313742885, -18.548596024181407, -332.11002566842154, 6.376027027871917, -44.087711586861715, -191.1126206775395, 85.99654127231466, -171.85594518217113, 18.771894808360358, 20.000000000000014, 19.09739983384245, 70.86989819676965, -391.41170868306415], "policy_predator_policy_reward": [32.997905937037096, 93.55776786287083, 137.8000604148258, 216.96132948749062, 39.42848002669877, 236.21523689247834, 277.47985258462893, 261.6729415859872, 380.06522356366617, 72.70154464867177, 19.267409709721825, 175.94504918031896, 89.2362535508241, 3.0400297273074157, 50.28868604442599, 222.65417778218847, 30.355592570221148, 205.616732665733, 155.5667326915425, 169.66528057978832, 176.3271483904777, 42.32368055390862, 35.50686868005829, 39.281941654817594, 173.0825293290509, 92.7148807769286, 7.093516299186621, 35.60185599508242, 30.837118783080406, 0.0, 85.55347060476039, 69.63938546298318, 181.35001991840463, 48.33392918685265, 75.69688170179806, 94.67981342017634, 223.03624736572786, 177.705519939221, 162.32260636665222, 119.33270270693625, 119.14696858221839, 34.6582372334019, 92.7903281482209, 176.42135815397137, 91.89232362535014, 58.877931253240625, 113.04987590246827, 98.2064921557661, 179.05307640585747, 104.34587893255116, 110.05946667509262, 292.14400013607826, 230.50522133337176, 133.93984031978405, 43.352681023913505, 140.89855709919755, 194.47526564502874, 76.41824780316901, 104.4634637933374, 406.1675147402545, 105.80180858754802, 100.61539339234253, 419.08730995600115, 29.675815791479742, 257.42323284055135, 287.673022592244, 25.371733943335865, 21.706763324968982, 350.8747488624343, 52.264940192196406, 214.83652550066063, 213.17479638971952, 319.3007484292188, 113.40700446096386, 346.5714201743488, 231.18287261412686, 497.0662236764479, 14.1926121633561, 50.016984982050054, 431.5231192434228, 249.34974337388903, 226.02997613105285, 378.55487883477343, 239.35652444920376, 318.24041228494, 408.5580476954767, 215.94399512858448, 112.45256139044237, 301.65020218615416, 114.26260144980765, 178.51973687298585, 206.91392057115237, 72.6502972361754, 267.19876508740697, 283.2531846138678, 96.27523928902819, 297.8273913890653, 72.34041115204822, 170.21765358263457, 275.6593171462176, 364.58234964850806, 221.13203817765597, 54.796385963622114, 322.04083871205256, 331.33152551818523, 58.75270133519896, 232.2119389185201, 50.898350804327386, 279.49509457347756, 111.48272753529069, 274.11431519069356, 331.8136247330121, 351.40594537063055, 334.07294616485297, 278.2437425276148, 250.45028149175548, 349.1194315451764, 268.764743983194, 259.6908803181826, 23.44793077489826, 312.29373727632003, 109.34583381829628, 374.02780922829317, 175.88228201514252, 4.725985713355941, 21.938367870442285, 57.806545087795335, 75.26018036289169, 0.0, 242.48512988390215, 147.91958076687428, 387.6064739030697, 187.9016279002884, 356.84595698381736, 24.595435653667394, 68.93939891306593, 32.150063778022194, 175.37000085297234, 102.86436787733626, 110.22854634715162, 327.8855513533467, 167.19662639835238, 41.464194901072176, 52.694810501260775, 337.6432878910106, 56.8090229038467, 262.84565159739225, 73.10058665276878, 0.0, 6.718708776363739, 307.14007825739645, 8.495500221212158, 255.51185290942735, 296.5188069916006, 128.93898126863235, 311.9705640209301, 70.80296201757798, 249.30975186460165, 429.63692715250835, 66.55474944272669, 260.8369826271976, 13.086481127152073, 330.823105844227, 115.55199381082251, 66.01461748587774, 252.18001693913303, 157.28053908414165, 317.53376148493464, 442.0439495590625, 86.02915517885519, 98.67451689054386, 331.74183959632364, 127.00933442206694, 367.1674128438562, 137.58711765740023, 407.95568094389483, 198.33582213338414, 108.26643635400329, 456.77024919762, 8.774835468025419, 278.8415518766725, 32.896993668979775, 358.54113366683754, 61.03365312461298, 123.09866394591032, 120.17304606144843, 25.38388113666473, 38.44742356606312, 95.9242184694958, 297.1149968969062, 66.02631433796543, 127.25361011833695, 212.5299103360707, 42.086169069153556, 23.50566459604155, 202.9995089632307, 1.1009378723396746, 99.50166229381789, 38.06629293452441, 436.7862463272796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.52422299453377, "mean_inference_ms": 6.748447954582181, "mean_action_processing_ms": 83.21095847454873, "mean_env_wait_ms": 2.1142255968210537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00713801383972168, "StateBufferConnector_ms": 0.028292417526245117, "ViewRequirementAgentConnector_ms": 0.1969844102859497}, "num_episodes": 72, "episode_return_max": 325.2324397313568, "episode_return_min": 3.7473633599667475, "episode_return_mean": 113.17712673924267, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 250.80646612812365, "num_env_steps_trained_throughput_per_sec": 250.80646612812365, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 43962.188, "restore_workers_time_ms": 4.276, "training_step_time_ms": 43940.07, "sample_time_ms": 8099.353, "learn_time_ms": 37976.221, "learn_throughput": 210.658, "synch_weights_time_ms": 942.506}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 11, "trial_id": "cdf01_00000", "date": "2024-08-20_10-30-03", "timestamp": 1724130003, "time_this_iter_s": 31.933788061141968, "time_total_s": 521.1093287467957, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a529e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 521.1093287467957, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 44.47111111111111, "ram_util_percent": 83.21555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3066652979169573, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 8.402448997043429, "policy_loss": -0.006950985755963576, "vf_loss": 8.409051942825318, "vf_explained_var": 0.10814684865966676, "kl": 0.0069602149876739116, "entropy": 0.8777823662947095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3530807150734796, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 9.15042067330981, "policy_loss": -0.005030220303507078, "vf_loss": 9.155151141635955, "vf_explained_var": 0.05379125702948798, "kl": 0.005995284369411878, "entropy": 1.1097539689805773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 325.2324397313568, "episode_reward_min": 3.7473633599667475, "episode_reward_mean": 113.17712673924267, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -494.46564633830405, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 171.2, "predator_policy": 497.0662236764479}, "policy_reward_mean": {"prey_policy": -114.61680928607657, "predator_policy": 171.20537265569794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [177.4470549029544, 62.67366927097001, 172.3706556197135, 3.7473633599667475, 44.55707926064649, 155.97626000586487, 35.700000000000244, 180.49999999999991, 87.29338919745646, 87.4073552285424, 131.52672192606053, 187.4999999999993, 88.83803437554508, 297.4000000000002, 51.900000000000425, 127.34684143287336, 127.48031226683749, 103.79999999999934, 87.41659143700365, 325.2324397313568, 41.00000000000027, 136.5177095645122, 168.6423293246679, 79.23947463173322, 195.68721643259633, 125.20156670166811, 75.62631562872981, 96.1999999999993, 141.28880125590933, 29.060903871057093, 98.06134732595007, 28.891460983781883, 165.00369207417333, 199.95792059714836, 35.36437673509116, 44.329993929057494, 131.53857393930414, 45.94764290315369, 72.09162014279704, 100.1533724894573, 232.04086608961381, 62.93327343661519, 106.93558058924894, 142.6864217786645, 31.628177705986005, 49.69764026501469, 63.806041581483655, 164.50634150200298, 79.49154866445495, 94.83184658195775, 105.34212832360967, 142.02478486610784, 49.66634494645647, 31.06678009143149, 128.5376906039142, 132.099939596012, 8.77398630227338, 145.19375427354265, 55.6678655012614, 113.88271842661555, 81.97138608307716, 53.90107143806574, 178.69999999999973, 160.09999999999954, 41.267531316522735, 151.25329336302056, 41.171572493526426, 139.4999999999996, 159.0971438681653, 145.19999999999965, 63.731782797246105, 116.78801082568023, 65.66250436040053, 144.43890316546137, 319.4000000000009, 140.59999999999994, 76.96076197631315, 142.18611620952194, 145.81714760822777, 74.55114065606709, 89.08543645208474, 132.69999999999993, 272.1689328547976, 25.18042876721072, 49.46632220280198, 172.84861801020546, 79.39988984671403, 44.004371382021546, 115.23823469607399, 79.82366120232959, 134.86589595054772, 20.536878938582916, 229.38203591925193, 229.10109833542276, 42.380593673799154, 155.56823989731177, 149.4999999999994, 73.42112318546171, 139.6999999999993, 154.3107287755085], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.420621914455005, 73.31200301750226, -254.9629822325797, -37.12473839876784, 113.83900916332806, -217.1120704627918, -267.456331473904, -267.94909933674575, -372.0652235636663, -36.14446538802524, 102.65564311340316, -141.8918419975791, -61.667798146635505, 5.091514868503957, 52.311313955574036, -144.75417778218863, 42.93908305266052, -191.61801909115763, -111.20811905333137, -126.61653898945806, -114.35799729624136, 27.233890277915773, 131.79313131994164, -19.08194165481735, -169.90639089745213, -7.052984832982936, 140.9064837008133, 113.79814400491763, 1.062881216919583, 20.000000000000014, -83.21122953961074, 55.36521490474008, -151.00612891209101, 48.80249207367105, -41.69753109366186, -24.879164028312914, -237.16524338975103, -76.15993247819505, 123.39250145107023, -79.81537079330164, -96.74696858221881, -16.058237233401655, -162.06815111009135, 29.37417437241131, 88.49546869969204, -70.62339425361446, -151.1678087294182, 19.150915302916612, -174.6066000339365, 86.89486112812396, -2.445670186751732, -274.5562299227507, -45.653691687705056, -243.16505433672165, 16.41548001268734, -104.46671813579906, -54.88538773014614, -74.71932446214163, -401.5267764526991, -80.04329820983611, -23.885664034318083, -84.4701906196223, -58.185523387645055, -361.68614137605465, -16.923720110384604, -363.1688432482374, 116.74841243919542, 36.131010889649126, -332.81037212734327, -34.96494019219616, -201.488764618637, -182.19256334268584, 63.909850219958244, -365.0790291708364, -225.52459276282565, -306.2820571224968, -494.46564633830405, 55.29843064129801, 46.03638750740718, -427.4231192434228, 70.01871938500723, -313.35757280033374, -374.8637165236328, -180.11441332372937, -217.59113984029165, -402.2717395508761, -242.81405859601563, 57.103923855653896, -294.8143777971645, -89.47024813281159, 26.51981174973917, -362.255828928863, -53.38764249427696, -222.65537824782177, -72.89622387252464, -142.12585852836838, -85.773135459941, -204.90311841671803, -309.2168331780403, -41.82829096885334, -370.83616123085295, -109.53609827170085, 82.72839890248581, -317.54083871205233, -341.7857921353168, 1.3679102283894888, -228.5210111182673, -23.52249851314869, -325.1377433639991, 62.69761185914534, -230.14748499312583, -243.68051533456713, -346.82354401060024, -329.88136122260863, -82.81274235697478, -300.6875273888526, -340.8128149387962, -221.40349508831315, -215.74351209091267, 46.48741942444794, -101.07587699892426, -238.5923080126146, -250.21357036477892, -245.79544944059157, 40.074014286644086, 111.96163212955774, 63.59345491220471, -36.56018036289157, -31.626108387875306, -169.59149017950477, 20.15986708317378, -404.4326283900974, -156.54587341159333, -347.03013897898643, -2.0831579934989986, 48.04832342676559, 93.12633459492682, -141.54925535775635, 28.5356321226637, -96.4285463471524, -276.39117565939085, -154.95921929506312, 36.093207516415085, -13.464202093065644, -331.6227016711472, 2.8328952366895876, -216.56202513371247, 25.054690049013594, 171.2, 141.48129122363596, -300.04007825739666, 125.00449977878783, -182.3799908481287, -292.68990707658656, 43.735103230369, -342.45853231040877, 17.207312126367405, -191.50287840031874, -186.66518921494458, -234.97534672422424, -205.6662195192392, 20.828192216974255, -269.9668777089922, -43.70822194605757, -1.6126687286375514, -44.4130328415755, 4.025834806475734, -453.6597066083411, -440.9439495590625, -37.662832976053195, 73.17345154665506, -330.7411900233156, -379.5341763153901, -35.242681103818626, -159.35086809048877, -342.18755912878487, -103.65725014418771, -87.70677364712621, -455.4702491976197, 69.74882573430467, 65.00144977509228, -241.87409937019663, 10.26735082812422, -409.305258680992, -7.836008736689886, -6.053665351416484, 132.95730931895255, 32.312484313742885, -18.548596024181407, -332.11002566842154, 6.376027027871917, -44.087711586861715, -191.1126206775395, 85.99654127231466, -171.85594518217113, 18.771894808360358, 20.000000000000014, 19.09739983384245, 70.86989819676965, -391.41170868306415], "policy_predator_policy_reward": [32.997905937037096, 93.55776786287083, 137.8000604148258, 216.96132948749062, 39.42848002669877, 236.21523689247834, 277.47985258462893, 261.6729415859872, 380.06522356366617, 72.70154464867177, 19.267409709721825, 175.94504918031896, 89.2362535508241, 3.0400297273074157, 50.28868604442599, 222.65417778218847, 30.355592570221148, 205.616732665733, 155.5667326915425, 169.66528057978832, 176.3271483904777, 42.32368055390862, 35.50686868005829, 39.281941654817594, 173.0825293290509, 92.7148807769286, 7.093516299186621, 35.60185599508242, 30.837118783080406, 0.0, 85.55347060476039, 69.63938546298318, 181.35001991840463, 48.33392918685265, 75.69688170179806, 94.67981342017634, 223.03624736572786, 177.705519939221, 162.32260636665222, 119.33270270693625, 119.14696858221839, 34.6582372334019, 92.7903281482209, 176.42135815397137, 91.89232362535014, 58.877931253240625, 113.04987590246827, 98.2064921557661, 179.05307640585747, 104.34587893255116, 110.05946667509262, 292.14400013607826, 230.50522133337176, 133.93984031978405, 43.352681023913505, 140.89855709919755, 194.47526564502874, 76.41824780316901, 104.4634637933374, 406.1675147402545, 105.80180858754802, 100.61539339234253, 419.08730995600115, 29.675815791479742, 257.42323284055135, 287.673022592244, 25.371733943335865, 21.706763324968982, 350.8747488624343, 52.264940192196406, 214.83652550066063, 213.17479638971952, 319.3007484292188, 113.40700446096386, 346.5714201743488, 231.18287261412686, 497.0662236764479, 14.1926121633561, 50.016984982050054, 431.5231192434228, 249.34974337388903, 226.02997613105285, 378.55487883477343, 239.35652444920376, 318.24041228494, 408.5580476954767, 215.94399512858448, 112.45256139044237, 301.65020218615416, 114.26260144980765, 178.51973687298585, 206.91392057115237, 72.6502972361754, 267.19876508740697, 283.2531846138678, 96.27523928902819, 297.8273913890653, 72.34041115204822, 170.21765358263457, 275.6593171462176, 364.58234964850806, 221.13203817765597, 54.796385963622114, 322.04083871205256, 331.33152551818523, 58.75270133519896, 232.2119389185201, 50.898350804327386, 279.49509457347756, 111.48272753529069, 274.11431519069356, 331.8136247330121, 351.40594537063055, 334.07294616485297, 278.2437425276148, 250.45028149175548, 349.1194315451764, 268.764743983194, 259.6908803181826, 23.44793077489826, 312.29373727632003, 109.34583381829628, 374.02780922829317, 175.88228201514252, 4.725985713355941, 21.938367870442285, 57.806545087795335, 75.26018036289169, 0.0, 242.48512988390215, 147.91958076687428, 387.6064739030697, 187.9016279002884, 356.84595698381736, 24.595435653667394, 68.93939891306593, 32.150063778022194, 175.37000085297234, 102.86436787733626, 110.22854634715162, 327.8855513533467, 167.19662639835238, 41.464194901072176, 52.694810501260775, 337.6432878910106, 56.8090229038467, 262.84565159739225, 73.10058665276878, 0.0, 6.718708776363739, 307.14007825739645, 8.495500221212158, 255.51185290942735, 296.5188069916006, 128.93898126863235, 311.9705640209301, 70.80296201757798, 249.30975186460165, 429.63692715250835, 66.55474944272669, 260.8369826271976, 13.086481127152073, 330.823105844227, 115.55199381082251, 66.01461748587774, 252.18001693913303, 157.28053908414165, 317.53376148493464, 442.0439495590625, 86.02915517885519, 98.67451689054386, 331.74183959632364, 127.00933442206694, 367.1674128438562, 137.58711765740023, 407.95568094389483, 198.33582213338414, 108.26643635400329, 456.77024919762, 8.774835468025419, 278.8415518766725, 32.896993668979775, 358.54113366683754, 61.03365312461298, 123.09866394591032, 120.17304606144843, 25.38388113666473, 38.44742356606312, 95.9242184694958, 297.1149968969062, 66.02631433796543, 127.25361011833695, 212.5299103360707, 42.086169069153556, 23.50566459604155, 202.9995089632307, 1.1009378723396746, 99.50166229381789, 38.06629293452441, 436.7862463272796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.52422299453377, "mean_inference_ms": 6.748447954582181, "mean_action_processing_ms": 83.21095847454873, "mean_env_wait_ms": 2.1142255968210537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00713801383972168, "StateBufferConnector_ms": 0.028292417526245117, "ViewRequirementAgentConnector_ms": 0.1969844102859497}, "num_episodes": 0, "episode_return_max": 325.2324397313568, "episode_return_min": 3.7473633599667475, "episode_return_mean": 113.17712673924267, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 256.4503435671172, "num_env_steps_trained_throughput_per_sec": 256.4503435671172, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 44102.873, "restore_workers_time_ms": 4.275, "training_step_time_ms": 44080.74, "sample_time_ms": 8114.941, "learn_time_ms": 37781.443, "learn_throughput": 211.744, "synch_weights_time_ms": 941.47}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 12, "trial_id": "cdf01_00000", "date": "2024-08-20_10-30-34", "timestamp": 1724130034, "time_this_iter_s": 31.230360746383667, "time_total_s": 552.3396894931793, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e8e1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 552.3396894931793, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 39.51363636363636, "ram_util_percent": 83.10227272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7783470885621178, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 8.15633021612016, "policy_loss": -0.0069333137013018135, "vf_loss": 8.16296975347731, "vf_explained_var": 0.15208048101455446, "kl": 0.005875277075271394, "entropy": 0.771743829477401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 7245.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2575019425342953, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 8.86480911345709, "policy_loss": -0.006671858045996891, "vf_loss": 8.871163823869493, "vf_explained_var": 0.09236205087767707, "kl": 0.006342006714585873, "entropy": 1.0186173428618719, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 7245.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 363.50616180323794, "episode_reward_min": -5.3975059924949065, "episode_reward_mean": 107.47460625851839, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -547.0029411127985, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.79695492590287, "predator_policy": 545.700942441613}, "policy_reward_mean": {"prey_policy": -212.25418796916836, "predator_policy": 265.99149109842756}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.66250436040053, 144.43890316546137, 319.4000000000009, 140.59999999999994, 76.96076197631315, 142.18611620952194, 145.81714760822777, 74.55114065606709, 89.08543645208474, 132.69999999999993, 272.1689328547976, 25.18042876721072, 49.46632220280198, 172.84861801020546, 79.39988984671403, 44.004371382021546, 115.23823469607399, 79.82366120232959, 134.86589595054772, 20.536878938582916, 229.38203591925193, 229.10109833542276, 42.380593673799154, 155.56823989731177, 149.4999999999994, 73.42112318546171, 139.6999999999993, 154.3107287755085, 176.9731733852216, 17.371788700068763, 68.3470629414276, 176.15056415895728, 145.96085641194983, 131.99727924475243, 4.100000000000003, 97.26876924668454, 226.3844444892168, 17.100000000000005, 31.375810533271007, 167.33378739509513, 53.723303308520485, 31.887321874818316, 188.20275035991548, 54.42718476150334, 14.748440117942, 157.50821440743638, 138.082468450755, 73.64496978725536, 33.00000000000006, 194.3329088645009, 99.30740852469296, 30.10000000000002, 265.08970632727846, 257.3205431255876, 45.70000000000006, 36.49650895053661, 0.9732128685421344, 15.435881468776426, 88.56387348352862, 3.6623283707616547, 49.52664042960727, 64.73914043544853, 74.60878525096678, 185.1435056704425, 174.37828854390776, 363.50616180323794, 179.9993466291205, 76.28373702870991, 94.90053428167982, 177.9813613552665, 148.41070464563128, 14.115890591724888, -5.3975059924949065, 10.353348041164438, 55.49117254862344, 97.38575720310442, 23.743216244430965, 313.09236192985804, 137.11615462402642, 130.6981548759143, 100.22842026617523, 9.923674533443746, 144.76956456197442, 2.5913300122674716, 102.37346079798115, 116.4342576464393, -2.938937394041954, 5.40786173669955, 132.65532297309346, 92.93337830965801, 206.80612548779771, 62.86931203666479, 9.334089665013561, 29.615770614827444, 304.62655342740635, 58.48618497514258, 182.1832331147396, 135.02237202036372, 22.92045507267747, 124.27181422803059], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-331.6227016711472, 2.8328952366895876, -216.56202513371247, 25.054690049013594, 171.2, 141.48129122363596, -300.04007825739666, 125.00449977878783, -182.3799908481287, -292.68990707658656, 43.735103230369, -342.45853231040877, 17.207312126367405, -191.50287840031874, -186.66518921494458, -234.97534672422424, -205.6662195192392, 20.828192216974255, -269.9668777089922, -43.70822194605757, -1.6126687286375514, -44.4130328415755, 4.025834806475734, -453.6597066083411, -440.9439495590625, -37.662832976053195, 73.17345154665506, -330.7411900233156, -379.5341763153901, -35.242681103818626, -159.35086809048877, -342.18755912878487, -103.65725014418771, -87.70677364712621, -455.4702491976197, 69.74882573430467, 65.00144977509228, -241.87409937019663, 10.26735082812422, -409.305258680992, -7.836008736689886, -6.053665351416484, 132.95730931895255, 32.312484313742885, -18.548596024181407, -332.11002566842154, 6.376027027871917, -44.087711586861715, -191.1126206775395, 85.99654127231466, -171.85594518217113, 18.771894808360358, 20.000000000000014, 19.09739983384245, 70.86989819676965, -391.41170868306415, -109.63944098912398, -539.568106246609, -403.84992876861486, -206.86305147060665, -325.9915074575388, -136.6655346049061, -10.92256766317706, -455.863514507354, -120.00012140234608, -422.5880299541558, -442.3211326669776, -286.9903646612232, -300.0926062978347, -501.09942830416725, -370.0484150862082, -94.13772089630199, 150.30073672317272, -267.21830361991294, -333.31181498396904, -263.74927054982453, -218.30754227565617, -390.60890675709834, -222.03125856333645, 111.09446850365954, -227.50639730849977, -433.9691990188612, -319.4791394100432, -202.441486784662, -308.8325861825715, 28.260882520711462, -340.6775419412363, -103.35563435420116, -369.468886729096, -345.8520620366998, -486.3190668257205, -3.151054387551856, -280.3854647354688, -84.41269436085841, -469.8418360174445, -54.3727853422177, -315.1860636311424, -482.1088684372563, 122.43729160766841, -388.7415948380635, -425.4720870328232, -5.684408505770097, -490.79991101558255, -171.93833571303355, 0.4631866348197491, -277.8607583968791, -118.59687208676621, 48.030715649977324, -279.0054512454985, -264.3967583194718, -66.2907629681145, -47.358378445479445, -547.0029411127985, -448.1232676203421, -445.852121302587, -261.1566682827719, -377.25974858305284, 58.098693944041194, -392.7520547761612, -496.9578141652122, -396.7396949165302, -181.8282763852193, -255.33698832865534, -417.1595264310588, -448.57022332601264, -182.30146748307175, 176.79695492590287, -422.04574647600907, -23.904001352958584, -227.42955257890088, -507.1143187497641, 20.08258800637671, 79.33232033030875, -500.0257246439098, -334.65339525069265, 58.33593646565185, -216.01877751697194, -86.53048966408468, -464.68288909505685, 133.92586153631163, -362.2531206894831, 100.98335731194649, -468.56538337220184, -457.83325192979083, -283.29601607519743, -133.33489476188097, -310.6954347043736, -338.67655870216277, -255.0215091008211, -383.98622008417897, -233.25172005524746, -530.577197538829, -538.9591323592352, -292.12934426219545, 135.2788369075538, 136.35928951940855, 124.82728553162312, -441.57012001088594, 49.30960624600837, -469.4104251982691, -203.71132898706605, -476.9420080549572, -285.3656700025676, -481.8018309530307, -277.16232944044873, -5.995048882380821, -485.9154730872077, -452.4554351962793, -144.8538845383358, -523.1334372567354, -106.34311729889112, -366.89400795554656, -357.86233169414595, -421.81796347894846, -354.44286047988845, -346.58110862094225, 55.69221902728416, -480.96021972095286, -380.5142189673785, -121.1803963699979, -398.03689953635796, 92.66481704458025, -439.1933311149548, -193.078678379619, -359.98722948632843, -532.263757825463, -477.3674263518448, -254.60811377269906, 46.62278953222495, 125.7075504656391, -343.2873595644814, -47.11919365420553, -188.10054614065336, -10.300959582734176, -133.31183017279258, -314.68666532553317, -410.1370988856738, -375.2391266867273, 76.16232844878567, -383.899656754278], "policy_predator_policy_reward": [337.6432878910106, 56.8090229038467, 262.84565159739225, 73.10058665276878, 0.0, 6.718708776363739, 307.14007825739645, 8.495500221212158, 255.51185290942735, 296.5188069916006, 128.93898126863235, 311.9705640209301, 70.80296201757798, 249.30975186460165, 429.63692715250835, 66.55474944272669, 260.8369826271976, 13.086481127152073, 330.823105844227, 115.55199381082251, 66.01461748587774, 252.18001693913303, 157.28053908414165, 317.53376148493464, 442.0439495590625, 86.02915517885519, 98.67451689054386, 331.74183959632364, 127.00933442206694, 367.1674128438562, 137.58711765740023, 407.95568094389483, 198.33582213338414, 108.26643635400329, 456.77024919762, 8.774835468025419, 278.8415518766725, 32.896993668979775, 358.54113366683754, 61.03365312461298, 123.09866394591032, 120.17304606144843, 25.38388113666473, 38.44742356606312, 95.9242184694958, 297.1149968969062, 66.02631433796543, 127.25361011833695, 212.5299103360707, 42.086169069153556, 23.50566459604155, 202.9995089632307, 1.1009378723396746, 99.50166229381789, 38.06629293452441, 436.7862463272796, 298.23890132626536, 527.9418192946885, 302.22024570537866, 325.86452323391114, 163.31889948504437, 367.6852055188291, 247.15047887286454, 395.78616745662436, 431.35061991355565, 257.198387854895, 420.2130221410195, 441.0957544319338, 303.39260629783456, 501.8994283041673, 105.60039218521577, 455.8545130439789, 251.48168449272694, 91.82032689323003, 334.1118149839691, 280.0492705498244, 254.7483184843064, 385.5439410817193, 9.180991017591804, 269.0895864371804, 256.43765699681677, 458.7612426390651, 299.40918042097417, 254.39876764854952, 282.0432583756934, 186.7311956460823, 346.6823556370865, 151.7780054198543, 382.3325799231645, 347.73680896057385, 287.7355261068772, 359.2428095138317, 251.9988846477966, 250.88174289928568, 380.807636857823, 217.05195428909454, 332.1860636311433, 498.1088684372564, 383.7210815065112, 76.9161305883852, 124.17393915138348, 406.2899649119031, 491.3999110155827, 201.43833571303335, 188.1549658638902, 354.3323122254475, 138.3229699826233, 189.56372957975313, 290.0054512454984, 299.0967583194718, 88.6533567437393, 61.492293620390235, 545.700942441613, 450.3984791600696, 453.51735639058205, 268.9273146635532, 269.2591335427248, 138.46579457981554, 395.18291653549375, 498.1892807766411, 400.69034931734586, 227.40426241401104, 487.690293106635, 249.54536208852724, 410.1963144236688, 295.28416163638275, 8.34655074453969, 422.04574647600907, 261.59215470526146, 164.11968777050635, 415.7813704710273, 434.7565220755979, 492.14183589985174, 108.55091504286996, 271.78323207272047, 80.8179637410299, 61.80537454038826, 335.64442692234815, 120.90616020249668, 387.8322287115148, 270.22251726091196, 139.45795076225582, 514.6476842948359, 425.86684159888193, 26.72442001767064, 384.50898482691247, 312.72491012090313, 347.0004313267976, 283.7403733282574, 410.7585284053664, 333.75598313497153, 527.4586916622094, 538.7850599938539, 316.04663287200805, 20.63447193425992, 20.819763568635825, 390.72533315860477, 63.13365594468467, 234.31487903077786, 316.4840947973981, 335.9938538469015, 444.8879034612972, 295.270643531661, 481.82053195738143, 87.82195342115607, 340.1049894636483, 485.9154730872077, 455.04676520854684, 249.06848535030974, 521.2922972427426, 249.62936560887513, 340.0420172920019, 348.53013899138455, 428.2112187876684, 350.3406653525874, 356.09116548494274, 93.94944327778454, 463.9738803889779, 382.86580493710426, 211.76218870992986, 375.0216228308471, 137.15658514872854, 442.1933311149548, 252.94799041628377, 371.0389970468125, 530.5460799299927, 239.66457065287725, 521.9267400864933, 77.95644744970758, 54.339765979834525, 84.1445289808887, 364.7482092129398, 288.4781659252227, 92.10657291290434, 494.0580945073803, 88.96277301131128, 429.8532427072471, 378.44343793783133, 35.80948577924495, 396.1996567542781]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.871656494496687, "mean_inference_ms": 6.332100292621078, "mean_action_processing_ms": 72.20180856054102, "mean_env_wait_ms": 1.9804409622728878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00821220874786377, "StateBufferConnector_ms": 0.015230894088745117, "ViewRequirementAgentConnector_ms": 0.15728318691253662}, "num_episodes": 72, "episode_return_max": 363.50616180323794, "episode_return_min": -5.3975059924949065, "episode_return_mean": 107.47460625851839, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.5833644896131, "num_env_steps_trained_throughput_per_sec": 246.5833644896131, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 44377.639, "restore_workers_time_ms": 4.276, "training_step_time_ms": 44355.492, "sample_time_ms": 8117.998, "learn_time_ms": 38032.649, "learn_throughput": 210.346, "synch_weights_time_ms": 943.77}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 13, "trial_id": "cdf01_00000", "date": "2024-08-20_10-31-07", "timestamp": 1724130067, "time_this_iter_s": 32.48842000961304, "time_total_s": 584.8281095027924, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52929d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 584.8281095027924, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 44.980851063829796, "ram_util_percent": 83.17021276595743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7285195605149344, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 8.313144804939391, "policy_loss": -0.005148202219667534, "vf_loss": 8.318076500060066, "vf_explained_var": 0.1495909846018231, "kl": 0.004331067805330912, "entropy": 0.7478346588119628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 7875.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4995546445487038, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 8.728540886773004, "policy_loss": -0.00535880939828025, "vf_loss": 8.733597378503708, "vf_explained_var": 0.06971848947661263, "kl": 0.006046759049578603, "entropy": 0.993401567141215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 7875.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 363.50616180323794, "episode_reward_min": -5.3975059924949065, "episode_reward_mean": 107.47460625851839, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -547.0029411127985, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.79695492590287, "predator_policy": 545.700942441613}, "policy_reward_mean": {"prey_policy": -212.25418796916836, "predator_policy": 265.99149109842756}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.66250436040053, 144.43890316546137, 319.4000000000009, 140.59999999999994, 76.96076197631315, 142.18611620952194, 145.81714760822777, 74.55114065606709, 89.08543645208474, 132.69999999999993, 272.1689328547976, 25.18042876721072, 49.46632220280198, 172.84861801020546, 79.39988984671403, 44.004371382021546, 115.23823469607399, 79.82366120232959, 134.86589595054772, 20.536878938582916, 229.38203591925193, 229.10109833542276, 42.380593673799154, 155.56823989731177, 149.4999999999994, 73.42112318546171, 139.6999999999993, 154.3107287755085, 176.9731733852216, 17.371788700068763, 68.3470629414276, 176.15056415895728, 145.96085641194983, 131.99727924475243, 4.100000000000003, 97.26876924668454, 226.3844444892168, 17.100000000000005, 31.375810533271007, 167.33378739509513, 53.723303308520485, 31.887321874818316, 188.20275035991548, 54.42718476150334, 14.748440117942, 157.50821440743638, 138.082468450755, 73.64496978725536, 33.00000000000006, 194.3329088645009, 99.30740852469296, 30.10000000000002, 265.08970632727846, 257.3205431255876, 45.70000000000006, 36.49650895053661, 0.9732128685421344, 15.435881468776426, 88.56387348352862, 3.6623283707616547, 49.52664042960727, 64.73914043544853, 74.60878525096678, 185.1435056704425, 174.37828854390776, 363.50616180323794, 179.9993466291205, 76.28373702870991, 94.90053428167982, 177.9813613552665, 148.41070464563128, 14.115890591724888, -5.3975059924949065, 10.353348041164438, 55.49117254862344, 97.38575720310442, 23.743216244430965, 313.09236192985804, 137.11615462402642, 130.6981548759143, 100.22842026617523, 9.923674533443746, 144.76956456197442, 2.5913300122674716, 102.37346079798115, 116.4342576464393, -2.938937394041954, 5.40786173669955, 132.65532297309346, 92.93337830965801, 206.80612548779771, 62.86931203666479, 9.334089665013561, 29.615770614827444, 304.62655342740635, 58.48618497514258, 182.1832331147396, 135.02237202036372, 22.92045507267747, 124.27181422803059], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-331.6227016711472, 2.8328952366895876, -216.56202513371247, 25.054690049013594, 171.2, 141.48129122363596, -300.04007825739666, 125.00449977878783, -182.3799908481287, -292.68990707658656, 43.735103230369, -342.45853231040877, 17.207312126367405, -191.50287840031874, -186.66518921494458, -234.97534672422424, -205.6662195192392, 20.828192216974255, -269.9668777089922, -43.70822194605757, -1.6126687286375514, -44.4130328415755, 4.025834806475734, -453.6597066083411, -440.9439495590625, -37.662832976053195, 73.17345154665506, -330.7411900233156, -379.5341763153901, -35.242681103818626, -159.35086809048877, -342.18755912878487, -103.65725014418771, -87.70677364712621, -455.4702491976197, 69.74882573430467, 65.00144977509228, -241.87409937019663, 10.26735082812422, -409.305258680992, -7.836008736689886, -6.053665351416484, 132.95730931895255, 32.312484313742885, -18.548596024181407, -332.11002566842154, 6.376027027871917, -44.087711586861715, -191.1126206775395, 85.99654127231466, -171.85594518217113, 18.771894808360358, 20.000000000000014, 19.09739983384245, 70.86989819676965, -391.41170868306415, -109.63944098912398, -539.568106246609, -403.84992876861486, -206.86305147060665, -325.9915074575388, -136.6655346049061, -10.92256766317706, -455.863514507354, -120.00012140234608, -422.5880299541558, -442.3211326669776, -286.9903646612232, -300.0926062978347, -501.09942830416725, -370.0484150862082, -94.13772089630199, 150.30073672317272, -267.21830361991294, -333.31181498396904, -263.74927054982453, -218.30754227565617, -390.60890675709834, -222.03125856333645, 111.09446850365954, -227.50639730849977, -433.9691990188612, -319.4791394100432, -202.441486784662, -308.8325861825715, 28.260882520711462, -340.6775419412363, -103.35563435420116, -369.468886729096, -345.8520620366998, -486.3190668257205, -3.151054387551856, -280.3854647354688, -84.41269436085841, -469.8418360174445, -54.3727853422177, -315.1860636311424, -482.1088684372563, 122.43729160766841, -388.7415948380635, -425.4720870328232, -5.684408505770097, -490.79991101558255, -171.93833571303355, 0.4631866348197491, -277.8607583968791, -118.59687208676621, 48.030715649977324, -279.0054512454985, -264.3967583194718, -66.2907629681145, -47.358378445479445, -547.0029411127985, -448.1232676203421, -445.852121302587, -261.1566682827719, -377.25974858305284, 58.098693944041194, -392.7520547761612, -496.9578141652122, -396.7396949165302, -181.8282763852193, -255.33698832865534, -417.1595264310588, -448.57022332601264, -182.30146748307175, 176.79695492590287, -422.04574647600907, -23.904001352958584, -227.42955257890088, -507.1143187497641, 20.08258800637671, 79.33232033030875, -500.0257246439098, -334.65339525069265, 58.33593646565185, -216.01877751697194, -86.53048966408468, -464.68288909505685, 133.92586153631163, -362.2531206894831, 100.98335731194649, -468.56538337220184, -457.83325192979083, -283.29601607519743, -133.33489476188097, -310.6954347043736, -338.67655870216277, -255.0215091008211, -383.98622008417897, -233.25172005524746, -530.577197538829, -538.9591323592352, -292.12934426219545, 135.2788369075538, 136.35928951940855, 124.82728553162312, -441.57012001088594, 49.30960624600837, -469.4104251982691, -203.71132898706605, -476.9420080549572, -285.3656700025676, -481.8018309530307, -277.16232944044873, -5.995048882380821, -485.9154730872077, -452.4554351962793, -144.8538845383358, -523.1334372567354, -106.34311729889112, -366.89400795554656, -357.86233169414595, -421.81796347894846, -354.44286047988845, -346.58110862094225, 55.69221902728416, -480.96021972095286, -380.5142189673785, -121.1803963699979, -398.03689953635796, 92.66481704458025, -439.1933311149548, -193.078678379619, -359.98722948632843, -532.263757825463, -477.3674263518448, -254.60811377269906, 46.62278953222495, 125.7075504656391, -343.2873595644814, -47.11919365420553, -188.10054614065336, -10.300959582734176, -133.31183017279258, -314.68666532553317, -410.1370988856738, -375.2391266867273, 76.16232844878567, -383.899656754278], "policy_predator_policy_reward": [337.6432878910106, 56.8090229038467, 262.84565159739225, 73.10058665276878, 0.0, 6.718708776363739, 307.14007825739645, 8.495500221212158, 255.51185290942735, 296.5188069916006, 128.93898126863235, 311.9705640209301, 70.80296201757798, 249.30975186460165, 429.63692715250835, 66.55474944272669, 260.8369826271976, 13.086481127152073, 330.823105844227, 115.55199381082251, 66.01461748587774, 252.18001693913303, 157.28053908414165, 317.53376148493464, 442.0439495590625, 86.02915517885519, 98.67451689054386, 331.74183959632364, 127.00933442206694, 367.1674128438562, 137.58711765740023, 407.95568094389483, 198.33582213338414, 108.26643635400329, 456.77024919762, 8.774835468025419, 278.8415518766725, 32.896993668979775, 358.54113366683754, 61.03365312461298, 123.09866394591032, 120.17304606144843, 25.38388113666473, 38.44742356606312, 95.9242184694958, 297.1149968969062, 66.02631433796543, 127.25361011833695, 212.5299103360707, 42.086169069153556, 23.50566459604155, 202.9995089632307, 1.1009378723396746, 99.50166229381789, 38.06629293452441, 436.7862463272796, 298.23890132626536, 527.9418192946885, 302.22024570537866, 325.86452323391114, 163.31889948504437, 367.6852055188291, 247.15047887286454, 395.78616745662436, 431.35061991355565, 257.198387854895, 420.2130221410195, 441.0957544319338, 303.39260629783456, 501.8994283041673, 105.60039218521577, 455.8545130439789, 251.48168449272694, 91.82032689323003, 334.1118149839691, 280.0492705498244, 254.7483184843064, 385.5439410817193, 9.180991017591804, 269.0895864371804, 256.43765699681677, 458.7612426390651, 299.40918042097417, 254.39876764854952, 282.0432583756934, 186.7311956460823, 346.6823556370865, 151.7780054198543, 382.3325799231645, 347.73680896057385, 287.7355261068772, 359.2428095138317, 251.9988846477966, 250.88174289928568, 380.807636857823, 217.05195428909454, 332.1860636311433, 498.1088684372564, 383.7210815065112, 76.9161305883852, 124.17393915138348, 406.2899649119031, 491.3999110155827, 201.43833571303335, 188.1549658638902, 354.3323122254475, 138.3229699826233, 189.56372957975313, 290.0054512454984, 299.0967583194718, 88.6533567437393, 61.492293620390235, 545.700942441613, 450.3984791600696, 453.51735639058205, 268.9273146635532, 269.2591335427248, 138.46579457981554, 395.18291653549375, 498.1892807766411, 400.69034931734586, 227.40426241401104, 487.690293106635, 249.54536208852724, 410.1963144236688, 295.28416163638275, 8.34655074453969, 422.04574647600907, 261.59215470526146, 164.11968777050635, 415.7813704710273, 434.7565220755979, 492.14183589985174, 108.55091504286996, 271.78323207272047, 80.8179637410299, 61.80537454038826, 335.64442692234815, 120.90616020249668, 387.8322287115148, 270.22251726091196, 139.45795076225582, 514.6476842948359, 425.86684159888193, 26.72442001767064, 384.50898482691247, 312.72491012090313, 347.0004313267976, 283.7403733282574, 410.7585284053664, 333.75598313497153, 527.4586916622094, 538.7850599938539, 316.04663287200805, 20.63447193425992, 20.819763568635825, 390.72533315860477, 63.13365594468467, 234.31487903077786, 316.4840947973981, 335.9938538469015, 444.8879034612972, 295.270643531661, 481.82053195738143, 87.82195342115607, 340.1049894636483, 485.9154730872077, 455.04676520854684, 249.06848535030974, 521.2922972427426, 249.62936560887513, 340.0420172920019, 348.53013899138455, 428.2112187876684, 350.3406653525874, 356.09116548494274, 93.94944327778454, 463.9738803889779, 382.86580493710426, 211.76218870992986, 375.0216228308471, 137.15658514872854, 442.1933311149548, 252.94799041628377, 371.0389970468125, 530.5460799299927, 239.66457065287725, 521.9267400864933, 77.95644744970758, 54.339765979834525, 84.1445289808887, 364.7482092129398, 288.4781659252227, 92.10657291290434, 494.0580945073803, 88.96277301131128, 429.8532427072471, 378.44343793783133, 35.80948577924495, 396.1996567542781]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.871656494496687, "mean_inference_ms": 6.332100292621078, "mean_action_processing_ms": 72.20180856054102, "mean_env_wait_ms": 1.9804409622728878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00821220874786377, "StateBufferConnector_ms": 0.015230894088745117, "ViewRequirementAgentConnector_ms": 0.15728318691253662}, "num_episodes": 0, "episode_return_max": 363.50616180323794, "episode_return_min": -5.3975059924949065, "episode_return_mean": 107.47460625851839, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 254.36316395775103, "num_env_steps_trained_throughput_per_sec": 254.36316395775103, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 44564.368, "restore_workers_time_ms": 4.276, "training_step_time_ms": 44542.219, "sample_time_ms": 8094.174, "learn_time_ms": 38209.178, "learn_throughput": 209.374, "synch_weights_time_ms": 942.68}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 14, "trial_id": "cdf01_00000", "date": "2024-08-20_10-31-38", "timestamp": 1724130098, "time_this_iter_s": 31.49703598022461, "time_total_s": 616.325145483017, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52ab280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 616.325145483017, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 40.449999999999996, "ram_util_percent": 83.13181818181816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.283109299625669, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 8.451101181242201, "policy_loss": -0.0056915634271082665, "vf_loss": 8.456638207511297, "vf_explained_var": 0.15453508600356086, "kl": 0.006181032785583998, "entropy": 0.6347548358024113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.551523035386252, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 8.61855161909073, "policy_loss": -0.004660240469855212, "vf_loss": 8.622960856604198, "vf_explained_var": 0.09635167954460024, "kl": 0.0050190991291610915, "entropy": 0.897677681370387, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 313.09236192985804, "episode_reward_min": -5.3975059924949065, "episode_reward_mean": 88.19219165921123, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -560.1376039548438, "predator_policy": 2.3321279085508633}, "policy_reward_max": {"prey_policy": 182.20307853187032, "predator_policy": 559.9906601683782}, "policy_reward_mean": {"prey_policy": -266.0855648612151, "predator_policy": 310.1816606908207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3975059924949065, 10.353348041164438, 55.49117254862344, 97.38575720310442, 23.743216244430965, 313.09236192985804, 137.11615462402642, 130.6981548759143, 100.22842026617523, 9.923674533443746, 144.76956456197442, 2.5913300122674716, 102.37346079798115, 116.4342576464393, -2.938937394041954, 5.40786173669955, 132.65532297309346, 92.93337830965801, 206.80612548779771, 62.86931203666479, 9.334089665013561, 29.615770614827444, 304.62655342740635, 58.48618497514258, 182.1832331147396, 135.02237202036372, 22.92045507267747, 124.27181422803059, -0.23677843656367248, 37.177571747874296, 0.41092440710523714, 168.4544591808836, 56.100000000000094, 52.67918565568973, 6.899999999999999, 68.10038203913778, 142.99196693559958, 168.3880461675054, 56.111381237439225, 78.56963445529811, 248.71615709438433, 36.95207708864696, 41.550074282412616, -0.12997930586052586, 87.28280149831437, 92.80000000000001, 140.9999999999995, 172.79999999999976, 116.82980567585443, 83.20492109595453, 238.4537164068865, -1.6649101669763464, 29.257706575123912, 78.7539386711116, 112.53718105260624, 6.193531028600249, 1.7886716925008574, 79.13835686233118, 38.244391374757086, 5.674643749636669, -0.14540759768128475, 171.71292138337566, 105.85349240737669, 21.675510102508547, 233.10512895365042, 66.3853103249356, 184.2157663677193, 210.12138455326613, 19.800000000000022, 19.65679293059833, 26.482701547348494, 133.70337788791406, 169.93527894388953, 10.299999999999981, 7.699999999999999, 5.299999999999997, 96.72898706934966, 289.7876608926911, 146.60378566437785, 32.124046103547904, 110.27002126566555, 151.68933258079397, 18.51575701710113, 180.3898725862303, 15.487188222678999, 282.6324360755578, 76.73364265023939, 83.73748938146096, 79.35741554352393, -1.0950030440893856, 43.09854147739105, 172.9999999999995, 307.34937602635193, 72.75090518343998, 7.505520711118215, 0.8777955010503289, -2.9085485631637904, 132.4214759883994, 14.54022827637618, 73.79221987889689], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-283.29601607519743, -133.33489476188097, -310.6954347043736, -338.67655870216277, -255.0215091008211, -383.98622008417897, -233.25172005524746, -530.577197538829, -538.9591323592352, -292.12934426219545, 135.2788369075538, 136.35928951940855, 124.82728553162312, -441.57012001088594, 49.30960624600837, -469.4104251982691, -203.71132898706605, -476.9420080549572, -285.3656700025676, -481.8018309530307, -277.16232944044873, -5.995048882380821, -485.9154730872077, -452.4554351962793, -144.8538845383358, -523.1334372567354, -106.34311729889112, -366.89400795554656, -357.86233169414595, -421.81796347894846, -354.44286047988845, -346.58110862094225, 55.69221902728416, -480.96021972095286, -380.5142189673785, -121.1803963699979, -398.03689953635796, 92.66481704458025, -439.1933311149548, -193.078678379619, -359.98722948632843, -532.263757825463, -477.3674263518448, -254.60811377269906, 46.62278953222495, 125.7075504656391, -343.2873595644814, -47.11919365420553, -188.10054614065336, -10.300959582734176, -133.31183017279258, -314.68666532553317, -410.1370988856738, -375.2391266867273, 76.16232844878567, -383.899656754278, -488.8596901235571, -456.11117937818227, -447.04148041081936, -64.31938474675131, -498.89392366415325, -452.5358612776344, -248.25495443136703, -211.3475822645509, -117.64586587083258, -215.42808069987333, -363.306165381463, -185.2804637367531, -358.81163900863817, -389.5134703864889, -27.48506524511079, -262.9910716273294, 136.21175759962492, -508.6573710312751, 13.627481228218356, -371.2420087191503, -476.98420352648935, -341.1419837840447, -88.29968139370213, -448.7354089080426, -127.98083634552356, -530.2339461710205, -338.80910092941366, -232.75576651676784, -496.66222037771666, -8.01664949946894, -370.1983544043616, -452.7691424869799, -168.3074027064487, -410.7897566810968, -54.1166529852095, -286.13948268977657, 118.26787209144906, 4.127484692182092, 64.12145167797686, -138.50287570130052, -355.11507739988957, -500.2178687345859, -93.9360982764376, -510.94229618178804, -298.1354211459689, 46.532518583585336, -525.7174026919994, -392.83696413022113, -375.66260137738914, 16.08090729395928, -368.8483305020039, -109.86276022372132, -79.91568476580687, 79.2864232606257, -418.6554161240417, -119.97620325313233, -560.1376039548438, -369.88577016059946, -497.71443850224205, -92.32095365913793, -344.25938545801023, -386.16006638952643, -387.7817801235591, -227.0928646165258, -353.2631847914046, -504.49014769154843, -189.79234607487888, -116.20116533424239, -287.3646304392771, -157.5868139963258, -356.45184430508147, -429.3799228690235, -62.7609264821034, -26.96188941304048, -361.50207371262087, -431.5217565003147, -7.797191542030625, -413.75523783927906, -359.87156891413537, 182.20307853187032, -316.9357610433102, -408.7901067736126, -189.50601287162593, -433.9317898999362, -241.40046212167132, -267.48103783919976, -105.77639895506475, -107.01008998656783, 1.2894920015523272, -439.18221381560124, -360.3572212832832, -321.1195190925828, -363.63067753430767, -356.5700116829467, -312.9909722133853, -499.461597013809, -101.13429881307823, -443.7280140629844, 115.139992277506, -523.8839592739289, 7.797076472964628, 110.66456497595097, -470.92173756333415, -363.1670773061865, -466.2514268285611, -209.99709604526868, -23.485772147081533, -362.931487450823, -117.11407065873185, -433.5326711937269, -394.4059997320074, 82.28615446851366, -469.26360328827036, -109.77035758007449, -495.84611957440654, -140.54654934086182, -388.2284470357562, -192.25370838835258, -204.3744565601305, 13.215990395944749, -399.35261784813986, -388.342283724542, -392.11069695916075, -472.6418944436066, -194.86817895609016, -372.8490464958547, -26.60762543539856, 104.22741240237508, 51.24795248179852, -380.82763074004623, -345.7983514551556, -58.18131455155075, -386.3500352070204, -484.7040449544376, -322.3706434718489, -510.44302228339933, -428.73125453763777, -475.0140220286263, -422.62452019095144, -26.365471053525805, -438.2315700462592, -294.4652943266963, -245.91369006121283, -446.78784389923794], "policy_predator_policy_reward": [26.72442001767064, 384.50898482691247, 312.72491012090313, 347.0004313267976, 283.7403733282574, 410.7585284053664, 333.75598313497153, 527.4586916622094, 538.7850599938539, 316.04663287200805, 20.63447193425992, 20.819763568635825, 390.72533315860477, 63.13365594468467, 234.31487903077786, 316.4840947973981, 335.9938538469015, 444.8879034612972, 295.270643531661, 481.82053195738143, 87.82195342115607, 340.1049894636483, 485.9154730872077, 455.04676520854684, 249.06848535030974, 521.2922972427426, 249.62936560887513, 340.0420172920019, 348.53013899138455, 428.2112187876684, 350.3406653525874, 356.09116548494274, 93.94944327778454, 463.9738803889779, 382.86580493710426, 211.76218870992986, 375.0216228308471, 137.15658514872854, 442.1933311149548, 252.94799041628377, 371.0389970468125, 530.5460799299927, 239.66457065287725, 521.9267400864933, 77.95644744970758, 54.339765979834525, 84.1445289808887, 364.7482092129398, 288.4781659252227, 92.10657291290434, 494.0580945073803, 88.96277301131128, 429.8532427072471, 378.44343793783133, 35.80948577924495, 396.1996567542781, 488.6229116869934, 456.11117937818227, 247.18314871609948, 301.3552881893448, 499.0939236641533, 452.74678568473956, 514.2742343938551, 113.78276148294651, 143.745865870832, 245.42808069987288, 259.50913045692704, 341.7566843169786, 365.71163900863814, 389.5134703864889, 166.60514570379374, 191.97137320778432, 508.69666044721015, 6.74091992003965, 177.68055821576704, 348.32201544267116, 465.05190378432553, 409.18566476364947, 216.5860735289656, 399.0186512280768, 388.02944698891554, 518.9014926220124, 339.00580007051457, 269.511144464314, 496.7622203777167, 49.466723781881505, 369.9683750985011, 452.8691424869799, 266.67649062000453, 399.7034702658557, 141.91665298520934, 291.1394826897765, 2.3321279085508633, 16.272515307817876, 94.37854832202311, 152.80287570130022, 502.97694912887937, 469.1858026814508, 203.7434026743866, 484.3399128797923, 153.50675977392953, 336.5498591953401, 523.3990045512527, 393.4904521039915, 347.78796496600927, 41.05143569254419, 159.12830113444903, 398.33672826238706, 110.35216607317605, 2.814276484611253, 422.6554161240417, 122.16973428173193, 559.9906601683782, 371.8213856395663, 350.45422266512855, 318.7195263585832, 352.65938545801, 416.00445776428336, 388.48178012355925, 232.06750836616249, 496.4704500244249, 361.13747486084696, 105.04189088795347, 372.66454190454306, 353.15903766782424, 197.6458991751547, 452.57131924565317, 354.93595803096036, 170.95447626932372, 151.87346857947063, 435.059832219567, 424.34930831830394, 225.39934296249282, 380.36885278653523, 370.17131770205515, 17.618557233476793, 334.93576104331044, 410.5901067736125, 200.02472613818048, 443.0698695639793, 333.4787931195401, 201.88540838867996, 218.40892023046018, 128.08094659908605, 348.4319891173734, 259.39601164056506, 366.3572212832832, 325.4195190925837, 364.1306775343078, 363.77001168294686, 318.2909722133853, 499.461597013809, 175.04336709979648, 466.54793284561504, 189.16680872549756, 509.3648191636165, 14.702923527035338, 13.439220688427154, 468.5597986792882, 397.6530622937806, 344.8069864095086, 441.71155772998645, 180.6384379641195, 357.468154214579, 362.73630691645167, 206.42619195310746, 338.29795677872875, 154.21176107099606, 451.8567643818977, 142.66438470912647, 430.5377683988163, 488.4873365920084, 443.0237694641417, 214.19202861020685, 6.339582894844819, 268.5563726508021, 396.7498483231213, 470.3024687930858, 393.51069695916067, 470.1468913995172, 212.86041960651465, 397.9553473228217, 43.107625435398795, 52.272587597624934, 285.12548032733866, 351.80357395725986, 192.94656137852272, 283.7840098116241, 391.55003520702064, 487.0095656655558, 321.24843897289895, 512.4430222833993, 448.7264738888814, 452.11025411421883, 426.2027994220894, 155.20866781078695, 432.5090749142161, 314.7280177351162, 370.20834890418814, 396.28540493516056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.304246844778836, "mean_inference_ms": 5.964049620750327, "mean_action_processing_ms": 62.33844583752295, "mean_env_wait_ms": 1.8676990307291674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007318019866943359, "StateBufferConnector_ms": 0.01626420021057129, "ViewRequirementAgentConnector_ms": 0.11017286777496338}, "num_episodes": 72, "episode_return_max": 313.09236192985804, "episode_return_min": -5.3975059924949065, "episode_return_mean": 88.19219165921123, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 207.68787814239926, "num_env_steps_trained_throughput_per_sec": 207.68787814239926, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 45534.307, "restore_workers_time_ms": 4.275, "training_step_time_ms": 45512.15, "sample_time_ms": 8128.833, "learn_time_ms": 39109.349, "learn_throughput": 204.555, "synch_weights_time_ms": 944.147}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 15, "trial_id": "cdf01_00000", "date": "2024-08-20_10-32-17", "timestamp": 1724130137, "time_this_iter_s": 38.55212092399597, "time_total_s": 654.8772664070129, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52c4940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 654.8772664070129, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 64.80727272727273, "ram_util_percent": 83.12727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.07272764586267, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 9.220881321316673, "policy_loss": -0.005200952841412454, "vf_loss": 9.225952859908816, "vf_explained_var": 0.10480311777856614, "kl": 0.005175236444939935, "entropy": 0.5429818235692524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 9135.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9572547978351986, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 9.271984062497578, "policy_loss": -0.006420460957590313, "vf_loss": 9.278038572886633, "vf_explained_var": 0.09506386556322613, "kl": 0.007318793690847954, "entropy": 0.8537497932948763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 9135.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 313.09236192985804, "episode_reward_min": -5.3975059924949065, "episode_reward_mean": 88.19219165921123, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -560.1376039548438, "predator_policy": 2.3321279085508633}, "policy_reward_max": {"prey_policy": 182.20307853187032, "predator_policy": 559.9906601683782}, "policy_reward_mean": {"prey_policy": -266.0855648612151, "predator_policy": 310.1816606908207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.3975059924949065, 10.353348041164438, 55.49117254862344, 97.38575720310442, 23.743216244430965, 313.09236192985804, 137.11615462402642, 130.6981548759143, 100.22842026617523, 9.923674533443746, 144.76956456197442, 2.5913300122674716, 102.37346079798115, 116.4342576464393, -2.938937394041954, 5.40786173669955, 132.65532297309346, 92.93337830965801, 206.80612548779771, 62.86931203666479, 9.334089665013561, 29.615770614827444, 304.62655342740635, 58.48618497514258, 182.1832331147396, 135.02237202036372, 22.92045507267747, 124.27181422803059, -0.23677843656367248, 37.177571747874296, 0.41092440710523714, 168.4544591808836, 56.100000000000094, 52.67918565568973, 6.899999999999999, 68.10038203913778, 142.99196693559958, 168.3880461675054, 56.111381237439225, 78.56963445529811, 248.71615709438433, 36.95207708864696, 41.550074282412616, -0.12997930586052586, 87.28280149831437, 92.80000000000001, 140.9999999999995, 172.79999999999976, 116.82980567585443, 83.20492109595453, 238.4537164068865, -1.6649101669763464, 29.257706575123912, 78.7539386711116, 112.53718105260624, 6.193531028600249, 1.7886716925008574, 79.13835686233118, 38.244391374757086, 5.674643749636669, -0.14540759768128475, 171.71292138337566, 105.85349240737669, 21.675510102508547, 233.10512895365042, 66.3853103249356, 184.2157663677193, 210.12138455326613, 19.800000000000022, 19.65679293059833, 26.482701547348494, 133.70337788791406, 169.93527894388953, 10.299999999999981, 7.699999999999999, 5.299999999999997, 96.72898706934966, 289.7876608926911, 146.60378566437785, 32.124046103547904, 110.27002126566555, 151.68933258079397, 18.51575701710113, 180.3898725862303, 15.487188222678999, 282.6324360755578, 76.73364265023939, 83.73748938146096, 79.35741554352393, -1.0950030440893856, 43.09854147739105, 172.9999999999995, 307.34937602635193, 72.75090518343998, 7.505520711118215, 0.8777955010503289, -2.9085485631637904, 132.4214759883994, 14.54022827637618, 73.79221987889689], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-283.29601607519743, -133.33489476188097, -310.6954347043736, -338.67655870216277, -255.0215091008211, -383.98622008417897, -233.25172005524746, -530.577197538829, -538.9591323592352, -292.12934426219545, 135.2788369075538, 136.35928951940855, 124.82728553162312, -441.57012001088594, 49.30960624600837, -469.4104251982691, -203.71132898706605, -476.9420080549572, -285.3656700025676, -481.8018309530307, -277.16232944044873, -5.995048882380821, -485.9154730872077, -452.4554351962793, -144.8538845383358, -523.1334372567354, -106.34311729889112, -366.89400795554656, -357.86233169414595, -421.81796347894846, -354.44286047988845, -346.58110862094225, 55.69221902728416, -480.96021972095286, -380.5142189673785, -121.1803963699979, -398.03689953635796, 92.66481704458025, -439.1933311149548, -193.078678379619, -359.98722948632843, -532.263757825463, -477.3674263518448, -254.60811377269906, 46.62278953222495, 125.7075504656391, -343.2873595644814, -47.11919365420553, -188.10054614065336, -10.300959582734176, -133.31183017279258, -314.68666532553317, -410.1370988856738, -375.2391266867273, 76.16232844878567, -383.899656754278, -488.8596901235571, -456.11117937818227, -447.04148041081936, -64.31938474675131, -498.89392366415325, -452.5358612776344, -248.25495443136703, -211.3475822645509, -117.64586587083258, -215.42808069987333, -363.306165381463, -185.2804637367531, -358.81163900863817, -389.5134703864889, -27.48506524511079, -262.9910716273294, 136.21175759962492, -508.6573710312751, 13.627481228218356, -371.2420087191503, -476.98420352648935, -341.1419837840447, -88.29968139370213, -448.7354089080426, -127.98083634552356, -530.2339461710205, -338.80910092941366, -232.75576651676784, -496.66222037771666, -8.01664949946894, -370.1983544043616, -452.7691424869799, -168.3074027064487, -410.7897566810968, -54.1166529852095, -286.13948268977657, 118.26787209144906, 4.127484692182092, 64.12145167797686, -138.50287570130052, -355.11507739988957, -500.2178687345859, -93.9360982764376, -510.94229618178804, -298.1354211459689, 46.532518583585336, -525.7174026919994, -392.83696413022113, -375.66260137738914, 16.08090729395928, -368.8483305020039, -109.86276022372132, -79.91568476580687, 79.2864232606257, -418.6554161240417, -119.97620325313233, -560.1376039548438, -369.88577016059946, -497.71443850224205, -92.32095365913793, -344.25938545801023, -386.16006638952643, -387.7817801235591, -227.0928646165258, -353.2631847914046, -504.49014769154843, -189.79234607487888, -116.20116533424239, -287.3646304392771, -157.5868139963258, -356.45184430508147, -429.3799228690235, -62.7609264821034, -26.96188941304048, -361.50207371262087, -431.5217565003147, -7.797191542030625, -413.75523783927906, -359.87156891413537, 182.20307853187032, -316.9357610433102, -408.7901067736126, -189.50601287162593, -433.9317898999362, -241.40046212167132, -267.48103783919976, -105.77639895506475, -107.01008998656783, 1.2894920015523272, -439.18221381560124, -360.3572212832832, -321.1195190925828, -363.63067753430767, -356.5700116829467, -312.9909722133853, -499.461597013809, -101.13429881307823, -443.7280140629844, 115.139992277506, -523.8839592739289, 7.797076472964628, 110.66456497595097, -470.92173756333415, -363.1670773061865, -466.2514268285611, -209.99709604526868, -23.485772147081533, -362.931487450823, -117.11407065873185, -433.5326711937269, -394.4059997320074, 82.28615446851366, -469.26360328827036, -109.77035758007449, -495.84611957440654, -140.54654934086182, -388.2284470357562, -192.25370838835258, -204.3744565601305, 13.215990395944749, -399.35261784813986, -388.342283724542, -392.11069695916075, -472.6418944436066, -194.86817895609016, -372.8490464958547, -26.60762543539856, 104.22741240237508, 51.24795248179852, -380.82763074004623, -345.7983514551556, -58.18131455155075, -386.3500352070204, -484.7040449544376, -322.3706434718489, -510.44302228339933, -428.73125453763777, -475.0140220286263, -422.62452019095144, -26.365471053525805, -438.2315700462592, -294.4652943266963, -245.91369006121283, -446.78784389923794], "policy_predator_policy_reward": [26.72442001767064, 384.50898482691247, 312.72491012090313, 347.0004313267976, 283.7403733282574, 410.7585284053664, 333.75598313497153, 527.4586916622094, 538.7850599938539, 316.04663287200805, 20.63447193425992, 20.819763568635825, 390.72533315860477, 63.13365594468467, 234.31487903077786, 316.4840947973981, 335.9938538469015, 444.8879034612972, 295.270643531661, 481.82053195738143, 87.82195342115607, 340.1049894636483, 485.9154730872077, 455.04676520854684, 249.06848535030974, 521.2922972427426, 249.62936560887513, 340.0420172920019, 348.53013899138455, 428.2112187876684, 350.3406653525874, 356.09116548494274, 93.94944327778454, 463.9738803889779, 382.86580493710426, 211.76218870992986, 375.0216228308471, 137.15658514872854, 442.1933311149548, 252.94799041628377, 371.0389970468125, 530.5460799299927, 239.66457065287725, 521.9267400864933, 77.95644744970758, 54.339765979834525, 84.1445289808887, 364.7482092129398, 288.4781659252227, 92.10657291290434, 494.0580945073803, 88.96277301131128, 429.8532427072471, 378.44343793783133, 35.80948577924495, 396.1996567542781, 488.6229116869934, 456.11117937818227, 247.18314871609948, 301.3552881893448, 499.0939236641533, 452.74678568473956, 514.2742343938551, 113.78276148294651, 143.745865870832, 245.42808069987288, 259.50913045692704, 341.7566843169786, 365.71163900863814, 389.5134703864889, 166.60514570379374, 191.97137320778432, 508.69666044721015, 6.74091992003965, 177.68055821576704, 348.32201544267116, 465.05190378432553, 409.18566476364947, 216.5860735289656, 399.0186512280768, 388.02944698891554, 518.9014926220124, 339.00580007051457, 269.511144464314, 496.7622203777167, 49.466723781881505, 369.9683750985011, 452.8691424869799, 266.67649062000453, 399.7034702658557, 141.91665298520934, 291.1394826897765, 2.3321279085508633, 16.272515307817876, 94.37854832202311, 152.80287570130022, 502.97694912887937, 469.1858026814508, 203.7434026743866, 484.3399128797923, 153.50675977392953, 336.5498591953401, 523.3990045512527, 393.4904521039915, 347.78796496600927, 41.05143569254419, 159.12830113444903, 398.33672826238706, 110.35216607317605, 2.814276484611253, 422.6554161240417, 122.16973428173193, 559.9906601683782, 371.8213856395663, 350.45422266512855, 318.7195263585832, 352.65938545801, 416.00445776428336, 388.48178012355925, 232.06750836616249, 496.4704500244249, 361.13747486084696, 105.04189088795347, 372.66454190454306, 353.15903766782424, 197.6458991751547, 452.57131924565317, 354.93595803096036, 170.95447626932372, 151.87346857947063, 435.059832219567, 424.34930831830394, 225.39934296249282, 380.36885278653523, 370.17131770205515, 17.618557233476793, 334.93576104331044, 410.5901067736125, 200.02472613818048, 443.0698695639793, 333.4787931195401, 201.88540838867996, 218.40892023046018, 128.08094659908605, 348.4319891173734, 259.39601164056506, 366.3572212832832, 325.4195190925837, 364.1306775343078, 363.77001168294686, 318.2909722133853, 499.461597013809, 175.04336709979648, 466.54793284561504, 189.16680872549756, 509.3648191636165, 14.702923527035338, 13.439220688427154, 468.5597986792882, 397.6530622937806, 344.8069864095086, 441.71155772998645, 180.6384379641195, 357.468154214579, 362.73630691645167, 206.42619195310746, 338.29795677872875, 154.21176107099606, 451.8567643818977, 142.66438470912647, 430.5377683988163, 488.4873365920084, 443.0237694641417, 214.19202861020685, 6.339582894844819, 268.5563726508021, 396.7498483231213, 470.3024687930858, 393.51069695916067, 470.1468913995172, 212.86041960651465, 397.9553473228217, 43.107625435398795, 52.272587597624934, 285.12548032733866, 351.80357395725986, 192.94656137852272, 283.7840098116241, 391.55003520702064, 487.0095656655558, 321.24843897289895, 512.4430222833993, 448.7264738888814, 452.11025411421883, 426.2027994220894, 155.20866781078695, 432.5090749142161, 314.7280177351162, 370.20834890418814, 396.28540493516056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.304246844778836, "mean_inference_ms": 5.964049620750327, "mean_action_processing_ms": 62.33844583752295, "mean_env_wait_ms": 1.8676990307291674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007318019866943359, "StateBufferConnector_ms": 0.01626420021057129, "ViewRequirementAgentConnector_ms": 0.11017286777496338}, "num_episodes": 0, "episode_return_max": 313.09236192985804, "episode_return_min": -5.3975059924949065, "episode_return_mean": 88.19219165921123, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 259.0502598899814, "num_env_steps_trained_throughput_per_sec": 259.0502598899814, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 45645.707, "restore_workers_time_ms": 4.277, "training_step_time_ms": 45623.493, "sample_time_ms": 8142.862, "learn_time_ms": 39261.537, "learn_throughput": 203.762, "synch_weights_time_ms": 945.481}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 16, "trial_id": "cdf01_00000", "date": "2024-08-20_10-32-48", "timestamp": 1724130168, "time_this_iter_s": 30.919442176818848, "time_total_s": 685.7967085838318, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5292700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 685.7967085838318, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.911363636363646, "ram_util_percent": 83.05227272727271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5883257502601262, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 8.769930518619597, "policy_loss": -0.005145219347572752, "vf_loss": 8.775002938225155, "vf_explained_var": 0.08772241851640127, "kl": 0.0029124255592626195, "entropy": 0.5091726582674753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.278560302087239, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 8.841833213018992, "policy_loss": -0.0063746306749563365, "vf_loss": 8.84789851657928, "vf_explained_var": 0.07429034672086202, "kl": 0.006185639477763967, "entropy": 0.8056751178370581, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 9765.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 351.51663361353906, "episode_reward_min": -7.508515788656972, "episode_reward_mean": 89.9538637234877, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -661.4304399668131, "predator_policy": 6.339582894844819}, "policy_reward_max": {"prey_policy": 143.19529865778622, "predator_policy": 661.5310878902939}, "policy_reward_mean": {"prey_policy": -297.3026158954756, "predator_policy": 342.27954775721946}, "custom_metrics": {}, "hist_stats": {"episode_reward": [169.93527894388953, 10.299999999999981, 7.699999999999999, 5.299999999999997, 96.72898706934966, 289.7876608926911, 146.60378566437785, 32.124046103547904, 110.27002126566555, 151.68933258079397, 18.51575701710113, 180.3898725862303, 15.487188222678999, 282.6324360755578, 76.73364265023939, 83.73748938146096, 79.35741554352393, -1.0950030440893856, 43.09854147739105, 172.9999999999995, 307.34937602635193, 72.75090518343998, 7.505520711118215, 0.8777955010503289, -2.9085485631637904, 132.4214759883994, 14.54022827637618, 73.79221987889689, 77.88010491107308, 111.02127261015063, 1.705935898839245, 74.07767441922661, 3.658717733670498, 4.240721512227914, 0.9999999999999978, 3.7209300588415477, 200.66900898540584, 3.900000000000002, 46.358756184120125, -0.8354975374675264, 136.90673611420226, -0.1352362910949152, 93.32168491187912, 2.9797149394879248, 351.51663361353906, 125.3772316139694, 257.7061877398124, 244.44831719721503, 85.26689627903, 101.18817349526351, 4.299999999999999, 167.42710877481596, 200.239137997694, 24.41120536036354, 4.007236586451379, 133.69230038118138, 0.2000000000000024, 3.416085803827597, 0.3459892589046798, 118.0600025064552, 114.15786685527468, 12.556650848090303, 193.249236029376, 10.172360817087611, 38.5355161822107, 8.751170840371921, 124.16904714192952, 2.0174883435969644, 120.02762590968193, 2.900000000000002, 16.699933995342015, 94.54039591712935, 4.440892098500626e-16, 224.0380573913099, 43.939672309885545, 99.64472673291594, -7.508515788656972, 69.89894697425582, 15.738947764088199, 216.8002296972286, 106.67849279223785, 209.6193248328494, 228.01661445374592, 133.03705768494493, 54.341610892724475, 34.02841966884055, 285.9590151239471, 11.59487591463672, 45.34020741810136, 0.19999999999999707, 11.725664531717346, 205.66220622645727, 348.3715788909413, 130.01271446610025, 258.1583936774811, 17.069508396425093, 323.0437176631423, 4.359807277137758, 27.13934798425714, -4.440892098500626e-15], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.2894920015523272, -439.18221381560124, -360.3572212832832, -321.1195190925828, -363.63067753430767, -356.5700116829467, -312.9909722133853, -499.461597013809, -101.13429881307823, -443.7280140629844, 115.139992277506, -523.8839592739289, 7.797076472964628, 110.66456497595097, -470.92173756333415, -363.1670773061865, -466.2514268285611, -209.99709604526868, -23.485772147081533, -362.931487450823, -117.11407065873185, -433.5326711937269, -394.4059997320074, 82.28615446851366, -469.26360328827036, -109.77035758007449, -495.84611957440654, -140.54654934086182, -388.2284470357562, -192.25370838835258, -204.3744565601305, 13.215990395944749, -399.35261784813986, -388.342283724542, -392.11069695916075, -472.6418944436066, -194.86817895609016, -372.8490464958547, -26.60762543539856, 104.22741240237508, 51.24795248179852, -380.82763074004623, -345.7983514551556, -58.18131455155075, -386.3500352070204, -484.7040449544376, -322.3706434718489, -510.44302228339933, -428.73125453763777, -475.0140220286263, -422.62452019095144, -26.365471053525805, -438.2315700462592, -294.4652943266963, -245.91369006121283, -446.78784389923794, -409.99821790830623, -377.00082677112175, -360.71073438990186, -143.05202339661443, -394.5332985301473, -505.3380472651627, -280.18365226050736, -230.09359523047576, -244.4288091118364, -517.3583429508903, -143.00379503891097, -405.30494662445346, -536.9942608840767, -436.0344838578489, -456.5464519555481, -313.345297637361, 113.4496352213524, -350.2045679971554, -467.54494359357517, -416.3206748351679, -223.35110593740092, -399.856919295113, -343.71231760289896, -469.2213698702589, -376.7265103155692, -174.1824438988168, -599.0482761281547, -388.39628320008336, -303.8201324804749, -126.5831541236887, -435.7602915290469, -367.9174375245918, -351.1604725589998, 104.50871274364013, -54.696673814602136, -430.49708807656464, -50.569624551310476, -381.20533102113063, -374.0511823849627, 28.24870123024613, -233.482183950353, -278.15258292275075, -375.9291145850682, -90.34365149615085, -495.93059174615803, -602.0232539008563, 68.8696464443422, -349.3074576844185, -372.1989324664139, -104.60293202912031, -399.02692387887225, -309.68597719812465, -293.5832913592662, -364.4092635564433, 101.4360144995472, -441.242895993898, -317.3736896342407, -490.33581263298146, -463.0579784950493, -334.7342515604637, -399.06051330012406, -577.3159892935893, 35.63550276807046, -254.72542029242385, -481.0368856061417, 91.38034055957783, -599.2930272312498, -327.361875522724, -482.66859361898105, 29.349517221993324, -327.2842364809214, -341.9916305863066, -310.22547336921315, -413.72771485607984, -418.3120574020959, -163.80865145553003, 7.797253866153909, -471.4157586064342, -661.4304399668131, -592.5440854586026, -303.360840367338, -21.40682461963399, -371.80523071631825, -584.6937342642372, -465.8770279967061, -295.229953994842, -289.99445328491026, -62.03502096500834, -463.4201455991279, -538.2106526665009, -139.5324690838797, -511.1737972288301, -415.2793566076357, -449.49941207763317, -12.853779843442723, -487.999906680468, -572.8064613212513, -316.62499230698575, -47.25294064455809, -357.68456206740564, -528.5083070101454, -312.42760465449595, 65.47847929187127, -505.7430439712212, -406.2658924689673, 29.10009179541153, -368.6633655926362, 80.17990772150483, -172.44642200448752, -375.35087228542676, -29.024915287981884, -329.06490736553644, -374.0418034767583, 2.809858831788368, -78.31554014247403, -585.3144520668112, -384.59067066322143, -48.86290411166943, -347.20356113646454, -47.557338721614535, -253.00556924709335, -393.30663256516834, -447.16053521786847, -434.241520737817, -339.7834077289693, -2.1844962637425125, -5.277113191660122, -215.56487439832586, 143.19529865778622, -498.3769193286437, -523.1013177522525, -252.47844713666143, 115.679543451433, -353.8152126767228, -330.61859920509596, -334.315474647084, -497.3280569493563, 91.5315466970612, -293.88322703809723, -511.75949661897937, -232.78915100446062, -514.1759623479527, -462.15227541391414, -505.4935719665402], "policy_predator_policy_reward": [348.4319891173734, 259.39601164056506, 366.3572212832832, 325.4195190925837, 364.1306775343078, 363.77001168294686, 318.2909722133853, 499.461597013809, 175.04336709979648, 466.54793284561504, 189.16680872549756, 509.3648191636165, 14.702923527035338, 13.439220688427154, 468.5597986792882, 397.6530622937806, 344.8069864095086, 441.71155772998645, 180.6384379641195, 357.468154214579, 362.73630691645167, 206.42619195310746, 338.29795677872875, 154.21176107099606, 451.8567643818977, 142.66438470912647, 430.5377683988163, 488.4873365920084, 443.0237694641417, 214.19202861020685, 6.339582894844819, 268.5563726508021, 396.7498483231213, 470.3024687930858, 393.51069695916067, 470.1468913995172, 212.86041960651465, 397.9553473228217, 43.107625435398795, 52.272587597624934, 285.12548032733866, 351.80357395725986, 192.94656137852272, 283.7840098116241, 391.55003520702064, 487.0095656655558, 321.24843897289895, 512.4430222833993, 448.7264738888814, 452.11025411421883, 426.2027994220894, 155.20866781078695, 432.5090749142161, 314.7280177351162, 370.20834890418814, 396.28540493516056, 379.09584663956025, 485.7833029509426, 285.88900524504226, 328.8950251516244, 394.85382011099574, 506.7234615831534, 358.0805397357281, 226.27438217448073, 248.08752684550686, 517.3583429508903, 133.95246307648938, 418.59700009910284, 536.9942608840767, 437.0344838578489, 456.5464519555481, 317.0662276962024, 132.56032989509623, 304.86361186611333, 471.1449435935752, 416.62067483516785, 290.38572298609483, 379.18105843053877, 342.6625089988773, 469.435680936813, 354.7997405801072, 333.01594974848075, 599.6219262826226, 387.68739675452076, 317.97211571366427, 205.7528558023786, 438.7493191354496, 367.90812485767725, 303.6312744992105, 294.5371189296879, 370.46380084235545, 240.10719266278167, 262.51273130765276, 426.96841200460204, 343.646904766129, 246.6038935858032, 372.382213716115, 224.51944943601856, 257.2278030146328, 310.23313656184973, 495.93059174615803, 606.3232539008563, 238.83069698006514, 209.03422303482688, 272.1853221604003, 404.8556803328275, 411.82413072238955, 321.2999757149712, 233.76747288999297, 428.2323186121689, 31.056285881634068, 442.4428959938983, 317.5736896342407, 490.33581263298146, 463.15546772713077, 338.05284813220993, 396.86070905205884, 579.8617828005591, 330.66986459882315, 6.480055431985338, 480.783837498693, 23.0305744031455, 599.2930272312498, 339.91852637081405, 198.42070799005506, 448.1476044363089, 331.0565972980089, 348.3916305863065, 348.7609895514237, 413.72771485607984, 419.1234929239687, 171.74838677402872, 122.52408541102265, 465.26346647118737, 661.5310878902939, 594.4609258787189, 252.0235506205393, 192.77174027611463, 374.70523071631817, 584.6937342642372, 475.8770279967061, 301.92988799018394, 292.9830732334102, 153.58679693363771, 463.4201455991279, 538.2106526665009, 376.017672268536, 498.72665143548346, 535.7101564682847, 373.0082845268698, 347.22501059227557, 253.273402664552, 377.42249933383044, 504.5004385057491, 197.0447672721113, 277.7916824141085, 528.6083070101453, 328.06655241858454, 177.1395844756852, 479.925209900893, 406.4658924689673, 77.37840099682626, 293.2160164930613, 204.8867662109202, 476.63142915057347, 299.18247959308786, 225.48137552728488, 265.6455048111794, 369.08193372129193, 56.49162181640251, 316.70183822201255, 380.9565736561125, 351.9730782479089, 367.4395116509292, 246.51961954209324, 159.83615623062283, 331.8909676634632, 359.76144156689963, 447.16053521786847, 434.44152073781703, 342.4211300688009, 11.272438455628203, 170.22046616093147, 256.2837276555117, 232.62104349321328, 470.93215606858456, 504.5803489801247, 401.012130374889, 325.11718228612887, 171.17688061664165, 349.68498304350965, 332.3185992050959, 389.59860270956256, 339.24162520587555, 298.243034315235, 511.75949661897937, 259.49347634939954, 514.6109849872705, 462.15227541391414, 505.4935719665402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.904661396535612, "mean_inference_ms": 5.7416056919863205, "mean_action_processing_ms": 54.92332459894183, "mean_env_wait_ms": 1.8024658539390659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003329634666442871, "StateBufferConnector_ms": 0.016046643257141113, "ViewRequirementAgentConnector_ms": 0.10447573661804199}, "num_episodes": 72, "episode_return_max": 351.51663361353906, "episode_return_min": -7.508515788656972, "episode_return_mean": 89.9538637234877, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 247.94532386083156, "num_env_steps_trained_throughput_per_sec": 247.94532386083156, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 36394.925, "restore_workers_time_ms": 4.27, "training_step_time_ms": 36372.718, "sample_time_ms": 7904.681, "learn_time_ms": 39519.37, "learn_throughput": 202.432, "synch_weights_time_ms": 946.132}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 17, "trial_id": "cdf01_00000", "date": "2024-08-20_10-33-20", "timestamp": 1724130200, "time_this_iter_s": 32.30884313583374, "time_total_s": 718.1055517196655, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e8e5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 718.1055517196655, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 46.02173913043478, "ram_util_percent": 82.89782608695654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.355418203274409, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 0.0001, "total_loss": 8.69054199551779, "policy_loss": -0.005212493179853828, "vf_loss": 8.695698323325505, "vf_explained_var": 0.18530975286922757, "kl": 0.004493604052752036, "entropy": 0.5159861417989883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2762625416592945, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 8.820041243992154, "policy_loss": -0.0054268845534395605, "vf_loss": 8.825215330578033, "vf_explained_var": 0.13407756818665398, "kl": 0.005056171347206102, "entropy": 0.8358096784069424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 351.51663361353906, "episode_reward_min": -7.508515788656972, "episode_reward_mean": 89.27561271049197, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -661.4304399668131, "predator_policy": 6.339582894844819}, "policy_reward_max": {"prey_policy": 143.19529865778622, "predator_policy": 661.5310878902939}, "policy_reward_mean": {"prey_policy": -297.4095098319755, "predator_policy": 342.0473161872215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [110.27002126566555, 151.68933258079397, 18.51575701710113, 180.3898725862303, 15.487188222678999, 282.6324360755578, 76.73364265023939, 83.73748938146096, 79.35741554352393, -1.0950030440893856, 43.09854147739105, 172.9999999999995, 307.34937602635193, 72.75090518343998, 7.505520711118215, 0.8777955010503289, -2.9085485631637904, 132.4214759883994, 14.54022827637618, 73.79221987889689, 77.88010491107308, 111.02127261015063, 1.705935898839245, 74.07767441922661, 3.658717733670498, 4.240721512227914, 0.9999999999999978, 3.7209300588415477, 200.66900898540584, 3.900000000000002, 46.358756184120125, -0.8354975374675264, 136.90673611420226, -0.1352362910949152, 93.32168491187912, 2.9797149394879248, 351.51663361353906, 125.3772316139694, 257.7061877398124, 244.44831719721503, 85.26689627903, 101.18817349526351, 4.299999999999999, 167.42710877481596, 200.239137997694, 24.41120536036354, 4.007236586451379, 133.69230038118138, 0.2000000000000024, 3.416085803827597, 0.3459892589046798, 118.0600025064552, 114.15786685527468, 12.556650848090303, 193.249236029376, 10.172360817087611, 38.5355161822107, 8.751170840371921, 124.16904714192952, 2.0174883435969644, 120.02762590968193, 2.900000000000002, 16.699933995342015, 94.54039591712935, 4.440892098500626e-16, 224.0380573913099, 43.939672309885545, 99.64472673291594, -7.508515788656972, 69.89894697425582, 15.738947764088199, 216.8002296972286, 106.67849279223785, 209.6193248328494, 228.01661445374592, 133.03705768494493, 54.341610892724475, 34.02841966884055, 285.9590151239471, 11.59487591463672, 45.34020741810136, 0.19999999999999707, 11.725664531717346, 205.66220622645727, 348.3715788909413, 130.01271446610025, 258.1583936774811, 17.069508396425093, 323.0437176631423, 4.359807277137758, 27.13934798425714, -4.440892098500626e-15, 208.82692457192212, 17.099736064987262, 0.014926922713775603, 29.554710083529393, 139.66403051977034, 124.01545420996482, 7.489961308684652, 163.9889136927111], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-466.2514268285611, -209.99709604526868, -23.485772147081533, -362.931487450823, -117.11407065873185, -433.5326711937269, -394.4059997320074, 82.28615446851366, -469.26360328827036, -109.77035758007449, -495.84611957440654, -140.54654934086182, -388.2284470357562, -192.25370838835258, -204.3744565601305, 13.215990395944749, -399.35261784813986, -388.342283724542, -392.11069695916075, -472.6418944436066, -194.86817895609016, -372.8490464958547, -26.60762543539856, 104.22741240237508, 51.24795248179852, -380.82763074004623, -345.7983514551556, -58.18131455155075, -386.3500352070204, -484.7040449544376, -322.3706434718489, -510.44302228339933, -428.73125453763777, -475.0140220286263, -422.62452019095144, -26.365471053525805, -438.2315700462592, -294.4652943266963, -245.91369006121283, -446.78784389923794, -409.99821790830623, -377.00082677112175, -360.71073438990186, -143.05202339661443, -394.5332985301473, -505.3380472651627, -280.18365226050736, -230.09359523047576, -244.4288091118364, -517.3583429508903, -143.00379503891097, -405.30494662445346, -536.9942608840767, -436.0344838578489, -456.5464519555481, -313.345297637361, 113.4496352213524, -350.2045679971554, -467.54494359357517, -416.3206748351679, -223.35110593740092, -399.856919295113, -343.71231760289896, -469.2213698702589, -376.7265103155692, -174.1824438988168, -599.0482761281547, -388.39628320008336, -303.8201324804749, -126.5831541236887, -435.7602915290469, -367.9174375245918, -351.1604725589998, 104.50871274364013, -54.696673814602136, -430.49708807656464, -50.569624551310476, -381.20533102113063, -374.0511823849627, 28.24870123024613, -233.482183950353, -278.15258292275075, -375.9291145850682, -90.34365149615085, -495.93059174615803, -602.0232539008563, 68.8696464443422, -349.3074576844185, -372.1989324664139, -104.60293202912031, -399.02692387887225, -309.68597719812465, -293.5832913592662, -364.4092635564433, 101.4360144995472, -441.242895993898, -317.3736896342407, -490.33581263298146, -463.0579784950493, -334.7342515604637, -399.06051330012406, -577.3159892935893, 35.63550276807046, -254.72542029242385, -481.0368856061417, 91.38034055957783, -599.2930272312498, -327.361875522724, -482.66859361898105, 29.349517221993324, -327.2842364809214, -341.9916305863066, -310.22547336921315, -413.72771485607984, -418.3120574020959, -163.80865145553003, 7.797253866153909, -471.4157586064342, -661.4304399668131, -592.5440854586026, -303.360840367338, -21.40682461963399, -371.80523071631825, -584.6937342642372, -465.8770279967061, -295.229953994842, -289.99445328491026, -62.03502096500834, -463.4201455991279, -538.2106526665009, -139.5324690838797, -511.1737972288301, -415.2793566076357, -449.49941207763317, -12.853779843442723, -487.999906680468, -572.8064613212513, -316.62499230698575, -47.25294064455809, -357.68456206740564, -528.5083070101454, -312.42760465449595, 65.47847929187127, -505.7430439712212, -406.2658924689673, 29.10009179541153, -368.6633655926362, 80.17990772150483, -172.44642200448752, -375.35087228542676, -29.024915287981884, -329.06490736553644, -374.0418034767583, 2.809858831788368, -78.31554014247403, -585.3144520668112, -384.59067066322143, -48.86290411166943, -347.20356113646454, -47.557338721614535, -253.00556924709335, -393.30663256516834, -447.16053521786847, -434.241520737817, -339.7834077289693, -2.1844962637425125, -5.277113191660122, -215.56487439832586, 143.19529865778622, -498.3769193286437, -523.1013177522525, -252.47844713666143, 115.679543451433, -353.8152126767228, -330.61859920509596, -334.315474647084, -497.3280569493563, 91.5315466970612, -293.88322703809723, -511.75949661897937, -232.78915100446062, -514.1759623479527, -462.15227541391414, -505.4935719665402, 93.25526763125112, -455.6504426764907, -329.84834170354685, -5.7238231228636085, -470.1201525052735, -414.63215775883583, -409.7565772308543, -219.91528106613282, -241.2667629567001, -79.53372337341172, -138.81892283601655, -490.04932849006616, -468.3069506216377, -380.2472212985939, -8.236382299714627, -323.78416091855144], "policy_predator_policy_reward": [344.8069864095086, 441.71155772998645, 180.6384379641195, 357.468154214579, 362.73630691645167, 206.42619195310746, 338.29795677872875, 154.21176107099606, 451.8567643818977, 142.66438470912647, 430.5377683988163, 488.4873365920084, 443.0237694641417, 214.19202861020685, 6.339582894844819, 268.5563726508021, 396.7498483231213, 470.3024687930858, 393.51069695916067, 470.1468913995172, 212.86041960651465, 397.9553473228217, 43.107625435398795, 52.272587597624934, 285.12548032733866, 351.80357395725986, 192.94656137852272, 283.7840098116241, 391.55003520702064, 487.0095656655558, 321.24843897289895, 512.4430222833993, 448.7264738888814, 452.11025411421883, 426.2027994220894, 155.20866781078695, 432.5090749142161, 314.7280177351162, 370.20834890418814, 396.28540493516056, 379.09584663956025, 485.7833029509426, 285.88900524504226, 328.8950251516244, 394.85382011099574, 506.7234615831534, 358.0805397357281, 226.27438217448073, 248.08752684550686, 517.3583429508903, 133.95246307648938, 418.59700009910284, 536.9942608840767, 437.0344838578489, 456.5464519555481, 317.0662276962024, 132.56032989509623, 304.86361186611333, 471.1449435935752, 416.62067483516785, 290.38572298609483, 379.18105843053877, 342.6625089988773, 469.435680936813, 354.7997405801072, 333.01594974848075, 599.6219262826226, 387.68739675452076, 317.97211571366427, 205.7528558023786, 438.7493191354496, 367.90812485767725, 303.6312744992105, 294.5371189296879, 370.46380084235545, 240.10719266278167, 262.51273130765276, 426.96841200460204, 343.646904766129, 246.6038935858032, 372.382213716115, 224.51944943601856, 257.2278030146328, 310.23313656184973, 495.93059174615803, 606.3232539008563, 238.83069698006514, 209.03422303482688, 272.1853221604003, 404.8556803328275, 411.82413072238955, 321.2999757149712, 233.76747288999297, 428.2323186121689, 31.056285881634068, 442.4428959938983, 317.5736896342407, 490.33581263298146, 463.15546772713077, 338.05284813220993, 396.86070905205884, 579.8617828005591, 330.66986459882315, 6.480055431985338, 480.783837498693, 23.0305744031455, 599.2930272312498, 339.91852637081405, 198.42070799005506, 448.1476044363089, 331.0565972980089, 348.3916305863065, 348.7609895514237, 413.72771485607984, 419.1234929239687, 171.74838677402872, 122.52408541102265, 465.26346647118737, 661.5310878902939, 594.4609258787189, 252.0235506205393, 192.77174027611463, 374.70523071631817, 584.6937342642372, 475.8770279967061, 301.92988799018394, 292.9830732334102, 153.58679693363771, 463.4201455991279, 538.2106526665009, 376.017672268536, 498.72665143548346, 535.7101564682847, 373.0082845268698, 347.22501059227557, 253.273402664552, 377.42249933383044, 504.5004385057491, 197.0447672721113, 277.7916824141085, 528.6083070101453, 328.06655241858454, 177.1395844756852, 479.925209900893, 406.4658924689673, 77.37840099682626, 293.2160164930613, 204.8867662109202, 476.63142915057347, 299.18247959308786, 225.48137552728488, 265.6455048111794, 369.08193372129193, 56.49162181640251, 316.70183822201255, 380.9565736561125, 351.9730782479089, 367.4395116509292, 246.51961954209324, 159.83615623062283, 331.8909676634632, 359.76144156689963, 447.16053521786847, 434.44152073781703, 342.4211300688009, 11.272438455628203, 170.22046616093147, 256.2837276555117, 232.62104349321328, 470.93215606858456, 504.5803489801247, 401.012130374889, 325.11718228612887, 171.17688061664165, 349.68498304350965, 332.3185992050959, 389.59860270956256, 339.24162520587555, 298.243034315235, 511.75949661897937, 259.49347634939954, 514.6109849872705, 462.15227541391414, 505.4935719665402, 127.16002641027866, 444.06207320688236, 340.4904544754408, 12.181446415956932, 470.13507942798725, 414.63215775883583, 426.82848682511457, 232.39808155540157, 316.1036812954026, 144.36083555447976, 259.35643914908997, 493.52726638695725, 468.3069506216377, 387.73718260727856, 276.5366894604261, 219.4727674505519]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.9306433287221765, "mean_inference_ms": 5.696691635545594, "mean_action_processing_ms": 54.08575305404466, "mean_env_wait_ms": 1.7999592769509207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035676956176757812, "StateBufferConnector_ms": 0.015862226486206055, "ViewRequirementAgentConnector_ms": 0.14478302001953125}, "num_episodes": 8, "episode_return_max": 351.51663361353906, "episode_return_min": -7.508515788656972, "episode_return_mean": 89.27561271049197, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 253.93808021302252, "num_env_steps_trained_throughput_per_sec": 253.93808021302252, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 33370.233, "restore_workers_time_ms": 0.294, "training_step_time_ms": 33368.864, "sample_time_ms": 1904.239, "learn_time_ms": 31426.769, "learn_throughput": 254.56, "synch_weights_time_ms": 28.98}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 18, "trial_id": "cdf01_00000", "date": "2024-08-20_10-33-52", "timestamp": 1724130232, "time_this_iter_s": 31.53944492340088, "time_total_s": 749.6449966430664, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52c48b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 749.6449966430664, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 41.297777777777775, "ram_util_percent": 83.12444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4948017173343233, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 0.0001, "total_loss": 9.044223237416102, "policy_loss": -0.004570157307067088, "vf_loss": 9.04876527634878, "vf_explained_var": 0.10522046495997717, "kl": 0.0044991380754048635, "entropy": 0.4472174681841381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 11025.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2870081597850436, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 9.148608926742796, "policy_loss": -0.00604525327992936, "vf_loss": 9.154325022016252, "vf_explained_var": 0.12582635292931207, "kl": 0.006583339930200184, "entropy": 0.7474099595395346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 11025.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 348.3715788909413, "episode_reward_min": -16.16148256488436, "episode_reward_mean": 89.44858426451512, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -608.7427132840434, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 143.19529865778622, "predator_policy": 626.7565721707651}, "policy_reward_mean": {"prey_policy": -307.7103271958955, "predator_policy": 352.4346193281531}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.440892098500626e-16, 224.0380573913099, 43.939672309885545, 99.64472673291594, -7.508515788656972, 69.89894697425582, 15.738947764088199, 216.8002296972286, 106.67849279223785, 209.6193248328494, 228.01661445374592, 133.03705768494493, 54.341610892724475, 34.02841966884055, 285.9590151239471, 11.59487591463672, 45.34020741810136, 0.19999999999999707, 11.725664531717346, 205.66220622645727, 348.3715788909413, 130.01271446610025, 258.1583936774811, 17.069508396425093, 323.0437176631423, 4.359807277137758, 27.13934798425714, -4.440892098500626e-15, 208.82692457192212, 17.099736064987262, 0.014926922713775603, 29.554710083529393, 139.66403051977034, 124.01545420996482, 7.489961308684652, 163.9889136927111, 2.5673641281409347, 109.48372274226571, 22.63716994275311, 84.44051275518605, 121.20925095184941, 34.61222640073163, 87.3123810657901, 4.952907019044829, 0.47427789903217077, 2.664551033479974, -9.757731912440104, -0.2266560178449557, 150.87000601296177, 98.13116398930788, 37.95503509666131, 258.5095869661021, 83.43468506385503, 11.278705092981458, 27.799999999999997, 14.456180741428824, 6.719061009594648, 205.46224091889616, 53.95998825197931, 29.700000000000152, 2.400000000000003, -0.04565305798526653, 26.15227388267963, 2.2173583793746303, 190.33424234123083, 105.39458021879588, 1.2523147456506152, 112.36675004532616, 9.014920169695499, 140.30204093821865, 26.17239636661976, 38.820890259269376, 10.228609964859315, 210.89805225213186, 246.20964726857326, 107.93520247409384, 14.834577487557945, 36.02233122437827, -16.16148256488436, 120.02806947207438, -2.220446049250313e-16, 223.24521750752575, 7.099999999999996, 286.25994090609606, 282.9410268311767, 1.4999999999999956, 150.5595691837962, 92.1436422405494, -0.011337326899057087, 0.7559646204774422, 240.42732644693388, 0.2846580750777774, 11.859037055065848, 130.48765242745412, 8.506732510010922, 156.7770600785151, 306.2757040643926, 161.73539291037855, 223.68646222004344, 49.73534533050165], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-463.4201455991279, -538.2106526665009, -139.5324690838797, -511.1737972288301, -415.2793566076357, -449.49941207763317, -12.853779843442723, -487.999906680468, -572.8064613212513, -316.62499230698575, -47.25294064455809, -357.68456206740564, -528.5083070101454, -312.42760465449595, 65.47847929187127, -505.7430439712212, -406.2658924689673, 29.10009179541153, -368.6633655926362, 80.17990772150483, -172.44642200448752, -375.35087228542676, -29.024915287981884, -329.06490736553644, -374.0418034767583, 2.809858831788368, -78.31554014247403, -585.3144520668112, -384.59067066322143, -48.86290411166943, -347.20356113646454, -47.557338721614535, -253.00556924709335, -393.30663256516834, -447.16053521786847, -434.241520737817, -339.7834077289693, -2.1844962637425125, -5.277113191660122, -215.56487439832586, 143.19529865778622, -498.3769193286437, -523.1013177522525, -252.47844713666143, 115.679543451433, -353.8152126767228, -330.61859920509596, -334.315474647084, -497.3280569493563, 91.5315466970612, -293.88322703809723, -511.75949661897937, -232.78915100446062, -514.1759623479527, -462.15227541391414, -505.4935719665402, 93.25526763125112, -455.6504426764907, -329.84834170354685, -5.7238231228636085, -470.1201525052735, -414.63215775883583, -409.7565772308543, -219.91528106613282, -241.2667629567001, -79.53372337341172, -138.81892283601655, -490.04932849006616, -468.3069506216377, -380.2472212985939, -8.236382299714627, -323.78416091855144, -486.226247401591, -502.57852948198206, -238.17706507375098, -508.7578543839002, -187.26501556613994, -482.0319844848425, -66.7240914922771, 13.718380798116367, -396.22666220876334, 8.981484656331181, -570.516185816602, -184.14593485153677, -51.346622045272774, -515.0189383899931, -425.6879453625501, -520.3615406943386, -458.96336854458053, -395.59831214700597, -475.4544932291229, -412.6188942272731, -385.46650627121255, -443.1586529147894, -459.03381800772394, -595.4245437390064, -97.6740377798072, -298.4517219924973, -394.68264853931544, 2.751441219208553, -275.75442146016, -389.7084093375914, -518.572402153242, 21.17790209749673, -476.8413574261182, -152.15901717508294, -430.76564098092774, -508.78274735877574, -422.84826150412, -426.78608163708054, -469.47712450708394, -356.39634018512805, -206.12837215477995, -510.7018089883714, 90.94413294856864, -461.1297389359774, -601.9057439967767, -40.24721925653003, 15.007745593653564, -211.19954774876828, -319.8779878997042, -519.8751314718837, -481.7581482241723, -547.8855974552664, -349.4621196832061, -241.4911284740225, -453.12083941544296, -608.7427132840434, -153.63553500605036, -270.9215346862532, -270.4284886317273, -369.6205495450149, -430.48168067803306, -419.40942350315777, -96.95182852723079, -309.54606017954876, -378.10527675781077, -505.7831363982705, -28.38751895859201, -469.5749498058077, -422.5973310272499, -257.5109312584448, -285.4332592063354, -337.8276837944561, -443.3629250604788, -126.58269117013258, 6.5254333336197, -429.3277102766195, -173.78165438644132, -407.9167537534914, -261.59067930019364, -496.7535688047793, -101.59884145390882, -558.2258173252211, -269.0877455582305, -428.9873359907892, -501.167272980496, -17.520528130235814, -12.506608046458615, -51.49771201786743, -596.7369442151969, -481.94300769424626, -544.1659610273172, 123.9260287257906, -295.2526216685318, -282.4159897601833, -482.6193129555565, 142.97833841856897, -338.35083390596265, -171.4965036460899, -536.7198990563604, -485.70066270507607, -135.4527270091122, -426.9262330684638, -435.63759773080045, 52.68676527734728, -509.87218662512805, -475.21589721315956, -434.0718741898692, -482.0552360866088, 93.13515206683715, -448.490111391357, -591.3927896747026, -392.1543659519288, -365.6795322506225, -508.9527817215663, -231.61834303927915, -378.91387438766645, -319.08411340282885, -459.41292639990405, 104.50453174268408, -349.80675743648516, -434.40369613746117, 48.21908376554135, -277.38644741960496, -238.6083728473066, -83.58078599632933, -255.1819499739633, -157.44100130568063, -419.3558010444326], "policy_predator_policy_reward": [463.4201455991279, 538.2106526665009, 376.017672268536, 498.72665143548346, 535.7101564682847, 373.0082845268698, 347.22501059227557, 253.273402664552, 377.42249933383044, 504.5004385057491, 197.0447672721113, 277.7916824141085, 528.6083070101453, 328.06655241858454, 177.1395844756852, 479.925209900893, 406.4658924689673, 77.37840099682626, 293.2160164930613, 204.8867662109202, 476.63142915057347, 299.18247959308786, 225.48137552728488, 265.6455048111794, 369.08193372129193, 56.49162181640251, 316.70183822201255, 380.9565736561125, 351.9730782479089, 367.4395116509292, 246.51961954209324, 159.83615623062283, 331.8909676634632, 359.76144156689963, 447.16053521786847, 434.44152073781703, 342.4211300688009, 11.272438455628203, 170.22046616093147, 256.2837276555117, 232.62104349321328, 470.93215606858456, 504.5803489801247, 401.012130374889, 325.11718228612887, 171.17688061664165, 349.68498304350965, 332.3185992050959, 389.59860270956256, 339.24162520587555, 298.243034315235, 511.75949661897937, 259.49347634939954, 514.6109849872705, 462.15227541391414, 505.4935719665402, 127.16002641027866, 444.06207320688236, 340.4904544754408, 12.181446415956932, 470.13507942798725, 414.63215775883583, 426.82848682511457, 232.39808155540157, 316.1036812954026, 144.36083555447976, 259.35643914908997, 493.52726638695725, 468.3069506216377, 387.73718260727856, 276.5366894604261, 219.4727674505519, 486.1227785548268, 505.24936245688707, 347.0597224918149, 509.3589197081016, 209.90218550889273, 482.0319844848425, 71.43430181804816, 66.01192163129888, 151.33955468023822, 357.11487382404465, 570.6161858166021, 218.65816125226792, 138.72495466293302, 514.952986838123, 426.88794536255017, 524.1144477133836, 459.06336854458056, 395.97259004603825, 484.41734119259394, 406.32059729728195, 396.64576437620127, 422.22166289736026, 459.0936411436023, 595.1380645852831, 322.40728075766197, 224.58848502760415, 394.8826485393155, 95.17972277009974, 312.60945655682116, 390.8084093375914, 437.6343119589085, 318.2697750629389, 473.8058235201855, 238.62923614487082, 440.7982684481112, 510.02882498457376, 449.0482615041207, 428.3860816370807, 453.2220108330278, 387.1076346006136, 212.84743316437445, 510.7018089883714, 140.21508959500588, 435.43275731129893, 174.09655327741905, 522.016398227866, 4.592254406346401, 221.2995477487677, 322.27798789970404, 519.8751314718837, 481.68945766826675, 547.9086349531867, 248.66089204730045, 368.4446299926077, 626.7565721707651, 437.32433890809557, 299.1210868513631, 315.7702251821711, 387.0706172992974, 358.37300109624033, 327.72654400613396, 523.4168749207072, 214.88066616773347, 303.9839725843727, 379.30527675781076, 513.5980565679662, 171.209357218196, 467.05515248442185, 423.78720878575524, 282.4934498665593, 315.5432495411655, 346.5385837188968, 443.46292506047877, 136.7113011349913, 366.7970823161839, 266.90324687894855, 465.4268942095159, 362.4811611989908, 464.7095126191522, 401.56993795991485, 111.66623453741927, 562.9930017292678, 304.91007678261036, 429.18733599078917, 502.52631854584746, 0.0, 181.4537201710462, 2.57866936535478, 596.7369442151969, 481.94300769424626, 173.51764233034334, 469.96750747870925, 295.6526216685318, 289.11598976018485, 462.4309205681894, 163.46999487489438, 346.42245860939283, 446.3659057738361, 536.7198990563604, 487.2006627050762, 378.3013148894465, 334.6372143719256, 435.63759773080045, 39.45687696320221, 509.86084929822897, 475.21589721315956, 434.78700560142534, 482.0960692955301, 255.051700387109, 340.73058538434475, 591.3927896747026, 392.43902402700667, 509.0527817215663, 377.43856930568825, 372.14921098408814, 368.8706588703121, 368.24587820648395, 418.75789410626, 345.0450608217322, 57.03422495058416, 412.893561078299, 279.56675535801236, 277.5893757666543, 400.1408374106352, 279.04317260856885, 283.4060255817669, 345.93413985819234, 280.59800782242235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.666409732449524, "mean_inference_ms": 5.5975152584032575, "mean_action_processing_ms": 49.34702728140903, "mean_env_wait_ms": 1.7602452241542175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056716203689575195, "StateBufferConnector_ms": 0.03449058532714844, "ViewRequirementAgentConnector_ms": 0.21499931812286377}, "num_episodes": 64, "episode_return_max": 348.3715788909413, "episode_return_min": -16.16148256488436, "episode_return_mean": 89.44858426451512, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 249.22221558460168, "num_env_steps_trained_throughput_per_sec": 249.22221558460168, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 32453.597, "restore_workers_time_ms": 0.029, "training_step_time_ms": 32453.224, "sample_time_ms": 1458.065, "learn_time_ms": 30952.829, "learn_throughput": 258.458, "synch_weights_time_ms": 33.732}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 19, "trial_id": "cdf01_00000", "date": "2024-08-20_10-34-24", "timestamp": 1724130264, "time_this_iter_s": 32.14719796180725, "time_total_s": 781.7921946048737, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317ed73a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 781.7921946048737, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 46.31739130434782, "ram_util_percent": 83.00434782608696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.159842564000024, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.0001, "total_loss": 8.606894897279286, "policy_loss": -0.004302494921943262, "vf_loss": 8.611185359954835, "vf_explained_var": 0.1792549797466823, "kl": 0.003857247413074335, "entropy": 0.48325529145816015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 11655.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.70188555499864, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 8.313356345797342, "policy_loss": -0.006268764155665561, "vf_loss": 8.319331635369196, "vf_explained_var": 0.19350887641074166, "kl": 0.005869570651754787, "entropy": 0.7537493596947382, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 11655.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 448.58371232865267, "episode_reward_min": -24.147501423817708, "episode_reward_mean": 101.71468493239335, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -712.0514974572343, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.25430611914118, "predator_policy": 712.1514974572343}, "policy_reward_mean": {"prey_policy": -305.3149302564314, "predator_policy": 356.1722727226281}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.228609964859315, 210.89805225213186, 246.20964726857326, 107.93520247409384, 14.834577487557945, 36.02233122437827, -16.16148256488436, 120.02806947207438, -2.220446049250313e-16, 223.24521750752575, 7.099999999999996, 286.25994090609606, 282.9410268311767, 1.4999999999999956, 150.5595691837962, 92.1436422405494, -0.011337326899057087, 0.7559646204774422, 240.42732644693388, 0.2846580750777774, 11.859037055065848, 130.48765242745412, 8.506732510010922, 156.7770600785151, 306.2757040643926, 161.73539291037855, 223.68646222004344, 49.73534533050165, 69.31552198762195, 337.48497502269726, 3.40967562325193, 186.2744829391343, 190.9989801412928, 137.44829849785904, 80.5044815893041, 87.58149941067477, 80.0255002158364, 292.3208277993072, 4.440892098500626e-15, 2.000000000000001, 82.46926214170774, 2.4000000000000057, 0.10000000000000075, 16.38015842505886, 113.84894807681523, 127.72951536177585, 158.77139492510534, 5.199999999999998, 4.920057555080904, -2.0110856315251446, 36.70000000000024, -24.147501423817708, 24.20000000000004, 158.90523914406663, 17.359947322081815, 268.127136438458, 47.82708052735865, 213.86940345071392, 194.4074009196251, 59.26374079901068, 4.300000000000006, 217.80061137076606, 125.56703552497152, 0.20000000000000107, -8.217159802052707, 124.02120337053441, 91.83005827105362, 151.02454112831083, 2.1157947822769696, -2.220446049250313e-15, 330.2588346272134, 214.17330910599682, 7.005873002082533, 36.13807560636222, 18.9368942405349, 8.592959297604986, 269.2917855652832, 47.76518171427659, 2.03279600846208, 43.31087062401507, 11.91459057814419, 1.1000000000000023, 262.26890047948893, 3.195077985245174, 448.58371232865267, 0.35856434172971463, 3.399999999999999, 97.32090184468763, 333.06580631174216, -3.841768950263063, 0.10000000000000697, 154.1902907662397, 140.35721071825245, 158.5096841781607, 321.44799362139423, 103.74478881878676, 76.34883593736713, 280.01842919046385, 15.516120898594377, 39.77134583457866], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-443.3629250604788, -126.58269117013258, 6.5254333336197, -429.3277102766195, -173.78165438644132, -407.9167537534914, -261.59067930019364, -496.7535688047793, -101.59884145390882, -558.2258173252211, -269.0877455582305, -428.9873359907892, -501.167272980496, -17.520528130235814, -12.506608046458615, -51.49771201786743, -596.7369442151969, -481.94300769424626, -544.1659610273172, 123.9260287257906, -295.2526216685318, -282.4159897601833, -482.6193129555565, 142.97833841856897, -338.35083390596265, -171.4965036460899, -536.7198990563604, -485.70066270507607, -135.4527270091122, -426.9262330684638, -435.63759773080045, 52.68676527734728, -509.87218662512805, -475.21589721315956, -434.0718741898692, -482.0552360866088, 93.13515206683715, -448.490111391357, -591.3927896747026, -392.1543659519288, -365.6795322506225, -508.9527817215663, -231.61834303927915, -378.91387438766645, -319.08411340282885, -459.41292639990405, 104.50453174268408, -349.80675743648516, -434.40369613746117, 48.21908376554135, -277.38644741960496, -238.6083728473066, -83.58078599632933, -255.1819499739633, -157.44100130568063, -419.3558010444326, -301.83935746694124, -424.95077097051814, -5.838352072010782, -267.52546385165004, -436.6404717600302, -373.15678726578574, 176.25430611914118, -181.13955665159995, -253.6988559877136, -305.8420078797479, 48.01921301246261, -393.33917351458007, -153.39149935536062, -302.7563616880647, 69.98044502186215, -328.6084626455139, -20.086763205514472, -472.8450936529936, 143.5756337293949, -425.99182936727584, -539.7126128640234, -694.8085373192581, -420.2255219875257, -545.6566467581902, -1.8960150717641016, -398.97755224251165, -479.6647788289109, -364.81070190861914, -528.4899061882674, -712.0514974572343, -440.3929200798752, -107.60319175316415, -226.86630353704695, 3.0204936762490737, -223.61657062370972, -276.12035113376623, 57.107435111013814, -349.30846950431663, -253.31694792159215, -383.7912721026101, -429.32918406468656, -421.9583745933709, -535.2928093101035, -547.261567162419, 5.276079146911747, -14.539769229810068, -492.31279027277304, -406.3433356993002, -526.24617608938, -61.58077553513183, -88.96934302581587, -378.94174982219505, -333.8096240514476, -351.8517740335431, 97.79104792117298, -391.7620702502682, -135.35834923256292, -335.493866838544, -450.5031520483899, -0.13904039885091085, -500.5030738962135, -87.90036087643462, -299.90481307968304, -416.76039934440666, -430.155487845796, -268.09392556350474, -36.09038179593355, -475.58864324259366, 19.294709440051868, -529.3940503326396, -602.0793896554511, -567.576010829628, -434.03167881473274, -484.0157411461987, -465.77538191926993, 45.21057822730713, -604.6389146064157, -250.12013675448506, 74.69687652053199, -449.2883075495655, -403.37718555134524, -439.66120949733977, -472.38854590323865, -534.45574297253, 48.27304932970109, -431.53028455983275, -439.43873585042155, -33.6120104307799, -380.13404239401206, -630.5553405365407, -236.9858219317467, -473.98400091081936, -224.4710896518641, -426.808641214053, -249.87497744697208, -310.0134338125674, -462.66152472407214, 146.2212175451159, -426.39685747337944, -212.09061081635815, -473.8002984096023, -451.21904048108405, -314.0690242629511, -288.3560127398261, -547.3837557077028, -503.9525109636306, -531.5180042626076, -527.8835087215901, -384.203852460021, 70.42593266221976, -563.4127438668572, -305.33162291172715, 142.39957481799405, -506.61276455805864, -501.35274597846274, -392.17983992846627, -351.0323247445794, -355.4157868136822, -358.8956450343475, -1.1842894422576529, -574.0569522492442, 93.06310157054992, -409.17411164532757, -351.07701731640026, -424.8874719588032, -398.6423986669813, -121.39779246940518, -306.2008881121122, -514.2703653879206, -107.6184782372448, 133.06120161471247, -487.2970856445461, -82.58096298499623, -387.65634031898054, -172.49061603630136, -488.07943900968576, 18.131394022125814, -371.783615043023, 41.00650200723429, -488.9182815466668, -291.92362435451736, -438.1196254444533, -380.1317664069996, -420.643479590127], "policy_predator_policy_reward": [443.46292506047877, 136.7113011349913, 366.7970823161839, 266.90324687894855, 465.4268942095159, 362.4811611989908, 464.7095126191522, 401.56993795991485, 111.66623453741927, 562.9930017292678, 304.91007678261036, 429.18733599078917, 502.52631854584746, 0.0, 181.4537201710462, 2.57866936535478, 596.7369442151969, 481.94300769424626, 173.51764233034334, 469.96750747870925, 295.6526216685318, 289.11598976018485, 462.4309205681894, 163.46999487489438, 346.42245860939283, 446.3659057738361, 536.7198990563604, 487.2006627050762, 378.3013148894465, 334.6372143719256, 435.63759773080045, 39.45687696320221, 509.86084929822897, 475.21589721315956, 434.78700560142534, 482.0960692955301, 255.051700387109, 340.73058538434475, 591.3927896747026, 392.43902402700667, 509.0527817215663, 377.43856930568825, 372.14921098408814, 368.8706588703121, 368.24587820648395, 418.75789410626, 345.0450608217322, 57.03422495058416, 412.893561078299, 279.56675535801236, 277.5893757666543, 400.1408374106352, 279.04317260856885, 283.4060255817669, 345.93413985819234, 280.59800782242235, 300.8966095487948, 495.2090408762861, 359.778265860071, 251.07052508628706, 434.35614050227355, 378.85079414679547, 1.6201768199935696, 189.53955665159947, 176.70003231394568, 573.8398116948077, 115.2055379163225, 367.5627210836552, 228.9784862024735, 307.6738564302558, 8.20105438881259, 338.0084626455138, 100.11226342135097, 472.8450936529936, 410.2980943746641, 164.4389290625227, 539.7126128640234, 694.8085373192581, 422.2255219875257, 545.6566467581902, 90.39019104916122, 392.95263840682446, 479.6647788289109, 367.210701908619, 528.4899061882674, 712.1514974572343, 440.3929200798752, 123.9833501782225, 218.42871697792992, 119.26604095968366, 323.87861132244046, 303.58782579681105, 118.04126062468445, 332.9311686937244, 257.81694792159186, 384.49127210261, 428.70930932115544, 427.49830689198274, 493.14721534745996, 587.3960754935367, 14.223920853088217, 31.739769229810264, 493.1687218123464, 381.33990273590894, 527.24617608938, 84.7807755351312, 180.35590360964875, 446.4604283824302, 332.1244320129183, 370.8969133941546, 243.38501420050164, 318.71314456705113, 239.5566551077023, 279.122641490762, 334.6085660970186, 329.9030298009373, 406.2872210743005, 376.5236146179724, 382.2038867480859, 393.7250664750154, 430.155487845796, 272.39392556350447, 286.0915266192178, 443.388109790076, 165.24538682382817, 470.42098959373095, 602.2793896554512, 567.576010829628, 456.0464426067815, 453.7838175520973, 268.8488478535499, 275.73715920894836, 479.4261327593101, 467.16297687264523, 476.55079377356907, 49.06517838377539, 404.6929803336222, 440.4612094973398, 472.38854590323865, 534.45574297253, 294.3096626110983, 419.20640724624735, 266.9665160229988, 420.2575393642, 430.94596027375627, 586.7492956588791, 273.1238975381087, 473.98400091081936, 415.3756142197787, 254.8410108866723, 362.2543848371884, 206.22698571995613, 420.48044746718307, 165.25164527705738, 222.5050351543764, 463.747614849637, 473.0401637536929, 454.01197114545556, 265.9232060891714, 379.8127015376239, 547.3837557077028, 515.8671015417748, 531.5180042626076, 528.9835087215902, 395.37868269361087, 180.66813758367908, 563.4127438668572, 308.5267008969722, 352.38789642458437, 460.4090056441332, 501.4336763808553, 392.45747386780346, 351.1323247445794, 358.71578681368214, 372.7686795665353, 84.63215675475878, 549.7478728515088, 264.31178413892826, 487.51040218257685, 268.8989578288884, 424.8874719588032, 398.74239866698133, 368.54442704974355, 213.24454429801352, 500.0965355236574, 262.1495188197604, 25.148482563448198, 487.5970856445461, 293.4657303353699, 498.21956659000057, 427.6299375064931, 336.6849063582795, 167.29744448375166, 262.70361247451484, 369.1842563573283, 358.74595237256784, 306.13820363399566, 439.42116706357024, 439.46557312922783, 401.08101870247697]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.589131976700946, "mean_inference_ms": 5.552725115006143, "mean_action_processing_ms": 46.017771585142036, "mean_env_wait_ms": 1.7449658745194778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004796147346496582, "StateBufferConnector_ms": 0.022783994674682617, "ViewRequirementAgentConnector_ms": 0.18600881099700928}, "num_episodes": 72, "episode_return_max": 448.58371232865267, "episode_return_min": -24.147501423817708, "episode_return_mean": 101.71468493239335, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 243.14853017250786, "num_env_steps_trained_throughput_per_sec": 243.14853017250786, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 32515.936, "restore_workers_time_ms": 0.03, "training_step_time_ms": 32515.588, "sample_time_ms": 1538.556, "learn_time_ms": 30929.822, "learn_throughput": 258.65, "synch_weights_time_ms": 37.468}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 20, "trial_id": "cdf01_00000", "date": "2024-08-20_10-34-57", "timestamp": 1724130297, "time_this_iter_s": 32.970245122909546, "time_total_s": 814.7624397277832, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a529eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 814.7624397277832, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 47.8212765957447, "ram_util_percent": 82.96808510638297}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7050148542911288, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.0001, "total_loss": 9.188479683891176, "policy_loss": -0.0038352658595180228, "vf_loss": 9.192307899111793, "vf_explained_var": 0.09609087923216442, "kl": 0.004512516247734224, "entropy": 0.3910169053645361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7410659650015452, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 0.0001, "total_loss": 8.58900441593594, "policy_loss": -0.003975010375743584, "vf_loss": 8.59280351003011, "vf_explained_var": 0.17456314005548992, "kl": 0.0035176590348147863, "entropy": 0.6930012403972565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 448.58371232865267, "episode_reward_min": -24.147501423817708, "episode_reward_mean": 101.71468493239335, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -712.0514974572343, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.25430611914118, "predator_policy": 712.1514974572343}, "policy_reward_mean": {"prey_policy": -305.3149302564314, "predator_policy": 356.1722727226281}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.228609964859315, 210.89805225213186, 246.20964726857326, 107.93520247409384, 14.834577487557945, 36.02233122437827, -16.16148256488436, 120.02806947207438, -2.220446049250313e-16, 223.24521750752575, 7.099999999999996, 286.25994090609606, 282.9410268311767, 1.4999999999999956, 150.5595691837962, 92.1436422405494, -0.011337326899057087, 0.7559646204774422, 240.42732644693388, 0.2846580750777774, 11.859037055065848, 130.48765242745412, 8.506732510010922, 156.7770600785151, 306.2757040643926, 161.73539291037855, 223.68646222004344, 49.73534533050165, 69.31552198762195, 337.48497502269726, 3.40967562325193, 186.2744829391343, 190.9989801412928, 137.44829849785904, 80.5044815893041, 87.58149941067477, 80.0255002158364, 292.3208277993072, 4.440892098500626e-15, 2.000000000000001, 82.46926214170774, 2.4000000000000057, 0.10000000000000075, 16.38015842505886, 113.84894807681523, 127.72951536177585, 158.77139492510534, 5.199999999999998, 4.920057555080904, -2.0110856315251446, 36.70000000000024, -24.147501423817708, 24.20000000000004, 158.90523914406663, 17.359947322081815, 268.127136438458, 47.82708052735865, 213.86940345071392, 194.4074009196251, 59.26374079901068, 4.300000000000006, 217.80061137076606, 125.56703552497152, 0.20000000000000107, -8.217159802052707, 124.02120337053441, 91.83005827105362, 151.02454112831083, 2.1157947822769696, -2.220446049250313e-15, 330.2588346272134, 214.17330910599682, 7.005873002082533, 36.13807560636222, 18.9368942405349, 8.592959297604986, 269.2917855652832, 47.76518171427659, 2.03279600846208, 43.31087062401507, 11.91459057814419, 1.1000000000000023, 262.26890047948893, 3.195077985245174, 448.58371232865267, 0.35856434172971463, 3.399999999999999, 97.32090184468763, 333.06580631174216, -3.841768950263063, 0.10000000000000697, 154.1902907662397, 140.35721071825245, 158.5096841781607, 321.44799362139423, 103.74478881878676, 76.34883593736713, 280.01842919046385, 15.516120898594377, 39.77134583457866], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-443.3629250604788, -126.58269117013258, 6.5254333336197, -429.3277102766195, -173.78165438644132, -407.9167537534914, -261.59067930019364, -496.7535688047793, -101.59884145390882, -558.2258173252211, -269.0877455582305, -428.9873359907892, -501.167272980496, -17.520528130235814, -12.506608046458615, -51.49771201786743, -596.7369442151969, -481.94300769424626, -544.1659610273172, 123.9260287257906, -295.2526216685318, -282.4159897601833, -482.6193129555565, 142.97833841856897, -338.35083390596265, -171.4965036460899, -536.7198990563604, -485.70066270507607, -135.4527270091122, -426.9262330684638, -435.63759773080045, 52.68676527734728, -509.87218662512805, -475.21589721315956, -434.0718741898692, -482.0552360866088, 93.13515206683715, -448.490111391357, -591.3927896747026, -392.1543659519288, -365.6795322506225, -508.9527817215663, -231.61834303927915, -378.91387438766645, -319.08411340282885, -459.41292639990405, 104.50453174268408, -349.80675743648516, -434.40369613746117, 48.21908376554135, -277.38644741960496, -238.6083728473066, -83.58078599632933, -255.1819499739633, -157.44100130568063, -419.3558010444326, -301.83935746694124, -424.95077097051814, -5.838352072010782, -267.52546385165004, -436.6404717600302, -373.15678726578574, 176.25430611914118, -181.13955665159995, -253.6988559877136, -305.8420078797479, 48.01921301246261, -393.33917351458007, -153.39149935536062, -302.7563616880647, 69.98044502186215, -328.6084626455139, -20.086763205514472, -472.8450936529936, 143.5756337293949, -425.99182936727584, -539.7126128640234, -694.8085373192581, -420.2255219875257, -545.6566467581902, -1.8960150717641016, -398.97755224251165, -479.6647788289109, -364.81070190861914, -528.4899061882674, -712.0514974572343, -440.3929200798752, -107.60319175316415, -226.86630353704695, 3.0204936762490737, -223.61657062370972, -276.12035113376623, 57.107435111013814, -349.30846950431663, -253.31694792159215, -383.7912721026101, -429.32918406468656, -421.9583745933709, -535.2928093101035, -547.261567162419, 5.276079146911747, -14.539769229810068, -492.31279027277304, -406.3433356993002, -526.24617608938, -61.58077553513183, -88.96934302581587, -378.94174982219505, -333.8096240514476, -351.8517740335431, 97.79104792117298, -391.7620702502682, -135.35834923256292, -335.493866838544, -450.5031520483899, -0.13904039885091085, -500.5030738962135, -87.90036087643462, -299.90481307968304, -416.76039934440666, -430.155487845796, -268.09392556350474, -36.09038179593355, -475.58864324259366, 19.294709440051868, -529.3940503326396, -602.0793896554511, -567.576010829628, -434.03167881473274, -484.0157411461987, -465.77538191926993, 45.21057822730713, -604.6389146064157, -250.12013675448506, 74.69687652053199, -449.2883075495655, -403.37718555134524, -439.66120949733977, -472.38854590323865, -534.45574297253, 48.27304932970109, -431.53028455983275, -439.43873585042155, -33.6120104307799, -380.13404239401206, -630.5553405365407, -236.9858219317467, -473.98400091081936, -224.4710896518641, -426.808641214053, -249.87497744697208, -310.0134338125674, -462.66152472407214, 146.2212175451159, -426.39685747337944, -212.09061081635815, -473.8002984096023, -451.21904048108405, -314.0690242629511, -288.3560127398261, -547.3837557077028, -503.9525109636306, -531.5180042626076, -527.8835087215901, -384.203852460021, 70.42593266221976, -563.4127438668572, -305.33162291172715, 142.39957481799405, -506.61276455805864, -501.35274597846274, -392.17983992846627, -351.0323247445794, -355.4157868136822, -358.8956450343475, -1.1842894422576529, -574.0569522492442, 93.06310157054992, -409.17411164532757, -351.07701731640026, -424.8874719588032, -398.6423986669813, -121.39779246940518, -306.2008881121122, -514.2703653879206, -107.6184782372448, 133.06120161471247, -487.2970856445461, -82.58096298499623, -387.65634031898054, -172.49061603630136, -488.07943900968576, 18.131394022125814, -371.783615043023, 41.00650200723429, -488.9182815466668, -291.92362435451736, -438.1196254444533, -380.1317664069996, -420.643479590127], "policy_predator_policy_reward": [443.46292506047877, 136.7113011349913, 366.7970823161839, 266.90324687894855, 465.4268942095159, 362.4811611989908, 464.7095126191522, 401.56993795991485, 111.66623453741927, 562.9930017292678, 304.91007678261036, 429.18733599078917, 502.52631854584746, 0.0, 181.4537201710462, 2.57866936535478, 596.7369442151969, 481.94300769424626, 173.51764233034334, 469.96750747870925, 295.6526216685318, 289.11598976018485, 462.4309205681894, 163.46999487489438, 346.42245860939283, 446.3659057738361, 536.7198990563604, 487.2006627050762, 378.3013148894465, 334.6372143719256, 435.63759773080045, 39.45687696320221, 509.86084929822897, 475.21589721315956, 434.78700560142534, 482.0960692955301, 255.051700387109, 340.73058538434475, 591.3927896747026, 392.43902402700667, 509.0527817215663, 377.43856930568825, 372.14921098408814, 368.8706588703121, 368.24587820648395, 418.75789410626, 345.0450608217322, 57.03422495058416, 412.893561078299, 279.56675535801236, 277.5893757666543, 400.1408374106352, 279.04317260856885, 283.4060255817669, 345.93413985819234, 280.59800782242235, 300.8966095487948, 495.2090408762861, 359.778265860071, 251.07052508628706, 434.35614050227355, 378.85079414679547, 1.6201768199935696, 189.53955665159947, 176.70003231394568, 573.8398116948077, 115.2055379163225, 367.5627210836552, 228.9784862024735, 307.6738564302558, 8.20105438881259, 338.0084626455138, 100.11226342135097, 472.8450936529936, 410.2980943746641, 164.4389290625227, 539.7126128640234, 694.8085373192581, 422.2255219875257, 545.6566467581902, 90.39019104916122, 392.95263840682446, 479.6647788289109, 367.210701908619, 528.4899061882674, 712.1514974572343, 440.3929200798752, 123.9833501782225, 218.42871697792992, 119.26604095968366, 323.87861132244046, 303.58782579681105, 118.04126062468445, 332.9311686937244, 257.81694792159186, 384.49127210261, 428.70930932115544, 427.49830689198274, 493.14721534745996, 587.3960754935367, 14.223920853088217, 31.739769229810264, 493.1687218123464, 381.33990273590894, 527.24617608938, 84.7807755351312, 180.35590360964875, 446.4604283824302, 332.1244320129183, 370.8969133941546, 243.38501420050164, 318.71314456705113, 239.5566551077023, 279.122641490762, 334.6085660970186, 329.9030298009373, 406.2872210743005, 376.5236146179724, 382.2038867480859, 393.7250664750154, 430.155487845796, 272.39392556350447, 286.0915266192178, 443.388109790076, 165.24538682382817, 470.42098959373095, 602.2793896554512, 567.576010829628, 456.0464426067815, 453.7838175520973, 268.8488478535499, 275.73715920894836, 479.4261327593101, 467.16297687264523, 476.55079377356907, 49.06517838377539, 404.6929803336222, 440.4612094973398, 472.38854590323865, 534.45574297253, 294.3096626110983, 419.20640724624735, 266.9665160229988, 420.2575393642, 430.94596027375627, 586.7492956588791, 273.1238975381087, 473.98400091081936, 415.3756142197787, 254.8410108866723, 362.2543848371884, 206.22698571995613, 420.48044746718307, 165.25164527705738, 222.5050351543764, 463.747614849637, 473.0401637536929, 454.01197114545556, 265.9232060891714, 379.8127015376239, 547.3837557077028, 515.8671015417748, 531.5180042626076, 528.9835087215902, 395.37868269361087, 180.66813758367908, 563.4127438668572, 308.5267008969722, 352.38789642458437, 460.4090056441332, 501.4336763808553, 392.45747386780346, 351.1323247445794, 358.71578681368214, 372.7686795665353, 84.63215675475878, 549.7478728515088, 264.31178413892826, 487.51040218257685, 268.8989578288884, 424.8874719588032, 398.74239866698133, 368.54442704974355, 213.24454429801352, 500.0965355236574, 262.1495188197604, 25.148482563448198, 487.5970856445461, 293.4657303353699, 498.21956659000057, 427.6299375064931, 336.6849063582795, 167.29744448375166, 262.70361247451484, 369.1842563573283, 358.74595237256784, 306.13820363399566, 439.42116706357024, 439.46557312922783, 401.08101870247697]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.589131976700946, "mean_inference_ms": 5.552725115006143, "mean_action_processing_ms": 46.017771585142036, "mean_env_wait_ms": 1.7449658745194778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004796147346496582, "StateBufferConnector_ms": 0.022783994674682617, "ViewRequirementAgentConnector_ms": 0.18600881099700928}, "num_episodes": 0, "episode_return_max": 448.58371232865267, "episode_return_min": -24.147501423817708, "episode_return_mean": 101.71468493239335, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 176.04048956778624, "num_env_steps_trained_throughput_per_sec": 176.04048956778624, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 33870.622, "restore_workers_time_ms": 0.026, "training_step_time_ms": 33870.23, "sample_time_ms": 1613.367, "learn_time_ms": 32207.843, "learn_throughput": 248.387, "synch_weights_time_ms": 38.933}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 21, "trial_id": "cdf01_00000", "date": "2024-08-20_10-35-42", "timestamp": 1724130342, "time_this_iter_s": 45.50605297088623, "time_total_s": 860.2684926986694, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5292430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 860.2684926986694, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 76.6640625, "ram_util_percent": 83.19062500000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.918184064494239, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.0001, "total_loss": 8.533843047278268, "policy_loss": -0.0038968592490409575, "vf_loss": 8.537737458092826, "vf_explained_var": 0.11550448584178137, "kl": 0.0031630393203895004, "entropy": 0.42520591044236744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 12915.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6730191824928162, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 8.058513893399919, "policy_loss": -0.008287589633763429, "vf_loss": 8.06661569353134, "vf_explained_var": 0.27224396050922456, "kl": 0.0074300563945779155, "entropy": 0.6714710695402962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 12915.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 448.58371232865267, "episode_reward_min": -25.464009639025313, "episode_reward_mean": 100.68148678947443, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -680.4886674089794, "predator_policy": 23.610598696974193}, "policy_reward_max": {"prey_policy": 146.2212175451159, "predator_policy": 650.428330031721}, "policy_reward_mean": {"prey_policy": -305.0005159430421, "predator_policy": 355.34125933777943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.005873002082533, 36.13807560636222, 18.9368942405349, 8.592959297604986, 269.2917855652832, 47.76518171427659, 2.03279600846208, 43.31087062401507, 11.91459057814419, 1.1000000000000023, 262.26890047948893, 3.195077985245174, 448.58371232865267, 0.35856434172971463, 3.399999999999999, 97.32090184468763, 333.06580631174216, -3.841768950263063, 0.10000000000000697, 154.1902907662397, 140.35721071825245, 158.5096841781607, 321.44799362139423, 103.74478881878676, 76.34883593736713, 280.01842919046385, 15.516120898594377, 39.77134583457866, 6.661338147750939e-16, 125.30718898686392, 103.00670044961157, 94.60569109537816, 154.94389826792184, 0.8139027985164995, 102.49537874334125, 84.99931778368963, 97.45516330902984, 38.1618889238642, 136.1702072302327, 254.27020929442696, 1.7424717139701116, 106.19470899277911, 17.114430253503826, 48.5802133821157, 3.7312573650348, 0.25500087408421224, 79.79821735205033, 2.0000000000000036, 108.90707810633101, 134.04225061844673, 120.45977400353344, 99.41746920456558, 269.52217274842667, -25.464009639025313, 179.05585609925012, 2.7026741735519497, -0.14435746950429196, 17.99986253214825, 35.836063914737785, 7.0510708378594105, 12.598483313472691, 137.31108143908077, 211.08042108089532, 260.18630291015177, 270.7787723916404, 24.28021535719033, 94.29774116206598, 314.8747539367786, 73.13001835433629, 0.0999999999999992, 25.000000000000014, -2.6645352591003757e-15, 37.08326840569673, 239.62704406564325, 262.6126172362233, 0.14279261821355682, 66.27746842786036, 0.6000000000000039, 71.31509008617215, 2.220446049250313e-15, 243.1257186825412, 44.07976117564284, 133.46620623498956, 12.294941967339467, 38.82731495962082, -9.606552877709179, 13.599253355962855, 195.76375048941603, 167.32610359393453, 0.29999999999999893, 43.376742024527275, 112.66769001700868, 271.6705944374962, 228.3482223834207, 314.47575740037763, 1.441622599749968, 78.32854719322629, 346.1398964463485, 79.2365409563442, 370.51382423316403], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-380.13404239401206, -630.5553405365407, -236.9858219317467, -473.98400091081936, -224.4710896518641, -426.808641214053, -249.87497744697208, -310.0134338125674, -462.66152472407214, 146.2212175451159, -426.39685747337944, -212.09061081635815, -473.8002984096023, -451.21904048108405, -314.0690242629511, -288.3560127398261, -547.3837557077028, -503.9525109636306, -531.5180042626076, -527.8835087215901, -384.203852460021, 70.42593266221976, -563.4127438668572, -305.33162291172715, 142.39957481799405, -506.61276455805864, -501.35274597846274, -392.17983992846627, -351.0323247445794, -355.4157868136822, -358.8956450343475, -1.1842894422576529, -574.0569522492442, 93.06310157054992, -409.17411164532757, -351.07701731640026, -424.8874719588032, -398.6423986669813, -121.39779246940518, -306.2008881121122, -514.2703653879206, -107.6184782372448, 133.06120161471247, -487.2970856445461, -82.58096298499623, -387.65634031898054, -172.49061603630136, -488.07943900968576, 18.131394022125814, -371.783615043023, 41.00650200723429, -488.9182815466668, -291.92362435451736, -438.1196254444533, -380.1317664069996, -420.643479590127, -472.10131692548055, -534.230982725595, -306.62071525146314, -46.29327078575378, -404.02215536443117, -111.7719173082123, -439.4439744123348, -30.71017390230015, -489.7426637126445, -206.2419343017665, -337.1372191193747, -386.20618103841355, -355.7555097477755, -6.7742702204124114, -448.0708397418634, -109.53005253303394, -302.95364885728156, -73.00773619175467, -311.1462052099163, -287.2295593635924, -205.45105998249832, -31.140943507184012, -442.1164371586318, 121.48136656640972, -369.08424280411924, -316.28144976286086, -65.67487352330453, -203.9995737867587, -257.9990448663171, -512.9525250600011, -283.2461401776695, -334.4412312722838, -400.6303113343649, -225.3442132419526, -341.8061486237172, -395.9587290640379, 54.189343984875144, -418.589020027039, -374.16511752366443, -458.11293238685954, -313.0232750765537, -386.5233628358488, -569.9188271620475, -2.452952501215435, -445.4391380537248, -95.36494343492998, -305.1704391627042, -437.65774450928205, -680.4886674089794, 68.37356389883884, -391.43562622158333, -318.9709155482359, 44.20220459732937, -553.6817946752617, -326.8079331869542, -278.40300927036867, -496.54649267118924, -419.2191648511998, -350.8818287479223, -617.1419778886477, -414.8071422584194, -288.36225710345445, -493.38602930112955, -419.12349849962703, -420.40760245482255, -430.3819186535533, -333.1079742522517, -117.13536914497958, -487.60816753441077, -121.68157540122296, 54.705619637308686, -284.8148395791544, -354.0818116282954, 91.09999999999934, -398.04411905984387, -148.89407293394902, -555.5619866416515, -72.8600709024789, 14.579716890636671, -550.6620246451897, 5.57509216254989, -487.84076925573237, -424.86229177973706, -366.1560391777493, -355.1887444057147, -202.01235332742831, -360.9063439701706, -516.0576239875473, -529.7624090918765, -175.5577458747457, 12.12162778409713, -465.11821084852033, 118.55441635023506, -488.64289725424504, -471.70834551744383, -370.2460650776368, -390.28394889002215, 7.698203205631694, -574.9685273582713, -592.6208011689656, -10.537370031949683, -392.5217920943505, -471.17053749989134, -430.2962659217555, -375.02199146640686, 16.06477212965318, -424.83147616986736, -174.74889677708313, -100.39249572903273, -370.75525291505795, -570.0711470372711, -276.6253731359919, -460.3722527881819, -411.45905282146293, -571.2513017212502, -361.06124678334777, -295.5234831971382, -376.70173248505273, -29.39153508539475, 120.72823328469539, -195.2949016874209, -382.62321134790164, -335.6710394663436, -540.869196926364, -98.21263265479085, -382.9031873551957, -375.07351822073247, -113.1788948297391, -358.78297978101403, 20.365335007450497, -4.1634567636863675, -415.27618653850743, -677.1951793261095, 10.968822652421316, -344.42679915521427, -451.67696174871924, -65.43663388897882, -532.9995095714277, -407.4782598874016, 32.39388697982013, 8.287227756596797, -534.28986453001, -586.6912572378866, 15.871744468142012], "policy_predator_policy_reward": [430.94596027375627, 586.7492956588791, 273.1238975381087, 473.98400091081936, 415.3756142197787, 254.8410108866723, 362.2543848371884, 206.22698571995613, 420.48044746718307, 165.25164527705738, 222.5050351543764, 463.747614849637, 473.0401637536929, 454.01197114545556, 265.9232060891714, 379.8127015376239, 547.3837557077028, 515.8671015417748, 531.5180042626076, 528.9835087215902, 395.37868269361087, 180.66813758367908, 563.4127438668572, 308.5267008969722, 352.38789642458437, 460.4090056441332, 501.4336763808553, 392.45747386780346, 351.1323247445794, 358.71578681368214, 372.7686795665353, 84.63215675475878, 549.7478728515088, 264.31178413892826, 487.51040218257685, 268.8989578288884, 424.8874719588032, 398.74239866698133, 368.54442704974355, 213.24454429801352, 500.0965355236574, 262.1495188197604, 25.148482563448198, 487.5970856445461, 293.4657303353699, 498.21956659000057, 427.6299375064931, 336.6849063582795, 167.29744448375166, 262.70361247451484, 369.1842563573283, 358.74595237256784, 306.13820363399566, 439.42116706357024, 439.46557312922783, 401.08101870247697, 472.10131692548055, 534.230982725595, 220.06781665257577, 258.1533583715057, 395.60315880161465, 223.19761432063927, 366.7305052509095, 198.02933415910434, 480.3862620668541, 370.54223421547806, 297.74276184102325, 426.4145411152824, 356.33157811977355, 108.69358059175568, 442.4199225541655, 200.1802875044224, 215.8872633473787, 257.529285010688, 353.82522817274105, 282.7124253246335, 202.27928295778491, 170.48292776213017, 162.2589801104656, 412.64629977618387, 369.3130534710481, 317.7951108099021, 223.6229572311585, 152.24619907168295, 274.8134751198206, 513.2525250600012, 380.45045725151545, 285.8171275805535, 207.79157660893722, 421.9142053324145, 341.7611494978014, 396.2587290640379, 23.610598696974193, 420.58729469724005, 374.16511752366443, 460.11293238685954, 458.6403614910344, 349.8133545277014, 330.9393372588597, 375.4746930228503, 353.5097995612586, 307.7540559309302, 365.75646245801613, 476.48919041853566, 231.2089462268448, 650.428330031721, 396.1016288090933, 288.84090332170143, 306.622533439801, 381.9129127373815, 325.94077103491475, 281.97284559596073, 581.5923427100166, 334.0289573428688, 617.1419778886477, 368.8816912800706, 407.7059577958592, 331.2995054807539, 494.0860293011297, 425.47456933748754, 442.35972464059427, 421.02827978125435, 310.79443248387724, 276.75999235243563, 487.4396256932399, 332.93053832328866, 224.5554926165748, 265.7400302354234, 314.69037359957036, 219.0702104203656, 400.1713519442912, 171.04705540669153, 224.69552015500787, 498.02427855118844, 354.41868806964834, 496.53837362168343, 318.7211756787464, 236.67451976877263, 424.9622917797371, 366.1560391777493, 355.1887444057147, 227.012353327428, 360.9063439701706, 516.0576239875473, 529.7624090918765, 212.64101428044194, 291.1541861152506, 401.4694410148171, 202.43712052440443, 430.26397761582837, 492.0920016413483, 350.0052015719464, 102.37478987601057, 346.48842423624035, 575.5685273582712, 592.6208011689656, 405.69754632847616, 68.67670588399652, 471.17053749989134, 430.2962659217555, 343.62722594399304, 258.4557120753034, 414.30681983316583, 229.35331428942825, 235.05686651737062, 369.55708836170925, 585.6049438353662, 273.3865183052375, 460.76080758551376, 449.8978129837524, 577.8794839450586, 344.82651168183014, 299.5494108317568, 386.275058206397, 31.70155958646876, 72.72549270364732, 501.5970951261925, 243.6471215030641, 540.869196926364, 335.97103946634354, 139.5663565517811, 384.926205482732, 374.81571552167765, 226.1043875458024, 273.1141616107482, 336.9740776003116, 225.1989808463729, 422.5888848392426, 463.6235946752555, 517.0785193988108, 342.3453486851516, 455.2000348185319, 337.06022935010816, 339.7044613035237, 389.3647867677559, 331.8594825861744, 80.99867661786084, 524.2405011118965, 518.9303179938132, 422.40301900909407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.525156011542999, "mean_inference_ms": 5.5444409705865, "mean_action_processing_ms": 42.56342329694312, "mean_env_wait_ms": 1.7378984016331736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004580497741699219, "StateBufferConnector_ms": 0.0529552698135376, "ViewRequirementAgentConnector_ms": 0.19624602794647217}, "num_episodes": 72, "episode_return_max": 448.58371232865267, "episode_return_min": -25.464009639025313, "episode_return_mean": 100.68148678947443, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 238.03604249466818, "num_env_steps_trained_throughput_per_sec": 238.03604249466818, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 34111.981, "restore_workers_time_ms": 0.028, "training_step_time_ms": 34111.535, "sample_time_ms": 1651.737, "learn_time_ms": 32408.828, "learn_throughput": 246.846, "synch_weights_time_ms": 40.175}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 22, "trial_id": "cdf01_00000", "date": "2024-08-20_10-36-16", "timestamp": 1724130376, "time_this_iter_s": 33.65498495101929, "time_total_s": 893.9234776496887, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52abaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 893.9234776496887, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 50.77916666666666, "ram_util_percent": 83.01458333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0004234004588355, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.0001, "total_loss": 9.03899161929176, "policy_loss": -0.005151581369887387, "vf_loss": 9.044141495417035, "vf_explained_var": 0.08976858456929525, "kl": 0.004293802574165821, "entropy": 0.35898997755277723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 13545.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4245181838198313, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 8.562518630708967, "policy_loss": -0.00629421864481022, "vf_loss": 8.568657119690426, "vf_explained_var": 0.23312303054900396, "kl": 0.006228980740207402, "entropy": 0.6036666584393334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 13545.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 448.58371232865267, "episode_reward_min": -25.464009639025313, "episode_reward_mean": 100.68148678947443, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -680.4886674089794, "predator_policy": 23.610598696974193}, "policy_reward_max": {"prey_policy": 146.2212175451159, "predator_policy": 650.428330031721}, "policy_reward_mean": {"prey_policy": -305.0005159430421, "predator_policy": 355.34125933777943}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.005873002082533, 36.13807560636222, 18.9368942405349, 8.592959297604986, 269.2917855652832, 47.76518171427659, 2.03279600846208, 43.31087062401507, 11.91459057814419, 1.1000000000000023, 262.26890047948893, 3.195077985245174, 448.58371232865267, 0.35856434172971463, 3.399999999999999, 97.32090184468763, 333.06580631174216, -3.841768950263063, 0.10000000000000697, 154.1902907662397, 140.35721071825245, 158.5096841781607, 321.44799362139423, 103.74478881878676, 76.34883593736713, 280.01842919046385, 15.516120898594377, 39.77134583457866, 6.661338147750939e-16, 125.30718898686392, 103.00670044961157, 94.60569109537816, 154.94389826792184, 0.8139027985164995, 102.49537874334125, 84.99931778368963, 97.45516330902984, 38.1618889238642, 136.1702072302327, 254.27020929442696, 1.7424717139701116, 106.19470899277911, 17.114430253503826, 48.5802133821157, 3.7312573650348, 0.25500087408421224, 79.79821735205033, 2.0000000000000036, 108.90707810633101, 134.04225061844673, 120.45977400353344, 99.41746920456558, 269.52217274842667, -25.464009639025313, 179.05585609925012, 2.7026741735519497, -0.14435746950429196, 17.99986253214825, 35.836063914737785, 7.0510708378594105, 12.598483313472691, 137.31108143908077, 211.08042108089532, 260.18630291015177, 270.7787723916404, 24.28021535719033, 94.29774116206598, 314.8747539367786, 73.13001835433629, 0.0999999999999992, 25.000000000000014, -2.6645352591003757e-15, 37.08326840569673, 239.62704406564325, 262.6126172362233, 0.14279261821355682, 66.27746842786036, 0.6000000000000039, 71.31509008617215, 2.220446049250313e-15, 243.1257186825412, 44.07976117564284, 133.46620623498956, 12.294941967339467, 38.82731495962082, -9.606552877709179, 13.599253355962855, 195.76375048941603, 167.32610359393453, 0.29999999999999893, 43.376742024527275, 112.66769001700868, 271.6705944374962, 228.3482223834207, 314.47575740037763, 1.441622599749968, 78.32854719322629, 346.1398964463485, 79.2365409563442, 370.51382423316403], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-380.13404239401206, -630.5553405365407, -236.9858219317467, -473.98400091081936, -224.4710896518641, -426.808641214053, -249.87497744697208, -310.0134338125674, -462.66152472407214, 146.2212175451159, -426.39685747337944, -212.09061081635815, -473.8002984096023, -451.21904048108405, -314.0690242629511, -288.3560127398261, -547.3837557077028, -503.9525109636306, -531.5180042626076, -527.8835087215901, -384.203852460021, 70.42593266221976, -563.4127438668572, -305.33162291172715, 142.39957481799405, -506.61276455805864, -501.35274597846274, -392.17983992846627, -351.0323247445794, -355.4157868136822, -358.8956450343475, -1.1842894422576529, -574.0569522492442, 93.06310157054992, -409.17411164532757, -351.07701731640026, -424.8874719588032, -398.6423986669813, -121.39779246940518, -306.2008881121122, -514.2703653879206, -107.6184782372448, 133.06120161471247, -487.2970856445461, -82.58096298499623, -387.65634031898054, -172.49061603630136, -488.07943900968576, 18.131394022125814, -371.783615043023, 41.00650200723429, -488.9182815466668, -291.92362435451736, -438.1196254444533, -380.1317664069996, -420.643479590127, -472.10131692548055, -534.230982725595, -306.62071525146314, -46.29327078575378, -404.02215536443117, -111.7719173082123, -439.4439744123348, -30.71017390230015, -489.7426637126445, -206.2419343017665, -337.1372191193747, -386.20618103841355, -355.7555097477755, -6.7742702204124114, -448.0708397418634, -109.53005253303394, -302.95364885728156, -73.00773619175467, -311.1462052099163, -287.2295593635924, -205.45105998249832, -31.140943507184012, -442.1164371586318, 121.48136656640972, -369.08424280411924, -316.28144976286086, -65.67487352330453, -203.9995737867587, -257.9990448663171, -512.9525250600011, -283.2461401776695, -334.4412312722838, -400.6303113343649, -225.3442132419526, -341.8061486237172, -395.9587290640379, 54.189343984875144, -418.589020027039, -374.16511752366443, -458.11293238685954, -313.0232750765537, -386.5233628358488, -569.9188271620475, -2.452952501215435, -445.4391380537248, -95.36494343492998, -305.1704391627042, -437.65774450928205, -680.4886674089794, 68.37356389883884, -391.43562622158333, -318.9709155482359, 44.20220459732937, -553.6817946752617, -326.8079331869542, -278.40300927036867, -496.54649267118924, -419.2191648511998, -350.8818287479223, -617.1419778886477, -414.8071422584194, -288.36225710345445, -493.38602930112955, -419.12349849962703, -420.40760245482255, -430.3819186535533, -333.1079742522517, -117.13536914497958, -487.60816753441077, -121.68157540122296, 54.705619637308686, -284.8148395791544, -354.0818116282954, 91.09999999999934, -398.04411905984387, -148.89407293394902, -555.5619866416515, -72.8600709024789, 14.579716890636671, -550.6620246451897, 5.57509216254989, -487.84076925573237, -424.86229177973706, -366.1560391777493, -355.1887444057147, -202.01235332742831, -360.9063439701706, -516.0576239875473, -529.7624090918765, -175.5577458747457, 12.12162778409713, -465.11821084852033, 118.55441635023506, -488.64289725424504, -471.70834551744383, -370.2460650776368, -390.28394889002215, 7.698203205631694, -574.9685273582713, -592.6208011689656, -10.537370031949683, -392.5217920943505, -471.17053749989134, -430.2962659217555, -375.02199146640686, 16.06477212965318, -424.83147616986736, -174.74889677708313, -100.39249572903273, -370.75525291505795, -570.0711470372711, -276.6253731359919, -460.3722527881819, -411.45905282146293, -571.2513017212502, -361.06124678334777, -295.5234831971382, -376.70173248505273, -29.39153508539475, 120.72823328469539, -195.2949016874209, -382.62321134790164, -335.6710394663436, -540.869196926364, -98.21263265479085, -382.9031873551957, -375.07351822073247, -113.1788948297391, -358.78297978101403, 20.365335007450497, -4.1634567636863675, -415.27618653850743, -677.1951793261095, 10.968822652421316, -344.42679915521427, -451.67696174871924, -65.43663388897882, -532.9995095714277, -407.4782598874016, 32.39388697982013, 8.287227756596797, -534.28986453001, -586.6912572378866, 15.871744468142012], "policy_predator_policy_reward": [430.94596027375627, 586.7492956588791, 273.1238975381087, 473.98400091081936, 415.3756142197787, 254.8410108866723, 362.2543848371884, 206.22698571995613, 420.48044746718307, 165.25164527705738, 222.5050351543764, 463.747614849637, 473.0401637536929, 454.01197114545556, 265.9232060891714, 379.8127015376239, 547.3837557077028, 515.8671015417748, 531.5180042626076, 528.9835087215902, 395.37868269361087, 180.66813758367908, 563.4127438668572, 308.5267008969722, 352.38789642458437, 460.4090056441332, 501.4336763808553, 392.45747386780346, 351.1323247445794, 358.71578681368214, 372.7686795665353, 84.63215675475878, 549.7478728515088, 264.31178413892826, 487.51040218257685, 268.8989578288884, 424.8874719588032, 398.74239866698133, 368.54442704974355, 213.24454429801352, 500.0965355236574, 262.1495188197604, 25.148482563448198, 487.5970856445461, 293.4657303353699, 498.21956659000057, 427.6299375064931, 336.6849063582795, 167.29744448375166, 262.70361247451484, 369.1842563573283, 358.74595237256784, 306.13820363399566, 439.42116706357024, 439.46557312922783, 401.08101870247697, 472.10131692548055, 534.230982725595, 220.06781665257577, 258.1533583715057, 395.60315880161465, 223.19761432063927, 366.7305052509095, 198.02933415910434, 480.3862620668541, 370.54223421547806, 297.74276184102325, 426.4145411152824, 356.33157811977355, 108.69358059175568, 442.4199225541655, 200.1802875044224, 215.8872633473787, 257.529285010688, 353.82522817274105, 282.7124253246335, 202.27928295778491, 170.48292776213017, 162.2589801104656, 412.64629977618387, 369.3130534710481, 317.7951108099021, 223.6229572311585, 152.24619907168295, 274.8134751198206, 513.2525250600012, 380.45045725151545, 285.8171275805535, 207.79157660893722, 421.9142053324145, 341.7611494978014, 396.2587290640379, 23.610598696974193, 420.58729469724005, 374.16511752366443, 460.11293238685954, 458.6403614910344, 349.8133545277014, 330.9393372588597, 375.4746930228503, 353.5097995612586, 307.7540559309302, 365.75646245801613, 476.48919041853566, 231.2089462268448, 650.428330031721, 396.1016288090933, 288.84090332170143, 306.622533439801, 381.9129127373815, 325.94077103491475, 281.97284559596073, 581.5923427100166, 334.0289573428688, 617.1419778886477, 368.8816912800706, 407.7059577958592, 331.2995054807539, 494.0860293011297, 425.47456933748754, 442.35972464059427, 421.02827978125435, 310.79443248387724, 276.75999235243563, 487.4396256932399, 332.93053832328866, 224.5554926165748, 265.7400302354234, 314.69037359957036, 219.0702104203656, 400.1713519442912, 171.04705540669153, 224.69552015500787, 498.02427855118844, 354.41868806964834, 496.53837362168343, 318.7211756787464, 236.67451976877263, 424.9622917797371, 366.1560391777493, 355.1887444057147, 227.012353327428, 360.9063439701706, 516.0576239875473, 529.7624090918765, 212.64101428044194, 291.1541861152506, 401.4694410148171, 202.43712052440443, 430.26397761582837, 492.0920016413483, 350.0052015719464, 102.37478987601057, 346.48842423624035, 575.5685273582712, 592.6208011689656, 405.69754632847616, 68.67670588399652, 471.17053749989134, 430.2962659217555, 343.62722594399304, 258.4557120753034, 414.30681983316583, 229.35331428942825, 235.05686651737062, 369.55708836170925, 585.6049438353662, 273.3865183052375, 460.76080758551376, 449.8978129837524, 577.8794839450586, 344.82651168183014, 299.5494108317568, 386.275058206397, 31.70155958646876, 72.72549270364732, 501.5970951261925, 243.6471215030641, 540.869196926364, 335.97103946634354, 139.5663565517811, 384.926205482732, 374.81571552167765, 226.1043875458024, 273.1141616107482, 336.9740776003116, 225.1989808463729, 422.5888848392426, 463.6235946752555, 517.0785193988108, 342.3453486851516, 455.2000348185319, 337.06022935010816, 339.7044613035237, 389.3647867677559, 331.8594825861744, 80.99867661786084, 524.2405011118965, 518.9303179938132, 422.40301900909407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.525156011542999, "mean_inference_ms": 5.5444409705865, "mean_action_processing_ms": 42.56342329694312, "mean_env_wait_ms": 1.7378984016331736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004580497741699219, "StateBufferConnector_ms": 0.0529552698135376, "ViewRequirementAgentConnector_ms": 0.19624602794647217}, "num_episodes": 0, "episode_return_max": 448.58371232865267, "episode_return_min": -25.464009639025313, "episode_return_mean": 100.68148678947443, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 239.06491582642232, "num_env_steps_trained_throughput_per_sec": 239.06491582642232, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 34214.013, "restore_workers_time_ms": 0.029, "training_step_time_ms": 34213.551, "sample_time_ms": 1708.037, "learn_time_ms": 32454.454, "learn_throughput": 246.499, "synch_weights_time_ms": 39.465}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 23, "trial_id": "cdf01_00000", "date": "2024-08-20_10-36-50", "timestamp": 1724130410, "time_this_iter_s": 33.48963975906372, "time_total_s": 927.4131174087524, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e3cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 927.4131174087524, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 50.86382978723404, "ram_util_percent": 83.10212765957445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.826050445390126, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 0.0001, "total_loss": 8.420601548845806, "policy_loss": -0.004981645974995835, "vf_loss": 8.425582313537598, "vf_explained_var": 0.0948177521190946, "kl": 0.0038353970191608478, "entropy": 0.3887586578490242, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.115171110913867, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 8.122047173030793, "policy_loss": -0.005284076816003238, "vf_loss": 8.127198547030252, "vf_explained_var": 0.28718206570262, "kl": 0.005308908980816976, "entropy": 0.5643754152078477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 419.658819188914, "episode_reward_min": -9.606552877709179, "episode_reward_mean": 114.41371465418233, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -677.1951793261095, "predator_policy": 21.504544085213166}, "policy_reward_max": {"prey_policy": 142.94816495311676, "predator_policy": 592.6208011689656}, "policy_reward_mean": {"prey_policy": -292.1529062562273, "predator_policy": 349.35976358331857}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.08326840569673, 239.62704406564325, 262.6126172362233, 0.14279261821355682, 66.27746842786036, 0.6000000000000039, 71.31509008617215, 2.220446049250313e-15, 243.1257186825412, 44.07976117564284, 133.46620623498956, 12.294941967339467, 38.82731495962082, -9.606552877709179, 13.599253355962855, 195.76375048941603, 167.32610359393453, 0.29999999999999893, 43.376742024527275, 112.66769001700868, 271.6705944374962, 228.3482223834207, 314.47575740037763, 1.441622599749968, 78.32854719322629, 346.1398964463485, 79.2365409563442, 370.51382423316403, 26.400000000000016, 56.91117148942602, 5.299999999999997, 205.40851226180476, 419.658819188914, 38.77160443855856, 10.798392387620332, 43.70951817372403, 179.079898404739, 10.989162130335131, 177.64652626607554, 161.4767771025409, 285.62648689900226, 5.088397511461428, 51.10663344435459, 1.4000000000000026, 138.6122028738028, 0.014372403914733045, 143.01596464631405, 242.56445131254245, 147.06583482212017, 65.530343916053, 142.75795805219397, 107.29000378685656, 12.253136096944774, 219.95790276853262, 188.600390894629, 6.749912703159929, 18.4391744325424, 124.8121735846401, 5.995204332975845e-15, 365.6750439683153, 149.03275749236474, 383.99122731700226, 0.39999999999999747, 235.70424026128208, -6.661338147750939e-15, 154.6368594735644, 0.09999999999999787, 2.4506068566244945, 271.8297116548595, 0.40580492855817885, 63.80331864999641, 97.37054640019451, -9.325873406851315e-15, 85.29369588593634, 335.6946497375714, 97.83320500221186, 83.38632102595388, 45.72384241992044, 174.74185581226322, 60.68534662244422, 412.52149507053235, 71.65181091345029, 242.59235274980708, 29.374542652032638, 178.6579202927118, 0.8999999999999997, 199.52825585435167, 183.75678655943352, 74.43459867376293, 15.683181068560092, 136.73027755699414, 393.5469735465929, 3.543958670935396, 0.6814540162908367, -8.970470230434834, 159.5699363904663, 0.33459249736945296, 34.87218995078189, 103.25110380370029, -0.11846623418288837], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-529.7624090918765, -175.5577458747457, 12.12162778409713, -465.11821084852033, 118.55441635023506, -488.64289725424504, -471.70834551744383, -370.2460650776368, -390.28394889002215, 7.698203205631694, -574.9685273582713, -592.6208011689656, -10.537370031949683, -392.5217920943505, -471.17053749989134, -430.2962659217555, -375.02199146640686, 16.06477212965318, -424.83147616986736, -174.74889677708313, -100.39249572903273, -370.75525291505795, -570.0711470372711, -276.6253731359919, -460.3722527881819, -411.45905282146293, -571.2513017212502, -361.06124678334777, -295.5234831971382, -376.70173248505273, -29.39153508539475, 120.72823328469539, -195.2949016874209, -382.62321134790164, -335.6710394663436, -540.869196926364, -98.21263265479085, -382.9031873551957, -375.07351822073247, -113.1788948297391, -358.78297978101403, 20.365335007450497, -4.1634567636863675, -415.27618653850743, -677.1951793261095, 10.968822652421316, -344.42679915521427, -451.67696174871924, -65.43663388897882, -532.9995095714277, -407.4782598874016, 32.39388697982013, 8.287227756596797, -534.28986453001, -586.6912572378866, 15.871744468142012, -540.3993144478987, -358.6026002092944, -450.981901214273, -260.1816597383628, -407.88942131847466, -501.00300916438624, 12.18205908929859, -358.8926735817007, 18.93051827808906, -525.9110414516978, -182.31763583876088, -382.7497771188877, -349.4373372302451, -498.1326254774749, -250.40173461569412, -371.80272338203986, -137.52856582440052, -317.14485322030964, -353.05542426297075, -327.65859006581144, -95.61575634050372, -374.7596600784078, 63.531542165898315, -247.7615575956255, -120.90960823219919, -675.4753313393315, -313.5920178952077, -355.4323890565185, -418.1515266509846, -294.0114917013119, -561.3420809917349, -432.43643451120636, 18.90039142296376, -53.462663490477546, -290.1059000168543, -299.69180205891035, -38.51788964936887, -279.8974785175599, 20.000000000000014, -402.95618796426777, 81.29393955602255, -458.1638435784384, -204.06383628579619, -390.5888107183036, -224.68507304248772, -473.2805919543554, -275.02932505903283, -292.28663610063126, -398.94237011761135, -183.76613315787046, -521.2535188901373, 89.65695398102976, 17.242344163604894, -185.18621146154368, -492.0213141666233, -298.8387580791769, -392.2838414283023, -395.6959044189967, -253.20414933756183, -208.95882026999936, -454.07191749396, -448.8624525450848, -86.27677421075126, 142.94816495311676, -244.85265872942767, 1.3269646462370184, -305.19179594734555, 80.2811977530979, -566.7154570021414, -347.7052967360356, -111.70625360205986, -265.7306008190372, -426.54729382038306, -515.667915552998, -458.3615437653988, -210.34657892511473, -312.0051387181465, -379.42430944354027, -362.3825442306085, -494.06781611611086, -449.34454213844896, 66.73095706319151, -357.4914776009237, -455.6602138391945, -15.607471140274491, -467.9427836413475, -403.95434028641415, -110.8686227165238, -535.1566415565129, -412.9888891097451, -399.7517809812844, -8.074165027164305, -508.01928831214144, -0.9286648324905725, -401.5784378022798, 76.32866091699867, -462.73821860702003, -9.540762544761472, -306.1094729030955, -478.3674429230158, 9.125286099904864, -317.82950651686866, -450.9164570814558, -168.2743591460525, 118.74966363601347, -492.7588811513526, -282.5212152429045, -83.70207972979694, 103.74103656625584, -517.9460571995609, -326.9368968958024, -422.9983918219546, -364.70757685264005, -116.63583779412113, -300.10547326095116, -434.4866958644239, -535.9644314498346, -52.48664880396589, -43.14498441687288, -383.0994143196463, -393.52017585626277, -23.003903392590935, -307.23124837813003, -454.32760018656916, -388.6316993529415, 16.571067266612147, 4.6956434554632835, -526.6336705917894, -520.8542745847413, -564.4551551794287, -369.2300293387394, -482.6226552607066, -448.16829253006006, -354.2618487673466, -445.10508140370894, 0.9873690507786722, -431.71135015396385, -414.1584464351167, -183.35490684277013, -521.848695540847, -424.54697973028885, -223.86508723119695, -475.9770836204122, -274.4509974024961], "policy_predator_policy_reward": [529.7624090918765, 212.64101428044194, 291.1541861152506, 401.4694410148171, 202.43712052440443, 430.26397761582837, 492.0920016413483, 350.0052015719464, 102.37478987601057, 346.48842423624035, 575.5685273582712, 592.6208011689656, 405.69754632847616, 68.67670588399652, 471.17053749989134, 430.2962659217555, 343.62722594399304, 258.4557120753034, 414.30681983316583, 229.35331428942825, 235.05686651737062, 369.55708836170925, 585.6049438353662, 273.3865183052375, 460.76080758551376, 449.8978129837524, 577.8794839450586, 344.82651168183014, 299.5494108317568, 386.275058206397, 31.70155958646876, 72.72549270364732, 501.5970951261925, 243.6471215030641, 540.869196926364, 335.97103946634354, 139.5663565517811, 384.926205482732, 374.81571552167765, 226.1043875458024, 273.1141616107482, 336.9740776003116, 225.1989808463729, 422.5888848392426, 463.6235946752555, 517.0785193988108, 342.3453486851516, 455.2000348185319, 337.06022935010816, 339.7044613035237, 389.3647867677559, 331.8594825861744, 80.99867661786084, 524.2405011118965, 518.9303179938132, 422.40301900909407, 540.3993144478987, 385.0026002092954, 408.12146964785705, 359.9532627942049, 413.1894213184746, 501.00300916438624, 204.8066818230714, 347.3124449311361, 426.5609864674078, 500.0783558951142, 239.51243649151957, 364.3265809046875, 355.40673700520085, 502.96161809013955, 314.51357236135226, 351.40040381010596, 406.01059290329687, 227.74272454615124, 307.4604208993626, 384.2427555597553, 246.1653486527436, 401.8565940322445, 92.47790892203999, 253.22888361022797, 526.0929328563775, 555.9184936141539, 320.00736809381976, 354.10543636936785, 466.73886555917346, 296.53078623747905, 561.3420809917349, 433.8364345112067, 70.29957618104358, 102.87489876027388, 287.30898966675176, 302.50308481292785, 178.60792666106434, 282.8234061521785, 230.21874588262415, 395.3018933941855, 90.48464708808173, 433.4510917564541, 105.88116479049211, 554.3018261296615, 386.8247652181928, 453.89885783084395, 307.2363253313152, 367.3696396152072, 399.8119503111318, 195.14968906129425, 473.82568025917226, 177.7287874184673, 140.3768986391849, 216.16735955338353, 456.8414895657149, 340.7684953832454, 384.465130094987, 421.9537901848547, 252.28788106690808, 334.6872621252936, 454.07191749396, 448.8624525450848, 161.27839243950936, 147.7252607864407, 115.26817519713862, 277.2902763784175, 305.99278527598244, 302.90904023526775, 566.7154570021414, 348.1052967360357, 278.74546808572006, 334.39562659666086, 426.54729382038306, 515.667915552998, 424.6208869017253, 398.7240952623534, 312.1051387181465, 379.42430944354027, 341.36949537526715, 517.5314718280769, 231.09355825118115, 423.3497384789356, 357.4972825294819, 456.0602138391946, 107.95365283642401, 439.39992059519454, 358.543908832602, 253.64960057053042, 535.1566415565129, 412.9888891097451, 387.16251882233723, 105.95712307204879, 372.74864065875926, 471.8939622234437, 401.5784378022798, 21.504544085213166, 456.78504962943146, 98.88025254830403, 373.5596287907108, 456.6411294553215, 175.12845250755421, 308.3176237216731, 377.25077591657225, 302.62538693337973, 331.0932772898186, 455.4374352960525, 291.6091633833519, 146.2659425028015, 496.14501188960435, 160.6523614935079, 315.3707773267323, 463.9390540430575, 264.75002881395545, 395.251306125518, 301.0054732609513, 434.4866958644239, 505.58822266063055, 282.3911134475217, 270.61803924868127, 339.38314604727213, 349.685289222181, 141.27338870043673, 323.8328836358254, 453.4091459974351, 218.0177232488681, 290.7731863944578, 467.43561865820226, 448.0493820247159, 505.1745009593458, 583.6788874757608, 370.2300293387395, 482.3041092769975, 449.5211949737908, 343.93847609318215, 239.07748510354574, 364.61016363985124, 432.04594265133335, 414.1584464351167, 519.725769975873, 220.3500223585259, 426.8102278659662, 324.85294289922064, 475.3093486057174, 275.0002661830079]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.45016891423252, "mean_inference_ms": 5.429610555189799, "mean_action_processing_ms": 39.073680172396095, "mean_env_wait_ms": 1.7032653436120178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00510561466217041, "StateBufferConnector_ms": 0.02680647373199463, "ViewRequirementAgentConnector_ms": 0.12587952613830566}, "num_episodes": 72, "episode_return_max": 419.658819188914, "episode_return_min": -9.606552877709179, "episode_return_mean": 114.41371465418233, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 260.56905548637644, "num_env_steps_trained_throughput_per_sec": 260.56905548637644, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 34139.108, "restore_workers_time_ms": 0.029, "training_step_time_ms": 34138.605, "sample_time_ms": 1712.615, "learn_time_ms": 32373.397, "learn_throughput": 247.116, "synch_weights_time_ms": 39.98}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 24, "trial_id": "cdf01_00000", "date": "2024-08-20_10-37-20", "timestamp": 1724130440, "time_this_iter_s": 30.760799169540405, "time_total_s": 958.1739165782928, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52ab430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 958.1739165782928, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 40.91136363636363, "ram_util_percent": 83.20454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3930454021408445, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 0.0001, "total_loss": 8.700603975568498, "policy_loss": -0.0034859427897673515, "vf_loss": 8.70408984290229, "vf_explained_var": 0.13380514449543424, "kl": 0.0032038543806439043, "entropy": 0.3893066352795041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 14805.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2046282234646024, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 8.289988103745475, "policy_loss": -0.0065472530201077465, "vf_loss": 8.296301893203978, "vf_explained_var": 0.2637968613987877, "kl": 0.009337943416895065, "entropy": 0.6134535887884716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 14805.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 419.658819188914, "episode_reward_min": -20.28193514759446, "episode_reward_mean": 110.51242850013332, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -677.1951793261095, "predator_policy": 21.504544085213166}, "policy_reward_max": {"prey_policy": 142.94816495311676, "predator_policy": 585.6049438353662}, "policy_reward_mean": {"prey_policy": -287.04065705797865, "predator_policy": 342.29687130804535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [243.1257186825412, 44.07976117564284, 133.46620623498956, 12.294941967339467, 38.82731495962082, -9.606552877709179, 13.599253355962855, 195.76375048941603, 167.32610359393453, 0.29999999999999893, 43.376742024527275, 112.66769001700868, 271.6705944374962, 228.3482223834207, 314.47575740037763, 1.441622599749968, 78.32854719322629, 346.1398964463485, 79.2365409563442, 370.51382423316403, 26.400000000000016, 56.91117148942602, 5.299999999999997, 205.40851226180476, 419.658819188914, 38.77160443855856, 10.798392387620332, 43.70951817372403, 179.079898404739, 10.989162130335131, 177.64652626607554, 161.4767771025409, 285.62648689900226, 5.088397511461428, 51.10663344435459, 1.4000000000000026, 138.6122028738028, 0.014372403914733045, 143.01596464631405, 242.56445131254245, 147.06583482212017, 65.530343916053, 142.75795805219397, 107.29000378685656, 12.253136096944774, 219.95790276853262, 188.600390894629, 6.749912703159929, 18.4391744325424, 124.8121735846401, 5.995204332975845e-15, 365.6750439683153, 149.03275749236474, 383.99122731700226, 0.39999999999999747, 235.70424026128208, -6.661338147750939e-15, 154.6368594735644, 0.09999999999999787, 2.4506068566244945, 271.8297116548595, 0.40580492855817885, 63.80331864999641, 97.37054640019451, -9.325873406851315e-15, 85.29369588593634, 335.6946497375714, 97.83320500221186, 83.38632102595388, 45.72384241992044, 174.74185581226322, 60.68534662244422, 412.52149507053235, 71.65181091345029, 242.59235274980708, 29.374542652032638, 178.6579202927118, 0.8999999999999997, 199.52825585435167, 183.75678655943352, 74.43459867376293, 15.683181068560092, 136.73027755699414, 393.5469735465929, 3.543958670935396, 0.6814540162908367, -8.970470230434834, 159.5699363904663, 0.33459249736945296, 34.87218995078189, 103.25110380370029, -0.11846623418288837, 1.8999999999999995, 6.298558739187882, -20.28193514759446, 19.822313360226783, 45.17073658078634, 18.806990995581994, 38.86495456801992, 176.94804633869913], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-375.02199146640686, 16.06477212965318, -424.83147616986736, -174.74889677708313, -100.39249572903273, -370.75525291505795, -570.0711470372711, -276.6253731359919, -460.3722527881819, -411.45905282146293, -571.2513017212502, -361.06124678334777, -295.5234831971382, -376.70173248505273, -29.39153508539475, 120.72823328469539, -195.2949016874209, -382.62321134790164, -335.6710394663436, -540.869196926364, -98.21263265479085, -382.9031873551957, -375.07351822073247, -113.1788948297391, -358.78297978101403, 20.365335007450497, -4.1634567636863675, -415.27618653850743, -677.1951793261095, 10.968822652421316, -344.42679915521427, -451.67696174871924, -65.43663388897882, -532.9995095714277, -407.4782598874016, 32.39388697982013, 8.287227756596797, -534.28986453001, -586.6912572378866, 15.871744468142012, -540.3993144478987, -358.6026002092944, -450.981901214273, -260.1816597383628, -407.88942131847466, -501.00300916438624, 12.18205908929859, -358.8926735817007, 18.93051827808906, -525.9110414516978, -182.31763583876088, -382.7497771188877, -349.4373372302451, -498.1326254774749, -250.40173461569412, -371.80272338203986, -137.52856582440052, -317.14485322030964, -353.05542426297075, -327.65859006581144, -95.61575634050372, -374.7596600784078, 63.531542165898315, -247.7615575956255, -120.90960823219919, -675.4753313393315, -313.5920178952077, -355.4323890565185, -418.1515266509846, -294.0114917013119, -561.3420809917349, -432.43643451120636, 18.90039142296376, -53.462663490477546, -290.1059000168543, -299.69180205891035, -38.51788964936887, -279.8974785175599, 20.000000000000014, -402.95618796426777, 81.29393955602255, -458.1638435784384, -204.06383628579619, -390.5888107183036, -224.68507304248772, -473.2805919543554, -275.02932505903283, -292.28663610063126, -398.94237011761135, -183.76613315787046, -521.2535188901373, 89.65695398102976, 17.242344163604894, -185.18621146154368, -492.0213141666233, -298.8387580791769, -392.2838414283023, -395.6959044189967, -253.20414933756183, -208.95882026999936, -454.07191749396, -448.8624525450848, -86.27677421075126, 142.94816495311676, -244.85265872942767, 1.3269646462370184, -305.19179594734555, 80.2811977530979, -566.7154570021414, -347.7052967360356, -111.70625360205986, -265.7306008190372, -426.54729382038306, -515.667915552998, -458.3615437653988, -210.34657892511473, -312.0051387181465, -379.42430944354027, -362.3825442306085, -494.06781611611086, -449.34454213844896, 66.73095706319151, -357.4914776009237, -455.6602138391945, -15.607471140274491, -467.9427836413475, -403.95434028641415, -110.8686227165238, -535.1566415565129, -412.9888891097451, -399.7517809812844, -8.074165027164305, -508.01928831214144, -0.9286648324905725, -401.5784378022798, 76.32866091699867, -462.73821860702003, -9.540762544761472, -306.1094729030955, -478.3674429230158, 9.125286099904864, -317.82950651686866, -450.9164570814558, -168.2743591460525, 118.74966363601347, -492.7588811513526, -282.5212152429045, -83.70207972979694, 103.74103656625584, -517.9460571995609, -326.9368968958024, -422.9983918219546, -364.70757685264005, -116.63583779412113, -300.10547326095116, -434.4866958644239, -535.9644314498346, -52.48664880396589, -43.14498441687288, -383.0994143196463, -393.52017585626277, -23.003903392590935, -307.23124837813003, -454.32760018656916, -388.6316993529415, 16.571067266612147, 4.6956434554632835, -526.6336705917894, -520.8542745847413, -564.4551551794287, -369.2300293387394, -482.6226552607066, -448.16829253006006, -354.2618487673466, -445.10508140370894, 0.9873690507786722, -431.71135015396385, -414.1584464351167, -183.35490684277013, -521.848695540847, -424.54697973028885, -223.86508723119695, -475.9770836204122, -274.4509974024961, -303.80585096423596, -306.1179354199622, -341.2585660864062, -369.49404852757704, -133.86438368833376, -389.95837103440107, -119.26299875502818, -325.15363571996994, -69.83361441263033, -394.24278870279136, -402.0598714676023, -140.63234087307768, -87.97496846011461, -391.987605674814, -351.32271862543024, -75.64113122760753], "policy_predator_policy_reward": [343.62722594399304, 258.4557120753034, 414.30681983316583, 229.35331428942825, 235.05686651737062, 369.55708836170925, 585.6049438353662, 273.3865183052375, 460.76080758551376, 449.8978129837524, 577.8794839450586, 344.82651168183014, 299.5494108317568, 386.275058206397, 31.70155958646876, 72.72549270364732, 501.5970951261925, 243.6471215030641, 540.869196926364, 335.97103946634354, 139.5663565517811, 384.926205482732, 374.81571552167765, 226.1043875458024, 273.1141616107482, 336.9740776003116, 225.1989808463729, 422.5888848392426, 463.6235946752555, 517.0785193988108, 342.3453486851516, 455.2000348185319, 337.06022935010816, 339.7044613035237, 389.3647867677559, 331.8594825861744, 80.99867661786084, 524.2405011118965, 518.9303179938132, 422.40301900909407, 540.3993144478987, 385.0026002092954, 408.12146964785705, 359.9532627942049, 413.1894213184746, 501.00300916438624, 204.8066818230714, 347.3124449311361, 426.5609864674078, 500.0783558951142, 239.51243649151957, 364.3265809046875, 355.40673700520085, 502.96161809013955, 314.51357236135226, 351.40040381010596, 406.01059290329687, 227.74272454615124, 307.4604208993626, 384.2427555597553, 246.1653486527436, 401.8565940322445, 92.47790892203999, 253.22888361022797, 526.0929328563775, 555.9184936141539, 320.00736809381976, 354.10543636936785, 466.73886555917346, 296.53078623747905, 561.3420809917349, 433.8364345112067, 70.29957618104358, 102.87489876027388, 287.30898966675176, 302.50308481292785, 178.60792666106434, 282.8234061521785, 230.21874588262415, 395.3018933941855, 90.48464708808173, 433.4510917564541, 105.88116479049211, 554.3018261296615, 386.8247652181928, 453.89885783084395, 307.2363253313152, 367.3696396152072, 399.8119503111318, 195.14968906129425, 473.82568025917226, 177.7287874184673, 140.3768986391849, 216.16735955338353, 456.8414895657149, 340.7684953832454, 384.465130094987, 421.9537901848547, 252.28788106690808, 334.6872621252936, 454.07191749396, 448.8624525450848, 161.27839243950936, 147.7252607864407, 115.26817519713862, 277.2902763784175, 305.99278527598244, 302.90904023526775, 566.7154570021414, 348.1052967360357, 278.74546808572006, 334.39562659666086, 426.54729382038306, 515.667915552998, 424.6208869017253, 398.7240952623534, 312.1051387181465, 379.42430944354027, 341.36949537526715, 517.5314718280769, 231.09355825118115, 423.3497384789356, 357.4972825294819, 456.0602138391946, 107.95365283642401, 439.39992059519454, 358.543908832602, 253.64960057053042, 535.1566415565129, 412.9888891097451, 387.16251882233723, 105.95712307204879, 372.74864065875926, 471.8939622234437, 401.5784378022798, 21.504544085213166, 456.78504962943146, 98.88025254830403, 373.5596287907108, 456.6411294553215, 175.12845250755421, 308.3176237216731, 377.25077591657225, 302.62538693337973, 331.0932772898186, 455.4374352960525, 291.6091633833519, 146.2659425028015, 496.14501188960435, 160.6523614935079, 315.3707773267323, 463.9390540430575, 264.75002881395545, 395.251306125518, 301.0054732609513, 434.4866958644239, 505.58822266063055, 282.3911134475217, 270.61803924868127, 339.38314604727213, 349.685289222181, 141.27338870043673, 323.8328836358254, 453.4091459974351, 218.0177232488681, 290.7731863944578, 467.43561865820226, 448.0493820247159, 505.1745009593458, 583.6788874757608, 370.2300293387395, 482.3041092769975, 449.5211949737908, 343.93847609318215, 239.07748510354574, 364.61016363985124, 432.04594265133335, 414.1584464351167, 519.725769975873, 220.3500223585259, 426.8102278659662, 324.85294289922064, 475.3093486057174, 275.0002661830079, 303.80585096423596, 308.01793541996204, 347.55712482559426, 369.49404852757704, 136.90049808838927, 366.6403214867508, 256.05364653548025, 208.18530129974377, 122.02550498624392, 387.22163470996395, 402.0598714676023, 159.43933186865968, 126.47958549180007, 392.3479432111473, 350.99728670785316, 252.91460948388345]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.48001749596296, "mean_inference_ms": 5.395468404062751, "mean_action_processing_ms": 38.645674052769, "mean_env_wait_ms": 1.7023755007813728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005075693130493164, "StateBufferConnector_ms": 0.026299118995666504, "ViewRequirementAgentConnector_ms": 0.1247483491897583}, "num_episodes": 8, "episode_return_max": 419.658819188914, "episode_return_min": -20.28193514759446, "episode_return_mean": 110.51242850013332, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 265.00565319423464, "num_env_steps_trained_throughput_per_sec": 265.00565319423464, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 33305.98, "restore_workers_time_ms": 0.03, "training_step_time_ms": 33305.472, "sample_time_ms": 1700.821, "learn_time_ms": 31551.691, "learn_throughput": 253.552, "synch_weights_time_ms": 40.565}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 25, "trial_id": "cdf01_00000", "date": "2024-08-20_10-37-51", "timestamp": 1724130471, "time_this_iter_s": 30.222325801849365, "time_total_s": 988.3962423801422, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e8ed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 988.3962423801422, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 38.90930232558139, "ram_util_percent": 83.18604651162792}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8727908617920344, "cur_kl_coeff": 4.8828124999999996e-05, "cur_lr": 0.0001, "total_loss": 8.89627343586513, "policy_loss": -0.005086731082863278, "vf_loss": 8.901360186319502, "vf_explained_var": -0.0993270266623724, "kl": 0.003394063257133345, "entropy": 0.3320010788383938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0371325254440307, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 8.487384548641387, "policy_loss": -0.005949045892893559, "vf_loss": 8.493189613402835, "vf_explained_var": 0.2610286361641354, "kl": 0.005758001086266473, "entropy": 0.5375961310806728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 412.52149507053235, "episode_reward_min": -33.475970819381516, "episode_reward_mean": 92.75007060066736, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -587.6414085113422, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.40678939229215, "predator_policy": 583.6788874757608}, "policy_reward_mean": {"prey_policy": -279.4942475923742, "predator_policy": 325.869282892708}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.325873406851315e-15, 85.29369588593634, 335.6946497375714, 97.83320500221186, 83.38632102595388, 45.72384241992044, 174.74185581226322, 60.68534662244422, 412.52149507053235, 71.65181091345029, 242.59235274980708, 29.374542652032638, 178.6579202927118, 0.8999999999999997, 199.52825585435167, 183.75678655943352, 74.43459867376293, 15.683181068560092, 136.73027755699414, 393.5469735465929, 3.543958670935396, 0.6814540162908367, -8.970470230434834, 159.5699363904663, 0.33459249736945296, 34.87218995078189, 103.25110380370029, -0.11846623418288837, 1.8999999999999995, 6.298558739187882, -20.28193514759446, 19.822313360226783, 45.17073658078634, 18.806990995581994, 38.86495456801992, 176.94804633869913, 0.3381155206258679, 87.82328473686715, 0.10000000000000253, 265.59939289086486, 254.71547959617277, 168.31366559438516, 3.6000000000000036, 71.71259731236113, 308.587894495781, 169.00614822081621, -6.930690381041195, -0.7659383259537802, 80.01561183666715, 127.3525786326649, 115.19797851983434, 213.32475004023436, 0.05054374221954738, 61.01578602773484, 25.916116523516827, 1.9000000000000026, 0.08813354972743226, 25.598883452403744, -2.50120563424265, 8.058279795308328, 118.86738683881575, 2.220446049250313e-16, 56.07466105399384, 18.802701998361083, 7.432733918145479, 1.5660284909845084, 0.28700693794078647, 85.09803491641959, 0.9000000000000026, 206.69642259213836, 28.336291224519496, 2.1177196627150625, 202.29999999999924, 129.45690021316614, 17.889105469108966, 58.79836093385379, 154.98375945455538, 0.26925626825446214, 78.67116659921518, 0.24230006359018375, 1.0999999999999979, 81.58466912945293, 326.387057411595, 232.98786655994607, 0.916116523516822, 221.25903016471557, 0.7771126177072607, 196.16835264383664, 191.6749665417907, 53.29547808058784, 197.9358261370394, 37.68010587553451, -33.475970819381516, 0.20000000000000018, 64.10635556157423, 197.67447258775474, 335.86514933764477, 121.52940304113922, 369.8653221537949, 127.13742799139703], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-535.1566415565129, -412.9888891097451, -399.7517809812844, -8.074165027164305, -508.01928831214144, -0.9286648324905725, -401.5784378022798, 76.32866091699867, -462.73821860702003, -9.540762544761472, -306.1094729030955, -478.3674429230158, 9.125286099904864, -317.82950651686866, -450.9164570814558, -168.2743591460525, 118.74966363601347, -492.7588811513526, -282.5212152429045, -83.70207972979694, 103.74103656625584, -517.9460571995609, -326.9368968958024, -422.9983918219546, -364.70757685264005, -116.63583779412113, -300.10547326095116, -434.4866958644239, -535.9644314498346, -52.48664880396589, -43.14498441687288, -383.0994143196463, -393.52017585626277, -23.003903392590935, -307.23124837813003, -454.32760018656916, -388.6316993529415, 16.571067266612147, 4.6956434554632835, -526.6336705917894, -520.8542745847413, -564.4551551794287, -369.2300293387394, -482.6226552607066, -448.16829253006006, -354.2618487673466, -445.10508140370894, 0.9873690507786722, -431.71135015396385, -414.1584464351167, -183.35490684277013, -521.848695540847, -424.54697973028885, -223.86508723119695, -475.9770836204122, -274.4509974024961, -303.80585096423596, -306.1179354199622, -341.2585660864062, -369.49404852757704, -133.86438368833376, -389.95837103440107, -119.26299875502818, -325.15363571996994, -69.83361441263033, -394.24278870279136, -402.0598714676023, -140.63234087307768, -87.97496846011461, -391.987605674814, -351.32271862543024, -75.64113122760753, -494.71859382426453, -432.69290730208314, -238.9090605186167, -206.72475608607292, -460.4264627922793, -314.93913949093803, -68.01959131586435, -420.4531131204653, -402.860748075565, -51.37737422207231, -419.1477198752484, 5.325921415974377, -233.314534741578, -399.97413753702676, -17.43194273946021, -67.75255645417374, -363.1371867917334, 127.99999999999956, -156.49726375882926, -166.5293564123622, -372.65226950880054, -567.7816553969891, -434.73749507547143, -331.74748327250336, -353.141084950902, -115.056912928082, -4.47701980268727, -429.9033867573134, -115.00978642928145, -137.82175086018174, -496.0809199143908, -55.05644568654469, -407.7058324868402, -409.92672218138847, -198.70052833895164, -132.16607163134782, -287.2819457324785, -268.9711355176628, -287.332953829957, -414.2862508002139, -403.678506840577, -374.3895387905031, -13.407674689540464, -392.31494997531206, -358.9327234530161, -35.466504765553424, -381.4729982270826, -329.97319041154884, -371.5737363161236, -278.98525565814936, -388.09147946836555, -579.671985791256, -81.85690865642064, -272.6514039449329, -387.5436479867092, -90.84602868322489, -431.8982701227634, -535.1102582498803, -151.59103845352928, -239.4433831292305, -393.01729468051553, -356.3458291648933, -209.77121091284005, -349.4877202312432, -394.4457337278549, -390.5322194918796, -6.301283519786774, -427.8284483273101, -35.308228152854944, -537.7622393082587, -400.7205544433252, -345.9674935222583, 20.000000000000014, 176.40678939229215, -93.6017375909077, -355.3162442627633, -153.6130151238738, -231.73253010600297, -298.3306924188704, -415.0165300668769, -313.97146507975043, -56.86905935214839, -573.5388335108904, -395.7672122308506, -295.423920762448, -1.163277459652274, -285.35505473683685, -378.8247647353078, -349.1442670268491, -466.02467238733743, -422.11026558210744, -342.63832579695946, -372.92673473429363, -29.584517806737125, -11.139340069976418, -587.6414085113422, -307.67475385785053, -448.4748544866833, -349.2108565249918, 18.048286842146098, -407.5576263331798, -368.185110942324, -418.6720498319414, -76.46248975430223, -494.672675301484, -7.604362423032359, -200.5138212145357, -269.0358186936365, -442.6183342710815, 12.064668958740166, -272.87248530142097, -440.94047793591403, -124.33848345163761, -255.92031251708477, -366.10830828321787, -367.08126703752464, -340.08928108976613, -541.7796288232906, -333.91015108551863, 35.941354561817704, 94.22644474871413, -465.75915536908303, -295.3521159070659, -119.30846339196907, 170.2999999999998, -569.6080322171507, 91.09999999999933, -337.50640716292], "policy_predator_policy_reward": [535.1566415565129, 412.9888891097451, 387.16251882233723, 105.95712307204879, 372.74864065875926, 471.8939622234437, 401.5784378022798, 21.504544085213166, 456.78504962943146, 98.88025254830403, 373.5596287907108, 456.6411294553215, 175.12845250755421, 308.3176237216731, 377.25077591657225, 302.62538693337973, 331.0932772898186, 455.4374352960525, 291.6091633833519, 146.2659425028015, 496.14501188960435, 160.6523614935079, 315.3707773267323, 463.9390540430575, 264.75002881395545, 395.251306125518, 301.0054732609513, 434.4866958644239, 505.58822266063055, 282.3911134475217, 270.61803924868127, 339.38314604727213, 349.685289222181, 141.27338870043673, 323.8328836358254, 453.4091459974351, 218.0177232488681, 290.7731863944578, 467.43561865820226, 448.0493820247159, 505.1745009593458, 583.6788874757608, 370.2300293387395, 482.3041092769975, 449.5211949737908, 343.93847609318215, 239.07748510354574, 364.61016363985124, 432.04594265133335, 414.1584464351167, 519.725769975873, 220.3500223585259, 426.8102278659662, 324.85294289922064, 475.3093486057174, 275.0002661830079, 303.80585096423596, 308.01793541996204, 347.55712482559426, 369.49404852757704, 136.90049808838927, 366.6403214867508, 256.05364653548025, 208.18530129974377, 122.02550498624392, 387.22163470996395, 402.0598714676023, 159.43933186865968, 126.47958549180007, 392.3479432111473, 350.99728670785316, 252.91460948388345, 494.71859382426453, 433.0310228227091, 331.85813601312293, 201.5989653284342, 460.52646279227935, 314.93913949093803, 409.11835972286354, 344.95373760433057, 389.01799222020844, 319.93560967360196, 387.91983345541104, 194.21563059824905, 236.91453474157782, 399.97413753702676, 82.10354086129703, 74.79355564469759, 322.32770723218164, 221.39737405533262, 237.01355840792937, 255.01920998407772, 542.7637742441235, 390.7394602806249, 434.73749507547143, 330.9815449465496, 234.87285341141109, 313.34075630423916, 132.48369747411618, 429.2492877185501, 123.08595551984696, 244.94356028944998, 318.241766060835, 446.22034958033566, 407.75637622905975, 409.92672218138847, 274.57206843867164, 117.3103175593625, 310.6980622559958, 271.47113551766273, 288.8329538299569, 414.686250800214, 403.678506840577, 374.4776723402305, 42.44200713993639, 388.8795009773198, 369.07699536301556, 22.821027221311716, 379.02469371218035, 340.4797747217598, 387.2115976559953, 382.2147811570935, 388.09147946836555, 579.671985791256, 129.73156971041345, 280.85140394493476, 217.94951430267096, 279.24286436562255, 422.73594031496435, 551.7053219758249, 375.16928220284973, 17.431167870894036, 392.67978053793405, 356.97035024541566, 369.4664481141638, 274.890517946339, 395.2457337278548, 390.6322194918796, 252.24322536960295, 388.5829290696323, 533.9013256930054, 67.50543299262753, 402.7382741060404, 346.0674935222583, 0.0, 5.893210607707798, 329.49318271405537, 248.8816993527819, 241.72163557511158, 161.51301512387334, 408.60904243115505, 363.5365409884461, 220.54603436732856, 305.2782495191256, 488.03235626581045, 481.5429457441845, 240.78604295559103, 134.47232186572677, 285.597354800427, 378.8247647353078, 350.2442670268491, 466.02467238733743, 352.28322982436964, 494.05003068415186, 364.5119250815663, 364.38638487105857, 502.87562383917003, 328.89299130209514, 308.5908703813678, 448.4748544866833, 284.9901198972696, 267.4314799502916, 407.840017380691, 368.6798325125203, 406.30510111722486, 284.9977911128553, 442.73541266906966, 251.216591597238, 257.44347437054967, 265.4016436182101, 397.5734172521799, 230.91607419720185, 310.9565884950841, 440.536480617786, 8.527342433323208, 338.25548271601724, 366.10830828321787, 367.2812670375247, 473.3713354491895, 472.60393002544185, 322.4312841991459, 173.21198491231007, 309.03843003866484, 398.3594299193475, 264.9349285477692, 271.25505379240496, 441.4408465832435, 327.7325077877013, 34.937427991397534, 338.60640716292005]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.277297265689181, "mean_inference_ms": 5.292830705861413, "mean_action_processing_ms": 36.22114342714612, "mean_env_wait_ms": 1.6600855313448823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043059587478637695, "StateBufferConnector_ms": 0.012667655944824219, "ViewRequirementAgentConnector_ms": 0.1031806468963623}, "num_episodes": 64, "episode_return_max": 412.52149507053235, "episode_return_min": -33.475970819381516, "episode_return_mean": 92.75007060066736, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 255.48224264045456, "num_env_steps_trained_throughput_per_sec": 255.48224264045456, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 33349.096, "restore_workers_time_ms": 0.028, "training_step_time_ms": 33348.646, "sample_time_ms": 1667.362, "learn_time_ms": 31627.776, "learn_throughput": 252.942, "synch_weights_time_ms": 41.412}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 26, "trial_id": "cdf01_00000", "date": "2024-08-20_10-38-22", "timestamp": 1724130502, "time_this_iter_s": 31.361533880233765, "time_total_s": 1019.757776260376, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52c49d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1019.757776260376, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 42.99111111111111, "ram_util_percent": 82.66444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.10538966788186, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 0.0001, "total_loss": 8.942536756727431, "policy_loss": -0.0037455188136340843, "vf_loss": 8.946282305036272, "vf_explained_var": -0.007011646599996657, "kl": 0.0026149742694856503, "entropy": 0.30305223152751015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0548598054855587, "cur_kl_coeff": 0.024999999999999998, "cur_lr": 0.0001, "total_loss": 8.432755570184616, "policy_loss": -0.004187534380674598, "vf_loss": 8.436840070996965, "vf_explained_var": 0.2801641528568571, "kl": 0.004123084969171667, "entropy": 0.5406660163213336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 412.52149507053235, "episode_reward_min": -33.475970819381516, "episode_reward_mean": 88.00709470972696, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -587.6414085113422, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.40678939229215, "predator_policy": 583.6788874757608}, "policy_reward_mean": {"prey_policy": -285.0686389032983, "predator_policy": 329.0721862581618}, "custom_metrics": {}, "hist_stats": {"episode_reward": [412.52149507053235, 71.65181091345029, 242.59235274980708, 29.374542652032638, 178.6579202927118, 0.8999999999999997, 199.52825585435167, 183.75678655943352, 74.43459867376293, 15.683181068560092, 136.73027755699414, 393.5469735465929, 3.543958670935396, 0.6814540162908367, -8.970470230434834, 159.5699363904663, 0.33459249736945296, 34.87218995078189, 103.25110380370029, -0.11846623418288837, 1.8999999999999995, 6.298558739187882, -20.28193514759446, 19.822313360226783, 45.17073658078634, 18.806990995581994, 38.86495456801992, 176.94804633869913, 0.3381155206258679, 87.82328473686715, 0.10000000000000253, 265.59939289086486, 254.71547959617277, 168.31366559438516, 3.6000000000000036, 71.71259731236113, 308.587894495781, 169.00614822081621, -6.930690381041195, -0.7659383259537802, 80.01561183666715, 127.3525786326649, 115.19797851983434, 213.32475004023436, 0.05054374221954738, 61.01578602773484, 25.916116523516827, 1.9000000000000026, 0.08813354972743226, 25.598883452403744, -2.50120563424265, 8.058279795308328, 118.86738683881575, 2.220446049250313e-16, 56.07466105399384, 18.802701998361083, 7.432733918145479, 1.5660284909845084, 0.28700693794078647, 85.09803491641959, 0.9000000000000026, 206.69642259213836, 28.336291224519496, 2.1177196627150625, 202.29999999999924, 129.45690021316614, 17.889105469108966, 58.79836093385379, 154.98375945455538, 0.26925626825446214, 78.67116659921518, 0.24230006359018375, 1.0999999999999979, 81.58466912945293, 326.387057411595, 232.98786655994607, 0.916116523516822, 221.25903016471557, 0.7771126177072607, 196.16835264383664, 191.6749665417907, 53.29547808058784, 197.9358261370394, 37.68010587553451, -33.475970819381516, 0.20000000000000018, 64.10635556157423, 197.67447258775474, 335.86514933764477, 121.52940304113922, 369.8653221537949, 127.13742799139703, 6.747698754720636, 61.83632808228769, -1.7375798557506013, 2.7395998482546964, 184.36367968297847, -2.5968094000389357, 1.4, 156.30841029980826], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [118.74966363601347, -492.7588811513526, -282.5212152429045, -83.70207972979694, 103.74103656625584, -517.9460571995609, -326.9368968958024, -422.9983918219546, -364.70757685264005, -116.63583779412113, -300.10547326095116, -434.4866958644239, -535.9644314498346, -52.48664880396589, -43.14498441687288, -383.0994143196463, -393.52017585626277, -23.003903392590935, -307.23124837813003, -454.32760018656916, -388.6316993529415, 16.571067266612147, 4.6956434554632835, -526.6336705917894, -520.8542745847413, -564.4551551794287, -369.2300293387394, -482.6226552607066, -448.16829253006006, -354.2618487673466, -445.10508140370894, 0.9873690507786722, -431.71135015396385, -414.1584464351167, -183.35490684277013, -521.848695540847, -424.54697973028885, -223.86508723119695, -475.9770836204122, -274.4509974024961, -303.80585096423596, -306.1179354199622, -341.2585660864062, -369.49404852757704, -133.86438368833376, -389.95837103440107, -119.26299875502818, -325.15363571996994, -69.83361441263033, -394.24278870279136, -402.0598714676023, -140.63234087307768, -87.97496846011461, -391.987605674814, -351.32271862543024, -75.64113122760753, -494.71859382426453, -432.69290730208314, -238.9090605186167, -206.72475608607292, -460.4264627922793, -314.93913949093803, -68.01959131586435, -420.4531131204653, -402.860748075565, -51.37737422207231, -419.1477198752484, 5.325921415974377, -233.314534741578, -399.97413753702676, -17.43194273946021, -67.75255645417374, -363.1371867917334, 127.99999999999956, -156.49726375882926, -166.5293564123622, -372.65226950880054, -567.7816553969891, -434.73749507547143, -331.74748327250336, -353.141084950902, -115.056912928082, -4.47701980268727, -429.9033867573134, -115.00978642928145, -137.82175086018174, -496.0809199143908, -55.05644568654469, -407.7058324868402, -409.92672218138847, -198.70052833895164, -132.16607163134782, -287.2819457324785, -268.9711355176628, -287.332953829957, -414.2862508002139, -403.678506840577, -374.3895387905031, -13.407674689540464, -392.31494997531206, -358.9327234530161, -35.466504765553424, -381.4729982270826, -329.97319041154884, -371.5737363161236, -278.98525565814936, -388.09147946836555, -579.671985791256, -81.85690865642064, -272.6514039449329, -387.5436479867092, -90.84602868322489, -431.8982701227634, -535.1102582498803, -151.59103845352928, -239.4433831292305, -393.01729468051553, -356.3458291648933, -209.77121091284005, -349.4877202312432, -394.4457337278549, -390.5322194918796, -6.301283519786774, -427.8284483273101, -35.308228152854944, -537.7622393082587, -400.7205544433252, -345.9674935222583, 20.000000000000014, 176.40678939229215, -93.6017375909077, -355.3162442627633, -153.6130151238738, -231.73253010600297, -298.3306924188704, -415.0165300668769, -313.97146507975043, -56.86905935214839, -573.5388335108904, -395.7672122308506, -295.423920762448, -1.163277459652274, -285.35505473683685, -378.8247647353078, -349.1442670268491, -466.02467238733743, -422.11026558210744, -342.63832579695946, -372.92673473429363, -29.584517806737125, -11.139340069976418, -587.6414085113422, -307.67475385785053, -448.4748544866833, -349.2108565249918, 18.048286842146098, -407.5576263331798, -368.185110942324, -418.6720498319414, -76.46248975430223, -494.672675301484, -7.604362423032359, -200.5138212145357, -269.0358186936365, -442.6183342710815, 12.064668958740166, -272.87248530142097, -440.94047793591403, -124.33848345163761, -255.92031251708477, -366.10830828321787, -367.08126703752464, -340.08928108976613, -541.7796288232906, -333.91015108551863, 35.941354561817704, 94.22644474871413, -465.75915536908303, -295.3521159070659, -119.30846339196907, 170.2999999999998, -569.6080322171507, 91.09999999999933, -337.50640716292, -357.7379119690317, -324.50447200382996, -291.4313169652416, -231.45865533608577, -415.91958048903894, -192.27828736012603, -361.5972787190037, -554.7126916210703, -377.1909947187187, -120.50454213972142, -430.3651608742817, -448.4446781579935, -365.12979870214235, -521.2213665384191, -64.1894868353585, -433.01218008172845], "policy_predator_policy_reward": [331.0932772898186, 455.4374352960525, 291.6091633833519, 146.2659425028015, 496.14501188960435, 160.6523614935079, 315.3707773267323, 463.9390540430575, 264.75002881395545, 395.251306125518, 301.0054732609513, 434.4866958644239, 505.58822266063055, 282.3911134475217, 270.61803924868127, 339.38314604727213, 349.685289222181, 141.27338870043673, 323.8328836358254, 453.4091459974351, 218.0177232488681, 290.7731863944578, 467.43561865820226, 448.0493820247159, 505.1745009593458, 583.6788874757608, 370.2300293387395, 482.3041092769975, 449.5211949737908, 343.93847609318215, 239.07748510354574, 364.61016363985124, 432.04594265133335, 414.1584464351167, 519.725769975873, 220.3500223585259, 426.8102278659662, 324.85294289922064, 475.3093486057174, 275.0002661830079, 303.80585096423596, 308.01793541996204, 347.55712482559426, 369.49404852757704, 136.90049808838927, 366.6403214867508, 256.05364653548025, 208.18530129974377, 122.02550498624392, 387.22163470996395, 402.0598714676023, 159.43933186865968, 126.47958549180007, 392.3479432111473, 350.99728670785316, 252.91460948388345, 494.71859382426453, 433.0310228227091, 331.85813601312293, 201.5989653284342, 460.52646279227935, 314.93913949093803, 409.11835972286354, 344.95373760433057, 389.01799222020844, 319.93560967360196, 387.91983345541104, 194.21563059824905, 236.91453474157782, 399.97413753702676, 82.10354086129703, 74.79355564469759, 322.32770723218164, 221.39737405533262, 237.01355840792937, 255.01920998407772, 542.7637742441235, 390.7394602806249, 434.73749507547143, 330.9815449465496, 234.87285341141109, 313.34075630423916, 132.48369747411618, 429.2492877185501, 123.08595551984696, 244.94356028944998, 318.241766060835, 446.22034958033566, 407.75637622905975, 409.92672218138847, 274.57206843867164, 117.3103175593625, 310.6980622559958, 271.47113551766273, 288.8329538299569, 414.686250800214, 403.678506840577, 374.4776723402305, 42.44200713993639, 388.8795009773198, 369.07699536301556, 22.821027221311716, 379.02469371218035, 340.4797747217598, 387.2115976559953, 382.2147811570935, 388.09147946836555, 579.671985791256, 129.73156971041345, 280.85140394493476, 217.94951430267096, 279.24286436562255, 422.73594031496435, 551.7053219758249, 375.16928220284973, 17.431167870894036, 392.67978053793405, 356.97035024541566, 369.4664481141638, 274.890517946339, 395.2457337278548, 390.6322194918796, 252.24322536960295, 388.5829290696323, 533.9013256930054, 67.50543299262753, 402.7382741060404, 346.0674935222583, 0.0, 5.893210607707798, 329.49318271405537, 248.8816993527819, 241.72163557511158, 161.51301512387334, 408.60904243115505, 363.5365409884461, 220.54603436732856, 305.2782495191256, 488.03235626581045, 481.5429457441845, 240.78604295559103, 134.47232186572677, 285.597354800427, 378.8247647353078, 350.2442670268491, 466.02467238733743, 352.28322982436964, 494.05003068415186, 364.5119250815663, 364.38638487105857, 502.87562383917003, 328.89299130209514, 308.5908703813678, 448.4748544866833, 284.9901198972696, 267.4314799502916, 407.840017380691, 368.6798325125203, 406.30510111722486, 284.9977911128553, 442.73541266906966, 251.216591597238, 257.44347437054967, 265.4016436182101, 397.5734172521799, 230.91607419720185, 310.9565884950841, 440.536480617786, 8.527342433323208, 338.25548271601724, 366.10830828321787, 367.2812670375247, 473.3713354491895, 472.60393002544185, 322.4312841991459, 173.21198491231007, 309.03843003866484, 398.3594299193475, 264.9349285477692, 271.25505379240496, 441.4408465832435, 327.7325077877013, 34.937427991397534, 338.60640716292005, 361.57523384385036, 327.41484888373225, 286.6877911708492, 298.0385092127655, 435.96503302099785, 170.49525497241638, 363.6368785672585, 555.4126916210705, 345.30898596134944, 336.7502305800693, 430.33853783553036, 445.87449179670614, 366.52979870214267, 521.2213665384191, 228.41238461177562, 425.0976926051199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.294916745099852, "mean_inference_ms": 5.264047104893765, "mean_action_processing_ms": 35.856105179571635, "mean_env_wait_ms": 1.6599526866966847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004243612289428711, "StateBufferConnector_ms": 0.013657450675964355, "ViewRequirementAgentConnector_ms": 0.10613536834716797}, "num_episodes": 8, "episode_return_max": 412.52149507053235, "episode_return_min": -33.475970819381516, "episode_return_mean": 88.00709470972696, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 214.67831852777482, "num_env_steps_trained_throughput_per_sec": 214.67831852777482, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 33849.09, "restore_workers_time_ms": 0.034, "training_step_time_ms": 33848.612, "sample_time_ms": 1686.754, "learn_time_ms": 32108.385, "learn_throughput": 249.156, "synch_weights_time_ms": 41.224}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 27, "trial_id": "cdf01_00000", "date": "2024-08-20_10-38-59", "timestamp": 1724130539, "time_this_iter_s": 37.30992889404297, "time_total_s": 1057.067705154419, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e63820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1057.067705154419, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 65.83018867924528, "ram_util_percent": 82.84528301886793}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.414916217232507, "cur_kl_coeff": 1.2207031249999999e-05, "cur_lr": 0.0001, "total_loss": 8.82263674054827, "policy_loss": -0.003935321016673235, "vf_loss": 8.826572051880852, "vf_explained_var": 0.013864097897968594, "kl": 0.0031646085679399435, "entropy": 0.35769208707506694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 16695.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1833743611971537, "cur_kl_coeff": 0.012499999999999999, "cur_lr": 0.0001, "total_loss": 8.253428128409007, "policy_loss": -0.004124703501454658, "vf_loss": 8.257501412194873, "vf_explained_var": 0.2829511355786096, "kl": 0.004114109933081116, "entropy": 0.5156918856832716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 16695.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 397.5608136443664, "episode_reward_min": -33.475970819381516, "episode_reward_mean": 99.04824353105805, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -614.4506726454999, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 176.40678939229215, "predator_policy": 638.6000250850216}, "policy_reward_mean": {"prey_policy": -288.956556398731, "predator_policy": 338.48067816426004}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.29999999999924, 129.45690021316614, 17.889105469108966, 58.79836093385379, 154.98375945455538, 0.26925626825446214, 78.67116659921518, 0.24230006359018375, 1.0999999999999979, 81.58466912945293, 326.387057411595, 232.98786655994607, 0.916116523516822, 221.25903016471557, 0.7771126177072607, 196.16835264383664, 191.6749665417907, 53.29547808058784, 197.9358261370394, 37.68010587553451, -33.475970819381516, 0.20000000000000018, 64.10635556157423, 197.67447258775474, 335.86514933764477, 121.52940304113922, 369.8653221537949, 127.13742799139703, 6.747698754720636, 61.83632808228769, -1.7375798557506013, 2.7395998482546964, 184.36367968297847, -2.5968094000389357, 1.4, 156.30841029980826, 224.88539944408237, 1.9000000000000026, 99.80534007586695, -1.6534765122557464, 33.2040224768767, 1.321433104296176, 0.8999999999999992, 209.4913531528251, 93.68846308740753, 12.999999999999972, 13.15584739715282, -6.824978937532347, 6.661338147750939e-15, 235.12401277669642, 73.86748802403916, 13.203010536931625, 0.7940178824623498, 17.799999999999994, 6.076625127708171, 53.14933214346662, 12.686421507008069, 55.734513394875144, 0.5000000000000004, 7.776347947577172, -11.0101892504826, 157.99908735163632, 30.73187537958208, 88.73016653557445, 176.9663533890218, 397.5608136443664, 282.3717000900431, 58.3999618965109, 166.76274846466558, 278.91810455474723, 12.560732027306894, 116.1792465681084, 0.10258709454356074, 16.33203827934595, 14.978756527247091, 2.0995139703131915, 78.44780687679975, 1.4999999999999996, 1.599999999999997, 190.68749875050804, 32.26456785051441, 294.0935096518791, 37.69408574241829, 362.12494060002956, 107.74134045026926, 184.92659741097842, 2.428457914013429, -15.606145287766559, 310.7036167605699, 0.6717863652178502, 1.0999999999999972, 85.60297020221996, 245.8609479331661, 78.75545966012267, 224.33951793784703, 271.541643386239, 313.41853471442573, 5.1999999999999975, 2.47618167730266, 361.64144740338696], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.000000000000014, 176.40678939229215, -93.6017375909077, -355.3162442627633, -153.6130151238738, -231.73253010600297, -298.3306924188704, -415.0165300668769, -313.97146507975043, -56.86905935214839, -573.5388335108904, -395.7672122308506, -295.423920762448, -1.163277459652274, -285.35505473683685, -378.8247647353078, -349.1442670268491, -466.02467238733743, -422.11026558210744, -342.63832579695946, -372.92673473429363, -29.584517806737125, -11.139340069976418, -587.6414085113422, -307.67475385785053, -448.4748544866833, -349.2108565249918, 18.048286842146098, -407.5576263331798, -368.185110942324, -418.6720498319414, -76.46248975430223, -494.672675301484, -7.604362423032359, -200.5138212145357, -269.0358186936365, -442.6183342710815, 12.064668958740166, -272.87248530142097, -440.94047793591403, -124.33848345163761, -255.92031251708477, -366.10830828321787, -367.08126703752464, -340.08928108976613, -541.7796288232906, -333.91015108551863, 35.941354561817704, 94.22644474871413, -465.75915536908303, -295.3521159070659, -119.30846339196907, 170.2999999999998, -569.6080322171507, 91.09999999999933, -337.50640716292, -357.7379119690317, -324.50447200382996, -291.4313169652416, -231.45865533608577, -415.91958048903894, -192.27828736012603, -361.5972787190037, -554.7126916210703, -377.1909947187187, -120.50454213972142, -430.3651608742817, -448.4446781579935, -365.12979870214235, -521.2213665384191, -64.1894868353585, -433.01218008172845, -308.15648149088514, -157.0199686369367, -320.51163088403393, -354.31668696938794, -194.0983668510247, -155.67173013746978, -306.9059469775863, -383.66300044524576, -79.56212606436492, -40.87520837882776, -432.4436380224792, -321.86089176762175, -374.06797746164796, -325.99859112212346, -170.04104964562464, -365.7359010796994, -475.929632808063, -83.04408594799854, -86.30609929468176, -346.2011784316633, -183.53602460344058, -479.3407507217217, -576.9398771167089, -323.5239809017683, -341.57501368889, -415.13637629707824, -458.68191672143735, -110.95002720527754, -228.2220416188847, -323.84781953229873, -293.88725915974976, -377.3103374290502, -314.1737996488972, -279.58901397068837, -205.95476472017646, -222.1757523673161, -414.54571974454745, -403.35415118649126, -604.550570572176, -39.89453011169485, -281.12414723638045, -338.24047617714496, 20.000000000000014, -442.81004591386795, -506.1135368035468, -316.7178394271961, -331.57169308269783, -492.03233013535123, -162.91493750788516, -314.6381248811269, -313.41985398802626, -313.4994424724194, -251.23122974478886, -394.79192423231626, -222.69445321812364, -412.2591738032531, -442.3467910127623, -4.375671412165202, 58.09521224666709, -411.96284962475454, -184.90227977756345, -125.95536852482235, -290.7662077923374, -63.539714432007585, -107.74900155412107, -336.64740013157575, 19.002077126590677, -406.9448606861344, -403.8539009795433, -152.33382208134964, 19.866660597316603, -314.94090093150027, -443.1007170445548, -315.2925422145898, -97.30827892965875, -344.759304712821, -331.2360766270866, -278.37110939205047, -423.2299239594243, -344.61667213059934, -165.7489725267883, -369.3679619566575, -360.4427300066029, -297.2666580920849, -344.74436097374354, -336.17612834321784, -399.6210862197044, -124.77345202785327, -78.90831402525741, -504.4779299988775, 78.49999999999932, -613.1958221927897, -272.7409800133063, -493.4401034554325, 12.50269151647947, -502.23339504970727, -589.664660940161, -222.61431597964219, -614.4506726454999, -344.3627154461561, -438.7316917975895, -387.94241844617744, -405.2536623218298, -203.8068356815561, 63.26918525874425, -593.494746447608, -379.3753184571311, -436.2744805986907, -407.5807783790952, -372.3376273180475, -446.51537399004883, -140.96495450758152, 13.769124328752913, -542.7527300835054, -234.22897039964636, -350.72986913728704, -182.48497216959308, -291.90384836493786, -0.39359028524958417, -381.58690725411054, -479.2375341661063, -103.57486515810913, -458.25165236829207, -356.6269644609185, -360.536486773969, -312.81298465351676, -465.97583566917206, 11.783700843180142], "policy_predator_policy_reward": [0.0, 5.893210607707798, 329.49318271405537, 248.8816993527819, 241.72163557511158, 161.51301512387334, 408.60904243115505, 363.5365409884461, 220.54603436732856, 305.2782495191256, 488.03235626581045, 481.5429457441845, 240.78604295559103, 134.47232186572677, 285.597354800427, 378.8247647353078, 350.2442670268491, 466.02467238733743, 352.28322982436964, 494.05003068415186, 364.5119250815663, 364.38638487105857, 502.87562383917003, 328.89299130209514, 308.5908703813678, 448.4748544866833, 284.9901198972696, 267.4314799502916, 407.840017380691, 368.6798325125203, 406.30510111722486, 284.9977911128553, 442.73541266906966, 251.216591597238, 257.44347437054967, 265.4016436182101, 397.5734172521799, 230.91607419720185, 310.9565884950841, 440.536480617786, 8.527342433323208, 338.25548271601724, 366.10830828321787, 367.2812670375247, 473.3713354491895, 472.60393002544185, 322.4312841991459, 173.21198491231007, 309.03843003866484, 398.3594299193475, 264.9349285477692, 271.25505379240496, 441.4408465832435, 327.7325077877013, 34.937427991397534, 338.60640716292005, 361.57523384385036, 327.41484888373225, 286.6877911708492, 298.0385092127655, 435.96503302099785, 170.49525497241638, 363.6368785672585, 555.4126916210705, 345.30898596134944, 336.7502305800693, 430.33853783553036, 445.87449179670614, 366.52979870214267, 521.2213665384191, 228.41238461177562, 425.0976926051199, 312.57665203664897, 377.4851975352557, 320.61163088403396, 356.11668696938835, 3.482988840021, 446.09244822433965, 305.2524704653306, 383.66300044524576, 55.62035415869177, 98.02100276137678, 442.40595642872853, 313.2200064656684, 374.06797746164796, 326.8985911221234, 407.9568374953642, 337.3114663827842, 476.63174246291146, 176.03043938055836, 99.00609929468105, 346.5011784316634, 196.69187200059284, 479.3407507217217, 561.4428070429556, 332.19607203798927, 341.57501368889, 415.13637629707824, 483.4128058202145, 321.3431508831979, 291.4985606766215, 334.43878849860266, 302.45473579074843, 381.9458713349831, 281.4230663645261, 313.13376513752183, 214.45476472017597, 231.47575236731603, 409.15415118649133, 414.82234487225566, 281.65739192075597, 415.93704090658076, 322.96775883188366, 309.08328608864963, 442.81004591386795, 35.73451339487506, 506.1135368035468, 317.2178394271961, 339.34804103027494, 492.03233013535123, 171.20182343571113, 295.3410497028184, 417.3146130656174, 367.6037707464654, 397.3739957866164, 279.38103357007077, 362.6529689307372, 361.03082462621404, 230.06483220258394, 393.62398361136604, 390.2587982672947, 361.1696527551576, 295.232823499719, 297.99652489271034, 266.9490121617155, 145.75687195914057, 273.75784076282883, 337.40130938753384, 285.6109063608374, 381.2499817534539, 404.56469072268993, 164.18376436550943, 98.06129707554938, 313.19218982674346, 443.20071704455484, 315.29512930913336, 358.85425065912574, 99.5453712626993, 301.21687809116185, 323.36906445522413, 423.8294379297375, 346.1166721305995, 245.60080069902958, 367.96394066121553, 360.4427300066029, 298.76665809208487, 345.64436097374374, 336.8761283432179, 341.6704725398791, 373.41156445818547, 110.4728818757711, 505.17792999887746, 444.5057781761372, 384.283553668531, 314.63543221115316, 489.23973700000414, 435.59407429504415, 416.26156983821255, 422.9067355498814, 497.11358182018944, 505.1399604176139, 638.6000250850216, 440.3201015129848, 388.78246664479616, 422.21472265130535, 171.23963006431367, 462.3097742974454, 378.6194036519888, 379.42283686893734, 436.89874855210235, 408.5807783790952, 372.43762731804753, 413.6990260395452, 259.38427266030493, 351.21028418274125, 423.63426950517817, 355.13315957051077, 308.5811396265455, 406.7308066379352, 291.9975318344437, 274.50399747097674, 379.0181434546229, 439.6511217001293, 456.57981233851143, 460.15165236829205, 359.92696446091924, 361.01579939703834, 314.80985370775016, 406.1995488633735, 409.6340333660044]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.139427992359233, "mean_inference_ms": 5.209918671385027, "mean_action_processing_ms": 33.70339425048822, "mean_env_wait_ms": 1.6407501474984911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004892110824584961, "StateBufferConnector_ms": 0.04904890060424805, "ViewRequirementAgentConnector_ms": 0.17992150783538818}, "num_episodes": 64, "episode_return_max": 397.5608136443664, "episode_return_min": -33.475970819381516, "episode_return_mean": 99.04824353105805, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 256.97597425047195, "num_env_steps_trained_throughput_per_sec": 256.97597425047195, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 33811.822, "restore_workers_time_ms": 0.034, "training_step_time_ms": 33811.38, "sample_time_ms": 1710.025, "learn_time_ms": 32050.01, "learn_throughput": 249.61, "synch_weights_time_ms": 40.281}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 28, "trial_id": "cdf01_00000", "date": "2024-08-20_10-39-31", "timestamp": 1724130571, "time_this_iter_s": 31.182852029800415, "time_total_s": 1088.2505571842194, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e3c310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1088.2505571842194, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 41.64545454545455, "ram_util_percent": 83.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.132454313739898, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 0.0001, "total_loss": 8.425521630332584, "policy_loss": -0.003868715138366771, "vf_loss": 8.429390336596777, "vf_explained_var": 0.08958736185043577, "kl": 0.0028626315748713697, "entropy": 0.3746048534200305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 17325.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5152607404050373, "cur_kl_coeff": 0.0062499999999999995, "cur_lr": 0.0001, "total_loss": 7.975719784933423, "policy_loss": -0.004904436433894766, "vf_loss": 7.980593311218988, "vf_explained_var": 0.27441233642517576, "kl": 0.004950393398642532, "entropy": 0.5385059527934544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 17325.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 362.12494060002956, "episode_reward_min": -49.54182492198916, "episode_reward_mean": 80.70070756299668, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -628.2690616472116, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 109.16169211022027, "predator_policy": 638.6000250850216}, "policy_reward_mean": {"prey_policy": -292.1742013334201, "predator_policy": 332.5245551149185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.10258709454356074, 16.33203827934595, 14.978756527247091, 2.0995139703131915, 78.44780687679975, 1.4999999999999996, 1.599999999999997, 190.68749875050804, 32.26456785051441, 294.0935096518791, 37.69408574241829, 362.12494060002956, 107.74134045026926, 184.92659741097842, 2.428457914013429, -15.606145287766559, 310.7036167605699, 0.6717863652178502, 1.0999999999999972, 85.60297020221996, 245.8609479331661, 78.75545966012267, 224.33951793784703, 271.541643386239, 313.41853471442573, 5.1999999999999975, 2.47618167730266, 361.64144740338696, 52.240424258123255, 108.1279608226193, -0.5361877604079477, 197.97423721097448, -6.04664582464963, 1.5999999999999988, 14.616934405208205, 7.680026327037112, -23.04117219027384, 33.86827903206314, 0.7286108690684683, 1.1999999999999988, 224.2056554775377, 153.999678866785, 106.62961460069283, 3.8, 2.9538192463132904, 3.839736551867299, 112.04805410607295, 113.13032092223085, -49.54182492198916, 96.70430410602059, 30.42880994072266, 162.20496887265156, 107.73404898251874, 89.83500926992429, 42.228489455948704, 2.000000000000003, 237.81590927276528, 42.146844948385805, 40.371804853424166, 8.731318335757003, 2.7563164739639037, 4.5, 78.9890573206139, 2.1, 60.81350789602375, 163.3755067222278, 10.22404901063311, 2.8299203570951827, 37.07586997008881, 350.28656943112173, 1.1942174202791398, 39.60000000000029, 51.000000000000426, 99.02738462289517, 21.319134193314028, 128.94663011117856, -11.109053708288684, 6.9100352818650865, 125.26170733385024, 163.00282000869205, -3.8081188596404845, 27.20000000000005, -3.3306690738754696e-15, 27.308908461937158, -0.5451829611390808, 227.97118951909758, 1.7228260553523274, 229.04113770505603, 209.49847568246003, 249.3172941724989, -4.4089058558923675, 25.158092955966477, 171.19129893520082, 6.01608514200128, 177.3226504543212, -22.277559702898596, -14.145285586552166, 94.68664615753974, 241.976432683471, -43.66559301365005], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-443.1007170445548, -315.2925422145898, -97.30827892965875, -344.759304712821, -331.2360766270866, -278.37110939205047, -423.2299239594243, -344.61667213059934, -165.7489725267883, -369.3679619566575, -360.4427300066029, -297.2666580920849, -344.74436097374354, -336.17612834321784, -399.6210862197044, -124.77345202785327, -78.90831402525741, -504.4779299988775, 78.49999999999932, -613.1958221927897, -272.7409800133063, -493.4401034554325, 12.50269151647947, -502.23339504970727, -589.664660940161, -222.61431597964219, -614.4506726454999, -344.3627154461561, -438.7316917975895, -387.94241844617744, -405.2536623218298, -203.8068356815561, 63.26918525874425, -593.494746447608, -379.3753184571311, -436.2744805986907, -407.5807783790952, -372.3376273180475, -446.51537399004883, -140.96495450758152, 13.769124328752913, -542.7527300835054, -234.22897039964636, -350.72986913728704, -182.48497216959308, -291.90384836493786, -0.39359028524958417, -381.58690725411054, -479.2375341661063, -103.57486515810913, -458.25165236829207, -356.6269644609185, -360.536486773969, -312.81298465351676, -465.97583566917206, 11.783700843180142, -338.19757236236296, -200.80905601166546, -589.4632818097436, -4.261320659500143, -465.74066943520165, -328.49861037072174, -448.94891988402605, -72.94516330017382, -496.4761863852469, -421.1149236333711, -282.55821100039464, -290.480586624993, -628.2690616472116, -89.92714818024226, -293.7837168370845, -295.5033130169773, -328.43408914723943, -418.16845840038405, -105.90185363812574, -375.74724034228836, -567.0657780150528, -387.53902508085616, -435.51917468029814, -369.44754331402424, -412.0714450584381, -73.8266258423095, -227.80021063656355, -381.62124479639783, -289.2242283432635, -219.07454445459888, -357.38222293328863, -430.4172832073248, -307.88849044760644, -294.04783337344367, -80.55815525992841, -398.4735645434752, -182.88377226624607, -488.26470428884534, -386.49065835509265, -59.90178583395988, -328.19714200188974, -437.0207671575497, -403.27950201435243, -208.05738970928928, -495.49254465179195, -67.62925589194735, -64.51963750456778, -320.7184045301266, -267.1954802424343, -251.8873151282662, -496.84420063625214, -188.89178892932622, -322.11735082719304, -449.608119376361, -324.59752054636687, -389.96878208772034, -53.95112064807493, -480.3071171386166, -47.84772213503777, -403.7529151572266, -169.50258046497618, -345.57609510046575, -430.7688856064951, -385.0736331649432, -303.96752795231595, -315.648148385942, -448.8428657938622, -333.7928294816246, -486.7886251388266, -25.52172326316626, -403.1995168389868, -304.5061330808312, -180.53926518685145, -0.36010391995210644, -79.11465036466097, -453.3907351686041, -398.80637858335007, -268.11850445832056, -459.131682530671, -491.03221774137614, 5.237200131185981, -39.53559169823065, -403.65497770055964, 109.16169211022027, -314.9938112480244, -301.03543637679354, 16.235370348948123, 20.000000000000014, 20.000000000000014, -9.348461834078373, -437.85950114846634, -24.502467127331524, -19.887789864139847, -491.100534574693, -61.26609134848412, -406.4882302913863, -394.9417294110587, -45.47843225918976, -439.97882592485024, -135.30149984165865, -304.3518264709525, -236.92396608419193, -184.3427785044825, -299.43588271207824, -444.9965668612918, -249.0536239996583, -343.07935533126545, -204.18703201852858, -361.63897264791825, -471.4441466618013, -193.09863312925728, -365.48119815153825, -388.3772763391146, -494.7775300282605, 14.202434861233986, -426.6609215425154, -295.88858482475894, -251.6149256698858, -140.01316200554405, -482.8155463588503, -206.66870275741792, -280.6868303290835, 9.212686826835538, -597.7463095808955, -308.70167180920197, -407.22691037041, -361.0553576082071, -398.7468097589996, -6.946775854531198, -338.5294076487985, -343.7977755244292, -318.4374253154869, -85.75480965257681, -296.33025943512695, -97.38105009863884, -359.3483624776028, -247.72302601168218, -96.72509498252658, -325.67307891856245, 20.000000000000014, -447.6841435920502, -38.83905516756503, -252.26422499084805, -293.0781252815103], "policy_predator_policy_reward": [443.20071704455484, 315.29512930913336, 358.85425065912574, 99.5453712626993, 301.21687809116185, 323.36906445522413, 423.8294379297375, 346.1166721305995, 245.60080069902958, 367.96394066121553, 360.4427300066029, 298.76665809208487, 345.64436097374374, 336.8761283432179, 341.6704725398791, 373.41156445818547, 110.4728818757711, 505.17792999887746, 444.5057781761372, 384.283553668531, 314.63543221115316, 489.23973700000414, 435.59407429504415, 416.26156983821255, 422.9067355498814, 497.11358182018944, 505.1399604176139, 638.6000250850216, 440.3201015129848, 388.78246664479616, 422.21472265130535, 171.23963006431367, 462.3097742974454, 378.6194036519888, 379.42283686893734, 436.89874855210235, 408.5807783790952, 372.43762731804753, 413.6990260395452, 259.38427266030493, 351.21028418274125, 423.63426950517817, 355.13315957051077, 308.5811396265455, 406.7308066379352, 291.9975318344437, 274.50399747097674, 379.0181434546229, 439.6511217001293, 456.57981233851143, 460.15165236829205, 359.92696446091924, 361.01579939703834, 314.80985370775016, 406.1995488633735, 409.6340333660044, 338.2975723623629, 252.94948026978815, 477.6805603375539, 224.17200295431005, 325.5650442535914, 468.13804779192395, 384.0446931455363, 335.82362724963946, 487.8743055676216, 423.6701586263471, 283.2582110003946, 291.38058662499293, 626.1640544752715, 106.64908975738979, 302.45723622716724, 294.5098199539321, 289.1836937826948, 434.37768157465393, 355.96764705716123, 159.54972595531504, 567.665778015053, 387.6676359499246, 436.4191746802981, 369.74754331402426, 351.1924638472768, 358.911262531007, 417.4441074264897, 345.9770268732562, 319.0968806708854, 295.8315067276691, 361.18222293328864, 430.4172832073248, 326.43849147332884, 278.45165159403655, 58.22939458684537, 424.6420617684257, 354.57065626701325, 428.6258743941513, 364.17449553492423, 195.34826957636005, 284.9214275828929, 430.7546566545574, 385.0993795553578, 322.94181627430476, 496.192544651792, 97.35806583266921, 250.0124696606196, 297.4305412467263, 191.2539382830053, 435.5629060702142, 494.30166027784094, 281.26933855766174, 384.4232896031493, 429.53067005635467, 326.497520546367, 390.0687820877203, 340.9642115463776, 431.1099355130789, 90.37307838540133, 403.37440385524906, 244.56879115205783, 310.88168926680885, 387.53787017986116, 437.03596692733527, 317.4181684839098, 304.9538243283122, 452.8428657938622, 334.2928294816247, 429.9353071518371, 161.3640985707693, 403.5995168389868, 306.2061330808311, 43.42624422668836, 198.28663277613845, 245.21001167742548, 450.6708805780675, 212.29144774217573, 464.857484310129, 461.46160288776605, 491.53221774137626, 15.938669838902541, 55.43559169823087, 354.3468131819507, 290.43304183950966, 316.4938112480243, 300.7296537970727, 3.3646296510518425, 0.0, 0.0, 40.34846183407843, 366.30815786247604, 195.0811950362171, 41.206924057454096, 491.100534574693, 425.4365656844763, 171.2643860665742, 413.3151670375152, 15.995940924444852, 441.75537232559066, 140.4349887227828, 308.2188730651269, 358.31862682386685, 442.81057838314, 203.97090284211404, 448.78776262709835, 241.4543093742111, 229.98703201852854, 344.4793553312654, 361.63897264791825, 471.4441466618013, 220.4075415911944, 365.48119815153825, 387.2750605446178, 495.33456286161817, 273.12386231764407, 367.3058138827353, 292.75807175833523, 256.46826479166106, 396.89627084028467, 454.97357522916406, 419.3452316507104, 277.5087771182529, 444.5860522223853, 393.2648647041734, 303.70262880568606, 407.81704751803386, 386.6898654885285, 398.2703948346438, 189.2325696460508, 327.43491279248053, 346.51386066643107, 321.737425315487, 265.19058105444424, 294.2171384875807, 71.44771905489227, 363.00413381845084, 45.05839747674182, 285.2444379309141, 68.61069796520182, 331.7490271109033, 391.3264701668725, 337.1731612762133, 268.1328046303977, 233.54395262831014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.099958350622212, "mean_inference_ms": 5.177103172416265, "mean_action_processing_ms": 32.50888817212699, "mean_env_wait_ms": 1.6305432776447315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005250215530395508, "StateBufferConnector_ms": 0.06982314586639404, "ViewRequirementAgentConnector_ms": 0.1822134256362915}, "num_episodes": 72, "episode_return_max": 362.12494060002956, "episode_return_min": -49.54182492198916, "episode_return_mean": 80.70070756299668, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 246.43200370949054, "num_env_steps_trained_throughput_per_sec": 246.43200370949054, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 33848.167, "restore_workers_time_ms": 0.034, "training_step_time_ms": 33847.664, "sample_time_ms": 1866.735, "learn_time_ms": 31933.999, "learn_throughput": 250.517, "synch_weights_time_ms": 36.179}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 29, "trial_id": "cdf01_00000", "date": "2024-08-20_10-40-03", "timestamp": 1724130603, "time_this_iter_s": 32.506189823150635, "time_total_s": 1120.75674700737, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5a040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1120.75674700737, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 41.31739130434783, "ram_util_percent": 82.8195652173913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.795085829307163, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 8.76848913677155, "policy_loss": -0.004571175274424373, "vf_loss": 8.773060268825954, "vf_explained_var": 0.0015439095951261974, "kl": 0.003967057022689207, "entropy": 0.31045833774029263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.617211980952157, "cur_kl_coeff": 0.0031249999999999997, "cur_lr": 0.0001, "total_loss": 8.474316911091881, "policy_loss": -0.0042659903750828804, "vf_loss": 8.478571100840492, "vf_explained_var": 0.34101427292066905, "kl": 0.0037645131815311505, "entropy": 0.4884796637391287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 362.12494060002956, "episode_reward_min": -49.54182492198916, "episode_reward_mean": 80.70070756299668, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -628.2690616472116, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 109.16169211022027, "predator_policy": 638.6000250850216}, "policy_reward_mean": {"prey_policy": -292.1742013334201, "predator_policy": 332.5245551149185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.10258709454356074, 16.33203827934595, 14.978756527247091, 2.0995139703131915, 78.44780687679975, 1.4999999999999996, 1.599999999999997, 190.68749875050804, 32.26456785051441, 294.0935096518791, 37.69408574241829, 362.12494060002956, 107.74134045026926, 184.92659741097842, 2.428457914013429, -15.606145287766559, 310.7036167605699, 0.6717863652178502, 1.0999999999999972, 85.60297020221996, 245.8609479331661, 78.75545966012267, 224.33951793784703, 271.541643386239, 313.41853471442573, 5.1999999999999975, 2.47618167730266, 361.64144740338696, 52.240424258123255, 108.1279608226193, -0.5361877604079477, 197.97423721097448, -6.04664582464963, 1.5999999999999988, 14.616934405208205, 7.680026327037112, -23.04117219027384, 33.86827903206314, 0.7286108690684683, 1.1999999999999988, 224.2056554775377, 153.999678866785, 106.62961460069283, 3.8, 2.9538192463132904, 3.839736551867299, 112.04805410607295, 113.13032092223085, -49.54182492198916, 96.70430410602059, 30.42880994072266, 162.20496887265156, 107.73404898251874, 89.83500926992429, 42.228489455948704, 2.000000000000003, 237.81590927276528, 42.146844948385805, 40.371804853424166, 8.731318335757003, 2.7563164739639037, 4.5, 78.9890573206139, 2.1, 60.81350789602375, 163.3755067222278, 10.22404901063311, 2.8299203570951827, 37.07586997008881, 350.28656943112173, 1.1942174202791398, 39.60000000000029, 51.000000000000426, 99.02738462289517, 21.319134193314028, 128.94663011117856, -11.109053708288684, 6.9100352818650865, 125.26170733385024, 163.00282000869205, -3.8081188596404845, 27.20000000000005, -3.3306690738754696e-15, 27.308908461937158, -0.5451829611390808, 227.97118951909758, 1.7228260553523274, 229.04113770505603, 209.49847568246003, 249.3172941724989, -4.4089058558923675, 25.158092955966477, 171.19129893520082, 6.01608514200128, 177.3226504543212, -22.277559702898596, -14.145285586552166, 94.68664615753974, 241.976432683471, -43.66559301365005], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-443.1007170445548, -315.2925422145898, -97.30827892965875, -344.759304712821, -331.2360766270866, -278.37110939205047, -423.2299239594243, -344.61667213059934, -165.7489725267883, -369.3679619566575, -360.4427300066029, -297.2666580920849, -344.74436097374354, -336.17612834321784, -399.6210862197044, -124.77345202785327, -78.90831402525741, -504.4779299988775, 78.49999999999932, -613.1958221927897, -272.7409800133063, -493.4401034554325, 12.50269151647947, -502.23339504970727, -589.664660940161, -222.61431597964219, -614.4506726454999, -344.3627154461561, -438.7316917975895, -387.94241844617744, -405.2536623218298, -203.8068356815561, 63.26918525874425, -593.494746447608, -379.3753184571311, -436.2744805986907, -407.5807783790952, -372.3376273180475, -446.51537399004883, -140.96495450758152, 13.769124328752913, -542.7527300835054, -234.22897039964636, -350.72986913728704, -182.48497216959308, -291.90384836493786, -0.39359028524958417, -381.58690725411054, -479.2375341661063, -103.57486515810913, -458.25165236829207, -356.6269644609185, -360.536486773969, -312.81298465351676, -465.97583566917206, 11.783700843180142, -338.19757236236296, -200.80905601166546, -589.4632818097436, -4.261320659500143, -465.74066943520165, -328.49861037072174, -448.94891988402605, -72.94516330017382, -496.4761863852469, -421.1149236333711, -282.55821100039464, -290.480586624993, -628.2690616472116, -89.92714818024226, -293.7837168370845, -295.5033130169773, -328.43408914723943, -418.16845840038405, -105.90185363812574, -375.74724034228836, -567.0657780150528, -387.53902508085616, -435.51917468029814, -369.44754331402424, -412.0714450584381, -73.8266258423095, -227.80021063656355, -381.62124479639783, -289.2242283432635, -219.07454445459888, -357.38222293328863, -430.4172832073248, -307.88849044760644, -294.04783337344367, -80.55815525992841, -398.4735645434752, -182.88377226624607, -488.26470428884534, -386.49065835509265, -59.90178583395988, -328.19714200188974, -437.0207671575497, -403.27950201435243, -208.05738970928928, -495.49254465179195, -67.62925589194735, -64.51963750456778, -320.7184045301266, -267.1954802424343, -251.8873151282662, -496.84420063625214, -188.89178892932622, -322.11735082719304, -449.608119376361, -324.59752054636687, -389.96878208772034, -53.95112064807493, -480.3071171386166, -47.84772213503777, -403.7529151572266, -169.50258046497618, -345.57609510046575, -430.7688856064951, -385.0736331649432, -303.96752795231595, -315.648148385942, -448.8428657938622, -333.7928294816246, -486.7886251388266, -25.52172326316626, -403.1995168389868, -304.5061330808312, -180.53926518685145, -0.36010391995210644, -79.11465036466097, -453.3907351686041, -398.80637858335007, -268.11850445832056, -459.131682530671, -491.03221774137614, 5.237200131185981, -39.53559169823065, -403.65497770055964, 109.16169211022027, -314.9938112480244, -301.03543637679354, 16.235370348948123, 20.000000000000014, 20.000000000000014, -9.348461834078373, -437.85950114846634, -24.502467127331524, -19.887789864139847, -491.100534574693, -61.26609134848412, -406.4882302913863, -394.9417294110587, -45.47843225918976, -439.97882592485024, -135.30149984165865, -304.3518264709525, -236.92396608419193, -184.3427785044825, -299.43588271207824, -444.9965668612918, -249.0536239996583, -343.07935533126545, -204.18703201852858, -361.63897264791825, -471.4441466618013, -193.09863312925728, -365.48119815153825, -388.3772763391146, -494.7775300282605, 14.202434861233986, -426.6609215425154, -295.88858482475894, -251.6149256698858, -140.01316200554405, -482.8155463588503, -206.66870275741792, -280.6868303290835, 9.212686826835538, -597.7463095808955, -308.70167180920197, -407.22691037041, -361.0553576082071, -398.7468097589996, -6.946775854531198, -338.5294076487985, -343.7977755244292, -318.4374253154869, -85.75480965257681, -296.33025943512695, -97.38105009863884, -359.3483624776028, -247.72302601168218, -96.72509498252658, -325.67307891856245, 20.000000000000014, -447.6841435920502, -38.83905516756503, -252.26422499084805, -293.0781252815103], "policy_predator_policy_reward": [443.20071704455484, 315.29512930913336, 358.85425065912574, 99.5453712626993, 301.21687809116185, 323.36906445522413, 423.8294379297375, 346.1166721305995, 245.60080069902958, 367.96394066121553, 360.4427300066029, 298.76665809208487, 345.64436097374374, 336.8761283432179, 341.6704725398791, 373.41156445818547, 110.4728818757711, 505.17792999887746, 444.5057781761372, 384.283553668531, 314.63543221115316, 489.23973700000414, 435.59407429504415, 416.26156983821255, 422.9067355498814, 497.11358182018944, 505.1399604176139, 638.6000250850216, 440.3201015129848, 388.78246664479616, 422.21472265130535, 171.23963006431367, 462.3097742974454, 378.6194036519888, 379.42283686893734, 436.89874855210235, 408.5807783790952, 372.43762731804753, 413.6990260395452, 259.38427266030493, 351.21028418274125, 423.63426950517817, 355.13315957051077, 308.5811396265455, 406.7308066379352, 291.9975318344437, 274.50399747097674, 379.0181434546229, 439.6511217001293, 456.57981233851143, 460.15165236829205, 359.92696446091924, 361.01579939703834, 314.80985370775016, 406.1995488633735, 409.6340333660044, 338.2975723623629, 252.94948026978815, 477.6805603375539, 224.17200295431005, 325.5650442535914, 468.13804779192395, 384.0446931455363, 335.82362724963946, 487.8743055676216, 423.6701586263471, 283.2582110003946, 291.38058662499293, 626.1640544752715, 106.64908975738979, 302.45723622716724, 294.5098199539321, 289.1836937826948, 434.37768157465393, 355.96764705716123, 159.54972595531504, 567.665778015053, 387.6676359499246, 436.4191746802981, 369.74754331402426, 351.1924638472768, 358.911262531007, 417.4441074264897, 345.9770268732562, 319.0968806708854, 295.8315067276691, 361.18222293328864, 430.4172832073248, 326.43849147332884, 278.45165159403655, 58.22939458684537, 424.6420617684257, 354.57065626701325, 428.6258743941513, 364.17449553492423, 195.34826957636005, 284.9214275828929, 430.7546566545574, 385.0993795553578, 322.94181627430476, 496.192544651792, 97.35806583266921, 250.0124696606196, 297.4305412467263, 191.2539382830053, 435.5629060702142, 494.30166027784094, 281.26933855766174, 384.4232896031493, 429.53067005635467, 326.497520546367, 390.0687820877203, 340.9642115463776, 431.1099355130789, 90.37307838540133, 403.37440385524906, 244.56879115205783, 310.88168926680885, 387.53787017986116, 437.03596692733527, 317.4181684839098, 304.9538243283122, 452.8428657938622, 334.2928294816247, 429.9353071518371, 161.3640985707693, 403.5995168389868, 306.2061330808311, 43.42624422668836, 198.28663277613845, 245.21001167742548, 450.6708805780675, 212.29144774217573, 464.857484310129, 461.46160288776605, 491.53221774137626, 15.938669838902541, 55.43559169823087, 354.3468131819507, 290.43304183950966, 316.4938112480243, 300.7296537970727, 3.3646296510518425, 0.0, 0.0, 40.34846183407843, 366.30815786247604, 195.0811950362171, 41.206924057454096, 491.100534574693, 425.4365656844763, 171.2643860665742, 413.3151670375152, 15.995940924444852, 441.75537232559066, 140.4349887227828, 308.2188730651269, 358.31862682386685, 442.81057838314, 203.97090284211404, 448.78776262709835, 241.4543093742111, 229.98703201852854, 344.4793553312654, 361.63897264791825, 471.4441466618013, 220.4075415911944, 365.48119815153825, 387.2750605446178, 495.33456286161817, 273.12386231764407, 367.3058138827353, 292.75807175833523, 256.46826479166106, 396.89627084028467, 454.97357522916406, 419.3452316507104, 277.5087771182529, 444.5860522223853, 393.2648647041734, 303.70262880568606, 407.81704751803386, 386.6898654885285, 398.2703948346438, 189.2325696460508, 327.43491279248053, 346.51386066643107, 321.737425315487, 265.19058105444424, 294.2171384875807, 71.44771905489227, 363.00413381845084, 45.05839747674182, 285.2444379309141, 68.61069796520182, 331.7490271109033, 391.3264701668725, 337.1731612762133, 268.1328046303977, 233.54395262831014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.099958350622212, "mean_inference_ms": 5.177103172416265, "mean_action_processing_ms": 32.50888817212699, "mean_env_wait_ms": 1.6305432776447315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005250215530395508, "StateBufferConnector_ms": 0.06982314586639404, "ViewRequirementAgentConnector_ms": 0.1822134256362915}, "num_episodes": 0, "episode_return_max": 362.12494060002956, "episode_return_min": -49.54182492198916, "episode_return_mean": 80.70070756299668, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 262.93302709351497, "num_env_steps_trained_throughput_per_sec": 262.93302709351497, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 33600.597, "restore_workers_time_ms": 0.035, "training_step_time_ms": 33600.101, "sample_time_ms": 1783.865, "learn_time_ms": 31776.139, "learn_throughput": 251.761, "synch_weights_time_ms": 30.445}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 30, "trial_id": "cdf01_00000", "date": "2024-08-20_10-40-34", "timestamp": 1724130634, "time_this_iter_s": 30.451745986938477, "time_total_s": 1151.2084929943085, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1151.2084929943085, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 38.58863636363636, "ram_util_percent": 82.12272727272726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.2107278950630675, "cur_kl_coeff": 1.5258789062499999e-06, "cur_lr": 0.0001, "total_loss": 8.725518748873757, "policy_loss": -0.004313825813329055, "vf_loss": 8.729832522831266, "vf_explained_var": -0.13712030488347252, "kl": 0.0032733423548304726, "entropy": 0.31159534501650976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 18585.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8451037940524873, "cur_kl_coeff": 0.0015624999999999999, "cur_lr": 0.0001, "total_loss": 8.151539025231013, "policy_loss": -0.004711169845956777, "vf_loss": 8.156244491395496, "vf_explained_var": 0.37611304474255397, "kl": 0.003664324899176473, "entropy": 0.48269110572716545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 18585.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 352.6553700271976, "episode_reward_min": -43.66559301365005, "episode_reward_mean": 97.51778273127462, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -693.1774658947484, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 124.21721008195733, "predator_policy": 615.9558927618864}, "policy_reward_mean": {"prey_policy": -277.89428727385365, "predator_policy": 326.65317863949093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.000000000000426, 99.02738462289517, 21.319134193314028, 128.94663011117856, -11.109053708288684, 6.9100352818650865, 125.26170733385024, 163.00282000869205, -3.8081188596404845, 27.20000000000005, -3.3306690738754696e-15, 27.308908461937158, -0.5451829611390808, 227.97118951909758, 1.7228260553523274, 229.04113770505603, 209.49847568246003, 249.3172941724989, -4.4089058558923675, 25.158092955966477, 171.19129893520082, 6.01608514200128, 177.3226504543212, -22.277559702898596, -14.145285586552166, 94.68664615753974, 241.976432683471, -43.66559301365005, 82.57869536439956, 67.62361136613373, 323.49738801433824, 222.0966543677402, 0.899999999999999, 0.9000000000000001, 147.37782364268625, 210.17586929042963, -1.3711479078736217, 0.2999999999999978, -32.00579663995902, 39.59768906722891, 42.63493289155889, 35.298704877592286, 155.62721233561103, -0.01283082056319107, 177.25638350249338, 116.32580574035659, 352.6553700271976, 5.230729152639384, 58.65195578982789, 0.13515102167409898, 184.1180895636575, 0.899999999999999, 228.73326140379882, 274.6483409597302, 18.667100849473307, 0.6718123477257487, 58.46611509681654, 169.81419162621992, 306.70535153691804, 0.9981253659088778, 218.00181304900622, 3.9000000000000004, 74.05989172506418, 131.45291042642472, 240.4724922503767, 4.5934935179354355, 110.51507245349106, 36.4281836512688, 294.44552049141095, 22.951855928258674, 7.899999999999997, 201.72493969401498, 55.88519617582631, 119.01867277443677, 289.59988795242043, 17.713047363893242, 2.0841967806862236, 0.668335969176955, 88.49521346854652, 217.20964809908276, 31.101641052011196, 1.4000000000000026, 170.45382940472217, 49.347697575513905, 91.6736186138116, -0.9136882812236, 11.265231072165413, -8.186578690770826, 305.1519984028048, 233.6144051161021, 12.2572116736282, 123.19113665355097, 6.7680600540706095, 164.84955179923574, 345.35671589036923, 318.32946750546677, 86.88120014762484, 121.16567227072308, -0.8145792794773627, 118.64967075341349], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.000000000000014, -9.348461834078373, -437.85950114846634, -24.502467127331524, -19.887789864139847, -491.100534574693, -61.26609134848412, -406.4882302913863, -394.9417294110587, -45.47843225918976, -439.97882592485024, -135.30149984165865, -304.3518264709525, -236.92396608419193, -184.3427785044825, -299.43588271207824, -444.9965668612918, -249.0536239996583, -343.07935533126545, -204.18703201852858, -361.63897264791825, -471.4441466618013, -193.09863312925728, -365.48119815153825, -388.3772763391146, -494.7775300282605, 14.202434861233986, -426.6609215425154, -295.88858482475894, -251.6149256698858, -140.01316200554405, -482.8155463588503, -206.66870275741792, -280.6868303290835, 9.212686826835538, -597.7463095808955, -308.70167180920197, -407.22691037041, -361.0553576082071, -398.7468097589996, -6.946775854531198, -338.5294076487985, -343.7977755244292, -318.4374253154869, -85.75480965257681, -296.33025943512695, -97.38105009863884, -359.3483624776028, -247.72302601168218, -96.72509498252658, -325.67307891856245, 20.000000000000014, -447.6841435920502, -38.83905516756503, -252.26422499084805, -293.0781252815103, 20.844676868119716, -512.9987976659488, 7.981041001260602, -377.67513448903026, -592.1317125894365, -47.29219743082904, -202.0079052671434, -215.32071908364594, -316.1386712686993, -462.0459860352264, -358.5082691029713, -309.50451599001553, -331.02217217836767, -167.13694595855344, -336.5595154937032, -196.16632802953455, -341.783227673782, -337.5439399871797, -443.6855350311103, -367.15405881677293, -237.5726313294248, -310.47219361933645, -268.5686210570412, -172.63064724317283, -430.89742422404396, -322.87631696467946, 3.315264411933297, -330.91128456179945, -12.502509739343624, -693.1774658947484, -316.42058967949527, -411.03855024981186, -519.6791296276649, 73.47450663954484, -268.0808100645914, -236.18552480149057, 40.70000000000023, -473.72996248409515, -297.1391283643419, -276.70913117283845, -539.829268424872, 14.020147440579214, -407.86354788299053, -401.44142089389237, -9.258533379496395, -367.3519503136573, -314.0339897424642, -312.6979816647792, -65.14554345300449, -487.80906779896634, -55.169407456952506, -546.3552281153391, -583.6063316597839, -384.871132701051, -442.9938177211159, -436.38676276817756, -437.78564602102097, -165.15369781191973, -553.1219139849568, -176.4855189154847, -541.069353097876, -156.15263656278987, -444.5669413443322, -103.04179541756619, -297.0988660766046, 124.21721008195733, -257.7133501777531, -471.2784609363619, -362.1549268611568, -8.128841301328377, 9.09652611855661, -446.6950536631984, -205.1388965653706, -312.62330205276277, -173.96503928529285, -541.136373864999, -162.30217532380038, -303.57319365221645, -253.44506796324407, -230.42220131866722, 54.58461503848821, -301.72460006449126, -368.1062692866428, -527.2862396948447, -437.74518196102173, -176.48592183178155, 47.54175179521912, -375.3873242148614, -325.7862369793208, -544.6262840417546, -65.20571997004686, -214.74610974678095, -73.94685740295546, -397.87297192983397, -377.6087544593685, -513.0900095676608, -351.24956800768257, -389.3025321852912, -303.3485916831951, -380.8099975800746, -198.5438146273921, -379.57983862275944, -45.87790086560609, -335.4662360154812, -506.60194254446543, 18.90178491473339, -312.7798789140366, -294.61844411623355, -292.8257413587459, -68.80503844046805, -87.01512141498706, 24.50000000000008, -151.19721784616416, -281.24228615493433, -399.37745573876975, -438.05025955556073, -487.90133810177394, -335.4237957044826, -331.5383084405292, -65.62208103124111, -433.18837910620454, 64.63353520140981, -31.408844417988128, -323.4813955691292, -495.4890562508481, -53.656813391258446, -353.82402531247294, -395.61774299627706, -330.9274606968411, -465.0653461014831, -473.05188882426467, -22.08165745172086, -457.46809806418133, 118.08732206831687, 60.98333333333355, -582.5079658565344, -131.1051234885595, -546.2531439419284, -248.00270935449217, -366.05434284918823, -269.5459786471242, -615.9558927618864, -47.2993009070148, -381.5577658031045], "policy_predator_policy_reward": [0.0, 40.34846183407843, 366.30815786247604, 195.0811950362171, 41.206924057454096, 491.100534574693, 425.4365656844763, 171.2643860665742, 413.3151670375152, 15.995940924444852, 441.75537232559066, 140.4349887227828, 308.2188730651269, 358.31862682386685, 442.81057838314, 203.97090284211404, 448.78776262709835, 241.4543093742111, 229.98703201852854, 344.4793553312654, 361.63897264791825, 471.4441466618013, 220.4075415911944, 365.48119815153825, 387.2750605446178, 495.33456286161817, 273.12386231764407, 367.3058138827353, 292.75807175833523, 256.46826479166106, 396.89627084028467, 454.97357522916406, 419.3452316507104, 277.5087771182529, 444.5860522223853, 393.2648647041734, 303.70262880568606, 407.81704751803386, 386.6898654885285, 398.2703948346438, 189.2325696460508, 327.43491279248053, 346.51386066643107, 321.737425315487, 265.19058105444424, 294.2171384875807, 71.44771905489227, 363.00413381845084, 45.05839747674182, 285.2444379309141, 68.61069796520182, 331.7490271109033, 391.3264701668725, 337.1731612762133, 268.1328046303977, 233.54395262831014, 66.18346766350554, 508.54934849872336, 368.4935295690659, 68.82417528483774, 563.701602107994, 399.2196959266098, 431.3954949343861, 208.02978378414255, 317.03867126869943, 462.0459860352264, 359.1082691029713, 309.80451599001555, 251.13512776787678, 394.40181401173123, 317.7306390876499, 425.1710737260181, 362.0622205479826, 315.89379920510595, 443.7855350311103, 367.354058816773, 327.38967422549825, 188.64935408330356, 302.58544439932, 178.21151296812317, 391.15381463517446, 405.2548594451096, 31.983440465658916, 330.91128456179945, 329.331711699707, 531.9754762699966, 316.42058967949527, 411.0257194292487, 508.76996458045863, 114.69104191015535, 247.2418261338274, 373.35031447261053, 342.6533198920817, 443.0320126192098, 298.0186620492547, 281.0603266405651, 539.829268424872, 44.63180834924859, 407.86354788299053, 401.57657191556643, 203.72751379570113, 357.0010594611105, 314.63398974246417, 312.9979816647792, 455.2017583717256, 326.4861142840435, 401.7192157330156, 474.45376079900586, 583.6063316597839, 403.5382335505243, 527.8929218248634, 352.15947101215585, 379.3951718520265, 282.01028707773094, 372.44359708039406, 526.9780274462655, 515.8993468230749, 488.0279943745084, 103.32829510341654, 445.27856702439004, 144.91577913378555, 245.96768990986806, 261.01335017775295, 471.87846093636205, 363.5907902898865, 80.75286959766282, 233.64067408131476, 335.4107638897531, 370.65282619159535, 387.58186467691706, 178.61455743989248, 541.0803492283343, 400.6938018402363, 175.6966395892706, 359.16581563162356, 161.1296373015577, 287.4309774221952, 254.15452809521852, 565.2181170316098, 353.12624787813786, 437.84518196102175, 184.2859218317812, 172.81202722364935, 356.758484890008, 381.6714331551483, 544.6262840417546, 232.8009169175887, 166.1695855736765, 362.9482214308089, 398.4714958543999, 387.02180182326174, 521.3900095676609, 314.3402439763467, 428.2960529973136, 260.09557277425114, 424.73135245819606, 378.03504070993984, 288.58382600875774, 344.59906811292274, 253.9547168672483, 506.57961015782894, 12.222188523914165, 313.77987891403654, 295.0184441162335, 243.67238159928857, 288.41222760464694, 85.0172531279336, 26.845565862566133, 339.7150865286343, 184.39803608627676, 400.75801155525863, 435.7560154578484, 487.0823639911945, 347.5080008872279, 344.4273863320942, 44.54642444890489, 288.6696823367328, 385.0371599708686, 303.97594709824, 284.5286980049804, 339.61357841483147, 221.78950290090395, 477.0927590339345, 395.54014592836893, 337.3955207509115, 465.36534610148306, 427.33658551029936, 232.6465125649226, 261.146417827809, 423.59107405842474, 485.3329063707892, 354.52119365787746, 347.7872672400744, 416.4522003380374, 370.9121077359993, 364.310616738405, 268.73139936764716, 615.9558927618864, 168.14042280466123, 379.36631465887166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.015599191726242, "mean_inference_ms": 5.13143591614732, "mean_action_processing_ms": 30.923052764993855, "mean_env_wait_ms": 1.6173322752758095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004650592803955078, "StateBufferConnector_ms": 0.038918137550354004, "ViewRequirementAgentConnector_ms": 0.13694870471954346}, "num_episodes": 72, "episode_return_max": 352.6553700271976, "episode_return_min": -43.66559301365005, "episode_return_mean": 97.51778273127462, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 262.4346114776146, "num_env_steps_trained_throughput_per_sec": 262.4346114776146, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 32104.565, "restore_workers_time_ms": 0.033, "training_step_time_ms": 32104.128, "sample_time_ms": 1758.978, "learn_time_ms": 30307.269, "learn_throughput": 263.963, "synch_weights_time_ms": 28.601}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 31, "trial_id": "cdf01_00000", "date": "2024-08-20_10-41-04", "timestamp": 1724130664, "time_this_iter_s": 30.532532930374146, "time_total_s": 1181.7410259246826, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52c4af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1181.7410259246826, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 39.17906976744186, "ram_util_percent": 82.63023255813954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.871620400273611, "cur_kl_coeff": 7.629394531249999e-07, "cur_lr": 0.0001, "total_loss": 9.076793941618904, "policy_loss": -0.003122735597814123, "vf_loss": 9.079916686103457, "vf_explained_var": -0.14984135656129746, "kl": 0.00231576603159449, "entropy": 0.24443731672234006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 19215.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.308015198272372, "cur_kl_coeff": 0.0007812499999999999, "cur_lr": 0.0001, "total_loss": 8.846197249397399, "policy_loss": -0.00415221547471389, "vf_loss": 8.850346976991684, "vf_explained_var": 0.3044467658277542, "kl": 0.003234095430863298, "entropy": 0.43415035137108393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 19215.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 352.6553700271976, "episode_reward_min": -43.66559301365005, "episode_reward_mean": 97.51778273127462, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -693.1774658947484, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 124.21721008195733, "predator_policy": 615.9558927618864}, "policy_reward_mean": {"prey_policy": -277.89428727385365, "predator_policy": 326.65317863949093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [51.000000000000426, 99.02738462289517, 21.319134193314028, 128.94663011117856, -11.109053708288684, 6.9100352818650865, 125.26170733385024, 163.00282000869205, -3.8081188596404845, 27.20000000000005, -3.3306690738754696e-15, 27.308908461937158, -0.5451829611390808, 227.97118951909758, 1.7228260553523274, 229.04113770505603, 209.49847568246003, 249.3172941724989, -4.4089058558923675, 25.158092955966477, 171.19129893520082, 6.01608514200128, 177.3226504543212, -22.277559702898596, -14.145285586552166, 94.68664615753974, 241.976432683471, -43.66559301365005, 82.57869536439956, 67.62361136613373, 323.49738801433824, 222.0966543677402, 0.899999999999999, 0.9000000000000001, 147.37782364268625, 210.17586929042963, -1.3711479078736217, 0.2999999999999978, -32.00579663995902, 39.59768906722891, 42.63493289155889, 35.298704877592286, 155.62721233561103, -0.01283082056319107, 177.25638350249338, 116.32580574035659, 352.6553700271976, 5.230729152639384, 58.65195578982789, 0.13515102167409898, 184.1180895636575, 0.899999999999999, 228.73326140379882, 274.6483409597302, 18.667100849473307, 0.6718123477257487, 58.46611509681654, 169.81419162621992, 306.70535153691804, 0.9981253659088778, 218.00181304900622, 3.9000000000000004, 74.05989172506418, 131.45291042642472, 240.4724922503767, 4.5934935179354355, 110.51507245349106, 36.4281836512688, 294.44552049141095, 22.951855928258674, 7.899999999999997, 201.72493969401498, 55.88519617582631, 119.01867277443677, 289.59988795242043, 17.713047363893242, 2.0841967806862236, 0.668335969176955, 88.49521346854652, 217.20964809908276, 31.101641052011196, 1.4000000000000026, 170.45382940472217, 49.347697575513905, 91.6736186138116, -0.9136882812236, 11.265231072165413, -8.186578690770826, 305.1519984028048, 233.6144051161021, 12.2572116736282, 123.19113665355097, 6.7680600540706095, 164.84955179923574, 345.35671589036923, 318.32946750546677, 86.88120014762484, 121.16567227072308, -0.8145792794773627, 118.64967075341349], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.000000000000014, -9.348461834078373, -437.85950114846634, -24.502467127331524, -19.887789864139847, -491.100534574693, -61.26609134848412, -406.4882302913863, -394.9417294110587, -45.47843225918976, -439.97882592485024, -135.30149984165865, -304.3518264709525, -236.92396608419193, -184.3427785044825, -299.43588271207824, -444.9965668612918, -249.0536239996583, -343.07935533126545, -204.18703201852858, -361.63897264791825, -471.4441466618013, -193.09863312925728, -365.48119815153825, -388.3772763391146, -494.7775300282605, 14.202434861233986, -426.6609215425154, -295.88858482475894, -251.6149256698858, -140.01316200554405, -482.8155463588503, -206.66870275741792, -280.6868303290835, 9.212686826835538, -597.7463095808955, -308.70167180920197, -407.22691037041, -361.0553576082071, -398.7468097589996, -6.946775854531198, -338.5294076487985, -343.7977755244292, -318.4374253154869, -85.75480965257681, -296.33025943512695, -97.38105009863884, -359.3483624776028, -247.72302601168218, -96.72509498252658, -325.67307891856245, 20.000000000000014, -447.6841435920502, -38.83905516756503, -252.26422499084805, -293.0781252815103, 20.844676868119716, -512.9987976659488, 7.981041001260602, -377.67513448903026, -592.1317125894365, -47.29219743082904, -202.0079052671434, -215.32071908364594, -316.1386712686993, -462.0459860352264, -358.5082691029713, -309.50451599001553, -331.02217217836767, -167.13694595855344, -336.5595154937032, -196.16632802953455, -341.783227673782, -337.5439399871797, -443.6855350311103, -367.15405881677293, -237.5726313294248, -310.47219361933645, -268.5686210570412, -172.63064724317283, -430.89742422404396, -322.87631696467946, 3.315264411933297, -330.91128456179945, -12.502509739343624, -693.1774658947484, -316.42058967949527, -411.03855024981186, -519.6791296276649, 73.47450663954484, -268.0808100645914, -236.18552480149057, 40.70000000000023, -473.72996248409515, -297.1391283643419, -276.70913117283845, -539.829268424872, 14.020147440579214, -407.86354788299053, -401.44142089389237, -9.258533379496395, -367.3519503136573, -314.0339897424642, -312.6979816647792, -65.14554345300449, -487.80906779896634, -55.169407456952506, -546.3552281153391, -583.6063316597839, -384.871132701051, -442.9938177211159, -436.38676276817756, -437.78564602102097, -165.15369781191973, -553.1219139849568, -176.4855189154847, -541.069353097876, -156.15263656278987, -444.5669413443322, -103.04179541756619, -297.0988660766046, 124.21721008195733, -257.7133501777531, -471.2784609363619, -362.1549268611568, -8.128841301328377, 9.09652611855661, -446.6950536631984, -205.1388965653706, -312.62330205276277, -173.96503928529285, -541.136373864999, -162.30217532380038, -303.57319365221645, -253.44506796324407, -230.42220131866722, 54.58461503848821, -301.72460006449126, -368.1062692866428, -527.2862396948447, -437.74518196102173, -176.48592183178155, 47.54175179521912, -375.3873242148614, -325.7862369793208, -544.6262840417546, -65.20571997004686, -214.74610974678095, -73.94685740295546, -397.87297192983397, -377.6087544593685, -513.0900095676608, -351.24956800768257, -389.3025321852912, -303.3485916831951, -380.8099975800746, -198.5438146273921, -379.57983862275944, -45.87790086560609, -335.4662360154812, -506.60194254446543, 18.90178491473339, -312.7798789140366, -294.61844411623355, -292.8257413587459, -68.80503844046805, -87.01512141498706, 24.50000000000008, -151.19721784616416, -281.24228615493433, -399.37745573876975, -438.05025955556073, -487.90133810177394, -335.4237957044826, -331.5383084405292, -65.62208103124111, -433.18837910620454, 64.63353520140981, -31.408844417988128, -323.4813955691292, -495.4890562508481, -53.656813391258446, -353.82402531247294, -395.61774299627706, -330.9274606968411, -465.0653461014831, -473.05188882426467, -22.08165745172086, -457.46809806418133, 118.08732206831687, 60.98333333333355, -582.5079658565344, -131.1051234885595, -546.2531439419284, -248.00270935449217, -366.05434284918823, -269.5459786471242, -615.9558927618864, -47.2993009070148, -381.5577658031045], "policy_predator_policy_reward": [0.0, 40.34846183407843, 366.30815786247604, 195.0811950362171, 41.206924057454096, 491.100534574693, 425.4365656844763, 171.2643860665742, 413.3151670375152, 15.995940924444852, 441.75537232559066, 140.4349887227828, 308.2188730651269, 358.31862682386685, 442.81057838314, 203.97090284211404, 448.78776262709835, 241.4543093742111, 229.98703201852854, 344.4793553312654, 361.63897264791825, 471.4441466618013, 220.4075415911944, 365.48119815153825, 387.2750605446178, 495.33456286161817, 273.12386231764407, 367.3058138827353, 292.75807175833523, 256.46826479166106, 396.89627084028467, 454.97357522916406, 419.3452316507104, 277.5087771182529, 444.5860522223853, 393.2648647041734, 303.70262880568606, 407.81704751803386, 386.6898654885285, 398.2703948346438, 189.2325696460508, 327.43491279248053, 346.51386066643107, 321.737425315487, 265.19058105444424, 294.2171384875807, 71.44771905489227, 363.00413381845084, 45.05839747674182, 285.2444379309141, 68.61069796520182, 331.7490271109033, 391.3264701668725, 337.1731612762133, 268.1328046303977, 233.54395262831014, 66.18346766350554, 508.54934849872336, 368.4935295690659, 68.82417528483774, 563.701602107994, 399.2196959266098, 431.3954949343861, 208.02978378414255, 317.03867126869943, 462.0459860352264, 359.1082691029713, 309.80451599001555, 251.13512776787678, 394.40181401173123, 317.7306390876499, 425.1710737260181, 362.0622205479826, 315.89379920510595, 443.7855350311103, 367.354058816773, 327.38967422549825, 188.64935408330356, 302.58544439932, 178.21151296812317, 391.15381463517446, 405.2548594451096, 31.983440465658916, 330.91128456179945, 329.331711699707, 531.9754762699966, 316.42058967949527, 411.0257194292487, 508.76996458045863, 114.69104191015535, 247.2418261338274, 373.35031447261053, 342.6533198920817, 443.0320126192098, 298.0186620492547, 281.0603266405651, 539.829268424872, 44.63180834924859, 407.86354788299053, 401.57657191556643, 203.72751379570113, 357.0010594611105, 314.63398974246417, 312.9979816647792, 455.2017583717256, 326.4861142840435, 401.7192157330156, 474.45376079900586, 583.6063316597839, 403.5382335505243, 527.8929218248634, 352.15947101215585, 379.3951718520265, 282.01028707773094, 372.44359708039406, 526.9780274462655, 515.8993468230749, 488.0279943745084, 103.32829510341654, 445.27856702439004, 144.91577913378555, 245.96768990986806, 261.01335017775295, 471.87846093636205, 363.5907902898865, 80.75286959766282, 233.64067408131476, 335.4107638897531, 370.65282619159535, 387.58186467691706, 178.61455743989248, 541.0803492283343, 400.6938018402363, 175.6966395892706, 359.16581563162356, 161.1296373015577, 287.4309774221952, 254.15452809521852, 565.2181170316098, 353.12624787813786, 437.84518196102175, 184.2859218317812, 172.81202722364935, 356.758484890008, 381.6714331551483, 544.6262840417546, 232.8009169175887, 166.1695855736765, 362.9482214308089, 398.4714958543999, 387.02180182326174, 521.3900095676609, 314.3402439763467, 428.2960529973136, 260.09557277425114, 424.73135245819606, 378.03504070993984, 288.58382600875774, 344.59906811292274, 253.9547168672483, 506.57961015782894, 12.222188523914165, 313.77987891403654, 295.0184441162335, 243.67238159928857, 288.41222760464694, 85.0172531279336, 26.845565862566133, 339.7150865286343, 184.39803608627676, 400.75801155525863, 435.7560154578484, 487.0823639911945, 347.5080008872279, 344.4273863320942, 44.54642444890489, 288.6696823367328, 385.0371599708686, 303.97594709824, 284.5286980049804, 339.61357841483147, 221.78950290090395, 477.0927590339345, 395.54014592836893, 337.3955207509115, 465.36534610148306, 427.33658551029936, 232.6465125649226, 261.146417827809, 423.59107405842474, 485.3329063707892, 354.52119365787746, 347.7872672400744, 416.4522003380374, 370.9121077359993, 364.310616738405, 268.73139936764716, 615.9558927618864, 168.14042280466123, 379.36631465887166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.015599191726242, "mean_inference_ms": 5.13143591614732, "mean_action_processing_ms": 30.923052764993855, "mean_env_wait_ms": 1.6173322752758095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004650592803955078, "StateBufferConnector_ms": 0.038918137550354004, "ViewRequirementAgentConnector_ms": 0.13694870471954346}, "num_episodes": 0, "episode_return_max": 352.6553700271976, "episode_return_min": -43.66559301365005, "episode_return_mean": 97.51778273127462, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 262.03303924354594, "num_env_steps_trained_throughput_per_sec": 262.03303924354594, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 31796.744, "restore_workers_time_ms": 0.03, "training_step_time_ms": 31796.152, "sample_time_ms": 1716.978, "learn_time_ms": 30043.511, "learn_throughput": 266.28, "synch_weights_time_ms": 27.203}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 32, "trial_id": "cdf01_00000", "date": "2024-08-20_10-41-35", "timestamp": 1724130695, "time_this_iter_s": 30.552661895751953, "time_total_s": 1212.2936878204346, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52ab430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1212.2936878204346, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 39.176744186046506, "ram_util_percent": 82.37674418604652}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.647031897590274, "cur_kl_coeff": 3.8146972656249997e-07, "cur_lr": 0.0001, "total_loss": 8.767664885142493, "policy_loss": -0.0031976175756888493, "vf_loss": 8.770862438565208, "vf_explained_var": -0.27815421034419346, "kl": 0.002584955104609637, "entropy": 0.26045877380030497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.750809201550862, "cur_kl_coeff": 0.00039062499999999997, "cur_lr": 0.0001, "total_loss": 8.365494170264592, "policy_loss": -0.0039282730773150445, "vf_loss": 8.369420632105024, "vf_explained_var": 0.3749240367185502, "kl": 0.004796647884390878, "entropy": 0.42377457500450194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 462.2448101249249, "episode_reward_min": -57.24099805027729, "episode_reward_mean": 99.30493954404872, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -699.2287230902873, "predator_policy": 4.207224691031762}, "policy_reward_max": {"prey_policy": 172.42275817164602, "predator_policy": 698.9724732033063}, "policy_reward_mean": {"prey_policy": -285.8298502646948, "predator_policy": 335.48232003671916}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.88519617582631, 119.01867277443677, 289.59988795242043, 17.713047363893242, 2.0841967806862236, 0.668335969176955, 88.49521346854652, 217.20964809908276, 31.101641052011196, 1.4000000000000026, 170.45382940472217, 49.347697575513905, 91.6736186138116, -0.9136882812236, 11.265231072165413, -8.186578690770826, 305.1519984028048, 233.6144051161021, 12.2572116736282, 123.19113665355097, 6.7680600540706095, 164.84955179923574, 345.35671589036923, 318.32946750546677, 86.88120014762484, 121.16567227072308, -0.8145792794773627, 118.64967075341349, 71.68777960189757, -2.169796141418713, 114.64561107709937, 9.074780963839363, 230.51738940938233, 79.2767099529266, 7.014787782717321, 4.4, 0.3999999999999998, 193.85266910869862, 34.8302205048321, 14.029698080016177, 2.6645352591003757e-15, 128.92053871034068, 59.4764484101329, 148.96719157443727, 213.08193643838638, 56.840629537083544, 49.53915750570193, 25.425441449115954, 7.699999999999999, 118.57249759263418, 136.7003338169643, 462.2448101249249, 170.642032243848, 187.22293560822223, 42.67282453741313, 0.8999999999999992, 69.2005641640088, 72.293775253232, 0.025348606142793217, -14.503367497606199, 176.32184172985217, 1.900000000000001, 0.09999999999999942, -2.11671159581201, 189.89938336189462, 189.9339413472516, 13.655661567237987, 357.7687782821892, 23.150629456653483, 1.7295011833601484, 148.13219097731874, 1.7891523583465847, 185.61488463737695, -0.9347225736365747, 153.50872775830325, 331.51373981935274, 206.01165196697838, 181.6379738025319, 2.220446049250313e-16, 182.93351167647992, -18.87933847026249, -8.881784197001252e-16, 26.102641941554214, 70.69755596200098, 170.4112515594688, 23.652363894916245, 203.04002334049494, 4.884981308350689e-15, 196.46483236496752, 1.9172517974635843, 72.93448506973938, -57.24099805027729, 292.00346398635287, 1.9466764314673068, 125.28527483041445, 3.7965510188747302, 257.24476385984474, 129.43028013476837, 156.93650491138655, 266.50082533323524], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-325.7862369793208, -544.6262840417546, -65.20571997004686, -214.74610974678095, -73.94685740295546, -397.87297192983397, -377.6087544593685, -513.0900095676608, -351.24956800768257, -389.3025321852912, -303.3485916831951, -380.8099975800746, -198.5438146273921, -379.57983862275944, -45.87790086560609, -335.4662360154812, -506.60194254446543, 18.90178491473339, -312.7798789140366, -294.61844411623355, -292.8257413587459, -68.80503844046805, -87.01512141498706, 24.50000000000008, -151.19721784616416, -281.24228615493433, -399.37745573876975, -438.05025955556073, -487.90133810177394, -335.4237957044826, -331.5383084405292, -65.62208103124111, -433.18837910620454, 64.63353520140981, -31.408844417988128, -323.4813955691292, -495.4890562508481, -53.656813391258446, -353.82402531247294, -395.61774299627706, -330.9274606968411, -465.0653461014831, -473.05188882426467, -22.08165745172086, -457.46809806418133, 118.08732206831687, 60.98333333333355, -582.5079658565344, -131.1051234885595, -546.2531439419284, -248.00270935449217, -366.05434284918823, -269.5459786471242, -615.9558927618864, -47.2993009070148, -381.5577658031045, -334.890762375836, -214.2950217773086, -393.3540588096082, -446.0274640018783, -210.27397688048103, -302.7842335748027, -278.0590986032166, -247.51171548586098, -9.537785818793742, -479.35093523046316, -294.7089277532288, -114.46004801544358, -443.29730238076485, -501.43986098961483, -340.7457475795338, -390.13254492747063, -356.64270794153356, -306.1663542871423, -315.50106965988266, -11.251742266974343, -398.9772259138622, -226.85806681293457, -158.90785704493632, -322.30480327818907, -348.0892638410382, -283.17799325933635, -312.19919874245517, -181.61620887864478, -325.59402968057907, -373.24518718164205, 49.016944856635945, -368.3263159086565, -37.50464034681688, -499.1883206866912, -5.776525726181765, -354.9411800183103, 3.7522635990595288, -261.207059782742, -366.60541871061645, -219.9153244710696, -480.620652844732, -240.3089887520941, -243.46284779700565, -307.89530195998765, -310.70505661964415, -164.3527474929421, 115.90456935846633, -474.1494203281656, -362.2899846435691, -151.55881078461783, -404.0915216826487, 70.4849818113245, -212.8899876746571, -307.47637476374564, -455.38318596463944, -261.0289386936349, -324.51852715997666, -272.33086712007486, -389.92002224108626, -317.5467975913972, -420.7024183759153, -269.40439927079353, -472.47497029014846, -293.44013389387965, -295.4078059180219, -227.54136631095616, -434.3832805928145, -413.91992157497896, -377.1453781571634, -332.8707664350733, -313.75029169661525, -496.69020519327734, -116.56620589760992, -348.01561463375657, 164.2478433167057, -443.0676055897784, -363.8451127780064, -266.5457440499054, -408.40306874362216, -22.793626714994442, -368.7266952306573, -83.79893804720535, -400.9589574985927, -396.50205186382755, -92.39383839582081, -341.83304164859175, -347.70816250937287, -332.30742901444717, -131.0117711902535, -392.7427657887862, -459.0283696034112, -285.1754352282443, -245.27571064630325, -85.6115980529321, 8.97507552846262, -430.30018858976274, -192.24655720150804, -378.4979726166477, -320.3478605723176, -53.63034574152897, -418.9097329368471, -447.7514345291693, -372.1612391929761, -136.42257423753725, -379.2879252089556, -414.65693832214174, -363.43739427113394, -414.1257383263795, -386.1108958022647, -458.9790249997741, -444.09401908888213, -105.52171238568414, -377.65693771116537, -175.89855393343632, -474.41727697211354, -23.533883117596844, -437.14392172213775, -3.432659601133074, -583.1467535266792, -446.8255274700541, -184.03185502880456, -407.0293421722639, -437.0711012893776, -384.6526802917423, -182.088601262846, -193.72480630972663, -365.8325309506445, -90.40145937483152, -40.37788847984116, -452.11163281562466, -356.25055342256974, -330.0656703932766, -197.20209858208167, -357.1838447614035, -285.3633085429753, -422.2012355328626, -699.2287230902873, 172.42275817164602, 125.22305544373657, -424.5048943911065, -57.37500828793755, -605.5286887072558, -106.51767159597924, -376.7808987465043], "policy_predator_policy_reward": [381.6714331551483, 544.6262840417546, 232.8009169175887, 166.1695855736765, 362.9482214308089, 398.4714958543999, 387.02180182326174, 521.3900095676609, 314.3402439763467, 428.2960529973136, 260.09557277425114, 424.73135245819606, 378.03504070993984, 288.58382600875774, 344.59906811292274, 253.9547168672483, 506.57961015782894, 12.222188523914165, 313.77987891403654, 295.0184441162335, 243.67238159928857, 288.41222760464694, 85.0172531279336, 26.845565862566133, 339.7150865286343, 184.39803608627676, 400.75801155525863, 435.7560154578484, 487.0823639911945, 347.5080008872279, 344.4273863320942, 44.54642444890489, 288.6696823367328, 385.0371599708686, 303.97594709824, 284.5286980049804, 339.61357841483147, 221.78950290090395, 477.0927590339345, 395.54014592836893, 337.3955207509115, 465.36534610148306, 427.33658551029936, 232.6465125649226, 261.146417827809, 423.59107405842474, 485.3329063707892, 354.52119365787746, 347.7872672400744, 416.4522003380374, 370.9121077359993, 364.310616738405, 268.73139936764716, 615.9558927618864, 168.14042280466123, 379.36631465887166, 316.9644853513046, 303.9090784037376, 323.2285679635439, 513.9831587065239, 242.03908016637334, 385.6647413660089, 284.3338795670561, 250.31171548586084, 256.30826671494236, 463.0978437436978, 324.87110229775124, 163.57458342384777, 443.29730238076485, 508.4546487723322, 340.7457475795338, 394.5325449274707, 356.64270794153356, 306.5663542871424, 308.133381734297, 212.47209930125877, 391.6669831916603, 268.998530039968, 159.54020674813478, 335.7021516550071, 348.0892638410382, 283.17799325933635, 257.71687582134706, 365.0190705100934, 395.11123515641987, 363.2044301159344, 116.29935594946734, 351.9772066769905, 365.04001037625295, 384.7348870956405, 309.4703318020011, 108.08800347957452, 47.37969775052901, 259.6142559388551, 366.60541871061645, 245.340765920185, 480.620652844732, 248.00898875209407, 388.6378106596053, 281.29283669002155, 321.5200754784072, 290.23806245114196, 387.1437592080339, 433.3459018865899, 328.6601440795858, 355.8306835924496, 350.7422917872968, 170.08718369224866, 268.1538258052164, 294.88536117059954, 455.38318596463944, 261.9289386936349, 364.54423455590586, 301.50572388815476, 363.63617796750646, 416.12441711821043, 419.58758547090054, 270.5445807819511, 459.9891787619671, 291.4225579244543, 489.64514485342846, 209.62586910540224, 436.28328059281455, 413.91992157497896, 377.1453781571634, 332.9707664350733, 287.15532757845756, 521.1684577156232, 335.92955041950313, 318.55165347375885, 25.586098030545877, 443.1676055897784, 361.60654819314186, 282.4399702020079, 410.97761216709955, 377.9878615737058, 361.72551091532256, 113.95075181919303, 402.4246806361681, 396.7658299096124, 278.8926511516812, 303.4664198700502, 349.1337912785748, 332.6709526035918, 360.5057929926596, 348.8636286237578, 472.8289563903155, 270.4401258677035, 256.62065709707025, 227.77537936046838, 341.7297527564912, 411.1091001241612, 393.0096326954397, 383.74654908969325, 315.1699444185426, 240.4462356978359, 418.9097329368471, 447.7514345291693, 360.2711839606439, 331.2461411463495, 471.1283188055463, 303.93720625528834, 363.43739427113394, 414.1257383263795, 393.3666475372948, 477.8259152062984, 267.5017814851165, 352.8115059514512, 349.32248978713613, 374.64425341693516, 474.81727697211363, 46.786247012513314, 333.82822089511285, 309.78838376865355, 583.1467535266792, 446.8255274700541, 385.5100306044988, 402.01599896153704, 387.85471426206004, 435.7863191165235, 195.63901765910856, 253.108874983203, 369.50082834942634, 29.492163925772147, 412.4811652561901, 372.0118200256291, 356.317885025691, 331.94501522162267, 325.2148397665005, 354.45637840739914, 287.0633085429752, 424.2977865517373, 85.07825557517978, 698.9724732033063, 4.207224691031762, 424.5048943911065, 221.03889928654198, 598.801302620038, 420.2218829993653, 329.5775126763536]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.898123711966805, "mean_inference_ms": 5.07644699344606, "mean_action_processing_ms": 29.126081942334476, "mean_env_wait_ms": 1.5997529686108418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005331277847290039, "StateBufferConnector_ms": 0.016951799392700195, "ViewRequirementAgentConnector_ms": 0.12766873836517334}, "num_episodes": 72, "episode_return_max": 462.2448101249249, "episode_return_min": -57.24099805027729, "episode_return_mean": 99.30493954404872, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 210.40042948875362, "num_env_steps_trained_throughput_per_sec": 210.40042948875362, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 32252.646, "restore_workers_time_ms": 0.03, "training_step_time_ms": 32251.819, "sample_time_ms": 1697.957, "learn_time_ms": 30511.997, "learn_throughput": 262.192, "synch_weights_time_ms": 34.446}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 33, "trial_id": "cdf01_00000", "date": "2024-08-20_10-42-13", "timestamp": 1724130733, "time_this_iter_s": 38.323644161224365, "time_total_s": 1250.617331981659, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e8e310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1250.617331981659, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 61.28000000000001, "ram_util_percent": 82.88363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.640534469059536, "cur_kl_coeff": 1.9073486328124998e-07, "cur_lr": 0.0001, "total_loss": 9.43246600438678, "policy_loss": -0.003836060562614529, "vf_loss": 9.436302107856386, "vf_explained_var": -0.4753132927039313, "kl": 0.002785552076540152, "entropy": 0.21386753720423532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 20475.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7703905414021204, "cur_kl_coeff": 0.00019531249999999998, "cur_lr": 0.0001, "total_loss": 8.416732642007252, "policy_loss": -0.004221627960306784, "vf_loss": 8.420953431962028, "vf_explained_var": 0.37610794797776237, "kl": 0.004219260191276258, "entropy": 0.44005211459265814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 20475.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 462.2448101249249, "episode_reward_min": -57.24099805027729, "episode_reward_mean": 98.12066204121406, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -699.2287230902873, "predator_policy": 4.207224691031762}, "policy_reward_max": {"prey_policy": 172.42275817164602, "predator_policy": 698.9724732033063}, "policy_reward_mean": {"prey_policy": -289.00515194008324, "predator_policy": 338.0654829606903}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.101641052011196, 1.4000000000000026, 170.45382940472217, 49.347697575513905, 91.6736186138116, -0.9136882812236, 11.265231072165413, -8.186578690770826, 305.1519984028048, 233.6144051161021, 12.2572116736282, 123.19113665355097, 6.7680600540706095, 164.84955179923574, 345.35671589036923, 318.32946750546677, 86.88120014762484, 121.16567227072308, -0.8145792794773627, 118.64967075341349, 71.68777960189757, -2.169796141418713, 114.64561107709937, 9.074780963839363, 230.51738940938233, 79.2767099529266, 7.014787782717321, 4.4, 0.3999999999999998, 193.85266910869862, 34.8302205048321, 14.029698080016177, 2.6645352591003757e-15, 128.92053871034068, 59.4764484101329, 148.96719157443727, 213.08193643838638, 56.840629537083544, 49.53915750570193, 25.425441449115954, 7.699999999999999, 118.57249759263418, 136.7003338169643, 462.2448101249249, 170.642032243848, 187.22293560822223, 42.67282453741313, 0.8999999999999992, 69.2005641640088, 72.293775253232, 0.025348606142793217, -14.503367497606199, 176.32184172985217, 1.900000000000001, 0.09999999999999942, -2.11671159581201, 189.89938336189462, 189.9339413472516, 13.655661567237987, 357.7687782821892, 23.150629456653483, 1.7295011833601484, 148.13219097731874, 1.7891523583465847, 185.61488463737695, -0.9347225736365747, 153.50872775830325, 331.51373981935274, 206.01165196697838, 181.6379738025319, 2.220446049250313e-16, 182.93351167647992, -18.87933847026249, -8.881784197001252e-16, 26.102641941554214, 70.69755596200098, 170.4112515594688, 23.652363894916245, 203.04002334049494, 4.884981308350689e-15, 196.46483236496752, 1.9172517974635843, 72.93448506973938, -57.24099805027729, 292.00346398635287, 1.9466764314673068, 125.28527483041445, 3.7965510188747302, 257.24476385984474, 129.43028013476837, 156.93650491138655, 266.50082533323524, 0.399999999999999, 77.96205178848282, 204.30308899955605, 147.15580602415093, 9.753920116650155, 0.1872441493139534, 51.1224673016644, 181.36186992077947], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-506.60194254446543, 18.90178491473339, -312.7798789140366, -294.61844411623355, -292.8257413587459, -68.80503844046805, -87.01512141498706, 24.50000000000008, -151.19721784616416, -281.24228615493433, -399.37745573876975, -438.05025955556073, -487.90133810177394, -335.4237957044826, -331.5383084405292, -65.62208103124111, -433.18837910620454, 64.63353520140981, -31.408844417988128, -323.4813955691292, -495.4890562508481, -53.656813391258446, -353.82402531247294, -395.61774299627706, -330.9274606968411, -465.0653461014831, -473.05188882426467, -22.08165745172086, -457.46809806418133, 118.08732206831687, 60.98333333333355, -582.5079658565344, -131.1051234885595, -546.2531439419284, -248.00270935449217, -366.05434284918823, -269.5459786471242, -615.9558927618864, -47.2993009070148, -381.5577658031045, -334.890762375836, -214.2950217773086, -393.3540588096082, -446.0274640018783, -210.27397688048103, -302.7842335748027, -278.0590986032166, -247.51171548586098, -9.537785818793742, -479.35093523046316, -294.7089277532288, -114.46004801544358, -443.29730238076485, -501.43986098961483, -340.7457475795338, -390.13254492747063, -356.64270794153356, -306.1663542871423, -315.50106965988266, -11.251742266974343, -398.9772259138622, -226.85806681293457, -158.90785704493632, -322.30480327818907, -348.0892638410382, -283.17799325933635, -312.19919874245517, -181.61620887864478, -325.59402968057907, -373.24518718164205, 49.016944856635945, -368.3263159086565, -37.50464034681688, -499.1883206866912, -5.776525726181765, -354.9411800183103, 3.7522635990595288, -261.207059782742, -366.60541871061645, -219.9153244710696, -480.620652844732, -240.3089887520941, -243.46284779700565, -307.89530195998765, -310.70505661964415, -164.3527474929421, 115.90456935846633, -474.1494203281656, -362.2899846435691, -151.55881078461783, -404.0915216826487, 70.4849818113245, -212.8899876746571, -307.47637476374564, -455.38318596463944, -261.0289386936349, -324.51852715997666, -272.33086712007486, -389.92002224108626, -317.5467975913972, -420.7024183759153, -269.40439927079353, -472.47497029014846, -293.44013389387965, -295.4078059180219, -227.54136631095616, -434.3832805928145, -413.91992157497896, -377.1453781571634, -332.8707664350733, -313.75029169661525, -496.69020519327734, -116.56620589760992, -348.01561463375657, 164.2478433167057, -443.0676055897784, -363.8451127780064, -266.5457440499054, -408.40306874362216, -22.793626714994442, -368.7266952306573, -83.79893804720535, -400.9589574985927, -396.50205186382755, -92.39383839582081, -341.83304164859175, -347.70816250937287, -332.30742901444717, -131.0117711902535, -392.7427657887862, -459.0283696034112, -285.1754352282443, -245.27571064630325, -85.6115980529321, 8.97507552846262, -430.30018858976274, -192.24655720150804, -378.4979726166477, -320.3478605723176, -53.63034574152897, -418.9097329368471, -447.7514345291693, -372.1612391929761, -136.42257423753725, -379.2879252089556, -414.65693832214174, -363.43739427113394, -414.1257383263795, -386.1108958022647, -458.9790249997741, -444.09401908888213, -105.52171238568414, -377.65693771116537, -175.89855393343632, -474.41727697211354, -23.533883117596844, -437.14392172213775, -3.432659601133074, -583.1467535266792, -446.8255274700541, -184.03185502880456, -407.0293421722639, -437.0711012893776, -384.6526802917423, -182.088601262846, -193.72480630972663, -365.8325309506445, -90.40145937483152, -40.37788847984116, -452.11163281562466, -356.25055342256974, -330.0656703932766, -197.20209858208167, -357.1838447614035, -285.3633085429753, -422.2012355328626, -699.2287230902873, 172.42275817164602, 125.22305544373657, -424.5048943911065, -57.37500828793755, -605.5286887072558, -106.51767159597924, -376.7808987465043, -468.29433006406947, -390.05852559308636, -192.1268569574554, -479.73219508149003, -81.11207486169103, -567.7611974590745, -185.2818965590076, -454.01305327024386, -288.2784402122564, -260.3930251709252, -409.4463436978278, -529.5087776145, -55.07648987161453, -667.5143395285454, -147.5909233173366, -355.9332895037767], "policy_predator_policy_reward": [506.57961015782894, 12.222188523914165, 313.77987891403654, 295.0184441162335, 243.67238159928857, 288.41222760464694, 85.0172531279336, 26.845565862566133, 339.7150865286343, 184.39803608627676, 400.75801155525863, 435.7560154578484, 487.0823639911945, 347.5080008872279, 344.4273863320942, 44.54642444890489, 288.6696823367328, 385.0371599708686, 303.97594709824, 284.5286980049804, 339.61357841483147, 221.78950290090395, 477.0927590339345, 395.54014592836893, 337.3955207509115, 465.36534610148306, 427.33658551029936, 232.6465125649226, 261.146417827809, 423.59107405842474, 485.3329063707892, 354.52119365787746, 347.7872672400744, 416.4522003380374, 370.9121077359993, 364.310616738405, 268.73139936764716, 615.9558927618864, 168.14042280466123, 379.36631465887166, 316.9644853513046, 303.9090784037376, 323.2285679635439, 513.9831587065239, 242.03908016637334, 385.6647413660089, 284.3338795670561, 250.31171548586084, 256.30826671494236, 463.0978437436978, 324.87110229775124, 163.57458342384777, 443.29730238076485, 508.4546487723322, 340.7457475795338, 394.5325449274707, 356.64270794153356, 306.5663542871424, 308.133381734297, 212.47209930125877, 391.6669831916603, 268.998530039968, 159.54020674813478, 335.7021516550071, 348.0892638410382, 283.17799325933635, 257.71687582134706, 365.0190705100934, 395.11123515641987, 363.2044301159344, 116.29935594946734, 351.9772066769905, 365.04001037625295, 384.7348870956405, 309.4703318020011, 108.08800347957452, 47.37969775052901, 259.6142559388551, 366.60541871061645, 245.340765920185, 480.620652844732, 248.00898875209407, 388.6378106596053, 281.29283669002155, 321.5200754784072, 290.23806245114196, 387.1437592080339, 433.3459018865899, 328.6601440795858, 355.8306835924496, 350.7422917872968, 170.08718369224866, 268.1538258052164, 294.88536117059954, 455.38318596463944, 261.9289386936349, 364.54423455590586, 301.50572388815476, 363.63617796750646, 416.12441711821043, 419.58758547090054, 270.5445807819511, 459.9891787619671, 291.4225579244543, 489.64514485342846, 209.62586910540224, 436.28328059281455, 413.91992157497896, 377.1453781571634, 332.9707664350733, 287.15532757845756, 521.1684577156232, 335.92955041950313, 318.55165347375885, 25.586098030545877, 443.1676055897784, 361.60654819314186, 282.4399702020079, 410.97761216709955, 377.9878615737058, 361.72551091532256, 113.95075181919303, 402.4246806361681, 396.7658299096124, 278.8926511516812, 303.4664198700502, 349.1337912785748, 332.6709526035918, 360.5057929926596, 348.8636286237578, 472.8289563903155, 270.4401258677035, 256.62065709707025, 227.77537936046838, 341.7297527564912, 411.1091001241612, 393.0096326954397, 383.74654908969325, 315.1699444185426, 240.4462356978359, 418.9097329368471, 447.7514345291693, 360.2711839606439, 331.2461411463495, 471.1283188055463, 303.93720625528834, 363.43739427113394, 414.1257383263795, 393.3666475372948, 477.8259152062984, 267.5017814851165, 352.8115059514512, 349.32248978713613, 374.64425341693516, 474.81727697211363, 46.786247012513314, 333.82822089511285, 309.78838376865355, 583.1467535266792, 446.8255274700541, 385.5100306044988, 402.01599896153704, 387.85471426206004, 435.7863191165235, 195.63901765910856, 253.108874983203, 369.50082834942634, 29.492163925772147, 412.4811652561901, 372.0118200256291, 356.317885025691, 331.94501522162267, 325.2148397665005, 354.45637840739914, 287.0633085429752, 424.2977865517373, 85.07825557517978, 698.9724732033063, 4.207224691031762, 424.5048943911065, 221.03889928654198, 598.801302620038, 420.2218829993653, 329.5775126763536, 468.29433006406947, 390.4585255930864, 356.302677278814, 393.5184265486129, 337.04405966999195, 516.1323016503288, 435.0334566074521, 351.41729924595154, 295.300821033809, 263.1245644660226, 409.6335878471417, 529.5087776145, 350.58761158379343, 423.12568511803045, 364.7538372356239, 320.13224550626774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 6.9798864682664385, "mean_inference_ms": 5.141114447728991, "mean_action_processing_ms": 28.915056888909074, "mean_env_wait_ms": 1.6258149856808444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005595088005065918, "StateBufferConnector_ms": 0.0177382230758667, "ViewRequirementAgentConnector_ms": 0.12997055053710938}, "num_episodes": 8, "episode_return_max": 462.2448101249249, "episode_return_min": -57.24099805027729, "episode_return_mean": 98.12066204121406, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 153.66440464987247, "num_env_steps_trained_throughput_per_sec": 153.66440464987247, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 34388.632, "restore_workers_time_ms": 0.098, "training_step_time_ms": 34387.463, "sample_time_ms": 2670.59, "learn_time_ms": 31655.731, "learn_throughput": 252.719, "synch_weights_time_ms": 52.614}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 34, "trial_id": "cdf01_00000", "date": "2024-08-20_10-43-06", "timestamp": 1724130786, "time_this_iter_s": 52.517476081848145, "time_total_s": 1303.134808063507, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a529e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1303.134808063507, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 84.51733333333334, "ram_util_percent": 83.30533333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.672017173066972, "cur_kl_coeff": 9.536743164062499e-08, "cur_lr": 0.0001, "total_loss": 8.981151471819196, "policy_loss": -0.0033977721329955827, "vf_loss": 8.98454926808675, "vf_explained_var": -0.35060719554386444, "kl": 0.0026453142643659373, "entropy": 0.22933022569096279, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 21105.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3547331596177723, "cur_kl_coeff": 9.765624999999999e-05, "cur_lr": 0.0001, "total_loss": 8.583602367128645, "policy_loss": -0.004511683041392456, "vf_loss": 8.588113660661001, "vf_explained_var": 0.34047448389113893, "kl": 0.004527431653303442, "entropy": 0.4059970418612162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 21105.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 480.0161546567559, "episode_reward_min": -57.24099805027729, "episode_reward_mean": 117.66995185375531, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -795.4146520927236, "predator_policy": 4.207224691031762}, "policy_reward_max": {"prey_policy": 172.42275817164602, "predator_policy": 698.9724732033063}, "policy_reward_mean": {"prey_policy": -288.51803649734063, "predator_policy": 347.3530124242183}, "custom_metrics": {}, "hist_stats": {"episode_reward": [185.61488463737695, -0.9347225736365747, 153.50872775830325, 331.51373981935274, 206.01165196697838, 181.6379738025319, 2.220446049250313e-16, 182.93351167647992, -18.87933847026249, -8.881784197001252e-16, 26.102641941554214, 70.69755596200098, 170.4112515594688, 23.652363894916245, 203.04002334049494, 4.884981308350689e-15, 196.46483236496752, 1.9172517974635843, 72.93448506973938, -57.24099805027729, 292.00346398635287, 1.9466764314673068, 125.28527483041445, 3.7965510188747302, 257.24476385984474, 129.43028013476837, 156.93650491138655, 266.50082533323524, 0.399999999999999, 77.96205178848282, 204.30308899955605, 147.15580602415093, 9.753920116650155, 0.1872441493139534, 51.1224673016644, 181.36186992077947, 220.54691593886702, -3.03869367151599, 292.141814090951, -0.243270553669227, 197.21364304661674, 256.0261568813268, 192.1711392582551, 225.66278641038008, 4.301259354587363, 185.2231393589982, 205.47108186456458, 62.42580063431396, 37.82022857628225, 0.8999999999999984, 1.9999999999999976, 2.220446049250313e-16, 480.0161546567559, 200.34762274744463, 236.91757148088732, 9.014579279477356, 314.6112561867488, 155.46222198066232, 7.148649611021995, 115.53176263832907, 261.62293081601496, 61.21022341752141, 0.0520291084128619, 102.9541329457851, 176.88198044777803, 1.3322676295501878e-15, 2.0874685676164333, 92.13265262374685, 214.2793417887188, 97.5858445278625, 142.80719790395892, 445.7805227721233, 141.21447524654562, 164.89564324281096, 134.25915980024158, 378.0844147599846, 3.600000000000002, 177.64807717602903, 109.84104838336053, -3.074821131862782, 47.81108531573505, -6.796620230684168, 0.20000000000000218, 33.81124247659511, 162.87579468014025, 166.02154294248678, 24.8923026125639, 2.7, -56.26659926882549, 294.0744522948363, 152.72783709622345, 7.415812150385383, 0.2000000000000013, 394.05962643394747, 125.33335461304524, -1.9053459595351852, 15.587273739853968, 391.875388632652, 10.92949337235667, 65.1377770014277], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-131.0117711902535, -392.7427657887862, -459.0283696034112, -285.1754352282443, -245.27571064630325, -85.6115980529321, 8.97507552846262, -430.30018858976274, -192.24655720150804, -378.4979726166477, -320.3478605723176, -53.63034574152897, -418.9097329368471, -447.7514345291693, -372.1612391929761, -136.42257423753725, -379.2879252089556, -414.65693832214174, -363.43739427113394, -414.1257383263795, -386.1108958022647, -458.9790249997741, -444.09401908888213, -105.52171238568414, -377.65693771116537, -175.89855393343632, -474.41727697211354, -23.533883117596844, -437.14392172213775, -3.432659601133074, -583.1467535266792, -446.8255274700541, -184.03185502880456, -407.0293421722639, -437.0711012893776, -384.6526802917423, -182.088601262846, -193.72480630972663, -365.8325309506445, -90.40145937483152, -40.37788847984116, -452.11163281562466, -356.25055342256974, -330.0656703932766, -197.20209858208167, -357.1838447614035, -285.3633085429753, -422.2012355328626, -699.2287230902873, 172.42275817164602, 125.22305544373657, -424.5048943911065, -57.37500828793755, -605.5286887072558, -106.51767159597924, -376.7808987465043, -468.29433006406947, -390.05852559308636, -192.1268569574554, -479.73219508149003, -81.11207486169103, -567.7611974590745, -185.2818965590076, -454.01305327024386, -288.2784402122564, -260.3930251709252, -409.4463436978278, -529.5087776145, -55.07648987161453, -667.5143395285454, -147.5909233173366, -355.9332895037767, -329.15505474108556, -57.276078013596276, -348.2628175140948, -393.73484999367673, 15.073943751915037, -449.8582468851834, -353.9732534512639, -385.9886251541482, -370.12278490256534, 7.2550221040797584, -0.30010633770242945, -434.8785669993437, -15.568855646386462, -358.84609338614524, -440.1340332241731, 21.800000000000047, -386.2199996579605, -327.8902377094752, -423.91647989670815, -144.34119710149974, -604.0669533206623, -147.65999690318245, -256.44616945024245, -341.48133064852766, -625.1216417494138, -16.359656683286943, -323.48906887792407, -350.38096061592745, -272.90128897885387, -351.0039021798885, -371.33853530844186, -425.8319460084947, -498.98626412287024, 135.66313459856525, -127.33729708274221, -381.81343892659066, 39.707684058093136, -450.0584096344723, -223.63912911502382, -436.0728869021062, -397.9684964316346, -158.4156665960546, -385.4668765227905, -339.6201385667797, -305.1778967155848, -346.2560375455361, -151.38673111925746, -349.29615667110994, -335.0296161540327, 74.76922134042212, -441.50033261781545, -238.62807224874211, -305.46771071497716, -327.7070409592079, -399.9106824190118, 60.43029853674582, -20.903496775066166, -132.85276577496273, -400.2368928216656, -466.57743846082474, -343.3318847117036, -267.2781921533046, -453.882641007275, -228.00750195673925, -402.63039782878616, 10.977208791373943, -351.33835515423596, -190.6108497356809, 22.305976427319962, -354.53512104887653, 129.4190619484778, -485.72069033496024, -384.77817794832004, -133.52767515806966, 72.47990946305381, -412.588964174014, -89.26647339183138, -375.8901455306739, -10.957502334385921, -693.0744179593329, -274.6887928095003, -309.34542463089196, -410.3380321597086, -133.30722152650037, -443.83687325039625, -110.31580788421473, -306.0098415151253, -56.007721998756324, -55.178133711345616, -477.3890204117571, -337.5016977803382, -396.7434338775961, -335.47910198141636, -269.8273294504711, -367.9923792895373, -499.7285410015195, -252.04716609183072, -46.38005490154536, -23.45477276144718, -502.42009138126366, -388.5068947921694, -282.9688872836436, -257.9286934585004, -342.9939989202122, -374.22296962824845, -413.5609862699686, 16.72690302554049, -359.3305239665152, -399.3778320961072, -174.2877889154864, -376.16461069249226, -285.1997652401203, -378.27713463866934, -379.39042850723087, 139.06967584328282, -795.4146520927236, -257.351694418354, -330.2683142710746, -293.42845983880267, -341.8578187350435, -322.9350093644124, -295.752931894938, -310.78696999498106, -53.87462423229219, -428.8811292573299, -221.609928059792, -438.9353931631799, -215.3011823058898], "policy_predator_policy_reward": [360.5057929926596, 348.8636286237578, 472.8289563903155, 270.4401258677035, 256.62065709707025, 227.77537936046838, 341.7297527564912, 411.1091001241612, 393.0096326954397, 383.74654908969325, 315.1699444185426, 240.4462356978359, 418.9097329368471, 447.7514345291693, 360.2711839606439, 331.2461411463495, 471.1283188055463, 303.93720625528834, 363.43739427113394, 414.1257383263795, 393.3666475372948, 477.8259152062984, 267.5017814851165, 352.8115059514512, 349.32248978713613, 374.64425341693516, 474.81727697211363, 46.786247012513314, 333.82822089511285, 309.78838376865355, 583.1467535266792, 446.8255274700541, 385.5100306044988, 402.01599896153704, 387.85471426206004, 435.7863191165235, 195.63901765910856, 253.108874983203, 369.50082834942634, 29.492163925772147, 412.4811652561901, 372.0118200256291, 356.317885025691, 331.94501522162267, 325.2148397665005, 354.45637840739914, 287.0633085429752, 424.2977865517373, 85.07825557517978, 698.9724732033063, 4.207224691031762, 424.5048943911065, 221.03889928654198, 598.801302620038, 420.2218829993653, 329.5775126763536, 468.29433006406947, 390.4585255930864, 356.302677278814, 393.5184265486129, 337.04405966999195, 516.1323016503288, 435.0334566074521, 351.41729924595154, 295.300821033809, 263.1245644660226, 409.6335878471417, 529.5087776145, 350.58761158379343, 423.12568511803045, 364.7538372356239, 320.13224550626774, 315.30719748656685, 291.67085120698243, 344.8763028520865, 394.08267098416906, 339.0530858655457, 387.8730313586724, 355.38593009496424, 384.3326779567787, 300.38459583052844, 259.6968100145742, 296.9154846817346, 394.2893455366371, 297.1543152950036, 269.43177299578423, 439.3285378620248, 204.66828177252867, 384.1054414910913, 334.306055230932, 362.15549631451296, 391.3253200426933, 402.67320788994584, 554.5248241984631, 321.1582724297384, 339.19502830334665, 624.4790045952498, 54.82252241373337, 323.6890688779241, 351.0809606159276, 274.90128897885387, 351.0039021798885, 371.33853530844186, 425.8319460084947, 423.4691993980345, 419.87008478302465, 317.787096486393, 391.7112622703843, 219.03683532870932, 428.2314617285571, 232.253708394501, 436.4728869021062, 392.7647704904992, 478.2306487239367, 327.25149345237486, 553.2977436178605, 324.8589298836675, 333.7236539884749, 267.854812921323, 348.3598375073725, 222.77446912042652, 299.1088565092005, 413.6899250043187, 327.6487032797598, 305.37730687757164, 327.8494739050263, 399.9106824190118, 42.52383440903952, 236.50365994218333, 94.13458305562472, 400.2368928216656, 466.57743846082474, 345.31935327932, 267.37819215330455, 460.4484772436722, 313.574318344089, 390.63640222325256, 215.29612860287884, 336.74721235659393, 302.7878370611844, 120.68784959952121, 354.3484929259943, 419.120858674471, 382.961292484133, 338.1016103402045, 321.418718012731, 168.46061718503245, 336.54408076873807, 253.07772447605382, 346.3380542466928, 586.2956132538536, 495.82072179984857, 277.3887928095002, 310.245424630892, 396.234508362266, 325.05882249997177, 420.472071340865, 243.52165817710633, 73.53211376138077, 285.4106286206384, 102.28921902708083, 478.0890204117571, 337.5016977803382, 389.9468136469117, 335.47910198141636, 270.0273294504711, 487.35143559014966, 414.1807271775017, 268.27014970753777, 193.03286596597866, 215.82380862189953, 476.07259846329947, 388.5068947921694, 307.8611898962073, 260.6286934585004, 342.9939989202122, 391.4221294758843, 340.0952271535075, 285.04148170378755, 351.6365915320238, 351.71114319443836, 374.68231491337895, 382.38042284287764, 286.39976524012025, 378.27713463866934, 379.59042850723085, 486.98037576840426, 563.4242269149803, 380.3646508060922, 332.58871249638185, 294.2078213794397, 339.17311123487184, 298.02566884294436, 336.24954615625967, 425.2084798543499, 331.32850300557584, 428.5389542646565, 232.88159642482208, 379.95673373131086, 339.4176187391863]}, "sampler_perf": {"mean_raw_obs_processing_ms": 7.966711594382925, "mean_inference_ms": 6.101283028067658, "mean_action_processing_ms": 27.89865564348275, "mean_env_wait_ms": 1.87114170081989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007327556610107422, "StateBufferConnector_ms": 0.2137984037399292, "ViewRequirementAgentConnector_ms": 0.37652266025543213}, "num_episodes": 64, "episode_return_max": 480.0161546567559, "episode_return_min": -57.24099805027729, "episode_return_mean": 117.66995185375531, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 53.16616966508262, "num_env_steps_trained_throughput_per_sec": 53.16616966508262, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 46417.011, "restore_workers_time_ms": 0.1, "training_step_time_ms": 46411.188, "sample_time_ms": 4337.801, "learn_time_ms": 41668.317, "learn_throughput": 191.992, "synch_weights_time_ms": 354.753}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 35, "trial_id": "cdf01_00000", "date": "2024-08-20_10-45-43", "timestamp": 1724130943, "time_this_iter_s": 156.26006865501404, "time_total_s": 1459.3948767185211, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e3cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1459.3948767185211, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 93.66948356807511, "ram_util_percent": 85.00610328638498}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.86752200447596, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.00010000000000000003, "total_loss": 9.272837495279836, "policy_loss": -0.0033117443448505723, "vf_loss": 9.276149255102807, "vf_explained_var": -0.4741918569082742, "kl": 0.0024092019988177196, "entropy": 0.19016240350492708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 254.06593406593407, "num_grad_updates_lifetime": 21875.5, "diff_num_grad_updates_vs_sampler_policy": 454.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1168019055665193, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.00010000000000000003, "total_loss": 8.913132125728733, "policy_loss": -0.004038979275059978, "vf_loss": 8.917171117761633, "vf_explained_var": 0.311446584712018, "kl": 0.003996856983096515, "entropy": 0.37447166203797516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 254.06593406593407, "num_grad_updates_lifetime": 21875.5, "diff_num_grad_updates_vs_sampler_policy": 454.5}}, "num_env_steps_sampled": 283560, "num_env_steps_trained": 283560, "num_agent_steps_sampled": 1134240, "num_agent_steps_trained": 1134240}, "env_runners": {"episode_reward_max": 476.7359831998636, "episode_reward_min": -56.26659926882549, "episode_reward_mean": 106.72518587653194, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -795.4146520927236, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.26292382173705, "predator_policy": 664.490306576997}, "policy_reward_mean": {"prey_policy": -288.64835159405527, "predator_policy": 342.01094453232116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.21447524654562, 164.89564324281096, 134.25915980024158, 378.0844147599846, 3.600000000000002, 177.64807717602903, 109.84104838336053, -3.074821131862782, 47.81108531573505, -6.796620230684168, 0.20000000000000218, 33.81124247659511, 162.87579468014025, 166.02154294248678, 24.8923026125639, 2.7, -56.26659926882549, 294.0744522948363, 152.72783709622345, 7.415812150385383, 0.2000000000000013, 394.05962643394747, 125.33335461304524, -1.9053459595351852, 15.587273739853968, 391.875388632652, 10.92949337235667, 65.1377770014277, 221.66451707781044, 90.10877256329645, 12.005967602774394, 25.7677350637532, 351.34546558854134, 2.083258637881782, 98.24268525868357, 4.332362505046033, 44.03806119788423, 52.48814815939797, 225.212544847914, -0.05264410217966642, 53.036500315621524, 164.41361451742054, 5.976263988837991, 62.76495799643855, 238.06479644768237, 262.1554813054497, 245.23440799710298, 173.4253490835681, 244.26529453361945, 476.7359831998636, 17.46870431037057, 35.64859411044318, -0.7253745482941687, 142.23612178437946, 193.87385510069026, 189.18113951299657, 161.41214401553796, 234.7229993205658, 188.38971356024467, 100.32552711606331, 401.6297905439007, -0.3387110435609282, 461.62954357965936, 1.9491135730376143, 205.94916927513103, 13.530074837987861, 109.86986444222872, 1.7211201596238035, 213.60695449668367, 24.997578401933595, -2.220446049250313e-16, 174.5489551253356, 1.138114444366709, 1.1000000000000014, 2.49334816936146, 100.72839577065525, 146.00215579929358, 50.53078510619655, 218.54025521062425, -0.02286546628312558, 9.594987123991624, 25.4962662881559, 122.9680466217588, -0.41659656302982384, 178.05000151238121, 62.42991238533304, 0.6000000000000019, 96.94429464321213, 1.3000000000000003, 0.6000000000000014, 32.18132301472649, 195.55915130013557, 32.96329871111411, 86.73450601370253, 2.405002490458495, 177.97766861670536, -1.9036936228382, -1.5429179440798444, 185.18092515852564, 82.79740602704666], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-384.77817794832004, -133.52767515806966, 72.47990946305381, -412.588964174014, -89.26647339183138, -375.8901455306739, -10.957502334385921, -693.0744179593329, -274.6887928095003, -309.34542463089196, -410.3380321597086, -133.30722152650037, -443.83687325039625, -110.31580788421473, -306.0098415151253, -56.007721998756324, -55.178133711345616, -477.3890204117571, -337.5016977803382, -396.7434338775961, -335.47910198141636, -269.8273294504711, -367.9923792895373, -499.7285410015195, -252.04716609183072, -46.38005490154536, -23.45477276144718, -502.42009138126366, -388.5068947921694, -282.9688872836436, -257.9286934585004, -342.9939989202122, -374.22296962824845, -413.5609862699686, 16.72690302554049, -359.3305239665152, -399.3778320961072, -174.2877889154864, -376.16461069249226, -285.1997652401203, -378.27713463866934, -379.39042850723087, 139.06967584328282, -795.4146520927236, -257.351694418354, -330.2683142710746, -293.42845983880267, -341.8578187350435, -322.9350093644124, -295.752931894938, -310.78696999498106, -53.87462423229219, -428.8811292573299, -221.609928059792, -438.9353931631799, -215.3011823058898, -690.3981887310341, -64.91911771877783, -364.2128000124732, -251.56818970618397, -345.45704868771674, -359.76907453051314, -516.454275188944, -297.24975190707335, -388.2897357957257, 196.26292382173705, -336.18542714512347, -379.116184238511, -30.931224964021155, -435.52529201639913, -315.7759306014461, -361.2438512961867, -224.08332953486615, -297.3000922773149, -516.7782417120025, -8.794132976012689, -517.8261929306933, 71.01837394775029, -300.3421257880991, -464.5953833905106, -357.6223510356772, -223.4591491823915, -123.92106960872306, -456.764295224859, -385.4303978690393, -388.99264851713536, -133.04917050204796, -385.0441148177824, -385.28139349244105, -7.645451004880336, -180.88795023498088, -293.2075008537686, -493.81121360093425, -21.125796617192897, 20.000000000000014, -388.8596197712196, -664.2107321793106, 11.951374381843566, 106.41549684449544, -543.6407700796249, -472.73167041246575, -396.9871231547865, -305.0548339408376, -251.9251599417825, -463.1517038146253, -343.24671189095346, -203.9408146778386, -425.10202948467287, -331.18187518519227, -192.08461703176144, -378.4912988728569, -99.01510623231975, -136.89249484910536, -430.7459670774005, -189.63753394511323, -203.49767218103523, 173.25223332276232, -511.6283761792845, -169.9088206015274, -362.41503405520956, -344.6559609292467, 72.13207654008485, -424.8244774057103, -247.239236719031, 179.1582661425142, -434.8588391949045, -300.3937506532816, -464.0367533230239, -415.82414801056694, -125.76568088345601, -361.8898272810955, -293.6348042093484, -429.45205578475293, 16.529406375959063, -319.55680736892015, -322.7265487130363, -199.50738313759558, -508.6936413686612, -315.5553842926089, -416.08080858089875, -317.7739369834019, -351.0887235913615, -100.53102221285386, -371.80227084560136, -320.02128993067487, -315.1788697620128, -364.6431798655457, -329.27638965083133, -385.2482570052059, -466.93480396140706, -353.96353618753017, -66.6570574736275, 43.34864616330137, -361.3127794901301, -419.2679783158571, -169.50417969459718, -600.7459687392336, -128.08440126210317, -356.3340515156471, -379.1006883749783, -403.6657967202213, -240.817569305648, -327.9791680131895, -306.0734759108549, -356.2320952832193, -148.5185245505062, -346.1313448754528, -360.6859409698417, -391.5319583498852, 121.74511120711966, -440.8735328406517, -63.49579526600436, -412.60208906731043, -366.2980537336354, -197.692394538793, -115.31011779710497, -328.9469391884729, -287.600646801542, -271.8140165211463, -364.1969616963742, -328.75299268914625, -31.03951997436188, 193.75915130013567, -335.5563925958622, -346.8618572374557, -200.61055358622417, -269.7891299058215, -306.8508119593651, -329.68244174954395, -334.6874543115005, -86.22338486082518, -542.3582921785709, -466.55291282355125, -479.1385006886173, -425.5279438559159, -591.6051905022705, -391.0596941459405, -2.103042710982336, -397.6828968055361, -290.71346424017304], "policy_predator_policy_reward": [338.1016103402045, 321.418718012731, 168.46061718503245, 336.54408076873807, 253.07772447605382, 346.3380542466928, 586.2956132538536, 495.82072179984857, 277.3887928095002, 310.245424630892, 396.234508362266, 325.05882249997177, 420.472071340865, 243.52165817710633, 73.53211376138077, 285.4106286206384, 102.28921902708083, 478.0890204117571, 337.5016977803382, 389.9468136469117, 335.47910198141636, 270.0273294504711, 487.35143559014966, 414.1807271775017, 268.27014970753777, 193.03286596597866, 215.82380862189953, 476.07259846329947, 388.5068947921694, 307.8611898962073, 260.6286934585004, 342.9939989202122, 391.4221294758843, 340.0952271535075, 285.04148170378755, 351.6365915320238, 351.71114319443836, 374.68231491337895, 382.38042284287764, 286.39976524012025, 378.27713463866934, 379.59042850723085, 486.98037576840426, 563.4242269149803, 380.3646508060922, 332.58871249638185, 294.2078213794397, 339.17311123487184, 298.02566884294436, 336.24954615625967, 425.2084798543499, 331.32850300557584, 428.5389542646565, 232.88159642482208, 379.95673373131086, 339.4176187391863, 664.490306576997, 312.49151695062596, 256.6198924364143, 449.2698698455404, 343.6770520986464, 373.5550387223579, 520.2358259828534, 319.2359361769183, 340.77711927537814, 202.59515828715104, 336.18542714512347, 381.1994428763927, 165.6569910099186, 399.04221122918653, 338.92871279499377, 342.4234316076846, 269.6749652596342, 295.7465177504309, 518.4782417120025, 59.582281135410426, 482.42151447314774, 189.59884935770998, 300.28948168591944, 464.5953833905106, 301.0962019917342, 333.0217985419555, 290.72865109835715, 454.3703282526455, 385.4303978690393, 394.96891250597355, 307.37666021322366, 273.4815831030439, 309.138064454398, 321.8535764906066, 291.58364566082497, 444.66728673337497, 396.42769806502156, 363.7437201502091, 224.40280466885898, 317.8821641859284, 459.124951080882, 437.3997012502024, 409.303902536214, 504.65735389877625, 472.73167041246575, 414.45582746515737, 260.37522303831753, 332.2533649547455, 353.8068195110096, 451.86622164627494, 427.4588291597241, 343.8201367871663, 300.72093066579436, 416.4194166518499, 347.8259851652448, 318.86155945292893, 311.90513323416496, 417.1454727078795, 314.9823207659935, 312.87588468072033, 21.031252015494296, 505.7346044012724, 312.1822285696186, 320.4671532031812, 339.562413662861, 334.59126127020215, 349.6083670021543, 322.1166360790273, 284.7482429013998, 432.58187373065107, 302.18385673707024, 464.19576081227274, 430.0969306403448, 317.44206752880893, 374.640575227872, 294.41413110055976, 450.85205578475274, 71.94045806626963, 319.68513631737653, 324.31933992420375, 483.76092694793687, 438.04705205500085, 344.7456066517012, 411.88816462373995, 317.7739369834019, 351.0887235913615, 322.43704366790496, 324.44520451588556, 335.7621337956343, 300.5761403414199, 365.6431798655457, 329.3763896508313, 385.33763059009806, 469.3387785458763, 179.61407892046103, 341.7349105113505, 228.27873776449667, 235.68755136162636, 419.2679783158571, 220.0349648007935, 484.024332516576, 463.3462926953849, 356.4340515156471, 378.97782290869515, 419.77392732260597, 234.30442582725468, 325.5074507064306, 334.0414595057708, 360.71574312136596, 267.0029233341176, 346.2007797203394, 360.1999095619252, 391.5319583498852, 56.30489030526153, 385.96582267870605, 180.83341781328292, 412.60208906731043, 366.89805373363555, 23.83567311790811, 386.11113386120115, 328.9469391884729, 288.90064680154205, 272.4140165211463, 364.1969616963742, 328.75299268914625, 63.220842989088595, 0.0, 337.3563925958626, 313.6385862465166, 266.79712328827776, 356.6977082849055, 306.67673959398365, 331.78244174954386, 334.992456801959, 332.86731348659384, 473.69203216950694, 346.8008031000974, 596.986916789233, 425.43019154153416, 590.1600248725724, 219.75504862569815, 358.58861338975066, 424.553868332374, 346.6398987403827]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.314993391807288, "mean_inference_ms": 11.17946311171134, "mean_action_processing_ms": 27.440504686426685, "mean_env_wait_ms": 3.4077727296519282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4676603078842163, "StateBufferConnector_ms": 1.0701225996017456, "ViewRequirementAgentConnector_ms": 2.9170756340026855}, "num_episodes": 72, "episode_return_max": 476.7359831998636, "episode_return_min": -56.26659926882549, "episode_return_mean": 106.72518587653194, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1134240, "num_agent_steps_trained": 1134240, "num_env_steps_sampled": 283560, "num_env_steps_trained": 283560, "num_env_steps_sampled_this_iter": 11560, "num_env_steps_trained_this_iter": 11560, "num_env_steps_sampled_throughput_per_sec": 33.32316457949358, "num_env_steps_trained_throughput_per_sec": 33.32316457949358, "timesteps_total": 283560, "num_env_steps_sampled_lifetime": 283560, "num_agent_steps_sampled_lifetime": 1134240, "num_steps_trained_this_iter": 11560, "agent_timesteps_total": 1134240, "timers": {"training_iteration_time_ms": 77977.23, "restore_workers_time_ms": 1.21, "training_step_time_ms": 77968.662, "sample_time_ms": 12902.721, "learn_time_ms": 64631.843, "learn_throughput": 129.286, "synch_weights_time_ms": 368.481}, "counters": {"num_env_steps_sampled": 283560, "num_env_steps_trained": 283560, "num_agent_steps_sampled": 1134240, "num_agent_steps_trained": 1134240}, "done": false, "training_iteration": 36, "trial_id": "cdf01_00000", "date": "2024-08-20_10-51-40", "timestamp": 1724131300, "time_this_iter_s": 349.7140040397644, "time_total_s": 1809.1088807582855, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1809.1088807582855, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 86.0442265795207, "ram_util_percent": 85.42244008714599}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.917927321555123, "cur_kl_coeff": 2.3841857910156248e-08, "cur_lr": 0.0001, "total_loss": 8.874680550893148, "policy_loss": -0.002931680147802191, "vf_loss": 8.877612180558462, "vf_explained_var": -0.24486870444010175, "kl": 0.0016895771490005194, "entropy": 0.1912346602668838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 22645.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3770939439062087, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 0.0001, "total_loss": 8.563400814268324, "policy_loss": -0.005216546683749627, "vf_loss": 8.568617360554045, "vf_explained_var": 0.42882887049326823, "kl": 0.005152912452456168, "entropy": 0.402976949678527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 22645.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 291560, "num_env_steps_trained": 291560, "num_agent_steps_sampled": 1166240, "num_agent_steps_trained": 1166240}, "env_runners": {"episode_reward_max": 444.09302168260115, "episode_reward_min": -15.499687326093683, "episode_reward_mean": 97.32430583514089, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -613.2558307563605, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.75915130013567, "predator_policy": 596.986916789233}, "policy_reward_mean": {"prey_policy": -295.9797304396234, "predator_policy": 344.6418833571938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.138114444366709, 1.1000000000000014, 2.49334816936146, 100.72839577065525, 146.00215579929358, 50.53078510619655, 218.54025521062425, -0.02286546628312558, 9.594987123991624, 25.4962662881559, 122.9680466217588, -0.41659656302982384, 178.05000151238121, 62.42991238533304, 0.6000000000000019, 96.94429464321213, 1.3000000000000003, 0.6000000000000014, 32.18132301472649, 195.55915130013557, 32.96329871111411, 86.73450601370253, 2.405002490458495, 177.97766861670536, -1.9036936228382, -1.5429179440798444, 185.18092515852564, 82.79740602704666, 262.3177555294136, 224.20698692808247, 37.40495207996291, 66.18001090584835, 1.7999999999999994, 2.700000000000002, 444.09302168260115, 415.3407329492505, 228.11382227796, -1.3322676295501878e-15, 180.29145153727336, 7.099999999999991, 11.145890728381834, 0.45626444995511894, 2.4295353780220106, -12.242228758218394, 255.64329136565306, 0.399999999999999, 156.4895021703774, 3.7842518854173797, 0.5999999999999994, -5.329070518200751e-15, 108.90709720980539, 29.20684664637958, 404.57337727548895, 0.026710176076976788, 148.0065536093522, 226.20827052361858, 275.5338237047935, 115.46115249521839, 0.5332829275421553, 0.24660906552831707, 1.9000000000000017, -8.0842584289715, 254.77239143257216, -8.342683993553951, 332.40040860208734, 397.9472218252205, -0.5412029706124448, 120.12022705641425, 7.39999999999999, 325.3311152995563, 1.8000000000000003, 2.220446049250313e-15, 190.7720220344493, 10.085333173517041, 337.5641890506198, 36.66171291306819, 13.0260680032049, 37.51218790973458, 116.86717760512711, 341.6174505551831, 330.5332283619119, 298.29320137785606, 430.7484953201406, -15.499687326093683, -3.3111765009094656, -2.3276420708630945, 0.8999999999999997, 2.855899537031847, 216.1952838845235, 163.65728449802418, 1.5551308227387075, 20.941554445145847, 264.0874620080772, 0.09999999999999809, 85.32890862685268, 0.8816726432453742, 7.00777532531551, -0.1632368906784032, -4.440892098500626e-16, 14.448333828854016], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-320.02128993067487, -315.1788697620128, -364.6431798655457, -329.27638965083133, -385.2482570052059, -466.93480396140706, -353.96353618753017, -66.6570574736275, 43.34864616330137, -361.3127794901301, -419.2679783158571, -169.50417969459718, -600.7459687392336, -128.08440126210317, -356.3340515156471, -379.1006883749783, -403.6657967202213, -240.817569305648, -327.9791680131895, -306.0734759108549, -356.2320952832193, -148.5185245505062, -346.1313448754528, -360.6859409698417, -391.5319583498852, 121.74511120711966, -440.8735328406517, -63.49579526600436, -412.60208906731043, -366.2980537336354, -197.692394538793, -115.31011779710497, -328.9469391884729, -287.600646801542, -271.8140165211463, -364.1969616963742, -328.75299268914625, -31.03951997436188, 193.75915130013567, -335.5563925958622, -346.8618572374557, -200.61055358622417, -269.7891299058215, -306.8508119593651, -329.68244174954395, -334.6874543115005, -86.22338486082518, -542.3582921785709, -466.55291282355125, -479.1385006886173, -425.5279438559159, -591.6051905022705, -391.0596941459405, -2.103042710982336, -397.6828968055361, -290.71346424017304, -525.7316155600831, -48.8098341551236, -314.14189739990695, -337.9545840198716, -361.09086806153704, -191.45076797947704, -328.1203672742528, -403.615238633104, -414.06083159508563, -286.2476978821951, -339.4388466818581, -282.92636419996944, 132.29402196459205, -453.2337303798465, 116.69320276338719, -437.2098706002831, -29.402197778126173, -429.36819761298926, -364.01109488468273, -412.66553474151897, -179.64768637764777, -299.60984985487624, -239.91629322617905, -275.81014425573363, -236.02039576414927, -272.0512840447927, -374.2200003157754, -509.82018764599513, -338.1357585412361, -302.0698083660037, -399.8113040839103, -583.539291336763, -154.46975163618444, -392.30057320548656, -328.2506081909792, -416.96986818884824, -271.4092062015957, -434.1246901036331, -341.14094728526527, -402.8286005486197, -297.10070564189675, -353.7422398623837, -313.5178778523291, -489.12705849316535, -25.00157113121061, -335.65193134935015, -450.98535713684015, -273.323483690641, -67.65679756010948, -613.2558307563605, -310.6646891086715, -380.82457567864617, -16.482181385473453, -226.25329936470385, -148.80172653261766, -284.59352387766484, 145.54947973711793, -380.163211674663, -160.9420915426463, -419.4520879620805, -293.24933797164687, -340.74829949597535, -296.7353804299388, -375.40658231682585, -450.48094285074336, -302.85626250138625, -584.6586691140403, -179.99554038657766, -169.81357753775126, -163.58621381699254, -277.3417131083658, -321.1895884382994, 26.070519524504974, -373.5590842700733, -544.228456793131, 64.47900044617329, -321.48517806049523, -386.1405519011166, -114.19781137726808, -319.8034252298141, -441.4308587273242, -374.1014003457568, 26.028167403186952, -386.46769305676196, -290.04884350174797, -296.5148962052935, -357.14407813445393, -338.8571356274153, -49.99050244565028, -500.590497937651, -343.70433327846973, -200.3217920335701, -576.0083839725121, -31.579512136858426, -108.81268559574828, -345.0203588909231, -417.1621474129517, -323.90931302232053, -437.7579498100694, -263.0104293312254, -489.8573245282128, 20.661944672591574, -526.589162014844, 44.4922014995893, -46.35910887284071, -503.4214027465396, -82.70804692962227, -416.5802378807905, 116.07291303186028, -437.007826406398, -248.61470919234213, -74.10368122350134, -390.71724906843394, -458.79228919346656, -400.6334663370191, -377.1600516120709, -287.8109952597491, -326.69819654379734, -336.22154860662596, -313.5068317924408, -248.06347902207088, -232.68941633504915, -482.30817381915125, -119.85250670137037, -394.6264966997192, -394.1572553721178, -80.54144970309969, -466.0615696265014, 70.81701078835056, -455.3471970578993, -344.38747119708466, -293.9560825934445, -107.72219523454095, -340.8878370754105, -385.72487262890036, -384.20022136361246, -348.0343458109502, -254.89153810177967, -330.4232123263452, -477.4120160397472, -299.90309620095894, -388.92718916137585, -387.6947285939355, -322.7511937897435], "policy_predator_policy_reward": [335.7621337956343, 300.5761403414199, 365.6431798655457, 329.3763896508313, 385.33763059009806, 469.3387785458763, 179.61407892046103, 341.7349105113505, 228.27873776449667, 235.68755136162636, 419.2679783158571, 220.0349648007935, 484.024332516576, 463.3462926953849, 356.4340515156471, 378.97782290869515, 419.77392732260597, 234.30442582725468, 325.5074507064306, 334.0414595057708, 360.71574312136596, 267.0029233341176, 346.2007797203394, 360.1999095619252, 391.5319583498852, 56.30489030526153, 385.96582267870605, 180.83341781328292, 412.60208906731043, 366.89805373363555, 23.83567311790811, 386.11113386120115, 328.9469391884729, 288.90064680154205, 272.4140165211463, 364.1969616963742, 328.75299268914625, 63.220842989088595, 0.0, 337.3563925958626, 313.6385862465166, 266.79712328827776, 356.6977082849055, 306.67673959398365, 331.78244174954386, 334.992456801959, 332.86731348659384, 473.69203216950694, 346.8008031000974, 596.986916789233, 425.43019154153416, 590.1600248725724, 219.75504862569815, 358.58861338975066, 424.553868332374, 346.6398987403827, 461.77391278258443, 375.0852924620348, 469.06788060299414, 407.235587744868, 362.190868061537, 227.75572005943982, 299.1909660027315, 498.72465081047415, 414.06083159508563, 288.04769788219505, 339.4388466818581, 285.62636419996926, 374.3570132161602, 390.67571688169403, 330.2013613492625, 405.6560394368836, 303.63817828084956, 383.2460393882262, 364.01109488468273, 412.66553474151897, 345.1399890849441, 314.4089986848537, 244.01629322617882, 278.8101442557335, 243.52039576414924, 275.6971747731745, 374.276433321117, 510.2200190906086, 337.06912783800647, 305.5659744472554, 458.06426572583166, 513.0441009366236, 462.6815069720582, 339.73210923526585, 328.2506081909792, 417.3698681888482, 451.6026597487711, 410.4207387268376, 335.74899168941784, 412.0048080298844, 297.10070564189675, 354.34223986238385, 313.5178778523291, 489.12705849316535, 331.9493081225475, 137.61129156781945, 327.73773025991494, 425.7779572139461, 590.8026610933466, 494.6833444986116, 310.6913992847484, 380.82457567864617, 132.35352524344367, 258.3885091160859, 373.96907874722586, 285.63444218667445, 140.0480658079688, 370.09948983436954, 354.2101465949457, 341.6451854049992, 293.84933797164683, 340.6815824235175, 297.3677611790251, 375.0208106332679, 450.48094285074336, 304.75626250138623, 471.38903084299966, 285.1809202286483, 273.00224815826556, 315.1699346290503, 281.64029237292567, 308.54832518018577, 366.42297333758285, 313.46600001007226, 495.3004040050352, 382.3962741671445, 338.8707827023364, 368.2137442886627, 246.83780114629567, 307.28366251719973, 442.2308587273242, 380.7014003457583, 348.8538773085175, 336.91676364461307, 290.84884350174815, 297.51489620529355, 357.14407813445393, 338.8571356274153, 343.5586414603895, 397.7943809573617, 340.1945901964057, 213.91686828915164, 529.415654540441, 415.73643061955016, 193.09050883164645, 297.40424856809267, 417.2748197241272, 336.82270871435, 437.7579498100694, 300.5226172409616, 122.7447462163975, 463.31781124435105, 436.411739777576, 387.30267129286074, 417.43163564849357, 462.88210433279863, 491.66610977631126, 305.915376411957, 318.0755062356328, 433.6079024590452, 306.43449922378824, 0.7842038659613141, 460.2916078802579, 385.9067538807331, 397.62408883872314, 377.8417870395038, 327.29819654379736, 288.11099525974913, 313.5068317924408, 339.0774481436578, 356.87580412003695, 340.0723751216045, 427.90031965131647, 337.9176453672291, 394.6264966997192, 395.71238619485644, 101.33656463519183, 466.2080091395542, 248.4167158101532, 400.20093246747297, 344.4874711970847, 293.9560825934445, 209.1961233959669, 324.74281754083535, 386.8472309084588, 383.95953572729957, 347.60314259150095, 262.33051664654414, 330.2599754356668, 477.4120160397472, 299.90309620095894, 388.92718916137585, 401.94306242278935, 322.9511937897435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.06597970649063, "mean_inference_ms": 13.282847034791287, "mean_action_processing_ms": 26.969074867677445, "mean_env_wait_ms": 4.127955102867709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09025406837463379, "StateBufferConnector_ms": 1.1736623048782349, "ViewRequirementAgentConnector_ms": 2.0055822134017944}, "num_episodes": 72, "episode_return_max": 444.09302168260115, "episode_return_min": -15.499687326093683, "episode_return_mean": 97.32430583514089, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1166240, "num_agent_steps_trained": 1166240, "num_env_steps_sampled": 291560, "num_env_steps_trained": 291560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 190.46034047381454, "num_env_steps_trained_throughput_per_sec": 190.46034047381454, "timesteps_total": 291560, "num_env_steps_sampled_lifetime": 291560, "num_agent_steps_sampled_lifetime": 1166240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1166240, "timers": {"training_iteration_time_ms": 78451.079, "restore_workers_time_ms": 1.222, "training_step_time_ms": 78442.501, "sample_time_ms": 13334.578, "learn_time_ms": 64668.03, "learn_throughput": 129.214, "synch_weights_time_ms": 373.303}, "counters": {"num_env_steps_sampled": 291560, "num_env_steps_trained": 291560, "num_agent_steps_sampled": 1166240, "num_agent_steps_trained": 1166240}, "done": false, "training_iteration": 37, "trial_id": "cdf01_00000", "date": "2024-08-20_10-52-25", "timestamp": 1724131345, "time_this_iter_s": 42.10840201377869, "time_total_s": 1851.2172827720642, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5a280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1851.2172827720642, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 71.59846153846154, "ram_util_percent": 83.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.868520446996841, "cur_kl_coeff": 1.1920928955078124e-08, "cur_lr": 0.0001, "total_loss": 9.35398276646932, "policy_loss": -0.003735486420226239, "vf_loss": 9.357718267894926, "vf_explained_var": -0.3576934012155684, "kl": 0.0032946487784408693, "entropy": 0.22339280883944224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 23275.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2373992700425407, "cur_kl_coeff": 2.4414062499999998e-05, "cur_lr": 0.0001, "total_loss": 8.981707980140808, "policy_loss": -0.004932468673509974, "vf_loss": 8.986640474531386, "vf_explained_var": 0.32101719171281845, "kl": 0.0040678365900136656, "entropy": 0.38216357831917114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 23275.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 299560, "num_env_steps_trained": 299560, "num_agent_steps_sampled": 1198240, "num_agent_steps_trained": 1198240}, "env_runners": {"episode_reward_max": 444.09302168260115, "episode_reward_min": -15.499687326093683, "episode_reward_mean": 97.32430583514089, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -613.2558307563605, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 193.75915130013567, "predator_policy": 596.986916789233}, "policy_reward_mean": {"prey_policy": -295.9797304396234, "predator_policy": 344.6418833571938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.138114444366709, 1.1000000000000014, 2.49334816936146, 100.72839577065525, 146.00215579929358, 50.53078510619655, 218.54025521062425, -0.02286546628312558, 9.594987123991624, 25.4962662881559, 122.9680466217588, -0.41659656302982384, 178.05000151238121, 62.42991238533304, 0.6000000000000019, 96.94429464321213, 1.3000000000000003, 0.6000000000000014, 32.18132301472649, 195.55915130013557, 32.96329871111411, 86.73450601370253, 2.405002490458495, 177.97766861670536, -1.9036936228382, -1.5429179440798444, 185.18092515852564, 82.79740602704666, 262.3177555294136, 224.20698692808247, 37.40495207996291, 66.18001090584835, 1.7999999999999994, 2.700000000000002, 444.09302168260115, 415.3407329492505, 228.11382227796, -1.3322676295501878e-15, 180.29145153727336, 7.099999999999991, 11.145890728381834, 0.45626444995511894, 2.4295353780220106, -12.242228758218394, 255.64329136565306, 0.399999999999999, 156.4895021703774, 3.7842518854173797, 0.5999999999999994, -5.329070518200751e-15, 108.90709720980539, 29.20684664637958, 404.57337727548895, 0.026710176076976788, 148.0065536093522, 226.20827052361858, 275.5338237047935, 115.46115249521839, 0.5332829275421553, 0.24660906552831707, 1.9000000000000017, -8.0842584289715, 254.77239143257216, -8.342683993553951, 332.40040860208734, 397.9472218252205, -0.5412029706124448, 120.12022705641425, 7.39999999999999, 325.3311152995563, 1.8000000000000003, 2.220446049250313e-15, 190.7720220344493, 10.085333173517041, 337.5641890506198, 36.66171291306819, 13.0260680032049, 37.51218790973458, 116.86717760512711, 341.6174505551831, 330.5332283619119, 298.29320137785606, 430.7484953201406, -15.499687326093683, -3.3111765009094656, -2.3276420708630945, 0.8999999999999997, 2.855899537031847, 216.1952838845235, 163.65728449802418, 1.5551308227387075, 20.941554445145847, 264.0874620080772, 0.09999999999999809, 85.32890862685268, 0.8816726432453742, 7.00777532531551, -0.1632368906784032, -4.440892098500626e-16, 14.448333828854016], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-320.02128993067487, -315.1788697620128, -364.6431798655457, -329.27638965083133, -385.2482570052059, -466.93480396140706, -353.96353618753017, -66.6570574736275, 43.34864616330137, -361.3127794901301, -419.2679783158571, -169.50417969459718, -600.7459687392336, -128.08440126210317, -356.3340515156471, -379.1006883749783, -403.6657967202213, -240.817569305648, -327.9791680131895, -306.0734759108549, -356.2320952832193, -148.5185245505062, -346.1313448754528, -360.6859409698417, -391.5319583498852, 121.74511120711966, -440.8735328406517, -63.49579526600436, -412.60208906731043, -366.2980537336354, -197.692394538793, -115.31011779710497, -328.9469391884729, -287.600646801542, -271.8140165211463, -364.1969616963742, -328.75299268914625, -31.03951997436188, 193.75915130013567, -335.5563925958622, -346.8618572374557, -200.61055358622417, -269.7891299058215, -306.8508119593651, -329.68244174954395, -334.6874543115005, -86.22338486082518, -542.3582921785709, -466.55291282355125, -479.1385006886173, -425.5279438559159, -591.6051905022705, -391.0596941459405, -2.103042710982336, -397.6828968055361, -290.71346424017304, -525.7316155600831, -48.8098341551236, -314.14189739990695, -337.9545840198716, -361.09086806153704, -191.45076797947704, -328.1203672742528, -403.615238633104, -414.06083159508563, -286.2476978821951, -339.4388466818581, -282.92636419996944, 132.29402196459205, -453.2337303798465, 116.69320276338719, -437.2098706002831, -29.402197778126173, -429.36819761298926, -364.01109488468273, -412.66553474151897, -179.64768637764777, -299.60984985487624, -239.91629322617905, -275.81014425573363, -236.02039576414927, -272.0512840447927, -374.2200003157754, -509.82018764599513, -338.1357585412361, -302.0698083660037, -399.8113040839103, -583.539291336763, -154.46975163618444, -392.30057320548656, -328.2506081909792, -416.96986818884824, -271.4092062015957, -434.1246901036331, -341.14094728526527, -402.8286005486197, -297.10070564189675, -353.7422398623837, -313.5178778523291, -489.12705849316535, -25.00157113121061, -335.65193134935015, -450.98535713684015, -273.323483690641, -67.65679756010948, -613.2558307563605, -310.6646891086715, -380.82457567864617, -16.482181385473453, -226.25329936470385, -148.80172653261766, -284.59352387766484, 145.54947973711793, -380.163211674663, -160.9420915426463, -419.4520879620805, -293.24933797164687, -340.74829949597535, -296.7353804299388, -375.40658231682585, -450.48094285074336, -302.85626250138625, -584.6586691140403, -179.99554038657766, -169.81357753775126, -163.58621381699254, -277.3417131083658, -321.1895884382994, 26.070519524504974, -373.5590842700733, -544.228456793131, 64.47900044617329, -321.48517806049523, -386.1405519011166, -114.19781137726808, -319.8034252298141, -441.4308587273242, -374.1014003457568, 26.028167403186952, -386.46769305676196, -290.04884350174797, -296.5148962052935, -357.14407813445393, -338.8571356274153, -49.99050244565028, -500.590497937651, -343.70433327846973, -200.3217920335701, -576.0083839725121, -31.579512136858426, -108.81268559574828, -345.0203588909231, -417.1621474129517, -323.90931302232053, -437.7579498100694, -263.0104293312254, -489.8573245282128, 20.661944672591574, -526.589162014844, 44.4922014995893, -46.35910887284071, -503.4214027465396, -82.70804692962227, -416.5802378807905, 116.07291303186028, -437.007826406398, -248.61470919234213, -74.10368122350134, -390.71724906843394, -458.79228919346656, -400.6334663370191, -377.1600516120709, -287.8109952597491, -326.69819654379734, -336.22154860662596, -313.5068317924408, -248.06347902207088, -232.68941633504915, -482.30817381915125, -119.85250670137037, -394.6264966997192, -394.1572553721178, -80.54144970309969, -466.0615696265014, 70.81701078835056, -455.3471970578993, -344.38747119708466, -293.9560825934445, -107.72219523454095, -340.8878370754105, -385.72487262890036, -384.20022136361246, -348.0343458109502, -254.89153810177967, -330.4232123263452, -477.4120160397472, -299.90309620095894, -388.92718916137585, -387.6947285939355, -322.7511937897435], "policy_predator_policy_reward": [335.7621337956343, 300.5761403414199, 365.6431798655457, 329.3763896508313, 385.33763059009806, 469.3387785458763, 179.61407892046103, 341.7349105113505, 228.27873776449667, 235.68755136162636, 419.2679783158571, 220.0349648007935, 484.024332516576, 463.3462926953849, 356.4340515156471, 378.97782290869515, 419.77392732260597, 234.30442582725468, 325.5074507064306, 334.0414595057708, 360.71574312136596, 267.0029233341176, 346.2007797203394, 360.1999095619252, 391.5319583498852, 56.30489030526153, 385.96582267870605, 180.83341781328292, 412.60208906731043, 366.89805373363555, 23.83567311790811, 386.11113386120115, 328.9469391884729, 288.90064680154205, 272.4140165211463, 364.1969616963742, 328.75299268914625, 63.220842989088595, 0.0, 337.3563925958626, 313.6385862465166, 266.79712328827776, 356.6977082849055, 306.67673959398365, 331.78244174954386, 334.992456801959, 332.86731348659384, 473.69203216950694, 346.8008031000974, 596.986916789233, 425.43019154153416, 590.1600248725724, 219.75504862569815, 358.58861338975066, 424.553868332374, 346.6398987403827, 461.77391278258443, 375.0852924620348, 469.06788060299414, 407.235587744868, 362.190868061537, 227.75572005943982, 299.1909660027315, 498.72465081047415, 414.06083159508563, 288.04769788219505, 339.4388466818581, 285.62636419996926, 374.3570132161602, 390.67571688169403, 330.2013613492625, 405.6560394368836, 303.63817828084956, 383.2460393882262, 364.01109488468273, 412.66553474151897, 345.1399890849441, 314.4089986848537, 244.01629322617882, 278.8101442557335, 243.52039576414924, 275.6971747731745, 374.276433321117, 510.2200190906086, 337.06912783800647, 305.5659744472554, 458.06426572583166, 513.0441009366236, 462.6815069720582, 339.73210923526585, 328.2506081909792, 417.3698681888482, 451.6026597487711, 410.4207387268376, 335.74899168941784, 412.0048080298844, 297.10070564189675, 354.34223986238385, 313.5178778523291, 489.12705849316535, 331.9493081225475, 137.61129156781945, 327.73773025991494, 425.7779572139461, 590.8026610933466, 494.6833444986116, 310.6913992847484, 380.82457567864617, 132.35352524344367, 258.3885091160859, 373.96907874722586, 285.63444218667445, 140.0480658079688, 370.09948983436954, 354.2101465949457, 341.6451854049992, 293.84933797164683, 340.6815824235175, 297.3677611790251, 375.0208106332679, 450.48094285074336, 304.75626250138623, 471.38903084299966, 285.1809202286483, 273.00224815826556, 315.1699346290503, 281.64029237292567, 308.54832518018577, 366.42297333758285, 313.46600001007226, 495.3004040050352, 382.3962741671445, 338.8707827023364, 368.2137442886627, 246.83780114629567, 307.28366251719973, 442.2308587273242, 380.7014003457583, 348.8538773085175, 336.91676364461307, 290.84884350174815, 297.51489620529355, 357.14407813445393, 338.8571356274153, 343.5586414603895, 397.7943809573617, 340.1945901964057, 213.91686828915164, 529.415654540441, 415.73643061955016, 193.09050883164645, 297.40424856809267, 417.2748197241272, 336.82270871435, 437.7579498100694, 300.5226172409616, 122.7447462163975, 463.31781124435105, 436.411739777576, 387.30267129286074, 417.43163564849357, 462.88210433279863, 491.66610977631126, 305.915376411957, 318.0755062356328, 433.6079024590452, 306.43449922378824, 0.7842038659613141, 460.2916078802579, 385.9067538807331, 397.62408883872314, 377.8417870395038, 327.29819654379736, 288.11099525974913, 313.5068317924408, 339.0774481436578, 356.87580412003695, 340.0723751216045, 427.90031965131647, 337.9176453672291, 394.6264966997192, 395.71238619485644, 101.33656463519183, 466.2080091395542, 248.4167158101532, 400.20093246747297, 344.4874711970847, 293.9560825934445, 209.1961233959669, 324.74281754083535, 386.8472309084588, 383.95953572729957, 347.60314259150095, 262.33051664654414, 330.2599754356668, 477.4120160397472, 299.90309620095894, 388.92718916137585, 401.94306242278935, 322.9511937897435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.06597970649063, "mean_inference_ms": 13.282847034791287, "mean_action_processing_ms": 26.969074867677445, "mean_env_wait_ms": 4.127955102867709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09025406837463379, "StateBufferConnector_ms": 1.1736623048782349, "ViewRequirementAgentConnector_ms": 2.0055822134017944}, "num_episodes": 0, "episode_return_max": 444.09302168260115, "episode_return_min": -15.499687326093683, "episode_return_mean": 97.32430583514089, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1198240, "num_agent_steps_trained": 1198240, "num_env_steps_sampled": 299560, "num_env_steps_trained": 299560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 156.9834283607156, "num_env_steps_trained_throughput_per_sec": 156.9834283607156, "timesteps_total": 299560, "num_env_steps_sampled_lifetime": 299560, "num_agent_steps_sampled_lifetime": 1198240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1198240, "timers": {"training_iteration_time_ms": 80434.027, "restore_workers_time_ms": 1.222, "training_step_time_ms": 80425.354, "sample_time_ms": 13408.531, "learn_time_ms": 66554.445, "learn_throughput": 125.551, "synch_weights_time_ms": 394.518}, "counters": {"num_env_steps_sampled": 299560, "num_env_steps_trained": 299560, "num_agent_steps_sampled": 1198240, "num_agent_steps_trained": 1198240}, "done": false, "training_iteration": 38, "trial_id": "cdf01_00000", "date": "2024-08-20_10-53-17", "timestamp": 1724131397, "time_this_iter_s": 51.42762303352356, "time_total_s": 1902.6449058055878, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e3c3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1902.6449058055878, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 82.6861111111111, "ram_util_percent": 83.58472222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.283894966140626, "cur_kl_coeff": 5.960464477539062e-09, "cur_lr": 0.0001, "total_loss": 9.117681992243206, "policy_loss": -0.00264268074709449, "vf_loss": 9.120324678269643, "vf_explained_var": -0.3967626615176125, "kl": 0.0017425291296020765, "entropy": 0.19346289227879238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 23905.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4447638933620754, "cur_kl_coeff": 1.2207031249999999e-05, "cur_lr": 0.0001, "total_loss": 8.576858889867388, "policy_loss": -0.004765556013536832, "vf_loss": 8.581624425403655, "vf_explained_var": 0.3853168511201465, "kl": 0.003865762867786139, "entropy": 0.3822915466058822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 23905.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 307560, "num_env_steps_trained": 307560, "num_agent_steps_sampled": 1230240, "num_agent_steps_trained": 1230240}, "env_runners": {"episode_reward_max": 430.7484953201406, "episode_reward_min": -15.499687326093683, "episode_reward_mean": 105.51507465817895, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -798.300462365081, "predator_policy": 0.7842038659613141}, "policy_reward_max": {"prey_policy": 116.07291303186028, "predator_policy": 658.9759455262363}, "policy_reward_mean": {"prey_policy": -309.36036837349343, "predator_policy": 362.1179057025828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.7720220344493, 10.085333173517041, 337.5641890506198, 36.66171291306819, 13.0260680032049, 37.51218790973458, 116.86717760512711, 341.6174505551831, 330.5332283619119, 298.29320137785606, 430.7484953201406, -15.499687326093683, -3.3111765009094656, -2.3276420708630945, 0.8999999999999997, 2.855899537031847, 216.1952838845235, 163.65728449802418, 1.5551308227387075, 20.941554445145847, 264.0874620080772, 0.09999999999999809, 85.32890862685268, 0.8816726432453742, 7.00777532531551, -0.1632368906784032, -4.440892098500626e-16, 14.448333828854016, 54.116374029443925, 232.76426495842173, 0.0, 298.2288864945202, 134.92839383354539, 230.67948399137248, -6.362806402481116, 1.5341531296646538, 321.89440284012, 2.700000000000001, 310.18810812614373, 0.32709038902018106, 319.11415668525177, 3.400000000000002, 34.59956700695809, 44.693373025583114, 0.16709708948921076, 153.15872175577846, 176.56594783316126, 207.8381546403112, 57.694071503889845, 341.50355495703616, 102.13650822138378, 53.28687633968506, 6.741199920154601, 85.48905974679305, 0.4043671510016511, 175.78937709396948, 35.02317096191137, 239.716934526847, 3.3000000000000007, 44.10399268739518, 0.39999999999999813, 1.445688629367676, 141.4639954291865, -13.482681823564228, 5.699999999999994, 256.4236605887397, 53.53476104937009, 399.4898267067322, 7.537008631673813, 259.6937213914619, 7.527903355555221, 141.74268690205773, 53.41939216963534, 56.52681059092675, -4.440892098500626e-16, 70.73016554337455, 348.2468399096904, 104.59931829959143, 239.93928682870413, -1.4629041206334155, 3.909217945630842, 271.59009430954956, 143.94025770659277, -2.6645352591003757e-15, 22.973162154938052, 157.38063125410844, 3.260767521179307, 363.86210373103324, 145.3373553533475, 22.80395831584207, 0.5315392950974771, 3.700000000000001, 0.09999999999999787, 195.87267334524242, 113.18244256079637, -2.6645352591003757e-15, 22.44929858338206, 377.23740752505114, 0.1919595724927503, 3.6460048892916266], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-49.99050244565028, -500.590497937651, -343.70433327846973, -200.3217920335701, -576.0083839725121, -31.579512136858426, -108.81268559574828, -345.0203588909231, -417.1621474129517, -323.90931302232053, -437.7579498100694, -263.0104293312254, -489.8573245282128, 20.661944672591574, -526.589162014844, 44.4922014995893, -46.35910887284071, -503.4214027465396, -82.70804692962227, -416.5802378807905, 116.07291303186028, -437.007826406398, -248.61470919234213, -74.10368122350134, -390.71724906843394, -458.79228919346656, -400.6334663370191, -377.1600516120709, -287.8109952597491, -326.69819654379734, -336.22154860662596, -313.5068317924408, -248.06347902207088, -232.68941633504915, -482.30817381915125, -119.85250670137037, -394.6264966997192, -394.1572553721178, -80.54144970309969, -466.0615696265014, 70.81701078835056, -455.3471970578993, -344.38747119708466, -293.9560825934445, -107.72219523454095, -340.8878370754105, -385.72487262890036, -384.20022136361246, -348.0343458109502, -254.89153810177967, -330.4232123263452, -477.4120160397472, -299.90309620095894, -388.92718916137585, -387.6947285939355, -322.7511937897435, -201.44081586116798, -289.54255621208046, 19.294189410570944, -388.38645696559865, -537.2648980291094, -466.6669125343349, -360.4281704908739, 95.52721129091239, -206.67774889184125, -219.8375055271655, -448.1742998525861, -141.44456557060556, -360.683596675052, -341.66747098555345, -343.14453104075835, -452.12819010454155, -441.95306350960965, 14.43388851058066, -273.0354989081982, -419.76135901725405, -488.88873822650396, -12.432628036991623, -351.44288438439605, -344.29635278371546, 3.051028504781514, -698.0076706349697, -268.8764743307571, -469.43716921308936, -185.0205848654543, -512.7231108841042, -133.6710000497915, -295.37709773529, -493.75728690314236, -347.0666233516227, -490.938991925086, -124.74781204975251, -331.3827967721291, -245.77116076599032, -522.7474919474331, -230.4637216207752, -91.04339048904517, -378.3376533830137, -484.350414846024, 16.960453138400474, -294.5388067469897, -341.02846265790413, -205.48760522083302, -291.9771183667145, -297.98110756634316, -490.2576144059134, -409.0972412492995, -431.12969705861843, -427.4451777155516, -535.7669541943255, -564.0522764870775, 56.33720970516758, -246.317916657592, -411.68762190810435, -9.86274176645907, -392.8592359759234, -379.6130548992632, -286.32261641699995, -220.05185294436154, -346.30054329722526, -288.32486579614925, -415.8896926933047, -380.87731995406847, -465.94268277306173, -501.13844589385286, 13.647475780201642, -353.55840384344157, -220.56828681208447, -316.43074077030485, -269.0099090225707, -334.91722128265934, -72.8623993496397, -583.4091645162412, -271.1662455342309, 36.23419179761722, -479.71161434997623, -338.6600833851313, -350.0230671250776, -363.8797319398933, -99.88146969710021, -429.22572354547077, -143.11330218998955, -374.6062420558475, -351.87181295667085, -369.98498363380025, -181.2611341861834, -66.97112738196304, -336.96012584408294, -458.780124858309, -370.9882456782888, -96.083476359556, -369.17152467419635, -115.06821950852583, -597.7941257540942, -299.274057759134, -16.90651663196647, -113.85129721878067, -409.39200176025986, -293.8814284011707, -411.21110337062964, -572.4324794085277, -319.5412414082932, 67.12079515122781, -355.6437595556527, -413.2018173922411, 18.1385332427231, -361.61446223865846, -431.4664114256223, -275.8570735469638, -552.101128946282, -319.385835722887, -559.9475129073807, -404.54548312064117, -274.31983759876573, 22.76830324238603, -578.6725112854713, -375.8689823300813, -279.8023716519539, -421.6231963464989, 17.061577300757147, -370.05141645341035, -576.7967224356096, -226.39351675750618, -489.38443746411764, -355.58857367591617, -362.33064997109153, -371.93059275043436, -93.50219740060035, -513.3316337640009, -122.11391400365902, -476.9570109307935, -425.12680043896364, -324.94622060299355, -374.4256034552263, -2.5893046995309654, -798.300462365081, -372.86298001269495, -351.1004266156509, -408.562841323083, -249.71535381005083], "policy_predator_policy_reward": [343.5586414603895, 397.7943809573617, 340.1945901964057, 213.91686828915164, 529.415654540441, 415.73643061955016, 193.09050883164645, 297.40424856809267, 417.2748197241272, 336.82270871435, 437.7579498100694, 300.5226172409616, 122.7447462163975, 463.31781124435105, 436.411739777576, 387.30267129286074, 417.43163564849357, 462.88210433279863, 491.66610977631126, 305.915376411957, 318.0755062356328, 433.6079024590452, 306.43449922378824, 0.7842038659613141, 460.2916078802579, 385.9067538807331, 397.62408883872314, 377.8417870395038, 327.29819654379736, 288.11099525974913, 313.5068317924408, 339.0774481436578, 356.87580412003695, 340.0723751216045, 427.90031965131647, 337.9176453672291, 394.6264966997192, 395.71238619485644, 101.33656463519183, 466.2080091395542, 248.4167158101532, 400.20093246747297, 344.4874711970847, 293.9560825934445, 209.1961233959669, 324.74281754083535, 386.8472309084588, 383.95953572729957, 347.60314259150095, 262.33051664654414, 330.2599754356668, 477.4120160397472, 299.90309620095894, 388.92718916137585, 401.94306242278935, 322.9511937897435, 362.54451331129087, 182.5552327914017, 255.71232284160143, 346.1442096718497, 537.2648980291094, 466.6669125343349, 284.85835161702204, 278.2714940774585, 222.40357676891753, 339.0400714836345, 447.08845196711565, 373.20989744744793, 351.9330606274612, 344.0552006306631, 344.678684170423, 452.12819010454155, 342.1390101653291, 407.27456767381926, 275.735498908198, 419.76135901725405, 499.09304230612406, 312.4164320835149, 348.4067232404104, 347.65960431672124, 471.57922062050096, 542.4915781949392, 272.27647433075714, 469.43716921308936, 219.6201518724123, 512.7231108841042, 173.93748135832502, 299.80398945233964, 493.75728690314236, 347.2337204411119, 473.6325648040034, 295.2129609266124, 268.2762217907687, 485.4436835805111, 359.08908562167016, 601.9602825868477, 146.63746199293496, 380.4376533830137, 373.1261641393889, 435.76735252527, 443.63079966727054, 294.0729779590071, 280.8755361412176, 269.8760637860143, 303.1394566171928, 491.84046527521826, 510.0914774614329, 415.624520593278, 427.84954486655334, 535.7669541943255, 121.63537967028445, 561.8690642055957, 333.588468064946, 359.44024146266145, 298.73532433445195, 343.7035879347788, 382.9130548992633, 286.32261641699995, 152.5077584032932, 457.94863052568974, 288.72486579614923, 415.8896926933047, 378.9463374122109, 469.3193539442871, 453.7432344504288, 175.2117310924089, 64.71253529638662, 495.931473535575, 318.8307407703048, 272.30990902257076, 205.70995720084963, 458.4933240201887, 583.3311323081922, 324.77903879164927, 406.3516752171823, 436.615574041908, 352.4454810608001, 343.77467808108247, 332.96803119014464, 390.48689183831084, 343.33276511346816, 236.53416397754677, 330.8981297614561, 537.3226121531223, 266.3971278127874, 338.26838217682985, 300.2209347111434, 160.2371291058276, 458.780124858309, 370.9882456782888, 313.77357811312964, 222.21158846399578, 537.8202952981324, 523.2888898741772, 163.01458207473763, 257.7653106159553, 381.93926599665474, 381.2433198110886, 293.1974431888868, 410.43218446228013, 572.2237192133656, 323.65921954908606, 332.5297411338109, 227.58331758016345, 307.46501508154915, 231.53852677456118, 361.61446223865846, 431.4664114256223, 323.14084492714807, 527.7905197210353, 488.01191480665926, 548.7020650777175, 322.7511960833519, 359.37489215723497, 454.7312363970203, 465.03507537709794, 392.6332067849185, 408.3755025504649, 425.0231963464992, 2.342381015084796, 370.05141645341035, 577.328261730707, 230.0935167575061, 489.38443746411764, 355.58857367591617, 362.43064997109155, 337.75002974493924, 323.55543375133743, 236.68955195768868, 511.9384383707681, 476.9570109307935, 425.12680043896364, 383.8560432683176, 337.9650793732847, 519.1512290634248, 658.9759455262363, 378.461437973977, 345.69392822686166, 314.52962321914487, 347.3945768032804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.565404791059978, "mean_inference_ms": 13.54121175478705, "mean_action_processing_ms": 26.071849406210568, "mean_env_wait_ms": 4.240410202781687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06974649429321289, "StateBufferConnector_ms": 0.5571770668029785, "ViewRequirementAgentConnector_ms": 1.3067574501037598}, "num_episodes": 72, "episode_return_max": 430.7484953201406, "episode_return_min": -15.499687326093683, "episode_return_mean": 105.51507465817895, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1230240, "num_agent_steps_trained": 1230240, "num_env_steps_sampled": 307560, "num_env_steps_trained": 307560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 77.69701455832366, "num_env_steps_trained_throughput_per_sec": 77.69701455832366, "timesteps_total": 307560, "num_env_steps_sampled_lifetime": 307560, "num_agent_steps_sampled_lifetime": 1230240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1230240, "timers": {"training_iteration_time_ms": 87484.12, "restore_workers_time_ms": 1.249, "training_step_time_ms": 87474.591, "sample_time_ms": 14502.488, "learn_time_ms": 72469.11, "learn_throughput": 115.304, "synch_weights_time_ms": 433.161}, "counters": {"num_env_steps_sampled": 307560, "num_env_steps_trained": 307560, "num_agent_steps_sampled": 1230240, "num_agent_steps_trained": 1230240}, "done": false, "training_iteration": 39, "trial_id": "cdf01_00000", "date": "2024-08-20_10-55-01", "timestamp": 1724131501, "time_this_iter_s": 103.56529307365417, "time_total_s": 2006.210198879242, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e8e430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2006.210198879242, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 96.61793103448275, "ram_util_percent": 83.65310344827587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.0575997837952205, "cur_kl_coeff": 2.980232238769531e-09, "cur_lr": 0.0001, "total_loss": 9.22041128854903, "policy_loss": -0.0031226450897982373, "vf_loss": 9.223533892253089, "vf_explained_var": -0.5164443180674598, "kl": 0.0022438485753459715, "entropy": 0.14361259472512064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 24535.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.058094891669258, "cur_kl_coeff": 6.1035156249999995e-06, "cur_lr": 0.0001, "total_loss": 8.777514360821437, "policy_loss": -0.0045348240506081355, "vf_loss": 8.782049180590917, "vf_explained_var": 0.3579132242808266, "kl": 0.0038722547455628436, "entropy": 0.3354649304870575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 24535.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 315560, "num_env_steps_trained": 315560, "num_agent_steps_sampled": 1262240, "num_agent_steps_trained": 1262240}, "env_runners": {"episode_reward_max": 430.7484953201406, "episode_reward_min": -15.499687326093683, "episode_reward_mean": 105.51507465817895, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -798.300462365081, "predator_policy": 0.7842038659613141}, "policy_reward_max": {"prey_policy": 116.07291303186028, "predator_policy": 658.9759455262363}, "policy_reward_mean": {"prey_policy": -309.36036837349343, "predator_policy": 362.1179057025828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.7720220344493, 10.085333173517041, 337.5641890506198, 36.66171291306819, 13.0260680032049, 37.51218790973458, 116.86717760512711, 341.6174505551831, 330.5332283619119, 298.29320137785606, 430.7484953201406, -15.499687326093683, -3.3111765009094656, -2.3276420708630945, 0.8999999999999997, 2.855899537031847, 216.1952838845235, 163.65728449802418, 1.5551308227387075, 20.941554445145847, 264.0874620080772, 0.09999999999999809, 85.32890862685268, 0.8816726432453742, 7.00777532531551, -0.1632368906784032, -4.440892098500626e-16, 14.448333828854016, 54.116374029443925, 232.76426495842173, 0.0, 298.2288864945202, 134.92839383354539, 230.67948399137248, -6.362806402481116, 1.5341531296646538, 321.89440284012, 2.700000000000001, 310.18810812614373, 0.32709038902018106, 319.11415668525177, 3.400000000000002, 34.59956700695809, 44.693373025583114, 0.16709708948921076, 153.15872175577846, 176.56594783316126, 207.8381546403112, 57.694071503889845, 341.50355495703616, 102.13650822138378, 53.28687633968506, 6.741199920154601, 85.48905974679305, 0.4043671510016511, 175.78937709396948, 35.02317096191137, 239.716934526847, 3.3000000000000007, 44.10399268739518, 0.39999999999999813, 1.445688629367676, 141.4639954291865, -13.482681823564228, 5.699999999999994, 256.4236605887397, 53.53476104937009, 399.4898267067322, 7.537008631673813, 259.6937213914619, 7.527903355555221, 141.74268690205773, 53.41939216963534, 56.52681059092675, -4.440892098500626e-16, 70.73016554337455, 348.2468399096904, 104.59931829959143, 239.93928682870413, -1.4629041206334155, 3.909217945630842, 271.59009430954956, 143.94025770659277, -2.6645352591003757e-15, 22.973162154938052, 157.38063125410844, 3.260767521179307, 363.86210373103324, 145.3373553533475, 22.80395831584207, 0.5315392950974771, 3.700000000000001, 0.09999999999999787, 195.87267334524242, 113.18244256079637, -2.6645352591003757e-15, 22.44929858338206, 377.23740752505114, 0.1919595724927503, 3.6460048892916266], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-49.99050244565028, -500.590497937651, -343.70433327846973, -200.3217920335701, -576.0083839725121, -31.579512136858426, -108.81268559574828, -345.0203588909231, -417.1621474129517, -323.90931302232053, -437.7579498100694, -263.0104293312254, -489.8573245282128, 20.661944672591574, -526.589162014844, 44.4922014995893, -46.35910887284071, -503.4214027465396, -82.70804692962227, -416.5802378807905, 116.07291303186028, -437.007826406398, -248.61470919234213, -74.10368122350134, -390.71724906843394, -458.79228919346656, -400.6334663370191, -377.1600516120709, -287.8109952597491, -326.69819654379734, -336.22154860662596, -313.5068317924408, -248.06347902207088, -232.68941633504915, -482.30817381915125, -119.85250670137037, -394.6264966997192, -394.1572553721178, -80.54144970309969, -466.0615696265014, 70.81701078835056, -455.3471970578993, -344.38747119708466, -293.9560825934445, -107.72219523454095, -340.8878370754105, -385.72487262890036, -384.20022136361246, -348.0343458109502, -254.89153810177967, -330.4232123263452, -477.4120160397472, -299.90309620095894, -388.92718916137585, -387.6947285939355, -322.7511937897435, -201.44081586116798, -289.54255621208046, 19.294189410570944, -388.38645696559865, -537.2648980291094, -466.6669125343349, -360.4281704908739, 95.52721129091239, -206.67774889184125, -219.8375055271655, -448.1742998525861, -141.44456557060556, -360.683596675052, -341.66747098555345, -343.14453104075835, -452.12819010454155, -441.95306350960965, 14.43388851058066, -273.0354989081982, -419.76135901725405, -488.88873822650396, -12.432628036991623, -351.44288438439605, -344.29635278371546, 3.051028504781514, -698.0076706349697, -268.8764743307571, -469.43716921308936, -185.0205848654543, -512.7231108841042, -133.6710000497915, -295.37709773529, -493.75728690314236, -347.0666233516227, -490.938991925086, -124.74781204975251, -331.3827967721291, -245.77116076599032, -522.7474919474331, -230.4637216207752, -91.04339048904517, -378.3376533830137, -484.350414846024, 16.960453138400474, -294.5388067469897, -341.02846265790413, -205.48760522083302, -291.9771183667145, -297.98110756634316, -490.2576144059134, -409.0972412492995, -431.12969705861843, -427.4451777155516, -535.7669541943255, -564.0522764870775, 56.33720970516758, -246.317916657592, -411.68762190810435, -9.86274176645907, -392.8592359759234, -379.6130548992632, -286.32261641699995, -220.05185294436154, -346.30054329722526, -288.32486579614925, -415.8896926933047, -380.87731995406847, -465.94268277306173, -501.13844589385286, 13.647475780201642, -353.55840384344157, -220.56828681208447, -316.43074077030485, -269.0099090225707, -334.91722128265934, -72.8623993496397, -583.4091645162412, -271.1662455342309, 36.23419179761722, -479.71161434997623, -338.6600833851313, -350.0230671250776, -363.8797319398933, -99.88146969710021, -429.22572354547077, -143.11330218998955, -374.6062420558475, -351.87181295667085, -369.98498363380025, -181.2611341861834, -66.97112738196304, -336.96012584408294, -458.780124858309, -370.9882456782888, -96.083476359556, -369.17152467419635, -115.06821950852583, -597.7941257540942, -299.274057759134, -16.90651663196647, -113.85129721878067, -409.39200176025986, -293.8814284011707, -411.21110337062964, -572.4324794085277, -319.5412414082932, 67.12079515122781, -355.6437595556527, -413.2018173922411, 18.1385332427231, -361.61446223865846, -431.4664114256223, -275.8570735469638, -552.101128946282, -319.385835722887, -559.9475129073807, -404.54548312064117, -274.31983759876573, 22.76830324238603, -578.6725112854713, -375.8689823300813, -279.8023716519539, -421.6231963464989, 17.061577300757147, -370.05141645341035, -576.7967224356096, -226.39351675750618, -489.38443746411764, -355.58857367591617, -362.33064997109153, -371.93059275043436, -93.50219740060035, -513.3316337640009, -122.11391400365902, -476.9570109307935, -425.12680043896364, -324.94622060299355, -374.4256034552263, -2.5893046995309654, -798.300462365081, -372.86298001269495, -351.1004266156509, -408.562841323083, -249.71535381005083], "policy_predator_policy_reward": [343.5586414603895, 397.7943809573617, 340.1945901964057, 213.91686828915164, 529.415654540441, 415.73643061955016, 193.09050883164645, 297.40424856809267, 417.2748197241272, 336.82270871435, 437.7579498100694, 300.5226172409616, 122.7447462163975, 463.31781124435105, 436.411739777576, 387.30267129286074, 417.43163564849357, 462.88210433279863, 491.66610977631126, 305.915376411957, 318.0755062356328, 433.6079024590452, 306.43449922378824, 0.7842038659613141, 460.2916078802579, 385.9067538807331, 397.62408883872314, 377.8417870395038, 327.29819654379736, 288.11099525974913, 313.5068317924408, 339.0774481436578, 356.87580412003695, 340.0723751216045, 427.90031965131647, 337.9176453672291, 394.6264966997192, 395.71238619485644, 101.33656463519183, 466.2080091395542, 248.4167158101532, 400.20093246747297, 344.4874711970847, 293.9560825934445, 209.1961233959669, 324.74281754083535, 386.8472309084588, 383.95953572729957, 347.60314259150095, 262.33051664654414, 330.2599754356668, 477.4120160397472, 299.90309620095894, 388.92718916137585, 401.94306242278935, 322.9511937897435, 362.54451331129087, 182.5552327914017, 255.71232284160143, 346.1442096718497, 537.2648980291094, 466.6669125343349, 284.85835161702204, 278.2714940774585, 222.40357676891753, 339.0400714836345, 447.08845196711565, 373.20989744744793, 351.9330606274612, 344.0552006306631, 344.678684170423, 452.12819010454155, 342.1390101653291, 407.27456767381926, 275.735498908198, 419.76135901725405, 499.09304230612406, 312.4164320835149, 348.4067232404104, 347.65960431672124, 471.57922062050096, 542.4915781949392, 272.27647433075714, 469.43716921308936, 219.6201518724123, 512.7231108841042, 173.93748135832502, 299.80398945233964, 493.75728690314236, 347.2337204411119, 473.6325648040034, 295.2129609266124, 268.2762217907687, 485.4436835805111, 359.08908562167016, 601.9602825868477, 146.63746199293496, 380.4376533830137, 373.1261641393889, 435.76735252527, 443.63079966727054, 294.0729779590071, 280.8755361412176, 269.8760637860143, 303.1394566171928, 491.84046527521826, 510.0914774614329, 415.624520593278, 427.84954486655334, 535.7669541943255, 121.63537967028445, 561.8690642055957, 333.588468064946, 359.44024146266145, 298.73532433445195, 343.7035879347788, 382.9130548992633, 286.32261641699995, 152.5077584032932, 457.94863052568974, 288.72486579614923, 415.8896926933047, 378.9463374122109, 469.3193539442871, 453.7432344504288, 175.2117310924089, 64.71253529638662, 495.931473535575, 318.8307407703048, 272.30990902257076, 205.70995720084963, 458.4933240201887, 583.3311323081922, 324.77903879164927, 406.3516752171823, 436.615574041908, 352.4454810608001, 343.77467808108247, 332.96803119014464, 390.48689183831084, 343.33276511346816, 236.53416397754677, 330.8981297614561, 537.3226121531223, 266.3971278127874, 338.26838217682985, 300.2209347111434, 160.2371291058276, 458.780124858309, 370.9882456782888, 313.77357811312964, 222.21158846399578, 537.8202952981324, 523.2888898741772, 163.01458207473763, 257.7653106159553, 381.93926599665474, 381.2433198110886, 293.1974431888868, 410.43218446228013, 572.2237192133656, 323.65921954908606, 332.5297411338109, 227.58331758016345, 307.46501508154915, 231.53852677456118, 361.61446223865846, 431.4664114256223, 323.14084492714807, 527.7905197210353, 488.01191480665926, 548.7020650777175, 322.7511960833519, 359.37489215723497, 454.7312363970203, 465.03507537709794, 392.6332067849185, 408.3755025504649, 425.0231963464992, 2.342381015084796, 370.05141645341035, 577.328261730707, 230.0935167575061, 489.38443746411764, 355.58857367591617, 362.43064997109155, 337.75002974493924, 323.55543375133743, 236.68955195768868, 511.9384383707681, 476.9570109307935, 425.12680043896364, 383.8560432683176, 337.9650793732847, 519.1512290634248, 658.9759455262363, 378.461437973977, 345.69392822686166, 314.52962321914487, 347.3945768032804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.565404791059978, "mean_inference_ms": 13.54121175478705, "mean_action_processing_ms": 26.071849406210568, "mean_env_wait_ms": 4.240410202781687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06974649429321289, "StateBufferConnector_ms": 0.5571770668029785, "ViewRequirementAgentConnector_ms": 1.3067574501037598}, "num_episodes": 0, "episode_return_max": 430.7484953201406, "episode_return_min": -15.499687326093683, "episode_return_mean": 105.51507465817895, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1262240, "num_agent_steps_trained": 1262240, "num_env_steps_sampled": 315560, "num_env_steps_trained": 315560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 204.85119779569908, "num_env_steps_trained_throughput_per_sec": 204.85119779569908, "timesteps_total": 315560, "num_env_steps_sampled_lifetime": 315560, "num_agent_steps_sampled_lifetime": 1262240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1262240, "timers": {"training_iteration_time_ms": 88346.803, "restore_workers_time_ms": 1.258, "training_step_time_ms": 88337.235, "sample_time_ms": 14696.188, "learn_time_ms": 73134.557, "learn_throughput": 114.255, "synch_weights_time_ms": 436.788}, "counters": {"num_env_steps_sampled": 315560, "num_env_steps_trained": 315560, "num_agent_steps_sampled": 1262240, "num_agent_steps_trained": 1262240}, "done": false, "training_iteration": 40, "trial_id": "cdf01_00000", "date": "2024-08-20_10-55-40", "timestamp": 1724131540, "time_this_iter_s": 39.13278007507324, "time_total_s": 2045.3429789543152, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5ad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2045.3429789543152, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 69.80181818181818, "ram_util_percent": 83.4381818181818}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.534340210566445, "cur_kl_coeff": 1.4901161193847655e-09, "cur_lr": 0.0001, "total_loss": 8.907911886487689, "policy_loss": -0.0033576363324379875, "vf_loss": 8.911269530038984, "vf_explained_var": -0.39410968820254005, "kl": 0.0026755945805946556, "entropy": 0.20574906094679757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 25165.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.740694486527216, "cur_kl_coeff": 3.0517578124999997e-06, "cur_lr": 0.0001, "total_loss": 8.548480081558228, "policy_loss": -0.004074822698113701, "vf_loss": 8.552554910145108, "vf_explained_var": 0.2975509663422902, "kl": 0.0033651126474054877, "entropy": 0.31860652785925636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 25165.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 323560, "num_env_steps_trained": 323560, "num_agent_steps_sampled": 1294240, "num_agent_steps_trained": 1294240}, "env_runners": {"episode_reward_max": 522.5316865499974, "episode_reward_min": -57.499184105315145, "episode_reward_mean": 89.31130841321205, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -798.300462365081, "predator_policy": 2.342381015084796}, "policy_reward_max": {"prey_policy": 195.49999999999997, "predator_policy": 682.4066150310839}, "policy_reward_mean": {"prey_policy": -317.5061227481425, "predator_policy": 362.1617769547485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.41939216963534, 56.52681059092675, -4.440892098500626e-16, 70.73016554337455, 348.2468399096904, 104.59931829959143, 239.93928682870413, -1.4629041206334155, 3.909217945630842, 271.59009430954956, 143.94025770659277, -2.6645352591003757e-15, 22.973162154938052, 157.38063125410844, 3.260767521179307, 363.86210373103324, 145.3373553533475, 22.80395831584207, 0.5315392950974771, 3.700000000000001, 0.09999999999999787, 195.87267334524242, 113.18244256079637, -2.6645352591003757e-15, 22.44929858338206, 377.23740752505114, 0.1919595724927503, 3.6460048892916266, 522.5316865499974, 106.96764240514264, 138.08113531123385, 3.774758283725532e-15, 164.01056169563228, 207.09949128616682, 2.102469859194218, 0.23522143461727119, 346.90413850248717, 196.98658978783536, 12.884758321696367, 70.75275698768473, 3.1086244689504383e-15, -3.552713678800501e-15, 8.881784197001252e-16, 9.447082989679402, 4.594920378386286, 311.5727748143001, 1.9656972411332563, 7.041570068706017, 0.30000000000000004, 180.02896458961916, 326.59503057811935, -0.24852159198020796, 14.140897219190055, 29.24866316215311, 76.78502281299072, 297.1818225238364, 12.349267189261791, 48.80313223584961, 2.283064502463408, 2.886579864025407e-15, -0.3718594068426029, 195.10223810549542, 232.6486431703302, 7.599999999999989, 43.55418623965574, 98.48663693141626, 7.8121117321436575, 1.700000000000001, 5.037136120633891, 456.6948039700259, 1.2785500859682513, 0.6840558181844667, 4.440892098500626e-15, -57.499184105315145, 2.4424906541753444e-15, 0.2409505104764229, 24.47769297788762, 14.11821647815124, 123.98301919706746, 54.92961575856313, -2.220446049250313e-16, 290.7647935577387, 300.06745350931664, 27.599314641830745, 2.4424906541753444e-15, 309.1415329491785, 82.4504831797562, -0.04470311848468711, 5.000000000000002, 56.68207434204874, 74.07128586103781, 2.8000000000000016, 4.440892098500626e-16, 57.680213064883304, 157.81985028511204, 11.46856217045771, 201.04712036806646, 27.08126808592331, 205.12236000930454, 97.28879469093063], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-369.98498363380025, -181.2611341861834, -66.97112738196304, -336.96012584408294, -458.780124858309, -370.9882456782888, -96.083476359556, -369.17152467419635, -115.06821950852583, -597.7941257540942, -299.274057759134, -16.90651663196647, -113.85129721878067, -409.39200176025986, -293.8814284011707, -411.21110337062964, -572.4324794085277, -319.5412414082932, 67.12079515122781, -355.6437595556527, -413.2018173922411, 18.1385332427231, -361.61446223865846, -431.4664114256223, -275.8570735469638, -552.101128946282, -319.385835722887, -559.9475129073807, -404.54548312064117, -274.31983759876573, 22.76830324238603, -578.6725112854713, -375.8689823300813, -279.8023716519539, -421.6231963464989, 17.061577300757147, -370.05141645341035, -576.7967224356096, -226.39351675750618, -489.38443746411764, -355.58857367591617, -362.33064997109153, -371.93059275043436, -93.50219740060035, -513.3316337640009, -122.11391400365902, -476.9570109307935, -425.12680043896364, -324.94622060299355, -374.4256034552263, -2.5893046995309654, -798.300462365081, -372.86298001269495, -351.1004266156509, -408.562841323083, -249.71535381005083, 163.30274871370636, -480.00341665827597, -344.43517899423796, -66.36436284009417, -94.48151844928438, -428.5721988369893, -319.1060047334608, -347.87856593461044, -215.53082108756539, -388.00653177795044, -394.3893699364491, -182.29070625889324, -383.4388419044388, -503.1599634473817, -340.90867584797866, -287.4550833430865, 16.58521710424251, -638.2280145506079, -165.39857216351717, -671.24794194087, -453.1432834263247, -398.27432320459786, -343.83955585852874, -318.50657191986846, -632.0578617964558, -459.82497709213584, -457.8651577957927, -333.9166007858535, -508.8364146166181, -396.8465047672656, -423.2157141917626, -265.62259545905636, -354.8085734297869, -333.23363362379195, 19.091370748665142, -422.46877748094505, -292.26912109569156, -361.3462644206238, -300.018723569334, -472.97091970361157, -492.4818737187311, -331.0109419910982, -441.96263895305844, -151.5798563643116, -486.7015498935291, -168.56712682911638, -267.93098097311554, -281.3808865309575, -202.0021559870185, -409.0810185610614, -222.38713526625216, -175.2822021072133, -357.008196971134, -215.7850392607687, 17.82966436117856, -561.936005898169, -558.1999613611293, -288.69995479799036, -330.17254123930985, -150.36798447688957, -325.1002688372021, -293.52245878307536, -338.5705343583479, -395.09499913313385, -366.9011596798792, -419.25657225269214, -292.1871857111064, 41.94897502327345, -383.25493005694324, -64.21153159485324, -228.00319763278898, -277.4925569545353, -332.1926571095174, -147.7897324362347, -310.019663614974, -88.87425753422812, -285.74242987882843, -326.1790466949345, -325.8796898381376, -367.9429250324666, -233.91012544680294, -475.13518840024057, 195.49999999999997, -332.0749531536524, -298.03377116625416, -281.67761998748847, -462.0819465006659, -317.3789935203235, -474.96820089821836, -482.314301229301, -165.0420901263992, -328.240868424024, -351.89083741473064, -306.68618439331794, -421.65855491548183, -377.6558593267404, -290.049124002158, -236.5332784973903, -239.84518683069825, -421.735617797276, 17.961844096834852, -698.2237257802582, -559.4791843399437, -103.92107027024878, -448.9631160365854, -326.7601898643434, -350.84625033451675, -39.94374029457895, -383.235658102041, -9.834031814119793, -267.44617957135245, -216.23399932709663, -353.680495728239, -344.24638049436066, -100.17977103279077, -507.1890938685693, -168.77095838237238, -522.8576234935814, -389.9411725402291, -309.22690937043734, -321.52448939549305, -385.1338937575985, -285.8084972278577, -409.7061532810259, -295.9080154240502, -535.1722833635783, -317.85967198184767, -354.38748081270313, -366.5677498604433, -397.736324921316, -326.21181874103405, -206.03600828733212, -159.89226869245363, -328.6059074397803, -347.5734334661165, -244.6460722712832, -109.91886934250607, -385.2658880084804, -338.69638694895394, -464.7278277543436, -4.894424858239386, -526.2512824128744, -505.3980764098568, -172.3890531817503], "policy_predator_policy_reward": [266.3971278127874, 338.26838217682985, 300.2209347111434, 160.2371291058276, 458.780124858309, 370.9882456782888, 313.77357811312964, 222.21158846399578, 537.8202952981324, 523.2888898741772, 163.01458207473763, 257.7653106159553, 381.93926599665474, 381.2433198110886, 293.1974431888868, 410.43218446228013, 572.2237192133656, 323.65921954908606, 332.5297411338109, 227.58331758016345, 307.46501508154915, 231.53852677456118, 361.61446223865846, 431.4664114256223, 323.14084492714807, 527.7905197210353, 488.01191480665926, 548.7020650777175, 322.7511960833519, 359.37489215723497, 454.7312363970203, 465.03507537709794, 392.6332067849185, 408.3755025504649, 425.0231963464992, 2.342381015084796, 370.05141645341035, 577.328261730707, 230.0935167575061, 489.38443746411764, 355.58857367591617, 362.43064997109155, 337.75002974493924, 323.55543375133743, 236.68955195768868, 511.9384383707681, 476.9570109307935, 425.12680043896364, 383.8560432683176, 337.9650793732847, 519.1512290634248, 658.9759455262363, 378.461437973977, 345.69392822686166, 314.52962321914487, 347.3945768032804, 384.10771313748785, 455.1246413570793, 263.85103327907206, 253.91615096040124, 353.6422062336187, 307.4926463638893, 319.1060047334608, 347.87856593461044, 317.3628851605095, 450.18502940063945, 351.0042298872946, 432.77533759421357, 382.38767802302556, 506.3135971879892, 340.90867584797866, 287.69030477770383, 386.79005068353155, 581.7568852653197, 390.3878876248489, 643.2452162673736, 378.43240073442615, 485.86996421819276, 449.3719894592904, 283.7268953067933, 632.0578617964558, 459.82497709213584, 457.8651577957927, 333.9166007858535, 508.8364146166181, 396.8465047672656, 333.5410702549271, 364.7443223855707, 315.2775971327232, 377.3595302992418, 360.0842988466405, 354.86588269994013, 289.19146130301885, 366.38962145442997, 307.06029363804004, 472.97091970361157, 492.4818737187311, 331.31094199109816, 397.3380989230859, 376.23336098390223, 395.2626226122957, 586.6010846884694, 267.1450729166426, 281.9182729954503, 243.77744821373506, 381.4466235535348, 344.7361743072265, 82.18182622839007, 357.44789704737957, 292.13036199751275, 323.6033618012805, 517.6848022595453, 552.6146473065105, 306.63453604187174, 284.4627337359398, 244.88092421611, 326.25600410687, 294.6497880158708, 338.5705343583479, 395.09499913313385, 366.5293002730366, 419.25657225269214, 158.9451757194299, 286.3952730738985, 348.48114804272603, 331.6339567794006, 231.10319763278886, 281.9925569545352, 309.8263574326897, 213.71021835271767, 186.30805777318167, 311.0725003074361, 316.0712705847951, 303.66231772111166, 327.5796898381376, 367.9429250324666, 237.31012544680289, 476.77232452087446, 265.02391074628815, 328.2458463773912, 302.08031575572187, 278.9096254839889, 461.530663056494, 318.6143327826798, 409.0217758140567, 548.2607263134632, 140.87170636960803, 294.91206807549827, 351.89083741473064, 306.68618439331794, 422.72029575791987, 376.8350689947788, 315.9702420766192, 235.08985340081708, 423.1356177972763, 252.56340330884947, 121.83828584940744, 682.4066150310839, 580.7704822069954, 137.55938816176032, 448.9631160365854, 326.7601898643434, 342.7341154990437, 338.82066868779134, 377.7228274066518, 315.41431601882573, 268.5399856453422, 242.73950789493705, 353.680495728239, 344.24638049436066, 429.5335267540403, 486.97687109649814, 315.0956249662907, 458.9834400894196, 390.1411725402291, 308.9822062519527, 390.13389375759857, 321.52448939549305, 288.69084447593644, 463.5058803749957, 379.52447171175305, 525.6271129369153, 317.85967198184767, 357.18748081270314, 366.5677498604433, 397.736324921316, 295.1301115167173, 294.7979285765317, 312.777686885794, 333.5403395315522, 295.006176336848, 308.6818915710094, 356.60774175854505, 339.62413596050857, 387.48384747276936, 443.02163531645124, 401.63498969422636, 334.6330775861939, 380.523220009976, 394.5527042725617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.625014536717726, "mean_inference_ms": 13.482566152211, "mean_action_processing_ms": 25.033253159503435, "mean_env_wait_ms": 4.235862617381401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07114541530609131, "StateBufferConnector_ms": 0.26961660385131836, "ViewRequirementAgentConnector_ms": 0.7103559970855713}, "num_episodes": 72, "episode_return_max": 522.5316865499974, "episode_return_min": -57.499184105315145, "episode_return_mean": 89.31130841321205, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1294240, "num_agent_steps_trained": 1294240, "num_env_steps_sampled": 323560, "num_env_steps_trained": 323560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 200.46553718928376, "num_env_steps_trained_throughput_per_sec": 200.46553718928376, "timesteps_total": 323560, "num_env_steps_sampled_lifetime": 323560, "num_agent_steps_sampled_lifetime": 1294240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1294240, "timers": {"training_iteration_time_ms": 89289.143, "restore_workers_time_ms": 1.26, "training_step_time_ms": 89279.518, "sample_time_ms": 14866.039, "learn_time_ms": 73903.903, "learn_throughput": 113.066, "synch_weights_time_ms": 439.158}, "counters": {"num_env_steps_sampled": 323560, "num_env_steps_trained": 323560, "num_agent_steps_sampled": 1294240, "num_agent_steps_trained": 1294240}, "done": false, "training_iteration": 41, "trial_id": "cdf01_00000", "date": "2024-08-20_10-56-20", "timestamp": 1724131580, "time_this_iter_s": 39.97914481163025, "time_total_s": 2085.3221237659454, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317edb8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2085.3221237659454, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 70.97894736842105, "ram_util_percent": 83.49122807017544}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.342212151156532, "cur_kl_coeff": 7.450580596923828e-10, "cur_lr": 0.0001, "total_loss": 9.157437118651375, "policy_loss": -0.0035630444789098367, "vf_loss": 9.161000176081581, "vf_explained_var": -0.2463642562192584, "kl": 0.003401977259482154, "entropy": 0.17483900153920764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 25795.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3620503300712223, "cur_kl_coeff": 1.5258789062499999e-06, "cur_lr": 0.0001, "total_loss": 8.847478200518896, "policy_loss": -0.003738758285042076, "vf_loss": 8.85121695351979, "vf_explained_var": 0.31852446870198325, "kl": 0.0031480063715828275, "entropy": 0.3137905438031469, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 25795.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 331560, "num_env_steps_trained": 331560, "num_agent_steps_sampled": 1326240, "num_agent_steps_trained": 1326240}, "env_runners": {"episode_reward_max": 522.5316865499974, "episode_reward_min": -57.499184105315145, "episode_reward_mean": 88.89742120634129, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -798.300462365081, "predator_policy": 2.342381015084796}, "policy_reward_max": {"prey_policy": 195.49999999999997, "predator_policy": 682.4066150310839}, "policy_reward_mean": {"prey_policy": -319.2914831959021, "predator_policy": 363.74019379907276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.909217945630842, 271.59009430954956, 143.94025770659277, -2.6645352591003757e-15, 22.973162154938052, 157.38063125410844, 3.260767521179307, 363.86210373103324, 145.3373553533475, 22.80395831584207, 0.5315392950974771, 3.700000000000001, 0.09999999999999787, 195.87267334524242, 113.18244256079637, -2.6645352591003757e-15, 22.44929858338206, 377.23740752505114, 0.1919595724927503, 3.6460048892916266, 522.5316865499974, 106.96764240514264, 138.08113531123385, 3.774758283725532e-15, 164.01056169563228, 207.09949128616682, 2.102469859194218, 0.23522143461727119, 346.90413850248717, 196.98658978783536, 12.884758321696367, 70.75275698768473, 3.1086244689504383e-15, -3.552713678800501e-15, 8.881784197001252e-16, 9.447082989679402, 4.594920378386286, 311.5727748143001, 1.9656972411332563, 7.041570068706017, 0.30000000000000004, 180.02896458961916, 326.59503057811935, -0.24852159198020796, 14.140897219190055, 29.24866316215311, 76.78502281299072, 297.1818225238364, 12.349267189261791, 48.80313223584961, 2.283064502463408, 2.886579864025407e-15, -0.3718594068426029, 195.10223810549542, 232.6486431703302, 7.599999999999989, 43.55418623965574, 98.48663693141626, 7.8121117321436575, 1.700000000000001, 5.037136120633891, 456.6948039700259, 1.2785500859682513, 0.6840558181844667, 4.440892098500626e-15, -57.499184105315145, 2.4424906541753444e-15, 0.2409505104764229, 24.47769297788762, 14.11821647815124, 123.98301919706746, 54.92961575856313, -2.220446049250313e-16, 290.7647935577387, 300.06745350931664, 27.599314641830745, 2.4424906541753444e-15, 309.1415329491785, 82.4504831797562, -0.04470311848468711, 5.000000000000002, 56.68207434204874, 74.07128586103781, 2.8000000000000016, 4.440892098500626e-16, 57.680213064883304, 157.81985028511204, 11.46856217045771, 201.04712036806646, 27.08126808592331, 205.12236000930454, 97.28879469093063, 259.3089081000969, 142.37547087874205, 46.383304940856085, 105.12391959142835, 8.982704345854739, 2.7380031757921683, 6.047326077942509, 259.6505514235011], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-572.4324794085277, -319.5412414082932, 67.12079515122781, -355.6437595556527, -413.2018173922411, 18.1385332427231, -361.61446223865846, -431.4664114256223, -275.8570735469638, -552.101128946282, -319.385835722887, -559.9475129073807, -404.54548312064117, -274.31983759876573, 22.76830324238603, -578.6725112854713, -375.8689823300813, -279.8023716519539, -421.6231963464989, 17.061577300757147, -370.05141645341035, -576.7967224356096, -226.39351675750618, -489.38443746411764, -355.58857367591617, -362.33064997109153, -371.93059275043436, -93.50219740060035, -513.3316337640009, -122.11391400365902, -476.9570109307935, -425.12680043896364, -324.94622060299355, -374.4256034552263, -2.5893046995309654, -798.300462365081, -372.86298001269495, -351.1004266156509, -408.562841323083, -249.71535381005083, 163.30274871370636, -480.00341665827597, -344.43517899423796, -66.36436284009417, -94.48151844928438, -428.5721988369893, -319.1060047334608, -347.87856593461044, -215.53082108756539, -388.00653177795044, -394.3893699364491, -182.29070625889324, -383.4388419044388, -503.1599634473817, -340.90867584797866, -287.4550833430865, 16.58521710424251, -638.2280145506079, -165.39857216351717, -671.24794194087, -453.1432834263247, -398.27432320459786, -343.83955585852874, -318.50657191986846, -632.0578617964558, -459.82497709213584, -457.8651577957927, -333.9166007858535, -508.8364146166181, -396.8465047672656, -423.2157141917626, -265.62259545905636, -354.8085734297869, -333.23363362379195, 19.091370748665142, -422.46877748094505, -292.26912109569156, -361.3462644206238, -300.018723569334, -472.97091970361157, -492.4818737187311, -331.0109419910982, -441.96263895305844, -151.5798563643116, -486.7015498935291, -168.56712682911638, -267.93098097311554, -281.3808865309575, -202.0021559870185, -409.0810185610614, -222.38713526625216, -175.2822021072133, -357.008196971134, -215.7850392607687, 17.82966436117856, -561.936005898169, -558.1999613611293, -288.69995479799036, -330.17254123930985, -150.36798447688957, -325.1002688372021, -293.52245878307536, -338.5705343583479, -395.09499913313385, -366.9011596798792, -419.25657225269214, -292.1871857111064, 41.94897502327345, -383.25493005694324, -64.21153159485324, -228.00319763278898, -277.4925569545353, -332.1926571095174, -147.7897324362347, -310.019663614974, -88.87425753422812, -285.74242987882843, -326.1790466949345, -325.8796898381376, -367.9429250324666, -233.91012544680294, -475.13518840024057, 195.49999999999997, -332.0749531536524, -298.03377116625416, -281.67761998748847, -462.0819465006659, -317.3789935203235, -474.96820089821836, -482.314301229301, -165.0420901263992, -328.240868424024, -351.89083741473064, -306.68618439331794, -421.65855491548183, -377.6558593267404, -290.049124002158, -236.5332784973903, -239.84518683069825, -421.735617797276, 17.961844096834852, -698.2237257802582, -559.4791843399437, -103.92107027024878, -448.9631160365854, -326.7601898643434, -350.84625033451675, -39.94374029457895, -383.235658102041, -9.834031814119793, -267.44617957135245, -216.23399932709663, -353.680495728239, -344.24638049436066, -100.17977103279077, -507.1890938685693, -168.77095838237238, -522.8576234935814, -389.9411725402291, -309.22690937043734, -321.52448939549305, -385.1338937575985, -285.8084972278577, -409.7061532810259, -295.9080154240502, -535.1722833635783, -317.85967198184767, -354.38748081270313, -366.5677498604433, -397.736324921316, -326.21181874103405, -206.03600828733212, -159.89226869245363, -328.6059074397803, -347.5734334661165, -244.6460722712832, -109.91886934250607, -385.2658880084804, -338.69638694895394, -464.7278277543436, -4.894424858239386, -526.2512824128744, -505.3980764098568, -172.3890531817503, -104.39167687332751, -408.512538749247, 31.197227448488952, -368.81848373544744, -470.4643732441531, -452.94281346837175, -381.5010928359787, -307.83561232482305, -57.01930180916506, -324.06910171492524, -297.59916839714316, -357.7029415993608, -272.94521331187656, -446.20111367697854, -156.1895312266033, -489.6558470539471], "policy_predator_policy_reward": [572.2237192133656, 323.65921954908606, 332.5297411338109, 227.58331758016345, 307.46501508154915, 231.53852677456118, 361.61446223865846, 431.4664114256223, 323.14084492714807, 527.7905197210353, 488.01191480665926, 548.7020650777175, 322.7511960833519, 359.37489215723497, 454.7312363970203, 465.03507537709794, 392.6332067849185, 408.3755025504649, 425.0231963464992, 2.342381015084796, 370.05141645341035, 577.328261730707, 230.0935167575061, 489.38443746411764, 355.58857367591617, 362.43064997109155, 337.75002974493924, 323.55543375133743, 236.68955195768868, 511.9384383707681, 476.9570109307935, 425.12680043896364, 383.8560432683176, 337.9650793732847, 519.1512290634248, 658.9759455262363, 378.461437973977, 345.69392822686166, 314.52962321914487, 347.3945768032804, 384.10771313748785, 455.1246413570793, 263.85103327907206, 253.91615096040124, 353.6422062336187, 307.4926463638893, 319.1060047334608, 347.87856593461044, 317.3628851605095, 450.18502940063945, 351.0042298872946, 432.77533759421357, 382.38767802302556, 506.3135971879892, 340.90867584797866, 287.69030477770383, 386.79005068353155, 581.7568852653197, 390.3878876248489, 643.2452162673736, 378.43240073442615, 485.86996421819276, 449.3719894592904, 283.7268953067933, 632.0578617964558, 459.82497709213584, 457.8651577957927, 333.9166007858535, 508.8364146166181, 396.8465047672656, 333.5410702549271, 364.7443223855707, 315.2775971327232, 377.3595302992418, 360.0842988466405, 354.86588269994013, 289.19146130301885, 366.38962145442997, 307.06029363804004, 472.97091970361157, 492.4818737187311, 331.31094199109816, 397.3380989230859, 376.23336098390223, 395.2626226122957, 586.6010846884694, 267.1450729166426, 281.9182729954503, 243.77744821373506, 381.4466235535348, 344.7361743072265, 82.18182622839007, 357.44789704737957, 292.13036199751275, 323.6033618012805, 517.6848022595453, 552.6146473065105, 306.63453604187174, 284.4627337359398, 244.88092421611, 326.25600410687, 294.6497880158708, 338.5705343583479, 395.09499913313385, 366.5293002730366, 419.25657225269214, 158.9451757194299, 286.3952730738985, 348.48114804272603, 331.6339567794006, 231.10319763278886, 281.9925569545352, 309.8263574326897, 213.71021835271767, 186.30805777318167, 311.0725003074361, 316.0712705847951, 303.66231772111166, 327.5796898381376, 367.9429250324666, 237.31012544680289, 476.77232452087446, 265.02391074628815, 328.2458463773912, 302.08031575572187, 278.9096254839889, 461.530663056494, 318.6143327826798, 409.0217758140567, 548.2607263134632, 140.87170636960803, 294.91206807549827, 351.89083741473064, 306.68618439331794, 422.72029575791987, 376.8350689947788, 315.9702420766192, 235.08985340081708, 423.1356177972763, 252.56340330884947, 121.83828584940744, 682.4066150310839, 580.7704822069954, 137.55938816176032, 448.9631160365854, 326.7601898643434, 342.7341154990437, 338.82066868779134, 377.7228274066518, 315.41431601882573, 268.5399856453422, 242.73950789493705, 353.680495728239, 344.24638049436066, 429.5335267540403, 486.97687109649814, 315.0956249662907, 458.9834400894196, 390.1411725402291, 308.9822062519527, 390.13389375759857, 321.52448939549305, 288.69084447593644, 463.5058803749957, 379.52447171175305, 525.6271129369153, 317.85967198184767, 357.18748081270314, 366.5677498604433, 397.736324921316, 295.1301115167173, 294.7979285765317, 312.777686885794, 333.5403395315522, 295.006176336848, 308.6818915710094, 356.60774175854505, 339.62413596050857, 387.48384747276936, 443.02163531645124, 401.63498969422636, 334.6330775861939, 380.523220009976, 394.5527042725617, 373.3400633727966, 398.8730603498737, 140.26556446686723, 339.7311626988337, 393.02355200515046, 576.7669396482303, 357.75387351122407, 436.70675124100615, 33.95053845260558, 356.1205694173392, 300.22182146140403, 357.81829171089214, 278.70243069340756, 446.491222373391, 502.2583160569615, 403.2376136470887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.704033961097268, "mean_inference_ms": 13.381511907904628, "mean_action_processing_ms": 24.87879329324993, "mean_env_wait_ms": 4.156183002799461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0709226131439209, "StateBufferConnector_ms": 0.15948748588562012, "ViewRequirementAgentConnector_ms": 0.6870682239532471}, "num_episodes": 8, "episode_return_max": 522.5316865499974, "episode_return_min": -57.499184105315145, "episode_return_mean": 88.89742120634129, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1326240, "num_agent_steps_trained": 1326240, "num_env_steps_sampled": 331560, "num_env_steps_trained": 331560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 135.84485594938477, "num_env_steps_trained_throughput_per_sec": 135.84485594938477, "timesteps_total": 331560, "num_env_steps_sampled_lifetime": 331560, "num_agent_steps_sampled_lifetime": 1326240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1326240, "timers": {"training_iteration_time_ms": 92125.192, "restore_workers_time_ms": 1.29, "training_step_time_ms": 92115.506, "sample_time_ms": 15098.49, "learn_time_ms": 76483.015, "learn_throughput": 109.253, "synch_weights_time_ms": 461.001}, "counters": {"num_env_steps_sampled": 331560, "num_env_steps_trained": 331560, "num_agent_steps_sampled": 1326240, "num_agent_steps_trained": 1326240}, "done": false, "training_iteration": 42, "trial_id": "cdf01_00000", "date": "2024-08-20_10-57-20", "timestamp": 1724131640, "time_this_iter_s": 59.71680474281311, "time_total_s": 2145.0389285087585, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2145.0389285087585, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 89.67023809523809, "ram_util_percent": 83.53333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.741105476258293, "cur_kl_coeff": 3.725290298461914e-10, "cur_lr": 0.0001, "total_loss": 8.961756355043441, "policy_loss": -0.0033962551190236966, "vf_loss": 8.96515266176254, "vf_explained_var": -0.5088485570180984, "kl": 0.0030028337153626557, "entropy": 0.1825262713763449, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 26425.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.602375982678126, "cur_kl_coeff": 7.629394531249999e-07, "cur_lr": 0.0001, "total_loss": 8.40418416431972, "policy_loss": -0.004636564338949346, "vf_loss": 8.408820732056148, "vf_explained_var": 0.4068100573524596, "kl": 0.00392825755593621, "entropy": 0.3414077626807349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 26425.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 339560, "num_env_steps_trained": 339560, "num_agent_steps_sampled": 1358240, "num_agent_steps_trained": 1358240}, "env_runners": {"episode_reward_max": 309.1415329491785, "episode_reward_min": -57.499184105315145, "episode_reward_mean": 63.27963598728488, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -698.2237257802582, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 31.197227448488952, "predator_policy": 683.4431188827855}, "policy_reward_mean": {"prey_policy": -321.6288419305143, "predator_policy": 353.2686599241567}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.440892098500626e-15, -57.499184105315145, 2.4424906541753444e-15, 0.2409505104764229, 24.47769297788762, 14.11821647815124, 123.98301919706746, 54.92961575856313, -2.220446049250313e-16, 290.7647935577387, 300.06745350931664, 27.599314641830745, 2.4424906541753444e-15, 309.1415329491785, 82.4504831797562, -0.04470311848468711, 5.000000000000002, 56.68207434204874, 74.07128586103781, 2.8000000000000016, 4.440892098500626e-16, 57.680213064883304, 157.81985028511204, 11.46856217045771, 201.04712036806646, 27.08126808592331, 205.12236000930454, 97.28879469093063, 259.3089081000969, 142.37547087874205, 46.383304940856085, 105.12391959142835, 8.982704345854739, 2.7380031757921683, 6.047326077942509, 259.6505514235011, 108.24666131302246, 8.190380023879179, 0.6000000000000012, -4.440892098500626e-16, 19.318619466289913, 38.90000000000014, 62.80848251227731, 239.48138056772208, 9.098474730217516, 40.490484691247076, 81.9343032330281, 37.0722684880502, 86.4674979343864, 6.599999999999991, 0.028139748780854568, 2.8000000000000025, -1.2610846839655845, -5.10702591327572e-15, 164.89116852529745, 59.21481333882178, 2.6000000000000023, 162.1695831033296, 8.881784197001252e-16, 0.3999999999999986, 60.780879743062115, 0.10000000000000098, -0.9514613369453604, 0.2000000000000033, 6.721140814446609, 14.624475388113249, 14.141396537573222, 277.4568279619532, -10.465043213699262, -1.0222125958292319, 3.837408339596184, 306.7071448513545, 119.80433816825776, 45.131267361915675, 125.83166847688554, -20.096115370445432, 38.69612747489058, 51.45955596795052, 161.99627921931207, 36.6006145047144, 239.36657014761516, 193.3332793611617, -2.6645352591003757e-15, 0.8417695601271287, -1.5432161228537153, 0.6000000000000001, 9.933727235142962, 6.525367736375784, 18.825706739411018, 47.166302694093304, 10.864666697041251, 1.3322676295501878e-15, 4.7534749313939475, 0.20000000000000107, -2.5430373576553187, 242.38274954625132, 17.290139787432295, 149.95705215057538, 12.229853251603263, 119.27282413713633], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-474.96820089821836, -482.314301229301, -165.0420901263992, -328.240868424024, -351.89083741473064, -306.68618439331794, -421.65855491548183, -377.6558593267404, -290.049124002158, -236.5332784973903, -239.84518683069825, -421.735617797276, 17.961844096834852, -698.2237257802582, -559.4791843399437, -103.92107027024878, -448.9631160365854, -326.7601898643434, -350.84625033451675, -39.94374029457895, -383.235658102041, -9.834031814119793, -267.44617957135245, -216.23399932709663, -353.680495728239, -344.24638049436066, -100.17977103279077, -507.1890938685693, -168.77095838237238, -522.8576234935814, -389.9411725402291, -309.22690937043734, -321.52448939549305, -385.1338937575985, -285.8084972278577, -409.7061532810259, -295.9080154240502, -535.1722833635783, -317.85967198184767, -354.38748081270313, -366.5677498604433, -397.736324921316, -326.21181874103405, -206.03600828733212, -159.89226869245363, -328.6059074397803, -347.5734334661165, -244.6460722712832, -109.91886934250607, -385.2658880084804, -338.69638694895394, -464.7278277543436, -4.894424858239386, -526.2512824128744, -505.3980764098568, -172.3890531817503, -104.39167687332751, -408.512538749247, 31.197227448488952, -368.81848373544744, -470.4643732441531, -452.94281346837175, -381.5010928359787, -307.83561232482305, -57.01930180916506, -324.06910171492524, -297.59916839714316, -357.7029415993608, -272.94521331187656, -446.20111367697854, -156.1895312266033, -489.6558470539471, -465.8429663129246, 13.563540111895065, -393.28431586122247, -334.5043516130264, -511.5876214845561, -297.3709908928562, -412.2121485464381, -385.18417586761024, -521.6494397862715, -393.03329262870176, -232.80906429040985, -190.87824365154083, -366.00074727807606, -291.66452377623983, -7.316246274679498, -367.7822588574125, -406.67422044989024, -310.2908461417267, -349.87648621264077, 28.47311700982649, -529.6639967438481, -224.3759847087395, -267.5081507759345, -314.3192732668219, -272.6921613885733, -302.01681628152824, -236.3507182444767, -354.31771522053606, -476.36200734990996, -417.3882092483953, -455.31478943855365, -253.8056977526203, -303.7690200185151, -384.6341781442603, -443.2325273289542, -392.50691484971605, 15.43102871968568, -427.0416148629427, 20.000000000000014, -522.2030236586482, -279.58832611431507, -347.3066428592675, -159.5616568931679, -357.2103472117671, -304.16838908555707, -327.03573364876297, -404.83612074555793, -356.1816554045459, -430.4544321586913, 18.265284112054847, -400.14067304336857, -405.8393971282245, -373.1586616028843, -367.40824693524735, -347.6097989762193, -374.52608698849383, -281.8077882126924, -303.8680798992464, -328.9110532303163, -374.4448528516489, -428.8180213290893, -509.3019311461093, 29.54892518556511, -425.0833628840837, -347.9819603843165, -338.5973128820492, -341.1050776820785, -316.11817033168717, -363.04495405093127, -358.5813416543848, -183.16323171143958, -172.56480980967362, -173.79995272894902, -512.1175889002653, -269.24864909098187, -107.11818092437785, 14.465293047823222, -312.1790018571012, -342.2668426093997, -361.26494381055824, -370.98826419950274, -274.9251140981823, -438.3159650670677, -244.50279513047087, -128.15041219632397, -364.1211033507854, -241.9022062640198, -396.001838724376, -84.08752931651927, -459.80149198985924, -502.6744757783668, -164.32460238699258, -510.3175666089712, -382.1515464297801, -394.91057335136605, -340.5786475399413, -440.97462443686595, -532.7345698641823, -315.87788073716405, -380.9309310297464, -346.0015331936654, -314.06381888824734, -305.3816390299093, -306.4911729230542, 17.925706739411005, -287.9983397700098, -397.832075846633, -338.0121321919129, -360.5424742822164, -361.19792488084795, -666.681518585245, -428.7894136503432, -283.463031706482, -330.8453579884007, -314.1480480561689, -420.35072515853847, -473.4259124315101, -465.11980269813927, -4.555463919177775, -308.7025181753042, -209.65495558272525, -376.4302104287432, -79.59640838435425, -530.9807580643162, -385.3359271469688, -280.3130773986363, -645.4198872063718, -257.3557281357142], "policy_predator_policy_reward": [409.0217758140567, 548.2607263134632, 140.87170636960803, 294.91206807549827, 351.89083741473064, 306.68618439331794, 422.72029575791987, 376.8350689947788, 315.9702420766192, 235.08985340081708, 423.1356177972763, 252.56340330884947, 121.83828584940744, 682.4066150310839, 580.7704822069954, 137.55938816176032, 448.9631160365854, 326.7601898643434, 342.7341154990437, 338.82066868779134, 377.7228274066518, 315.41431601882573, 268.5399856453422, 242.73950789493705, 353.680495728239, 344.24638049436066, 429.5335267540403, 486.97687109649814, 315.0956249662907, 458.9834400894196, 390.1411725402291, 308.9822062519527, 390.13389375759857, 321.52448939549305, 288.69084447593644, 463.5058803749957, 379.52447171175305, 525.6271129369153, 317.85967198184767, 357.18748081270314, 366.5677498604433, 397.736324921316, 295.1301115167173, 294.7979285765317, 312.777686885794, 333.5403395315522, 295.006176336848, 308.6818915710094, 356.60774175854505, 339.62413596050857, 387.48384747276936, 443.02163531645124, 401.63498969422636, 334.6330775861939, 380.523220009976, 394.5527042725617, 373.3400633727966, 398.8730603498737, 140.26556446686723, 339.7311626988337, 393.02355200515046, 576.7669396482303, 357.75387351122407, 436.70675124100615, 33.95053845260558, 356.1205694173392, 300.22182146140403, 357.81829171089214, 278.70243069340756, 446.491222373391, 502.2583160569615, 403.2376136470887, 309.6508665741712, 250.8752209398812, 385.4534588747458, 350.5255886233829, 511.5876214845561, 297.9709908928562, 412.2121485464381, 385.18417586761024, 498.9601268841841, 435.0412249970788, 251.60906429040978, 210.97824365154042, 357.32334101256004, 363.1504125540338, 315.9557041806835, 298.62418151913175, 398.34011433908444, 327.7234269827502, 349.97458656227553, 11.919267331785662, 529.77529942056, 306.1989852650552, 300.0164513963044, 318.883241134502, 238.20533715207839, 422.9711384524092, 242.95071824447632, 354.31771522053606, 476.36200734990996, 417.41634899717616, 455.31478943855365, 256.6056977526203, 272.134284009342, 415.00782946946896, 443.2325273289542, 392.50691484971605, 207.3889493433723, 369.11280532518316, 39.21481333882158, 522.2030236586482, 281.488326114315, 348.0066428592675, 298.40088801526116, 380.540699193004, 304.16838908555707, 327.03573364876297, 405.23612074555797, 356.1816554045459, 431.28154528388677, 41.68848250581175, 400.14067304336857, 405.9393971282245, 366.67791432570755, 372.9375328754788, 347.8097989762193, 374.52608698849383, 292.725134279502, 299.6718746468837, 354.68243026948545, 363.29795120059316, 464.720633467209, 487.54071554556384, 350.70230898165386, 322.28895667881795, 362.09415011745796, 314.02007993520795, 313.0105566460883, 343.19047877184755, 371.6000067688974, 353.8636972760141, 376.52075914748974, 285.9144272249777, 457.7356430449696, 347.9862367525011, 82.11814989641071, 339.37994748086265, 162.11189485297112, 261.43348243319264, 378.1215579050923, 305.31411314441976, 351.15609110342746, 333.45341466914914, 434.507285554237, 299.77103061125223, 308.763169476235, 345.50462529018677, 379.23243646917217, 295.27222302393824, 373.4040349446756, 409.8515565093189, 338.2750542323322, 522.0573032941878, 510.3175666089712, 382.1515464297801, 394.9523429114932, 341.37864753994126, 438.26419173520026, 533.9017864429943, 316.37788073716405, 381.0309310297464, 331.28320916528395, 338.7158701517717, 306.28163902990934, 312.11654065942986, 0.0, 288.89833977000984, 450.06745462241935, 332.9430561102198, 366.8325590217929, 365.7725068383128, 666.681518585245, 428.7894136503432, 319.5859680291174, 299.4758965971595, 314.3480480561689, 420.35072515853847, 499.4306590848286, 436.5720186871659, 287.61607858674466, 268.0246530539898, 217.8983752642438, 385.4769305346569, 464.48148219751454, 296.05273640173135, 385.427265588679, 292.4515922085292, 338.6053205964381, 683.4431188827855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.031991325208853, "mean_inference_ms": 13.818847340052155, "mean_action_processing_ms": 24.22697054848977, "mean_env_wait_ms": 4.3064305025007386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069828033447265625, "StateBufferConnector_ms": 0.20632529258728027, "ViewRequirementAgentConnector_ms": 0.535144567489624}, "num_episodes": 64, "episode_return_max": 309.1415329491785, "episode_return_min": -57.499184105315145, "episode_return_mean": 63.27963598728488, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1358240, "num_agent_steps_trained": 1358240, "num_env_steps_sampled": 339560, "num_env_steps_trained": 339560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 99.42558359783095, "num_env_steps_trained_throughput_per_sec": 99.42558359783095, "timesteps_total": 339560, "num_env_steps_sampled_lifetime": 339560, "num_agent_steps_sampled_lifetime": 1358240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1358240, "timers": {"training_iteration_time_ms": 96369.177, "restore_workers_time_ms": 1.312, "training_step_time_ms": 96359.691, "sample_time_ms": 16604.628, "learn_time_ms": 79165.498, "learn_throughput": 105.551, "synch_weights_time_ms": 514.625}, "counters": {"num_env_steps_sampled": 339560, "num_env_steps_trained": 339560, "num_agent_steps_sampled": 1358240, "num_agent_steps_trained": 1358240}, "done": false, "training_iteration": 43, "trial_id": "cdf01_00000", "date": "2024-08-20_10-58-42", "timestamp": 1724131722, "time_this_iter_s": 80.60931515693665, "time_total_s": 2225.648243665695, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5a1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2225.648243665695, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 97.01565217391307, "ram_util_percent": 83.50434782608694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.194669990501707, "cur_kl_coeff": 1.862645149230957e-10, "cur_lr": 0.0001, "total_loss": 9.056001906924777, "policy_loss": -0.0028550572959440096, "vf_loss": 9.058856976221477, "vf_explained_var": -0.2466132314432235, "kl": 0.0018895471445422652, "entropy": 0.1879920029805766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 27055.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4562911625892396, "cur_kl_coeff": 3.8146972656249997e-07, "cur_lr": 0.0001, "total_loss": 8.239932037535167, "policy_loss": -0.0041586723095471305, "vf_loss": 8.244090716044107, "vf_explained_var": 0.42887704533243937, "kl": 0.004962553588350039, "entropy": 0.36478998902298154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 27055.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 347560, "num_env_steps_trained": 347560, "num_agent_steps_sampled": 1390240, "num_agent_steps_trained": 1390240}, "env_runners": {"episode_reward_max": 309.1415329491785, "episode_reward_min": -20.096115370445432, "episode_reward_mean": 66.08087494380575, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -678.0291911824386, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 31.197227448488952, "predator_policy": 683.4431188827855}, "policy_reward_mean": {"prey_policy": -320.43657014149585, "predator_policy": 353.47700761339877}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.220446049250313e-16, 290.7647935577387, 300.06745350931664, 27.599314641830745, 2.4424906541753444e-15, 309.1415329491785, 82.4504831797562, -0.04470311848468711, 5.000000000000002, 56.68207434204874, 74.07128586103781, 2.8000000000000016, 4.440892098500626e-16, 57.680213064883304, 157.81985028511204, 11.46856217045771, 201.04712036806646, 27.08126808592331, 205.12236000930454, 97.28879469093063, 259.3089081000969, 142.37547087874205, 46.383304940856085, 105.12391959142835, 8.982704345854739, 2.7380031757921683, 6.047326077942509, 259.6505514235011, 108.24666131302246, 8.190380023879179, 0.6000000000000012, -4.440892098500626e-16, 19.318619466289913, 38.90000000000014, 62.80848251227731, 239.48138056772208, 9.098474730217516, 40.490484691247076, 81.9343032330281, 37.0722684880502, 86.4674979343864, 6.599999999999991, 0.028139748780854568, 2.8000000000000025, -1.2610846839655845, -5.10702591327572e-15, 164.89116852529745, 59.21481333882178, 2.6000000000000023, 162.1695831033296, 8.881784197001252e-16, 0.3999999999999986, 60.780879743062115, 0.10000000000000098, -0.9514613369453604, 0.2000000000000033, 6.721140814446609, 14.624475388113249, 14.141396537573222, 277.4568279619532, -10.465043213699262, -1.0222125958292319, 3.837408339596184, 306.7071448513545, 119.80433816825776, 45.131267361915675, 125.83166847688554, -20.096115370445432, 38.69612747489058, 51.45955596795052, 161.99627921931207, 36.6006145047144, 239.36657014761516, 193.3332793611617, -2.6645352591003757e-15, 0.8417695601271287, -1.5432161228537153, 0.6000000000000001, 9.933727235142962, 6.525367736375784, 18.825706739411018, 47.166302694093304, 10.864666697041251, 1.3322676295501878e-15, 4.7534749313939475, 0.20000000000000107, -2.5430373576553187, 242.38274954625132, 17.290139787432295, 149.95705215057538, 12.229853251603263, 119.27282413713633, 1.7763568394002505e-15, -1.5543122344752192e-15, -0.1686106252281121, 51.499825315519715, 30.911715410958944, 71.3052874240992, 286.6477143944483, 0.17827454911878982], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-448.9631160365854, -326.7601898643434, -350.84625033451675, -39.94374029457895, -383.235658102041, -9.834031814119793, -267.44617957135245, -216.23399932709663, -353.680495728239, -344.24638049436066, -100.17977103279077, -507.1890938685693, -168.77095838237238, -522.8576234935814, -389.9411725402291, -309.22690937043734, -321.52448939549305, -385.1338937575985, -285.8084972278577, -409.7061532810259, -295.9080154240502, -535.1722833635783, -317.85967198184767, -354.38748081270313, -366.5677498604433, -397.736324921316, -326.21181874103405, -206.03600828733212, -159.89226869245363, -328.6059074397803, -347.5734334661165, -244.6460722712832, -109.91886934250607, -385.2658880084804, -338.69638694895394, -464.7278277543436, -4.894424858239386, -526.2512824128744, -505.3980764098568, -172.3890531817503, -104.39167687332751, -408.512538749247, 31.197227448488952, -368.81848373544744, -470.4643732441531, -452.94281346837175, -381.5010928359787, -307.83561232482305, -57.01930180916506, -324.06910171492524, -297.59916839714316, -357.7029415993608, -272.94521331187656, -446.20111367697854, -156.1895312266033, -489.6558470539471, -465.8429663129246, 13.563540111895065, -393.28431586122247, -334.5043516130264, -511.5876214845561, -297.3709908928562, -412.2121485464381, -385.18417586761024, -521.6494397862715, -393.03329262870176, -232.80906429040985, -190.87824365154083, -366.00074727807606, -291.66452377623983, -7.316246274679498, -367.7822588574125, -406.67422044989024, -310.2908461417267, -349.87648621264077, 28.47311700982649, -529.6639967438481, -224.3759847087395, -267.5081507759345, -314.3192732668219, -272.6921613885733, -302.01681628152824, -236.3507182444767, -354.31771522053606, -476.36200734990996, -417.3882092483953, -455.31478943855365, -253.8056977526203, -303.7690200185151, -384.6341781442603, -443.2325273289542, -392.50691484971605, 15.43102871968568, -427.0416148629427, 20.000000000000014, -522.2030236586482, -279.58832611431507, -347.3066428592675, -159.5616568931679, -357.2103472117671, -304.16838908555707, -327.03573364876297, -404.83612074555793, -356.1816554045459, -430.4544321586913, 18.265284112054847, -400.14067304336857, -405.8393971282245, -373.1586616028843, -367.40824693524735, -347.6097989762193, -374.52608698849383, -281.8077882126924, -303.8680798992464, -328.9110532303163, -374.4448528516489, -428.8180213290893, -509.3019311461093, 29.54892518556511, -425.0833628840837, -347.9819603843165, -338.5973128820492, -341.1050776820785, -316.11817033168717, -363.04495405093127, -358.5813416543848, -183.16323171143958, -172.56480980967362, -173.79995272894902, -512.1175889002653, -269.24864909098187, -107.11818092437785, 14.465293047823222, -312.1790018571012, -342.2668426093997, -361.26494381055824, -370.98826419950274, -274.9251140981823, -438.3159650670677, -244.50279513047087, -128.15041219632397, -364.1211033507854, -241.9022062640198, -396.001838724376, -84.08752931651927, -459.80149198985924, -502.6744757783668, -164.32460238699258, -510.3175666089712, -382.1515464297801, -394.91057335136605, -340.5786475399413, -440.97462443686595, -532.7345698641823, -315.87788073716405, -380.9309310297464, -346.0015331936654, -314.06381888824734, -305.3816390299093, -306.4911729230542, 17.925706739411005, -287.9983397700098, -397.832075846633, -338.0121321919129, -360.5424742822164, -361.19792488084795, -666.681518585245, -428.7894136503432, -283.463031706482, -330.8453579884007, -314.1480480561689, -420.35072515853847, -473.4259124315101, -465.11980269813927, -4.555463919177775, -308.7025181753042, -209.65495558272525, -376.4302104287432, -79.59640838435425, -530.9807580643162, -385.3359271469688, -280.3130773986363, -645.4198872063718, -257.3557281357142, -473.77728866481283, -501.3666803796603, -322.03840267690714, -317.3144174121527, -351.39366107128825, -334.73828695179685, -52.80525177095205, -402.9935501822469, -325.3472872758436, 20.000000000000014, -459.20510435880686, -149.15228116725046, 11.913277543670745, -402.91332721745164, -462.6664295777271, -678.0291911824386], "policy_predator_policy_reward": [448.9631160365854, 326.7601898643434, 342.7341154990437, 338.82066868779134, 377.7228274066518, 315.41431601882573, 268.5399856453422, 242.73950789493705, 353.680495728239, 344.24638049436066, 429.5335267540403, 486.97687109649814, 315.0956249662907, 458.9834400894196, 390.1411725402291, 308.9822062519527, 390.13389375759857, 321.52448939549305, 288.69084447593644, 463.5058803749957, 379.52447171175305, 525.6271129369153, 317.85967198184767, 357.18748081270314, 366.5677498604433, 397.736324921316, 295.1301115167173, 294.7979285765317, 312.777686885794, 333.5403395315522, 295.006176336848, 308.6818915710094, 356.60774175854505, 339.62413596050857, 387.48384747276936, 443.02163531645124, 401.63498969422636, 334.6330775861939, 380.523220009976, 394.5527042725617, 373.3400633727966, 398.8730603498737, 140.26556446686723, 339.7311626988337, 393.02355200515046, 576.7669396482303, 357.75387351122407, 436.70675124100615, 33.95053845260558, 356.1205694173392, 300.22182146140403, 357.81829171089214, 278.70243069340756, 446.491222373391, 502.2583160569615, 403.2376136470887, 309.6508665741712, 250.8752209398812, 385.4534588747458, 350.5255886233829, 511.5876214845561, 297.9709908928562, 412.2121485464381, 385.18417586761024, 498.9601268841841, 435.0412249970788, 251.60906429040978, 210.97824365154042, 357.32334101256004, 363.1504125540338, 315.9557041806835, 298.62418151913175, 398.34011433908444, 327.7234269827502, 349.97458656227553, 11.919267331785662, 529.77529942056, 306.1989852650552, 300.0164513963044, 318.883241134502, 238.20533715207839, 422.9711384524092, 242.95071824447632, 354.31771522053606, 476.36200734990996, 417.41634899717616, 455.31478943855365, 256.6056977526203, 272.134284009342, 415.00782946946896, 443.2325273289542, 392.50691484971605, 207.3889493433723, 369.11280532518316, 39.21481333882158, 522.2030236586482, 281.488326114315, 348.0066428592675, 298.40088801526116, 380.540699193004, 304.16838908555707, 327.03573364876297, 405.23612074555797, 356.1816554045459, 431.28154528388677, 41.68848250581175, 400.14067304336857, 405.9393971282245, 366.67791432570755, 372.9375328754788, 347.8097989762193, 374.52608698849383, 292.725134279502, 299.6718746468837, 354.68243026948545, 363.29795120059316, 464.720633467209, 487.54071554556384, 350.70230898165386, 322.28895667881795, 362.09415011745796, 314.02007993520795, 313.0105566460883, 343.19047877184755, 371.6000067688974, 353.8636972760141, 376.52075914748974, 285.9144272249777, 457.7356430449696, 347.9862367525011, 82.11814989641071, 339.37994748086265, 162.11189485297112, 261.43348243319264, 378.1215579050923, 305.31411314441976, 351.15609110342746, 333.45341466914914, 434.507285554237, 299.77103061125223, 308.763169476235, 345.50462529018677, 379.23243646917217, 295.27222302393824, 373.4040349446756, 409.8515565093189, 338.2750542323322, 522.0573032941878, 510.3175666089712, 382.1515464297801, 394.9523429114932, 341.37864753994126, 438.26419173520026, 533.9017864429943, 316.37788073716405, 381.0309310297464, 331.28320916528395, 338.7158701517717, 306.28163902990934, 312.11654065942986, 0.0, 288.89833977000984, 450.06745462241935, 332.9430561102198, 366.8325590217929, 365.7725068383128, 666.681518585245, 428.7894136503432, 319.5859680291174, 299.4758965971595, 314.3480480561689, 420.35072515853847, 499.4306590848286, 436.5720186871659, 287.61607858674466, 268.0246530539898, 217.8983752642438, 385.4769305346569, 464.48148219751454, 296.05273640173135, 385.427265588679, 292.4515922085292, 338.6053205964381, 683.4431188827855, 473.77728866481283, 501.3666803796603, 322.03840267690714, 317.3144174121527, 348.9214141331785, 337.0419232646785, 103.90507708647161, 403.393550182247, 325.3472872758436, 10.911715410958923, 317.4218088959929, 362.2408640541632, 308.0624060042705, 369.58535806395963, 462.8447041268459, 678.0291911824386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.163727942343767, "mean_inference_ms": 13.796404726832076, "mean_action_processing_ms": 24.109975255785354, "mean_env_wait_ms": 4.25576737832591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007164478302001953, "StateBufferConnector_ms": 0.2008042335510254, "ViewRequirementAgentConnector_ms": 0.5295634269714355}, "num_episodes": 8, "episode_return_max": 309.1415329491785, "episode_return_min": -20.096115370445432, "episode_return_mean": 66.08087494380575, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1390240, "num_agent_steps_trained": 1390240, "num_env_steps_sampled": 347560, "num_env_steps_trained": 347560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 206.8201866107479, "num_env_steps_trained_throughput_per_sec": 206.8201866107479, "timesteps_total": 347560, "num_env_steps_sampled_lifetime": 347560, "num_agent_steps_sampled_lifetime": 1390240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1390240, "timers": {"training_iteration_time_ms": 95031.084, "restore_workers_time_ms": 1.244, "training_step_time_ms": 95021.959, "sample_time_ms": 15772.37, "learn_time_ms": 78675.124, "learn_throughput": 106.209, "synch_weights_time_ms": 500.853}, "counters": {"num_env_steps_sampled": 347560, "num_env_steps_trained": 347560, "num_agent_steps_sampled": 1390240, "num_agent_steps_trained": 1390240}, "done": false, "training_iteration": 44, "trial_id": "cdf01_00000", "date": "2024-08-20_10-59-21", "timestamp": 1724131761, "time_this_iter_s": 38.728206634521484, "time_total_s": 2264.3764503002167, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52ab430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2264.3764503002167, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 69.39090909090909, "ram_util_percent": 83.43272727272729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.418090599680704, "cur_kl_coeff": 9.313225746154784e-11, "cur_lr": 0.0001, "total_loss": 8.872263451228067, "policy_loss": -0.0035119015084106534, "vf_loss": 8.875775364467076, "vf_explained_var": -0.32643324685475184, "kl": 0.002781615043404094, "entropy": 0.19031482893559667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 27685.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.165151181485918, "cur_kl_coeff": 1.9073486328124998e-07, "cur_lr": 0.0001, "total_loss": 8.470423684801375, "policy_loss": -0.005032365793170082, "vf_loss": 8.475456052356297, "vf_explained_var": 0.31507489756932333, "kl": 0.005244602127824316, "entropy": 0.3296281683066535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 27685.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 355560, "num_env_steps_trained": 355560, "num_agent_steps_sampled": 1422240, "num_agent_steps_trained": 1422240}, "env_runners": {"episode_reward_max": 497.98779258342165, "episode_reward_min": -69.90614304069918, "episode_reward_mean": 89.22193879083825, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -882.5213436742994, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.14873215738555, "predator_policy": 862.0117081657714}, "policy_reward_mean": {"prey_policy": -316.7131876349398, "predator_policy": 361.324157030359}, "custom_metrics": {}, "hist_stats": {"episode_reward": [119.80433816825776, 45.131267361915675, 125.83166847688554, -20.096115370445432, 38.69612747489058, 51.45955596795052, 161.99627921931207, 36.6006145047144, 239.36657014761516, 193.3332793611617, -2.6645352591003757e-15, 0.8417695601271287, -1.5432161228537153, 0.6000000000000001, 9.933727235142962, 6.525367736375784, 18.825706739411018, 47.166302694093304, 10.864666697041251, 1.3322676295501878e-15, 4.7534749313939475, 0.20000000000000107, -2.5430373576553187, 242.38274954625132, 17.290139787432295, 149.95705215057538, 12.229853251603263, 119.27282413713633, 1.7763568394002505e-15, -1.5543122344752192e-15, -0.1686106252281121, 51.499825315519715, 30.911715410958944, 71.3052874240992, 286.6477143944483, 0.17827454911878982, 43.2308767968359, 226.15774961172423, 2.4000000000000017, 76.11664736582934, 1.7718748395295014, 278.37804863409684, 170.37097755472251, 6.178489171325788, 186.88775670542242, 146.4926619372371, 1.1490103418139936, 43.06536638420413, 191.528542940629, 169.77671685100754, 1.9984014443252818e-15, 113.97829463961116, 57.36190741143162, 6.800000000000001, -69.90614304069918, 497.98779258342165, 6.933044429962742, 40.61229114318913, 85.33902883490644, -4.186288064266165, 179.4342190892679, 31.796624157656414, 379.29012265836803, 259.774547983494, 160.5919495292482, 112.36800238002749, 21.08873812903715, 206.11265467585318, 2.8844227476665587, 71.16371256714383, 299.91206979269316, 258.6650127657156, 5.6, 5.528235893608727, 0.15635686507919555, -8.881784197001252e-16, 268.656431220588, 73.46587107801825, 11.217711158977089, 158.54703051104704, 13.930704637606157, 6.745536395272488, 306.74572177050715, 202.0725338004508, 105.6774104180682, 0.20000000000000462, 31.196372646904358, 164.29392578246424, 218.47970506107146, 90.89559669883252, 1.3433044791682907, 265.4897208334041, 3.900000000000003, 63.11784479512819, 4.893025280901805, 5.5845141010697255, 209.49246911781324, 336.47814856370263, 35.70514422247323, 2.018667436309908], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-173.79995272894902, -512.1175889002653, -269.24864909098187, -107.11818092437785, 14.465293047823222, -312.1790018571012, -342.2668426093997, -361.26494381055824, -370.98826419950274, -274.9251140981823, -438.3159650670677, -244.50279513047087, -128.15041219632397, -364.1211033507854, -241.9022062640198, -396.001838724376, -84.08752931651927, -459.80149198985924, -502.6744757783668, -164.32460238699258, -510.3175666089712, -382.1515464297801, -394.91057335136605, -340.5786475399413, -440.97462443686595, -532.7345698641823, -315.87788073716405, -380.9309310297464, -346.0015331936654, -314.06381888824734, -305.3816390299093, -306.4911729230542, 17.925706739411005, -287.9983397700098, -397.832075846633, -338.0121321919129, -360.5424742822164, -361.19792488084795, -666.681518585245, -428.7894136503432, -283.463031706482, -330.8453579884007, -314.1480480561689, -420.35072515853847, -473.4259124315101, -465.11980269813927, -4.555463919177775, -308.7025181753042, -209.65495558272525, -376.4302104287432, -79.59640838435425, -530.9807580643162, -385.3359271469688, -280.3130773986363, -645.4198872063718, -257.3557281357142, -473.77728866481283, -501.3666803796603, -322.03840267690714, -317.3144174121527, -351.39366107128825, -334.73828695179685, -52.80525177095205, -402.9935501822469, -325.3472872758436, 20.000000000000014, -459.20510435880686, -149.15228116725046, 11.913277543670745, -402.91332721745164, -462.6664295777271, -678.0291911824386, -185.74023846013174, -351.30022239788923, -645.9030865100935, -12.050101097191547, -365.6327981760418, -310.5914536633075, -700.3035467117705, 5.94427261193375, -466.5275572370812, -379.4962617982492, -1.6772567830126945, -882.5213436742994, -153.32276228261486, -385.513995791016, -477.4036943181923, -297.28612200789496, -478.80464314482595, -64.67577119966796, -56.24158960796344, -335.8499869334033, -453.14751938306034, -334.02879710374, -397.9876936381394, -151.6047472330184, -143.5046901488173, -330.47916504882915, -2.127302541564536, -390.3064309295409, -351.0076677753367, -403.5713864851434, -257.9470767626974, -426.38961009083556, -447.5880919428219, -244.13882718594024, -394.0853693952728, -192.52595201931678, -194.15411811712102, -193.51354978591826, 173.0, -512.7770598633597, -14.151752588743044, -276.1436732294564, -328.2635984678196, -76.67411824107788, -387.3672153567496, -283.8885631930515, -334.1918061471696, -486.96217911031954, -440.5215923224892, -145.37976672985144, -370.4205808292461, -435.5015517576239, 20.643885865683608, -618.9684275315384, -495.5600417919028, 13.637872832693043, -55.572072413636185, -662.2518087807617, -375.76363506183066, -276.17485415406634, -470.74759566409205, -291.0754284902982, -432.8895665852128, -228.71665560046392, -382.05651022278164, -398.6420123772276, -329.38804313641725, -282.74721998209225, -68.73087574945416, -408.805020366294, -522.2954896196702, -38.624699502561064, -314.1878096003214, -257.0898900457986, -458.1140331618844, -392.9532306167938, -496.69605912018415, -439.38757758842286, -312.0034412827166, -476.3186404259833, -414.2800652423968, 20.50092131374198, -130.51906331656213, -316.59670339871195, -396.4746816381605, -254.04823400389807, -689.1982896208215, 6.312518961622642, -319.2392928559059, -97.82693401254427, -676.0383570930998, -328.1711452155562, -378.3924023572281, 198.14873215738555, -296.32393959966294, -424.6534233234845, -404.9939890574354, -149.09471094725257, -660.5831538457244, -373.42323574666085, -118.62019495210727, -253.48322230937126, -158.60120225371315, -475.0805811602879, -649.8438883027158, -99.15412892046173, -461.933603904959, -128.0915610616478, -223.90035236211386, -301.04783429248096, 4.028015059701053, -576.9780817117545, -281.5346846006966, -254.74578161377983, -151.5021339338804, -350.9828494188784, -858.6194869392242, -304.9100237027089, -248.48349291299132, -616.2670852791907, 86.75861907981032, -366.6054288056802, -346.5859683630467, 128.08741677357818, -266.69747200638625, -374.33000483331364, -326.8727591609015, -363.62177677141074], "policy_predator_policy_reward": [457.7356430449696, 347.9862367525011, 82.11814989641071, 339.37994748086265, 162.11189485297112, 261.43348243319264, 378.1215579050923, 305.31411314441976, 351.15609110342746, 333.45341466914914, 434.507285554237, 299.77103061125223, 308.763169476235, 345.50462529018677, 379.23243646917217, 295.27222302393824, 373.4040349446756, 409.8515565093189, 338.2750542323322, 522.0573032941878, 510.3175666089712, 382.1515464297801, 394.9523429114932, 341.37864753994126, 438.26419173520026, 533.9017864429943, 316.37788073716405, 381.0309310297464, 331.28320916528395, 338.7158701517717, 306.28163902990934, 312.11654065942986, 0.0, 288.89833977000984, 450.06745462241935, 332.9430561102198, 366.8325590217929, 365.7725068383128, 666.681518585245, 428.7894136503432, 319.5859680291174, 299.4758965971595, 314.3480480561689, 420.35072515853847, 499.4306590848286, 436.5720186871659, 287.61607858674466, 268.0246530539898, 217.8983752642438, 385.4769305346569, 464.48148219751454, 296.05273640173135, 385.427265588679, 292.4515922085292, 338.6053205964381, 683.4431188827855, 473.77728866481283, 501.3666803796603, 322.03840267690714, 317.3144174121527, 348.9214141331785, 337.0419232646785, 103.90507708647161, 403.393550182247, 325.3472872758436, 10.911715410958923, 317.4218088959929, 362.2408640541632, 308.0624060042705, 369.58535806395963, 462.8447041268459, 678.0291911824386, 228.97111525696684, 351.30022239788923, 608.9881862469969, 275.12275097201336, 365.6327981760418, 312.99145366330805, 700.3035467117705, 70.1723747538959, 466.6994320766107, 381.09626179824954, 862.0117081657714, 300.5649409256364, 325.68395431209626, 383.52378131625693, 483.9390645106748, 296.92924098673734, 424.3818074211829, 305.9863636287341, 265.557010773562, 273.0272277050425, 444.9752882048823, 343.3500386237327, 294.5802897754162, 298.07751747994524, 329.25075818227145, 336.2616399560042, 220.92951005501232, 341.28094026710136, 351.0076677753367, 403.5713864851434, 382.23000653953187, 416.0849749536141, 424.7627641648467, 324.3260623753467, 395.4853693952731, 197.92595201931658, 317.7615248623393, 0.0, 413.5029142356715, 424.2619382111096, 13.688008891219635, 283.5404613569423, 124.19949098787313, 321.350516864213, 387.7481933420746, 368.846614042634, 334.3412662112043, 482.6264309820187, 307.9033824713942, 457.43219567021544, 387.08179370324456, 450.63696304128223, 492.3875225201228, 485.22714180409974, 439.52513997393936, 302.17157696876546, 430.76351339057163, 447.65231733307417, 376.72527306702153, 387.58121852890383, 528.3018551628377, 254.60990712059106, 423.7378997632733, 443.9809770982543, 385.94129436302734, 397.6416509846483, 376.0443846453331, 307.25459104032166, 392.37634548134054, 385.07162042709973, 430.16297709748665, 389.42222479046154, 314.98780960032155, 261.8898900457986, 465.77396892401197, 390.82153074827494, 496.8524159852634, 439.38757758842286, 312.0034412827166, 476.3186404259833, 346.2214086269804, 316.21416652226173, 220.45610529525513, 300.12553249803693, 396.4746816381605, 265.26594516287525, 578.1389815052404, 263.2938196650055, 167.93325200968832, 263.0636794963678, 675.4375804096392, 335.5174582942893, 372.92395095640035, 114.06544101394975, 341.53872372925633, 581.5111729943433, 202.4244888434794, 457.3416215792769, 660.5831538457244, 373.62323574666084, 121.26888328698459, 282.0309066213975, 337.38537679092485, 460.5903324055398, 560.5850472976246, 406.89267498662423, 399.5787074777951, 281.3420541876429, 232.42680644811293, 293.86468468564976, 427.42458266320926, 411.015204822249, 283.0346846006966, 257.14578161377983, 360.62055334942926, 204.9822747984567, 858.1252842061017, 310.29725171673306, 254.06800701406098, 616.2670852791907, 197.63360271679676, 291.7056761268857, 286.76918802071384, 268.20751213245745, 235.55553882603016, 441.1770822361425, 327.8738499878954, 364.63935338072645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.132365718114839, "mean_inference_ms": 13.902383154039669, "mean_action_processing_ms": 23.404904711493238, "mean_env_wait_ms": 4.317506081016911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039246439933776855, "StateBufferConnector_ms": 0.17155003547668457, "ViewRequirementAgentConnector_ms": 0.3954569101333618}, "num_episodes": 64, "episode_return_max": 497.98779258342165, "episode_return_min": -69.90614304069918, "episode_return_mean": 89.22193879083825, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422240, "num_agent_steps_trained": 1422240, "num_env_steps_sampled": 355560, "num_env_steps_trained": 355560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 122.38211632595366, "num_env_steps_trained_throughput_per_sec": 122.38211632595366, "timesteps_total": 355560, "num_env_steps_sampled_lifetime": 355560, "num_agent_steps_sampled_lifetime": 1422240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1422240, "timers": {"training_iteration_time_ms": 86520.822, "restore_workers_time_ms": 1.254, "training_step_time_ms": 86516.315, "sample_time_ms": 14252.179, "learn_time_ms": 72031.357, "learn_throughput": 116.005, "synch_weights_time_ms": 200.354}, "counters": {"num_env_steps_sampled": 355560, "num_env_steps_trained": 355560, "num_agent_steps_sampled": 1422240, "num_agent_steps_trained": 1422240}, "done": false, "training_iteration": 45, "trial_id": "cdf01_00000", "date": "2024-08-20_11-00-26", "timestamp": 1724131826, "time_this_iter_s": 65.4992733001709, "time_total_s": 2329.8757236003876, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5f1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2329.8757236003876, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 92.56195652173913, "ram_util_percent": 83.46739130434783}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.518638069478293, "cur_kl_coeff": 4.656612873077392e-11, "cur_lr": 0.0001, "total_loss": 8.530498090622917, "policy_loss": -0.003323871576936827, "vf_loss": 8.533821973346528, "vf_explained_var": -0.023838327990637884, "kl": 0.001991549070327095, "entropy": 0.20718046845424742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 28315.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.40239316773793, "cur_kl_coeff": 1.9073486328124998e-07, "cur_lr": 0.0001, "total_loss": 8.18161745903984, "policy_loss": -0.005386576423835423, "vf_loss": 8.187004062864515, "vf_explained_var": 0.424318014723914, "kl": 0.00662809061195153, "entropy": 0.39221840458256857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 28315.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 363560, "num_env_steps_trained": 363560, "num_agent_steps_sampled": 1454240, "num_agent_steps_trained": 1454240}, "env_runners": {"episode_reward_max": 496.6230848955365, "episode_reward_min": -23.10338761909919, "episode_reward_mean": 107.78160387460822, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -858.6194869392242, "predator_policy": 21.331277879881338}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 858.1252842061017}, "policy_reward_mean": {"prey_policy": -288.9854587503919, "predator_policy": 342.87626068769606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.6, 5.528235893608727, 0.15635686507919555, -8.881784197001252e-16, 268.656431220588, 73.46587107801825, 11.217711158977089, 158.54703051104704, 13.930704637606157, 6.745536395272488, 306.74572177050715, 202.0725338004508, 105.6774104180682, 0.20000000000000462, 31.196372646904358, 164.29392578246424, 218.47970506107146, 90.89559669883252, 1.3433044791682907, 265.4897208334041, 3.900000000000003, 63.11784479512819, 4.893025280901805, 5.5845141010697255, 209.49246911781324, 336.47814856370263, 35.70514422247323, 2.018667436309908, 116.88453968856133, 6.599837609140421, 83.85048675225109, 66.21766309488102, -23.10338761909919, -2.6269329457149446, 23.27299847942048, 74.71668535367729, 46.22704405812741, 86.60354886078, 1.909927930941756, 95.53682970667802, -8.881784197001252e-16, 11.89999999999998, 0.2999999999999996, 126.27578931492717, -9.29095226615068, 212.31972475020376, 55.0037331115316, 11.56981405935191, 47.02973470454663, 213.61300465640846, 318.6131708664393, 0.9999999999999993, 387.8629912654609, 354.8013579208592, 89.95065999885503, 236.12371004879205, 325.9872784625296, 177.66419539578544, 217.32105609703183, 151.11412407170303, 302.0915414977905, 132.6824613182018, 15.8, 45.31782463712784, -0.5642679159569108, 16.955914148700938, -1.9740143021911563, 12.170684871264879, 98.15847339970848, 49.765418082422926, 16.138034375544986, 176.2922428859567, 68.57591356915108, 218.4194330226441, -5.551115123125783e-15, 496.6230848955365, 90.34979305892507, 0.2999999999999956, 410.85766495176847, 102.85319254009444, 122.77491693577437, 304.05104790952373, 13.04168770806099, 237.60825078179477, 234.9631738474811, 207.64405528634762, 4.440892098500626e-16, -21.677450203167147, 24.372897079757262, 471.8220549411676, 8.074790280429726, 2.4000000000000004, 67.31532402078199, 223.3837925964635, 78.38331406957798, 3.700000000000002, 40.664214383068206, 8.881784197001252e-16, 249.0259214824147, 163.11838510826925], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-314.1878096003214, -257.0898900457986, -458.1140331618844, -392.9532306167938, -496.69605912018415, -439.38757758842286, -312.0034412827166, -476.3186404259833, -414.2800652423968, 20.50092131374198, -130.51906331656213, -316.59670339871195, -396.4746816381605, -254.04823400389807, -689.1982896208215, 6.312518961622642, -319.2392928559059, -97.82693401254427, -676.0383570930998, -328.1711452155562, -378.3924023572281, 198.14873215738555, -296.32393959966294, -424.6534233234845, -404.9939890574354, -149.09471094725257, -660.5831538457244, -373.42323574666085, -118.62019495210727, -253.48322230937126, -158.60120225371315, -475.0805811602879, -649.8438883027158, -99.15412892046173, -461.933603904959, -128.0915610616478, -223.90035236211386, -301.04783429248096, 4.028015059701053, -576.9780817117545, -281.5346846006966, -254.74578161377983, -151.5021339338804, -350.9828494188784, -858.6194869392242, -304.9100237027089, -248.48349291299132, -616.2670852791907, 86.75861907981032, -366.6054288056802, -346.5859683630467, 128.08741677357818, -266.69747200638625, -374.33000483331364, -326.8727591609015, -363.62177677141074, -193.77337665492098, -101.97004473825682, -390.4088631944545, -339.3209354688853, -317.74105595663974, -351.3105679697105, -185.46800209290117, -501.6129360618556, -373.4824512732472, -110.00723437910965, -379.19625974407563, -432.4689083752989, -554.7980641665099, -273.68196594634486, -146.30362217348252, -471.18685052351515, 23.493632230896708, -337.1673789300955, 11.443497018922592, -379.68905098633155, -260.98618954968146, -410.87857120154797, -134.8636903406939, -568.8316097575093, -401.7405128600374, -438.8073158002237, -206.71079137436587, -280.9709329392134, -403.9044191190697, -299.7154562761596, -30.39992351290838, -455.8757557016494, -215.92299523559933, -263.0877060108517, 7.3750079958095665, -528.9677404726349, -43.946302414661076, -426.83119299074144, -252.0591925182013, -171.69884053019678, -188.2379218756185, -383.755624151923, -122.2350233101775, -453.4874006465164, -547.7766123325601, -98.50955758900615, -319.81217417774747, -354.3482503253426, -546.8682469582683, -84.63955569050178, 180.3889292683213, -511.53882912655763, -308.97420064501875, -259.18781578956674, -211.30528554612454, -370.74815138305496, -560.9385018136635, -1.1153082316579375, -533.1784132666711, -29.775495555569, 12.15481935964127, -292.3650297496711, -117.90553200636867, -370.6674885724665, -633.7931353855545, -27.901252076703848, -250.12586806185217, -378.2415133584467, -264.93717172451153, -204.2166479947665, 8.054961404338403, -451.1569678519547, -422.5620811397163, -449.2908315041553, -397.97770786577945, -87.00249919462249, -327.5028215873268, -450.26697944777726, -283.94295003086216, -331.85720000453784, -14.714839906391962, -379.0679782111104, -187.73128725899647, -74.60429011606718, -294.4041934402556, -373.5134984114081, -37.59645221886503, -586.3091275872009, -39.63665044062986, -421.80029334948756, -136.96719990558947, -342.5800421529044, -340.83436592250104, -306.65870830269427, -463.83215813816514, 200.0, -399.41652459636873, -261.56528352159785, -377.5971697857538, -308.16731001129176, 12.75345233392986, -513.5004247390307, -290.9703600512877, -294.077191885813, -241.33422868045562, -476.7077328698588, -661.8118282987633, -68.91104178330028, -259.78247305357337, -275.1165862605197, 11.696607541713464, -366.02354996989726, 131.9619368985884, -340.4316996900153, -455.5132969766767, 14.113311612669822, -458.482916457785, -456.61648661319265, -401.2719860250103, -181.2781320254844, -268.10878393126615, -100.33611782614375, 187.73183389739026, -341.8072135422076, -382.5612274263856, -354.19453782741516, -291.98093913165735, -381.8077868089125, -384.94929747490306, -349.235463991789, -131.56331100981814, -346.98308503577226, -10.899678096237373, -476.68075000365104, -411.5080376577631, -277.2364053534928, 29.19989011557216, -298.12409440583156, -374.7464517836913, -271.3181725703758, -524.2671835993904, -45.9639638295434, -239.1084029886057, -440.0529842440999], "policy_predator_policy_reward": [314.98780960032155, 261.8898900457986, 465.77396892401197, 390.82153074827494, 496.8524159852634, 439.38757758842286, 312.0034412827166, 476.3186404259833, 346.2214086269804, 316.21416652226173, 220.45610529525513, 300.12553249803693, 396.4746816381605, 265.26594516287525, 578.1389815052404, 263.2938196650055, 167.93325200968832, 263.0636794963678, 675.4375804096392, 335.5174582942893, 372.92395095640035, 114.06544101394975, 341.53872372925633, 581.5111729943433, 202.4244888434794, 457.3416215792769, 660.5831538457244, 373.62323574666084, 121.26888328698459, 282.0309066213975, 337.38537679092485, 460.5903324055398, 560.5850472976246, 406.89267498662423, 399.5787074777951, 281.3420541876429, 232.42680644811293, 293.86468468564976, 427.42458266320926, 411.015204822249, 283.0346846006966, 257.14578161377983, 360.62055334942926, 204.9822747984567, 858.1252842061017, 310.29725171673306, 254.06800701406098, 616.2670852791907, 197.63360271679676, 291.7056761268857, 286.76918802071384, 268.20751213245745, 235.55553882603016, 441.1770822361425, 327.8738499878954, 364.63935338072645, 166.87081443767838, 245.75714664406132, 350.8515447675458, 385.478091504935, 393.6089560805777, 359.29315459802433, 446.46965028761775, 306.8289509620197, 376.9344467658119, 83.45185126744498, 380.41192879020235, 428.626306383457, 571.0710626459303, 280.6819659463448, 341.0102534868627, 351.19690456381153, 22.73341182723066, 337.1673789300955, 156.25815118960716, 298.59095163858217, 262.8961174806238, 410.87857120154797, 282.25560612591937, 516.9765236789611, 401.7405128600374, 438.8073158002237, 216.11079137436585, 283.47093293921324, 403.9044191190697, 300.0154562761596, 175.58702828606897, 436.96444024341685, 196.2313574967394, 273.48839148356046, 222.58752805725257, 511.3249291697779, 115.82971582708221, 409.951512689853, 196.6480333086252, 238.67981379912413, 235.26765658016467, 383.755624151923, 365.72350865069797, 423.61191996240456, 472.1783739019857, 492.7209668860185, 319.81217417774747, 355.3482503253426, 485.79253491504085, 533.5782589991879, 488.8474454913007, 197.10381228779556, 301.42467571230276, 356.68800072113885, 456.93388488166653, 361.2432620963038, 388.37406847050033, 499.6670200373502, 194.65187747940007, 545.9662267386261, 259.20518969090114, 238.3260767961614, 357.9222489049109, 281.76489574562663, 463.37282548394796, 500.4131034761019, 374.33093066716253, 386.7189120713393, 265.0371717245115, 219.91664799476644, 35.56286323278931, 452.85696785195466, 421.9978132237594, 449.2908315041553, 401.60658923195945, 100.32953197714374, 343.6859507402812, 432.10983599263216, 308.7550514152804, 319.21578349138474, 144.3055489935628, 347.6357425236478, 290.7697175776049, 21.331277879881338, 309.54222781580125, 374.5134984114081, 235.41667754843664, 564.7811451435865, 345.6401977928855, 184.37265956638402, 372.1259035753497, 325.840771505788, 340.83436592250104, 306.65870830269427, 405.7898104592794, 354.6654325744218, 474.42342172548877, 276.90817945140316, 377.5971697857538, 308.4673100112918, 447.14341122558073, 464.4612261312864, 223.84517521660206, 464.05556926059376, 398.6735331486765, 442.1433453374116, 603.3899662125249, 431.38395177906136, 283.05437743651646, 264.88636958563836, 237.1982363866865, 354.73695682329407, 131.36804889087986, 312.06488774802824, 379.75384801913145, 269.29019263122416, 458.482916457785, 456.61648661319265, 424.70470457493724, 136.16796327238933, 291.77632772759233, 101.04147110957456, 327.8886204955671, 298.0088140904187, 421.75844047539334, 323.0721150588373, 294.3809391316573, 381.8077868089125, 382.45595244155015, 419.04413304592424, 279.1142205073805, 422.81596813467667, 187.12792381031318, 378.8358183591527, 411.90803765776315, 280.53640535349285, 180.6006622992383, 128.9877563740891, 374.7464517836913, 271.3181725703758, 366.67772156016116, 452.5793473511882, 463.46523385817494, 378.81453848279943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.932984028467818, "mean_inference_ms": 13.694852294784386, "mean_action_processing_ms": 22.805016409516302, "mean_env_wait_ms": 4.25823818045641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01413583755493164, "StateBufferConnector_ms": 0.05312693119049072, "ViewRequirementAgentConnector_ms": 0.17245173454284668}, "num_episodes": 72, "episode_return_max": 496.6230848955365, "episode_return_min": -23.10338761909919, "episode_return_mean": 107.78160387460822, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1454240, "num_agent_steps_trained": 1454240, "num_env_steps_sampled": 363560, "num_env_steps_trained": 363560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 199.31138369888262, "num_env_steps_trained_throughput_per_sec": 199.31138369888262, "timesteps_total": 363560, "num_env_steps_sampled_lifetime": 363560, "num_agent_steps_sampled_lifetime": 1454240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1454240, "timers": {"training_iteration_time_ms": 55843.139, "restore_workers_time_ms": 0.153, "training_step_time_ms": 55841.311, "sample_time_ms": 5816.26, "learn_time_ms": 49823.744, "learn_throughput": 160.566, "synch_weights_time_ms": 184.143}, "counters": {"num_env_steps_sampled": 363560, "num_env_steps_trained": 363560, "num_agent_steps_sampled": 1454240, "num_agent_steps_trained": 1454240}, "done": false, "training_iteration": 46, "trial_id": "cdf01_00000", "date": "2024-08-20_11-01-07", "timestamp": 1724131867, "time_this_iter_s": 40.24155378341675, "time_total_s": 2370.1172773838043, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e3c280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2370.1172773838043, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 72.44561403508771, "ram_util_percent": 83.00877192982456}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.427679177503737, "cur_kl_coeff": 2.328306436538696e-11, "cur_lr": 0.0001, "total_loss": 8.70721398232475, "policy_loss": -0.00471697209092478, "vf_loss": 8.711930991732885, "vf_explained_var": -0.2661711763767969, "kl": 0.0033868534999313966, "entropy": 0.18467060698876306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 28945.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.723537063977075, "cur_kl_coeff": 1.9073486328124998e-07, "cur_lr": 0.0001, "total_loss": 8.821446819910927, "policy_loss": -0.004354299001011347, "vf_loss": 8.825801154545376, "vf_explained_var": 0.3325365653113713, "kl": 0.004723769777180699, "entropy": 0.3569978415966034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 28945.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 371560, "num_env_steps_trained": 371560, "num_agent_steps_sampled": 1486240, "num_agent_steps_trained": 1486240}, "env_runners": {"episode_reward_max": 496.6230848955365, "episode_reward_min": -23.10338761909919, "episode_reward_mean": 107.78160387460822, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -858.6194869392242, "predator_policy": 21.331277879881338}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 858.1252842061017}, "policy_reward_mean": {"prey_policy": -288.9854587503919, "predator_policy": 342.87626068769606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.6, 5.528235893608727, 0.15635686507919555, -8.881784197001252e-16, 268.656431220588, 73.46587107801825, 11.217711158977089, 158.54703051104704, 13.930704637606157, 6.745536395272488, 306.74572177050715, 202.0725338004508, 105.6774104180682, 0.20000000000000462, 31.196372646904358, 164.29392578246424, 218.47970506107146, 90.89559669883252, 1.3433044791682907, 265.4897208334041, 3.900000000000003, 63.11784479512819, 4.893025280901805, 5.5845141010697255, 209.49246911781324, 336.47814856370263, 35.70514422247323, 2.018667436309908, 116.88453968856133, 6.599837609140421, 83.85048675225109, 66.21766309488102, -23.10338761909919, -2.6269329457149446, 23.27299847942048, 74.71668535367729, 46.22704405812741, 86.60354886078, 1.909927930941756, 95.53682970667802, -8.881784197001252e-16, 11.89999999999998, 0.2999999999999996, 126.27578931492717, -9.29095226615068, 212.31972475020376, 55.0037331115316, 11.56981405935191, 47.02973470454663, 213.61300465640846, 318.6131708664393, 0.9999999999999993, 387.8629912654609, 354.8013579208592, 89.95065999885503, 236.12371004879205, 325.9872784625296, 177.66419539578544, 217.32105609703183, 151.11412407170303, 302.0915414977905, 132.6824613182018, 15.8, 45.31782463712784, -0.5642679159569108, 16.955914148700938, -1.9740143021911563, 12.170684871264879, 98.15847339970848, 49.765418082422926, 16.138034375544986, 176.2922428859567, 68.57591356915108, 218.4194330226441, -5.551115123125783e-15, 496.6230848955365, 90.34979305892507, 0.2999999999999956, 410.85766495176847, 102.85319254009444, 122.77491693577437, 304.05104790952373, 13.04168770806099, 237.60825078179477, 234.9631738474811, 207.64405528634762, 4.440892098500626e-16, -21.677450203167147, 24.372897079757262, 471.8220549411676, 8.074790280429726, 2.4000000000000004, 67.31532402078199, 223.3837925964635, 78.38331406957798, 3.700000000000002, 40.664214383068206, 8.881784197001252e-16, 249.0259214824147, 163.11838510826925], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-314.1878096003214, -257.0898900457986, -458.1140331618844, -392.9532306167938, -496.69605912018415, -439.38757758842286, -312.0034412827166, -476.3186404259833, -414.2800652423968, 20.50092131374198, -130.51906331656213, -316.59670339871195, -396.4746816381605, -254.04823400389807, -689.1982896208215, 6.312518961622642, -319.2392928559059, -97.82693401254427, -676.0383570930998, -328.1711452155562, -378.3924023572281, 198.14873215738555, -296.32393959966294, -424.6534233234845, -404.9939890574354, -149.09471094725257, -660.5831538457244, -373.42323574666085, -118.62019495210727, -253.48322230937126, -158.60120225371315, -475.0805811602879, -649.8438883027158, -99.15412892046173, -461.933603904959, -128.0915610616478, -223.90035236211386, -301.04783429248096, 4.028015059701053, -576.9780817117545, -281.5346846006966, -254.74578161377983, -151.5021339338804, -350.9828494188784, -858.6194869392242, -304.9100237027089, -248.48349291299132, -616.2670852791907, 86.75861907981032, -366.6054288056802, -346.5859683630467, 128.08741677357818, -266.69747200638625, -374.33000483331364, -326.8727591609015, -363.62177677141074, -193.77337665492098, -101.97004473825682, -390.4088631944545, -339.3209354688853, -317.74105595663974, -351.3105679697105, -185.46800209290117, -501.6129360618556, -373.4824512732472, -110.00723437910965, -379.19625974407563, -432.4689083752989, -554.7980641665099, -273.68196594634486, -146.30362217348252, -471.18685052351515, 23.493632230896708, -337.1673789300955, 11.443497018922592, -379.68905098633155, -260.98618954968146, -410.87857120154797, -134.8636903406939, -568.8316097575093, -401.7405128600374, -438.8073158002237, -206.71079137436587, -280.9709329392134, -403.9044191190697, -299.7154562761596, -30.39992351290838, -455.8757557016494, -215.92299523559933, -263.0877060108517, 7.3750079958095665, -528.9677404726349, -43.946302414661076, -426.83119299074144, -252.0591925182013, -171.69884053019678, -188.2379218756185, -383.755624151923, -122.2350233101775, -453.4874006465164, -547.7766123325601, -98.50955758900615, -319.81217417774747, -354.3482503253426, -546.8682469582683, -84.63955569050178, 180.3889292683213, -511.53882912655763, -308.97420064501875, -259.18781578956674, -211.30528554612454, -370.74815138305496, -560.9385018136635, -1.1153082316579375, -533.1784132666711, -29.775495555569, 12.15481935964127, -292.3650297496711, -117.90553200636867, -370.6674885724665, -633.7931353855545, -27.901252076703848, -250.12586806185217, -378.2415133584467, -264.93717172451153, -204.2166479947665, 8.054961404338403, -451.1569678519547, -422.5620811397163, -449.2908315041553, -397.97770786577945, -87.00249919462249, -327.5028215873268, -450.26697944777726, -283.94295003086216, -331.85720000453784, -14.714839906391962, -379.0679782111104, -187.73128725899647, -74.60429011606718, -294.4041934402556, -373.5134984114081, -37.59645221886503, -586.3091275872009, -39.63665044062986, -421.80029334948756, -136.96719990558947, -342.5800421529044, -340.83436592250104, -306.65870830269427, -463.83215813816514, 200.0, -399.41652459636873, -261.56528352159785, -377.5971697857538, -308.16731001129176, 12.75345233392986, -513.5004247390307, -290.9703600512877, -294.077191885813, -241.33422868045562, -476.7077328698588, -661.8118282987633, -68.91104178330028, -259.78247305357337, -275.1165862605197, 11.696607541713464, -366.02354996989726, 131.9619368985884, -340.4316996900153, -455.5132969766767, 14.113311612669822, -458.482916457785, -456.61648661319265, -401.2719860250103, -181.2781320254844, -268.10878393126615, -100.33611782614375, 187.73183389739026, -341.8072135422076, -382.5612274263856, -354.19453782741516, -291.98093913165735, -381.8077868089125, -384.94929747490306, -349.235463991789, -131.56331100981814, -346.98308503577226, -10.899678096237373, -476.68075000365104, -411.5080376577631, -277.2364053534928, 29.19989011557216, -298.12409440583156, -374.7464517836913, -271.3181725703758, -524.2671835993904, -45.9639638295434, -239.1084029886057, -440.0529842440999], "policy_predator_policy_reward": [314.98780960032155, 261.8898900457986, 465.77396892401197, 390.82153074827494, 496.8524159852634, 439.38757758842286, 312.0034412827166, 476.3186404259833, 346.2214086269804, 316.21416652226173, 220.45610529525513, 300.12553249803693, 396.4746816381605, 265.26594516287525, 578.1389815052404, 263.2938196650055, 167.93325200968832, 263.0636794963678, 675.4375804096392, 335.5174582942893, 372.92395095640035, 114.06544101394975, 341.53872372925633, 581.5111729943433, 202.4244888434794, 457.3416215792769, 660.5831538457244, 373.62323574666084, 121.26888328698459, 282.0309066213975, 337.38537679092485, 460.5903324055398, 560.5850472976246, 406.89267498662423, 399.5787074777951, 281.3420541876429, 232.42680644811293, 293.86468468564976, 427.42458266320926, 411.015204822249, 283.0346846006966, 257.14578161377983, 360.62055334942926, 204.9822747984567, 858.1252842061017, 310.29725171673306, 254.06800701406098, 616.2670852791907, 197.63360271679676, 291.7056761268857, 286.76918802071384, 268.20751213245745, 235.55553882603016, 441.1770822361425, 327.8738499878954, 364.63935338072645, 166.87081443767838, 245.75714664406132, 350.8515447675458, 385.478091504935, 393.6089560805777, 359.29315459802433, 446.46965028761775, 306.8289509620197, 376.9344467658119, 83.45185126744498, 380.41192879020235, 428.626306383457, 571.0710626459303, 280.6819659463448, 341.0102534868627, 351.19690456381153, 22.73341182723066, 337.1673789300955, 156.25815118960716, 298.59095163858217, 262.8961174806238, 410.87857120154797, 282.25560612591937, 516.9765236789611, 401.7405128600374, 438.8073158002237, 216.11079137436585, 283.47093293921324, 403.9044191190697, 300.0154562761596, 175.58702828606897, 436.96444024341685, 196.2313574967394, 273.48839148356046, 222.58752805725257, 511.3249291697779, 115.82971582708221, 409.951512689853, 196.6480333086252, 238.67981379912413, 235.26765658016467, 383.755624151923, 365.72350865069797, 423.61191996240456, 472.1783739019857, 492.7209668860185, 319.81217417774747, 355.3482503253426, 485.79253491504085, 533.5782589991879, 488.8474454913007, 197.10381228779556, 301.42467571230276, 356.68800072113885, 456.93388488166653, 361.2432620963038, 388.37406847050033, 499.6670200373502, 194.65187747940007, 545.9662267386261, 259.20518969090114, 238.3260767961614, 357.9222489049109, 281.76489574562663, 463.37282548394796, 500.4131034761019, 374.33093066716253, 386.7189120713393, 265.0371717245115, 219.91664799476644, 35.56286323278931, 452.85696785195466, 421.9978132237594, 449.2908315041553, 401.60658923195945, 100.32953197714374, 343.6859507402812, 432.10983599263216, 308.7550514152804, 319.21578349138474, 144.3055489935628, 347.6357425236478, 290.7697175776049, 21.331277879881338, 309.54222781580125, 374.5134984114081, 235.41667754843664, 564.7811451435865, 345.6401977928855, 184.37265956638402, 372.1259035753497, 325.840771505788, 340.83436592250104, 306.65870830269427, 405.7898104592794, 354.6654325744218, 474.42342172548877, 276.90817945140316, 377.5971697857538, 308.4673100112918, 447.14341122558073, 464.4612261312864, 223.84517521660206, 464.05556926059376, 398.6735331486765, 442.1433453374116, 603.3899662125249, 431.38395177906136, 283.05437743651646, 264.88636958563836, 237.1982363866865, 354.73695682329407, 131.36804889087986, 312.06488774802824, 379.75384801913145, 269.29019263122416, 458.482916457785, 456.61648661319265, 424.70470457493724, 136.16796327238933, 291.77632772759233, 101.04147110957456, 327.8886204955671, 298.0088140904187, 421.75844047539334, 323.0721150588373, 294.3809391316573, 381.8077868089125, 382.45595244155015, 419.04413304592424, 279.1142205073805, 422.81596813467667, 187.12792381031318, 378.8358183591527, 411.90803765776315, 280.53640535349285, 180.6006622992383, 128.9877563740891, 374.7464517836913, 271.3181725703758, 366.67772156016116, 452.5793473511882, 463.46523385817494, 378.81453848279943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.932984028467818, "mean_inference_ms": 13.694852294784386, "mean_action_processing_ms": 22.805016409516302, "mean_env_wait_ms": 4.25823818045641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01413583755493164, "StateBufferConnector_ms": 0.05312693119049072, "ViewRequirementAgentConnector_ms": 0.17245173454284668}, "num_episodes": 0, "episode_return_max": 496.6230848955365, "episode_return_min": -23.10338761909919, "episode_return_mean": 107.78160387460822, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1486240, "num_agent_steps_trained": 1486240, "num_env_steps_sampled": 371560, "num_env_steps_trained": 371560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 215.9486050738941, "num_env_steps_trained_throughput_per_sec": 215.9486050738941, "timesteps_total": 371560, "num_env_steps_sampled_lifetime": 371560, "num_agent_steps_sampled_lifetime": 1486240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1486240, "timers": {"training_iteration_time_ms": 55347.363, "restore_workers_time_ms": 0.139, "training_step_time_ms": 55345.574, "sample_time_ms": 5476.555, "learn_time_ms": 49671.766, "learn_throughput": 161.057, "synch_weights_time_ms": 180.891}, "counters": {"num_env_steps_sampled": 371560, "num_env_steps_trained": 371560, "num_agent_steps_sampled": 1486240, "num_agent_steps_trained": 1486240}, "done": false, "training_iteration": 47, "trial_id": "cdf01_00000", "date": "2024-08-20_11-01-44", "timestamp": 1724131904, "time_this_iter_s": 37.10597205162048, "time_total_s": 2407.223249435425, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5c9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2407.223249435425, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 69.95961538461539, "ram_util_percent": 83.3596153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.590166759490967, "cur_kl_coeff": 1.164153218269348e-11, "cur_lr": 0.0001, "total_loss": 8.617874754799736, "policy_loss": -0.003109808739215609, "vf_loss": 8.620984592891874, "vf_explained_var": -0.1863544225692749, "kl": 0.00260737404335068, "entropy": 0.18398939343908477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 29575.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.6367230267751784, "cur_kl_coeff": 9.536743164062499e-08, "cur_lr": 0.0001, "total_loss": 8.562852182085551, "policy_loss": -0.0044936752726604775, "vf_loss": 8.567345847023859, "vf_explained_var": 0.33463262385792203, "kl": 0.004312086170428244, "entropy": 0.327367335794464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 29575.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 379560, "num_env_steps_trained": 379560, "num_agent_steps_sampled": 1518240, "num_agent_steps_trained": 1518240}, "env_runners": {"episode_reward_max": 496.6230848955365, "episode_reward_min": -44.60432697340353, "episode_reward_mean": 98.60276806714919, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -721.3355210474841, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 721.3355210474841}, "policy_reward_mean": {"prey_policy": -288.5152297624386, "predator_policy": 337.81661379601326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [68.57591356915108, 218.4194330226441, -5.551115123125783e-15, 496.6230848955365, 90.34979305892507, 0.2999999999999956, 410.85766495176847, 102.85319254009444, 122.77491693577437, 304.05104790952373, 13.04168770806099, 237.60825078179477, 234.9631738474811, 207.64405528634762, 4.440892098500626e-16, -21.677450203167147, 24.372897079757262, 471.8220549411676, 8.074790280429726, 2.4000000000000004, 67.31532402078199, 223.3837925964635, 78.38331406957798, 3.700000000000002, 40.664214383068206, 8.881784197001252e-16, 249.0259214824147, 163.11838510826925, 1.5543122344752192e-15, 126.0573003109374, 187.54631165565223, 10.42763385132682, 194.39482850688037, 86.41167129228873, 24.01529253797102, -44.60432697340353, 25.813695308925645, 191.761138933905, 63.71103623520213, 4.6989479076890674, 74.36935078120366, 118.92571123384899, -2.3328624523376345, 2.406210575736856, 11.275973863340987, 238.2549689453294, 11.653317764672567, 31.95866786486279, 356.5157803317667, 69.57144393478706, -7.3948651553011295, -9.103828801926284e-15, 140.89424886691043, 62.757131910531506, 392.546295114754, 342.8491754100969, 18.594362998387826, 225.8238923666949, 8.190057459149399, 0.13857769057416802, 22.225822699497293, -4.202009475931996, 15.863307564417859, 91.76170885190751, 144.41363947292115, -8.37622485778981, 2.500000000000001, 8.55688864874919, 19.134065526996125, 46.844572497587116, 212.6665122569296, -0.21126428794494423, 104.3955223473906, -6.727366110041973, -1.7763568394002505e-15, 44.163299809958765, 28.446769190264668, 163.25512899672233, 260.6111277127869, 213.98028387338007, 67.62110915881878, 143.6191198420385, 34.40763407955549, 307.80268312318515, 53.5686505752559, 0.4808612321369845, 229.1280106373812, 209.34172121413621, -14.066551512281935, 0.11296445561028756, 5.359755272050011, -25.505927583385386, 100.4108243494326, 16.520884932236253, 237.78909750584648, 2.400000000000003, 57.22952842851878, 1.015644591124536, 293.9761087381042, -6.113524380897305], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-39.63665044062986, -421.80029334948756, -136.96719990558947, -342.5800421529044, -340.83436592250104, -306.65870830269427, -463.83215813816514, 200.0, -399.41652459636873, -261.56528352159785, -377.5971697857538, -308.16731001129176, 12.75345233392986, -513.5004247390307, -290.9703600512877, -294.077191885813, -241.33422868045562, -476.7077328698588, -661.8118282987633, -68.91104178330028, -259.78247305357337, -275.1165862605197, 11.696607541713464, -366.02354996989726, 131.9619368985884, -340.4316996900153, -455.5132969766767, 14.113311612669822, -458.482916457785, -456.61648661319265, -401.2719860250103, -181.2781320254844, -268.10878393126615, -100.33611782614375, 187.73183389739026, -341.8072135422076, -382.5612274263856, -354.19453782741516, -291.98093913165735, -381.8077868089125, -384.94929747490306, -349.235463991789, -131.56331100981814, -346.98308503577226, -10.899678096237373, -476.68075000365104, -411.5080376577631, -277.2364053534928, 29.19989011557216, -298.12409440583156, -374.7464517836913, -271.3181725703758, -524.2671835993904, -45.9639638295434, -239.1084029886057, -440.0529842440999, -721.3355210474841, -491.5684928895898, -290.5146727125178, -168.1156813499156, 147.7346291155268, -454.65020737800677, -308.21254998737675, -459.34845516763244, -95.55552251710273, -348.9777601733077, -68.78740553108683, -470.058472296312, -274.6930950810521, -83.47445673252349, -466.36007490137507, -381.3644850149728, -128.53070372203177, -450.8408672603344, -50.63145004696538, -490.4606630884113, -274.155231370749, -104.30537081880685, -595.4586784315416, -267.49699657850186, -414.2067309755122, -171.53746721183333, -382.3300586076961, -189.31994650007522, -368.584448720763, -316.7968299632586, -334.7406908299227, -310.15363850887434, -273.9138162970666, -456.7270351111529, -341.51462200875767, 0.5930201446393906, -274.18875734853344, -329.5106821925988, -296.6911628183745, -405.72637176806086, 15.162562042440648, -552.8057130987739, -271.22378323266406, -232.51927104501146, -441.6950497210755, -382.8637501417062, -379.24084330388825, -497.6011879176323, -193.71454456293628, -435.47908112441985, -276.9568557677446, -138.50511062839595, -393.7440422336857, 171.8672187201052, -354.96604413135145, 152.34899037122432, -333.1256186852155, -338.0365593258095, -487.7604707119728, -149.0095708679653, -378.1443981994525, -457.08432910536607, -498.2550030151856, -351.6525270092193, -216.510267779422, -565.8596172102264, -308.057772558509, -349.16880247254835, -27.782781307115236, -304.1198347403793, -241.542304864142, -211.14619060647763, -276.31343943078366, -401.2492897866332, -50.330929848851326, -378.558378196235, -348.24663309518957, -318.74527112685143, -385.6300196653939, -156.9566430119876, -117.79587208522035, -131.68593161763965, -332.8377430671585, -290.31140647081105, -541.1228260156114, 132.21156019318977, -341.42303998655973, -383.05326023632443, -269.05799351677, -357.6908737102657, -402.07125953323487, -315.91236077973247, -474.5483588561415, -382.66710579243227, -245.00129774293066, -237.754560498, -277.73972309387, -346.3129276229256, -141.38407054505214, -265.0530018235809, -308.67183595442026, -160.12633602475844, -15.704686126819137, -457.6074895228648, -239.67288272772015, -552.850874977209, -503.62812327676306, -182.55869789770384, -86.67757745411375, -109.03115932416935, -416.36899661160817, 183.80472849224887, -381.11103664199845, -148.6881154171229, -468.7358572712351, -360.68161390700124, -647.7159823929975, 190.29515838094673, -382.151999450849, -4.102814162715488, -385.713043227124, -536.3563485475868, -329.644418491519, -390.58330017988885, -464.70583606595306, -417.8062729053971, -107.01422715897004, -307.1206766940311, -14.043183590438868, -445.2679592028945, -12.953421107559432, -285.50057733802316, -407.767758845244, 16.59588907096076, -532.6600441954268, -321.8621811808832, -502.1716511829801, -139.14228422437628, -458.31134996523554, -326.71794521780555, -347.50184279032106, -177.45615230072437, -526.242208835413, -345.30383349784523], "policy_predator_policy_reward": [345.6401977928855, 184.37265956638402, 372.1259035753497, 325.840771505788, 340.83436592250104, 306.65870830269427, 405.7898104592794, 354.6654325744218, 474.42342172548877, 276.90817945140316, 377.5971697857538, 308.4673100112918, 447.14341122558073, 464.4612261312864, 223.84517521660206, 464.05556926059376, 398.6735331486765, 442.1433453374116, 603.3899662125249, 431.38395177906136, 283.05437743651646, 264.88636958563836, 237.1982363866865, 354.73695682329407, 131.36804889087986, 312.06488774802824, 379.75384801913145, 269.29019263122416, 458.482916457785, 456.61648661319265, 424.70470457493724, 136.16796327238933, 291.77632772759233, 101.04147110957456, 327.8886204955671, 298.0088140904187, 421.75844047539334, 323.0721150588373, 294.3809391316573, 381.8077868089125, 382.45595244155015, 419.04413304592424, 279.1142205073805, 422.81596813467667, 187.12792381031318, 378.8358183591527, 411.90803765776315, 280.53640535349285, 180.6006622992383, 128.9877563740891, 374.7464517836913, 271.3181725703758, 366.67772156016116, 452.5793473511882, 463.46523385817494, 378.81453848279943, 721.3355210474841, 491.5684928895898, 291.0277609024444, 293.65989347092676, 39.33279982323908, 455.1290900948933, 318.64018383870325, 459.34845516763244, 320.92934767467085, 317.9987635226197, 161.8114707306006, 463.4460783890866, 286.75175472711584, 95.43108962443085, 459.9190682334316, 343.2011647095133, 186.48282745331548, 418.70243883797514, 285.32331576742837, 447.5299363018519, 294.1191692332547, 148.05246919150233, 595.4586784315416, 272.1959444861909, 265.45930502530297, 394.6542439432463, 318.7369432816321, 371.83877305998834, 365.216146012919, 317.8322702187648, 335.80872481867283, 311.4918150958616, 285.1897901604097, 456.7270351111529, 338.2846154724294, 240.89195533701908, 286.39392674495633, 328.95883056084824, 328.9342256336467, 405.44197681765286, 427.7736162830879, 466.38531510501105, 299.8412700002463, 273.4732282122165, 354.705111732738, 462.45882297474253, 379.24084330388825, 497.6011879176323, 348.99517657953527, 421.0926979747317, 176.35912831600987, 301.85996999066134, 322.72968753699405, 291.6934310913397, 268.71502063778615, 276.75120853243664, 347.6968481624218, 342.05969284699114, 481.31427879936393, 381.27965514726856, 455.97915058655525, 387.4396341774148, 498.0294117194951, 352.0166959954839, 238.73609047891944, 565.8596172102264, 299.09528056460005, 353.92928499052516, 3.9512565665708776, 343.8146670453419, 329.05527107449575, 215.3949332480315, 414.6953399315731, 407.2810287587665, 41.95470499106162, 378.558378196235, 348.24663309518957, 321.2452711268513, 384.96117843981654, 166.1823728863137, 3.948003970755012, 264.66786525910067, 331.78630058194756, 338.2074214536094, 526.4438630305568, 95.13391504879448, 341.68187273234355, 382.5831632025956, 325.6095021534157, 405.53488742101035, 377.14151000191237, 334.1147442010134, 474.5483588561415, 382.66710579243227, 275.8776488495901, 251.04150920129956, 306.0864922841346, 346.4129276229256, 308.481823345416, 261.21037801993936, 279.1612468428829, 450.2480528490826, 242.26036624791703, 445.03209327514827, 325.2476128662405, 534.8972539975068, 387.8238608565837, 441.98208015992174, 220.49072478524374, 9.62564607259455, 254.43443024304727, 285.93252099949626, 363.12344998697375, 220.24435264740356, 469.21671850337214, 360.68161390700124, 648.1923723590357, 38.356462290396856, 350.8280737263286, 244.7684611013716, 479.35713809997, 428.64570216245977, 329.75738294712926, 390.58330017988885, 520.2214376210849, 367.6504266223155, 0.0, 388.62897626961427, 435.4554383418728, 124.26652880089416, 6.7064688213017245, 308.26841455651675, 374.55004112154364, 254.41092615858736, 532.6600441954268, 324.2621811808838, 503.4239433689339, 195.11952046694094, 458.0207357636225, 328.0242040105432, 344.067486700794, 474.86661712835553, 546.0843842413555, 319.34813371100495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.70239511052846, "mean_inference_ms": 13.438569111136253, "mean_action_processing_ms": 22.096515005597574, "mean_env_wait_ms": 4.19062112278918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01033318042755127, "StateBufferConnector_ms": 0.07785153388977051, "ViewRequirementAgentConnector_ms": 0.369030237197876}, "num_episodes": 72, "episode_return_max": 496.6230848955365, "episode_return_min": -44.60432697340353, "episode_return_mean": 98.60276806714919, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1518240, "num_agent_steps_trained": 1518240, "num_env_steps_sampled": 379560, "num_env_steps_trained": 379560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 215.20154137065532, "num_env_steps_trained_throughput_per_sec": 215.20154137065532, "timesteps_total": 379560, "num_env_steps_sampled_lifetime": 379560, "num_agent_steps_sampled_lifetime": 1518240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1518240, "timers": {"training_iteration_time_ms": 53968.73, "restore_workers_time_ms": 0.139, "training_step_time_ms": 53967.057, "sample_time_ms": 5472.251, "learn_time_ms": 48317.246, "learn_throughput": 165.572, "synch_weights_time_ms": 162.379}, "counters": {"num_env_steps_sampled": 379560, "num_env_steps_trained": 379560, "num_agent_steps_sampled": 1518240, "num_agent_steps_trained": 1518240}, "done": false, "training_iteration": 48, "trial_id": "cdf01_00000", "date": "2024-08-20_11-02-21", "timestamp": 1724131941, "time_this_iter_s": 37.25558590888977, "time_total_s": 2444.4788353443146, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e4b430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2444.4788353443146, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 69.47169811320755, "ram_util_percent": 83.3981132075472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.7822814685957775, "cur_kl_coeff": 5.82076609134674e-12, "cur_lr": 0.0001, "total_loss": 8.690189957997156, "policy_loss": -0.004086621298587748, "vf_loss": 8.694276546296619, "vf_explained_var": -0.11830711033609179, "kl": 0.0024019677492578776, "entropy": 0.1635690967833239, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 30205.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.221560563738384, "cur_kl_coeff": 4.7683715820312496e-08, "cur_lr": 0.0001, "total_loss": 8.564427240311153, "policy_loss": -0.0035329090715903377, "vf_loss": 8.567960229752556, "vf_explained_var": 0.33723063308095175, "kl": 0.0031008561468638617, "entropy": 0.35036366823173704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 30205.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 387560, "num_env_steps_trained": 387560, "num_agent_steps_sampled": 1550240, "num_agent_steps_trained": 1550240}, "env_runners": {"episode_reward_max": 471.8220549411676, "episode_reward_min": -44.60432697340353, "episode_reward_mean": 88.27107262909604, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -721.3355210474841, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.29515838094673, "predator_policy": 721.3355210474841}, "policy_reward_mean": {"prey_policy": -296.1967060631639, "predator_policy": 340.33224237771196}, "custom_metrics": {}, "hist_stats": {"episode_reward": [122.77491693577437, 304.05104790952373, 13.04168770806099, 237.60825078179477, 234.9631738474811, 207.64405528634762, 4.440892098500626e-16, -21.677450203167147, 24.372897079757262, 471.8220549411676, 8.074790280429726, 2.4000000000000004, 67.31532402078199, 223.3837925964635, 78.38331406957798, 3.700000000000002, 40.664214383068206, 8.881784197001252e-16, 249.0259214824147, 163.11838510826925, 1.5543122344752192e-15, 126.0573003109374, 187.54631165565223, 10.42763385132682, 194.39482850688037, 86.41167129228873, 24.01529253797102, -44.60432697340353, 25.813695308925645, 191.761138933905, 63.71103623520213, 4.6989479076890674, 74.36935078120366, 118.92571123384899, -2.3328624523376345, 2.406210575736856, 11.275973863340987, 238.2549689453294, 11.653317764672567, 31.95866786486279, 356.5157803317667, 69.57144393478706, -7.3948651553011295, -9.103828801926284e-15, 140.89424886691043, 62.757131910531506, 392.546295114754, 342.8491754100969, 18.594362998387826, 225.8238923666949, 8.190057459149399, 0.13857769057416802, 22.225822699497293, -4.202009475931996, 15.863307564417859, 91.76170885190751, 144.41363947292115, -8.37622485778981, 2.500000000000001, 8.55688864874919, 19.134065526996125, 46.844572497587116, 212.6665122569296, -0.21126428794494423, 104.3955223473906, -6.727366110041973, -1.7763568394002505e-15, 44.163299809958765, 28.446769190264668, 163.25512899672233, 260.6111277127869, 213.98028387338007, 67.62110915881878, 143.6191198420385, 34.40763407955549, 307.80268312318515, 53.5686505752559, 0.4808612321369845, 229.1280106373812, 209.34172121413621, -14.066551512281935, 0.11296445561028756, 5.359755272050011, -25.505927583385386, 100.4108243494326, 16.520884932236253, 237.78909750584648, 2.400000000000003, 57.22952842851878, 1.015644591124536, 293.9761087381042, -6.113524380897305, 0.1999999999999953, 23.13011611358003, -1.476099536882697, 56.3012604713, 269.04748986825024, 9.10954899607589, -0.4034871831034501, -1.099290496413694], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-241.33422868045562, -476.7077328698588, -661.8118282987633, -68.91104178330028, -259.78247305357337, -275.1165862605197, 11.696607541713464, -366.02354996989726, 131.9619368985884, -340.4316996900153, -455.5132969766767, 14.113311612669822, -458.482916457785, -456.61648661319265, -401.2719860250103, -181.2781320254844, -268.10878393126615, -100.33611782614375, 187.73183389739026, -341.8072135422076, -382.5612274263856, -354.19453782741516, -291.98093913165735, -381.8077868089125, -384.94929747490306, -349.235463991789, -131.56331100981814, -346.98308503577226, -10.899678096237373, -476.68075000365104, -411.5080376577631, -277.2364053534928, 29.19989011557216, -298.12409440583156, -374.7464517836913, -271.3181725703758, -524.2671835993904, -45.9639638295434, -239.1084029886057, -440.0529842440999, -721.3355210474841, -491.5684928895898, -290.5146727125178, -168.1156813499156, 147.7346291155268, -454.65020737800677, -308.21254998737675, -459.34845516763244, -95.55552251710273, -348.9777601733077, -68.78740553108683, -470.058472296312, -274.6930950810521, -83.47445673252349, -466.36007490137507, -381.3644850149728, -128.53070372203177, -450.8408672603344, -50.63145004696538, -490.4606630884113, -274.155231370749, -104.30537081880685, -595.4586784315416, -267.49699657850186, -414.2067309755122, -171.53746721183333, -382.3300586076961, -189.31994650007522, -368.584448720763, -316.7968299632586, -334.7406908299227, -310.15363850887434, -273.9138162970666, -456.7270351111529, -341.51462200875767, 0.5930201446393906, -274.18875734853344, -329.5106821925988, -296.6911628183745, -405.72637176806086, 15.162562042440648, -552.8057130987739, -271.22378323266406, -232.51927104501146, -441.6950497210755, -382.8637501417062, -379.24084330388825, -497.6011879176323, -193.71454456293628, -435.47908112441985, -276.9568557677446, -138.50511062839595, -393.7440422336857, 171.8672187201052, -354.96604413135145, 152.34899037122432, -333.1256186852155, -338.0365593258095, -487.7604707119728, -149.0095708679653, -378.1443981994525, -457.08432910536607, -498.2550030151856, -351.6525270092193, -216.510267779422, -565.8596172102264, -308.057772558509, -349.16880247254835, -27.782781307115236, -304.1198347403793, -241.542304864142, -211.14619060647763, -276.31343943078366, -401.2492897866332, -50.330929848851326, -378.558378196235, -348.24663309518957, -318.74527112685143, -385.6300196653939, -156.9566430119876, -117.79587208522035, -131.68593161763965, -332.8377430671585, -290.31140647081105, -541.1228260156114, 132.21156019318977, -341.42303998655973, -383.05326023632443, -269.05799351677, -357.6908737102657, -402.07125953323487, -315.91236077973247, -474.5483588561415, -382.66710579243227, -245.00129774293066, -237.754560498, -277.73972309387, -346.3129276229256, -141.38407054505214, -265.0530018235809, -308.67183595442026, -160.12633602475844, -15.704686126819137, -457.6074895228648, -239.67288272772015, -552.850874977209, -503.62812327676306, -182.55869789770384, -86.67757745411375, -109.03115932416935, -416.36899661160817, 183.80472849224887, -381.11103664199845, -148.6881154171229, -468.7358572712351, -360.68161390700124, -647.7159823929975, 190.29515838094673, -382.151999450849, -4.102814162715488, -385.713043227124, -536.3563485475868, -329.644418491519, -390.58330017988885, -464.70583606595306, -417.8062729053971, -107.01422715897004, -307.1206766940311, -14.043183590438868, -445.2679592028945, -12.953421107559432, -285.50057733802316, -407.767758845244, 16.59588907096076, -532.6600441954268, -321.8621811808832, -502.1716511829801, -139.14228422437628, -458.31134996523554, -326.71794521780555, -347.50184279032106, -177.45615230072437, -526.242208835413, -345.30383349784523, -421.1684745089739, -319.42131340515107, -491.47267561859155, -412.9465576203487, -302.88878627562787, -557.7801581726018, -338.9331712952573, -308.80207898624417, -482.50248673767584, -47.59013572275528, -293.9243200461898, -512.9040741166582, -299.3937152762976, -354.971945608548, -323.9673485578657, -352.47824866546136], "policy_predator_policy_reward": [398.6735331486765, 442.1433453374116, 603.3899662125249, 431.38395177906136, 283.05437743651646, 264.88636958563836, 237.1982363866865, 354.73695682329407, 131.36804889087986, 312.06488774802824, 379.75384801913145, 269.29019263122416, 458.482916457785, 456.61648661319265, 424.70470457493724, 136.16796327238933, 291.77632772759233, 101.04147110957456, 327.8886204955671, 298.0088140904187, 421.75844047539334, 323.0721150588373, 294.3809391316573, 381.8077868089125, 382.45595244155015, 419.04413304592424, 279.1142205073805, 422.81596813467667, 187.12792381031318, 378.8358183591527, 411.90803765776315, 280.53640535349285, 180.6006622992383, 128.9877563740891, 374.7464517836913, 271.3181725703758, 366.67772156016116, 452.5793473511882, 463.46523385817494, 378.81453848279943, 721.3355210474841, 491.5684928895898, 291.0277609024444, 293.65989347092676, 39.33279982323908, 455.1290900948933, 318.64018383870325, 459.34845516763244, 320.92934767467085, 317.9987635226197, 161.8114707306006, 463.4460783890866, 286.75175472711584, 95.43108962443085, 459.9190682334316, 343.2011647095133, 186.48282745331548, 418.70243883797514, 285.32331576742837, 447.5299363018519, 294.1191692332547, 148.05246919150233, 595.4586784315416, 272.1959444861909, 265.45930502530297, 394.6542439432463, 318.7369432816321, 371.83877305998834, 365.216146012919, 317.8322702187648, 335.80872481867283, 311.4918150958616, 285.1897901604097, 456.7270351111529, 338.2846154724294, 240.89195533701908, 286.39392674495633, 328.95883056084824, 328.9342256336467, 405.44197681765286, 427.7736162830879, 466.38531510501105, 299.8412700002463, 273.4732282122165, 354.705111732738, 462.45882297474253, 379.24084330388825, 497.6011879176323, 348.99517657953527, 421.0926979747317, 176.35912831600987, 301.85996999066134, 322.72968753699405, 291.6934310913397, 268.71502063778615, 276.75120853243664, 347.6968481624218, 342.05969284699114, 481.31427879936393, 381.27965514726856, 455.97915058655525, 387.4396341774148, 498.0294117194951, 352.0166959954839, 238.73609047891944, 565.8596172102264, 299.09528056460005, 353.92928499052516, 3.9512565665708776, 343.8146670453419, 329.05527107449575, 215.3949332480315, 414.6953399315731, 407.2810287587665, 41.95470499106162, 378.558378196235, 348.24663309518957, 321.2452711268513, 384.96117843981654, 166.1823728863137, 3.948003970755012, 264.66786525910067, 331.78630058194756, 338.2074214536094, 526.4438630305568, 95.13391504879448, 341.68187273234355, 382.5831632025956, 325.6095021534157, 405.53488742101035, 377.14151000191237, 334.1147442010134, 474.5483588561415, 382.66710579243227, 275.8776488495901, 251.04150920129956, 306.0864922841346, 346.4129276229256, 308.481823345416, 261.21037801993936, 279.1612468428829, 450.2480528490826, 242.26036624791703, 445.03209327514827, 325.2476128662405, 534.8972539975068, 387.8238608565837, 441.98208015992174, 220.49072478524374, 9.62564607259455, 254.43443024304727, 285.93252099949626, 363.12344998697375, 220.24435264740356, 469.21671850337214, 360.68161390700124, 648.1923723590357, 38.356462290396856, 350.8280737263286, 244.7684611013716, 479.35713809997, 428.64570216245977, 329.75738294712926, 390.58330017988885, 520.2214376210849, 367.6504266223155, 0.0, 388.62897626961427, 435.4554383418728, 124.26652880089416, 6.7064688213017245, 308.26841455651675, 374.55004112154364, 254.41092615858736, 532.6600441954268, 324.2621811808838, 503.4239433689339, 195.11952046694094, 458.0207357636225, 328.0242040105432, 344.067486700794, 474.86661712835553, 546.0843842413555, 319.34813371100495, 421.1684745089739, 319.62131340515106, 454.58929594381226, 472.96005340870835, 299.50318234113206, 559.6896625702151, 346.9007772241957, 357.1357335286061, 330.9570154221296, 468.1830969065521, 301.4200845104307, 514.5178586484922, 299.3749028244678, 354.58727087727436, 323.4277617422177, 351.91854498469576]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.730090123141979, "mean_inference_ms": 13.345896050105862, "mean_action_processing_ms": 22.044622331109025, "mean_env_wait_ms": 4.126815761145919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01040196418762207, "StateBufferConnector_ms": 0.07181644439697266, "ViewRequirementAgentConnector_ms": 0.3743089437484741}, "num_episodes": 8, "episode_return_max": 471.8220549411676, "episode_return_min": -44.60432697340353, "episode_return_mean": 88.27107262909604, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1550240, "num_agent_steps_trained": 1550240, "num_env_steps_sampled": 387560, "num_env_steps_trained": 387560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 186.4497424393947, "num_env_steps_trained_throughput_per_sec": 186.4497424393947, "timesteps_total": 387560, "num_env_steps_sampled_lifetime": 387560, "num_agent_steps_sampled_lifetime": 1550240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1550240, "timers": {"training_iteration_time_ms": 47963.006, "restore_workers_time_ms": 0.112, "training_step_time_ms": 47962.198, "sample_time_ms": 4786.228, "learn_time_ms": 43035.367, "learn_throughput": 185.894, "synch_weights_time_ms": 126.389}, "counters": {"num_env_steps_sampled": 387560, "num_env_steps_trained": 387560, "num_agent_steps_sampled": 1550240, "num_agent_steps_trained": 1550240}, "done": false, "training_iteration": 49, "trial_id": "cdf01_00000", "date": "2024-08-20_11-03-04", "timestamp": 1724131984, "time_this_iter_s": 43.05554699897766, "time_total_s": 2487.5343823432922, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2487.5343823432922, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 73.63387096774193, "ram_util_percent": 83.50806451612905}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.197250917411985, "cur_kl_coeff": 2.91038304567337e-12, "cur_lr": 0.0001, "total_loss": 8.52179846612234, "policy_loss": -0.0038950540727773117, "vf_loss": 8.52569355132088, "vf_explained_var": -0.15011633407501948, "kl": 0.0025232731919430313, "entropy": 0.1849458748622546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 30835.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.636025670974973, "cur_kl_coeff": 2.3841857910156248e-08, "cur_lr": 0.0001, "total_loss": 8.283475150002374, "policy_loss": -0.0044197004236694835, "vf_loss": 8.287894887015932, "vf_explained_var": 0.37985450918712316, "kl": 0.004235854100841693, "entropy": 0.35463025560454714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 30835.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 395560, "num_env_steps_trained": 395560, "num_agent_steps_sampled": 1582240, "num_agent_steps_trained": 1582240}, "env_runners": {"episode_reward_max": 371.90262130495654, "episode_reward_min": -98.48002520645878, "episode_reward_mean": 85.66210405502086, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -697.4340191129335, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.3, "predator_policy": 702.5106548787794}, "policy_reward_mean": {"prey_policy": -294.75560489011275, "predator_policy": 337.5866569176232}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.3955223473906, -6.727366110041973, -1.7763568394002505e-15, 44.163299809958765, 28.446769190264668, 163.25512899672233, 260.6111277127869, 213.98028387338007, 67.62110915881878, 143.6191198420385, 34.40763407955549, 307.80268312318515, 53.5686505752559, 0.4808612321369845, 229.1280106373812, 209.34172121413621, -14.066551512281935, 0.11296445561028756, 5.359755272050011, -25.505927583385386, 100.4108243494326, 16.520884932236253, 237.78909750584648, 2.400000000000003, 57.22952842851878, 1.015644591124536, 293.9761087381042, -6.113524380897305, 0.1999999999999953, 23.13011611358003, -1.476099536882697, 56.3012604713, 269.04748986825024, 9.10954899607589, -0.4034871831034501, -1.099290496413694, 208.9825352779187, 174.27340167633992, 7.69999999999999, -0.3426235197358063, 5.905724786915956, 166.88278786977924, 57.11480490260534, 33.69750816297746, 201.2382717671534, 45.84190128554104, -6.052536395751263, 21.904562301546026, 197.07359680561422, 233.67531422425338, 51.20047847761395, 261.44997327465774, -31.631940660269347, 149.0336456674033, -98.48002520645878, 7.69999999999999, 11.406302161193203, 0.7346295424693992, 28.756801859281133, 63.276870922223125, 50.56726793136879, 171.79793437384888, 9.334294159730335, 104.66688152014267, 30.108033086061397, 52.38552131020057, 371.90262130495654, -4.450261075320076, -1.3322676295501878e-15, 165.36654440239045, 44.14984076111833, 230.97302361362895, 108.1381945020662, 0.7229105955410966, 37.94381404518768, 180.25633105862508, 212.9130796495306, 31.593605869563458, 4.378860053113491, 232.52459570140024, 206.9843641786613, 279.74843882717295, 60.585171897262896, 2.7216785323817225, 0.7662063922831182, 235.55678868136735, 2.1999999999999993, 19.221548247379143, -43.144935663395195, 160.10920138428483, 17.556378452507968, 104.65215202915996, 114.88594893913826, 325.2456402097563, 275.38467151670636, 44.144248957614586, 0.5022098647111655, -3.828447163043475, 47.656282748746406, 10.614880710830098], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-269.05799351677, -357.6908737102657, -402.07125953323487, -315.91236077973247, -474.5483588561415, -382.66710579243227, -245.00129774293066, -237.754560498, -277.73972309387, -346.3129276229256, -141.38407054505214, -265.0530018235809, -308.67183595442026, -160.12633602475844, -15.704686126819137, -457.6074895228648, -239.67288272772015, -552.850874977209, -503.62812327676306, -182.55869789770384, -86.67757745411375, -109.03115932416935, -416.36899661160817, 183.80472849224887, -381.11103664199845, -148.6881154171229, -468.7358572712351, -360.68161390700124, -647.7159823929975, 190.29515838094673, -382.151999450849, -4.102814162715488, -385.713043227124, -536.3563485475868, -329.644418491519, -390.58330017988885, -464.70583606595306, -417.8062729053971, -107.01422715897004, -307.1206766940311, -14.043183590438868, -445.2679592028945, -12.953421107559432, -285.50057733802316, -407.767758845244, 16.59588907096076, -532.6600441954268, -321.8621811808832, -502.1716511829801, -139.14228422437628, -458.31134996523554, -326.71794521780555, -347.50184279032106, -177.45615230072437, -526.242208835413, -345.30383349784523, -421.1684745089739, -319.42131340515107, -491.47267561859155, -412.9465576203487, -302.88878627562787, -557.7801581726018, -338.9331712952573, -308.80207898624417, -482.50248673767584, -47.59013572275528, -293.9243200461898, -512.9040741166582, -299.3937152762976, -354.971945608548, -323.9673485578657, -352.47824866546136, -76.8000253777574, -416.0480816027371, -500.4714464761328, -164.8352266818405, -283.50734013301, -192.11027784616556, -312.89652979438114, -377.79372313237013, -508.44094435024317, -493.6985355622307, -273.2028103063953, -114.8532614630862, -218.35165355141055, -403.5688883168341, -465.2348113411621, 14.248150702016485, -194.33260144501548, -526.3303833361243, -372.30027996078087, -178.82398129483923, -669.3848020056544, -346.0516444885559, -321.8243856435461, -22.67154061947414, -273.246550070635, -205.37688952936074, -388.8512639584205, 160.51766498500538, -352.70226630427, -4.466908900231864, -286.3953793898542, -36.97250800290929, -338.8498532043742, -359.2656827319116, -114.60154129299303, -336.3795010231485, -179.984835993751, -328.91126643898383, -277.7586524781026, -283.05170191412896, -89.82941356055802, -438.77170355382185, -400.85604990089354, -529.1164133595671, 23.97353899908522, -371.5480324046034, -306.3971211080043, -425.06177891095973, -295.6303100712825, -287.6832315651798, -532.7382167615514, -87.7223789971945, -342.5843863638559, -373.6724828422462, -473.2103854303571, -149.4288327653568, -335.2102270588283, 11.930500277446841, -187.67086403233864, -257.9535532936084, -29.50886420274211, -633.5149635973052, -283.958007589917, -476.62470121427003, -697.4340191129335, -392.24195566612224, -121.62935953577946, -323.5614571368285, -95.6481199569767, -285.55307743903865, -36.74490532229591, -427.77635138930884, -424.7650921127792, -134.10408059380893, -366.57317213415143, -347.16880050644744, 10.826626211194515, -366.1031385896847, -354.8897348174507, -115.22501556457414, -145.06334125735705, -554.7588934519724, -182.81218950142005, -110.83859729071558, -345.9517912330379, -424.83695276218566, -54.358151698303146, -389.0558547321858, 197.3, -204.37135324979965, -348.1718359544264, 36.77028388591202, -428.07172748297035, -247.19217534517858, -308.3078450562473, -311.9708291843329, -100.38668682121185, -333.43520943338495, -257.4514471405341, -228.76210294879178, -373.53059459861373, -386.50923795464064, -291.62866362678335, -341.9255682994508, -567.3100031356262, -358.05669908385084, -166.83280762170253, -389.43575222307794, -248.1981839543491, -344.4074635709116, -477.43951050554807, -135.6578440903723, -283.6741067554444, -200.62304742850455, 11.236058120481504, -531.2023152067854, 25.37341276167026, -457.32804740890174, -629.5750134886964, -494.90666246412985, -414.06992064653707, -373.77118032086116, -359.9915912562387, -402.8912106705855, -461.2025355110268, -51.291484286565236, -310.2447198638374, -63.76204695008236], "policy_predator_policy_reward": [325.6095021534157, 405.53488742101035, 377.14151000191237, 334.1147442010134, 474.5483588561415, 382.66710579243227, 275.8776488495901, 251.04150920129956, 306.0864922841346, 346.4129276229256, 308.481823345416, 261.21037801993936, 279.1612468428829, 450.2480528490826, 242.26036624791703, 445.03209327514827, 325.2476128662405, 534.8972539975068, 387.8238608565837, 441.98208015992174, 220.49072478524374, 9.62564607259455, 254.43443024304727, 285.93252099949626, 363.12344998697375, 220.24435264740356, 469.21671850337214, 360.68161390700124, 648.1923723590357, 38.356462290396856, 350.8280737263286, 244.7684611013716, 479.35713809997, 428.64570216245977, 329.75738294712926, 390.58330017988885, 520.2214376210849, 367.6504266223155, 0.0, 388.62897626961427, 435.4554383418728, 124.26652880089416, 6.7064688213017245, 308.26841455651675, 374.55004112154364, 254.41092615858736, 532.6600441954268, 324.2621811808838, 503.4239433689339, 195.11952046694094, 458.0207357636225, 328.0242040105432, 344.067486700794, 474.86661712835553, 546.0843842413555, 319.34813371100495, 421.1684745089739, 319.62131340515106, 454.58929594381226, 472.96005340870835, 299.50318234113206, 559.6896625702151, 346.9007772241957, 357.1357335286061, 330.9570154221296, 468.1830969065521, 301.4200845104307, 514.5178586484922, 299.3749028244678, 354.58727087727436, 323.4277617422177, 351.91854498469576, 295.4472829798193, 406.383359278593, 483.12464257518957, 356.45543225912314, 284.70734013300995, 198.61027784616562, 304.7750220230567, 385.5726073839589, 514.4539897262216, 493.59121497316806, 263.88787691119825, 291.0509827280614, 317.2438721921488, 361.7914745787009, 465.2348113411621, 19.44935746096089, 478.29527836918413, 443.6059781791079, 141.30867358372294, 455.65748895743764, 702.5106548787794, 306.8732552196795, 260.7300820472049, 105.67040651736119, 371.1081831016412, 304.5888533039698, 283.769171929201, 178.23974126846744, 352.70226630427, 55.6673873778456, 292.5940252188584, 292.22383544856314, 305.2147379320054, 361.26885734401145, 318.2422541560444, 281.7724338274989, 404.19413635971574, 6.2219408665603435, 283.1586524781026, 285.3517019141295, 432.61278647144377, 107.39463280412865, 401.2906794433629, 529.4164133595672, 4.783262860195866, 371.5480324046034, 454.4848864246105, 340.250884516577, 344.22036052276763, 289.6604490450641, 519.9932470724615, 272.2652830601337, 369.249060845536, 356.3421025202967, 299.66661937547207, 427.6394803403845, 342.7906017156127, 10.597158151830163, 185.7908654678919, 312.2190731682548, 565.0613404376971, 469.8651086673065, 243.63614158346232, 512.4963061454046, 697.4340191129335, 392.24195566612224, 207.75204460663022, 402.80531646836874, 88.74318540046609, 336.60785275666706, 286.7278770448847, 408.7664032803503, 313.4442664990535, 353.5631007096005, 367.05330081033446, 347.4115824258055, 244.10351701482816, 149.11680940885037, 287.5136414396076, 362.8574400010433, 534.8185100361201, 377.91680432273927, 270.8322254749664, 54.4121671867317, 382.45784437714246, 392.70975967119386, 292.07513634113394, 383.8634657907555, 2.584364178661702, 211.47135324979925, 296.05689447300136, 295.0930964226862, 268.38650769562753, 467.462567029784, 318.84177892367893, 304.15857384928296, 64.6241781748763, 369.9639244720041, 388.9191710179886, 332.8511677527035, 375.7305945986138, 386.50923795464064, 316.25752700806066, 336.5182531655521, 377.6684670104755, 504.553299545607, 388.25093902838506, 328.1268222006803, 265.2201412753202, 344.94188470244836, 346.783219042339, 370.96628758274136, 282.3145087432744, 316.86859437981246, 382.02081206668043, 463.19108522937876, 375.890595571456, 331.44871059248237, 625.8358114130915, 542.7901134973497, 414.06992064653707, 374.2733901855723, 354.27861111857794, 404.7757436452035, 258.8195029421817, 301.3307996041554, 338.4790890476675, 46.14255847708289]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.568106260557984, "mean_inference_ms": 13.279585143380045, "mean_action_processing_ms": 21.93398098387198, "mean_env_wait_ms": 4.161781488562102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005548357963562012, "StateBufferConnector_ms": 0.05049479007720947, "ViewRequirementAgentConnector_ms": 0.2713465690612793}, "num_episodes": 64, "episode_return_max": 371.90262130495654, "episode_return_min": -98.48002520645878, "episode_return_mean": 85.66210405502086, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1582240, "num_agent_steps_trained": 1582240, "num_env_steps_sampled": 395560, "num_env_steps_trained": 395560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 193.4117911991367, "num_env_steps_trained_throughput_per_sec": 193.4117911991367, "timesteps_total": 395560, "num_env_steps_sampled_lifetime": 395560, "num_agent_steps_sampled_lifetime": 1582240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1582240, "timers": {"training_iteration_time_ms": 48193.987, "restore_workers_time_ms": 0.125, "training_step_time_ms": 48193.156, "sample_time_ms": 4930.176, "learn_time_ms": 43120.091, "learn_throughput": 185.528, "synch_weights_time_ms": 128.427}, "counters": {"num_env_steps_sampled": 395560, "num_env_steps_trained": 395560, "num_agent_steps_sampled": 1582240, "num_agent_steps_trained": 1582240}, "done": false, "training_iteration": 50, "trial_id": "cdf01_00000", "date": "2024-08-20_11-03-46", "timestamp": 1724132026, "time_this_iter_s": 41.481807231903076, "time_total_s": 2529.0161895751953, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2529.0161895751953, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 76.2491525423729, "ram_util_percent": 83.51694915254237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.940631136818538, "cur_kl_coeff": 1.455191522836685e-12, "cur_lr": 0.0001, "total_loss": Infinity, "policy_loss": -0.0024276562389873324, "vf_loss": 8.747489163232228, "vf_explained_var": -0.03297320547558012, "kl": Infinity, "entropy": 0.15577804461594613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 31465.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.348092373874453, "cur_kl_coeff": 1.1920928955078124e-08, "cur_lr": 0.0001, "total_loss": 8.317107304315718, "policy_loss": -0.004091349619603346, "vf_loss": 8.32119864660596, "vf_explained_var": 0.4036731725647336, "kl": 0.0032336710294036913, "entropy": 0.35281586145597793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 31465.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 403560, "num_env_steps_trained": 403560, "num_agent_steps_sampled": 1614240, "num_agent_steps_trained": 1614240}, "env_runners": {"episode_reward_max": 371.90262130495654, "episode_reward_min": -98.48002520645878, "episode_reward_mean": 87.42998092030015, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -697.4340191129335, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.3, "predator_policy": 702.5106548787794}, "policy_reward_mean": {"prey_policy": -292.31435363854644, "predator_policy": 336.02934409869647}, "custom_metrics": {}, "hist_stats": {"episode_reward": [67.62110915881878, 143.6191198420385, 34.40763407955549, 307.80268312318515, 53.5686505752559, 0.4808612321369845, 229.1280106373812, 209.34172121413621, -14.066551512281935, 0.11296445561028756, 5.359755272050011, -25.505927583385386, 100.4108243494326, 16.520884932236253, 237.78909750584648, 2.400000000000003, 57.22952842851878, 1.015644591124536, 293.9761087381042, -6.113524380897305, 0.1999999999999953, 23.13011611358003, -1.476099536882697, 56.3012604713, 269.04748986825024, 9.10954899607589, -0.4034871831034501, -1.099290496413694, 208.9825352779187, 174.27340167633992, 7.69999999999999, -0.3426235197358063, 5.905724786915956, 166.88278786977924, 57.11480490260534, 33.69750816297746, 201.2382717671534, 45.84190128554104, -6.052536395751263, 21.904562301546026, 197.07359680561422, 233.67531422425338, 51.20047847761395, 261.44997327465774, -31.631940660269347, 149.0336456674033, -98.48002520645878, 7.69999999999999, 11.406302161193203, 0.7346295424693992, 28.756801859281133, 63.276870922223125, 50.56726793136879, 171.79793437384888, 9.334294159730335, 104.66688152014267, 30.108033086061397, 52.38552131020057, 371.90262130495654, -4.450261075320076, -1.3322676295501878e-15, 165.36654440239045, 44.14984076111833, 230.97302361362895, 108.1381945020662, 0.7229105955410966, 37.94381404518768, 180.25633105862508, 212.9130796495306, 31.593605869563458, 4.378860053113491, 232.52459570140024, 206.9843641786613, 279.74843882717295, 60.585171897262896, 2.7216785323817225, 0.7662063922831182, 235.55678868136735, 2.1999999999999993, 19.221548247379143, -43.144935663395195, 160.10920138428483, 17.556378452507968, 104.65215202915996, 114.88594893913826, 325.2456402097563, 275.38467151670636, 44.144248957614586, 0.5022098647111655, -3.828447163043475, 47.656282748746406, 10.614880710830098, 353.15912092564207, 2.3903804835222133, -1.3322676295501878e-15, 4.603644523543981, 82.88622393340418, 137.29054665699573, 279.0536480102156, 125.52888781506662], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-239.67288272772015, -552.850874977209, -503.62812327676306, -182.55869789770384, -86.67757745411375, -109.03115932416935, -416.36899661160817, 183.80472849224887, -381.11103664199845, -148.6881154171229, -468.7358572712351, -360.68161390700124, -647.7159823929975, 190.29515838094673, -382.151999450849, -4.102814162715488, -385.713043227124, -536.3563485475868, -329.644418491519, -390.58330017988885, -464.70583606595306, -417.8062729053971, -107.01422715897004, -307.1206766940311, -14.043183590438868, -445.2679592028945, -12.953421107559432, -285.50057733802316, -407.767758845244, 16.59588907096076, -532.6600441954268, -321.8621811808832, -502.1716511829801, -139.14228422437628, -458.31134996523554, -326.71794521780555, -347.50184279032106, -177.45615230072437, -526.242208835413, -345.30383349784523, -421.1684745089739, -319.42131340515107, -491.47267561859155, -412.9465576203487, -302.88878627562787, -557.7801581726018, -338.9331712952573, -308.80207898624417, -482.50248673767584, -47.59013572275528, -293.9243200461898, -512.9040741166582, -299.3937152762976, -354.971945608548, -323.9673485578657, -352.47824866546136, -76.8000253777574, -416.0480816027371, -500.4714464761328, -164.8352266818405, -283.50734013301, -192.11027784616556, -312.89652979438114, -377.79372313237013, -508.44094435024317, -493.6985355622307, -273.2028103063953, -114.8532614630862, -218.35165355141055, -403.5688883168341, -465.2348113411621, 14.248150702016485, -194.33260144501548, -526.3303833361243, -372.30027996078087, -178.82398129483923, -669.3848020056544, -346.0516444885559, -321.8243856435461, -22.67154061947414, -273.246550070635, -205.37688952936074, -388.8512639584205, 160.51766498500538, -352.70226630427, -4.466908900231864, -286.3953793898542, -36.97250800290929, -338.8498532043742, -359.2656827319116, -114.60154129299303, -336.3795010231485, -179.984835993751, -328.91126643898383, -277.7586524781026, -283.05170191412896, -89.82941356055802, -438.77170355382185, -400.85604990089354, -529.1164133595671, 23.97353899908522, -371.5480324046034, -306.3971211080043, -425.06177891095973, -295.6303100712825, -287.6832315651798, -532.7382167615514, -87.7223789971945, -342.5843863638559, -373.6724828422462, -473.2103854303571, -149.4288327653568, -335.2102270588283, 11.930500277446841, -187.67086403233864, -257.9535532936084, -29.50886420274211, -633.5149635973052, -283.958007589917, -476.62470121427003, -697.4340191129335, -392.24195566612224, -121.62935953577946, -323.5614571368285, -95.6481199569767, -285.55307743903865, -36.74490532229591, -427.77635138930884, -424.7650921127792, -134.10408059380893, -366.57317213415143, -347.16880050644744, 10.826626211194515, -366.1031385896847, -354.8897348174507, -115.22501556457414, -145.06334125735705, -554.7588934519724, -182.81218950142005, -110.83859729071558, -345.9517912330379, -424.83695276218566, -54.358151698303146, -389.0558547321858, 197.3, -204.37135324979965, -348.1718359544264, 36.77028388591202, -428.07172748297035, -247.19217534517858, -308.3078450562473, -311.9708291843329, -100.38668682121185, -333.43520943338495, -257.4514471405341, -228.76210294879178, -373.53059459861373, -386.50923795464064, -291.62866362678335, -341.9255682994508, -567.3100031356262, -358.05669908385084, -166.83280762170253, -389.43575222307794, -248.1981839543491, -344.4074635709116, -477.43951050554807, -135.6578440903723, -283.6741067554444, -200.62304742850455, 11.236058120481504, -531.2023152067854, 25.37341276167026, -457.32804740890174, -629.5750134886964, -494.90666246412985, -414.06992064653707, -373.77118032086116, -359.9915912562387, -402.8912106705855, -461.2025355110268, -51.291484286565236, -310.2447198638374, -63.76204695008236, 69.22754994520044, -371.90104471163636, -350.2412307915061, -301.52627814738594, -377.70402114575603, -458.1715133939246, -251.28783280076144, -332.6165791934997, -371.63807706025335, -257.21446808785817, -44.06713038235395, -438.46953084402094, -319.35363169503404, 129.51319598873513, -185.75208922220048, -307.8509492882883], "policy_predator_policy_reward": [325.2476128662405, 534.8972539975068, 387.8238608565837, 441.98208015992174, 220.49072478524374, 9.62564607259455, 254.43443024304727, 285.93252099949626, 363.12344998697375, 220.24435264740356, 469.21671850337214, 360.68161390700124, 648.1923723590357, 38.356462290396856, 350.8280737263286, 244.7684611013716, 479.35713809997, 428.64570216245977, 329.75738294712926, 390.58330017988885, 520.2214376210849, 367.6504266223155, 0.0, 388.62897626961427, 435.4554383418728, 124.26652880089416, 6.7064688213017245, 308.26841455651675, 374.55004112154364, 254.41092615858736, 532.6600441954268, 324.2621811808838, 503.4239433689339, 195.11952046694094, 458.0207357636225, 328.0242040105432, 344.067486700794, 474.86661712835553, 546.0843842413555, 319.34813371100495, 421.1684745089739, 319.62131340515106, 454.58929594381226, 472.96005340870835, 299.50318234113206, 559.6896625702151, 346.9007772241957, 357.1357335286061, 330.9570154221296, 468.1830969065521, 301.4200845104307, 514.5178586484922, 299.3749028244678, 354.58727087727436, 323.4277617422177, 351.91854498469576, 295.4472829798193, 406.383359278593, 483.12464257518957, 356.45543225912314, 284.70734013300995, 198.61027784616562, 304.7750220230567, 385.5726073839589, 514.4539897262216, 493.59121497316806, 263.88787691119825, 291.0509827280614, 317.2438721921488, 361.7914745787009, 465.2348113411621, 19.44935746096089, 478.29527836918413, 443.6059781791079, 141.30867358372294, 455.65748895743764, 702.5106548787794, 306.8732552196795, 260.7300820472049, 105.67040651736119, 371.1081831016412, 304.5888533039698, 283.769171929201, 178.23974126846744, 352.70226630427, 55.6673873778456, 292.5940252188584, 292.22383544856314, 305.2147379320054, 361.26885734401145, 318.2422541560444, 281.7724338274989, 404.19413635971574, 6.2219408665603435, 283.1586524781026, 285.3517019141295, 432.61278647144377, 107.39463280412865, 401.2906794433629, 529.4164133595672, 4.783262860195866, 371.5480324046034, 454.4848864246105, 340.250884516577, 344.22036052276763, 289.6604490450641, 519.9932470724615, 272.2652830601337, 369.249060845536, 356.3421025202967, 299.66661937547207, 427.6394803403845, 342.7906017156127, 10.597158151830163, 185.7908654678919, 312.2190731682548, 565.0613404376971, 469.8651086673065, 243.63614158346232, 512.4963061454046, 697.4340191129335, 392.24195566612224, 207.75204460663022, 402.80531646836874, 88.74318540046609, 336.60785275666706, 286.7278770448847, 408.7664032803503, 313.4442664990535, 353.5631007096005, 367.05330081033446, 347.4115824258055, 244.10351701482816, 149.11680940885037, 287.5136414396076, 362.8574400010433, 534.8185100361201, 377.91680432273927, 270.8322254749664, 54.4121671867317, 382.45784437714246, 392.70975967119386, 292.07513634113394, 383.8634657907555, 2.584364178661702, 211.47135324979925, 296.05689447300136, 295.0930964226862, 268.38650769562753, 467.462567029784, 318.84177892367893, 304.15857384928296, 64.6241781748763, 369.9639244720041, 388.9191710179886, 332.8511677527035, 375.7305945986138, 386.50923795464064, 316.25752700806066, 336.5182531655521, 377.6684670104755, 504.553299545607, 388.25093902838506, 328.1268222006803, 265.2201412753202, 344.94188470244836, 346.783219042339, 370.96628758274136, 282.3145087432744, 316.86859437981246, 382.02081206668043, 463.19108522937876, 375.890595571456, 331.44871059248237, 625.8358114130915, 542.7901134973497, 414.06992064653707, 374.2733901855723, 354.27861111857794, 404.7757436452035, 258.8195029421817, 301.3307996041554, 338.4790890476675, 46.14255847708289, 328.95512078079025, 326.8774949112867, 350.57191232681106, 303.58597709560325, 377.70402114575603, 458.1715133939246, 255.89147732430538, 332.6165791934997, 312.42962694775576, 399.3091421337603, 183.80824598882646, 436.01896189454436, 269.8645214370014, 199.02956227951304, 351.6237106018377, 267.5082157237176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.68125970643214, "mean_inference_ms": 13.242098614226897, "mean_action_processing_ms": 21.908326917119368, "mean_env_wait_ms": 4.109297473095876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03501474857330322, "StateBufferConnector_ms": 0.059375643730163574, "ViewRequirementAgentConnector_ms": 0.4358823299407959}, "num_episodes": 8, "episode_return_max": 371.90262130495654, "episode_return_min": -98.48002520645878, "episode_return_mean": 87.42998092030015, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1614240, "num_agent_steps_trained": 1614240, "num_env_steps_sampled": 403560, "num_env_steps_trained": 403560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 46.964524534890074, "num_env_steps_trained_throughput_per_sec": 46.964524534890074, "timesteps_total": 403560, "num_env_steps_sampled_lifetime": 403560, "num_agent_steps_sampled_lifetime": 1614240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1614240, "timers": {"training_iteration_time_ms": 61237.415, "restore_workers_time_ms": 0.126, "training_step_time_ms": 61236.484, "sample_time_ms": 5825.505, "learn_time_ms": 55216.338, "learn_throughput": 144.885, "synch_weights_time_ms": 177.66}, "counters": {"num_env_steps_sampled": 403560, "num_env_steps_trained": 403560, "num_agent_steps_sampled": 1614240, "num_agent_steps_trained": 1614240}, "done": false, "training_iteration": 51, "trial_id": "cdf01_00000", "date": "2024-08-20_11-06-38", "timestamp": 1724132198, "time_this_iter_s": 171.9396150112152, "time_total_s": 2700.9558045864105, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a529ea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2700.9558045864105, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 97.791452991453, "ram_util_percent": 83.69444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.782798549296364, "cur_kl_coeff": 2.1827872842550277e-12, "cur_lr": 0.0001, "total_loss": 8.749225306132484, "policy_loss": -0.0033808739781971014, "vf_loss": 8.75260615878635, "vf_explained_var": -0.27306542339779083, "kl": 0.00236309267065609, "entropy": 0.15110680020990827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 32095.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.627801368350075, "cur_kl_coeff": 5.960464477539062e-09, "cur_lr": 0.0001, "total_loss": 8.384942331011333, "policy_loss": -0.00392399744707204, "vf_loss": 8.388866307243468, "vf_explained_var": 0.28434854499877443, "kl": 0.0034429108179641244, "entropy": 0.33610035497990864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 32095.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 411560, "num_env_steps_trained": 411560, "num_agent_steps_sampled": 1646240, "num_agent_steps_trained": 1646240}, "env_runners": {"episode_reward_max": 457.0439044964772, "episode_reward_min": -43.144935663395195, "episode_reward_mean": 93.59431465767582, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -707.1803344514249, "predator_policy": 1.6940352149960611}, "policy_reward_max": {"prey_policy": 197.3, "predator_policy": 681.8400585802872}, "policy_reward_mean": {"prey_policy": -292.1770159334727, "predator_policy": 338.97417326231067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.1381945020662, 0.7229105955410966, 37.94381404518768, 180.25633105862508, 212.9130796495306, 31.593605869563458, 4.378860053113491, 232.52459570140024, 206.9843641786613, 279.74843882717295, 60.585171897262896, 2.7216785323817225, 0.7662063922831182, 235.55678868136735, 2.1999999999999993, 19.221548247379143, -43.144935663395195, 160.10920138428483, 17.556378452507968, 104.65215202915996, 114.88594893913826, 325.2456402097563, 275.38467151670636, 44.144248957614586, 0.5022098647111655, -3.828447163043475, 47.656282748746406, 10.614880710830098, 353.15912092564207, 2.3903804835222133, -1.3322676295501878e-15, 4.603644523543981, 82.88622393340418, 137.29054665699573, 279.0536480102156, 125.52888781506662, 157.39554738257033, -18.1720950343621, 132.56216563562546, 110.25927168959294, 26.669327482632262, 7.3999999999999915, 161.74951507260337, 118.06813552238846, 104.29923154353285, 145.73340328722995, -2.0824446474287504, 71.02139703897345, 74.92544116438125, 457.0439044964772, 89.90295437070522, 140.91788993293017, 0.63375567784996, 44.393151135618, 81.79778480590824, 71.94324058964425, 56.45798967646391, 78.35638055764204, 2.8016366240523936, 28.38986846560002, 0.35844130854435186, 143.28979453702763, 94.8625418636151, 18.04737526626559, 79.98048094510922, 81.95467255678929, 0.4895269623979144, 219.70986682859044, 104.86560560315948, 191.99830893605085, 73.31641697381, 8.449741969874363, 176.06745538865775, 135.5070106177454, 4.437059298643306, 214.27349926652082, 0.19999999999999285, 21.792057369948267, 221.54831300954436, 43.43862144587208, 2.800000000000005, 219.92632723649263, 84.50530675043264, 32.77873775676769, 2.4424906541753444e-15, 232.7723937443234, 1.3280037689557276, 176.2838834764829, 124.3542849411126, -8.881784197001252e-16, -7.673804866267126, -15.351660632637094, 185.98461515878594, 2.8781392508786814, 8.299999999999995, 1.2723684150518528, 341.2957136320068, 0.3153203443722963, 180.50669434424796, 155.1546272608312], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-424.7650921127792, -134.10408059380893, -366.57317213415143, -347.16880050644744, 10.826626211194515, -366.1031385896847, -354.8897348174507, -115.22501556457414, -145.06334125735705, -554.7588934519724, -182.81218950142005, -110.83859729071558, -345.9517912330379, -424.83695276218566, -54.358151698303146, -389.0558547321858, 197.3, -204.37135324979965, -348.1718359544264, 36.77028388591202, -428.07172748297035, -247.19217534517858, -308.3078450562473, -311.9708291843329, -100.38668682121185, -333.43520943338495, -257.4514471405341, -228.76210294879178, -373.53059459861373, -386.50923795464064, -291.62866362678335, -341.9255682994508, -567.3100031356262, -358.05669908385084, -166.83280762170253, -389.43575222307794, -248.1981839543491, -344.4074635709116, -477.43951050554807, -135.6578440903723, -283.6741067554444, -200.62304742850455, 11.236058120481504, -531.2023152067854, 25.37341276167026, -457.32804740890174, -629.5750134886964, -494.90666246412985, -414.06992064653707, -373.77118032086116, -359.9915912562387, -402.8912106705855, -461.2025355110268, -51.291484286565236, -310.2447198638374, -63.76204695008236, 69.22754994520044, -371.90104471163636, -350.2412307915061, -301.52627814738594, -377.70402114575603, -458.1715133939246, -251.28783280076144, -332.6165791934997, -371.63807706025335, -257.21446808785817, -44.06713038235395, -438.46953084402094, -319.35363169503404, 129.51319598873513, -185.75208922220048, -307.8509492882883, -239.35663143037797, -60.08823238227042, -451.0021463159523, -371.29858832711994, -333.70565410069133, -92.53622384857016, -113.59795798234077, -370.0839618977437, -254.98403061730528, -359.1630054502062, -348.10193823969877, -161.6704391411014, -194.96740269291186, -470.1491575165214, -175.88216640019635, -390.702883824356, -425.10251891053485, -129.16021398056586, 20.000000000000014, -707.1803344514249, -342.35350593475033, -365.16450621909826, -427.1266970586688, -237.56059657261665, -306.4423650116395, -411.3299401283174, 119.33463934029011, -381.0348987968207, -67.2676917194784, -417.08612969724453, -8.981741540156497, -442.5845999778545, -485.2409091735101, -311.43960139341374, -197.84314644334998, -598.3560108518926, -94.91754084850903, -333.7696116691687, -127.23117145997531, -138.4415712019465, -105.26418874691852, -354.99037552655403, -431.4754139294121, -111.30186191292384, -354.2923971194586, -464.59756366727214, -546.299017914716, -288.43644089584416, -294.2760296359141, -355.89973234992715, -487.10199121701277, -173.7059715687245, -411.8042523150497, -289.02446687649484, -424.50856307501454, -486.2176901393701, -384.97646918871936, -407.4222077700228, -103.24267467259065, -391.23459443274817, -409.64400169581006, -416.6686522045833, -465.42196952037864, -212.1357768072882, -254.78920814157928, -542.4569251163803, 107.83472792090402, -435.3758796526427, 25.666121393207717, -414.2188784406433, -450.93052480187646, -290.82287916959564, -26.001768174500995, 147.65995674012294, -472.87893224313444, -256.50755314972054, -457.2223422096717, -304.1014287000131, 31.130140722272746, -608.7589341553607, -466.43747308673613, -398.68051875450544, -227.102595279243, -275.4574454928186, -137.83181123534752, -331.0240639689616, -447.3830896947446, -268.25956476518786, -292.7425447495076, -391.9856589784882, -118.70495068372327, -319.81396224930194, -356.484635991572, -235.35394450053892, -313.7803354814052, 15.132769308461288, -439.4474876796526, -507.325420681165, -57.90864785445829, -413.11996116041297, -324.65948960651286, -364.72788397911745, -229.19933229021294, 158.84800384509796, -351.30136601614583, 28.388748519348876, -303.5013641229156, -386.3973244094777, -376.0752021178185, -254.56983707422282, -474.7245202726152, -291.7282344508653, -536.1992927692953, -192.74861759011827, -323.14662868025783, -384.7321224903771, -496.8428516796018, -247.59691723810587, -388.2153392489872, -359.15371174058424, 11.333396232762226, -447.5510988917472, -437.78023266019915, -428.32387855848543, -400.97742688013426, -103.79474405660187, -524.731723574225, -158.6556780470945], "policy_predator_policy_reward": [313.4442664990535, 353.5631007096005, 367.05330081033446, 347.4115824258055, 244.10351701482816, 149.11680940885037, 287.5136414396076, 362.8574400010433, 534.8185100361201, 377.91680432273927, 270.8322254749664, 54.4121671867317, 382.45784437714246, 392.70975967119386, 292.07513634113394, 383.8634657907555, 2.584364178661702, 211.47135324979925, 296.05689447300136, 295.0930964226862, 268.38650769562753, 467.462567029784, 318.84177892367893, 304.15857384928296, 64.6241781748763, 369.9639244720041, 388.9191710179886, 332.8511677527035, 375.7305945986138, 386.50923795464064, 316.25752700806066, 336.5182531655521, 377.6684670104755, 504.553299545607, 388.25093902838506, 328.1268222006803, 265.2201412753202, 344.94188470244836, 346.783219042339, 370.96628758274136, 282.3145087432744, 316.86859437981246, 382.02081206668043, 463.19108522937876, 375.890595571456, 331.44871059248237, 625.8358114130915, 542.7901134973497, 414.06992064653707, 374.2733901855723, 354.27861111857794, 404.7757436452035, 258.8195029421817, 301.3307996041554, 338.4790890476675, 46.14255847708289, 328.95512078079025, 326.8774949112867, 350.57191232681106, 303.58597709560325, 377.70402114575603, 458.1715133939246, 255.89147732430538, 332.6165791934997, 312.42962694775576, 399.3091421337603, 183.80824598882646, 436.01896189454436, 269.8645214370014, 199.02956227951304, 351.6237106018377, 267.5082157237176, 241.7253691045525, 215.1150420906662, 432.2256018171512, 371.9030377915587, 344.2281266186782, 214.57591696620824, 105.5066079690032, 488.43458360067723, 296.0474861333335, 344.7688774168098, 348.5019382396988, 168.670439141101, 434.6282638544997, 392.2378114275376, 348.7715892503393, 335.8815964966012, 409.5138986961908, 249.04806573844374, 151.07367915836824, 681.8400585802872, 291.59979735742087, 413.83577014899913, 420.1151197524746, 315.5935709177841, 473.62903232030436, 319.0687139840335, 339.1296802460913, 379.6144837069155, 351.9376648097855, 222.3191109776431, 442.45937061807, 150.02486083287113, 485.2409091735101, 312.07335707126373, 267.25444658698336, 573.3378618438768, 14.557782331580889, 495.9271549920065, 5.60714947961847, 332.00883377194714, 174.8639808962815, 341.8485730536544, 536.064357121255, 85.06929927872494, 295.6440747411484, 526.0475226696345, 439.81203558113975, 423.3132916950215, 298.91731220414596, 351.61689109023973, 484.64841897875493, 319.44933834401013, 399.8966455861938, 395.79461546896687, 448.936365945812, 479.8372625348386, 388.30714769124825, 484.07201021260397, 192.57155356732713, 383.86038809480084, 410.1335286582079, 416.6686522045833, 384.8266191988667, 512.4409939573898, 516.274012052621, 385.83772680849984, 84.15567062080797, 435.38379004698135, 289.3775032908646, 172.49167073038197, 299.2726211394697, 450.93052480187646, 45.32904515082971, 9.080221672206864, 431.03979661802913, 433.85369939257214, 445.34487129393, 320.41595891439846, 306.0274272181831, 485.8748654814266, 466.53747308673616, 398.78051875450547, 248.74828114395407, 275.6038169980557, 292.8134777019438, 397.5907105119096, 438.35498129160385, 320.72629461420115, 295.54254474950744, 391.9856589784882, 365.0210097037956, 293.42423046572145, 356.5122072762443, 319.8316799662983, 15.419393603883456, 316.006910325828, 439.4474876796526, 507.325420681165, 353.8366519304235, 349.964350828771, 325.6515995555405, 365.0637777990455, 244.94117670660182, 1.6940352149960611, 360.0806840689924, 87.18621836891725, 303.5013641229156, 386.3973244094777, 264.65826715384765, 358.3129671719262, 470.5194011056764, 280.5816929851666, 398.6572486586949, 516.2752768595055, 326.93098193136234, 383.8259084901513, 496.8428516796018, 255.89691723810586, 389.4410999170918, 359.20031948753154, 387.20900667355255, 390.30440961743795, 438.09555300457146, 428.32387855848543, 361.31693881950986, 323.9619264614744, 311.0178582512561, 527.5241706308943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 16.93964378856171, "mean_inference_ms": 14.982402077733775, "mean_action_processing_ms": 21.81478654141505, "mean_env_wait_ms": 4.67661166798167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.3000462055206299, "StateBufferConnector_ms": 1.5617681741714478, "ViewRequirementAgentConnector_ms": 5.683725833892822}, "num_episodes": 64, "episode_return_max": 457.0439044964772, "episode_return_min": -43.144935663395195, "episode_return_mean": 93.59431465767582, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1646240, "num_agent_steps_trained": 1646240, "num_env_steps_sampled": 411560, "num_env_steps_trained": 411560, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 29.64693564245065, "num_env_steps_trained_throughput_per_sec": 29.64693564245065, "timesteps_total": 411560, "num_env_steps_sampled_lifetime": 411560, "num_agent_steps_sampled_lifetime": 1646240, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1646240, "timers": {"training_iteration_time_ms": 82335.285, "restore_workers_time_ms": 3.546, "training_step_time_ms": 82326.615, "sample_time_ms": 11214.773, "learn_time_ms": 70834.327, "learn_throughput": 112.94, "synch_weights_time_ms": 257.068}, "counters": {"num_env_steps_sampled": 411560, "num_env_steps_trained": 411560, "num_agent_steps_sampled": 1646240, "num_agent_steps_trained": 1646240}, "done": false, "training_iteration": 52, "trial_id": "cdf01_00000", "date": "2024-08-20_11-11-13", "timestamp": 1724132473, "time_this_iter_s": 271.7768120765686, "time_total_s": 2972.732616662979, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e63430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2972.732616662979, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 97.42695417789758, "ram_util_percent": 83.68975741239892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.811488474096571, "cur_kl_coeff": 1.0913936421275138e-12, "cur_lr": 0.0001, "total_loss": 9.084921597072057, "policy_loss": -0.0034909530725729253, "vf_loss": 9.088412536893571, "vf_explained_var": -0.4282985641275133, "kl": 0.002031097559192858, "entropy": 0.13579558610916137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.71428571428572, "num_grad_updates_lifetime": 32760.5, "diff_num_grad_updates_vs_sampler_policy": 349.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.389531107800347, "cur_kl_coeff": 2.9802322387695306e-09, "cur_lr": 0.0001, "total_loss": 8.468044684955052, "policy_loss": -0.004742849482156869, "vf_loss": 8.472787526675633, "vf_explained_var": 0.3134206762484142, "kl": 0.0039087005829518216, "entropy": 0.3079200746757644, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.71428571428572, "num_grad_updates_lifetime": 32760.5, "diff_num_grad_updates_vs_sampler_policy": 349.5}}, "num_env_steps_sampled": 420440, "num_env_steps_trained": 420440, "num_agent_steps_sampled": 1681760, "num_agent_steps_trained": 1681760}, "env_runners": {"episode_reward_max": 416.49251868138737, "episode_reward_min": -75.51242433498668, "episode_reward_mean": 83.20146834679541, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 43200, "policy_reward_min": {"prey_policy": -778.8783531940223, "predator_policy": 4.177905810901051}, "policy_reward_max": {"prey_policy": 194.6, "predator_policy": 775.8311745952092}, "policy_reward_mean": {"prey_policy": -313.5352309629231, "predator_policy": 355.1359651363208}, "custom_metrics": {}, "hist_stats": {"episode_reward": [232.33874642305673, 26.84615658576415, 188.95041840028225, 119.3958984401671, 204.23866327437935, 175.46437160288158, 3.6000000000000023, 55.86384471756512, 1.0625850598531033, 3.0999999999999996, 380.92922675163413, 66.0312364002123, 73.1717099819119, 9.38356836449897, 241.19969397405734, 30.78207311656411, 2.1705662988754035, 46.922434070476946, 0.26293636241685325, 0.24794602898878326, 164.7272709496438, -8.881784197001252e-16, -9.762976260671966, 0.5999999999999999, 24.877905810901076, 1.5543122344752192e-15, 0.10332903569849705, 416.49251868138737, -15.663605326722067, 146.73221093239582, -0.17579423284850804, 27.851106595002214, -74.56347269645501, 79.24267850782333, 264.39604481172205, 0.28422727979354967, 74.10707908650777, 97.34765050931976, 91.60946271340289, 113.70448408422094, 130.23803460305115, 63.92410082240343, 42.03367710392831, 20.80008558384632, -34.87903308793172, 249.00159386224615, 56.13272742944849, 16.434300627266087, 126.8523462662316, 272.56024962496735, 281.60088996277915, 92.41702248283825, 284.2302584898421, 54.34118188198445, -3.847446845633664, 40.257372104944125, 124.4232812424508, 10.948537330366918, -4.0832066157670965, 9.241358265397569, 0.0, 7.273349909837105, 262.5035497227351, 202.12022808530665, 15.439251005382355, 3.000000000000002, 149.00058203765784, -2.1683514949090945, -3.1515056035105546, 17.587492672157822, 0.4336869221677, 242.90374997372294, 193.3171126929478, 21.465312432337868, 173.59445801331663, 313.3757568623071, -0.08090795096283054, 2.0205835490898103, 27.012628930894103, 16.69163692431201, 16.79999999999997, 139.0478098709819, 0.40000000000000036, 63.51388709754088, 37.09168992149025, 44.954217325433575, 141.99132012020283, -2.683373311219956, 143.4542055234942, 25.776825036027, 154.33447092675536, 147.5550851148314, 0.3999999999999937, 6.731167633536213, 46.99203231516264, 119.19999999999959, 18.455739627269516, 168.3657181834739, 2.0086155621125963, 0.0, 70.25511267537055, 204.63232762759452, 29.039193918308435, 334.4072451692745, 3.2196718950899923, 46.188085074716824, 309.616084019785, 2.24381693120133, 109.03807796605614, 32.087649491908415, 161.53878533839168, 61.174391972015, 173.22768544237252, 171.73828820815126, 104.1168101509707, -3.57027107099076, 7.7066393573418885, 20.473008064200595, 0.06580252714758084, 26.805762409311146, 2.1013686471056268, 1.6000000000000012, -4.440892098500626e-15, 77.26978073183557, -9.87078342926156, 191.6370785009357, 304.83380729976165, 43.105434021575185, 254.06206334774694, 77.53588666200909, 5.211997850637223, 29.74926286092912, 61.96191359938528, 25.963695975996085, 124.33642274302375, 53.592852991337516, 63.54429980004255, 0.7000000000000035, 238.8897366789761, 15.856712334138944, 0.30940630806901126, 2.5000000000000013, 150.227447847548, -75.51242433498668, 212.1613123419269, 0.2418303833400055, 146.9782397607576, 160.1841465120833, 67.98488211881913, 272.6808201732355, 0.08418758087281564, 95.54472480658498, 0.09999999999999387, 141.71920138017333, 392.81068550976204, 1.0000000000000013, -0.0344085075831706, -3.368177034788306, 109.56873642481331, 177.51780904348726, 164.95822997618836, 12.926300145957304, 143.61808358460993, 209.36318354370022, 34.2191414405051, 12.041371319698609, 21.665547209944833, 18.588841297466875, 3.2949972367589284, 131.44219143405826, -8.450971433894127, 146.38716318216095, 61.824163045507106, 362.311004627573, 86.59657681472744, 2.220446049250313e-16, 212.77885651959429, 145.93714090300762, -22.893727243738624, 124.39672423130466, 204.90007828167538, 138.3322601585908, 230.48424559142987, 63.71618302001551, 0.922079979408873, 96.75660783477252, 157.47609994641405, -1.5006284268172803, 11.419930205605153, 151.28849823073614, 62.13931452665314, 0.12634154080864946, 206.68298777075955, 2.616666254244274, -12.241516915230964, 18.700000000000085, 51.805730922377926, 215.04125998281674, 276.02441239781655, 0.07429741860658723, 254.08134224218688, 13.138233845795892, 186.92370135030947, 36.48486689617217, 42.79229215242568, 10.472021779870865, 192.38417661195575, 83.55367257193349, -2.220446049250313e-16, 1.6369563780816638, -2.1472890668787743, -2.812117484079285, -0.17765408656960902, 1.104664084596012, 15.632335137527665, 110.66862273890763], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-86.68568032131235, -399.31374597592105, -393.7034003251263, -486.342043819685, -103.97517789563193, -278.0529439012647, -221.17018460726223, -390.90171997778435, -390.60047837071943, -108.32751823530644, -449.20956056618445, -118.1665478669355, -263.1012489097302, -325.61796758072654, -417.6336442906965, -316.96935449478116, -170.96730040986702, -417.2332200186844, -457.25289637150735, -295.8925267107287, 15.247209515227057, -479.8552744250963, -486.1807364884088, -207.05433172603918, -490.51285612148126, -327.971166769006, -326.68133922419594, -364.189661540614, -10.247868916659199, -470.9300055895666, -355.3240226214702, -425.8539589351093, -314.0469607667038, -246.29435378222095, -382.9382056368731, -291.5341488811638, -643.4008497202187, -452.96434620126905, -379.592425444665, -402.40029046816886, -379.262540546776, -99.91613078044813, -585.7116930468842, -428.94769290382055, -294.63074082985554, -298.00974601575865, -385.4928117872611, -394.3390738286722, 20.000000000000014, -309.3901567349452, -374.0073552835855, -397.03086065522444, -317.72926164444084, -689.6136322574497, -645.2085238196198, -80.19245973971827, -411.58647057795764, -433.5705613681146, -119.51353278443727, -363.60692157914093, -546.0291068565747, -320.4575782928668, -354.8144261785364, -308.5763916663056, -440.134727801954, -387.68332601136126, -233.944676175544, -494.56055689776207, -24.266032561086277, -345.2830095546063, -415.63316827337064, -264.0734543531048, -299.83565420428397, -301.3263349281265, -507.521754331411, -119.69174715364976, -479.320926779991, -162.89203443102915, -445.36699923025697, -261.1190362172331, -348.384146757909, -101.72497422872578, -364.86264449175945, -310.0335674335462, -324.1264354744356, -328.368829337234, -409.9875090352289, -227.12724681676715, -482.04401093478424, -461.91923337813864, -429.2996041157752, 101.59184910435356, -458.6038546757274, -326.70319166423775, -332.3458559579234, -325.33769058751614, -163.43374851771694, -574.3299741236369, -368.50053158924925, -133.6753284427678, -95.2113256035805, -668.7251340002294, -2.85055925096637, -521.442717442412, -351.4309685287061, -7.581869391294195, -144.29638942171835, -353.29856264514245, -464.38135138868034, -330.1513804480573, -228.5760798259202, -410.3435659259958, -27.32792079906519, -462.8840887273073, -297.60890820376284, -397.48697328846345, -677.9436144612171, -336.0859520881385, -462.69195805414216, -325.31319676437954, -627.5588507102374, -472.6509389298844, -315.0558338473737, -397.54870972992614, -307.8862126036239, -117.0627913429467, -445.85921758094617, 22.20362370406913, -240.49203066793316, -346.4559733736592, -314.482592219061, -269.2410981498959, -269.1770556393695, -410.55394193369324, -339.5126713257817, -458.41951402705206, -428.26966201414945, -396.86100048590293, -496.49928126145016, -444.2342666456548, -410.97853316271147, -327.65120437336805, -361.51476114644095, -117.78676538850456, -406.3015773855331, -184.5639943451956, -143.08889053422965, -365.9814486364091, -375.631938332569, -144.62509651659957, -489.53944895127944, 77.59999999999928, -319.37155826163746, -437.96242107995005, -289.24944597373985, -304.6699081010088, -407.65826976125163, -180.51747808145197, -252.36200783947066, -311.5051838408609, -334.4783915108027, -29.28545403416203, -175.1514712250801, -297.2324716341723, -410.5268346306695, -356.1305609601475, -365.31337973189346, -73.01797731529979, -299.35040538205504, -247.23114021526965, -370.8361864356514, -70.39600519852439, -408.7898053575675, -118.48746693082697, -231.64930833890426, -367.3440433982604, -298.87406094207455, -173.2126424460224, -331.2636841523329, -98.65513079134253, 19.089778758705684, -539.7040065828714, -159.41679107045547, -366.18041543555177, -302.1280747941559, -640.6366133756308, -173.72764932748692, -444.7395987743944, -438.508590838658, -45.50222077956991, -324.43823048388896, 45.223270846986054, -513.6554543705369, -95.06671854520485, -498.85726851746705, -191.33899131984452, -275.5274959192892, -523.1566575288722, -343.29027036257014, -338.3260568800922, -330.2890893002836, -188.88234507007672, -240.36792043024693, -136.48630729184543, -274.2926682647705, -303.6614820559033, -11.167977864915374, -472.8605297843818, -517.5324779848422, -443.2014098754981, -402.82525107620825, -256.5164827760633, -98.61196298684986, -592.2030037162181, -319.5499810312739, -275.9883184364677, -328.9130053491669, -332.04962842445894, -368.552460566365, -405.8382424923433, -186.68249494110628, -505.5000843021084, -778.8783531940223, -161.82388904863421, -309.8286707142913, -132.61908934325095, -138.57406676717014, -454.40398559943225, -388.3897458589012, -18.5073422223213, -322.184805628107, -452.5962233915974, -404.5181990060652, -384.0651582052534, -343.0857478229909, -387.21791095186995, -233.16205086046236, -452.3069847749929, -318.692950438486, -320.5370453782398, -323.03366619034415, -395.68997789145766, -411.37981839893234, -369.2925862639564, -532.9075230709673, -369.13546776409953, -363.5578962355827, -318.36161928353374, -307.75828854285794, -511.2968258384363, -169.122037993162, -374.4847028509567, 102.54502476013712, -543.7879063245484, -278.62243892713144, -378.8236033245784, -411.221615336852, -117.93418223689656, -240.07417269777434, -400.9721915223032, -190.3601943948083, -393.52780765173696, -351.4311587601164, -381.71695458392674, -232.63812917912193, -360.53504824416274, -404.30891339575567, -432.8667370925196, -365.2844177619675, -140.97763827597996, -179.69463363575392, -347.34647067502317, -585.1770045464364, -386.5082253525327, -288.8357214055489, -484.2603006502289, -488.10240175609033, -121.47664385223156, -42.85847480418904, -418.6078042483941, -292.9615244583875, -204.98096729086342, -339.4598378961532, -270.895155475546, -370.7146738989784, -91.48618972501575, -183.9437897356285, -325.0689753447093, -454.0858425893527, -220.48429951229963, -337.23226453923024, -599.9460378638665, -460.1049514358079, -17.651967689120674, -366.6886838676968, -156.56545879070293, -239.60863614311396, -78.74104234042488, -99.13318599112836, -483.47335074102784, -425.58877659257297, -406.2180727364683, -573.741047350532, -23.79707934149816, -533.3670089264848, -378.519481400943, -144.97527107596747, -335.976102375321, -418.1493476987661, 105.12222735357848, -294.83743107679305, -309.8727547482899, -319.52936003030374, -262.139902300593, -307.88895820957, -374.3747897055939, -336.32456926166196, -174.37425101737603, -80.60828868694718, -342.59627477563623, -96.99701740780996, -441.55052364640267, -243.33625530064106, -411.43845629070506, -253.40950016461744, -228.3009050323874, 22.615320643427545, -653.447357364054, -381.7789206121354, -424.12840896785946, -211.00746938503602, -238.37305822386688, -249.56199791165713, -545.7309906799654, -75.50947681493724, -295.8402455784872, -390.01516840457515, -432.44801075054284, -442.9387112020291, -60.221926520587274, -249.69679743521996, -35.13439175549727, -426.5976178129348, -99.16843207291619, -280.6702053545013, -111.03553027849756, -60.5024507660472, -484.5946976905673, -221.29174088682618, -369.07183430142163, -511.8074097010876, -349.43722851026865, -434.71733225970524, -77.78768953073366, -409.7932125901978, 90.12636188550154, -381.96569789604075, -330.03068823141007, -393.9987018190033, -178.15189231271933, 194.6, -417.29655274634774, -462.95107732625377, -168.12621333277778, -507.6842462926337, -152.14113833742562, -267.7627393441963, -281.21320362071276, -620.3265026963827, -380.56472921896204, -451.20646515261586, -175.98326249266213, -154.00201133753689, -293.0634788069852, -352.9387876921257, -334.155636974244, -256.71029172768743, -380.3589605513715, -425.67406441698597, -156.78422349132646, -321.70034542375794, -292.6169191521276, -326.5737234775969, -383.500635937685, -335.14239038109895, -177.6230678942348, -326.26877328879266, -359.0305517161663, -371.4049300772125, -373.6459838716034, -322.2393774825095, -264.6863972239712, -185.51556424594102, -351.449493203633, -381.23920082867517, -53.773768147791806, -26.984577169121792, -368.83882783286214, -288.1950652735693, -275.82015699902007, -59.17350450857392, -449.69092166298225, -183.90280533391228, -372.1269353680287, -142.7308316192799, -265.78764780215954, 14.26203466780011, -364.0586729479151, -587.9886716662787, -270.68346508029816, -537.4621325724302, -370.9168735531205, -87.61914038722675, -460.7435366258213, -56.986424081575244, -456.4309559483638, -305.58875598256816, -392.7682735230714, -188.5286585738042, -281.78480711746977, -373.57946452616443, -437.39410922694907, -493.357564815875, -369.2014880537868, -482.0392639480935, -399.6018291666484, -592.9288506941989, -311.3830307249129, -276.020856252833, -316.95961623485516, -135.50298284128382, -598.3499073502686], "policy_predator_policy_reward": [341.3514050119342, 376.986767708357, 413.05248799847874, 493.8391127320967, 293.94478687643925, 277.03375332073927, 386.7289576742447, 344.738845350968, 346.69688165142134, 356.4697782289828, 416.5443626288426, 326.2961174071596, 266.70124890973017, 325.61796758072654, 418.2797773443804, 372.1870661586642, 152.439453258142, 436.8236522302626, 459.1528963715073, 297.09252671072875, 394.2400416585318, 451.2972500029708, 225.87856245035988, 533.3877421643007, 488.650785357903, 403.0049475144968, 335.3981057069758, 364.8564634223331, 265.33429152275085, 457.0432769575321, 364.4022279462714, 447.55782672687263, 314.0469607667038, 248.4649200810963, 343.2899395317344, 378.1048490567805, 653.716887048151, 442.9112452357534, 379.2424311091965, 402.9982308326265, 324.3053105269787, 319.60063174989, 585.7116930468842, 428.94769290382055, 279.91743627651823, 302.9600743084237, 386.09281178726104, 394.3390738286722, 4.177905810901051, 310.0901567349452, 374.0073552835855, 397.03086065522444, 320.50889756744994, 686.9373253701392, 638.3075187965848, 503.5859834441393, 531.4519278940983, 298.04149872525136, 273.13870712505513, 356.71395817091934, 563.503133217533, 302.8077576990599, 345.6614981655015, 345.5804262743432, 400.18869613001357, 353.0658849868474, 343.33480923722817, 464.41310234390045, 372.34328086268164, 261.6018060647328, 415.66172805389385, 264.3291218523752, 271.5119067101651, 403.75716150875377, 501.5579548520321, 223.00319714234732, 434.77376239599164, 299.0486615284316, 362.8998435384865, 457.290675993226, 292.34237849709643, 288.0047770925895, 360.9007889254413, 377.91952382227, 385.07936117791246, 309.4495807376854, 367.8418536810786, 290.07298775476335, 444.84073703130855, 464.24347419368286, 368.9328979320209, 207.77645094164708, 513.6293116359427, 327.81046213347173, 332.60592884972215, 341.5119183229834, 581.5157160789075, 283.1003528286791, 349.8807854792811, 424.85532417770264, 500.06159337434485, 545.4757561922432, 97.06727104076766, 519.6430281354496, 325.019703920775, 318.2233924890674, 199.25172632897707, 352.68440761986824, 482.86296185553914, 307.82232313556455, 295.48953661460104, 383.68748124225885, 435.20469120766046, 179.43059956116312, 314.70741443164303, 391.3370043909501, 330.90705662093245, 679.0393033126561, 462.69195805414216, 334.55455502977736, 627.5588507102374, 472.6509389298844, 329.23326898322375, 390.64462450391306, 299.56894330009374, 387.8836103692123, 393.4190866639782, 232.3567352982067, 333.41779889992534, 268.9694561470491, 317.2825922190609, 269.4410981498959, 324.6275247152045, 504.1040548955178, 323.1967401007409, 472.5670937571841, 410.98653202015237, 410.99262487638936, 478.0649386282338, 480.25610195102854, 428.3946666505015, 310.6687578077454, 354.7347731978267, 367.4705033108414, 369.8846878011799, 414.2979966224965, 164.5542029665673, 365.9814486364091, 357.0433715734081, 336.8081212890758, 464.24235064970753, 261.0728551638785, 319.5669899342981, 437.6860814563267, 292.25725987593296, 303.68267774790564, 345.2451790955859, 269.94319767801164, 267.46200783947086, 313.0968207651731, 334.67839151080267, 45.885454034162265, 300.19838110154365, 311.2333716286911, 410.92683463066953, 356.1305609601475, 111.60404361924952, 390.2412005254836, 298.5810749924149, 285.0921605263999, 370.92459894487695, 115.26181001473186, 392.82489655152193, 276.44369585707466, 242.18170501258572, 354.1282734133587, 296.2436805798172, 319.2972283317741, 343.2041927865832, 112.49144719311859, 409.9238301925713, 265.02486855835105, 320.8949216101995, 352.25737001063993, 302.52807479415594, 640.6366133756308, 180.2585371860881, 444.9398785493292, 213.87456153385938, 317.1282823995316, 342.3382304838889, 56.07672915301349, 488.12336286167016, 139.0545496813412, 446.3705690152235, 412.1914090055627, 294.03664244677555, 506.6561265634983, 343.29027036257014, 338.3260568800922, 162.6474495049246, 426.77909754080576, 327.1124460988971, 254.37410925078814, 339.7286577107683, 267.26468652821563, 391.08943507215054, 427.3463177464203, 517.3776675194262, 446.57589223600417, 306.6339588718633, 398.89586005512484, 552.8441185671534, 447.58693215569895, 322.1482333687529, 275.63388303019, 308.3909409259914, 461.60977081369106, 368.1420864048438, 438.33626614577287, 573.4541783977779, 280.26718618382847, 775.8311745952092, 226.04545961946195, 312.4801733543772, 303.19527214553887, 487.6617187512433, 277.054621823511, 125.63503755409177, 385.37886067810246, 327.27796837608224, 443.93278957263175, 400.1299924495619, 396.1600041190985, 375.1284110431732, 375.64825579588904, 248.53360686001756, 437.0012313025852, 355.98035745196495, 310.05540077407204, 329.97201792850854, 390.8529948003988, 412.47981839893237, 369.79258626395637, 532.9075230709673, 369.13546776409953, 396.794867177869, 362.3944290730844, 324.5194897120692, 484.6648412399635, 377.9538497576339, 357.2899695874202, 460.90884892249204, 285.1678399416803, 364.2072884679732, 336.3441878053119, 357.52019403457996, 425.69766688691516, 401.5210070748736, 317.06124380721354, 192.7492164810911, 396.3507834160914, 332.1115286813256, 430.7858475236472, 272.91740954465956, 382.2176814780093, 439.72115397224155, 423.4181924920305, 310.23650899608504, 320.36196978488454, 203.45404711901995, 377.1799101830936, 665.5431152898196, 369.6864144091929, 289.5357214055489, 484.2603006502289, 355.8358721263754, 492.63291016092353, 58.71518713832809, 418.6078042483941, 300.9382220455124, 197.31367601180688, 339.4598378961532, 273.395155475546, 346.1270775332937, 266.30123393824766, 109.9707328264543, 323.52960791889757, 376.48448497404235, 510.24696946953605, 342.7485791606963, 594.671553625741, 375.78598016653837, 248.9491787191481, 355.5655050579598, 327.8727841125236, 44.065468228735845, 342.26909237362156, 453.2684502193334, 402.01890668605745, 425.58877659257297, 406.3022603173411, 562.4472558756653, 130.63559562295117, 533.3670089264848, 378.619481400943, 304.5284422245479, 318.14213260691383, 320.7473621917502, 385.0904436631959, 294.83743107679305, 310.8727547482898, 319.9293600303037, 261.7054937930098, 383.4772939376511, 295.418276942724, 307.09405643586496, 313.1735002679859, 276.1157275004466, 324.6066450056244, 287.84075225840223, 415.66501877199835, 256.262555446598, 411.43845629070506, 305.8204618051179, 319.508026976496, 183.58517775208503, 656.6100425122435, 434.47596953742413, 405.65050148307705, 221.05401829396345, 240.3678806346373, 264.8078687256827, 552.1506670758858, 15.572061086490436, 374.3665026044016, 406.8768232201035, 418.88135317177336, 495.59853133843933, 139.00429781823524, 272.10737585407605, 4.272841902746554, 389.9532130213426, 282.2000000466698, 98.92064510023013, 354.60925357827455, 450.1853352281841, 457.2228178560027, 300.5039912862055, 376.4561607167701, 511.8074097010876, 349.43722851026865, 413.9003860329998, 311.38349227703276, 435.4028557575633, 30.20113585014085, 363.0303058970154, 326.0723529866963, 391.67151038076463, 304.87580798226264, 10.300078281675393, 417.29655274634774, 374.5799821328201, 394.829568684802, 462.53787994171785, 427.77175027977114, 330.11949517699657, 282.5726308079294, 620.3265026963827, 381.48680919837096, 217.60221195961816, 506.344123520431, 327.4975061465714, 277.0440839443643, 331.88436580321803, 353.70943043633474, 267.9729698528688, 380.516212631795, 353.79243381796437, 379.95435232108315, 388.1000984132945, 288.3564806892448, 326.41804519611185, 383.7826557599787, 322.6966302072773, 396.75181583881607, 327.9793726093223, 359.93661864988104, 425.8415525626758, 306.96784447090954, 322.2393774825095, 283.38639722397136, 235.92129516831832, 352.84949320363296, 287.5931726150435, 362.4610563442414, 314.3762677475152, 357.4715496522849, 301.60126180676986, 262.4882578844261, 385.8868907185764, 377.0588776951676, 213.2216694858352, 355.9463050619012, 302.0803325198502, 293.36184825189844, 19.62283222837191, 366.65867294791514, 609.1051516001955, 292.35927729880933, 529.8032430916189, 389.0477848138027, 287.3943816425811, 453.3524719824232, 115.46670085335634, 481.50435174851583, 305.58875598256816, 392.7682735230714, 247.65158913598603, 224.29883293336917, 334.9756458159041, 473.85063887033067, 498.5806153534591, 361.1663200321237, 482.0392639480935, 399.4241750800788, 593.233514778795, 312.1830307249128, 241.08251174121895, 367.53029588399687, 543.2771412871133, 301.24437164334677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 36.33534249761773, "mean_inference_ms": 32.2197581469552, "mean_action_processing_ms": 23.190627320617303, "mean_env_wait_ms": 9.743006267204814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9830715479674162, "StateBufferConnector_ms": 3.049278590414259, "ViewRequirementAgentConnector_ms": 12.110069394111633}, "num_episodes": 216, "episode_return_max": 416.49251868138737, "episode_return_min": -75.51242433498668, "episode_return_mean": 83.20146834679541, "episodes_this_iter": 216}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1681760, "num_agent_steps_trained": 1681760, "num_env_steps_sampled": 420440, "num_env_steps_trained": 420440, "num_env_steps_sampled_this_iter": 8880, "num_env_steps_trained_this_iter": 8880, "num_env_steps_sampled_throughput_per_sec": 13.678526897838175, "num_env_steps_trained_throughput_per_sec": 13.678526897838175, "timesteps_total": 420440, "num_env_steps_sampled_lifetime": 420440, "num_agent_steps_sampled_lifetime": 1681760, "num_steps_trained_this_iter": 8880, "agent_timesteps_total": 1681760, "timers": {"training_iteration_time_ms": 139208.943, "restore_workers_time_ms": 3.704, "training_step_time_ms": 139198.789, "sample_time_ms": 40083.569, "learn_time_ms": 98572.693, "learn_throughput": 82.051, "synch_weights_time_ms": 496.539}, "counters": {"num_env_steps_sampled": 420440, "num_env_steps_trained": 420440, "num_agent_steps_sampled": 1681760, "num_agent_steps_trained": 1681760}, "done": false, "training_iteration": 53, "trial_id": "cdf01_00000", "date": "2024-08-20_11-22-08", "timestamp": 1724133128, "time_this_iter_s": 652.1322069168091, "time_total_s": 3624.864823579788, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e63820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3624.864823579788, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 96.78306636155605, "ram_util_percent": 83.70846681922198}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.6190508263451715, "cur_kl_coeff": 5.456968210637569e-13, "cur_lr": 0.0001, "total_loss": 8.92723473897056, "policy_loss": -0.0028762860981274454, "vf_loss": 8.930111008598692, "vf_explained_var": -0.3176646113395691, "kl": 0.0022197401690830375, "entropy": 0.1560009009071759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 33425.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.537593718937465, "cur_kl_coeff": 1.4901161193847655e-09, "cur_lr": 0.0001, "total_loss": 8.211733022568717, "policy_loss": -0.005008585954691091, "vf_loss": 8.21674158459618, "vf_explained_var": 0.34707493015698027, "kl": 0.004161245737059975, "entropy": 0.3437312662601471, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 33425.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 428440, "num_env_steps_trained": 428440, "num_agent_steps_sampled": 1713760, "num_agent_steps_trained": 1713760}, "env_runners": {"episode_reward_max": 392.81068550976204, "episode_reward_min": -75.51242433498668, "episode_reward_mean": 88.40486441390067, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -683.8386919836673, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.6, "predator_policy": 674.5679875803719}, "policy_reward_mean": {"prey_policy": -297.77122071681555, "predator_policy": 341.97365292376594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.87078342926156, 191.6370785009357, 304.83380729976165, 43.105434021575185, 254.06206334774694, 77.53588666200909, 5.211997850637223, 29.74926286092912, 61.96191359938528, 25.963695975996085, 124.33642274302375, 53.592852991337516, 63.54429980004255, 0.7000000000000035, 238.8897366789761, 15.856712334138944, 0.30940630806901126, 2.5000000000000013, 150.227447847548, -75.51242433498668, 212.1613123419269, 0.2418303833400055, 146.9782397607576, 160.1841465120833, 67.98488211881913, 272.6808201732355, 0.08418758087281564, 95.54472480658498, 0.09999999999999387, 141.71920138017333, 392.81068550976204, 1.0000000000000013, -0.0344085075831706, -3.368177034788306, 109.56873642481331, 177.51780904348726, 164.95822997618836, 12.926300145957304, 143.61808358460993, 209.36318354370022, 34.2191414405051, 12.041371319698609, 21.665547209944833, 18.588841297466875, 3.2949972367589284, 131.44219143405826, -8.450971433894127, 146.38716318216095, 61.824163045507106, 362.311004627573, 86.59657681472744, 2.220446049250313e-16, 212.77885651959429, 145.93714090300762, -22.893727243738624, 124.39672423130466, 204.90007828167538, 138.3322601585908, 230.48424559142987, 63.71618302001551, 0.922079979408873, 96.75660783477252, 157.47609994641405, -1.5006284268172803, 11.419930205605153, 151.28849823073614, 62.13931452665314, 0.12634154080864946, 206.68298777075955, 2.616666254244274, -12.241516915230964, 18.700000000000085, 51.805730922377926, 215.04125998281674, 276.02441239781655, 0.07429741860658723, 254.08134224218688, 13.138233845795892, 186.92370135030947, 36.48486689617217, 42.79229215242568, 10.472021779870865, 192.38417661195575, 83.55367257193349, -2.220446049250313e-16, 1.6369563780816638, -2.1472890668787743, -2.812117484079285, -0.17765408656960902, 1.104664084596012, 15.632335137527665, 110.66862273890763, 30.9619492547844, 89.13188846133414, 153.3428836635481, 15.099999999999971, 198.88167943500645, 271.69032039576484, -70.29697370493918, 138.3604006251697], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-307.75828854285794, -511.2968258384363, -169.122037993162, -374.4847028509567, 102.54502476013712, -543.7879063245484, -278.62243892713144, -378.8236033245784, -411.221615336852, -117.93418223689656, -240.07417269777434, -400.9721915223032, -190.3601943948083, -393.52780765173696, -351.4311587601164, -381.71695458392674, -232.63812917912193, -360.53504824416274, -404.30891339575567, -432.8667370925196, -365.2844177619675, -140.97763827597996, -179.69463363575392, -347.34647067502317, -585.1770045464364, -386.5082253525327, -288.8357214055489, -484.2603006502289, -488.10240175609033, -121.47664385223156, -42.85847480418904, -418.6078042483941, -292.9615244583875, -204.98096729086342, -339.4598378961532, -270.895155475546, -370.7146738989784, -91.48618972501575, -183.9437897356285, -325.0689753447093, -454.0858425893527, -220.48429951229963, -337.23226453923024, -599.9460378638665, -460.1049514358079, -17.651967689120674, -366.6886838676968, -156.56545879070293, -239.60863614311396, -78.74104234042488, -99.13318599112836, -483.47335074102784, -425.58877659257297, -406.2180727364683, -573.741047350532, -23.79707934149816, -533.3670089264848, -378.519481400943, -144.97527107596747, -335.976102375321, -418.1493476987661, 105.12222735357848, -294.83743107679305, -309.8727547482899, -319.52936003030374, -262.139902300593, -307.88895820957, -374.3747897055939, -336.32456926166196, -174.37425101737603, -80.60828868694718, -342.59627477563623, -96.99701740780996, -441.55052364640267, -243.33625530064106, -411.43845629070506, -253.40950016461744, -228.3009050323874, 22.615320643427545, -653.447357364054, -381.7789206121354, -424.12840896785946, -211.00746938503602, -238.37305822386688, -249.56199791165713, -545.7309906799654, -75.50947681493724, -295.8402455784872, -390.01516840457515, -432.44801075054284, -442.9387112020291, -60.221926520587274, -249.69679743521996, -35.13439175549727, -426.5976178129348, -99.16843207291619, -280.6702053545013, -111.03553027849756, -60.5024507660472, -484.5946976905673, -221.29174088682618, -369.07183430142163, -511.8074097010876, -349.43722851026865, -434.71733225970524, -77.78768953073366, -409.7932125901978, 90.12636188550154, -381.96569789604075, -330.03068823141007, -393.9987018190033, -178.15189231271933, 194.6, -417.29655274634774, -462.95107732625377, -168.12621333277778, -507.6842462926337, -152.14113833742562, -267.7627393441963, -281.21320362071276, -620.3265026963827, -380.56472921896204, -451.20646515261586, -175.98326249266213, -154.00201133753689, -293.0634788069852, -352.9387876921257, -334.155636974244, -256.71029172768743, -380.3589605513715, -425.67406441698597, -156.78422349132646, -321.70034542375794, -292.6169191521276, -326.5737234775969, -383.500635937685, -335.14239038109895, -177.6230678942348, -326.26877328879266, -359.0305517161663, -371.4049300772125, -373.6459838716034, -322.2393774825095, -264.6863972239712, -185.51556424594102, -351.449493203633, -381.23920082867517, -53.773768147791806, -26.984577169121792, -368.83882783286214, -288.1950652735693, -275.82015699902007, -59.17350450857392, -449.69092166298225, -183.90280533391228, -372.1269353680287, -142.7308316192799, -265.78764780215954, 14.26203466780011, -364.0586729479151, -587.9886716662787, -270.68346508029816, -537.4621325724302, -370.9168735531205, -87.61914038722675, -460.7435366258213, -56.986424081575244, -456.4309559483638, -305.58875598256816, -392.7682735230714, -188.5286585738042, -281.78480711746977, -373.57946452616443, -437.39410922694907, -493.357564815875, -369.2014880537868, -482.0392639480935, -399.6018291666484, -592.9288506941989, -311.3830307249129, -276.020856252833, -316.95961623485516, -135.50298284128382, -598.3499073502686, -266.74163106102776, -53.67806718836306, -242.48019684813772, -364.2705743066382, -9.76742127126989, -683.8386919836673, -288.55466174554476, -35.62620738008575, -87.32424382193912, -319.73215823396174, -80.26944383251134, -430.6151216658883, -150.52902691938118, -304.29962312681005, -482.23402128252155, -188.86250866216432], "policy_predator_policy_reward": [324.5194897120692, 484.6648412399635, 377.9538497576339, 357.2899695874202, 460.90884892249204, 285.1678399416803, 364.2072884679732, 336.3441878053119, 357.52019403457996, 425.69766688691516, 401.5210070748736, 317.06124380721354, 192.7492164810911, 396.3507834160914, 332.1115286813256, 430.7858475236472, 272.91740954465956, 382.2176814780093, 439.72115397224155, 423.4181924920305, 310.23650899608504, 320.36196978488454, 203.45404711901995, 377.1799101830936, 665.5431152898196, 369.6864144091929, 289.5357214055489, 484.2603006502289, 355.8358721263754, 492.63291016092353, 58.71518713832809, 418.6078042483941, 300.9382220455124, 197.31367601180688, 339.4598378961532, 273.395155475546, 346.1270775332937, 266.30123393824766, 109.9707328264543, 323.52960791889757, 376.48448497404235, 510.24696946953605, 342.7485791606963, 594.671553625741, 375.78598016653837, 248.9491787191481, 355.5655050579598, 327.8727841125236, 44.065468228735845, 342.26909237362156, 453.2684502193334, 402.01890668605745, 425.58877659257297, 406.3022603173411, 562.4472558756653, 130.63559562295117, 533.3670089264848, 378.619481400943, 304.5284422245479, 318.14213260691383, 320.7473621917502, 385.0904436631959, 294.83743107679305, 310.8727547482898, 319.9293600303037, 261.7054937930098, 383.4772939376511, 295.418276942724, 307.09405643586496, 313.1735002679859, 276.1157275004466, 324.6066450056244, 287.84075225840223, 415.66501877199835, 256.262555446598, 411.43845629070506, 305.8204618051179, 319.508026976496, 183.58517775208503, 656.6100425122435, 434.47596953742413, 405.65050148307705, 221.05401829396345, 240.3678806346373, 264.8078687256827, 552.1506670758858, 15.572061086490436, 374.3665026044016, 406.8768232201035, 418.88135317177336, 495.59853133843933, 139.00429781823524, 272.10737585407605, 4.272841902746554, 389.9532130213426, 282.2000000466698, 98.92064510023013, 354.60925357827455, 450.1853352281841, 457.2228178560027, 300.5039912862055, 376.4561607167701, 511.8074097010876, 349.43722851026865, 413.9003860329998, 311.38349227703276, 435.4028557575633, 30.20113585014085, 363.0303058970154, 326.0723529866963, 391.67151038076463, 304.87580798226264, 10.300078281675393, 417.29655274634774, 374.5799821328201, 394.829568684802, 462.53787994171785, 427.77175027977114, 330.11949517699657, 282.5726308079294, 620.3265026963827, 381.48680919837096, 217.60221195961816, 506.344123520431, 327.4975061465714, 277.0440839443643, 331.88436580321803, 353.70943043633474, 267.9729698528688, 380.516212631795, 353.79243381796437, 379.95435232108315, 388.1000984132945, 288.3564806892448, 326.41804519611185, 383.7826557599787, 322.6966302072773, 396.75181583881607, 327.9793726093223, 359.93661864988104, 425.8415525626758, 306.96784447090954, 322.2393774825095, 283.38639722397136, 235.92129516831832, 352.84949320363296, 287.5931726150435, 362.4610563442414, 314.3762677475152, 357.4715496522849, 301.60126180676986, 262.4882578844261, 385.8868907185764, 377.0588776951676, 213.2216694858352, 355.9463050619012, 302.0803325198502, 293.36184825189844, 19.62283222837191, 366.65867294791514, 609.1051516001955, 292.35927729880933, 529.8032430916189, 389.0477848138027, 287.3943816425811, 453.3524719824232, 115.46670085335634, 481.50435174851583, 305.58875598256816, 392.7682735230714, 247.65158913598603, 224.29883293336917, 334.9756458159041, 473.85063887033067, 498.5806153534591, 361.1663200321237, 482.0392639480935, 399.4241750800788, 593.233514778795, 312.1830307249128, 241.08251174121895, 367.53029588399687, 543.2771412871133, 301.24437164334677, 351.38164750417485, 0.0, 356.09619842217154, 339.78646119393784, 172.38100933811418, 674.5679875803719, 288.55466174554476, 50.72620738008574, 292.49262128505075, 313.44546020585625, 389.7793417807662, 392.7955441133982, 73.45006122667901, 311.08161511457314, 467.7128367195788, 341.74409385027644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.44863447372251, "mean_inference_ms": 35.87105717016076, "mean_action_processing_ms": 23.931228854027285, "mean_env_wait_ms": 11.021807925232778, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.151818871498108, "StateBufferConnector_ms": 4.5892558097839355, "ViewRequirementAgentConnector_ms": 15.281166791915894}, "num_episodes": 8, "episode_return_max": 392.81068550976204, "episode_return_min": -75.51242433498668, "episode_return_mean": 88.40486441390067, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1713760, "num_agent_steps_trained": 1713760, "num_env_steps_sampled": 428440, "num_env_steps_trained": 428440, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 25.0268658498998, "num_env_steps_trained_throughput_per_sec": 25.0268658498998, "timesteps_total": 428440, "num_env_steps_sampled_lifetime": 428440, "num_agent_steps_sampled_lifetime": 1713760, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1713760, "timers": {"training_iteration_time_ms": 167306.769, "restore_workers_time_ms": 5.244, "training_step_time_ms": 167293.95, "sample_time_ms": 44508.441, "learn_time_ms": 121996.979, "learn_throughput": 66.297, "synch_weights_time_ms": 728.776}, "counters": {"num_env_steps_sampled": 428440, "num_env_steps_trained": 428440, "num_agent_steps_sampled": 1713760, "num_agent_steps_trained": 1713760}, "done": false, "training_iteration": 54, "trial_id": "cdf01_00000", "date": "2024-08-20_11-27-33", "timestamp": 1724133453, "time_this_iter_s": 321.1958169937134, "time_total_s": 3946.0606405735016, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e3dc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3946.0606405735016, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 96.83940774487472, "ram_util_percent": 83.87835990888382}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.625598550221277, "cur_kl_coeff": 2.7284841053187846e-13, "cur_lr": 0.0001, "total_loss": 8.760572654481917, "policy_loss": -0.0034568104782097394, "vf_loss": 8.764029402959915, "vf_explained_var": -0.19684399224462965, "kl": 0.0021987520256501855, "entropy": 0.14604290613815898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 34055.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.742305931401631, "cur_kl_coeff": 7.450580596923828e-10, "cur_lr": 0.0001, "total_loss": 8.38591472307841, "policy_loss": -0.004089677479443332, "vf_loss": 8.39000445547558, "vf_explained_var": 0.3338087768781753, "kl": 0.0033869731864681865, "entropy": 0.34169182559800526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 34055.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 436440, "num_env_steps_trained": 436440, "num_agent_steps_sampled": 1745760, "num_agent_steps_trained": 1745760}, "env_runners": {"episode_reward_max": 359.8959883706997, "episode_reward_min": -70.29697370493918, "episode_reward_mean": 91.2664478551464, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -683.8386919836673, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 91.71543689380749, "predator_policy": 674.5679875803719}, "policy_reward_mean": {"prey_policy": -294.86061457403935, "predator_policy": 340.49383850161263}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.419930205605153, 151.28849823073614, 62.13931452665314, 0.12634154080864946, 206.68298777075955, 2.616666254244274, -12.241516915230964, 18.700000000000085, 51.805730922377926, 215.04125998281674, 276.02441239781655, 0.07429741860658723, 254.08134224218688, 13.138233845795892, 186.92370135030947, 36.48486689617217, 42.79229215242568, 10.472021779870865, 192.38417661195575, 83.55367257193349, -2.220446049250313e-16, 1.6369563780816638, -2.1472890668787743, -2.812117484079285, -0.17765408656960902, 1.104664084596012, 15.632335137527665, 110.66862273890763, 30.9619492547844, 89.13188846133414, 153.3428836635481, 15.099999999999971, 198.88167943500645, 271.69032039576484, -70.29697370493918, 138.3604006251697, 300.0338427373802, 122.69158945250942, 109.61373498451546, 2.7000000000000006, 59.282632423467135, 88.73408373587432, 27.968987041991387, 3.1866281228821807, 117.97586312166094, 310.2477388042866, 127.99394671114503, 123.67534376271439, 41.72777277991823, 46.02099256573809, 40.81534439594236, 65.61842548411717, 26.008981720720055, -40.877943089205, 74.70638358630427, 180.66949732712428, 41.97319704198866, 203.81762900069793, 86.81547795423177, -6.747714462978955, 46.328486508258706, 146.23611703089682, 17.06876673439933, 70.10694821828854, 164.20792015577484, 278.7831771533854, 273.675320792334, 58.87641999723719, 0.0, 8.660253635411848, 1.1196695497941307, 175.1736972396297, 214.75688864403202, 1.0284165184255871, 143.46931555040658, 139.5379210661223, 339.9399329080234, 105.35754747224094, 217.13370023641357, 5.106393353184311, 269.08340622017005, 238.63918196568076, 110.85800147166545, 3.07727244314904, -24.509413893234072, 2.7412166679430463, 4.599999999999998, 1.8772202462522893, 14.699999999999969, 6.530136325654745, -6.661338147750939e-16, 239.59131145080292, 359.8959883706997, 12.146177487330919, -10.260138021206444, 90.39630699446582, 202.68168178872386, -3.552713678800501e-15, 100.18944738722786, 188.60176502393165], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-256.71029172768743, -380.3589605513715, -425.67406441698597, -156.78422349132646, -321.70034542375794, -292.6169191521276, -326.5737234775969, -383.500635937685, -335.14239038109895, -177.6230678942348, -326.26877328879266, -359.0305517161663, -371.4049300772125, -373.6459838716034, -322.2393774825095, -264.6863972239712, -185.51556424594102, -351.449493203633, -381.23920082867517, -53.773768147791806, -26.984577169121792, -368.83882783286214, -288.1950652735693, -275.82015699902007, -59.17350450857392, -449.69092166298225, -183.90280533391228, -372.1269353680287, -142.7308316192799, -265.78764780215954, 14.26203466780011, -364.0586729479151, -587.9886716662787, -270.68346508029816, -537.4621325724302, -370.9168735531205, -87.61914038722675, -460.7435366258213, -56.986424081575244, -456.4309559483638, -305.58875598256816, -392.7682735230714, -188.5286585738042, -281.78480711746977, -373.57946452616443, -437.39410922694907, -493.357564815875, -369.2014880537868, -482.0392639480935, -399.6018291666484, -592.9288506941989, -311.3830307249129, -276.020856252833, -316.95961623485516, -135.50298284128382, -598.3499073502686, -266.74163106102776, -53.67806718836306, -242.48019684813772, -364.2705743066382, -9.76742127126989, -683.8386919836673, -288.55466174554476, -35.62620738008575, -87.32424382193912, -319.73215823396174, -80.26944383251134, -430.6151216658883, -150.52902691938118, -304.29962312681005, -482.23402128252155, -188.86250866216432, -90.56871224918027, -170.8070728989499, -78.46327126660447, -387.1004791557577, -198.50121684286776, -367.36428285479093, -248.01503974342245, -276.2488996580001, -241.76579898945457, -165.46739662583488, 17.91978074995637, -379.0799083076199, -450.8194681137214, -169.00668606558366, -317.4497341859791, -231.89194658480926, -323.0840065962601, -219.22257200933902, -477.21935432887636, -121.64428851750253, -99.13581872953598, -441.8156826511686, -5.791112059446809, 73.45410737975293, -60.21525905230885, -286.739488407181, -280.59968163220543, -618.7015951525354, -666.4531923297138, 15.461063196657705, -463.6653812416702, -213.56138414588088, -363.6350583931128, -313.59065033309196, -413.9698580001569, -186.98548143546077, -233.99121813087137, -411.0226550012867, -313.57532972333473, -316.2867844611628, -345.34202159150465, -249.15872282465878, -111.84362882480966, -390.4580511439585, -576.1922788945484, -17.418705283127146, -376.58305472078575, -367.0541277832166, -258.1783962812675, -415.95403215559406, -124.01369418622275, -440.061154786982, -293.30410129053155, -377.83908868854536, -322.71450868032537, -319.1912987036208, -92.25655597418846, -627.8706979624749, -69.73030298166634, -312.90971553186307, -335.60524742693764, -57.014369422123366, -336.4302924343962, -503.01593060415723, -347.8645947862877, -364.8547625029337, -334.7374619740474, -208.54102840297506, -409.7326960103368, -324.4998595740902, -299.2295369758638, -76.15417898414405, -105.35718258041824, -403.0281626709227, -629.890937852183, -410.1525678194042, -225.02599639617867, -442.66100062068597, -328.23787794914057, -156.9653542081894, -521.426228029995, -22.55826029736061, -399.35320494975394, -12.069767751399763, -77.37207823417856, -385.4498701385669, -340.28997832264366, -260.38935586293604, -110.8956278451673, -568.9847763467092, -539.6216847415936, 16.080448670914528, -399.2723546822122, -282.68113296528435, -341.4547446383064, -431.3292602190606, -389.1950298716955, -416.6461461370714, -339.9572064003874, -420.8019549603119, -292.16985986996855, -422.6484777602617, -384.9411637984542, -338.60996965520764, -445.7291323528666, -63.6797047298612, -389.86679054050416, -320.95262905967223, -310.23946251233565, -315.8340173459409, -463.0939557146402, -131.2021611798932, -391.35535001610305, 10.578951286089355, -324.7803606934585, -372.2941451034277, -374.5358904729319, -255.91972411287267, -373.9671455642545, -207.5213574210094, -329.7362706335927, 91.71543689380749, -352.13035508427555, -397.9060010799153, -287.95664544890354, -174.77145797526495, -99.52151530118692, -524.0607211360185], "policy_predator_policy_reward": [267.9729698528688, 380.516212631795, 353.79243381796437, 379.95435232108315, 388.1000984132945, 288.3564806892448, 326.41804519611185, 383.7826557599787, 322.6966302072773, 396.75181583881607, 327.9793726093223, 359.93661864988104, 425.8415525626758, 306.96784447090954, 322.2393774825095, 283.38639722397136, 235.92129516831832, 352.84949320363296, 287.5931726150435, 362.4610563442414, 314.3762677475152, 357.4715496522849, 301.60126180676986, 262.4882578844261, 385.8868907185764, 377.0588776951676, 213.2216694858352, 355.9463050619012, 302.0803325198502, 293.36184825189844, 19.62283222837191, 366.65867294791514, 609.1051516001955, 292.35927729880933, 529.8032430916189, 389.0477848138027, 287.3943816425811, 453.3524719824232, 115.46670085335634, 481.50435174851583, 305.58875598256816, 392.7682735230714, 247.65158913598603, 224.29883293336917, 334.9756458159041, 473.85063887033067, 498.5806153534591, 361.1663200321237, 482.0392639480935, 399.4241750800788, 593.233514778795, 312.1830307249128, 241.08251174121895, 367.53029588399687, 543.2771412871133, 301.24437164334677, 351.38164750417485, 0.0, 356.09619842217154, 339.78646119393784, 172.38100933811418, 674.5679875803719, 288.55466174554476, 50.72620738008574, 292.49262128505075, 313.44546020585625, 389.7793417807662, 392.7955441133982, 73.45006122667901, 311.08161511457314, 467.7128367195788, 341.74409385027644, 257.4622260694118, 303.94740181609785, 362.16671720095985, 226.0886226739118, 327.79074910462094, 347.68848557755337, 250.5150397434223, 276.44889965800013, 337.75324412354416, 128.76258391521142, 124.4113444388279, 325.4828668547107, 435.3470784963433, 212.44806272495302, 317.4497341859791, 235.07857470769127, 349.9333226369315, 310.34911909032775, 460.4100102835623, 448.7013713671017, 382.5855888723487, 286.3598592195009, 4.774058758142246, 51.23828968426699, 280.1849489814135, 108.49757125799488, 490.898952978158, 454.42331637232263, 666.4531923297138, 25.354281199284415, 475.86284243041393, 266.9823484412542, 336.44282813657406, 366.7918623103518, 369.7484962653488, 190.32890008106276, 373.19090833966794, 346.52934837879343, 345.82144903861973, 464.7101624730028, 341.35869722910667, 295.1152442290456, 346.30034036443493, 359.81896860503184, 574.0945192010007, 106.3319429309069, 389.66336921253463, 347.2260988284891, 304.4594731513086, 416.0014417938124, 278.44292514741534, 431.86804085668615, 285.625623258195, 402.5863334552814, 378.14491994326477, 333.86783565897167, 341.4980127859503, 542.8371613064879, 337.65105482103525, 323.7721408458795, 352.4397621544585, 313.85517548693724, 640.2085291354782, 258.1141139003142, 347.8645947862877, 364.8547625029337, 335.6300131126969, 216.3087308997373, 409.7326960103368, 325.6195291238843, 256.8337320289379, 293.72368117069993, 330.0627706720666, 393.0794632233057, 618.7216437662863, 422.3502784237264, 465.66956121081677, 345.4867513564548, 292.69552450873937, 332.04562871471217, 467.9668789060697, 415.9575423293094, 414.20256404032773, 102.5779561330675, 311.74026756673004, 368.21538104242865, 330.74144820548264, 275.04427933328145, 442.02777164535064, 506.9360387666937, 472.3040127319776, 289.8764053043822, 410.55084544782557, 382.2606436713369, 359.4986708854392, 416.36260641507687, 389.47237322083663, 391.8593888946967, 339.49899035830225, 424.0013876703401, 296.16985986996843, 423.24847776026184, 385.15404572784956, 340.2743079720652, 445.92913235286665, 78.17970472986127, 406.4520036282248, 310.89755229760624, 310.23946251233565, 315.8340173459409, 438.37840418602025, 395.50902415931654, 364.2194731331165, 376.4529139675948, 336.9265381807908, 372.2941451034277, 179.0515697681222, 441.14390679647875, 334.236161074969, 337.64864890476105, 302.7126845897027, 137.98983093880642, 352.13035508427555, 397.9060010799153, 213.29911758152898, 349.6184332298689, 363.98787487892565, 448.19612658221246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 40.88339874557661, "mean_inference_ms": 35.311975081484206, "mean_action_processing_ms": 23.43591395801076, "mean_env_wait_ms": 10.8117176379477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.9262224435806274, "StateBufferConnector_ms": 3.2993781566619873, "ViewRequirementAgentConnector_ms": 12.820383548736572}, "num_episodes": 64, "episode_return_max": 359.8959883706997, "episode_return_min": -70.29697370493918, "episode_return_mean": 91.2664478551464, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1745760, "num_agent_steps_trained": 1745760, "num_env_steps_sampled": 436440, "num_env_steps_trained": 436440, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 35.76245969040008, "num_env_steps_trained_throughput_per_sec": 35.76245969040008, "timesteps_total": 436440, "num_env_steps_sampled_lifetime": 436440, "num_agent_steps_sampled_lifetime": 1745760, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1745760, "timers": {"training_iteration_time_ms": 183140.295, "restore_workers_time_ms": 5.517, "training_step_time_ms": 183124.067, "sample_time_ms": 49526.634, "learn_time_ms": 132696.36, "learn_throughput": 60.951, "synch_weights_time_ms": 810.844}, "counters": {"num_env_steps_sampled": 436440, "num_env_steps_trained": 436440, "num_agent_steps_sampled": 1745760, "num_agent_steps_trained": 1745760}, "done": false, "training_iteration": 55, "trial_id": "cdf01_00000", "date": "2024-08-20_11-31-22", "timestamp": 1724133682, "time_this_iter_s": 225.5175540447235, "time_total_s": 4171.578194618225, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e46430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4171.578194618225, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 96.21089743589742, "ram_util_percent": 83.76955128205128}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.149513186620815, "cur_kl_coeff": 1.3642420526593923e-13, "cur_lr": 0.00010000000000000002, "total_loss": 9.113631897313255, "policy_loss": -0.003317022861717435, "vf_loss": 9.116948906012944, "vf_explained_var": -0.4841524480709008, "kl": 0.002880442027492336, "entropy": 0.13266276011709124, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.85714285714286, "num_grad_updates_lifetime": 34930.5, "diff_num_grad_updates_vs_sampler_policy": 559.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.490447867635106, "cur_kl_coeff": 3.725290298461914e-10, "cur_lr": 0.00010000000000000002, "total_loss": 8.791522234678268, "policy_loss": -0.002477887242899409, "vf_loss": 8.794000143664224, "vf_explained_var": 0.3463388123682567, "kl": 0.003224481561867216, "entropy": 0.3271070617384144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.85714285714286, "num_grad_updates_lifetime": 34930.5, "diff_num_grad_updates_vs_sampler_policy": 559.5}}, "num_env_steps_sampled": 450656, "num_env_steps_trained": 450656, "num_agent_steps_sampled": 1802624, "num_agent_steps_trained": 1802624}, "env_runners": {"episode_reward_max": 454.072069578895, "episode_reward_min": -214.7294792604344, "episode_reward_mean": 90.68610610318323, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -778.948358447006, "predator_policy": 2.6447530848056973}, "policy_reward_max": {"prey_policy": 197.29999999999998, "predator_policy": 778.948358447006}, "policy_reward_mean": {"prey_policy": -311.30365243379276, "predator_policy": 356.64670548538436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [214.75688864403202, 1.0284165184255871, 143.46931555040658, 139.5379210661223, 339.9399329080234, 105.35754747224094, 217.13370023641357, 5.106393353184311, 269.08340622017005, 238.63918196568076, 110.85800147166545, 3.07727244314904, -24.509413893234072, 2.7412166679430463, 4.599999999999998, 1.8772202462522893, 14.699999999999969, 6.530136325654745, -6.661338147750939e-16, 239.59131145080292, 359.8959883706997, 12.146177487330919, -10.260138021206444, 90.39630699446582, 202.68168178872386, -3.552713678800501e-15, 100.18944738722786, 188.60176502393165, -5.276628028785823, 4.576266226672348, -1.1102230246251565e-15, 181.33232184985883, 42.77179695838286, 7.142996605150517, 6.63972278999611, 164.52455609967882, -24.80106314319002, 1.793273783871784, 0.3999999999999988, 86.93494880278156, 396.7976929717852, 249.90365258339014, 281.0127349319955, 225.51885675873348, 27.03968393785834, 85.02962606768975, 0.0, 1.3322676295501878e-15, 35.47061626373579, 242.45214686585243, 202.59198958302665, -1.2271885316498077, 16.930524281059853, 141.49089892316258, 394.9138315767018, 2.513809116093165, 101.57961144041418, 309.7225472461235, -7.176189035327743, 0.6699260770240429, 37.65956585223308, 16.287662839375045, 104.06771620670398, 351.2593569931396, 3.4007628855973095, 136.01505806778624, -10.728307121341192, 9.406614981520915, 244.28479111860554, 0.08453172133563691, -78.75115439656939, 3.8221965689518558, 84.03839895619817, 202.42505553979694, 187.76397004473228, -16.568278670143336, -1.077318304405594, -0.4685886846063725, 280.55019903999397, 5.399999999999995, 86.62884622006372, 176.69415303705625, 11.98150475417679, 1.299999999999995, 15.407862150324931, 0.6999999999999997, 454.072069578895, 8.598822131551712, 5.904764086410709, 89.49340107015338, 51.58985127210006, 175.70769290224644, 139.44475308480565, 22.49350718907982, -214.7294792604344, 5.699999999999994, 13.620519254628135, 263.86629627840404, 37.32570648384567, 15.49546576592004], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-105.35718258041824, -403.0281626709227, -629.890937852183, -410.1525678194042, -225.02599639617867, -442.66100062068597, -328.23787794914057, -156.9653542081894, -521.426228029995, -22.55826029736061, -399.35320494975394, -12.069767751399763, -77.37207823417856, -385.4498701385669, -340.28997832264366, -260.38935586293604, -110.8956278451673, -568.9847763467092, -539.6216847415936, 16.080448670914528, -399.2723546822122, -282.68113296528435, -341.4547446383064, -431.3292602190606, -389.1950298716955, -416.6461461370714, -339.9572064003874, -420.8019549603119, -292.16985986996855, -422.6484777602617, -384.9411637984542, -338.60996965520764, -445.7291323528666, -63.6797047298612, -389.86679054050416, -320.95262905967223, -310.23946251233565, -315.8340173459409, -463.0939557146402, -131.2021611798932, -391.35535001610305, 10.578951286089355, -324.7803606934585, -372.2941451034277, -374.5358904729319, -255.91972411287267, -373.9671455642545, -207.5213574210094, -329.7362706335927, 91.71543689380749, -352.13035508427555, -397.9060010799153, -287.95664544890354, -174.77145797526495, -99.52151530118692, -524.0607211360185, -181.2501996354787, -202.580729102901, -354.6999577764442, -458.9495462212347, -576.328178239421, -439.85434698956374, -527.5547956913476, 140.41443642859895, -15.04642549510336, -462.5838878983337, -417.3335646992223, -370.5264490814642, -252.44753397564605, -354.1359243262072, -246.41108316006284, -433.2637972774772, -442.19437495913934, -357.2430145968585, -436.9199385558998, -397.95578677595887, -310.2205806182934, -400.98416614153354, -358.187871746447, -227.61360743359467, 197.29999999999998, -365.2120556286103, -178.70190097774963, -454.9724404155428, -58.644207586298215, -512.0949202934019, -368.01239721410656, 167.88142431360177, -436.68763184658224, -589.3150005399214, -369.95349016273383, -86.16196810337897, -364.7923590301874, -394.2932806939821, -350.5227940226041, -366.45628608639885, -280.7203127633083, -283.0356380501265, -151.6313403316183, -427.2577233215249, -348.0161108479756, -44.3043674719375, -303.1697894188617, -272.788908487519, -392.2583457287444, -474.6415106180287, -537.6566854217423, -119.78596862646435, -336.36960380860313, 148.42544907367338, -426.56895376439525, -360.1974038431716, -276.07135624347677, -299.0114245784081, -587.0608604985734, 104.22888067495076, -183.40349409702924, -274.45680086949926, -363.8412812897157, -423.6800410568816, -439.4267502364665, -76.42131064037432, -468.8217136644159, -246.4497251153005, -475.3773629815001, -377.7143657425282, -412.41640529130416, 9.11413831181196, -282.8643188791164, -479.86925635592695, -201.6646541276759, -361.7369955978739, -438.6905875280237, -355.0802802930189, -303.9936022166937, -262.1759256506545, -634.0575577766565, -34.90600154866245, -451.9971718906138, -492.4562853368843, -242.59933190526638, -313.6218641475374, -404.5999613859434, -377.56631649880893, -236.9886736356083, -401.4695389112723, -90.72585753384021, -400.03385657484415, -254.44188907408687, -359.1835702622431, -389.3981907054077, -493.14528374912373, -344.7548112753919, -432.01106994234397, -477.7271079479567, -355.1814246079721, -256.1834379424201, -60.97366173995909, -331.81600758450656, -226.32810644692495, -304.1491435145093, -317.6488422730832, -385.844740925562, -89.06484739921487, -295.3448087924153, -222.12307515482732, -368.0688090967698, -595.9527034058729, -279.2025871826667, -318.13798005700437, -304.41388706750985, -778.948358447006, -421.22018441803084, 28.49502427971879, -227.01543705398726, -332.379497354371, -306.467635880869, -324.78886505760437, -117.71128625923379, -409.1198376941136, -349.77605548838494, -512.9241138243669, -174.44092692890516, -518.4120752646402, 135.20000000000005, -388.2288130701224, -279.6649734322159, -237.5414466526678, -523.5692392565687, -390.44422891677607, -367.3690727583131, -275.2536195300966, -317.16373049737336, -315.4172265135926, 140.61645914412068, -332.21830099224184, -239.39522347889383, -353.6990514755867, -367.25633602998613, -273.0075207539829], "policy_predator_policy_reward": [330.0627706720666, 393.0794632233057, 618.7216437662863, 422.3502784237264, 465.66956121081677, 345.4867513564548, 292.69552450873937, 332.04562871471217, 467.9668789060697, 415.9575423293094, 414.20256404032773, 102.5779561330675, 311.74026756673004, 368.21538104242865, 330.74144820548264, 275.04427933328145, 442.02777164535064, 506.9360387666937, 472.3040127319776, 289.8764053043822, 410.55084544782557, 382.2606436713369, 359.4986708854392, 416.36260641507687, 389.47237322083663, 391.8593888946967, 339.49899035830225, 424.0013876703401, 296.16985986996843, 423.24847776026184, 385.15404572784956, 340.2743079720652, 445.92913235286665, 78.17970472986127, 406.4520036282248, 310.89755229760624, 310.23946251233565, 315.8340173459409, 438.37840418602025, 395.50902415931654, 364.2194731331165, 376.4529139675948, 336.9265381807908, 372.2941451034277, 179.0515697681222, 441.14390679647875, 334.236161074969, 337.64864890476105, 302.7126845897027, 137.98983093880642, 352.13035508427555, 397.9060010799153, 213.29911758152898, 349.6184332298689, 363.98787487892565, 448.19612658221246, 354.67495591774485, 23.879344791848336, 419.1611009511454, 399.0646692732069, 576.328178239421, 439.85434698956374, 122.44554513797692, 446.02713597463077, 57.818222453486186, 462.5838878983337, 417.27814757131824, 377.7248628145189, 263.00568398080276, 350.2174971110467, 439.1008022533331, 405.09863428388553, 372.3183980556763, 402.3179283571312, 412.70746624959236, 423.9615328661383, 310.2205806182934, 401.38416614153357, 331.53590609153764, 341.2005218912855, 297.6246343429615, 267.08511425743353, 460.1434263517852, 423.43456762489694, 473.70991265842076, 378.04195015327485, 366.2451565597084, 59.40467309953022, 633.2038924335783, 419.83842389078455, 162.28391762553005, 378.86116670827215, 364.7923590301874, 394.2932806939821, 350.5227940226041, 366.45628608639885, 306.4497237602438, 292.7768433169273, 433.3815959262168, 387.95961459277765, 310.34702892599023, 284.5654389769497, 245.44918130052488, 329.2823280742059, 501.67494616546736, 382.15543446236563, 482.08475313391375, 316.8487998374538, 288.50051213522295, 294.3574741764076, 425.9242470459355, 363.3559196777245, 337.14052820712016, 339.5218640551787, 338.46387105343786, 454.0906560163068, 209.01029716167292, 241.67380876952691, 379.973144989573, 408.21810343404854, 439.4267502364665, 114.08087649260655, 272.3111328069887, 459.2479688121029, 384.2101787114977, 572.9492662192366, 338.9164442689389, 415.6451797036924, 287.6015330234498, 478.53280509719076, 353.1462407077486, 346.2704670855869, 427.96228040668257, 355.0802802930189, 304.0371611073912, 271.53898174147884, 372.84710034477297, 540.4012500991524, 452.0817036119494, 492.4562853368843, 343.69365175032993, 133.77638990590518, 405.83480024897835, 380.15367420472586, 342.8172879353598, 379.67932356771894, 318.7090713183867, 374.47569833009396, 433.02410802990346, 368.36532135115874, 365.8356798347149, 500.1395159496733, 344.7548112753919, 430.93375163793826, 480.83962239929144, 351.600321472031, 298.4678659288736, 299.23943279349965, 333.5160075845066, 230.02810644692474, 365.6477115432299, 342.77912046442714, 315.65967571680045, 335.9440656450327, 297.24480879241526, 232.20457990900368, 369.3688090967701, 595.9527034058729, 282.90258718266756, 329.84584220732904, 305.11388706750984, 778.948358447006, 410.91651505811495, 435.880714659092, 233.1142591855386, 334.87949735437155, 319.2925111962914, 317.8687538285928, 246.12608855225682, 370.1984364712449, 502.79457219400575, 411.4954483908466, 381.1457535774009, 487.4149415183917, 2.6447530848056973, 389.8288130701223, 254.6738693832233, 285.02605789073954, 542.7505584900033, 156.53343042290723, 367.3690727583131, 280.9536195300964, 355.3549370838771, 290.8465391817171, 211.5338424465184, 243.93429568000832, 457.7178853649504, 172.70209607337515, 390.8872512391993, 264.87207131068976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 45.51678234674495, "mean_inference_ms": 39.720554377568774, "mean_action_processing_ms": 23.89035892851465, "mean_env_wait_ms": 12.185290248003671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.4547642469406128, "StateBufferConnector_ms": 1.8518766164779663, "ViewRequirementAgentConnector_ms": 8.951256275177002}, "num_episodes": 72, "episode_return_max": 454.072069578895, "episode_return_min": -214.7294792604344, "episode_return_mean": 90.68610610318323, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1802624, "num_agent_steps_trained": 1802624, "num_env_steps_sampled": 450656, "num_env_steps_trained": 450656, "num_env_steps_sampled_this_iter": 14216, "num_env_steps_trained_this_iter": 14216, "num_env_steps_sampled_throughput_per_sec": 22.068556358197856, "num_env_steps_trained_throughput_per_sec": 22.068556358197856, "timesteps_total": 450656, "num_env_steps_sampled_lifetime": 450656, "num_agent_steps_sampled_lifetime": 1802624, "num_steps_trained_this_iter": 14216, "agent_timesteps_total": 1802624, "timers": {"training_iteration_time_ms": 243544.713, "restore_workers_time_ms": 7.095, "training_step_time_ms": 243525.373, "sample_time_ms": 61632.735, "learn_time_ms": 180957.732, "learn_throughput": 48.131, "synch_weights_time_ms": 838.997}, "counters": {"num_env_steps_sampled": 450656, "num_env_steps_trained": 450656, "num_agent_steps_sampled": 1802624, "num_agent_steps_trained": 1802624}, "done": false, "training_iteration": 56, "trial_id": "cdf01_00000", "date": "2024-08-20_11-42-12", "timestamp": 1724134332, "time_this_iter_s": 646.4320278167725, "time_total_s": 4818.010222434998, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e63820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4818.010222434998, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 96.48238039673278, "ram_util_percent": 83.65554259043176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.839466244691894, "cur_kl_coeff": 6.82121026329696e-14, "cur_lr": 0.00010000000000000002, "total_loss": 9.074718314125425, "policy_loss": -0.0035950635900787475, "vf_loss": 9.078313393819899, "vf_explained_var": -0.3498538972366424, "kl": 0.002272265733149733, "entropy": 0.13216989286953496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.9047619047619, "num_grad_updates_lifetime": 35910.5, "diff_num_grad_updates_vs_sampler_policy": 419.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.5310254241739, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.00010000000000000002, "total_loss": 8.445863587515694, "policy_loss": -0.003252787626115605, "vf_loss": 8.449116363411857, "vf_explained_var": 0.38757080151921225, "kl": 0.0032499652637270737, "entropy": 0.31835328253606954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.9047619047619, "num_grad_updates_lifetime": 35910.5, "diff_num_grad_updates_vs_sampler_policy": 419.5}}, "num_env_steps_sampled": 461320, "num_env_steps_trained": 461320, "num_agent_steps_sampled": 1845280, "num_agent_steps_trained": 1845280}, "env_runners": {"episode_reward_max": 454.072069578895, "episode_reward_min": -214.7294792604344, "episode_reward_mean": 83.98346332839564, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -778.948358447006, "predator_policy": 2.6447530848056973}, "policy_reward_max": {"prey_policy": 176.04290186207038, "predator_policy": 778.948358447006}, "policy_reward_mean": {"prey_policy": -318.1761349286469, "predator_policy": 360.16786659284463}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.03839895619817, 202.42505553979694, 187.76397004473228, -16.568278670143336, -1.077318304405594, -0.4685886846063725, 280.55019903999397, 5.399999999999995, 86.62884622006372, 176.69415303705625, 11.98150475417679, 1.299999999999995, 15.407862150324931, 0.6999999999999997, 454.072069578895, 8.598822131551712, 5.904764086410709, 89.49340107015338, 51.58985127210006, 175.70769290224644, 139.44475308480565, 22.49350718907982, -214.7294792604344, 5.699999999999994, 13.620519254628135, 263.86629627840404, 37.32570648384567, 15.49546576592004, 46.13732032574883, 283.19952281453834, 169.83160784813663, 245.6572599283005, 186.5612038041526, 118.33998764319891, 1.168175301875726, 11.011407131508294, 94.29110122004316, 202.73628427083784, 6.744791127471268, 78.2085583812942, 3.5000000000000036, 187.40337271134143, 97.30452737695359, 238.18837499298024, 4.884981308350689e-15, 10.599999999999978, 2.5497972745515676, 213.11043446096332, 0.19999999999999796, 46.101664857968984, 11.039740852521753, 28.33194551823136, -3.2128490099304585, 184.5679315339045, 107.15944800159653, 15.72284193575401, 272.2926188203463, -56.79308820151448, 4.293269166495373, 8.172007345782815, 43.968960185221505, -68.55696411712609, 136.32749138430404, 0.5000000000000018, 209.78432961454197, 16.91930055719171, 314.3331987082833, 198.27207787162132, 3.966901740298333, -1.7178718674573281, 195.90546999482234, -6.661338147750939e-16, 10.384247046352833, 216.94153600117747, 158.0999959923338, -63.92438610435485, 1.7839965237097037, 92.76584089078933, 3.774758283725532e-15, 353.86861326206014, 165.96238319461938, -1.3322676295501878e-15, 1.9984014443252818e-15, 203.77592410787275, -1.8455031947777982, 117.8605977815117, 145.88050243318284, 9.340078149854518, 55.99762184128179, -5.339132525232964, 245.41113097579353, 18.399999999999988, 5.537444860662543, 31.06921194254796, 202.92000273913234, 109.2751747567169, 15.624153617056562, -6.661338147750939e-16, 77.96973891607603, 263.10583420365094], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-236.9886736356083, -401.4695389112723, -90.72585753384021, -400.03385657484415, -254.44188907408687, -359.1835702622431, -389.3981907054077, -493.14528374912373, -344.7548112753919, -432.01106994234397, -477.7271079479567, -355.1814246079721, -256.1834379424201, -60.97366173995909, -331.81600758450656, -226.32810644692495, -304.1491435145093, -317.6488422730832, -385.844740925562, -89.06484739921487, -295.3448087924153, -222.12307515482732, -368.0688090967698, -595.9527034058729, -279.2025871826667, -318.13798005700437, -304.41388706750985, -778.948358447006, -421.22018441803084, 28.49502427971879, -227.01543705398726, -332.379497354371, -306.467635880869, -324.78886505760437, -117.71128625923379, -409.1198376941136, -349.77605548838494, -512.9241138243669, -174.44092692890516, -518.4120752646402, 135.20000000000005, -388.2288130701224, -279.6649734322159, -237.5414466526678, -523.5692392565687, -390.44422891677607, -367.3690727583131, -275.2536195300966, -317.16373049737336, -315.4172265135926, 140.61645914412068, -332.21830099224184, -239.39522347889383, -353.6990514755867, -367.25633602998613, -273.0075207539829, -443.4821977588938, -310.9108750910011, -416.56953032859263, -81.6857125785174, -439.8168164155981, -302.97846246775555, -397.25360510708333, 78.81512745423818, -77.32899238638902, -267.83590293406576, -218.21083804581397, -344.46872282271175, -280.3023417869779, -304.26645378220906, -299.9202981905504, -296.4869924500048, -271.44522715467036, -339.5365583092932, -331.638237764306, -184.2969817389035, -350.6832877816843, -528.6875075673755, -308.5739865715914, -197.92014302658143, -280.67146662777543, -397.47741962692595, -496.03576238864576, -209.0051766420456, -456.8760363748997, -246.75431835603837, -188.53118648391003, -488.72337808464096, -539.7285398496224, -572.8151826503655, -133.4605359458563, -458.38970417471296, -419.18031782044983, -415.2000008197823, -477.7557474239642, -113.4898534750602, -372.4013571055026, -462.60857610629745, -341.91530314597736, -457.34533773663685, -288.76452959847995, -240.75174138793844, -342.414622903469, -343.48154771011576, -542.1400972763518, -433.1375466074256, -144.91058868800883, -301.89194295639703, -143.08762077220783, -706.6486928973505, -463.5695414361218, -272.0240403950382, -676.0228657177174, 176.04290186207038, -382.2818679905282, -400.9193477764774, -410.55546848794785, -387.4071196773784, -335.28978999877995, -93.05158619359248, -551.5990839046782, -278.21110841789385, -355.7522973545215, -486.6542523324973, -368.82379625047236, -84.22040683000729, -306.87575666648246, -635.8899926507124, -356.2927906144112, -95.95050636303105, -345.48295552363163, -212.53495865223616, -589.0756528695476, 34.282949280342294, 139.544711644548, -380.3985321551611, -370.36423400064496, -356.0116742291271, -336.31246079996095, -472.96669175236303, -29.746122974061954, -459.112969121999, -376.4869493284388, -347.3653346702317, -305.23952455581014, -247.45067135143418, -167.46992869851934, -457.5844760608062, -276.28435859011, -650.6586749559087, -369.38687039650307, -491.238053674662, -346.17141202375706, -342.40990146410155, -139.9492528071652, -391.5603652386712, -472.72443935790375, -372.4917176230829, 95.54873593695649, -349.23907774686677, -115.64813653593909, -495.15449391262837, -361.9240727851209, -328.7665688835585, -326.26308862623574, -354.005828220997, -79.43459558438319, -305.72001481118565, -344.105471220509, -386.4894128839575, -15.704231801026642, -582.4506056542349, 113.5347119810909, -311.79475322850874, -299.35551858620863, -120.87396004296649, -321.4651501434712, -266.13388462750464, -284.88423729212303, -409.91113046376216, -446.2921589808897, -181.97869722342932, -370.9212968953928, 4.997511233994857, -393.76856750966374, -443.93613617500307, -351.0025666727452, -332.6588278639665, -359.00038691233726, -160.06107082015225, -295.245473141798, -147.63000979412163, -360.3216351695305, -334.35935365328544, -518.8401557247196, -572.5433104565401, -358.4733285554187, -314.13022097051817, -226.63328723588938, -373.6738262750403], "policy_predator_policy_reward": [342.8172879353598, 379.67932356771894, 318.7090713183867, 374.47569833009396, 433.02410802990346, 368.36532135115874, 365.8356798347149, 500.1395159496733, 344.7548112753919, 430.93375163793826, 480.83962239929144, 351.600321472031, 298.4678659288736, 299.23943279349965, 333.5160075845066, 230.02810644692474, 365.6477115432299, 342.77912046442714, 315.65967571680045, 335.9440656450327, 297.24480879241526, 232.20457990900368, 369.3688090967701, 595.9527034058729, 282.90258718266756, 329.84584220732904, 305.11388706750984, 778.948358447006, 410.91651505811495, 435.880714659092, 233.1142591855386, 334.87949735437155, 319.2925111962914, 317.8687538285928, 246.12608855225682, 370.1984364712449, 502.79457219400575, 411.4954483908466, 381.1457535774009, 487.4149415183917, 2.6447530848056973, 389.8288130701223, 254.6738693832233, 285.02605789073954, 542.7505584900033, 156.53343042290723, 367.3690727583131, 280.9536195300964, 355.3549370838771, 290.8465391817171, 211.5338424465184, 243.93429568000832, 457.7178853649504, 172.70209607337515, 390.8872512391993, 264.87207131068976, 425.8503539655376, 374.680039210108, 376.4386174391188, 405.01614828253213, 367.99128641513994, 544.6356003163515, 354.42561859098316, 209.67011899016256, 248.70776248862177, 283.0183366359866, 363.0987326724514, 317.92081583927364, 281.07051708885353, 304.66645378220903, 324.844964510106, 282.5737332619575, 346.7927012488115, 358.4801854351951, 397.4475888069709, 321.22391496707496, 427.1673991341575, 458.9481873423728, 254.8712359659053, 329.83145201356086, 284.17146662777526, 397.47741962692595, 417.45944317197046, 474.9848685700631, 446.8100025963816, 354.1248795115109, 422.5677752458034, 492.87516431572766, 539.7285398496224, 572.8151826503655, 144.06053594585575, 458.38970417471296, 418.8561456288092, 418.07397028597495, 439.50860090872, 364.8474344512668, 372.6013571055026, 462.60857610629745, 437.1634023108961, 408.19890342968904, 277.7524761036881, 262.80353573525184, 370.9294223529047, 343.2986937789118, 545.722541477627, 426.34225339621975, 339.8678653339338, 291.50259784437657, 763.8209696728829, 193.07479199827162, 449.4988419944119, 301.81758177250214, 345.94924365382036, 426.32333902217226, 397.17049621544396, 329.237631350047, 488.1660539131868, 314.0898034186358, 78.76097893748027, 357.75240460067505, 535.7086135293672, 338.07053897842565, 271.9194990146929, 501.9300865552, 178.97597507491713, 410.3957193898653, 307.37575666648246, 635.8899926507124, 297.1500267552445, 364.8775998367402, 185.72349471661647, 389.21372001644244, 506.8592981519981, 362.26660414549025, 90.31348870229506, 348.81240967994063, 372.2311357409434, 358.111674229127, 452.1586039563641, 355.4026767285025, 424.35062907300284, 260.4139330178804, 376.4869493284388, 347.3653346702317, 225.12845210834004, 337.9459908452574, 408.11313680008493, 433.8828039604174, 499.2794051981002, 585.7636243402565, 306.11450885267084, 490.5860291141397, 354.1789006850485, 336.18640932651994, 351.6758012959468, 272.5996576406784, 472.72443935790375, 372.4917176230829, 272.4523534733938, 335.10660159857457, 340.09544137257825, 436.66957227060857, 361.9240727851209, 328.7665688835585, 326.26308862623574, 354.005828220997, 290.38729751331624, 298.54323699012417, 320.9047196949014, 407.8446612147872, 312.0500945969254, 403.96534063984797, 337.1600412474176, 6.980502433183191, 298.94037906025756, 130.6291777187722, 380.7381076858577, 262.8585489263998, 303.78530623337355, 385.67092899727874, 418.17858264358233, 455.5034045365287, 371.0212968953928, 13.302488766005112, 438.7130043280545, 404.52914421727473, 374.9901777450084, 339.74042873425117, 385.6436557336033, 336.337804738019, 251.79352886666183, 300.3571288259746, 376.08192185739165, 334.22322058248136, 518.8401557247196, 572.5433104565401, 360.3312412158894, 390.242047226124, 468.241266177578, 395.1716815370036]}, "sampler_perf": {"mean_raw_obs_processing_ms": 50.60587277535321, "mean_inference_ms": 43.89678413736705, "mean_action_processing_ms": 24.247333115648715, "mean_env_wait_ms": 13.484528907370205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.34943366050720215, "StateBufferConnector_ms": 2.036224365234375, "ViewRequirementAgentConnector_ms": 8.169027924537659}, "num_episodes": 72, "episode_return_max": 454.072069578895, "episode_return_min": -214.7294792604344, "episode_return_mean": 83.98346332839564, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1845280, "num_agent_steps_trained": 1845280, "num_env_steps_sampled": 461320, "num_env_steps_trained": 461320, "num_env_steps_sampled_this_iter": 10664, "num_env_steps_trained_this_iter": 10664, "num_env_steps_sampled_throughput_per_sec": 25.826786098414075, "num_env_steps_trained_throughput_per_sec": 25.826786098414075, "timesteps_total": 461320, "num_env_steps_sampled_lifetime": 461320, "num_agent_steps_sampled_lifetime": 1845280, "num_steps_trained_this_iter": 10664, "agent_timesteps_total": 1845280, "timers": {"training_iteration_time_ms": 281131.134, "restore_workers_time_ms": 7.909, "training_step_time_ms": 281109.248, "sample_time_ms": 73713.515, "learn_time_ms": 206356.837, "learn_throughput": 43.497, "synch_weights_time_ms": 931.088}, "counters": {"num_env_steps_sampled": 461320, "num_env_steps_trained": 461320, "num_agent_steps_sampled": 1845280, "num_agent_steps_trained": 1845280}, "done": false, "training_iteration": 57, "trial_id": "cdf01_00000", "date": "2024-08-20_11-49-09", "timestamp": 1724134749, "time_this_iter_s": 415.0337300300598, "time_total_s": 5233.043952465057, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52c45e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5233.043952465057, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 96.91795774647888, "ram_util_percent": 83.60017605633803}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.67723650421415, "cur_kl_coeff": 3.410605131648481e-14, "cur_lr": 0.0001, "total_loss": 8.566915923073179, "policy_loss": -0.003372351677408294, "vf_loss": 8.570288283484322, "vf_explained_var": -0.08366931374110873, "kl": 0.0024337995138888836, "entropy": 0.1474547948629137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 36645.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.343128849589635, "cur_kl_coeff": 9.313225746154784e-11, "cur_lr": 0.0001, "total_loss": 7.836675761237977, "policy_loss": -0.004353153766576378, "vf_loss": 7.841028924972292, "vf_explained_var": 0.5329046270203969, "kl": 0.0031275466542735686, "entropy": 0.3607276518666555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 36645.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 469320, "num_env_steps_trained": 469320, "num_agent_steps_sampled": 1877280, "num_agent_steps_trained": 1877280}, "env_runners": {"episode_reward_max": 601.9577315534516, "episode_reward_min": -63.92438610435485, "episode_reward_mean": 120.18065179410894, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -687.4894159198784, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.36789223374365, "predator_policy": 633.9547935127916}, "policy_reward_mean": {"prey_policy": -300.4122058374528, "predator_policy": 360.50253173450733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.384247046352833, 216.94153600117747, 158.0999959923338, -63.92438610435485, 1.7839965237097037, 92.76584089078933, 3.774758283725532e-15, 353.86861326206014, 165.96238319461938, -1.3322676295501878e-15, 1.9984014443252818e-15, 203.77592410787275, -1.8455031947777982, 117.8605977815117, 145.88050243318284, 9.340078149854518, 55.99762184128179, -5.339132525232964, 245.41113097579353, 18.399999999999988, 5.537444860662543, 31.06921194254796, 202.92000273913234, 109.2751747567169, 15.624153617056562, -6.661338147750939e-16, 77.96973891607603, 263.10583420365094, 47.04740507233748, 408.63659753522626, 157.78795540700142, -2.3771225096838124, 109.31010927147103, 238.367175049552, 86.82335230016406, -6.7300753853124835, 140.1889320462445, 30.50598551250573, 50.102408253779586, 52.565585158361166, 87.81407946257308, -0.7633479011241113, 13.433432318736495, 3.992736757279662, 237.19270927442943, 224.77082544256302, 287.64582087623876, 193.56246892787982, 601.9577315534516, 93.65706523319302, 172.9408723050119, 5.051151927835406, 20.056379721292135, 90.41496695312975, 69.78219086012196, 115.55178485816177, 154.76594836265932, 78.53792892871172, 236.711007932182, 245.9527928731436, 154.7206321754373, 8.069359952704398, 146.21051560826618, 86.7646413584741, 133.8514281445777, 123.00095073967692, 349.14476779863367, 154.6716674412693, 114.42353594265651, 97.05112930111447, 77.954485248213, 1.1000000000000025, 290.7982980252591, 453.8819862200461, 322.91689709574496, 96.54587318901727, 47.39698724727181, 397.8089249003436, 224.50762444059907, 78.127911610408, 224.79413046676214, 3.4355712843481765, 123.86450264447551, -0.02138534787644808, 9.672560028859426, 342.36439622141523, 213.219094996321, 286.25084844290774, 2.902041719892526, 21.38852719200374, 191.5515407225319, 4.75844191461906, 192.84012911628562, 8.947046997698127, 22.800000000000047, 3.9581226548553134, 198.7999999999999, 22.300000000000068, 65.23153694936914, 43.93859517557842], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-305.23952455581014, -247.45067135143418, -167.46992869851934, -457.5844760608062, -276.28435859011, -650.6586749559087, -369.38687039650307, -491.238053674662, -346.17141202375706, -342.40990146410155, -139.9492528071652, -391.5603652386712, -472.72443935790375, -372.4917176230829, 95.54873593695649, -349.23907774686677, -115.64813653593909, -495.15449391262837, -361.9240727851209, -328.7665688835585, -326.26308862623574, -354.005828220997, -79.43459558438319, -305.72001481118565, -344.105471220509, -386.4894128839575, -15.704231801026642, -582.4506056542349, 113.5347119810909, -311.79475322850874, -299.35551858620863, -120.87396004296649, -321.4651501434712, -266.13388462750464, -284.88423729212303, -409.91113046376216, -446.2921589808897, -181.97869722342932, -370.9212968953928, 4.997511233994857, -393.76856750966374, -443.93613617500307, -351.0025666727452, -332.6588278639665, -359.00038691233726, -160.06107082015225, -295.245473141798, -147.63000979412163, -360.3216351695305, -334.35935365328544, -518.8401557247196, -572.5433104565401, -358.4733285554187, -314.13022097051817, -226.63328723588938, -373.6738262750403, -509.61042933482764, -227.19231593416816, -91.84434266390542, -519.584554706217, -78.84684086296267, -552.9429046280263, -484.28680636404727, -503.7192602026915, -456.2197926449552, -153.24675711912266, -144.81825407956907, -375.23161281027774, -385.239728455181, -325.4090470269679, -426.01506320510754, -286.58804472242036, -325.60598823815496, -148.99161438637245, -202.09944722825506, -542.3476049038561, -382.4381352545699, -391.73190891719946, -278.11131832634686, -404.3390332829541, 15.160503467982709, -497.9170540318381, -550.7582616572778, -391.36860640396185, -201.25361532122142, -284.1498102486491, -341.2748931092552, -461.9534400898472, -491.12852599151944, -128.14743685981364, -407.7454449907303, -184.8460027498801, 13.858876045778677, -530.3349224059875, 30.319981250286887, -379.04197982124793, -675.6862768611182, 178.98737785981805, -86.34237390863541, -452.18833232135944, -169.45420951958263, -356.72301935792757, -517.3219351834355, -374.90540989197166, -312.43194124189205, -327.1965914469189, -443.431793174314, -106.54819219296432, -388.9787315395226, -122.84835886278427, -464.93795163499004, -255.29654906128178, -416.15970064936386, 2.3664404950327445, -264.6392868816156, -399.1431242041119, -328.5989688575109, -77.5356121681164, -341.16181310864175, -180.18347775681156, -3.9709445520456153, -384.34016435818467, -356.6911140473374, -304.03539624015247, -165.12230658984205, -494.4279631808545, -146.25612633591604, -359.5272534556108, -184.71516067531374, -377.6513427103305, -115.71953501570219, -311.89464721929994, -445.3248061074542, 184.38873420663924, -255.77589870978417, -439.4111759441949, -386.48949057573424, 27.731893197730948, -650.5538181610723, -114.02781521958532, -269.5383645684386, -386.5258738542014, -289.4394113785389, -338.5884029203934, -527.7176860200235, -14.223418798799376, 169.38289207076403, -565.5087138433398, -77.29539470931745, -687.4894159198784, -404.55187753244746, -195.50303408949702, -402.6998479094373, -206.46774065259476, 196.36789223374365, -431.1441647995241, -92.43843596672643, -622.1634755802653, -372.65334215270684, -450.28079948256607, -128.26539387983843, -449.0653838729723, -346.4266640430595, -421.45358374065944, -441.3304228221571, -240.8546873989131, -453.69176084378523, -324.11203947531493, -624.9613395145798, -328.00845587773694, -523.3644114368959, -59.402549244835434, -293.29648550367375, -97.93943807376614, -15.189894919503942, -417.38438316981285, -305.1335223606779, -298.6289366144842, -225.43331021308023, -436.307711144484, -160.0403524846881, -394.03177372781636, -288.38606944833634, -30.714883555150315, -128.69369883145768, -336.9982175841648, -272.7659877380563, -456.5611716528798, -290.5087831122579, 17.019397620381874, -397.0281102002761, -467.4362315388311, -335.19883417035084, 194.57735082501384, 20.000000000000014, -407.9755404146445, -506.15671557774897, -60.99977826597066, -473.2435284337738, -340.0204170677031], "policy_predator_policy_reward": [225.12845210834004, 337.9459908452574, 408.11313680008493, 433.8828039604174, 499.2794051981002, 585.7636243402565, 306.11450885267084, 490.5860291141397, 354.1789006850485, 336.18640932651994, 351.6758012959468, 272.5996576406784, 472.72443935790375, 372.4917176230829, 272.4523534733938, 335.10660159857457, 340.09544137257825, 436.66957227060857, 361.9240727851209, 328.7665688835585, 326.26308862623574, 354.005828220997, 290.38729751331624, 298.54323699012417, 320.9047196949014, 407.8446612147872, 312.0500945969254, 403.96534063984797, 337.1600412474176, 6.980502433183191, 298.94037906025756, 130.6291777187722, 380.7381076858577, 262.8585489263998, 303.78530623337355, 385.67092899727874, 418.17858264358233, 455.5034045365287, 371.0212968953928, 13.302488766005112, 438.7130043280545, 404.52914421727473, 374.9901777450084, 339.74042873425117, 385.6436557336033, 336.337804738019, 251.79352886666183, 300.3571288259746, 376.08192185739165, 334.22322058248136, 518.8401557247196, 572.5433104565401, 360.3312412158894, 390.242047226124, 468.241266177578, 395.1716815370036, 250.0588861252354, 533.7912642160977, 519.4635170869013, 500.60197781844556, 235.2558523821904, 554.321848515799, 481.90968385436344, 503.7192602026915, 306.6395947393726, 412.1370642961762, 393.3530036272416, 365.06403831215687, 327.74503252837144, 469.7270952539423, 339.9109364468799, 365.9620960953337, 319.71139859022554, 295.07513608054677, 232.30543274076012, 542.6476049038561, 345.94346193573523, 478.3289904898138, 338.57825176434704, 396.43768500331623, 430.22214411930526, 140.34848590712377, 554.7781259870017, 386.58539417311414, 208.6848545146793, 290.1520033739285, 344.56762986653484, 462.65344008984715, 337.7878370082273, 518.680835117535, 396.80585502250136, 420.5564181606719, 291.785734317992, 512.336132918455, 353.9907002479969, 188.2937672508446, 533.8030474780451, 564.8535830767057, 417.4845314689813, 214.70323999420674, 348.34549244762286, 350.7726087348994, 533.0692727839069, 364.20922421933597, 314.2724873282032, 345.4124250818996, 416.3052675797155, 224.08968474069232, 229.88535301415405, 351.72392824827443, 503.18252026383334, 332.6037652906009, 376.68749344417614, 191.8717150728138, 396.3008508867471, 346.01948912769336, 324.0010765996649, 318.84451235814413, 341.86181310864185, 425.4362706299551, 198.84435872825784, 344.18738235740983, 355.934801571353, 312.8610686688416, 475.10293304178487, 330.6578523371769, 270.05740592282643, 322.4906152271736, 336.6749526071609, 359.5429789230622, 155.95378418858243, 394.6613487860977, 193.78004886029674, 416.30079083915297, 417.2327881711167, 432.62595392413385, 451.55089450442483, 21.630238816235956, 559.8964018203035, 301.7363608614686, 377.0162139710441, 357.00250969980925, 290.5394113785389, 338.5884029203934, 402.28449129067536, 430.4549115534062, 403.36863254942557, 446.63917544319565, 504.2412087626193, 583.4604989623197, 393.3005416529987, 303.30024315796277, 453.7731968270245, 202.79137898227998, 253.02995905144337, 379.55523841468096, 395.65898896173843, 543.4505470258521, 318.393284305704, 582.6687689399803, 354.5473807489351, 447.57752747063813, 346.52666404305944, 424.78915502500763, 443.8900113529358, 362.15960151261055, 453.69176084378523, 324.0906541274385, 633.9547935127916, 328.6875619083859, 457.83154214946444, 467.2998147536808, 310.0120841388491, 294.4429344349116, 329.35252574750336, 389.4726007847216, 284.3985301071543, 322.2659705879004, 258.152484052373, 424.97706449719504, 354.02977427562143, 391.59389265941536, 290.5825352575587, 33.276859660547245, 342.24693698407833, 316.2851085478293, 268.70479035972255, 469.5694160289116, 291.108783112258, 5.180602379618103, 405.0940682955311, 463.3283960984314, 336.99883417035073, 2.4226491749861694, 0.0, 410.2755404146446, 507.1371201438311, 125.25091064925748, 475.74352843377363, 381.4590122432814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 53.69629613506461, "mean_inference_ms": 46.22819068776282, "mean_action_processing_ms": 24.425646642766377, "mean_env_wait_ms": 14.245335407134517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6130694150924683, "StateBufferConnector_ms": 2.629934787750244, "ViewRequirementAgentConnector_ms": 11.113871455192566}, "num_episodes": 72, "episode_return_max": 601.9577315534516, "episode_return_min": -63.92438610435485, "episode_return_mean": 120.18065179410894, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1877280, "num_agent_steps_trained": 1877280, "num_env_steps_sampled": 469320, "num_env_steps_trained": 469320, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 19.9142743368478, "num_env_steps_trained_throughput_per_sec": 19.9142743368478, "timesteps_total": 469320, "num_env_steps_sampled_lifetime": 469320, "num_agent_steps_sampled_lifetime": 1877280, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1877280, "timers": {"training_iteration_time_ms": 317586.036, "restore_workers_time_ms": 9.488, "training_step_time_ms": 317518.238, "sample_time_ms": 79185.17, "learn_time_ms": 232167.438, "learn_throughput": 38.662, "synch_weights_time_ms": 5543.62}, "counters": {"num_env_steps_sampled": 469320, "num_env_steps_trained": 469320, "num_agent_steps_sampled": 1877280, "num_agent_steps_trained": 1877280}, "done": false, "training_iteration": 58, "trial_id": "cdf01_00000", "date": "2024-08-20_11-56-24", "timestamp": 1724135184, "time_this_iter_s": 431.8240249156952, "time_total_s": 5664.867977380753, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52c48b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5664.867977380753, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 80.86377551020408, "ram_util_percent": 85.25127551020408}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.70272831897887, "cur_kl_coeff": 1.7053025658242404e-14, "cur_lr": 0.0001, "total_loss": 8.842522058032808, "policy_loss": -0.004034258461823421, "vf_loss": 8.84655633956667, "vf_explained_var": -0.26458590361807083, "kl": 0.0025761034729016715, "entropy": 0.14217921990960364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 37275.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.109364388291798, "cur_kl_coeff": 4.656612873077392e-11, "cur_lr": 0.0001, "total_loss": 8.623895963033041, "policy_loss": -0.004289465903171471, "vf_loss": 8.628185437217592, "vf_explained_var": 0.36405129716509865, "kl": 0.003441691262789737, "entropy": 0.30011662001174594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 37275.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 477320, "num_env_steps_trained": 477320, "num_agent_steps_sampled": 1909280, "num_agent_steps_trained": 1909280}, "env_runners": {"episode_reward_max": 601.9577315534516, "episode_reward_min": -63.92438610435485, "episode_reward_mean": 120.18065179410894, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -687.4894159198784, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.36789223374365, "predator_policy": 633.9547935127916}, "policy_reward_mean": {"prey_policy": -300.4122058374528, "predator_policy": 360.50253173450733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.384247046352833, 216.94153600117747, 158.0999959923338, -63.92438610435485, 1.7839965237097037, 92.76584089078933, 3.774758283725532e-15, 353.86861326206014, 165.96238319461938, -1.3322676295501878e-15, 1.9984014443252818e-15, 203.77592410787275, -1.8455031947777982, 117.8605977815117, 145.88050243318284, 9.340078149854518, 55.99762184128179, -5.339132525232964, 245.41113097579353, 18.399999999999988, 5.537444860662543, 31.06921194254796, 202.92000273913234, 109.2751747567169, 15.624153617056562, -6.661338147750939e-16, 77.96973891607603, 263.10583420365094, 47.04740507233748, 408.63659753522626, 157.78795540700142, -2.3771225096838124, 109.31010927147103, 238.367175049552, 86.82335230016406, -6.7300753853124835, 140.1889320462445, 30.50598551250573, 50.102408253779586, 52.565585158361166, 87.81407946257308, -0.7633479011241113, 13.433432318736495, 3.992736757279662, 237.19270927442943, 224.77082544256302, 287.64582087623876, 193.56246892787982, 601.9577315534516, 93.65706523319302, 172.9408723050119, 5.051151927835406, 20.056379721292135, 90.41496695312975, 69.78219086012196, 115.55178485816177, 154.76594836265932, 78.53792892871172, 236.711007932182, 245.9527928731436, 154.7206321754373, 8.069359952704398, 146.21051560826618, 86.7646413584741, 133.8514281445777, 123.00095073967692, 349.14476779863367, 154.6716674412693, 114.42353594265651, 97.05112930111447, 77.954485248213, 1.1000000000000025, 290.7982980252591, 453.8819862200461, 322.91689709574496, 96.54587318901727, 47.39698724727181, 397.8089249003436, 224.50762444059907, 78.127911610408, 224.79413046676214, 3.4355712843481765, 123.86450264447551, -0.02138534787644808, 9.672560028859426, 342.36439622141523, 213.219094996321, 286.25084844290774, 2.902041719892526, 21.38852719200374, 191.5515407225319, 4.75844191461906, 192.84012911628562, 8.947046997698127, 22.800000000000047, 3.9581226548553134, 198.7999999999999, 22.300000000000068, 65.23153694936914, 43.93859517557842], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-305.23952455581014, -247.45067135143418, -167.46992869851934, -457.5844760608062, -276.28435859011, -650.6586749559087, -369.38687039650307, -491.238053674662, -346.17141202375706, -342.40990146410155, -139.9492528071652, -391.5603652386712, -472.72443935790375, -372.4917176230829, 95.54873593695649, -349.23907774686677, -115.64813653593909, -495.15449391262837, -361.9240727851209, -328.7665688835585, -326.26308862623574, -354.005828220997, -79.43459558438319, -305.72001481118565, -344.105471220509, -386.4894128839575, -15.704231801026642, -582.4506056542349, 113.5347119810909, -311.79475322850874, -299.35551858620863, -120.87396004296649, -321.4651501434712, -266.13388462750464, -284.88423729212303, -409.91113046376216, -446.2921589808897, -181.97869722342932, -370.9212968953928, 4.997511233994857, -393.76856750966374, -443.93613617500307, -351.0025666727452, -332.6588278639665, -359.00038691233726, -160.06107082015225, -295.245473141798, -147.63000979412163, -360.3216351695305, -334.35935365328544, -518.8401557247196, -572.5433104565401, -358.4733285554187, -314.13022097051817, -226.63328723588938, -373.6738262750403, -509.61042933482764, -227.19231593416816, -91.84434266390542, -519.584554706217, -78.84684086296267, -552.9429046280263, -484.28680636404727, -503.7192602026915, -456.2197926449552, -153.24675711912266, -144.81825407956907, -375.23161281027774, -385.239728455181, -325.4090470269679, -426.01506320510754, -286.58804472242036, -325.60598823815496, -148.99161438637245, -202.09944722825506, -542.3476049038561, -382.4381352545699, -391.73190891719946, -278.11131832634686, -404.3390332829541, 15.160503467982709, -497.9170540318381, -550.7582616572778, -391.36860640396185, -201.25361532122142, -284.1498102486491, -341.2748931092552, -461.9534400898472, -491.12852599151944, -128.14743685981364, -407.7454449907303, -184.8460027498801, 13.858876045778677, -530.3349224059875, 30.319981250286887, -379.04197982124793, -675.6862768611182, 178.98737785981805, -86.34237390863541, -452.18833232135944, -169.45420951958263, -356.72301935792757, -517.3219351834355, -374.90540989197166, -312.43194124189205, -327.1965914469189, -443.431793174314, -106.54819219296432, -388.9787315395226, -122.84835886278427, -464.93795163499004, -255.29654906128178, -416.15970064936386, 2.3664404950327445, -264.6392868816156, -399.1431242041119, -328.5989688575109, -77.5356121681164, -341.16181310864175, -180.18347775681156, -3.9709445520456153, -384.34016435818467, -356.6911140473374, -304.03539624015247, -165.12230658984205, -494.4279631808545, -146.25612633591604, -359.5272534556108, -184.71516067531374, -377.6513427103305, -115.71953501570219, -311.89464721929994, -445.3248061074542, 184.38873420663924, -255.77589870978417, -439.4111759441949, -386.48949057573424, 27.731893197730948, -650.5538181610723, -114.02781521958532, -269.5383645684386, -386.5258738542014, -289.4394113785389, -338.5884029203934, -527.7176860200235, -14.223418798799376, 169.38289207076403, -565.5087138433398, -77.29539470931745, -687.4894159198784, -404.55187753244746, -195.50303408949702, -402.6998479094373, -206.46774065259476, 196.36789223374365, -431.1441647995241, -92.43843596672643, -622.1634755802653, -372.65334215270684, -450.28079948256607, -128.26539387983843, -449.0653838729723, -346.4266640430595, -421.45358374065944, -441.3304228221571, -240.8546873989131, -453.69176084378523, -324.11203947531493, -624.9613395145798, -328.00845587773694, -523.3644114368959, -59.402549244835434, -293.29648550367375, -97.93943807376614, -15.189894919503942, -417.38438316981285, -305.1335223606779, -298.6289366144842, -225.43331021308023, -436.307711144484, -160.0403524846881, -394.03177372781636, -288.38606944833634, -30.714883555150315, -128.69369883145768, -336.9982175841648, -272.7659877380563, -456.5611716528798, -290.5087831122579, 17.019397620381874, -397.0281102002761, -467.4362315388311, -335.19883417035084, 194.57735082501384, 20.000000000000014, -407.9755404146445, -506.15671557774897, -60.99977826597066, -473.2435284337738, -340.0204170677031], "policy_predator_policy_reward": [225.12845210834004, 337.9459908452574, 408.11313680008493, 433.8828039604174, 499.2794051981002, 585.7636243402565, 306.11450885267084, 490.5860291141397, 354.1789006850485, 336.18640932651994, 351.6758012959468, 272.5996576406784, 472.72443935790375, 372.4917176230829, 272.4523534733938, 335.10660159857457, 340.09544137257825, 436.66957227060857, 361.9240727851209, 328.7665688835585, 326.26308862623574, 354.005828220997, 290.38729751331624, 298.54323699012417, 320.9047196949014, 407.8446612147872, 312.0500945969254, 403.96534063984797, 337.1600412474176, 6.980502433183191, 298.94037906025756, 130.6291777187722, 380.7381076858577, 262.8585489263998, 303.78530623337355, 385.67092899727874, 418.17858264358233, 455.5034045365287, 371.0212968953928, 13.302488766005112, 438.7130043280545, 404.52914421727473, 374.9901777450084, 339.74042873425117, 385.6436557336033, 336.337804738019, 251.79352886666183, 300.3571288259746, 376.08192185739165, 334.22322058248136, 518.8401557247196, 572.5433104565401, 360.3312412158894, 390.242047226124, 468.241266177578, 395.1716815370036, 250.0588861252354, 533.7912642160977, 519.4635170869013, 500.60197781844556, 235.2558523821904, 554.321848515799, 481.90968385436344, 503.7192602026915, 306.6395947393726, 412.1370642961762, 393.3530036272416, 365.06403831215687, 327.74503252837144, 469.7270952539423, 339.9109364468799, 365.9620960953337, 319.71139859022554, 295.07513608054677, 232.30543274076012, 542.6476049038561, 345.94346193573523, 478.3289904898138, 338.57825176434704, 396.43768500331623, 430.22214411930526, 140.34848590712377, 554.7781259870017, 386.58539417311414, 208.6848545146793, 290.1520033739285, 344.56762986653484, 462.65344008984715, 337.7878370082273, 518.680835117535, 396.80585502250136, 420.5564181606719, 291.785734317992, 512.336132918455, 353.9907002479969, 188.2937672508446, 533.8030474780451, 564.8535830767057, 417.4845314689813, 214.70323999420674, 348.34549244762286, 350.7726087348994, 533.0692727839069, 364.20922421933597, 314.2724873282032, 345.4124250818996, 416.3052675797155, 224.08968474069232, 229.88535301415405, 351.72392824827443, 503.18252026383334, 332.6037652906009, 376.68749344417614, 191.8717150728138, 396.3008508867471, 346.01948912769336, 324.0010765996649, 318.84451235814413, 341.86181310864185, 425.4362706299551, 198.84435872825784, 344.18738235740983, 355.934801571353, 312.8610686688416, 475.10293304178487, 330.6578523371769, 270.05740592282643, 322.4906152271736, 336.6749526071609, 359.5429789230622, 155.95378418858243, 394.6613487860977, 193.78004886029674, 416.30079083915297, 417.2327881711167, 432.62595392413385, 451.55089450442483, 21.630238816235956, 559.8964018203035, 301.7363608614686, 377.0162139710441, 357.00250969980925, 290.5394113785389, 338.5884029203934, 402.28449129067536, 430.4549115534062, 403.36863254942557, 446.63917544319565, 504.2412087626193, 583.4604989623197, 393.3005416529987, 303.30024315796277, 453.7731968270245, 202.79137898227998, 253.02995905144337, 379.55523841468096, 395.65898896173843, 543.4505470258521, 318.393284305704, 582.6687689399803, 354.5473807489351, 447.57752747063813, 346.52666404305944, 424.78915502500763, 443.8900113529358, 362.15960151261055, 453.69176084378523, 324.0906541274385, 633.9547935127916, 328.6875619083859, 457.83154214946444, 467.2998147536808, 310.0120841388491, 294.4429344349116, 329.35252574750336, 389.4726007847216, 284.3985301071543, 322.2659705879004, 258.152484052373, 424.97706449719504, 354.02977427562143, 391.59389265941536, 290.5825352575587, 33.276859660547245, 342.24693698407833, 316.2851085478293, 268.70479035972255, 469.5694160289116, 291.108783112258, 5.180602379618103, 405.0940682955311, 463.3283960984314, 336.99883417035073, 2.4226491749861694, 0.0, 410.2755404146446, 507.1371201438311, 125.25091064925748, 475.74352843377363, 381.4590122432814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 53.69629613506461, "mean_inference_ms": 46.22819068776282, "mean_action_processing_ms": 24.425646642766377, "mean_env_wait_ms": 14.245335407134517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6130694150924683, "StateBufferConnector_ms": 2.629934787750244, "ViewRequirementAgentConnector_ms": 11.113871455192566}, "num_episodes": 0, "episode_return_max": 601.9577315534516, "episode_return_min": -63.92438610435485, "episode_return_mean": 120.18065179410894, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1909280, "num_agent_steps_trained": 1909280, "num_env_steps_sampled": 477320, "num_env_steps_trained": 477320, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 50.32773645283128, "num_env_steps_trained_throughput_per_sec": 50.32773645283128, "timesteps_total": 477320, "num_env_steps_sampled_lifetime": 477320, "num_agent_steps_sampled_lifetime": 1909280, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1909280, "timers": {"training_iteration_time_ms": 329217.104, "restore_workers_time_ms": 61.349, "training_step_time_ms": 329056.536, "sample_time_ms": 82940.343, "learn_time_ms": 238708.199, "learn_throughput": 37.602, "synch_weights_time_ms": 6698.886}, "counters": {"num_env_steps_sampled": 477320, "num_env_steps_trained": 477320, "num_agent_steps_sampled": 1909280, "num_agent_steps_trained": 1909280}, "done": false, "training_iteration": 59, "trial_id": "cdf01_00000", "date": "2024-08-20_11-59-48", "timestamp": 1724135388, "time_this_iter_s": 164.1785111427307, "time_total_s": 5829.046488523483, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5829.046488523483, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 54.125855513308, "ram_util_percent": 86.39429657794678}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.288951774816665, "cur_kl_coeff": 8.526512829121202e-15, "cur_lr": 0.0001, "total_loss": 8.626497341337657, "policy_loss": -0.004074587873257106, "vf_loss": 8.630571928478423, "vf_explained_var": 0.031849937117288986, "kl": 0.0035702442455514093, "entropy": 0.1698901580203147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 37905.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.029541474107712, "cur_kl_coeff": 2.328306436538696e-11, "cur_lr": 0.0001, "total_loss": 8.522047213145665, "policy_loss": -0.002980181798782377, "vf_loss": 8.525027455223931, "vf_explained_var": 0.4031370527214474, "kl": 0.0034420036704255782, "entropy": 0.32017525753804615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 37905.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 485320, "num_env_steps_trained": 485320, "num_agent_steps_sampled": 1941280, "num_agent_steps_trained": 1941280}, "env_runners": {"episode_reward_max": 453.8819862200461, "episode_reward_min": -51.58374621319315, "episode_reward_mean": 101.0997100282658, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -713.6368830568564, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.1117702586338, "predator_policy": 633.9547935127916}, "policy_reward_mean": {"prey_policy": -302.513229399726, "predator_policy": 353.063084413859}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.7982980252591, 453.8819862200461, 322.91689709574496, 96.54587318901727, 47.39698724727181, 397.8089249003436, 224.50762444059907, 78.127911610408, 224.79413046676214, 3.4355712843481765, 123.86450264447551, -0.02138534787644808, 9.672560028859426, 342.36439622141523, 213.219094996321, 286.25084844290774, 2.902041719892526, 21.38852719200374, 191.5515407225319, 4.75844191461906, 192.84012911628562, 8.947046997698127, 22.800000000000047, 3.9581226548553134, 198.7999999999999, 22.300000000000068, 65.23153694936914, 43.93859517557842, -10.73224180415628, 60.44444265215275, 111.71000428053955, 87.51341247135315, 184.99346601905856, 43.316293495667956, 26.27069579930245, 2.7037783853722743, 254.2060858539177, 153.58944288568966, 24.92897204875458, 203.18389436033675, 235.1699659321454, 0.589204560410866, 5.791162230106723, 24.804568848559928, -4.884981308350689e-15, 186.40932551191787, -19.16225708999648, 61.31865482268357, -6.959437385755621, 33.45517130054805, 0.09999999999999942, 214.5419532461758, 4.599999999999996, 59.65779977829185, 138.23430349010715, 379.6638291903157, 121.34792620924978, 64.07091418015457, 5.656775055150177, 201.85977515003003, 134.97067427499593, 255.41416581581024, 1.5000000000000053, 204.43813085707933, 15.39483339145802, 2.634355166979997, 14.561500958252338, 101.05285355875299, 0.10667366420359681, 57.14458814343382, 112.70151575730507, -51.58374621319315, 37.390784240074815, 20.03461967742375, 185.71136875916574, 2.5019155103270005, 245.5186643351847, 0.5000000000000036, 1.3507986050538212, -14.131782037630195, 103.31295406954493, 121.33758134877492, 4.836529876141286, 281.568830090274, 59.076019978749095, 367.66336652104127, 160.3963974317005, 14.406038155246145, 7.9618881397369075, 2.9000000000000066, -16.724550961092064, 171.90912947199226, 0.5999999999999954, 19.10558415451988, -8.582325487655154, 201.04988310883965, 198.1117702586338, -20.225498083795465, 126.84986292241021, 238.9475419800175], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-527.7176860200235, -14.223418798799376, 169.38289207076403, -565.5087138433398, -77.29539470931745, -687.4894159198784, -404.55187753244746, -195.50303408949702, -402.6998479094373, -206.46774065259476, 196.36789223374365, -431.1441647995241, -92.43843596672643, -622.1634755802653, -372.65334215270684, -450.28079948256607, -128.26539387983843, -449.0653838729723, -346.4266640430595, -421.45358374065944, -441.3304228221571, -240.8546873989131, -453.69176084378523, -324.11203947531493, -624.9613395145798, -328.00845587773694, -523.3644114368959, -59.402549244835434, -293.29648550367375, -97.93943807376614, -15.189894919503942, -417.38438316981285, -305.1335223606779, -298.6289366144842, -225.43331021308023, -436.307711144484, -160.0403524846881, -394.03177372781636, -288.38606944833634, -30.714883555150315, -128.69369883145768, -336.9982175841648, -272.7659877380563, -456.5611716528798, -290.5087831122579, 17.019397620381874, -397.0281102002761, -467.4362315388311, -335.19883417035084, 194.57735082501384, 20.000000000000014, -407.9755404146445, -506.15671557774897, -60.99977826597066, -473.2435284337738, -340.0204170677031, -192.1714201179822, -332.9233506229152, -223.5131637445482, -269.5130718105654, -180.35922297241305, -476.1224359250229, -242.0738990482044, -302.1784439751126, -164.2165152620626, -507.67610164787595, -332.2039758596607, -302.1955207003168, -375.83681714160133, -106.25954425540687, -304.7704860718526, -424.2946570265438, -518.4918631297055, -55.931970553223316, -402.54121459169966, -153.8514590599643, -388.8566374608692, -168.28670109994607, -115.14210193288865, -401.3331189976486, -184.486330073811, -257.08418409516224, -319.20162384954017, -510.01941548807275, -448.51270205616066, -451.29013742802283, -303.8246841031102, -322.8208845492621, -300.8209623709347, -500.86578988628924, -205.65581341316945, -416.8225260463003, -362.73397299091397, -335.0944053572473, -379.4410857060583, -37.21635615370284, -331.52686107948, -314.4359388952894, -252.74783035321704, -276.1110012006818, -313.587281917161, -322.86698997908616, -169.55458902416487, -550.6605307649579, -264.7480896030187, -292.87745983885765, -445.49447774215014, -223.2886881875594, -395.0261123205868, -223.08235531623453, 196.3745753129366, -612.6091989856661, -578.0879610765485, 2.2576123947802165, -325.57906394708266, -312.620891149178, -205.16365166502902, -196.40907828685545, 198.03277620169786, -332.02835953114896, -120.7892988398684, -312.4044931905442, -500.0619170720575, -163.0926742955653, -627.599866753914, -381.36758852050866, -713.6368830568564, -133.87726501715338, -382.252178362171, -416.3888870236039, -425.7955743395591, -399.4833459066438, -402.3580768494303, -377.888662853197, -363.4419950987207, -419.68312539401643, -309.2695822803569, -454.43123306328306, -370.8529546017502, -197.06145477370484, -487.67744716680727, -156.0083731527315, -514.6206996643002, -333.3560541509367, -552.3412463390122, -372.1898860353025, -390.9899278783363, 11.556290982654486, -388.0749999199789, 182.18244961330004, -352.2322365559776, -354.8403498129301, -49.60168204959268, -217.70222580394193, -374.49730508918475, -355.8768236965312, -402.41681811951497, -384.41290169445085, -476.7966632169111, -458.0800345274249, -457.97818324686966, -187.94490899739034, -382.50596646210835, -157.20859218899804, -523.7711743007063, -284.7882621803607, -489.8880504517457, -62.18813045767616, -368.76682766917287, -313.7132786551162, -494.1587857407816, 16.506841737344125, -660.2435392149163, 9.68272592435559, -287.5151273724885, -108.8977795753986, -460.28561416286385, -318.0346470501924, -362.0961556228665, -372.76882198292407, -384.12481268035924, -384.77384787556, 160.90673150905334, -430.6218387553766, -333.01122065422976, -333.59523705517915, -69.49210041099752, -272.3809980524559, -341.7785047566121, -116.87930404435319, -576.1321831510038, -7.955869593382738, -529.150665062195, 198.1117702586338, -411.6815908379862, -93.3084784580223, -494.0939260867872, -244.24597241015147, -161.12585667635466, -462.75740971830896], "policy_predator_policy_reward": [402.28449129067536, 430.4549115534062, 403.36863254942557, 446.63917544319565, 504.2412087626193, 583.4604989623197, 393.3005416529987, 303.30024315796277, 453.7731968270245, 202.79137898227998, 253.02995905144337, 379.55523841468096, 395.65898896173843, 543.4505470258521, 318.393284305704, 582.6687689399803, 354.5473807489351, 447.57752747063813, 346.52666404305944, 424.78915502500763, 443.8900113529358, 362.15960151261055, 453.69176084378523, 324.0906541274385, 633.9547935127916, 328.6875619083859, 457.83154214946444, 467.2998147536808, 310.0120841388491, 294.4429344349116, 329.35252574750336, 389.4726007847216, 284.3985301071543, 322.2659705879004, 258.152484052373, 424.97706449719504, 354.02977427562143, 391.59389265941536, 290.5825352575587, 33.276859660547245, 342.24693698407833, 316.2851085478293, 268.70479035972255, 469.5694160289116, 291.108783112258, 5.180602379618103, 405.0940682955311, 463.3283960984314, 336.99883417035073, 2.4226491749861694, 0.0, 410.2755404146446, 507.1371201438311, 125.25091064925748, 475.74352843377363, 381.4590122432814, 130.4460213072865, 383.9165076294544, 287.890422126698, 265.58025608056806, 264.8043691576898, 503.3872940202877, 297.52022247124575, 334.245533023425, 444.7752073313937, 412.11087559760415, 331.50294209427443, 346.21284796137087, 359.12374663729264, 149.24331055901746, 386.4708567316717, 345.2980647520965, 494.37509184044313, 334.2548276964039, 380.6282402911305, 329.3538762462229, 386.7705839965279, 195.30172661304204, 378.1171859416757, 341.5419293491991, 420.6627317336486, 256.07774836746836, 319.7908284099511, 510.01941548807275, 446.02712165243963, 459.5668800618507, 314.49641948800974, 336.95371801292316, 300.8209623709347, 500.86578988628924, 413.9894790294051, 394.89818594198204, 338.35351128397957, 340.3126099741858, 131.37598076097063, 346.60011592147407, 248.04713207656744, 390.9562305124466, 379.54544733268233, 182.76855552176445, 313.687281917161, 322.86698997908616, 462.9842385725582, 471.77283446274015, 269.3480896030184, 292.87745983885765, 398.31117591351517, 330.1297897944862, 364.9927658360251, 391.3500052909021, 522.4735128478954, 273.4249400151503, 428.76979103733646, 268.4084838536821, 376.3660473534221, 325.9048219229946, 264.0964591923055, 143.13304581472826, 3.826998948332137, 332.02835953114896, 302.9928451961875, 265.17162110922175, 443.04846000488527, 475.5202971785472, 629.0998667539143, 381.36758852050866, 474.6874118419521, 577.2648670891357, 397.247011753629, 416.788887023604, 425.9299295065391, 401.9833459066443, 324.2163447773203, 470.5918958835598, 528.1883259312964, 355.98964812019403, 314.1756391128184, 449.63184989502406, 403.4261948302326, 221.63280268865617, 412.749620257349, 343.63771581949516, 372.1026551498527, 424.2903524521923, 598.7755046899077, 363.14641192448164, 392.6899278783367, 6.778328694769225, 388.0749999199789, 3.528919145865711, 352.3719442757696, 357.2025576034651, 294.11821594516283, 218.70435624355713, 374.99730508918475, 355.8768236965312, 402.35020138163253, 385.8303170373872, 445.3199135941604, 475.42500211254554, 279.20068958845087, 470.0353567253538, 420.2092610437717, 240.84287895610993, 523.7711743007063, 289.62479205650186, 385.4565321958981, 448.1884788037979, 368.34666080496083, 373.20946549807974, 352.49981859086665, 492.81549193361155, 622.7849851570209, 188.17222556524166, 288.9151273724885, 121.9038177306448, 434.5398658465447, 351.74228350624855, 364.99615562286715, 372.76882198292407, 352.7508385274034, 399.42327106742374, 11.002397962938902, 430.6218387553766, 333.21122065422975, 333.99523705517913, 353.04694076501465, 7.931741852956841, 374.53621550531307, 75.53926780799758, 522.2207403352252, 262.91719551800185, 529.150665062195, 0.0, 431.66185795748373, 53.102713254729565, 414.14970074046107, 451.0400606788874, 426.0644185494897, 436.7663898251909]}, "sampler_perf": {"mean_raw_obs_processing_ms": 55.93335351403802, "mean_inference_ms": 48.38192593720931, "mean_action_processing_ms": 24.411166150307608, "mean_env_wait_ms": 14.836468796386022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5360274314880371, "StateBufferConnector_ms": 4.122005105018616, "ViewRequirementAgentConnector_ms": 12.381588101387024}, "num_episodes": 72, "episode_return_max": 453.8819862200461, "episode_return_min": -51.58374621319315, "episode_return_mean": 101.0997100282658, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1941280, "num_agent_steps_trained": 1941280, "num_env_steps_sampled": 485320, "num_env_steps_trained": 485320, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 33.38536244842521, "num_env_steps_trained_throughput_per_sec": 33.38536244842521, "timesteps_total": 485320, "num_env_steps_sampled_lifetime": 485320, "num_agent_steps_sampled_lifetime": 1941280, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 1941280, "timers": {"training_iteration_time_ms": 349051.62, "restore_workers_time_ms": 70.341, "training_step_time_ms": 348863.231, "sample_time_ms": 87515.143, "learn_time_ms": 253485.546, "learn_throughput": 35.41, "synch_weights_time_ms": 7106.029}, "counters": {"num_env_steps_sampled": 485320, "num_env_steps_trained": 485320, "num_agent_steps_sampled": 1941280, "num_agent_steps_trained": 1941280}, "done": false, "training_iteration": 60, "trial_id": "cdf01_00000", "date": "2024-08-20_12-04-13", "timestamp": 1724135653, "time_this_iter_s": 244.44953870773315, "time_total_s": 6073.496027231216, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317edb280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6073.496027231216, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 88.24827586206897, "ram_util_percent": 85.59712643678161}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.489938445431846, "cur_kl_coeff": 4.263256414560601e-15, "cur_lr": 0.0001, "total_loss": 8.833625614983696, "policy_loss": -0.002732910076821489, "vf_loss": 8.836358532224383, "vf_explained_var": -0.27226728405271255, "kl": 0.002015756070868926, "entropy": 0.1354287442671401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.71428571428572, "num_grad_updates_lifetime": 38570.5, "diff_num_grad_updates_vs_sampler_policy": 349.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.593598068441663, "cur_kl_coeff": 1.1641532182693479e-11, "cur_lr": 0.0001, "total_loss": 8.38630542755127, "policy_loss": -0.003731550472688728, "vf_loss": 8.390036988258363, "vf_explained_var": 0.38345596994672504, "kl": 0.0032440346795250923, "entropy": 0.3003563702532223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.71428571428572, "num_grad_updates_lifetime": 38570.5, "diff_num_grad_updates_vs_sampler_policy": 349.5}}, "num_env_steps_sampled": 494200, "num_env_steps_trained": 494200, "num_agent_steps_sampled": 1976800, "num_agent_steps_trained": 1976800}, "env_runners": {"episode_reward_max": 539.0039921114014, "episode_reward_min": -83.9842404945024, "episode_reward_mean": 102.08360284932365, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 57600, "policy_reward_min": {"prey_policy": -1478.9606050309626, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1478.9606050309626}, "policy_reward_mean": {"prey_policy": -301.9778453786241, "predator_policy": 353.0196468032861}, "custom_metrics": {}, "hist_stats": {"episode_reward": [237.83645098583358, 9.41598546176342, 6.914494944871052, 293.8309862562276, 58.81977907293102, 6.60398017406864, 234.69001332554737, 323.0210516577305, 111.65378046351783, 8.561251738461841, 18.6035809840805, 156.7199985155535, 147.70684315452158, 239.22461710636708, 214.02682635256775, 106.22442612659634, 388.5329347400011, 96.14468660546774, 17.775573267859382, -9.723653536549342, 2.952836369507339, 64.89482251574687, 41.9325598938292, 126.99453892082339, -68.57363607275934, 12.199999999999992, 5.245959365512379, 266.9169754023416, 68.42049346723778, 163.09999999999965, 17.006899077673346, 72.78006030061862, 104.79737397630545, 116.00512045682224, 66.3933663304601, 227.81411275521245, -19.817959718369206, -10.940579825667847, -2.220446049250313e-16, 86.89227483313518, 77.32218303811406, 19.28455537884599, 31.437523499661964, 294.85485353843956, -26.018119067081745, -21.974519031328548, -6.530586277292845, 19.68908645318508, -81.3684373947063, 2.6546696835238, 43.80549861823923, 16.8977085213769, 435.024346844827, 15.693227381030612, 148.390073538241, 207.9050607351252, 242.28821671659338, 87.25524088861994, 299.3363653943897, 2.39871356525508, 359.7813887214159, 0.5213317894669784, 82.76146232213763, 32.40951460455944, -34.876969599086145, -0.6056714626837914, -83.9842404945024, 1.2018085023358116, 158.5234376711958, 40.4360995885839, 115.99183770236246, 18.080585393228684, 8.881784197001252e-16, 132.84567663429695, 0.10000000000000608, 85.08720510303714, 201.680948839259, 17.384150011576658, 219.29343498813284, 357.3369056093847, 160.86047550816087, 235.62645292035842, -6.406684500942784, 2.1352135161618793, -0.1248893892168681, 28.814579279477393, 171.22657893796077, 31.581556591656213, 3.7381633410228208, 138.9089954686059, 189.58890576574947, 46.64339431462432, 93.18418443699134, 109.32350102527623, 2.5875638300721553, 298.73352061518347, 252.74418031731892, 448.0445402013487, 27.58376870203066, 310.06435087977576, -26.041815385421252, -2.2460878122710812, 163.98360612852306, 28.290515252780708, 112.74112574393334, 11.200303553235912, 2.15775653605008, 51.021068824881, 208.6363202609213, 403.7113047092641, 5.053590934462138, -4.440892098500626e-16, 178.05781692103116, 1.2507902230447305, 93.15027194566963, 21.74634077238299, 184.17276335255724, 1.5742101528378383, 2.457936160409915, 11.421283694817463, 12.78381298095207, -12.585125225742008, 61.34620464180085, 193.66648635918745, 167.04958413179745, 213.56409972900613, 131.28042015385225, 2.6000000000000005, -1.7763568394002505e-15, 12.481396977408753, 0.599999999999995, 31.943675470787028, 197.1714866041004, 75.94923920226168, -0.4814987154179118, 1.3995512226194906, 459.6401278074241, 140.37160278171862, 203.24168898736863, -29.86716496236456, 214.91492897234292, 196.91442856427417, 64.4261193311909, 176.95822776427627, 57.67379771273983, 57.88339455663183, 6.499999999999995, -2.0241779766483785, 41.905863038629406, 277.8240937601448, 90.55045198250572, 32.86188238202903, 210.25032696174625, 2.687722429708156, 180.56046567229214, 18.015781831109077, -29.912629780027356, 80.075361865113, 17.107102134891406, 139.4303795847602, 135.1436457766984, 16.766544618047615, 173.12537616393195, 15.048865944567975, 213.36317940620268, 67.19526196424033, 164.79724580986948, 6.853652111954112, 100.10542911517256, 224.1591473131925, 3.440559235920686, 2.690250172709953, 79.74963832832114, 68.74283308973529, 3.249562526009507, 105.93326438063802, 317.4571078130621, 203.28010846200218, 2.600000000000003, 136.35510550409487, 316.83684091544876, 4.102709496944293, 90.33021490901614, 15.864305338566783, 0.5000000000000018, 199.9634522002964, 227.8478826526003, 263.49859499691433, 99.69623460883213, 31.644160419209992, 475.4645928682612, 202.55802678532862, 99.68563413669182, 11.268541093694402, -17.01901729832935, 203.56504782749346, 114.07627032973345, -5.324463258493234, 162.49579287249594, 0.19999999999999774, 11.180102615418582, 126.25193816800122, 21.947804599989894, 121.77809235636866, 149.67002577171547, -43.24956784321854, 154.20247773844272, 196.20814965920567, 40.184459538162685, 7.799947222149988, 1.4732914315848196, 9.681378413857113, 98.7861194465985, 203.54615872538056, 5.284084641777324, 108.42784550089475, 315.024242229763, -4.227378809365662, 269.88770726991845, 304.32595496016086, 21.36718718524722, 230.3042870876958, 179.56805307101115, 123.22107270659424, 539.0039921114014, 150.2128655051207, 171.91698940865413, 87.3747600872106, 207.14749184530066, 126.93269483484475, 201.09999999999982, 67.34089631625893, -32.445104279234585, 6.690120803219323, 51.395397792355375, 201.44421914137706, 175.21087005591974, 218.7317871221668, 148.98151619092988, 245.43483796670125, 116.12558799224851, 28.998840676880647, 79.38682681857007, 1.609295904187974, 37.0584846023125, -2.220446049250313e-15, 40.713144742334855, -65.81609620224113, 20.132631487366005, 152.16439666348685, -18.369514957804913, 6.899999999999996, 101.80674191778252, 80.50110173937146, 2.494872360402154, 21.438836292759426, -0.047891102546249176, 2.432669751581651, 304.2861482235691, 210.3107845790021, 12.795870254835105, 177.044318011068, 458.71640585350247, 1.3999999999999981, 65.00459418710615, 14.882858641361267, 27.51495150508093, 0.7823646090034138, 28.849858435161515, 103.53599043271356, 319.5164089081017, -8.537643050785704, 264.84630457231754, -3.128826714321856, 53.49416481280096, 15.97816970607876, 37.31834445409995, 68.5442357306914, -52.71110465470959, 11.825191313809999, 267.8892048368975, 6.099999999999996, 367.3051864139067, 367.5025766605869, 182.8610503385276, 87.86717092388758, 265.34759267626015, 161.10719697650612], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [199.1, -439.9415679332922, -227.77047536720062, -365.26013497287204, -341.5339945196935, -397.6405115021247, 191.1583168668273, -1478.9606050309626, -269.69335975794667, -362.8201710033424, -422.07065578339797, -309.60099428042764, -128.11214735350842, -449.0042226797243, -219.39924566687367, -489.9884693521118, -531.2727122258956, 18.77431838717983, -253.2213379846036, -501.29449578954103, -357.433540253764, -367.1290024743864, -444.5387344773516, 6.7849971227171775, -225.41523944325104, -291.2224106354959, -399.3140697668221, -74.79809320537201, -339.9484812488025, -90.97029976758174, -440.09334066178627, -125.6661027885493, -532.6556802820292, -55.02239182811089, -420.2444991065065, -160.95478106551366, -388.5267300073222, -412.85363173666684, -291.6718915321353, -399.17413542316797, -279.47439941078, -302.1805108699223, -295.75089979108145, -317.42897625282154, -504.1616199401975, -63.54706976727053, -395.49363976337946, -262.91352918512086, -388.7945695419291, -386.13050253483186, -343.72269026986737, -252.70142178240067, -339.20567760868954, -360.0262423536259, -412.4169649154087, -161.3819009709802, -298.06315462410635, -335.45822111420006, 160.46014222822322, -367.14516574242555, -590.1293619246628, -318.07371683185545, -375.97833546004125, -264.8538271583197, -500.88505121167816, -119.34518356249208, -428.25633587085565, -96.76606945487191, -480.37771337622974, -158.46038101164945, 8.516953314782677, -505.27888567147437, -95.24455998514735, -429.9192669966086, -523.280646480161, -386.85214030790524, -485.407319634899, -304.8768448496894, -284.8883194216236, -372.2592610587817, -240.39862009408532, -423.50194684554384, -316.99725283915654, -496.3294410757807, -434.55847544166136, -215.46648978968054, -574.1315635460196, -161.0976430132545, -326.32071467129083, -100.44939822644919, -472.15059127445244, -361.82330590611315, -273.7356338675491, -312.72147913372424, -316.12825678296434, -223.89011323524977, -363.41788763645286, -538.1360103652454, -414.94167342831275, -278.5126387833282, -192.53646541365708, -385.9322753545501, -597.3099901894675, -253.96723107850025, 136.05339125362545, -370.74400435298656, -184.99314955777152, -82.37363850408175, -321.30417343955526, -172.00857482938127, -550.1451573345281, 98.49328379515721, -533.7719906710851, -115.36968105789704, -592.0846987882619, -86.44100032956807, -505.8247530307356, -72.45373695007878, -297.40487613548873, -380.73869517198904, -399.3497162204074, 20.185999117941545, -205.5217664800847, -483.93982352201664, -306.11848652826717, -224.41861415599104, -523.9700096831975, -327.0220142435153, -188.68246380971928, -512.2075941869354, -549.8753665481796, -386.36382760627623, -136.62829055878473, -273.29025440822073, -352.6002676657423, -366.0569418396262, -770.0558746458759, -106.3714141451877, -260.21855180506304, -276.13912405544323, -449.65581877268204, -175.54342905383038, -400.8721484398415, -366.58133857931296, -383.5638367482668, -613.3869641084561, -309.6348380155086, -229.52793945418827, -340.83426923791416, -322.63347048632414, -239.6377419267594, -427.1387362756244, -242.06490344723358, -233.59363764308026, -398.28298456241123, -276.5842842790551, -314.4660424426435, 200.0, 0.4201866207188374, -460.5646788179688, -133.47085859763175, -270.40200062245333, -522.4741495058481, -56.57182341242809, -491.1102147826717, -368.4957809692389, -389.7848268569265, -386.8052944827756, -768.4399166618822, -412.85682030643187, -270.2748573842064, -183.37115682348394, -441.9251073465205, -176.34942613024955, -360.02754341913794, -369.8793856168517, -318.78414134072335, -523.5135941899804, -378.16308212842085, -235.24857008868057, -281.711845433499, -85.4995229796391, -503.6428371894627, -256.91321034661, -347.11857581632535, -538.6612032904841, -480.0929942588552, -234.87402276866294, -294.6976299723104, -287.7936673932819, -172.900797333659, -182.10869879308345, 64.17381029859195, -363.1125310400724, -734.3239374700412, 13.728910791183937, -225.18360892351097, -382.38590991457977, -508.38246453897995, 14.787564322513074, -321.743648560858, -288.7694144682234, -487.81954302039264, -320.5037365344767, -148.90222864829292, -562.6699506620494, -323.2947587090677, -271.1531688448724, -220.60887178293498, -434.8679055531004, -377.756328052018, -407.7317893295959, -598.2427685812047, -376.13542553826204, -400.94691325881803, -239.592587083506, -74.49816023289063, -554.5485684435625, -18.266014961159847, -474.99669923275076, -447.1825255499553, -355.52613240467673, -468.95853990857125, -403.6962087720007, 35.75664090181886, -260.00634997684904, -373.44864702372456, -304.5231957869517, -445.033327133714, 16.672068767756695, -392.2971653354017, -353.9948609029292, -304.51737131034696, -135.52038284985758, -299.33532747393406, -386.9028388050494, -329.1345544348954, -263.2423346369871, -383.39372869131444, -327.62031433757625, -350.324558667437, -327.46389279662185, -451.42033650085756, -451.0191589550048, -244.94410092790102, -335.94953103901224, -418.7038973412279, -191.05777392409715, -374.9315225556237, -168.04397123911323, -298.5590783672316, -204.4029404786846, -399.44301307470005, -119.50695209621577, -506.6097027924479, -285.9465731819346, -377.6828708745574, -688.454672444713, -366.19974913183495, -515.520049984357, -369.77180105974395, -725.6432381257972, -176.538763755389, -547.547826533053, -279.90912160899455, -163.24890380390923, -292.8878898754916, -443.7785729471974, -425.2810393968577, -374.72779491344477, -528.5835671204222, -41.687425849111904, -604.6083869813048, -18.37566786587339, -312.22964698212945, -233.32633043248268, -441.0752030640512, 198.2, -355.9923842988979, -340.2303370735213, -581.0041888493749, -309.91900532699657, -508.95052449213404, -129.4326079351925, -271.79109499638764, -313.14939002444964, -121.03075768412393, -337.29331506181325, -455.56866551527884, -89.45730101386566, -389.58266279953097, -214.83459507129714, -271.25614075930173, -237.7847066670609, -325.3638961761129, -400.08846398281463, -557.1966331071534, 20.000000000000014, -317.98788804939625, -336.42685034578574, -335.7278857141555, -235.41074486206963, -119.97059765415605, -335.6897486865882, 13.10359937737513, -553.9178281887453, -497.55493840765376, -270.6418557179593, -594.5058311472153, -36.12527491037613, -317.609096215994, -279.89734633952406, -317.89084400952277, -65.99400298982061, -325.4828734447459, -219.4717809478018, -275.6545940801134, -342.8110666548051, -313.70428917013277, -182.3819499367388, -248.3706620564787, -406.349917567202, -351.4324895898996, -291.18434477554985, -488.67726920136994, -133.85602596215887, -377.7983582543362, -382.07467550193104, -552.7833746496568, -127.33797440124187, -513.3933804987921, -150.95809532970807, -178.83547276755792, -371.19986138992215, -475.9261318691034, -279.7055342455074, -180.8121527799544, -398.6791334058585, -34.075025616027176, -478.2286349708403, -387.549121398933, -289.47597757391344, -345.36494059844495, -327.10623197300333, -54.702383201641005, -484.8393767764687, -413.1492864219425, -359.05565352178445, -367.54293328097765, -340.66542905128745, -542.2532173308113, 17.02636819071107, -320.7809640906145, -18.035665891631087, 200.0, -273.47568726251063, -552.8979544696032, -356.18592756070115, -312.4911248296601, 76.60402022681323, -444.69932567253693, 199.1, -324.11089557938277, -259.26815206446634, -442.72226472638783, -296.3069429658077, -361.0357618377236, -77.44880224115619, -298.49063099446005, -637.2643535187385, -155.64881645774463, -341.4269270760674, -466.4308896875904, -88.3939925756961, -528.9090478736169, -264.69109511327696, -228.66963318086124, -296.5018116121809, -360.38675203966517, -401.58400533911293, 183.3966199165335, -443.21426498946045, -51.933296488216804, -457.4589306948084, -297.93100422021786, -183.6929644403932, -355.6170061650812, -358.9594268419424, -410.7394498681502, -20.359721358035365, -143.31002448997657, -351.173555180867, -309.8329148597184, -300.4412617082623, -393.4266049711512, -292.1311441390623, -363.0140078096775, -63.606260433877026, -357.0662168132315, -498.88373334717477, -170.7861725401373, -324.51283974662493, -120.62550156553591, -571.9682205767114, -116.43006090392882, -418.48919646741933, -628.8946876983752, 20.000000000000014, -262.52105386030195, -482.90231340898856, -294.48807437771484, -537.0151316267459, -177.8321254550796, -350.2614124253134, -490.6180341136815, -236.48349258560287, -612.6836517381627, -302.6173168044532, -350.51608808010235, -122.91160006467354, -321.1761038946999, -261.47851473548855, -436.6069235053747, -280.0119684572862, -505.99661396108917, -247.99037066855198, -66.09591590442275, -389.2975392934083, -40.726426346907175, -202.36323585453107, -378.07221065973084, -320.6157277094797, -157.00204995403016, -327.104078915022, -217.74831183830972, -450.02344748201307, 10.508977926979844, -386.53524647256984, -108.72975234493632, -470.5015381686211, -310.8557227447748, -309.0270489331397, 1.9520021553936215, -305.7828428861357, -66.63804739187594, -457.2901092522717, -223.90518074366472, -305.6630980352973, -547.6125869657964, 200.0, -140.73105793690573, -634.8500122515331, -124.71171375078482, -330.80531422302806, -299.4569329917875, 81.1999999999993, -90.60217003864113, -395.83594081820655, -106.85739506352888, -224.01409260039551, -282.51879292907205, 198.2, -55.78020502997647, -345.54276820495164, -115.56104617963956, -169.15980378871, -354.7340758384088, -397.206774560842, -19.607388367721896, -414.69089566164826, -72.8647827813526, -302.66213298295366, -423.136278974913, -354.54520398434374, 194.34704288602978, -375.4442297019211, -133.55024326981146, -594.0248637141402, -50.72395117798819, -399.29088771107246, -344.92795277802884, -367.0270266678291, -334.38975774323194, -277.01732456843615, -343.43401670767616, -461.9228776346706, -372.7681369367638, -344.0087430363934, -329.6416596787108, -324.55252331087775, -352.1613253243962, -371.2290745037369, 14.591754210747185, -285.18952651204006, -507.6139796150082, -437.3986614788332, -342.6059301163817, -252.62821589092846, -195.73359827116485, -593.804790071974, -35.28727155194941, -495.9665092254952, -331.94895550058516, -529.2050989969105, -294.9159076173196, -378.001740526222, -199.34515493966185, -236.09156109585064, -406.80649512166553, -279.44163302252906, -166.17038636676256, -299.05240038699344, -497.7583419348969, -602.3190369665291, -360.807510191193, -387.2634622434726, 185.60650467301397, -772.1997898264686, 166.61719354235882, -377.54531508519597, -477.10321586197836, -373.0415819348807, -160.96570720235277, -488.04821562001115, -348.40685320468185, 144.41602202373096, -607.9526662985195, -318.480182571034, -164.27976034916566, -319.8629284114164, -363.5557281256991, -400.3492926913491, -102.79306797245701, -193.7118416406736, -301.69246905835274, -376.58697124637723, -172.4284163927387, -759.5548153305348, -362.0888531228251, 31.448162835776444, -345.37923839381, 3.6876076085399774, -361.16099732833663, -421.5288716159691, -27.073829077420715, -391.8166123636318, -256.2164211900301, -300.2241159282908, -374.0249435706865, -211.06206528220363, -328.8091923869847, -109.31036357951282, -225.99920470341638, -354.60175535462463, -242.6064166181225, -378.0487946466652, -270.6700820890795, -114.45007241915597, -299.75503304459454, -357.32954575317564, -161.5292273615765, -332.01137945154454, -333.04493943338963, -236.58369324899567, 193.08116718610964, -277.53164540551893, 56.33906178557097, -580.583849714216, -357.1867361108164, -93.24813680869384, -291.7559779420378, 50.78355698046218, 194.63176301278526, -751.5654029498802, -419.6651154032468, -44.15720150051101], "policy_predator_policy_reward": [147.04415293576488, 331.63386598336075, 236.98646082896397, 365.460134972872, 370.6673259197835, 375.42167504690485, 102.67266938940004, 1478.9606050309626, 336.5927530539134, 354.74055678030845, 422.07065578339797, 316.2049744544961, 395.14769998532546, 416.65868337345483, 595.9322022001855, 436.4765644765318, 477.42667134938824, 146.72550295284555, 261.78258972306537, 501.29449578954103, 377.1672953617763, 365.9988283504549, 408.1110017400465, 186.36273413014115, 366.48694310023325, 297.85755013303674, 348.3866174157453, 364.95016266281544, 323.6041374810539, 321.3414698878969, 351.1854076912569, 320.7984618856745, 506.4562101224727, 469.7547967276686, 424.2795740326659, 253.06439274482085, 394.9317251390254, 424.22420987282226, 281.2738700579989, 399.84850336075556, 284.15063866543636, 300.45710798477353, 374.45277460068047, 303.62192395897125, 65.08120460213816, 544.5600449991588, 428.1264101201422, 357.27529774918344, 550.8630658267573, 155.48837017724617, 353.0226902698674, 255.6014217824005, 344.4056776086895, 360.07220171913826, 347.0340586675019, 493.681782621229, 328.0669004939196, 373.8749687116248, 0.7398577717765481, 369.0451657424254, 591.3917027551486, 333.8182750790432, 399.1947118959824, 314.4175110229973, 244.04881425937802, 480.9787944910971, 438.4987799531105, 202.5287458294406, 485.38555857329214, 219.84590214504686, 421.8944656545362, 302.6815794573689, 69.95638793824716, 435.38947932513963, 532.9607687771497, 366.23143818524903, 485.407319634899, 304.8768448496894, 275.09588108394456, 468.94397422959776, 417.45234937755697, 323.7704006001856, 335.7818082180025, 496.82944107578084, 298.66985574324866, 382.79263298775436, 493.2439252087475, 536.8401348889658, 393.2251262934164, 7.5268675372414675, 356.2979922938061, 455.701385855431, 261.2729262319195, 318.65360049206083, 317.75498413778456, 241.9524723336147, 526.1967410799667, 293.9887195270301, 414.99634311183655, 281.11263878332807, 244.80813674680059, 377.4661026396454, 585.8694747367405, 282.30545505260403, 347.8187097851598, 321.89625015902567, 0.0, 283.0600154428826, 285.4470715296076, 356.2557502775695, 538.3169643751969, 121.23996989929897, 463.06565570116334, 428.36423274441256, 120.30025286972382, 645.4806871367257, 434.9279959308542, 442.6868594443497, 299.80358970074377, 380.73869517198904, 381.444391496851, 357.5007143270294, 206.04309826955154, 483.93982352201664, 278.4970976708692, 334.80146533552687, 550.036758206483, 333.3647803247898, 244.52087306186743, 421.4922153357026, 549.2696950854959, 386.36382760627623, 293.7797370265741, 32.154567445928805, 381.8680466928183, 337.99097131488645, 770.1843029823466, 264.76642347991265, 305.76392353031497, 271.029851918775, 325.5028982917617, 415.68818723711166, 393.953249246449, 391.5808231659346, 383.5638367482668, 613.3869641084561, 296.989619877348, 375.0188342266452, 340.9342692379141, 322.63347048632414, 338.7883817659158, 413.075301539506, 124.89820831915583, 552.4412816104167, 401.097249381792, 291.15416947125095, 79.7143640354465, 254.04511339533005, 380.04827302589405, 437.4331247807404, 327.0882294073723, 237.64510532087357, 459.5897831656765, 355.0826426729573, 510.32726105153927, 342.87205019942894, 391.67233762164113, 387.0529972342229, 498.64931019795864, 682.5225373811376, 271.9748573842064, 210.48573610296097, 406.0239393386705, 383.47717307606, 386.29302511957684, 375.1954605080689, 319.78414134072335, 526.2517575310032, 383.3741953337329, 368.94645235197476, 284.0461538038032, 272.75412037508426, 506.7054880285258, 300.49395382217176, 604.2068131268626, 374.75715041693945, 479.9918939725555, 344.29862408023877, 275.05244015086026, 310.02642104480384, 304.3534173064439, 349.38959943548105, 216.73653145094343, 334.9463696078568, 608.5129928973344, 560.1265739828701, 250.51462779482074, 384.63865974530063, 410.2580555481126, 393.40119554813, 295.1895769196688, 289.2816707239911, 486.1645249323208, 319.9126668102774, 322.3801181931128, 553.1756672457514, 353.5480800633324, 269.1903627433887, 317.2499975268672, 450.9679055531004, 410.42724923605755, 386.2611716987923, 593.5565209932655, 382.9794296622516, 436.05219963401055, 255.50836953319384, 363.61548964604094, 474.067559291335, 463.81395578104554, 433.16006312212784, 449.1806054431934, 358.58164344590085, 468.95853990857125, 403.6962087720007, 140.52093950783694, 261.7865864882244, 373.3994372467693, 305.8231957869517, 422.22328677377783, 99.2882435378494, 392.74305664067805, 375.29531037003596, 316.9175001545928, 307.2930173581678, 300.70953762677215, 387.1028388050495, 329.1980669678385, 265.63675826445376, 370.7775423630708, 351.6577843606374, 345.0084766881873, 345.5637877568241, 431.78633079826267, 458.068039431857, 303.04829943584093, 339.19153717287304, 359.7703885291565, 443.6577690953552, 355.544931627618, 354.48014629891617, 355.08922001263613, 361.4368985622861, 376.1178572130547, 274.11252811171323, 506.6097027924479, 288.54657318193455, 377.6828708745574, 688.454672444713, 366.19974913183495, 528.0014469617654, 370.3718010597439, 725.6432381257972, 380.5521182207143, 375.4781475385151, 322.31431342142014, 318.0151985955844, 445.25355322013064, 367.3621488048218, 427.12715177806086, 372.40018381682387, 476.3646634866429, 95.30588070551077, 538.3848322425324, 544.2393504120689, 266.629002175625, 419.29857802070484, 441.0752030640512, 5.041688987368647, 344.32577665835566, 322.02977975169995, 579.0035083221926, 526.8346148265227, 419.3709497527167, 415.9266112388836, 318.0347344314521, 331.3318699205766, 316.48585749618337, 318.7964430140295, 166.8102793507156, 435.88948489116774, 342.8539548220913, 319.4466976053683, 274.35614075930164, 241.184706667061, 357.4271059075915, 366.0010762746883, 212.70468766958288, 366.39780847619977, 502.468571749613, 429.7702604057139, 280.5841624073034, 381.10492015142694, 337.4897486865881, 151.0324800361842, 463.7141428059157, 287.3504129672017, 497.55493840765376, 273.3295781476673, 524.9173720285804, 286.27419970130296, 310.54256019358206, 304.9796641930458, 332.4242237660461, 21.547993453270056, 300.6659783883717, 324.3640378692884, 290.898077175378, 344.6746856944325, 308.0829979634572, 327.4336207281738, 408.6301988419181, 381.23402655846064, 346.1780935196904, 313.20528546380615, 479.95027746353253, 315.7083938639281, 391.9094036954454, 383.01249600539103, 328.3459176643156, 565.1386107927857, 526.1171747957195, 205.42956299702067, 353.0690814722255, 361.7634984951236, 477.5011925670339, 284.9841256595305, 367.7132386289438, 311.8834766720414, 459.2289737372894, 277.23383416277187, 396.34634455265694, 284.1193136561102, 338.5190578845329, 336.64236485962533, 134.25202152996275, 485.0393767764687, 404.11201843141635, 436.83575460204514, 370.94029947960456, 340.51762537866995, 538.3567496339671, 92.80336388677192, 322.52852992143374, 333.74520787387434, 2.3701626930034223, 274.3856330315098, 555.4979544696031, 356.18592756070115, 312.4911248296601, 59.751085277281646, 223.17198288884842, 339.2641836991378, 333.43711714505184, 254.0446399957415, 318.2694272542358, 511.0899953469774, 363.6357618377242, 90.7131075797229, 298.99063099446005, 637.2643535187385, 334.3519782373572, 362.6872174967512, 520.9793048558813, 261.69346006000706, 587.4969018962717, 469.6018360875362, 314.69548426481794, 310.1721951370557, 353.2857015606012, 440.3292162373871, 364.42172480956674, 370.860513131621, 261.647875252778, 450.3023787155763, 316.1641026624738, 265.14550013482915, 367.1932495487015, 358.6517245520167, 413.2390453578503, 0.8411085700057481, 347.16649882751045, 350.88212867082603, 336.7498099901466, 387.60063690757, 371.52631047403986, 308.70697537768103, 425.27393747089906, 163.84212364515247, 357.0662168132315, 499.08373334717476, 330.5717587056921, 175.9073561964876, 551.600262624176, 267.2453976860725, 138.3778655039187, 418.48919646741933, 225.18331165843955, 505.4894683963059, 456.5893060290751, 438.5040870119321, 501.1113656932319, 287.14227246801016, 334.2933302468303, 348.00268537200515, 472.6877354293791, 450.6219409291114, 611.9949040524641, 343.4905240283153, 379.32387756125905, 101.90375780566666, 321.9761038946999, 262.15180616707335, 438.30692350537475, 287.99334687114305, 507.6232899348731, 345.1498141413662, 367.5092198290553, 291.4303940941562, 0.0, 248.37374684321537, 517.2960602538811, 289.81972361622627, 435.6931245821813, 363.437246516635, 213.52093302894374, 450.02344748201307, 293.7397060449479, 352.17426977056175, 470.5999603307444, 412.95728514297343, 320.4911014612266, 320.758857401936, 267.01281148357634, 267.122316334862, 338.6030966273668, 364.893113087793, 352.3081610494981, 300.4811904360578, 441.53255683200524, 445.084022245193, 326.223323711556, 599.5706119820015, 356.68059725389463, 270.75342012857226, 300.85693299178746, 4.774760087211355, 363.69558904879244, 329.890013653357, 218.33458063927705, 239.46960185949112, 285.41879292907186, 0.0, 27.07270625837721, 441.5911632928093, 252.27574568911425, 0.0, 440.5513578533956, 318.07961334907367, 130.7301116089583, 354.9635702127675, 277.66058821788806, 299.31054668779467, 477.8106445191902, 475.08170849598713, 371.3118068625801, 28.517167075477985, 631.2402550914081, 245.31636808347304, 336.6861522226539, 358.76352463310843, 473.13207442835943, 354.94849300974823, 311.85401304939745, 328.55190993915204, 432.32474140264924, 452.41897975826896, 349.9288650251093, 368.457310852236, 327.1097328336105, 364.14293475829163, 352.1613253243962, 371.2290745037369, 25.921390531587527, 285.38952651204005, 381.270096983006, 497.92644790859435, 377.9136935649524, 237.45308392972493, 472.63784639835785, 469.0649386082672, 14.351037584390957, 498.5332282352487, 338.848955500585, 529.2050989969105, 388.2793039128373, 386.44508614848644, 284.0676806451335, 231.87013712974988, 406.70136748206767, 282.04163302252897, 246.91744977983643, 239.74417326667816, 497.71045083235066, 602.3190369665291, 362.7746280671062, 387.7290141191414, 710.2441059101959, 180.63532746682685, 145.12093976858688, 276.1179663532524, 496.05283668918344, 366.88783136251095, 426.0347237508814, 400.0235170825506, 323.24734189468904, 339.45989513976303, 607.9526662985195, 319.88018257103397, 339.4113005791827, 209.73598236850586, 359.1776416611081, 419.6102377973006, 284.7881079350371, 39.23175318317345, 298.4007894203741, 380.6610154933593, 201.27827482790016, 759.5548153305348, 108.45078529400415, 325.72589542575895, 314.8712226506786, 346.336817042693, 307.2627686944594, 466.8894571990616, 348.6093947335814, 335.1273512797891, 274.2207919614453, 279.0909184425535, 366.4966966177221, 272.0844770479687, 107.54689745082582, 346.5508282217499, 278.86669236806244, 339.05261214407864, 311.4854443661025, 377.7140026293755, 328.85132704183604, 3.557722811689344, 308.98022435840477, 359.92954575317543, 345.14822582282295, 416.2815858271963, 335.84493943339027, 239.8836932489955, 274.9370496399227, 176.81861499339274, 482.55046237834154, 409.1969022108893, 354.62008955453535, 278.67583370350286, 315.47760372203635, 13.36198816342709, 87.2886122586458, 734.9926203547088, 377.9595396047763, 246.9699742754882]}, "sampler_perf": {"mean_raw_obs_processing_ms": 74.69024784585346, "mean_inference_ms": 64.62254553866927, "mean_action_processing_ms": 25.777590422270833, "mean_env_wait_ms": 19.821265446680123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.3129579524199169, "StateBufferConnector_ms": 3.3372072296010122, "ViewRequirementAgentConnector_ms": 13.708067271444532}, "num_episodes": 288, "episode_return_max": 539.0039921114014, "episode_return_min": -83.9842404945024, "episode_return_mean": 102.08360284932365, "episodes_this_iter": 288}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1976800, "num_agent_steps_trained": 1976800, "num_env_steps_sampled": 494200, "num_env_steps_trained": 494200, "num_env_steps_sampled_this_iter": 8880, "num_env_steps_trained_this_iter": 8880, "num_env_steps_sampled_throughput_per_sec": 13.301872829277421, "num_env_steps_trained_throughput_per_sec": 13.301872829277421, "timesteps_total": 494200, "num_env_steps_sampled_lifetime": 494200, "num_agent_steps_sampled_lifetime": 1976800, "num_steps_trained_this_iter": 8880, "agent_timesteps_total": 1976800, "timers": {"training_iteration_time_ms": 398776.817, "restore_workers_time_ms": 71.266, "training_step_time_ms": 398534.857, "sample_time_ms": 128916.744, "learn_time_ms": 258257.327, "learn_throughput": 35.097, "synch_weights_time_ms": 10303.28}, "counters": {"num_env_steps_sampled": 494200, "num_env_steps_trained": 494200, "num_agent_steps_sampled": 1976800, "num_agent_steps_trained": 1976800}, "done": false, "training_iteration": 61, "trial_id": "cdf01_00000", "date": "2024-08-20_12-15-50", "timestamp": 1724136350, "time_this_iter_s": 692.4079201221466, "time_total_s": 6765.903947353363, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52c45e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6765.903947353363, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 89.85908071748878, "ram_util_percent": 84.31625560538117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.632192890417008, "cur_kl_coeff": 2.1316282072803005e-15, "cur_lr": 0.0001, "total_loss": 8.959317328437926, "policy_loss": -0.003355935178623195, "vf_loss": 8.962673252347916, "vf_explained_var": -0.44795264242187377, "kl": 0.0021264345754403507, "entropy": 0.13732523893316587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 39235.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.468713437943231, "cur_kl_coeff": 5.82076609134674e-12, "cur_lr": 0.0001, "total_loss": 8.782390941892352, "policy_loss": -0.004082026896953937, "vf_loss": 8.786472963908363, "vf_explained_var": 0.2582768904784369, "kl": 0.003579925113768291, "entropy": 0.2765760837329759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 39235.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 502200, "num_env_steps_trained": 502200, "num_agent_steps_sampled": 2008800, "num_agent_steps_trained": 2008800}, "env_runners": {"episode_reward_max": 539.0039921114014, "episode_reward_min": -65.81609620224113, "episode_reward_mean": 107.24374153654604, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -772.1997898264686, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 759.5548153305348}, "policy_reward_mean": {"prey_policy": -283.34729328629766, "predator_policy": 336.96916405457074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [114.07627032973345, -5.324463258493234, 162.49579287249594, 0.19999999999999774, 11.180102615418582, 126.25193816800122, 21.947804599989894, 121.77809235636866, 149.67002577171547, -43.24956784321854, 154.20247773844272, 196.20814965920567, 40.184459538162685, 7.799947222149988, 1.4732914315848196, 9.681378413857113, 98.7861194465985, 203.54615872538056, 5.284084641777324, 108.42784550089475, 315.024242229763, -4.227378809365662, 269.88770726991845, 304.32595496016086, 21.36718718524722, 230.3042870876958, 179.56805307101115, 123.22107270659424, 539.0039921114014, 150.2128655051207, 171.91698940865413, 87.3747600872106, 207.14749184530066, 126.93269483484475, 201.09999999999982, 67.34089631625893, -32.445104279234585, 6.690120803219323, 51.395397792355375, 201.44421914137706, 175.21087005591974, 218.7317871221668, 148.98151619092988, 245.43483796670125, 116.12558799224851, 28.998840676880647, 79.38682681857007, 1.609295904187974, 37.0584846023125, -2.220446049250313e-15, 40.713144742334855, -65.81609620224113, 20.132631487366005, 152.16439666348685, -18.369514957804913, 6.899999999999996, 101.80674191778252, 80.50110173937146, 2.494872360402154, 21.438836292759426, -0.047891102546249176, 2.432669751581651, 304.2861482235691, 210.3107845790021, 12.795870254835105, 177.044318011068, 458.71640585350247, 1.3999999999999981, 65.00459418710615, 14.882858641361267, 27.51495150508093, 0.7823646090034138, 28.849858435161515, 103.53599043271356, 319.5164089081017, -8.537643050785704, 264.84630457231754, -3.128826714321856, 53.49416481280096, 15.97816970607876, 37.31834445409995, 68.5442357306914, -52.71110465470959, 11.825191313809999, 267.8892048368975, 6.099999999999996, 367.3051864139067, 367.5025766605869, 182.8610503385276, 87.86717092388758, 265.34759267626015, 161.10719697650612, 32.069178490942, 162.6211027719463, 21.416284955304565, 86.26044395822618, 167.19383036133735, 61.87592300123948, 288.98385865196207, -12.39013439342268], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-309.8329148597184, -300.4412617082623, -393.4266049711512, -292.1311441390623, -363.0140078096775, -63.606260433877026, -357.0662168132315, -498.88373334717477, -170.7861725401373, -324.51283974662493, -120.62550156553591, -571.9682205767114, -116.43006090392882, -418.48919646741933, -628.8946876983752, 20.000000000000014, -262.52105386030195, -482.90231340898856, -294.48807437771484, -537.0151316267459, -177.8321254550796, -350.2614124253134, -490.6180341136815, -236.48349258560287, -612.6836517381627, -302.6173168044532, -350.51608808010235, -122.91160006467354, -321.1761038946999, -261.47851473548855, -436.6069235053747, -280.0119684572862, -505.99661396108917, -247.99037066855198, -66.09591590442275, -389.2975392934083, -40.726426346907175, -202.36323585453107, -378.07221065973084, -320.6157277094797, -157.00204995403016, -327.104078915022, -217.74831183830972, -450.02344748201307, 10.508977926979844, -386.53524647256984, -108.72975234493632, -470.5015381686211, -310.8557227447748, -309.0270489331397, 1.9520021553936215, -305.7828428861357, -66.63804739187594, -457.2901092522717, -223.90518074366472, -305.6630980352973, -547.6125869657964, 200.0, -140.73105793690573, -634.8500122515331, -124.71171375078482, -330.80531422302806, -299.4569329917875, 81.1999999999993, -90.60217003864113, -395.83594081820655, -106.85739506352888, -224.01409260039551, -282.51879292907205, 198.2, -55.78020502997647, -345.54276820495164, -115.56104617963956, -169.15980378871, -354.7340758384088, -397.206774560842, -19.607388367721896, -414.69089566164826, -72.8647827813526, -302.66213298295366, -423.136278974913, -354.54520398434374, 194.34704288602978, -375.4442297019211, -133.55024326981146, -594.0248637141402, -50.72395117798819, -399.29088771107246, -344.92795277802884, -367.0270266678291, -334.38975774323194, -277.01732456843615, -343.43401670767616, -461.9228776346706, -372.7681369367638, -344.0087430363934, -329.6416596787108, -324.55252331087775, -352.1613253243962, -371.2290745037369, 14.591754210747185, -285.18952651204006, -507.6139796150082, -437.3986614788332, -342.6059301163817, -252.62821589092846, -195.73359827116485, -593.804790071974, -35.28727155194941, -495.9665092254952, -331.94895550058516, -529.2050989969105, -294.9159076173196, -378.001740526222, -199.34515493966185, -236.09156109585064, -406.80649512166553, -279.44163302252906, -166.17038636676256, -299.05240038699344, -497.7583419348969, -602.3190369665291, -360.807510191193, -387.2634622434726, 185.60650467301397, -772.1997898264686, 166.61719354235882, -377.54531508519597, -477.10321586197836, -373.0415819348807, -160.96570720235277, -488.04821562001115, -348.40685320468185, 144.41602202373096, -607.9526662985195, -318.480182571034, -164.27976034916566, -319.8629284114164, -363.5557281256991, -400.3492926913491, -102.79306797245701, -193.7118416406736, -301.69246905835274, -376.58697124637723, -172.4284163927387, -759.5548153305348, -362.0888531228251, 31.448162835776444, -345.37923839381, 3.6876076085399774, -361.16099732833663, -421.5288716159691, -27.073829077420715, -391.8166123636318, -256.2164211900301, -300.2241159282908, -374.0249435706865, -211.06206528220363, -328.8091923869847, -109.31036357951282, -225.99920470341638, -354.60175535462463, -242.6064166181225, -378.0487946466652, -270.6700820890795, -114.45007241915597, -299.75503304459454, -357.32954575317564, -161.5292273615765, -332.01137945154454, -333.04493943338963, -236.58369324899567, 193.08116718610964, -277.53164540551893, 56.33906178557097, -580.583849714216, -357.1867361108164, -93.24813680869384, -291.7559779420378, 50.78355698046218, 194.63176301278526, -751.5654029498802, -419.6651154032468, -44.15720150051101, -709.5570392609209, -287.7780439536054, -376.4729983912457, -117.54036703930342, -339.37162625387936, -325.29576714007675, -342.0574769043708, -182.74115843877837, -270.4441342527505, -337.83084208996837, -87.62810837111809, -536.0944345187513, -423.04899222344716, 24.602690586053036, -452.5877904603912, -170.28958044109172], "policy_predator_policy_reward": [336.7498099901466, 387.60063690757, 371.52631047403986, 308.70697537768103, 425.27393747089906, 163.84212364515247, 357.0662168132315, 499.08373334717476, 330.5717587056921, 175.9073561964876, 551.600262624176, 267.2453976860725, 138.3778655039187, 418.48919646741933, 225.18331165843955, 505.4894683963059, 456.5893060290751, 438.5040870119321, 501.1113656932319, 287.14227246801016, 334.2933302468303, 348.00268537200515, 472.6877354293791, 450.6219409291114, 611.9949040524641, 343.4905240283153, 379.32387756125905, 101.90375780566666, 321.9761038946999, 262.15180616707335, 438.30692350537475, 287.99334687114305, 507.6232899348731, 345.1498141413662, 367.5092198290553, 291.4303940941562, 0.0, 248.37374684321537, 517.2960602538811, 289.81972361622627, 435.6931245821813, 363.437246516635, 213.52093302894374, 450.02344748201307, 293.7397060449479, 352.17426977056175, 470.5999603307444, 412.95728514297343, 320.4911014612266, 320.758857401936, 267.01281148357634, 267.122316334862, 338.6030966273668, 364.893113087793, 352.3081610494981, 300.4811904360578, 441.53255683200524, 445.084022245193, 326.223323711556, 599.5706119820015, 356.68059725389463, 270.75342012857226, 300.85693299178746, 4.774760087211355, 363.69558904879244, 329.890013653357, 218.33458063927705, 239.46960185949112, 285.41879292907186, 0.0, 27.07270625837721, 441.5911632928093, 252.27574568911425, 0.0, 440.5513578533956, 318.07961334907367, 130.7301116089583, 354.9635702127675, 277.66058821788806, 299.31054668779467, 477.8106445191902, 475.08170849598713, 371.3118068625801, 28.517167075477985, 631.2402550914081, 245.31636808347304, 336.6861522226539, 358.76352463310843, 473.13207442835943, 354.94849300974823, 311.85401304939745, 328.55190993915204, 432.32474140264924, 452.41897975826896, 349.9288650251093, 368.457310852236, 327.1097328336105, 364.14293475829163, 352.1613253243962, 371.2290745037369, 25.921390531587527, 285.38952651204005, 381.270096983006, 497.92644790859435, 377.9136935649524, 237.45308392972493, 472.63784639835785, 469.0649386082672, 14.351037584390957, 498.5332282352487, 338.848955500585, 529.2050989969105, 388.2793039128373, 386.44508614848644, 284.0676806451335, 231.87013712974988, 406.70136748206767, 282.04163302252897, 246.91744977983643, 239.74417326667816, 497.71045083235066, 602.3190369665291, 362.7746280671062, 387.7290141191414, 710.2441059101959, 180.63532746682685, 145.12093976858688, 276.1179663532524, 496.05283668918344, 366.88783136251095, 426.0347237508814, 400.0235170825506, 323.24734189468904, 339.45989513976303, 607.9526662985195, 319.88018257103397, 339.4113005791827, 209.73598236850586, 359.1776416611081, 419.6102377973006, 284.7881079350371, 39.23175318317345, 298.4007894203741, 380.6610154933593, 201.27827482790016, 759.5548153305348, 108.45078529400415, 325.72589542575895, 314.8712226506786, 346.336817042693, 307.2627686944594, 466.8894571990616, 348.6093947335814, 335.1273512797891, 274.2207919614453, 279.0909184425535, 366.4966966177221, 272.0844770479687, 107.54689745082582, 346.5508282217499, 278.86669236806244, 339.05261214407864, 311.4854443661025, 377.7140026293755, 328.85132704183604, 3.557722811689344, 308.98022435840477, 359.92954575317543, 345.14822582282295, 416.2815858271963, 335.84493943339027, 239.8836932489955, 274.9370496399227, 176.81861499339274, 482.55046237834154, 409.1969022108893, 354.62008955453535, 278.67583370350286, 315.47760372203635, 13.36198816342709, 87.2886122586458, 734.9926203547088, 377.9595396047763, 246.9699742754882, 709.5570392609209, 319.84722244454883, 332.07451223620444, 324.5599559662912, 337.8499270241404, 348.2337513251202, 239.84079898241532, 371.2182803189593, 439.0346958983564, 336.43411080570206, 155.20278304497035, 530.3956828461374, 390.939855631556, 296.4903046578002, 455.440326234509, 155.04691027355048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 83.76018218868111, "mean_inference_ms": 71.94036202405955, "mean_action_processing_ms": 27.081638506708813, "mean_env_wait_ms": 21.890306513118308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 1.359940528869629, "StateBufferConnector_ms": 3.883882522583008, "ViewRequirementAgentConnector_ms": 13.92353367805481}, "num_episodes": 8, "episode_return_max": 539.0039921114014, "episode_return_min": -65.81609620224113, "episode_return_mean": 107.24374153654604, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2008800, "num_agent_steps_trained": 2008800, "num_env_steps_sampled": 502200, "num_env_steps_trained": 502200, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 25.626661664249486, "num_env_steps_trained_throughput_per_sec": 25.626661664249486, "timesteps_total": 502200, "num_env_steps_sampled_lifetime": 502200, "num_agent_steps_sampled_lifetime": 2008800, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2008800, "timers": {"training_iteration_time_ms": 403025.896, "restore_workers_time_ms": 85.434, "training_step_time_ms": 402747.729, "sample_time_ms": 129400.05, "learn_time_ms": 261946.908, "learn_throughput": 34.602, "synch_weights_time_ms": 10298.031}, "counters": {"num_env_steps_sampled": 502200, "num_env_steps_trained": 502200, "num_agent_steps_sampled": 2008800, "num_agent_steps_trained": 2008800}, "done": false, "training_iteration": 62, "trial_id": "cdf01_00000", "date": "2024-08-20_12-21-45", "timestamp": 1724136705, "time_this_iter_s": 321.85718989372253, "time_total_s": 7087.761137247086, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317edbaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7087.761137247086, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 43.68690909090909, "ram_util_percent": 85.21527272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.364737393364074, "cur_kl_coeff": 1.0658141036401502e-15, "cur_lr": 0.0001, "total_loss": 8.836458913106767, "policy_loss": -0.0037803639110828204, "vf_loss": 8.840239300803532, "vf_explained_var": -0.2027683537157755, "kl": 0.0024190648221469424, "entropy": 0.15140102730383947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 39865.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.202755409952194, "cur_kl_coeff": 2.91038304567337e-12, "cur_lr": 0.0001, "total_loss": 8.549309095503792, "policy_loss": -0.0032044557625398274, "vf_loss": 8.552513546413845, "vf_explained_var": 0.3436962578031752, "kl": 0.003373961594605221, "entropy": 0.28991449631395794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 39865.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 510200, "num_env_steps_trained": 510200, "num_agent_steps_sampled": 2040800, "num_agent_steps_trained": 2040800}, "env_runners": {"episode_reward_max": 458.71640585350247, "episode_reward_min": -120.1175368491433, "episode_reward_mean": 104.06919771755983, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -759.5548153305348, "predator_policy": 3.557722811689344}, "policy_reward_max": {"prey_policy": 194.63176301278526, "predator_policy": 759.5548153305348}, "policy_reward_mean": {"prey_policy": -285.3505195885622, "predator_policy": 337.3851184473421}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.795870254835105, 177.044318011068, 458.71640585350247, 1.3999999999999981, 65.00459418710615, 14.882858641361267, 27.51495150508093, 0.7823646090034138, 28.849858435161515, 103.53599043271356, 319.5164089081017, -8.537643050785704, 264.84630457231754, -3.128826714321856, 53.49416481280096, 15.97816970607876, 37.31834445409995, 68.5442357306914, -52.71110465470959, 11.825191313809999, 267.8892048368975, 6.099999999999996, 367.3051864139067, 367.5025766605869, 182.8610503385276, 87.86717092388758, 265.34759267626015, 161.10719697650612, 32.069178490942, 162.6211027719463, 21.416284955304565, 86.26044395822618, 167.19383036133735, 61.87592300123948, 288.98385865196207, -12.39013439342268, 2.3639299331842656, 350.0872013558411, 41.50881350757342, 57.81393776311138, 9.366227868735857, 233.04123686388323, 223.43637318182954, 202.33751202426697, 167.90596208816413, 111.52244934051353, 2.933705673511035, 81.42887122093089, 9.0666748192738, 173.1599290323068, 198.64975080583136, 148.34071616710816, 246.09428164995563, 6.4151111829277125, 225.30458522386112, -120.1175368491433, 277.07006521568616, 87.15618156603, 242.08037648597806, 7.452715696217318, 6.234837794001093, 195.48277790270987, -25.480022756852176, 92.5238583964096, 19.056854850514014, 11.93265949037443, 181.81530706863242, 69.2915169068938, 105.48660596311328, 3.1280131162445635, 14.08022288570115, 3.356836918931473, 7.269919028984165, 197.56652348210147, 282.8512810759432, 59.697015095396075, -26.283817853193284, 129.5049097885249, 11.471938106973363, 285.4068300450223, -106.46635463640739, 180.15732317552462, 306.61848904439637, 9.202027313380892, 192.51635755553707, 10.804749223226843, -3.567775523174152, 40.19002590872786, 6.550190991786765, 154.45561279478065, -14.177244205291668, 167.7788500550087, 77.97935065042265, 7.236422173684824, 198.5867163987537, 1.740292652755782, 1.9233135872536056, 46.98495006739383, 123.48268587746453, 284.4277258947313], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-477.10321586197836, -373.0415819348807, -160.96570720235277, -488.04821562001115, -348.40685320468185, 144.41602202373096, -607.9526662985195, -318.480182571034, -164.27976034916566, -319.8629284114164, -363.5557281256991, -400.3492926913491, -102.79306797245701, -193.7118416406736, -301.69246905835274, -376.58697124637723, -172.4284163927387, -759.5548153305348, -362.0888531228251, 31.448162835776444, -345.37923839381, 3.6876076085399774, -361.16099732833663, -421.5288716159691, -27.073829077420715, -391.8166123636318, -256.2164211900301, -300.2241159282908, -374.0249435706865, -211.06206528220363, -328.8091923869847, -109.31036357951282, -225.99920470341638, -354.60175535462463, -242.6064166181225, -378.0487946466652, -270.6700820890795, -114.45007241915597, -299.75503304459454, -357.32954575317564, -161.5292273615765, -332.01137945154454, -333.04493943338963, -236.58369324899567, 193.08116718610964, -277.53164540551893, 56.33906178557097, -580.583849714216, -357.1867361108164, -93.24813680869384, -291.7559779420378, 50.78355698046218, 194.63176301278526, -751.5654029498802, -419.6651154032468, -44.15720150051101, -709.5570392609209, -287.7780439536054, -376.4729983912457, -117.54036703930342, -339.37162625387936, -325.29576714007675, -342.0574769043708, -182.74115843877837, -270.4441342527505, -337.83084208996837, -87.62810837111809, -536.0944345187513, -423.04899222344716, 24.602690586053036, -452.5877904603912, -170.28958044109172, -401.7485695827073, -264.04693717883214, -51.97042753650918, -478.57875024861346, -387.1240645389453, -417.25058790027106, -267.7241623502151, -205.28000935316237, -460.2741300818362, -369.3433364185007, -461.0903206483599, -182.4270420376853, -305.2891738062812, -173.02032696357497, -131.92567686071115, -302.04316520368155, -359.2970850041819, -129.6793703028942, -357.3348780811583, -389.5183296753506, -383.7911426378062, -344.10000539909174, -173.86998744996185, -357.4958190069568, -359.0783176589432, -338.122546436002, 156.46052423985094, -502.2389286246393, -506.568639679788, 3.069139129828045, -616.2421729330881, 16.091479015082374, -426.5844890302737, 184.03006567855766, -378.9315977427653, -325.0239698506906, -413.1033748808639, -100.30535331929774, -352.8180295580752, -158.81888742709148, -132.1203299134058, -471.8001853166528, -451.02744474856235, -3.203951111656103, -133.26067324629886, -366.4985899502594, -225.5194844040914, -261.4575014446211, -293.97186228828036, -352.5805613380349, -478.5402054820406, -105.31385900351614, -142.49431918462935, -386.3736202498546, -337.8797802386582, -221.37049688831215, -314.39267577551703, -333.1138906413482, -416.63568565711546, -482.9262247623358, -55.64621983865206, -222.858417347201, -339.10026644545314, -169.44818707060054, -189.63480691676781, -392.10982551393096, -543.3041559530807, -280.39304422076333, -418.23884886846685, -327.5137827984414, -302.9384497939911, -276.3497241601701, -251.16842789505608, -336.4443999497284, -121.41661309553513, -332.27666889844505, -162.59600134935798, -220.4483348996443, -346.11030069827706, -455.89789873450513, -378.1933158786217, -403.28933893395805, -286.9472863249284, -363.2338024568531, -315.580271171737, -339.60058853793043, -97.01764666392751, -304.7926765174314, -384.79128465913834, -154.7339413664541, -404.8251748568739, -123.17245853819199, -505.4770608868284, -30.23239385086513, -289.137165971116, -331.16627421554483, -465.95562152484007, -37.51505092734742, -316.9794854933604, -352.7267699197705, -377.4887679140828, -276.5386069814426, -81.91591964766016, -237.42426499827855, -320.4031033820832, -327.1917172131965, -160.21047659020292, -336.8069615550887, -549.0101755312994, -393.6128022112143, -127.24717543167654, -309.3628054902068, -20.521532221447927, -388.42544199935185, -438.9511376039128, -250.28587567882406, -179.89001297064513, -218.60456429960624, -484.2789021012749, -315.7910758802218, -417.531509274116, -400.1665800004486, -237.35412674138274, -317.0455762547216, -472.1712505784419, -73.24844671213107, -339.59163945508107, -207.29999142807796], "policy_predator_policy_reward": [496.05283668918344, 366.88783136251095, 426.0347237508814, 400.0235170825506, 323.24734189468904, 339.45989513976303, 607.9526662985195, 319.88018257103397, 339.4113005791827, 209.73598236850586, 359.1776416611081, 419.6102377973006, 284.7881079350371, 39.23175318317345, 298.4007894203741, 380.6610154933593, 201.27827482790016, 759.5548153305348, 108.45078529400415, 325.72589542575895, 314.8712226506786, 346.336817042693, 307.2627686944594, 466.8894571990616, 348.6093947335814, 335.1273512797891, 274.2207919614453, 279.0909184425535, 366.4966966177221, 272.0844770479687, 107.54689745082582, 346.5508282217499, 278.86669236806244, 339.05261214407864, 311.4854443661025, 377.7140026293755, 328.85132704183604, 3.557722811689344, 308.98022435840477, 359.92954575317543, 345.14822582282295, 416.2815858271963, 335.84493943339027, 239.8836932489955, 274.9370496399227, 176.81861499339274, 482.55046237834154, 409.1969022108893, 354.62008955453535, 278.67583370350286, 315.47760372203635, 13.36198816342709, 87.2886122586458, 734.9926203547088, 377.9595396047763, 246.9699742754882, 709.5570392609209, 319.84722244454883, 332.07451223620444, 324.5599559662912, 337.8499270241404, 348.2337513251202, 239.84079898241532, 371.2182803189593, 439.0346958983564, 336.43411080570206, 155.20278304497035, 530.3956828461374, 390.939855631556, 296.4903046578002, 455.440326234509, 155.04691027355048, 401.7485695827073, 266.41086711201626, 455.96243726778283, 424.67394187318047, 396.27169756004844, 449.6117683867409, 298.26229054787, 232.55581891861868, 468.72918435112905, 370.2545100179434, 517.2538191833124, 359.30478036661606, 396.5005204959381, 305.24535345574594, 304.5154921049871, 331.7908619836718, 322.18888864977777, 334.6935287454622, 405.46249762839386, 452.9131594686287, 370.68690326189477, 360.137950448514, 301.9269794924767, 310.867698185374, 372.18728213763035, 334.0802567765886, 16.699404792455862, 502.2389286246393, 465.12128562715094, 237.0279657286401, 234.24932648895123, 514.24208359616, 432.08448903027374, 56.56421597139775, 381.78656810249066, 328.584110673893, 361.93147700287557, 376.78183642114726, 18.033405782393153, 373.4859743536301, 451.9297671883974, 429.06081325734635, 227.2668258346874, 314.1207515915609, 354.4997272126975, 387.3399124698403, 230.07220010030846, 264.3575014446209, 289.103835268206, 363.6834261521105, 274.9127073285658, 504.42413505970137, 4.089621260945866, 499.29829541668613, 340.6685929990033, 311.10554252437584, 325.32902290176025, 341.2343983656188, 501.8938735641916, 409.6006963456337, 346.68317848158773, 113.63676577289866, 335.1295658449704, 242.71040457797673, 611.8115216038995, 75.41971678991196, 296.5760811645526, 530.2491321255364, 432.98666344200836, 326.8461911106012, 305.226180807645, 277.41883006544776, 267.32546092661073, 327.55728594715737, 319.1877440268182, 332.07206144926243, 323.8445487065779, 342.0510686183683, 290.53864042840945, 571.1665740997696, 361.80626633295566, 393.3925706264303, 455.538044832084, 324.14795373822403, 365.1434495312663, 301.50934828537527, 340.85796873614777, 346.3591844902331, 22.27754068843212, 410.78133070075353, 271.84397358555424, 436.3109829850367, 375.1427675639421, 467.18517621814846, 325.91531359685195, 303.5901539031896, 430.2281781498751, 265.7588518578503, 327.2842347165876, 353.2267699197705, 359.4190765739706, 291.04052279838055, 31.032538664297913, 328.49767189036817, 319.32138985312287, 334.8236217339436, 400.2613265029043, 251.21172443716685, 516.9934856976237, 411.45224783959816, 334.3927191030073, 269.9961118738831, 99.91356304120926, 387.0127618300141, 266.5333617310448, 429.9400737253767, 360.9201170364723, 236.16117663253212, 462.7618737202553, 339.048396913997, 417.7919935468065, 401.82940931501196, 296.4794867021415, 304.90516636135584, 425.6084324346463, 243.29395073339174, 531.3065423774285, 300.012814400462]}, "sampler_perf": {"mean_raw_obs_processing_ms": 77.84060499551443, "mean_inference_ms": 67.30060791280472, "mean_action_processing_ms": 25.88784026911105, "mean_env_wait_ms": 20.329697633932973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8812192678451538, "StateBufferConnector_ms": 3.1077544689178467, "ViewRequirementAgentConnector_ms": 7.582579851150513}, "num_episodes": 64, "episode_return_max": 458.71640585350247, "episode_return_min": -120.1175368491433, "episode_return_mean": 104.06919771755983, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040800, "num_agent_steps_trained": 2040800, "num_env_steps_sampled": 510200, "num_env_steps_trained": 510200, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 29.935754312503303, "num_env_steps_trained_throughput_per_sec": 29.935754312503303, "timesteps_total": 510200, "num_env_steps_sampled_lifetime": 510200, "num_agent_steps_sampled_lifetime": 2040800, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2040800, "timers": {"training_iteration_time_ms": 364835.395, "restore_workers_time_ms": 92.266, "training_step_time_ms": 364542.77, "sample_time_ms": 101944.415, "learn_time_ms": 251409.718, "learn_throughput": 35.703, "synch_weights_time_ms": 10096.695}, "counters": {"num_env_steps_sampled": 510200, "num_env_steps_trained": 510200, "num_agent_steps_sampled": 2040800, "num_agent_steps_trained": 2040800}, "done": false, "training_iteration": 63, "trial_id": "cdf01_00000", "date": "2024-08-20_12-26-24", "timestamp": 1724136984, "time_this_iter_s": 269.35646176338196, "time_total_s": 7357.1175990104675, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e46ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7357.1175990104675, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 96.66282722513088, "ram_util_percent": 83.76544502617803}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.532016556225126, "cur_kl_coeff": 5.329070518200751e-16, "cur_lr": 0.0001, "total_loss": 8.859837135436043, "policy_loss": -0.004347877532598518, "vf_loss": 8.864185012332976, "vf_explained_var": -0.3232784172845265, "kl": 0.002780017546119924, "entropy": 0.14372432065151985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 40495.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.515337509200687, "cur_kl_coeff": 1.455191522836685e-12, "cur_lr": 0.0001, "total_loss": 8.84704042162214, "policy_loss": -0.0034276128325256565, "vf_loss": 8.850468025510274, "vf_explained_var": 0.39995825962414816, "kl": 0.0033932060647174018, "entropy": 0.270951520024784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 40495.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 518200, "num_env_steps_trained": 518200, "num_agent_steps_sampled": 2072800, "num_agent_steps_trained": 2072800}, "env_runners": {"episode_reward_max": 367.5025766605869, "episode_reward_min": -120.1175368491433, "episode_reward_mean": 103.29424299068047, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -759.5548153305348, "predator_policy": 3.557722811689344}, "policy_reward_max": {"prey_policy": 194.63176301278526, "predator_policy": 759.5548153305348}, "policy_reward_mean": {"prey_policy": -283.71773164623346, "predator_policy": 335.36485314157363}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.849858435161515, 103.53599043271356, 319.5164089081017, -8.537643050785704, 264.84630457231754, -3.128826714321856, 53.49416481280096, 15.97816970607876, 37.31834445409995, 68.5442357306914, -52.71110465470959, 11.825191313809999, 267.8892048368975, 6.099999999999996, 367.3051864139067, 367.5025766605869, 182.8610503385276, 87.86717092388758, 265.34759267626015, 161.10719697650612, 32.069178490942, 162.6211027719463, 21.416284955304565, 86.26044395822618, 167.19383036133735, 61.87592300123948, 288.98385865196207, -12.39013439342268, 2.3639299331842656, 350.0872013558411, 41.50881350757342, 57.81393776311138, 9.366227868735857, 233.04123686388323, 223.43637318182954, 202.33751202426697, 167.90596208816413, 111.52244934051353, 2.933705673511035, 81.42887122093089, 9.0666748192738, 173.1599290323068, 198.64975080583136, 148.34071616710816, 246.09428164995563, 6.4151111829277125, 225.30458522386112, -120.1175368491433, 277.07006521568616, 87.15618156603, 242.08037648597806, 7.452715696217318, 6.234837794001093, 195.48277790270987, -25.480022756852176, 92.5238583964096, 19.056854850514014, 11.93265949037443, 181.81530706863242, 69.2915169068938, 105.48660596311328, 3.1280131162445635, 14.08022288570115, 3.356836918931473, 7.269919028984165, 197.56652348210147, 282.8512810759432, 59.697015095396075, -26.283817853193284, 129.5049097885249, 11.471938106973363, 285.4068300450223, -106.46635463640739, 180.15732317552462, 306.61848904439637, 9.202027313380892, 192.51635755553707, 10.804749223226843, -3.567775523174152, 40.19002590872786, 6.550190991786765, 154.45561279478065, -14.177244205291668, 167.7788500550087, 77.97935065042265, 7.236422173684824, 198.5867163987537, 1.740292652755782, 1.9233135872536056, 46.98495006739383, 123.48268587746453, 284.4277258947313, -64.3588203835935, 11.053868011979109, 19.770331080443434, 14.737910946868325, -2.1433244262895115, 133.72211554367811, 351.72444074939386, 216.13936885154052], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-172.4284163927387, -759.5548153305348, -362.0888531228251, 31.448162835776444, -345.37923839381, 3.6876076085399774, -361.16099732833663, -421.5288716159691, -27.073829077420715, -391.8166123636318, -256.2164211900301, -300.2241159282908, -374.0249435706865, -211.06206528220363, -328.8091923869847, -109.31036357951282, -225.99920470341638, -354.60175535462463, -242.6064166181225, -378.0487946466652, -270.6700820890795, -114.45007241915597, -299.75503304459454, -357.32954575317564, -161.5292273615765, -332.01137945154454, -333.04493943338963, -236.58369324899567, 193.08116718610964, -277.53164540551893, 56.33906178557097, -580.583849714216, -357.1867361108164, -93.24813680869384, -291.7559779420378, 50.78355698046218, 194.63176301278526, -751.5654029498802, -419.6651154032468, -44.15720150051101, -709.5570392609209, -287.7780439536054, -376.4729983912457, -117.54036703930342, -339.37162625387936, -325.29576714007675, -342.0574769043708, -182.74115843877837, -270.4441342527505, -337.83084208996837, -87.62810837111809, -536.0944345187513, -423.04899222344716, 24.602690586053036, -452.5877904603912, -170.28958044109172, -401.7485695827073, -264.04693717883214, -51.97042753650918, -478.57875024861346, -387.1240645389453, -417.25058790027106, -267.7241623502151, -205.28000935316237, -460.2741300818362, -369.3433364185007, -461.0903206483599, -182.4270420376853, -305.2891738062812, -173.02032696357497, -131.92567686071115, -302.04316520368155, -359.2970850041819, -129.6793703028942, -357.3348780811583, -389.5183296753506, -383.7911426378062, -344.10000539909174, -173.86998744996185, -357.4958190069568, -359.0783176589432, -338.122546436002, 156.46052423985094, -502.2389286246393, -506.568639679788, 3.069139129828045, -616.2421729330881, 16.091479015082374, -426.5844890302737, 184.03006567855766, -378.9315977427653, -325.0239698506906, -413.1033748808639, -100.30535331929774, -352.8180295580752, -158.81888742709148, -132.1203299134058, -471.8001853166528, -451.02744474856235, -3.203951111656103, -133.26067324629886, -366.4985899502594, -225.5194844040914, -261.4575014446211, -293.97186228828036, -352.5805613380349, -478.5402054820406, -105.31385900351614, -142.49431918462935, -386.3736202498546, -337.8797802386582, -221.37049688831215, -314.39267577551703, -333.1138906413482, -416.63568565711546, -482.9262247623358, -55.64621983865206, -222.858417347201, -339.10026644545314, -169.44818707060054, -189.63480691676781, -392.10982551393096, -543.3041559530807, -280.39304422076333, -418.23884886846685, -327.5137827984414, -302.9384497939911, -276.3497241601701, -251.16842789505608, -336.4443999497284, -121.41661309553513, -332.27666889844505, -162.59600134935798, -220.4483348996443, -346.11030069827706, -455.89789873450513, -378.1933158786217, -403.28933893395805, -286.9472863249284, -363.2338024568531, -315.580271171737, -339.60058853793043, -97.01764666392751, -304.7926765174314, -384.79128465913834, -154.7339413664541, -404.8251748568739, -123.17245853819199, -505.4770608868284, -30.23239385086513, -289.137165971116, -331.16627421554483, -465.95562152484007, -37.51505092734742, -316.9794854933604, -352.7267699197705, -377.4887679140828, -276.5386069814426, -81.91591964766016, -237.42426499827855, -320.4031033820832, -327.1917172131965, -160.21047659020292, -336.8069615550887, -549.0101755312994, -393.6128022112143, -127.24717543167654, -309.3628054902068, -20.521532221447927, -388.42544199935185, -438.9511376039128, -250.28587567882406, -179.89001297064513, -218.60456429960624, -484.2789021012749, -315.7910758802218, -417.531509274116, -400.1665800004486, -237.35412674138274, -317.0455762547216, -472.1712505784419, -73.24844671213107, -339.59163945508107, -207.29999142807796, -297.5845679796263, -292.8879810940953, -348.82503050161125, -265.3543785223055, -309.9064036945076, -321.56520814163383, -83.9438313980242, -361.4442068393873, -262.28903258710653, -311.5960783488832, -201.92171647296055, -350.8519522476586, -112.15939251052691, -572.7322634945187, -88.14998449497787, -344.644843371635], "policy_predator_policy_reward": [201.27827482790016, 759.5548153305348, 108.45078529400415, 325.72589542575895, 314.8712226506786, 346.336817042693, 307.2627686944594, 466.8894571990616, 348.6093947335814, 335.1273512797891, 274.2207919614453, 279.0909184425535, 366.4966966177221, 272.0844770479687, 107.54689745082582, 346.5508282217499, 278.86669236806244, 339.05261214407864, 311.4854443661025, 377.7140026293755, 328.85132704183604, 3.557722811689344, 308.98022435840477, 359.92954575317543, 345.14822582282295, 416.2815858271963, 335.84493943339027, 239.8836932489955, 274.9370496399227, 176.81861499339274, 482.55046237834154, 409.1969022108893, 354.62008955453535, 278.67583370350286, 315.47760372203635, 13.36198816342709, 87.2886122586458, 734.9926203547088, 377.9595396047763, 246.9699742754882, 709.5570392609209, 319.84722244454883, 332.07451223620444, 324.5599559662912, 337.8499270241404, 348.2337513251202, 239.84079898241532, 371.2182803189593, 439.0346958983564, 336.43411080570206, 155.20278304497035, 530.3956828461374, 390.939855631556, 296.4903046578002, 455.440326234509, 155.04691027355048, 401.7485695827073, 266.41086711201626, 455.96243726778283, 424.67394187318047, 396.27169756004844, 449.6117683867409, 298.26229054787, 232.55581891861868, 468.72918435112905, 370.2545100179434, 517.2538191833124, 359.30478036661606, 396.5005204959381, 305.24535345574594, 304.5154921049871, 331.7908619836718, 322.18888864977777, 334.6935287454622, 405.46249762839386, 452.9131594686287, 370.68690326189477, 360.137950448514, 301.9269794924767, 310.867698185374, 372.18728213763035, 334.0802567765886, 16.699404792455862, 502.2389286246393, 465.12128562715094, 237.0279657286401, 234.24932648895123, 514.24208359616, 432.08448903027374, 56.56421597139775, 381.78656810249066, 328.584110673893, 361.93147700287557, 376.78183642114726, 18.033405782393153, 373.4859743536301, 451.9297671883974, 429.06081325734635, 227.2668258346874, 314.1207515915609, 354.4997272126975, 387.3399124698403, 230.07220010030846, 264.3575014446209, 289.103835268206, 363.6834261521105, 274.9127073285658, 504.42413505970137, 4.089621260945866, 499.29829541668613, 340.6685929990033, 311.10554252437584, 325.32902290176025, 341.2343983656188, 501.8938735641916, 409.6006963456337, 346.68317848158773, 113.63676577289866, 335.1295658449704, 242.71040457797673, 611.8115216038995, 75.41971678991196, 296.5760811645526, 530.2491321255364, 432.98666344200836, 326.8461911106012, 305.226180807645, 277.41883006544776, 267.32546092661073, 327.55728594715737, 319.1877440268182, 332.07206144926243, 323.8445487065779, 342.0510686183683, 290.53864042840945, 571.1665740997696, 361.80626633295566, 393.3925706264303, 455.538044832084, 324.14795373822403, 365.1434495312663, 301.50934828537527, 340.85796873614777, 346.3591844902331, 22.27754068843212, 410.78133070075353, 271.84397358555424, 436.3109829850367, 375.1427675639421, 467.18517621814846, 325.91531359685195, 303.5901539031896, 430.2281781498751, 265.7588518578503, 327.2842347165876, 353.2267699197705, 359.4190765739706, 291.04052279838055, 31.032538664297913, 328.49767189036817, 319.32138985312287, 334.8236217339436, 400.2613265029043, 251.21172443716685, 516.9934856976237, 411.45224783959816, 334.3927191030073, 269.9961118738831, 99.91356304120926, 387.0127618300141, 266.5333617310448, 429.9400737253767, 360.9201170364723, 236.16117663253212, 462.7618737202553, 339.048396913997, 417.7919935468065, 401.82940931501196, 296.4794867021415, 304.90516636135584, 425.6084324346463, 243.29395073339174, 531.3065423774285, 300.012814400462, 230.07348563078378, 296.04024305934496, 357.0874507298905, 268.14582630600523, 306.3611513662469, 344.8807915503373, 84.60965761579014, 375.51629156848986, 253.62649247815264, 318.11529403154714, 311.9611634037554, 374.534620860543, 627.6039713632275, 409.0121253912111, 322.8534958587993, 326.08070085935344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 77.66669052403171, "mean_inference_ms": 67.53711822769094, "mean_action_processing_ms": 25.833040259698404, "mean_env_wait_ms": 20.332833466931586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.8001278638839722, "StateBufferConnector_ms": 3.069391131401062, "ViewRequirementAgentConnector_ms": 8.379494428634644}, "num_episodes": 8, "episode_return_max": 367.5025766605869, "episode_return_min": -120.1175368491433, "episode_return_mean": 103.29424299068047, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2072800, "num_agent_steps_trained": 2072800, "num_env_steps_sampled": 518200, "num_env_steps_trained": 518200, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 24.921965205957527, "num_env_steps_trained_throughput_per_sec": 24.921965205957527, "timesteps_total": 518200, "num_env_steps_sampled_lifetime": 518200, "num_agent_steps_sampled_lifetime": 2072800, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2072800, "timers": {"training_iteration_time_ms": 364970.29, "restore_workers_time_ms": 91.055, "training_step_time_ms": 364677.919, "sample_time_ms": 103070.39, "learn_time_ms": 250581.491, "learn_throughput": 35.821, "synch_weights_time_ms": 9939.984}, "counters": {"num_env_steps_sampled": 518200, "num_env_steps_trained": 518200, "num_agent_steps_sampled": 2072800, "num_agent_steps_trained": 2072800}, "done": false, "training_iteration": 64, "trial_id": "cdf01_00000", "date": "2024-08-20_12-31-49", "timestamp": 1724137309, "time_this_iter_s": 322.3007547855377, "time_total_s": 7679.418353796005, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e3d430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7679.418353796005, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 95.94013605442179, "ram_util_percent": 83.60476190476192}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.309548527664608, "cur_kl_coeff": 2.6645352591003756e-16, "cur_lr": 0.0001, "total_loss": Infinity, "policy_loss": -0.004183239001218998, "vf_loss": 8.638181712135436, "vf_explained_var": -0.11038278776501852, "kl": Infinity, "entropy": 0.16997027837094805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 41125.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.564122883100358, "cur_kl_coeff": 7.275957614183425e-13, "cur_lr": 0.0001, "total_loss": 8.326247803370158, "policy_loss": -0.003600298286238242, "vf_loss": 8.32984812751649, "vf_explained_var": 0.462478251400448, "kl": 0.003101431197323802, "entropy": 0.3051348508586959, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 41125.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 526200, "num_env_steps_trained": 526200, "num_agent_steps_sampled": 2104800, "num_agent_steps_trained": 2104800}, "env_runners": {"episode_reward_max": 576.4364856113083, "episode_reward_min": -106.46635463640739, "episode_reward_mean": 100.22303223628484, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -913.4017173101851, "predator_policy": 2.536007103786137}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 908.4635203805618}, "policy_reward_mean": {"prey_policy": -303.6410814658395, "predator_policy": 353.75259758398187}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.269919028984165, 197.56652348210147, 282.8512810759432, 59.697015095396075, -26.283817853193284, 129.5049097885249, 11.471938106973363, 285.4068300450223, -106.46635463640739, 180.15732317552462, 306.61848904439637, 9.202027313380892, 192.51635755553707, 10.804749223226843, -3.567775523174152, 40.19002590872786, 6.550190991786765, 154.45561279478065, -14.177244205291668, 167.7788500550087, 77.97935065042265, 7.236422173684824, 198.5867163987537, 1.740292652755782, 1.9233135872536056, 46.98495006739383, 123.48268587746453, 284.4277258947313, -64.3588203835935, 11.053868011979109, 19.770331080443434, 14.737910946868325, -2.1433244262895115, 133.72211554367811, 351.72444074939386, 216.13936885154052, 132.34503465268173, 181.4162255418122, -0.26286374444474103, 134.79838517598228, 451.26664358889724, 277.48538369812957, 34.80261299907847, 148.799973745422, 104.72059697828885, 140.53976578481218, 50.936409841308205, 13.266363091578892, 4.149710482073122, -76.16676155762158, 32.17336831034675, 119.23150611002654, 37.439072901321715, -30.113395068910258, 47.7896765773085, 0.9245513608863427, 0.9175362729233609, -15.755237680183651, -6.573207920754065, 108.39429716086161, 79.21062474214976, 50.83918061379262, 253.97636303860583, 142.9091796489708, 0.09999999999999853, 51.49816195091865, 393.731305988361, 84.30371140269922, 122.98556198205458, -0.14463304233516938, 376.56607374387454, 1.1762461307343068, 77.37653544735281, 5.599999999999996, 16.49288972054106, 113.17344147439071, 248.08663884020783, 0.1685634287836284, 83.73344266665072, 121.8712949497625, 199.62676125897835, 330.81515800309904, 226.292603756861, 576.4364856113083, 202.53600710378618, -5.515148469079243, 3.027204150989754, 95.44337546335267, -4.440892098500626e-16, 10.348591159392765, 213.71447845771152, 111.3552657144232, 195.72775889167286, -95.25371188197799, 101.20323817416855, 189.98981738462803, -17.967781675961376, 254.6298400466269, -3.0091810933544894, 2.1680323987864716], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-251.16842789505608, -336.4443999497284, -121.41661309553513, -332.27666889844505, -162.59600134935798, -220.4483348996443, -346.11030069827706, -455.89789873450513, -378.1933158786217, -403.28933893395805, -286.9472863249284, -363.2338024568531, -315.580271171737, -339.60058853793043, -97.01764666392751, -304.7926765174314, -384.79128465913834, -154.7339413664541, -404.8251748568739, -123.17245853819199, -505.4770608868284, -30.23239385086513, -289.137165971116, -331.16627421554483, -465.95562152484007, -37.51505092734742, -316.9794854933604, -352.7267699197705, -377.4887679140828, -276.5386069814426, -81.91591964766016, -237.42426499827855, -320.4031033820832, -327.1917172131965, -160.21047659020292, -336.8069615550887, -549.0101755312994, -393.6128022112143, -127.24717543167654, -309.3628054902068, -20.521532221447927, -388.42544199935185, -438.9511376039128, -250.28587567882406, -179.89001297064513, -218.60456429960624, -484.2789021012749, -315.7910758802218, -417.531509274116, -400.1665800004486, -237.35412674138274, -317.0455762547216, -472.1712505784419, -73.24844671213107, -339.59163945508107, -207.29999142807796, -297.5845679796263, -292.8879810940953, -348.82503050161125, -265.3543785223055, -309.9064036945076, -321.56520814163383, -83.9438313980242, -361.4442068393873, -262.28903258710653, -311.5960783488832, -201.92171647296055, -350.8519522476586, -112.15939251052691, -572.7322634945187, -88.14998449497787, -344.644843371635, -31.604712596772423, -452.580234765603, -46.908649809945075, -289.7737736746848, -439.4503020486518, -402.53800068894395, -347.237524400739, -169.5932373727401, -696.3564937395668, -16.1585495780329, -363.26493478477875, -44.9687541171748, -513.0565390427986, -300.5595528520116, -333.68274197186247, -177.24695994061068, -358.4803615088722, -479.65037606243493, -212.92231022274598, -209.18864058987037, -273.97643644892366, -250.08390221213415, -316.0499180483336, -441.55335053640465, -290.74280379830907, -430.35322202014123, -648.1740295015891, -511.3986075034562, -405.5077427824694, -0.18200264786110484, -217.07318134323052, -564.4269933184519, -295.70106294845243, -400.92380990487936, -211.48509898512646, -407.8282251359449, -302.8950835429609, -315.1287165084956, -550.7531772632007, -321.0206639047609, -380.5287561304923, -539.2097339111152, -327.50654077643657, -328.29550586407794, -299.20426864103985, -263.37578894748026, -119.96348340655213, -485.71195267845263, -401.8910264287854, -213.0770350701508, -348.2381045231855, -271.67800875194945, -36.6328448665188, -416.05552551285655, -594.8658680705612, -78.76293327016195, -343.43294468750224, -333.8129548182166, -416.61217415179607, -541.9851813627689, 184.21098813799415, -590.5354852103432, -391.523429416502, -307.2819622539129, -352.85176869717753, -158.91563147506756, -320.4827005966197, -89.5379307718704, -421.85089635112536, 68.10676756608612, -428.3170468196587, -388.26904800375144, -8.818579455860245, -409.1223264256138, -277.64347581932674, -310.49545248051027, -300.55246383284646, -417.0556698840931, -303.06084856084556, -420.1253364509289, -666.2307247729295, -37.52525892024023, -567.518218469114, -375.67483138384017, -446.9795940204784, -368.4572314690241, -138.02333195865663, -345.14484880961123, -243.8318840902105, -363.8915288439304, 198.2009175667743, -913.4017173101851, -457.3216602743181, -120.2222587422088, -632.9473937616403, 15.948349570550409, 200.0, -483.2861360909586, -318.81816295856, -266.5620554126567, -429.1429068665613, -358.25923668610733, -137.12843628674437, -301.7257961965122, -439.121425093118, -352.5636510179128, -392.3200595399889, -532.7386432874827, -319.2884573641697, 198.24536690092245, -155.23433511354176, -486.36712006210195, -317.5892686700898, 171.88474216058307, -322.5634959886181, -428.54493703920656, -287.3257982691668, -316.82415750769513, 89.43218671681964, -383.2924759775135, -325.59709357557495, -179.024138808967, -319.0337286029124, -18.69402110999145, -291.9414710557589, -621.8929783073582, -294.975814837292, -523.5043986727085], "policy_predator_policy_reward": [267.32546092661073, 327.55728594715737, 319.1877440268182, 332.07206144926243, 323.8445487065779, 342.0510686183683, 290.53864042840945, 571.1665740997696, 361.80626633295566, 393.3925706264303, 455.538044832084, 324.14795373822403, 365.1434495312663, 301.50934828537527, 340.85796873614777, 346.3591844902331, 22.27754068843212, 410.78133070075353, 271.84397358555424, 436.3109829850367, 375.1427675639421, 467.18517621814846, 325.91531359685195, 303.5901539031896, 430.2281781498751, 265.7588518578503, 327.2842347165876, 353.2267699197705, 359.4190765739706, 291.04052279838055, 31.032538664297913, 328.49767189036817, 319.32138985312287, 334.8236217339436, 400.2613265029043, 251.21172443716685, 516.9934856976237, 411.45224783959816, 334.3927191030073, 269.9961118738831, 99.91356304120926, 387.0127618300141, 266.5333617310448, 429.9400737253767, 360.9201170364723, 236.16117663253212, 462.7618737202553, 339.048396913997, 417.7919935468065, 401.82940931501196, 296.4794867021415, 304.90516636135584, 425.6084324346463, 243.29395073339174, 531.3065423774285, 300.012814400462, 230.07348563078378, 296.04024305934496, 357.0874507298905, 268.14582630600523, 306.3611513662469, 344.8807915503373, 84.60965761579014, 375.51629156848986, 253.62649247815264, 318.11529403154714, 311.9611634037554, 374.534620860543, 627.6039713632275, 409.0121253912111, 322.8534958587993, 326.08070085935344, 415.71255417358077, 200.8174278414774, 273.7352017390278, 244.36344728741466, 439.1799549923478, 402.54548400080324, 327.7860899928768, 323.84305695658435, 682.5610003684518, 481.2206865380432, 319.02181557454844, 366.69725702553626, 459.19203296287367, 389.22667193101455, 323.08324852528796, 336.64642713260696, 356.66486012171725, 586.1864744278794, 301.246685724962, 261.40403087246733, 325.4075482816164, 249.58920022074844, 334.8074177235199, 436.06221395279726, 294.20509466922977, 431.0406416312935, 648.3145554755026, 435.09131997192, 405.4117126893603, 32.451401051316736, 416.7287850944402, 484.0028956772676, 334.20789693727477, 399.8560488173792, 469.3413877394505, 119.85854131270968, 360.9051679802662, 304.9083086484988, 551.3531772632008, 321.3452152656473, 381.4462924034156, 539.2097339111152, 337.14531029780136, 302.90149866253, 241.41019100794966, 314.5966586598163, 464.49306997875715, 249.57666326710947, 371.3133859871856, 322.8653002539005, 284.42598679762455, 386.32930709130386, 354.4564194067178, 352.2083140112639, 381.35189199758645, 435.1860889921064, 343.43294468750224, 333.91295481821663, 437.3743440159065, 572.7211734495775, 537.9648661942763, 262.090936866434, 372.4494759307203, 410.65962714239436, 321.51903774145876, 313.2339244128411, 338.12729475463885, 71.74870357151616, 336.19732116977974, 394.1128813591329, 428.4170468196587, 389.34529413448575, 364.63771607716217, 130.6797252516656, 282.84347581932656, 310.89545248051036, 326.1135399998028, 407.9874834376779, 419.53470762909944, 416.8249188570669, 438.87008782954143, 512.9725347038352, 567.518218469114, 375.84339481262384, 416.04991650947784, 483.12035164667583, 331.9504240090859, 273.0890517089443, 388.69231378597027, 418.65786040715096, 137.55243736594787, 908.4635203805618, 365.6960298709915, 438.1404929023962, 627.7344404397892, 565.7010893626067, 2.536007103786137, 483.2861360909586, 303.0687873657296, 276.7962825364084, 432.17011101755094, 358.25923668610733, 280.12576607447716, 254.1718418721328, 439.121425093118, 352.5636510179128, 619.2566190931325, 316.1506748937319, 324.88845736416937, 9.869111556789306, 237.34751772390374, 515.6092031661632, 318.7892686700897, 22.643016731089848, 163.5283448199503, 492.3263763258967, 358.02740237776794, 347.32579157326296, 373.368991922071, 110.48111472325101, 339.89739861633154, 146.75605209224835, 272.18097919185544, 320.1766105676763, 288.9322899624044, 621.8929783073582, 297.14384723607833, 523.5043986727085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 78.79102981699565, "mean_inference_ms": 68.37679651262746, "mean_action_processing_ms": 25.7436663755853, "mean_env_wait_ms": 20.834977002441814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5680885314941406, "StateBufferConnector_ms": 2.133136749267578, "ViewRequirementAgentConnector_ms": 7.800090551376343}, "num_episodes": 64, "episode_return_max": 576.4364856113083, "episode_return_min": -106.46635463640739, "episode_return_mean": 100.22303223628484, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2104800, "num_agent_steps_trained": 2104800, "num_env_steps_sampled": 526200, "num_env_steps_trained": 526200, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 28.427212654153944, "num_env_steps_trained_throughput_per_sec": 28.427212654153944, "timesteps_total": 526200, "num_env_steps_sampled_lifetime": 526200, "num_agent_steps_sampled_lifetime": 2104800, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2104800, "timers": {"training_iteration_time_ms": 370742.25, "restore_workers_time_ms": 94.859, "training_step_time_ms": 370444.24, "sample_time_ms": 103025.378, "learn_time_ms": 256124.449, "learn_throughput": 35.045, "synch_weights_time_ms": 10222.019}, "counters": {"num_env_steps_sampled": 526200, "num_env_steps_trained": 526200, "num_agent_steps_sampled": 2104800, "num_agent_steps_trained": 2104800}, "done": false, "training_iteration": 65, "trial_id": "cdf01_00000", "date": "2024-08-20_12-36-36", "timestamp": 1724137596, "time_this_iter_s": 284.1833679676056, "time_total_s": 7963.601721763611, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e3dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7963.601721763611, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 95.51237113402063, "ram_util_percent": 83.63118556701032}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.7302696178829855, "cur_kl_coeff": 3.996802888650564e-16, "cur_lr": 0.0001, "total_loss": 8.849680149744428, "policy_loss": -0.0036394205240030137, "vf_loss": 8.853319573780848, "vf_explained_var": -0.15970507141143556, "kl": 0.0021337801641946627, "entropy": 0.15969104234661374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 41755.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.078481355356792, "cur_kl_coeff": 3.6379788070917126e-13, "cur_lr": 0.0001, "total_loss": 8.777432880704366, "policy_loss": -0.0033621886172257955, "vf_loss": 8.780795089782231, "vf_explained_var": 0.44034585186413355, "kl": 0.002860704402135323, "entropy": 0.3088413840011945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 41755.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 534200, "num_env_steps_trained": 534200, "num_agent_steps_sampled": 2136800, "num_agent_steps_trained": 2136800}, "env_runners": {"episode_reward_max": 576.4364856113083, "episode_reward_min": -106.46635463640739, "episode_reward_mean": 105.14184530938675, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -913.4017173101851, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 908.4635203805618}, "policy_reward_mean": {"prey_policy": -301.76466270071217, "predator_policy": 354.33558535540556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-106.46635463640739, 180.15732317552462, 306.61848904439637, 9.202027313380892, 192.51635755553707, 10.804749223226843, -3.567775523174152, 40.19002590872786, 6.550190991786765, 154.45561279478065, -14.177244205291668, 167.7788500550087, 77.97935065042265, 7.236422173684824, 198.5867163987537, 1.740292652755782, 1.9233135872536056, 46.98495006739383, 123.48268587746453, 284.4277258947313, -64.3588203835935, 11.053868011979109, 19.770331080443434, 14.737910946868325, -2.1433244262895115, 133.72211554367811, 351.72444074939386, 216.13936885154052, 132.34503465268173, 181.4162255418122, -0.26286374444474103, 134.79838517598228, 451.26664358889724, 277.48538369812957, 34.80261299907847, 148.799973745422, 104.72059697828885, 140.53976578481218, 50.936409841308205, 13.266363091578892, 4.149710482073122, -76.16676155762158, 32.17336831034675, 119.23150611002654, 37.439072901321715, -30.113395068910258, 47.7896765773085, 0.9245513608863427, 0.9175362729233609, -15.755237680183651, -6.573207920754065, 108.39429716086161, 79.21062474214976, 50.83918061379262, 253.97636303860583, 142.9091796489708, 0.09999999999999853, 51.49816195091865, 393.731305988361, 84.30371140269922, 122.98556198205458, -0.14463304233516938, 376.56607374387454, 1.1762461307343068, 77.37653544735281, 5.599999999999996, 16.49288972054106, 113.17344147439071, 248.08663884020783, 0.1685634287836284, 83.73344266665072, 121.8712949497625, 199.62676125897835, 330.81515800309904, 226.292603756861, 576.4364856113083, 202.53600710378618, -5.515148469079243, 3.027204150989754, 95.44337546335267, -4.440892098500626e-16, 10.348591159392765, 213.71447845771152, 111.3552657144232, 195.72775889167286, -95.25371188197799, 101.20323817416855, 189.98981738462803, -17.967781675961376, 254.6298400466269, -3.0091810933544894, 2.1680323987864716, 275.8802180082255, 150.30490204222073, 195.9064525144146, 198.29821670739233, 200.45621426342495, 249.11201120141283, 50.12963665287468, 119.27825468997818], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-384.79128465913834, -154.7339413664541, -404.8251748568739, -123.17245853819199, -505.4770608868284, -30.23239385086513, -289.137165971116, -331.16627421554483, -465.95562152484007, -37.51505092734742, -316.9794854933604, -352.7267699197705, -377.4887679140828, -276.5386069814426, -81.91591964766016, -237.42426499827855, -320.4031033820832, -327.1917172131965, -160.21047659020292, -336.8069615550887, -549.0101755312994, -393.6128022112143, -127.24717543167654, -309.3628054902068, -20.521532221447927, -388.42544199935185, -438.9511376039128, -250.28587567882406, -179.89001297064513, -218.60456429960624, -484.2789021012749, -315.7910758802218, -417.531509274116, -400.1665800004486, -237.35412674138274, -317.0455762547216, -472.1712505784419, -73.24844671213107, -339.59163945508107, -207.29999142807796, -297.5845679796263, -292.8879810940953, -348.82503050161125, -265.3543785223055, -309.9064036945076, -321.56520814163383, -83.9438313980242, -361.4442068393873, -262.28903258710653, -311.5960783488832, -201.92171647296055, -350.8519522476586, -112.15939251052691, -572.7322634945187, -88.14998449497787, -344.644843371635, -31.604712596772423, -452.580234765603, -46.908649809945075, -289.7737736746848, -439.4503020486518, -402.53800068894395, -347.237524400739, -169.5932373727401, -696.3564937395668, -16.1585495780329, -363.26493478477875, -44.9687541171748, -513.0565390427986, -300.5595528520116, -333.68274197186247, -177.24695994061068, -358.4803615088722, -479.65037606243493, -212.92231022274598, -209.18864058987037, -273.97643644892366, -250.08390221213415, -316.0499180483336, -441.55335053640465, -290.74280379830907, -430.35322202014123, -648.1740295015891, -511.3986075034562, -405.5077427824694, -0.18200264786110484, -217.07318134323052, -564.4269933184519, -295.70106294845243, -400.92380990487936, -211.48509898512646, -407.8282251359449, -302.8950835429609, -315.1287165084956, -550.7531772632007, -321.0206639047609, -380.5287561304923, -539.2097339111152, -327.50654077643657, -328.29550586407794, -299.20426864103985, -263.37578894748026, -119.96348340655213, -485.71195267845263, -401.8910264287854, -213.0770350701508, -348.2381045231855, -271.67800875194945, -36.6328448665188, -416.05552551285655, -594.8658680705612, -78.76293327016195, -343.43294468750224, -333.8129548182166, -416.61217415179607, -541.9851813627689, 184.21098813799415, -590.5354852103432, -391.523429416502, -307.2819622539129, -352.85176869717753, -158.91563147506756, -320.4827005966197, -89.5379307718704, -421.85089635112536, 68.10676756608612, -428.3170468196587, -388.26904800375144, -8.818579455860245, -409.1223264256138, -277.64347581932674, -310.49545248051027, -300.55246383284646, -417.0556698840931, -303.06084856084556, -420.1253364509289, -666.2307247729295, -37.52525892024023, -567.518218469114, -375.67483138384017, -446.9795940204784, -368.4572314690241, -138.02333195865663, -345.14484880961123, -243.8318840902105, -363.8915288439304, 198.2009175667743, -913.4017173101851, -457.3216602743181, -120.2222587422088, -632.9473937616403, 15.948349570550409, 200.0, -483.2861360909586, -318.81816295856, -266.5620554126567, -429.1429068665613, -358.25923668610733, -137.12843628674437, -301.7257961965122, -439.121425093118, -352.5636510179128, -392.3200595399889, -532.7386432874827, -319.2884573641697, 198.24536690092245, -155.23433511354176, -486.36712006210195, -317.5892686700898, 171.88474216058307, -322.5634959886181, -428.54493703920656, -287.3257982691668, -316.82415750769513, 89.43218671681964, -383.2924759775135, -325.59709357557495, -179.024138808967, -319.0337286029124, -18.69402110999145, -291.9414710557589, -621.8929783073582, -294.975814837292, -523.5043986727085, -600.573083971678, -95.01091839688773, -562.0704759393262, -176.3977225673629, -362.66804233819767, 195.9064525144146, -123.38963986110456, -359.79683921820424, -460.7452647752416, 191.89999999999995, -536.8305664797003, 20.000000000000014, -409.9096977878531, -430.58186257766465, -276.4456353764479, -353.11652220521916], "policy_predator_policy_reward": [22.27754068843212, 410.78133070075353, 271.84397358555424, 436.3109829850367, 375.1427675639421, 467.18517621814846, 325.91531359685195, 303.5901539031896, 430.2281781498751, 265.7588518578503, 327.2842347165876, 353.2267699197705, 359.4190765739706, 291.04052279838055, 31.032538664297913, 328.49767189036817, 319.32138985312287, 334.8236217339436, 400.2613265029043, 251.21172443716685, 516.9934856976237, 411.45224783959816, 334.3927191030073, 269.9961118738831, 99.91356304120926, 387.0127618300141, 266.5333617310448, 429.9400737253767, 360.9201170364723, 236.16117663253212, 462.7618737202553, 339.048396913997, 417.7919935468065, 401.82940931501196, 296.4794867021415, 304.90516636135584, 425.6084324346463, 243.29395073339174, 531.3065423774285, 300.012814400462, 230.07348563078378, 296.04024305934496, 357.0874507298905, 268.14582630600523, 306.3611513662469, 344.8807915503373, 84.60965761579014, 375.51629156848986, 253.62649247815264, 318.11529403154714, 311.9611634037554, 374.534620860543, 627.6039713632275, 409.0121253912111, 322.8534958587993, 326.08070085935344, 415.71255417358077, 200.8174278414774, 273.7352017390278, 244.36344728741466, 439.1799549923478, 402.54548400080324, 327.7860899928768, 323.84305695658435, 682.5610003684518, 481.2206865380432, 319.02181557454844, 366.69725702553626, 459.19203296287367, 389.22667193101455, 323.08324852528796, 336.64642713260696, 356.66486012171725, 586.1864744278794, 301.246685724962, 261.40403087246733, 325.4075482816164, 249.58920022074844, 334.8074177235199, 436.06221395279726, 294.20509466922977, 431.0406416312935, 648.3145554755026, 435.09131997192, 405.4117126893603, 32.451401051316736, 416.7287850944402, 484.0028956772676, 334.20789693727477, 399.8560488173792, 469.3413877394505, 119.85854131270968, 360.9051679802662, 304.9083086484988, 551.3531772632008, 321.3452152656473, 381.4462924034156, 539.2097339111152, 337.14531029780136, 302.90149866253, 241.41019100794966, 314.5966586598163, 464.49306997875715, 249.57666326710947, 371.3133859871856, 322.8653002539005, 284.42598679762455, 386.32930709130386, 354.4564194067178, 352.2083140112639, 381.35189199758645, 435.1860889921064, 343.43294468750224, 333.91295481821663, 437.3743440159065, 572.7211734495775, 537.9648661942763, 262.090936866434, 372.4494759307203, 410.65962714239436, 321.51903774145876, 313.2339244128411, 338.12729475463885, 71.74870357151616, 336.19732116977974, 394.1128813591329, 428.4170468196587, 389.34529413448575, 364.63771607716217, 130.6797252516656, 282.84347581932656, 310.89545248051036, 326.1135399998028, 407.9874834376779, 419.53470762909944, 416.8249188570669, 438.87008782954143, 512.9725347038352, 567.518218469114, 375.84339481262384, 416.04991650947784, 483.12035164667583, 331.9504240090859, 273.0890517089443, 388.69231378597027, 418.65786040715096, 137.55243736594787, 908.4635203805618, 365.6960298709915, 438.1404929023962, 627.7344404397892, 565.7010893626067, 2.536007103786137, 483.2861360909586, 303.0687873657296, 276.7962825364084, 432.17011101755094, 358.25923668610733, 280.12576607447716, 254.1718418721328, 439.121425093118, 352.5636510179128, 619.2566190931325, 316.1506748937319, 324.88845736416937, 9.869111556789306, 237.34751772390374, 515.6092031661632, 318.7892686700897, 22.643016731089848, 163.5283448199503, 492.3263763258967, 358.02740237776794, 347.32579157326296, 373.368991922071, 110.48111472325101, 339.89739861633154, 146.75605209224835, 272.18097919185544, 320.1766105676763, 288.9322899624044, 621.8929783073582, 297.14384723607833, 523.5043986727085, 463.43072370199377, 508.033496674796, 328.5308193723712, 560.2422811765384, 362.66804233819767, 0.0, 324.0549068108175, 357.429788975884, 460.7452647752416, 8.556214263425018, 432.73100436044956, 333.21157332066514, 448.641454499622, 441.97974251877037, 401.90112448749846, 346.93928778414823]}, "sampler_perf": {"mean_raw_obs_processing_ms": 79.09805012808664, "mean_inference_ms": 68.82652480842623, "mean_action_processing_ms": 25.723707856249533, "mean_env_wait_ms": 20.86111740498414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5571184158325195, "StateBufferConnector_ms": 1.8909296989440918, "ViewRequirementAgentConnector_ms": 7.336373329162598}, "num_episodes": 8, "episode_return_max": 576.4364856113083, "episode_return_min": -106.46635463640739, "episode_return_mean": 105.14184530938675, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2136800, "num_agent_steps_trained": 2136800, "num_env_steps_sampled": 534200, "num_env_steps_trained": 534200, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 33.9990899134107, "num_env_steps_trained_throughput_per_sec": 33.9990899134107, "timesteps_total": 534200, "num_env_steps_sampled_lifetime": 534200, "num_agent_steps_sampled_lifetime": 2136800, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2136800, "timers": {"training_iteration_time_ms": 329854.409, "restore_workers_time_ms": 93.778, "training_step_time_ms": 329558.322, "sample_time_ms": 91435.457, "learn_time_ms": 226806.996, "learn_throughput": 36.835, "synch_weights_time_ms": 10242.875}, "counters": {"num_env_steps_sampled": 534200, "num_env_steps_trained": 534200, "num_agent_steps_sampled": 2136800, "num_agent_steps_trained": 2136800}, "done": false, "training_iteration": 66, "trial_id": "cdf01_00000", "date": "2024-08-20_12-40-35", "timestamp": 1724137835, "time_this_iter_s": 237.0098021030426, "time_total_s": 8200.611523866653, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a53264c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8200.611523866653, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 96.18328267477204, "ram_util_percent": 83.58206686930092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.398194740499768, "cur_kl_coeff": 1.998401444325282e-16, "cur_lr": 0.0001, "total_loss": 8.816460441407703, "policy_loss": -0.004045050223875377, "vf_loss": 8.820505497947572, "vf_explained_var": -0.2208070801364051, "kl": 0.0027230805122184978, "entropy": 0.15738789676910356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 42385.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.843905027707418, "cur_kl_coeff": 1.8189894035458563e-13, "cur_lr": 0.0001, "total_loss": 8.364070123339456, "policy_loss": -0.003558597188915998, "vf_loss": 8.367628703798566, "vf_explained_var": 0.4286589980125427, "kl": 0.003630238560922335, "entropy": 0.3034305552168498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 42385.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 542200, "num_env_steps_trained": 542200, "num_agent_steps_sampled": 2168800, "num_agent_steps_trained": 2168800}, "env_runners": {"episode_reward_max": 576.4364856113083, "episode_reward_min": -95.25371188197799, "episode_reward_mean": 104.9693583812967, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -913.4017173101851, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 908.4635203805618}, "policy_reward_mean": {"prey_policy": -299.375212509093, "predator_policy": 351.8598916997414}, "custom_metrics": {}, "hist_stats": {"episode_reward": [77.37653544735281, 5.599999999999996, 16.49288972054106, 113.17344147439071, 248.08663884020783, 0.1685634287836284, 83.73344266665072, 121.8712949497625, 199.62676125897835, 330.81515800309904, 226.292603756861, 576.4364856113083, 202.53600710378618, -5.515148469079243, 3.027204150989754, 95.44337546335267, -4.440892098500626e-16, 10.348591159392765, 213.71447845771152, 111.3552657144232, 195.72775889167286, -95.25371188197799, 101.20323817416855, 189.98981738462803, -17.967781675961376, 254.6298400466269, -3.0091810933544894, 2.1680323987864716, 275.8802180082255, 150.30490204222073, 195.9064525144146, 198.29821670739233, 200.45621426342495, 249.11201120141283, 50.12963665287468, 119.27825468997818, 69.32815263454566, 228.1096093287875, 15.168066069858689, 212.76269837167, 19.443572371082677, 31.384584394301243, 4.33551005296372, 77.19687425660645, 12.017035945243277, 56.17568857426995, 15.138059481788146, 2.3000000000000043, 0.7322859623695468, 155.86915026754062, 125.20773442388813, 1.1000000000000023, 105.06600502983885, 5.433993538618477, 114.05275843313802, -74.38883045675416, 10.400000000000006, 248.11647546731388, 259.2764239237343, 181.49648085100588, 337.50822982393987, -0.3286971539349899, 142.07827240732962, 45.210250231958554, -9.482047013944722, 8.1, 33.936149546389245, 27.542885226616228, 137.1758335702305, 15.694736663515533, 82.31576033397234, 271.7790253341121, 211.0996515006615, 0.2800247593198999, 103.71472952395645, 44.81368786100331, 44.75972099177536, 419.9243346396114, 96.68424640215933, 63.87013509439146, 0.2000000000000015, 138.52282474666077, 39.72338339885422, 129.82209872749124, -38.57676963527548, 163.66565333758194, 5.677762805213019, 19.90691756317893, 99.95884775373784, 156.90535014242442, 1.7000000000000024, 212.51142258682583, 329.4501533060345, 23.85195764560252, 2.199999999999998, 150.230920970096, 217.077233855693, -16.99838084715836, -6.661338147750939e-16, 211.26969604478975], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.818579455860245, -409.1223264256138, -277.64347581932674, -310.49545248051027, -300.55246383284646, -417.0556698840931, -303.06084856084556, -420.1253364509289, -666.2307247729295, -37.52525892024023, -567.518218469114, -375.67483138384017, -446.9795940204784, -368.4572314690241, -138.02333195865663, -345.14484880961123, -243.8318840902105, -363.8915288439304, 198.2009175667743, -913.4017173101851, -457.3216602743181, -120.2222587422088, -632.9473937616403, 15.948349570550409, 200.0, -483.2861360909586, -318.81816295856, -266.5620554126567, -429.1429068665613, -358.25923668610733, -137.12843628674437, -301.7257961965122, -439.121425093118, -352.5636510179128, -392.3200595399889, -532.7386432874827, -319.2884573641697, 198.24536690092245, -155.23433511354176, -486.36712006210195, -317.5892686700898, 171.88474216058307, -322.5634959886181, -428.54493703920656, -287.3257982691668, -316.82415750769513, 89.43218671681964, -383.2924759775135, -325.59709357557495, -179.024138808967, -319.0337286029124, -18.69402110999145, -291.9414710557589, -621.8929783073582, -294.975814837292, -523.5043986727085, -600.573083971678, -95.01091839688773, -562.0704759393262, -176.3977225673629, -362.66804233819767, 195.9064525144146, -123.38963986110456, -359.79683921820424, -460.7452647752416, 191.89999999999995, -536.8305664797003, 20.000000000000014, -409.9096977878531, -430.58186257766465, -276.4456353764479, -353.11652220521916, -422.19904832524037, -275.84746244364374, -353.32477678953165, -337.5442068993387, -116.5162987392946, -375.44456785227067, 172.05921849575924, -362.82475901872823, -336.51825497503904, -499.611755987179, -57.44909131951666, -474.46292288085687, -622.9994746556679, -465.8967439687525, -525.817430247273, -171.19268584135634, -458.4157942583288, -371.8258206022693, -368.777155282096, -117.66210787652633, -309.0634405383622, -420.9406005628532, -475.2052893198298, -306.0026372015567, -385.4541274772737, -371.8516068408898, -382.20916916211434, -135.1055909711594, -328.3978951976599, -364.6332198411242, -591.179356055756, -332.998106466782, -588.3984693430355, -28.492553214035972, -227.41979931356926, -323.5795449394491, -340.3480453118631, -118.70140750552459, -501.7396334229384, -300.434892728548, -252.4265369069365, -354.21089612839626, -436.5125644605461, -9.910508987122777, -288.4731514988992, -145.16784950379102, 162.32127879584522, -472.3296098115219, -558.2541083261256, 14.999057907103657, -325.00808783774676, -430.9947869148404, -338.1883823642503, -261.2512758864768, -439.2781084605468, -235.47542707869903, -439.9432042258799, -323.16613937373046, -342.9570223230935, -274.78519108308177, -287.8596378309025, 2.519621234664205, -58.554434362986264, -313.5588004481251, -311.8510557300613, -453.6657451328581, -330.03938863884815, -415.3993467996009, -127.13333770188785, -385.22288525505365, -254.53315246655583, -658.3594738072346, -175.28800314392294, -340.6387807089555, -191.45563939656685, -347.49935502429355, -196.53403746906363, -370.052381624606, -457.85904589059686, -201.81261906593528, -442.28016360714236, -255.15660587597117, -600.5998107556912, 200.0, -426.0197371184474, -394.0720971727256, -393.150065335952, -284.7961694509935, -400.04953900608393, -388.57564513207274, -334.44375778226765, -184.69522929837302, -305.64007152930697, -364.0968741666067, -228.1887635094952, -349.8144164932588, -346.13025606393774, -341.9144632274428, 31.362847974726165, -361.67017288379304, -580.1813568779506, -353.1773107360914, -327.74297983849914, -191.7916035451036, -203.34596085026166, -313.93234524126666, -88.85848689072054, -584.3571373539539, -286.9807580889126, -431.85360099160556, -107.687754827826, -334.4669532112093, -343.25130017711484, 20.000000000000014, 17.89233640424849, -331.8678941601579, -362.51213999249165, -456.5122087966521, -347.90140730271366, -137.50945519371297, 183.85593957223378, -310.23055681179943, -424.2993391330698, -49.354466897940625, -345.6141124187117, -391.39724911961946, -199.4920256571138, -228.8817524316424], "policy_predator_policy_reward": [364.63771607716217, 130.6797252516656, 282.84347581932656, 310.89545248051036, 326.1135399998028, 407.9874834376779, 419.53470762909944, 416.8249188570669, 438.87008782954143, 512.9725347038352, 567.518218469114, 375.84339481262384, 416.04991650947784, 483.12035164667583, 331.9504240090859, 273.0890517089443, 388.69231378597027, 418.65786040715096, 137.55243736594787, 908.4635203805618, 365.6960298709915, 438.1404929023962, 627.7344404397892, 565.7010893626067, 2.536007103786137, 483.2861360909586, 303.0687873657296, 276.7962825364084, 432.17011101755094, 358.25923668610733, 280.12576607447716, 254.1718418721328, 439.121425093118, 352.5636510179128, 619.2566190931325, 316.1506748937319, 324.88845736416937, 9.869111556789306, 237.34751772390374, 515.6092031661632, 318.7892686700897, 22.643016731089848, 163.5283448199503, 492.3263763258967, 358.02740237776794, 347.32579157326296, 373.368991922071, 110.48111472325101, 339.89739861633154, 146.75605209224835, 272.18097919185544, 320.1766105676763, 288.9322899624044, 621.8929783073582, 297.14384723607833, 523.5043986727085, 463.43072370199377, 508.033496674796, 328.5308193723712, 560.2422811765384, 362.66804233819767, 0.0, 324.0549068108175, 357.429788975884, 460.7452647752416, 8.556214263425018, 432.73100436044956, 333.21157332066514, 448.641454499622, 441.97974251877037, 401.90112448749846, 346.93928778414823, 366.52768193877415, 400.846981464656, 309.13814069676476, 609.8404523208943, 75.9168344160139, 431.2120982454105, 373.37784891878704, 30.150389975852118, 508.20892475061555, 347.364658582685, 81.36689268650541, 481.92970590816924, 627.4443850294978, 465.78734364788625, 364.39469753799455, 409.8122928072413, 450.0683667089215, 392.19028409691987, 225.43958840282255, 317.175363330069, 342.040396824288, 403.10170375871525, 475.2052893198298, 308.3026372015565, 375.3939495823499, 382.6440706981834, 266.5701039285168, 406.6138064722971, 356.98613126296414, 461.2527181997106, 591.179356055756, 334.098106466782, 165.32578851468384, 556.6312390722268, 282.7226454563292, 273.7106923353078, 378.0509887852597, 195.05122246526713, 388.0570354237964, 339.7286602709374, 262.82653690693616, 354.21089612839626, 393.8373639921205, 300.7021849228628, 342.9534875778798, 349.963937348546, 19.175202055160668, 472.3296098115219, 422.5763242811889, 458.1869559617721, 328.3674105660131, 427.30676703263947, 341.46927844751514, 400.04865221054246, 439.2781084605468, 280.6856773106568, 430.2611572119352, 323.3661393737305, 343.0570223230935, 282.7851910830817, 289.4596378309025, 29.81652831172496, 70.13253014260228, 329.5235898951254, 510.64739645886795, 392.0452379742853, 331.6627116738805, 429.47076042808465, 337.5502391693716, 257.12174412154263, 532.6579484162265, 652.0137031916768, 361.569918740026, 365.45651661351405, 111.84977861532835, 427.38524056485227, 314.81449597553603, 355.48665264208984, 447.9709027402345, 256.5144500773015, 450.2778483529452, 291.9186421219436, 540.9457785089545, 279.578366886348, 436.22758103650176, 480.5484996568319, 317.35697139820974, 424.4593984831288, 400.04953900608393, 388.7756451320727, 291.15019312298244, 366.5116187043194, 345.9511276865498, 363.5092014082188, 356.5108622369869, 351.31441649325916, 377.4643745476023, 272.0035751085033, 379.7762141288111, 114.19676411783767, 580.1813568779506, 358.8550735413043, 209.81953285891197, 329.6219680878709, 279.81161237113844, 337.4255414741272, 424.8601452313511, 405.2608291557465, 288.28075808891253, 432.25360099160565, 325.47833410968485, 329.18779651617655, 319.48842791284136, 333.2130255703077, 5.3596212413539925, 332.46789416015787, 362.51213999249165, 458.7122087966526, 325.72955614868397, 309.9122273178384, 33.221294283459116, 310.23055681179943, 442.4746377708697, 14.180787412982504, 345.6141124187117, 391.39724911961946, 315.57488921420435, 324.06858491933974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 79.8243368263381, "mean_inference_ms": 69.0795186357689, "mean_action_processing_ms": 25.604480701781704, "mean_env_wait_ms": 21.07247784494389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6960275173187256, "StateBufferConnector_ms": 1.5399876832962036, "ViewRequirementAgentConnector_ms": 7.805614233016968}, "num_episodes": 64, "episode_return_max": 576.4364856113083, "episode_return_min": -95.25371188197799, "episode_return_mean": 104.9693583812967, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2168800, "num_agent_steps_trained": 2168800, "num_env_steps_sampled": 542200, "num_env_steps_trained": 542200, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 26.442872804505694, "num_env_steps_trained_throughput_per_sec": 26.442872804505694, "timesteps_total": 542200, "num_env_steps_sampled_lifetime": 542200, "num_agent_steps_sampled_lifetime": 2168800, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2168800, "timers": {"training_iteration_time_ms": 318818.002, "restore_workers_time_ms": 93.358, "training_step_time_ms": 318523.131, "sample_time_ms": 83761.691, "learn_time_ms": 223483.928, "learn_throughput": 36.191, "synch_weights_time_ms": 10211.287}, "counters": {"num_env_steps_sampled": 542200, "num_env_steps_trained": 542200, "num_agent_steps_sampled": 2168800, "num_agent_steps_trained": 2168800}, "done": false, "training_iteration": 67, "trial_id": "cdf01_00000", "date": "2024-08-20_12-45-41", "timestamp": 1724138141, "time_this_iter_s": 303.9941580295563, "time_total_s": 8504.60568189621, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5326430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8504.60568189621, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 96.02358722358724, "ram_util_percent": 83.56781326781328}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.364549353576841, "cur_kl_coeff": 9.99200722162641e-17, "cur_lr": 0.0001, "total_loss": 8.98954674100119, "policy_loss": -0.0027323418917755285, "vf_loss": 8.992279087551056, "vf_explained_var": -0.31959792640474105, "kl": 0.0023872624801578282, "entropy": 0.1410750404946388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 43015.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.875115064401475, "cur_kl_coeff": 9.094947017729282e-14, "cur_lr": 0.0001, "total_loss": 8.793773870619516, "policy_loss": -0.0032825896054476736, "vf_loss": 8.79705648724995, "vf_explained_var": 0.3432472955612909, "kl": 0.0026720075725698116, "entropy": 0.2630830327433253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 43015.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 550200, "num_env_steps_trained": 550200, "num_agent_steps_sampled": 2200800, "num_agent_steps_trained": 2200800}, "env_runners": {"episode_reward_max": 576.4364856113083, "episode_reward_min": -95.25371188197799, "episode_reward_mean": 111.1009120220765, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -913.4017173101851, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 908.4635203805618}, "policy_reward_mean": {"prey_policy": -294.4074428191445, "predator_policy": 349.95789883018284}, "custom_metrics": {}, "hist_stats": {"episode_reward": [199.62676125897835, 330.81515800309904, 226.292603756861, 576.4364856113083, 202.53600710378618, -5.515148469079243, 3.027204150989754, 95.44337546335267, -4.440892098500626e-16, 10.348591159392765, 213.71447845771152, 111.3552657144232, 195.72775889167286, -95.25371188197799, 101.20323817416855, 189.98981738462803, -17.967781675961376, 254.6298400466269, -3.0091810933544894, 2.1680323987864716, 275.8802180082255, 150.30490204222073, 195.9064525144146, 198.29821670739233, 200.45621426342495, 249.11201120141283, 50.12963665287468, 119.27825468997818, 69.32815263454566, 228.1096093287875, 15.168066069858689, 212.76269837167, 19.443572371082677, 31.384584394301243, 4.33551005296372, 77.19687425660645, 12.017035945243277, 56.17568857426995, 15.138059481788146, 2.3000000000000043, 0.7322859623695468, 155.86915026754062, 125.20773442388813, 1.1000000000000023, 105.06600502983885, 5.433993538618477, 114.05275843313802, -74.38883045675416, 10.400000000000006, 248.11647546731388, 259.2764239237343, 181.49648085100588, 337.50822982393987, -0.3286971539349899, 142.07827240732962, 45.210250231958554, -9.482047013944722, 8.1, 33.936149546389245, 27.542885226616228, 137.1758335702305, 15.694736663515533, 82.31576033397234, 271.7790253341121, 211.0996515006615, 0.2800247593198999, 103.71472952395645, 44.81368786100331, 44.75972099177536, 419.9243346396114, 96.68424640215933, 63.87013509439146, 0.2000000000000015, 138.52282474666077, 39.72338339885422, 129.82209872749124, -38.57676963527548, 163.66565333758194, 5.677762805213019, 19.90691756317893, 99.95884775373784, 156.90535014242442, 1.7000000000000024, 212.51142258682583, 329.4501533060345, 23.85195764560252, 2.199999999999998, 150.230920970096, 217.077233855693, -16.99838084715836, -6.661338147750939e-16, 211.26969604478975, 384.96620082951944, -74.05088407761755, 125.0549031859439, 0.6385218687961307, 197.9919731967724, 470.2933652692695, 42.13288548028026, 132.6312048527047], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-243.8318840902105, -363.8915288439304, 198.2009175667743, -913.4017173101851, -457.3216602743181, -120.2222587422088, -632.9473937616403, 15.948349570550409, 200.0, -483.2861360909586, -318.81816295856, -266.5620554126567, -429.1429068665613, -358.25923668610733, -137.12843628674437, -301.7257961965122, -439.121425093118, -352.5636510179128, -392.3200595399889, -532.7386432874827, -319.2884573641697, 198.24536690092245, -155.23433511354176, -486.36712006210195, -317.5892686700898, 171.88474216058307, -322.5634959886181, -428.54493703920656, -287.3257982691668, -316.82415750769513, 89.43218671681964, -383.2924759775135, -325.59709357557495, -179.024138808967, -319.0337286029124, -18.69402110999145, -291.9414710557589, -621.8929783073582, -294.975814837292, -523.5043986727085, -600.573083971678, -95.01091839688773, -562.0704759393262, -176.3977225673629, -362.66804233819767, 195.9064525144146, -123.38963986110456, -359.79683921820424, -460.7452647752416, 191.89999999999995, -536.8305664797003, 20.000000000000014, -409.9096977878531, -430.58186257766465, -276.4456353764479, -353.11652220521916, -422.19904832524037, -275.84746244364374, -353.32477678953165, -337.5442068993387, -116.5162987392946, -375.44456785227067, 172.05921849575924, -362.82475901872823, -336.51825497503904, -499.611755987179, -57.44909131951666, -474.46292288085687, -622.9994746556679, -465.8967439687525, -525.817430247273, -171.19268584135634, -458.4157942583288, -371.8258206022693, -368.777155282096, -117.66210787652633, -309.0634405383622, -420.9406005628532, -475.2052893198298, -306.0026372015567, -385.4541274772737, -371.8516068408898, -382.20916916211434, -135.1055909711594, -328.3978951976599, -364.6332198411242, -591.179356055756, -332.998106466782, -588.3984693430355, -28.492553214035972, -227.41979931356926, -323.5795449394491, -340.3480453118631, -118.70140750552459, -501.7396334229384, -300.434892728548, -252.4265369069365, -354.21089612839626, -436.5125644605461, -9.910508987122777, -288.4731514988992, -145.16784950379102, 162.32127879584522, -472.3296098115219, -558.2541083261256, 14.999057907103657, -325.00808783774676, -430.9947869148404, -338.1883823642503, -261.2512758864768, -439.2781084605468, -235.47542707869903, -439.9432042258799, -323.16613937373046, -342.9570223230935, -274.78519108308177, -287.8596378309025, 2.519621234664205, -58.554434362986264, -313.5588004481251, -311.8510557300613, -453.6657451328581, -330.03938863884815, -415.3993467996009, -127.13333770188785, -385.22288525505365, -254.53315246655583, -658.3594738072346, -175.28800314392294, -340.6387807089555, -191.45563939656685, -347.49935502429355, -196.53403746906363, -370.052381624606, -457.85904589059686, -201.81261906593528, -442.28016360714236, -255.15660587597117, -600.5998107556912, 200.0, -426.0197371184474, -394.0720971727256, -393.150065335952, -284.7961694509935, -400.04953900608393, -388.57564513207274, -334.44375778226765, -184.69522929837302, -305.64007152930697, -364.0968741666067, -228.1887635094952, -349.8144164932588, -346.13025606393774, -341.9144632274428, 31.362847974726165, -361.67017288379304, -580.1813568779506, -353.1773107360914, -327.74297983849914, -191.7916035451036, -203.34596085026166, -313.93234524126666, -88.85848689072054, -584.3571373539539, -286.9807580889126, -431.85360099160556, -107.687754827826, -334.4669532112093, -343.25130017711484, 20.000000000000014, 17.89233640424849, -331.8678941601579, -362.51213999249165, -456.5122087966521, -347.90140730271366, -137.50945519371297, 183.85593957223378, -310.23055681179943, -424.2993391330698, -49.354466897940625, -345.6141124187117, -391.39724911961946, -199.4920256571138, -228.8817524316424, 12.127212752491566, -523.5577249729038, -171.49642896111317, -433.60250681469455, -353.59136218305065, -215.72345500477178, -374.50891297153066, -282.6063230775293, 11.896069332222432, -625.6597845888509, 166.76393054335, -326.58282715778483, -339.3469949980444, -392.32017877723916, -528.4128766219801, -22.252091222783505], "policy_predator_policy_reward": [388.69231378597027, 418.65786040715096, 137.55243736594787, 908.4635203805618, 365.6960298709915, 438.1404929023962, 627.7344404397892, 565.7010893626067, 2.536007103786137, 483.2861360909586, 303.0687873657296, 276.7962825364084, 432.17011101755094, 358.25923668610733, 280.12576607447716, 254.1718418721328, 439.121425093118, 352.5636510179128, 619.2566190931325, 316.1506748937319, 324.88845736416937, 9.869111556789306, 237.34751772390374, 515.6092031661632, 318.7892686700897, 22.643016731089848, 163.5283448199503, 492.3263763258967, 358.02740237776794, 347.32579157326296, 373.368991922071, 110.48111472325101, 339.89739861633154, 146.75605209224835, 272.18097919185544, 320.1766105676763, 288.9322899624044, 621.8929783073582, 297.14384723607833, 523.5043986727085, 463.43072370199377, 508.033496674796, 328.5308193723712, 560.2422811765384, 362.66804233819767, 0.0, 324.0549068108175, 357.429788975884, 460.7452647752416, 8.556214263425018, 432.73100436044956, 333.21157332066514, 448.641454499622, 441.97974251877037, 401.90112448749846, 346.93928778414823, 366.52768193877415, 400.846981464656, 309.13814069676476, 609.8404523208943, 75.9168344160139, 431.2120982454105, 373.37784891878704, 30.150389975852118, 508.20892475061555, 347.364658582685, 81.36689268650541, 481.92970590816924, 627.4443850294978, 465.78734364788625, 364.39469753799455, 409.8122928072413, 450.0683667089215, 392.19028409691987, 225.43958840282255, 317.175363330069, 342.040396824288, 403.10170375871525, 475.2052893198298, 308.3026372015565, 375.3939495823499, 382.6440706981834, 266.5701039285168, 406.6138064722971, 356.98613126296414, 461.2527181997106, 591.179356055756, 334.098106466782, 165.32578851468384, 556.6312390722268, 282.7226454563292, 273.7106923353078, 378.0509887852597, 195.05122246526713, 388.0570354237964, 339.7286602709374, 262.82653690693616, 354.21089612839626, 393.8373639921205, 300.7021849228628, 342.9534875778798, 349.963937348546, 19.175202055160668, 472.3296098115219, 422.5763242811889, 458.1869559617721, 328.3674105660131, 427.30676703263947, 341.46927844751514, 400.04865221054246, 439.2781084605468, 280.6856773106568, 430.2611572119352, 323.3661393737305, 343.0570223230935, 282.7851910830817, 289.4596378309025, 29.81652831172496, 70.13253014260228, 329.5235898951254, 510.64739645886795, 392.0452379742853, 331.6627116738805, 429.47076042808465, 337.5502391693716, 257.12174412154263, 532.6579484162265, 652.0137031916768, 361.569918740026, 365.45651661351405, 111.84977861532835, 427.38524056485227, 314.81449597553603, 355.48665264208984, 447.9709027402345, 256.5144500773015, 450.2778483529452, 291.9186421219436, 540.9457785089545, 279.578366886348, 436.22758103650176, 480.5484996568319, 317.35697139820974, 424.4593984831288, 400.04953900608393, 388.7756451320727, 291.15019312298244, 366.5116187043194, 345.9511276865498, 363.5092014082188, 356.5108622369869, 351.31441649325916, 377.4643745476023, 272.0035751085033, 379.7762141288111, 114.19676411783767, 580.1813568779506, 358.8550735413043, 209.81953285891197, 329.6219680878709, 279.81161237113844, 337.4255414741272, 424.8601452313511, 405.2608291557465, 288.28075808891253, 432.25360099160565, 325.47833410968485, 329.18779651617655, 319.48842791284136, 333.2130255703077, 5.3596212413539925, 332.46789416015787, 362.51213999249165, 458.7122087966526, 325.72955614868397, 309.9122273178384, 33.221294283459116, 310.23055681179943, 442.4746377708697, 14.180787412982504, 345.6141124187117, 391.39724911961946, 315.57488921420435, 324.06858491933974, 423.40692789891403, 472.9897851510176, 465.50123129259333, 65.546820405597, 301.9964748831893, 392.3732454905762, 386.779170341699, 270.97458757615686, 272.2954808454191, 539.4602076079831, 306.7112889401316, 323.4009729435727, 353.7193543583763, 420.08070489718693, 160.91626358098478, 522.3799091164841]}, "sampler_perf": {"mean_raw_obs_processing_ms": 80.06073429447248, "mean_inference_ms": 69.46630268363978, "mean_action_processing_ms": 25.574102204640084, "mean_env_wait_ms": 21.070870610767916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6662729978561401, "StateBufferConnector_ms": 2.001590371131897, "ViewRequirementAgentConnector_ms": 7.589267373085022}, "num_episodes": 8, "episode_return_max": 576.4364856113083, "episode_return_min": -95.25371188197799, "episode_return_mean": 111.1009120220765, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2200800, "num_agent_steps_trained": 2200800, "num_env_steps_sampled": 550200, "num_env_steps_trained": 550200, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 29.707171853039988, "num_env_steps_trained_throughput_per_sec": 29.707171853039988, "timesteps_total": 550200, "num_env_steps_sampled_lifetime": 550200, "num_agent_steps_sampled_lifetime": 2200800, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2200800, "timers": {"training_iteration_time_ms": 305576.178, "restore_workers_time_ms": 92.453, "training_step_time_ms": 305325.207, "sample_time_ms": 82226.386, "learn_time_ms": 216865.741, "learn_throughput": 37.295, "synch_weights_time_ms": 5669.561}, "counters": {"num_env_steps_sampled": 550200, "num_env_steps_trained": 550200, "num_agent_steps_sampled": 2200800, "num_agent_steps_trained": 2200800}, "done": false, "training_iteration": 68, "trial_id": "cdf01_00000", "date": "2024-08-20_12-50-14", "timestamp": 1724138414, "time_this_iter_s": 270.44106698036194, "time_total_s": 8775.046748876572, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a53261f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8775.046748876572, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 95.90857908847185, "ram_util_percent": 83.56648793565684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.727825211343312, "cur_kl_coeff": 4.996003610813205e-17, "cur_lr": 0.0001, "total_loss": 8.834222664908758, "policy_loss": -0.0049201231050704205, "vf_loss": 8.839142767588298, "vf_explained_var": -0.31412316768888443, "kl": 0.002802753777724132, "entropy": 0.15187957577762148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 43645.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.637765835580372, "cur_kl_coeff": 4.547473508864641e-14, "cur_lr": 0.0001, "total_loss": 8.658431176533774, "policy_loss": -0.003249386858402027, "vf_loss": 8.661680617408146, "vf_explained_var": 0.3413110722625066, "kl": 0.002589134102540384, "entropy": 0.31027135354658913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 43645.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 558200, "num_env_steps_trained": 558200, "num_agent_steps_sampled": 2232800, "num_agent_steps_trained": 2232800}, "env_runners": {"episode_reward_max": 470.2933652692695, "episode_reward_min": -90.34131529411044, "episode_reward_mean": 87.6538434301551, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -635.2776490688143, "predator_policy": 5.3596212413539925}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 626.544056096197}, "policy_reward_mean": {"prey_policy": -297.31413696506684, "predator_policy": 341.1410586801445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.0996515006615, 0.2800247593198999, 103.71472952395645, 44.81368786100331, 44.75972099177536, 419.9243346396114, 96.68424640215933, 63.87013509439146, 0.2000000000000015, 138.52282474666077, 39.72338339885422, 129.82209872749124, -38.57676963527548, 163.66565333758194, 5.677762805213019, 19.90691756317893, 99.95884775373784, 156.90535014242442, 1.7000000000000024, 212.51142258682583, 329.4501533060345, 23.85195764560252, 2.199999999999998, 150.230920970096, 217.077233855693, -16.99838084715836, -6.661338147750939e-16, 211.26969604478975, 384.96620082951944, -74.05088407761755, 125.0549031859439, 0.6385218687961307, 197.9919731967724, 470.2933652692695, 42.13288548028026, 132.6312048527047, -3.834670860928655, -67.16819984457887, 277.83810798776375, -29.707056398571147, 86.77218941465246, 41.061872627038404, 6.328336590047073, 429.29173571424565, 297.58168928236205, 99.25890292216123, 71.87837466404899, 129.58423571103327, 256.6082922865556, -0.2652032183296884, 23.291833024586296, 65.5062246794139, 146.3111658682801, 12.096613910856881, -20.14660913747138, 131.48453024971693, 18.380328609925932, 42.333488957956064, 37.88483894785051, 143.21251449805263, 116.31586919430805, 4.9999999999999964, 1.3943362983887002, 18.344733685253143, 93.49202073178564, 54.494791383892355, -52.13715464229596, 4.1000000000000005, 84.36179009664899, 22.181546541753697, 93.52311764567943, 13.5966735540852, -90.34131529411044, 123.05082848004494, -76.400941672183, 54.00472892998362, 93.31856534246413, 194.70000000000002, 35.2525535471852, 15.577823138688082, 202.79352828015436, -72.98064741997189, 42.7418418107383, 8.881784197001252e-16, 3.000000000000003, 6.575510093397753, 170.9043666249782, 8.881784197001252e-16, 63.79854406418553, -11.912328656507766, 436.9778381093818, 24.879674170750103, 119.72350368947724, 37.893375394500445, 25.74781336943211, 198.6057902685667, 94.71624704801673, 202.66267812518169, 57.63829205064281, 50.30103876405093], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-175.28800314392294, -340.6387807089555, -191.45563939656685, -347.49935502429355, -196.53403746906363, -370.052381624606, -457.85904589059686, -201.81261906593528, -442.28016360714236, -255.15660587597117, -600.5998107556912, 200.0, -426.0197371184474, -394.0720971727256, -393.150065335952, -284.7961694509935, -400.04953900608393, -388.57564513207274, -334.44375778226765, -184.69522929837302, -305.64007152930697, -364.0968741666067, -228.1887635094952, -349.8144164932588, -346.13025606393774, -341.9144632274428, 31.362847974726165, -361.67017288379304, -580.1813568779506, -353.1773107360914, -327.74297983849914, -191.7916035451036, -203.34596085026166, -313.93234524126666, -88.85848689072054, -584.3571373539539, -286.9807580889126, -431.85360099160556, -107.687754827826, -334.4669532112093, -343.25130017711484, 20.000000000000014, 17.89233640424849, -331.8678941601579, -362.51213999249165, -456.5122087966521, -347.90140730271366, -137.50945519371297, 183.85593957223378, -310.23055681179943, -424.2993391330698, -49.354466897940625, -345.6141124187117, -391.39724911961946, -199.4920256571138, -228.8817524316424, 12.127212752491566, -523.5577249729038, -171.49642896111317, -433.60250681469455, -353.59136218305065, -215.72345500477178, -374.50891297153066, -282.6063230775293, 11.896069332222432, -625.6597845888509, 166.76393054335, -326.58282715778483, -339.3469949980444, -392.32017877723916, -528.4128766219801, -22.252091222783505, -582.2541518375136, -352.98030617441174, -371.4674498063449, -359.3628361031631, -290.3358570480431, 5.4788948812943605, -242.76977590504669, -245.9252752250492, -370.81233764267483, -147.6764311711168, -493.3925394870091, -377.5496358170671, -460.065202438863, -323.96779007024213, 187.421070757421, -609.2426904579469, 194.70724784077981, -345.79740725109696, -635.2776490688143, -297.7149093390282, -227.13163542479407, -394.1479056645086, -282.79214916792733, -33.842885201066444, -126.73010274180061, -501.71909296394546, -353.7009663526639, -363.628324377563, -401.9054767867795, -370.30906589993884, -254.44117082202354, -427.08851781621246, -209.75174567989092, -532.8092050977772, -410.9268855817514, -355.70432178500545, -396.6883938048732, -427.94397902189905, -388.23184358487174, -305.939127791139, -18.477516456817803, -556.8431864880059, -252.68138687732727, -320.4569250808574, -270.11420501039134, -109.52512874967424, -265.83361460181135, -98.29207344822834, -248.7609948190878, -223.854377906107, -294.4926822280762, -335.8557859270567, -326.6379991558357, -351.3669212596614, -123.17889602610465, -332.1773642296008, -368.74861357701025, -193.0106452901108, -459.5314856275743, -103.66770118132453, -308.3991175510528, -353.62340311529573, -311.64586540003666, -307.9045753375595, -577.892753657738, -405.92174710127375, -352.2358190912985, -342.8039060012954, -371.54568993866235, -222.46085378227934, -411.00486923342726, -318.09290382421284, -229.96687906032042, -264.97885425509014, -432.9026523493012, -143.5116180106167, -325.3077614615388, -324.03553520978744, -390.9146355960348, -310.00693243083026, -197.786465253578, -462.6515245505126, 188.30775228847085, -382.81132223050804, -287.7594559304997, -275.86473455879775, -545.5825578601977, -351.8442268152406, -533.5508692114802, -270.0723888310014, -351.62428467431823, -240.6454226607424, -424.08245145646976, -474.81377137502426, -339.3465792297301, -369.606026576472, -339.1625785060891, -261.62555462796615, -226.75466746834752, -357.33715491759506, -325.86608788060204, -416.01923605163927, -316.8371870427578, -463.89408038784165, -78.80107342133375, -297.96522160648783, -414.22188133379944, -199.07886754208036, 12.356021207163689, -519.0822119647688, -265.6373173068253, -417.01004815524726, -345.0796147489765, -287.03352142598385, -334.7175509180083, -421.36734328589864, -210.84449969864835, -227.61615792914043, -377.0749203229344, 189.30049679326942, -134.8583359112021, -391.1363822630048, -544.5017306581739, 196.10829962901875, -342.5739456709857, -424.79726216901196, -415.48475717003714, 20.000000000000014], "policy_predator_policy_reward": [361.569918740026, 365.45651661351405, 111.84977861532835, 427.38524056485227, 314.81449597553603, 355.48665264208984, 447.9709027402345, 256.5144500773015, 450.2778483529452, 291.9186421219436, 540.9457785089545, 279.578366886348, 436.22758103650176, 480.5484996568319, 317.35697139820974, 424.4593984831288, 400.04953900608393, 388.7756451320727, 291.15019312298244, 366.5116187043194, 345.9511276865498, 363.5092014082188, 356.5108622369869, 351.31441649325916, 377.4643745476023, 272.0035751085033, 379.7762141288111, 114.19676411783767, 580.1813568779506, 358.8550735413043, 209.81953285891197, 329.6219680878709, 279.81161237113844, 337.4255414741272, 424.8601452313511, 405.2608291557465, 288.28075808891253, 432.25360099160565, 325.47833410968485, 329.18779651617655, 319.48842791284136, 333.2130255703077, 5.3596212413539925, 332.46789416015787, 362.51213999249165, 458.7122087966526, 325.72955614868397, 309.9122273178384, 33.221294283459116, 310.23055681179943, 442.4746377708697, 14.180787412982504, 345.6141124187117, 391.39724911961946, 315.57488921420435, 324.06858491933974, 423.40692789891403, 472.9897851510176, 465.50123129259333, 65.546820405597, 301.9964748831893, 392.3732454905762, 386.779170341699, 270.97458757615686, 272.2954808454191, 539.4602076079831, 306.7112889401316, 323.4009729435727, 353.7193543583763, 420.08070489718693, 160.91626358098478, 522.3799091164841, 578.4194809765847, 352.98030617441174, 385.99275671898823, 277.66932934594104, 287.0803907932448, 275.6146793612674, 385.60215021704033, 73.38584451448318, 369.348735403897, 235.91222282454697, 497.97324211655933, 414.03080581455356, 460.065202438863, 330.2961266602893, 410.46719317071376, 440.646162244057, 135.94937105102628, 312.72247764165326, 626.544056096197, 405.7074052338089, 308.950123782968, 384.2077919703829, 254.324251968016, 191.8950181120122, 455.2207178541132, 429.8367701381895, 347.22186229118915, 369.8422252207082, 384.0444616452838, 411.46191406602037, 309.98413160889777, 437.0517817087527, 395.25317982667815, 493.6189368192693, 413.6866598989399, 365.04116137867373, 364.9124357380321, 439.5733279512687, 351.66829609373093, 473.9872055319983, 36.681890062737985, 557.0191414920116, 309.2195103550625, 306.25229056107827, 335.52854707597436, 81.99562563194148, 236.20051036957074, 271.1376921785221, 310.6583359014919, 278.27290601801025, 339.5557859270575, 295.7926822280765, 327.6262593995876, 351.7729973142982, 358.21409406979865, 115.48689987115873, 334.34854871630057, 320.9027308826068, 160.41712627145844, 457.2768519213325, 286.3330469868475, 323.5523190372036, 315.7458654000365, 307.9045753375595, 498.2295085721683, 569.9467822834926, 324.95024895161856, 392.2710226827298, 369.19431492923866, 318.3353464373818, 411.1348582657822, 331.55958834594315, 371.7561829826468, 32.84823503865365, 427.8765604975197, 271.5885383424425, 327.450551983967, 245.49180301517498, 286.60112931306475, 468.3251676437851, 278.7116567651889, 475.0448983813655, 5.69224771152913, 383.5113222305081, 263.5261688574429, 335.3505751790398, 543.5715868161226, 369.43302099800434, 464.365869566322, 542.050916756316, 239.09480754642476, 280.1942523686632, 469.0850188640436, 472.5530457781877, 339.3465792297301, 369.606026576472, 339.1625785060891, 264.625554627966, 233.15689890543388, 357.5104335739063, 510.3023625926458, 402.4873279645773, 316.8371870427578, 463.89408038784165, 79.80185287962921, 360.7629862123778, 235.9581434273135, 365.43027679205886, 456.73969165452894, 486.96433721245603, 291.0821464585172, 416.444893174307, 354.68972196780743, 397.1469178966311, 328.95694739002016, 465.0213222083882, 233.91149965913633, 230.29697133808432, 377.0749203229344, 9.305293475297265, 252.05815899716882, 368.6528062250552, 413.00018677172847, 138.0559223826092, 356.02699147747416, 468.98250841316695, 304.36579770808754, 141.4199982260012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 80.94501611822866, "mean_inference_ms": 69.79280828438776, "mean_action_processing_ms": 25.47700772329179, "mean_env_wait_ms": 21.29985387898807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.6203080415725708, "StateBufferConnector_ms": 1.788650631904602, "ViewRequirementAgentConnector_ms": 5.734914302825928}, "num_episodes": 64, "episode_return_max": 470.2933652692695, "episode_return_min": -90.34131529411044, "episode_return_mean": 87.6538434301551, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2232800, "num_agent_steps_trained": 2232800, "num_env_steps_sampled": 558200, "num_env_steps_trained": 558200, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 42.26287588270464, "num_env_steps_trained_throughput_per_sec": 42.26287588270464, "timesteps_total": 558200, "num_env_steps_sampled_lifetime": 558200, "num_agent_steps_sampled_lifetime": 2232800, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2232800, "timers": {"training_iteration_time_ms": 308583.675, "restore_workers_time_ms": 40.857, "training_step_time_ms": 308424.721, "sample_time_ms": 81245.002, "learn_time_ms": 222120.473, "learn_throughput": 36.413, "synch_weights_time_ms": 4577.137}, "counters": {"num_env_steps_sampled": 558200, "num_env_steps_trained": 558200, "num_agent_steps_sampled": 2232800, "num_agent_steps_trained": 2232800}, "done": false, "training_iteration": 69, "trial_id": "cdf01_00000", "date": "2024-08-20_12-53-28", "timestamp": 1724138608, "time_this_iter_s": 190.6987338066101, "time_total_s": 8965.745482683182, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8965.745482683182, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 96.90936329588015, "ram_util_percent": 83.60449438202248}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.489431170433287, "cur_kl_coeff": 2.4980018054066026e-17, "cur_lr": 0.0001, "total_loss": 8.31395809309823, "policy_loss": -0.0034832227450337203, "vf_loss": 8.317441380970061, "vf_explained_var": 0.042970396412743465, "kl": 0.0020642577328234195, "entropy": 0.16696359761177548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 44275.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.932041932666112, "cur_kl_coeff": 2.2737367544323204e-14, "cur_lr": 0.0001, "total_loss": 8.685306030606467, "policy_loss": -0.0035587009619034472, "vf_loss": 8.688864748818533, "vf_explained_var": 0.4059794082528069, "kl": 0.0038508588453984726, "entropy": 0.3516375742261372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 44275.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 566200, "num_env_steps_trained": 566200, "num_agent_steps_sampled": 2264800, "num_agent_steps_trained": 2264800}, "env_runners": {"episode_reward_max": 499.45959880566267, "episode_reward_min": -90.34131529411044, "episode_reward_mean": 84.08569821756365, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -670.4797466836923, "predator_policy": 0.8047337785586307}, "policy_reward_max": {"prey_policy": 198.1837644879749, "predator_policy": 636.9045036183148}, "policy_reward_mean": {"prey_policy": -285.9419487356151, "predator_policy": 327.984797844397}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.34131529411044, 123.05082848004494, -76.400941672183, 54.00472892998362, 93.31856534246413, 194.70000000000002, 35.2525535471852, 15.577823138688082, 202.79352828015436, -72.98064741997189, 42.7418418107383, 8.881784197001252e-16, 3.000000000000003, 6.575510093397753, 170.9043666249782, 8.881784197001252e-16, 63.79854406418553, -11.912328656507766, 436.9778381093818, 24.879674170750103, 119.72350368947724, 37.893375394500445, 25.74781336943211, 198.6057902685667, 94.71624704801673, 202.66267812518169, 57.63829205064281, 50.30103876405093, 69.39913549031922, 50.23473274679655, -4.633354216786969, 2.4000000000000017, 22.565898188313266, 144.07761936535513, 98.98934153497505, 6.263249509436923, 43.68534165120577, 92.00340178904996, 19.300000000000047, 1.5543122344752192e-15, 49.72019982856776, -66.48776282406571, 21.912234670813184, 360.1683323644109, 7.553394835625294, -1.3322676295501878e-15, 206.33029083538054, 24.60556956917116, 42.39895771589883, -18.21616538242948, 55.790441721262866, 181.66354309624384, 87.08931690688127, 1.9072031621616856, 179.4560043653035, -6.144396440334574, 139.64350172359832, 4.158016580903057, 315.5310818460395, 109.82910748475649, 0.39999999999999836, 11.813562738771893, 14.698769155217988, 40.709314489104266, 67.46638418541075, 158.5387975796531, 117.12178908471249, 302.59647802267364, 40.207329801286335, 499.45959880566267, 62.01572323008801, 134.79158476251644, 0.6000000000000032, 75.11553173152731, 15.198312612320777, 168.7287367161137, 237.2587376050106, 96.76596944745667, 133.1085874431126, 2.600000000000004, -1.0814280746686027, 162.4092050945653, 67.91112976621906, 107.98717825858655, 199.69999999999996, 72.28215648186833, 97.45586970923168, 6.470635983526401, 12.305177691903188, 249.40523444883613, 9.499999999999982, 160.26382967947276, 60.49704068062547, 313.59551451000704, 42.23112296051624, 91.33071648081197, 197.47944958257582, 68.7963329941357, 1.8702116382228957, 64.5416900813892], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-229.96687906032042, -264.97885425509014, -432.9026523493012, -143.5116180106167, -325.3077614615388, -324.03553520978744, -390.9146355960348, -310.00693243083026, -197.786465253578, -462.6515245505126, 188.30775228847085, -382.81132223050804, -287.7594559304997, -275.86473455879775, -545.5825578601977, -351.8442268152406, -533.5508692114802, -270.0723888310014, -351.62428467431823, -240.6454226607424, -424.08245145646976, -474.81377137502426, -339.3465792297301, -369.606026576472, -339.1625785060891, -261.62555462796615, -226.75466746834752, -357.33715491759506, -325.86608788060204, -416.01923605163927, -316.8371870427578, -463.89408038784165, -78.80107342133375, -297.96522160648783, -414.22188133379944, -199.07886754208036, 12.356021207163689, -519.0822119647688, -265.6373173068253, -417.01004815524726, -345.0796147489765, -287.03352142598385, -334.7175509180083, -421.36734328589864, -210.84449969864835, -227.61615792914043, -377.0749203229344, 189.30049679326942, -134.8583359112021, -391.1363822630048, -544.5017306581739, 196.10829962901875, -342.5739456709857, -424.79726216901196, -415.48475717003714, 20.000000000000014, -277.27296970446315, -255.55400674836977, -478.66059879577045, -406.89416783958836, -379.0297852709792, -268.63016477792155, -278.9979778569185, -400.5012287228255, 18.14105231823705, -365.635047706765, -382.1645790268537, -105.95322933569798, -562.4729143257588, -54.13727891767336, -287.19464089518266, -353.54871579184385, -287.4648260886723, -252.030813120653, -202.46902803123456, -319.3046196027318, -368.8060511244936, 13.381748645783158, -367.5579226200371, -566.9351085134331, -318.7049602218347, -343.601884944225, -348.0717710980067, -284.10032077508015, -451.77115439579245, -329.3434414657838, -297.6690693357622, 192.75167591464273, -263.9049968368244, -360.8064665033898, -352.9767052028837, -331.89852115532995, 198.1837644879749, -346.7507528832119, -334.55974785664404, -620.693938389859, -238.27377656088683, -290.06044813310956, -403.29491553622313, -236.10923001070003, -257.00119036659817, -279.3459577571537, -28.641972675234662, -670.4797466836923, -261.23687709115364, -372.5037055729367, -77.2836659322145, -364.4599538761331, -209.00251446950523, -248.93050715473413, -317.49071702560286, -326.98394280485377, -151.926661216405, -225.19963383476252, -353.765342241537, -344.55300388731933, -343.26651049113565, 196.39999999999998, -364.33905305405744, -233.07437804426175, -308.1413636682286, -537.3165135382424, -391.18088282576224, -333.3752586815827, -58.89239571239151, -278.65002953799313, -577.5705850021045, -40.06443379360283, -329.5221070525997, -279.12600074122105, -354.4978484828315, -213.82128254190218, -155.7540998371045, -289.49754116499685, -215.1353489204928, -346.8454002413681, -485.8064609455659, -366.43476483085647, 178.95194915129122, -515.9499457365972, -253.77289953728533, -259.4694850285411, -220.04038410187187, -380.7521566495291, -290.04360097993725, -382.40723680308787, -366.40326633322314, -381.93658449096745, -288.61475063272906, -339.0803230044148, -137.68803909420842, -337.3726353422564, -188.20423538534297, -334.7137335260179, -479.86312267042297, -247.33987380502344, -335.27198129486135, -283.5571396681431, -303.1086620086423, -266.70054147054435, -339.30545474501366, -370.71138574271436, -473.16813676057296, -97.94471007319919, -495.8699841912233, -133.83035454928626, -331.3846155979795, -154.79621288806834, -297.79360081505956, 197.29526622144135, -291.6471195247052, -401.5001934838969, -105.21614228734644, -475.4419809311126, -399.30005262600224, -314.77882348999344, -98.56488325380163, -256.9763405692238, 9.886361087378397, -598.5148842038202, -257.5915792113224, -398.91649271039415, -294.8561342350581, 117.43111759997134, -315.3177033063013, -115.58579818514097, 194.6, -470.76454709468516, -69.62663760531485, -379.87563140896657, -456.22678998850756, -265.47555365596855, -313.0286031047305, 171.1567902666528, -165.38238924517043, -387.5491921578748, -385.5015522363062, -592.9777433656564, -220.0565459345926, -313.9021081966243], "policy_predator_policy_reward": [371.7561829826468, 32.84823503865365, 427.8765604975197, 271.5885383424425, 327.450551983967, 245.49180301517498, 286.60112931306475, 468.3251676437851, 278.7116567651889, 475.0448983813655, 5.69224771152913, 383.5113222305081, 263.5261688574429, 335.3505751790398, 543.5715868161226, 369.43302099800434, 464.365869566322, 542.050916756316, 239.09480754642476, 280.1942523686632, 469.0850188640436, 472.5530457781877, 339.3465792297301, 369.606026576472, 339.1625785060891, 264.625554627966, 233.15689890543388, 357.5104335739063, 510.3023625926458, 402.4873279645773, 316.8371870427578, 463.89408038784165, 79.80185287962921, 360.7629862123778, 235.9581434273135, 365.43027679205886, 456.73969165452894, 486.96433721245603, 291.0821464585172, 416.444893174307, 354.68972196780743, 397.1469178966311, 328.95694739002016, 465.0213222083882, 233.91149965913633, 230.29697133808432, 377.0749203229344, 9.305293475297265, 252.05815899716882, 368.6528062250552, 413.00018677172847, 138.0559223826092, 356.02699147747416, 468.98250841316695, 304.36579770808754, 141.4199982260012, 303.94911153946936, 298.27700040368285, 513.0914662915977, 422.6980330905572, 364.2848743555125, 278.741721476601, 281.3979778569184, 400.5012287228255, 4.424845870076187, 365.635047706765, 386.0308976043369, 246.1645301235697, 408.4413709578753, 307.15816382053214, 293.45789040461943, 353.54871579184385, 305.7138474050241, 277.46713345550756, 286.0097325556227, 327.7673168673941, 368.8060511244936, 5.918251354216807, 367.5579226200371, 566.9351085134331, 347.0420810924242, 364.9849639022015, 159.29840910775349, 406.3859199412681, 331.09912666320713, 471.92770386918284, 195.31221492072922, 269.7735108648005, 273.25394367471694, 359.01091450112233, 352.9767052028837, 331.89852115532995, 8.146526347405628, 346.7507528832119, 353.8379203601042, 626.0213354555701, 240.27377656088672, 330.45940584900916, 388.4272000106973, 232.76078015379693, 382.0611304580911, 210.07645938692332, 547.2218255003118, 333.563436954859, 346.8701595603868, 373.9597400105847, 75.49403741159917, 368.1567855589103, 330.8484413428241, 306.5405846467195, 276.4409286281859, 361.8893347619358, 265.2356608913271, 251.53413588343804, 353.4052939140405, 349.0710687957188, 296.78048287654383, 165.61710946063062, 352.82252819678735, 354.4200103862872, 306.3767106878351, 539.481166518636, 391.5988923838388, 344.7708118622778, 64.05726280834189, 288.1839315972612, 636.9045036183148, 21.439829666498206, 325.1187891603294, 350.99570281890294, 332.1503265010056, 394.70760210337903, 290.11615973871676, 272.2572703480963, 402.86612244130237, 461.71110474323206, 521.9906323506782, 370.4579232270317, 467.5150721343036, 368.94252325666463, 235.4287443116309, 339.82936348428467, 388.5265672890338, 347.0575582248844, 290.6436009799374, 382.40723680308787, 519.9712751562861, 303.48410739943336, 300.41319726033987, 342.4801889891256, 316.3313177955917, 327.458093356987, 427.92486942460306, 332.25183709176844, 381.00606611313634, 442.9628998097679, 316.60241116874556, 435.3352972373728, 303.1086620086423, 269.3005414705442, 321.6068991688715, 387.32851324418874, 443.0019534375898, 290.5200984907472, 474.0543822579641, 223.5570862487656, 271.1415932852073, 323.02641345942686, 299.3936008150599, 0.8047337785586307, 409.39443925809417, 356.03503023237664, 466.63200803818876, 211.48198488950206, 405.67068860952855, 314.87882348999347, 69.66584340724945, 298.1805581076798, 503.48513342100244, 334.5486241442762, 267.09157921132436, 398.91649271039415, 296.65613423505806, 41.03271207950146, 282.50245781479407, 208.89808435727338, 151.58604432991248, 438.1740172747797, 89.32306151972321, 402.4103304550756, 477.84446926445304, 335.188590860836, 311.2648877726995, 28.086374647954294, 416.16254544012344, 205.5653689570588, 387.3717638745294, 592.9777433656564, 334.43577974739355, 264.0645644652119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 81.56970338713555, "mean_inference_ms": 70.1659271980968, "mean_action_processing_ms": 25.399337931559266, "mean_env_wait_ms": 21.48903807141991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.18284618854522705, "StateBufferConnector_ms": 2.232552170753479, "ViewRequirementAgentConnector_ms": 6.016646862030029}, "num_episodes": 72, "episode_return_max": 499.45959880566267, "episode_return_min": -90.34131529411044, "episode_return_mean": 84.08569821756365, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2264800, "num_agent_steps_trained": 2264800, "num_env_steps_sampled": 566200, "num_env_steps_trained": 566200, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 35.65613423305656, "num_env_steps_trained_throughput_per_sec": 35.65613423305656, "timesteps_total": 566200, "num_env_steps_sampled_lifetime": 566200, "num_agent_steps_sampled_lifetime": 2264800, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2264800, "timers": {"training_iteration_time_ms": 307049.757, "restore_workers_time_ms": 32.184, "training_step_time_ms": 306917.295, "sample_time_ms": 79736.78, "learn_time_ms": 222494.051, "learn_throughput": 36.352, "synch_weights_time_ms": 4230.187}, "counters": {"num_env_steps_sampled": 566200, "num_env_steps_trained": 566200, "num_agent_steps_sampled": 2264800, "num_agent_steps_trained": 2264800}, "done": false, "training_iteration": 70, "trial_id": "cdf01_00000", "date": "2024-08-20_12-57-16", "timestamp": 1724138836, "time_this_iter_s": 226.28355240821838, "time_total_s": 9192.0290350914, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5326940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9192.0290350914, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 95.47507987220447, "ram_util_percent": 83.69680511182109}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.030133915515173, "cur_kl_coeff": 1.2490009027033013e-17, "cur_lr": 0.0001, "total_loss": 8.879276319534059, "policy_loss": -0.002396448492442095, "vf_loss": 8.881672815292601, "vf_explained_var": -0.5212615980042352, "kl": 0.0021538251322811854, "entropy": 0.14032616861282832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 44905.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.019504533873664, "cur_kl_coeff": 1.1368683772161602e-14, "cur_lr": 0.0001, "total_loss": 9.111232067289807, "policy_loss": -0.0029895746053033878, "vf_loss": 9.114221631912958, "vf_explained_var": 0.3571465141243405, "kl": 0.0032065400555124383, "entropy": 0.3352870209349526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 44905.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 574200, "num_env_steps_trained": 574200, "num_agent_steps_sampled": 2296800, "num_agent_steps_trained": 2296800}, "env_runners": {"episode_reward_max": 499.45959880566267, "episode_reward_min": -72.98064741997189, "episode_reward_mean": 93.70590015948534, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -670.4797466836923, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 636.9045036183148}, "policy_reward_mean": {"prey_policy": -280.0659867673568, "predator_policy": 326.91893684709953}, "custom_metrics": {}, "hist_stats": {"episode_reward": [202.79352828015436, -72.98064741997189, 42.7418418107383, 8.881784197001252e-16, 3.000000000000003, 6.575510093397753, 170.9043666249782, 8.881784197001252e-16, 63.79854406418553, -11.912328656507766, 436.9778381093818, 24.879674170750103, 119.72350368947724, 37.893375394500445, 25.74781336943211, 198.6057902685667, 94.71624704801673, 202.66267812518169, 57.63829205064281, 50.30103876405093, 69.39913549031922, 50.23473274679655, -4.633354216786969, 2.4000000000000017, 22.565898188313266, 144.07761936535513, 98.98934153497505, 6.263249509436923, 43.68534165120577, 92.00340178904996, 19.300000000000047, 1.5543122344752192e-15, 49.72019982856776, -66.48776282406571, 21.912234670813184, 360.1683323644109, 7.553394835625294, -1.3322676295501878e-15, 206.33029083538054, 24.60556956917116, 42.39895771589883, -18.21616538242948, 55.790441721262866, 181.66354309624384, 87.08931690688127, 1.9072031621616856, 179.4560043653035, -6.144396440334574, 139.64350172359832, 4.158016580903057, 315.5310818460395, 109.82910748475649, 0.39999999999999836, 11.813562738771893, 14.698769155217988, 40.709314489104266, 67.46638418541075, 158.5387975796531, 117.12178908471249, 302.59647802267364, 40.207329801286335, 499.45959880566267, 62.01572323008801, 134.79158476251644, 0.6000000000000032, 75.11553173152731, 15.198312612320777, 168.7287367161137, 237.2587376050106, 96.76596944745667, 133.1085874431126, 2.600000000000004, -1.0814280746686027, 162.4092050945653, 67.91112976621906, 107.98717825858655, 199.69999999999996, 72.28215648186833, 97.45586970923168, 6.470635983526401, 12.305177691903188, 249.40523444883613, 9.499999999999982, 160.26382967947276, 60.49704068062547, 313.59551451000704, 42.23112296051624, 91.33071648081197, 197.47944958257582, 68.7963329941357, 1.8702116382228957, 64.5416900813892, 178.96036051670828, 202.69999999999965, 20.47685517505399, 135.15414161195702, 56.022732556791, 238.22358964277896, 195.5, 284.14475716095365], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-533.5508692114802, -270.0723888310014, -351.62428467431823, -240.6454226607424, -424.08245145646976, -474.81377137502426, -339.3465792297301, -369.606026576472, -339.1625785060891, -261.62555462796615, -226.75466746834752, -357.33715491759506, -325.86608788060204, -416.01923605163927, -316.8371870427578, -463.89408038784165, -78.80107342133375, -297.96522160648783, -414.22188133379944, -199.07886754208036, 12.356021207163689, -519.0822119647688, -265.6373173068253, -417.01004815524726, -345.0796147489765, -287.03352142598385, -334.7175509180083, -421.36734328589864, -210.84449969864835, -227.61615792914043, -377.0749203229344, 189.30049679326942, -134.8583359112021, -391.1363822630048, -544.5017306581739, 196.10829962901875, -342.5739456709857, -424.79726216901196, -415.48475717003714, 20.000000000000014, -277.27296970446315, -255.55400674836977, -478.66059879577045, -406.89416783958836, -379.0297852709792, -268.63016477792155, -278.9979778569185, -400.5012287228255, 18.14105231823705, -365.635047706765, -382.1645790268537, -105.95322933569798, -562.4729143257588, -54.13727891767336, -287.19464089518266, -353.54871579184385, -287.4648260886723, -252.030813120653, -202.46902803123456, -319.3046196027318, -368.8060511244936, 13.381748645783158, -367.5579226200371, -566.9351085134331, -318.7049602218347, -343.601884944225, -348.0717710980067, -284.10032077508015, -451.77115439579245, -329.3434414657838, -297.6690693357622, 192.75167591464273, -263.9049968368244, -360.8064665033898, -352.9767052028837, -331.89852115532995, 198.1837644879749, -346.7507528832119, -334.55974785664404, -620.693938389859, -238.27377656088683, -290.06044813310956, -403.29491553622313, -236.10923001070003, -257.00119036659817, -279.3459577571537, -28.641972675234662, -670.4797466836923, -261.23687709115364, -372.5037055729367, -77.2836659322145, -364.4599538761331, -209.00251446950523, -248.93050715473413, -317.49071702560286, -326.98394280485377, -151.926661216405, -225.19963383476252, -353.765342241537, -344.55300388731933, -343.26651049113565, 196.39999999999998, -364.33905305405744, -233.07437804426175, -308.1413636682286, -537.3165135382424, -391.18088282576224, -333.3752586815827, -58.89239571239151, -278.65002953799313, -577.5705850021045, -40.06443379360283, -329.5221070525997, -279.12600074122105, -354.4978484828315, -213.82128254190218, -155.7540998371045, -289.49754116499685, -215.1353489204928, -346.8454002413681, -485.8064609455659, -366.43476483085647, 178.95194915129122, -515.9499457365972, -253.77289953728533, -259.4694850285411, -220.04038410187187, -380.7521566495291, -290.04360097993725, -382.40723680308787, -366.40326633322314, -381.93658449096745, -288.61475063272906, -339.0803230044148, -137.68803909420842, -337.3726353422564, -188.20423538534297, -334.7137335260179, -479.86312267042297, -247.33987380502344, -335.27198129486135, -283.5571396681431, -303.1086620086423, -266.70054147054435, -339.30545474501366, -370.71138574271436, -473.16813676057296, -97.94471007319919, -495.8699841912233, -133.83035454928626, -331.3846155979795, -154.79621288806834, -297.79360081505956, 197.29526622144135, -291.6471195247052, -401.5001934838969, -105.21614228734644, -475.4419809311126, -399.30005262600224, -314.77882348999344, -98.56488325380163, -256.9763405692238, 9.886361087378397, -598.5148842038202, -257.5915792113224, -398.91649271039415, -294.8561342350581, 117.43111759997134, -315.3177033063013, -115.58579818514097, 194.6, -470.76454709468516, -69.62663760531485, -379.87563140896657, -456.22678998850756, -265.47555365596855, -313.0286031047305, 171.1567902666528, -165.38238924517043, -387.5491921578748, -385.5015522363062, -592.9777433656564, -220.0565459345926, -313.9021081966243, -134.04342780051368, -470.8803158950289, -239.203440615635, 193.66219647085006, -375.682323751554, -377.2252667859357, -310.60092569789526, -342.4195688081333, -353.56027157045907, -299.8730553544094, -138.57275945653154, -432.3380800744299, -317.040133824974, 195.49999999999997, 199.1, -359.24763646806633], "policy_predator_policy_reward": [464.365869566322, 542.050916756316, 239.09480754642476, 280.1942523686632, 469.0850188640436, 472.5530457781877, 339.3465792297301, 369.606026576472, 339.1625785060891, 264.625554627966, 233.15689890543388, 357.5104335739063, 510.3023625926458, 402.4873279645773, 316.8371870427578, 463.89408038784165, 79.80185287962921, 360.7629862123778, 235.9581434273135, 365.43027679205886, 456.73969165452894, 486.96433721245603, 291.0821464585172, 416.444893174307, 354.68972196780743, 397.1469178966311, 328.95694739002016, 465.0213222083882, 233.91149965913633, 230.29697133808432, 377.0749203229344, 9.305293475297265, 252.05815899716882, 368.6528062250552, 413.00018677172847, 138.0559223826092, 356.02699147747416, 468.98250841316695, 304.36579770808754, 141.4199982260012, 303.94911153946936, 298.27700040368285, 513.0914662915977, 422.6980330905572, 364.2848743555125, 278.741721476601, 281.3979778569184, 400.5012287228255, 4.424845870076187, 365.635047706765, 386.0308976043369, 246.1645301235697, 408.4413709578753, 307.15816382053214, 293.45789040461943, 353.54871579184385, 305.7138474050241, 277.46713345550756, 286.0097325556227, 327.7673168673941, 368.8060511244936, 5.918251354216807, 367.5579226200371, 566.9351085134331, 347.0420810924242, 364.9849639022015, 159.29840910775349, 406.3859199412681, 331.09912666320713, 471.92770386918284, 195.31221492072922, 269.7735108648005, 273.25394367471694, 359.01091450112233, 352.9767052028837, 331.89852115532995, 8.146526347405628, 346.7507528832119, 353.8379203601042, 626.0213354555701, 240.27377656088672, 330.45940584900916, 388.4272000106973, 232.76078015379693, 382.0611304580911, 210.07645938692332, 547.2218255003118, 333.563436954859, 346.8701595603868, 373.9597400105847, 75.49403741159917, 368.1567855589103, 330.8484413428241, 306.5405846467195, 276.4409286281859, 361.8893347619358, 265.2356608913271, 251.53413588343804, 353.4052939140405, 349.0710687957188, 296.78048287654383, 165.61710946063062, 352.82252819678735, 354.4200103862872, 306.3767106878351, 539.481166518636, 391.5988923838388, 344.7708118622778, 64.05726280834189, 288.1839315972612, 636.9045036183148, 21.439829666498206, 325.1187891603294, 350.99570281890294, 332.1503265010056, 394.70760210337903, 290.11615973871676, 272.2572703480963, 402.86612244130237, 461.71110474323206, 521.9906323506782, 370.4579232270317, 467.5150721343036, 368.94252325666463, 235.4287443116309, 339.82936348428467, 388.5265672890338, 347.0575582248844, 290.6436009799374, 382.40723680308787, 519.9712751562861, 303.48410739943336, 300.41319726033987, 342.4801889891256, 316.3313177955917, 327.458093356987, 427.92486942460306, 332.25183709176844, 381.00606611313634, 442.9628998097679, 316.60241116874556, 435.3352972373728, 303.1086620086423, 269.3005414705442, 321.6068991688715, 387.32851324418874, 443.0019534375898, 290.5200984907472, 474.0543822579641, 223.5570862487656, 271.1415932852073, 323.02641345942686, 299.3936008150599, 0.8047337785586307, 409.39443925809417, 356.03503023237664, 466.63200803818876, 211.48198488950206, 405.67068860952855, 314.87882348999347, 69.66584340724945, 298.1805581076798, 503.48513342100244, 334.5486241442762, 267.09157921132436, 398.91649271039415, 296.65613423505806, 41.03271207950146, 282.50245781479407, 208.89808435727338, 151.58604432991248, 438.1740172747797, 89.32306151972321, 402.4103304550756, 477.84446926445304, 335.188590860836, 311.2648877726995, 28.086374647954294, 416.16254544012344, 205.5653689570588, 387.3717638745294, 592.9777433656564, 334.43577974739355, 264.0645644652119, 471.1955114546737, 312.68859275757717, 245.80344061563463, 2.4378035291499205, 376.346529592729, 397.03791611981404, 357.98634899926054, 430.1882871187252, 317.9948625060458, 391.4611969756143, 452.32284772586365, 356.81158144787923, 317.040133824974, 0.0, 196.14514154534513, 248.1472520836749]}, "sampler_perf": {"mean_raw_obs_processing_ms": 81.7864948501562, "mean_inference_ms": 70.57161903152777, "mean_action_processing_ms": 25.392099621595698, "mean_env_wait_ms": 21.502705244300188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.21569740772247314, "StateBufferConnector_ms": 2.4045828580856323, "ViewRequirementAgentConnector_ms": 6.744043827056885}, "num_episodes": 8, "episode_return_max": 499.45959880566267, "episode_return_min": -72.98064741997189, "episode_return_mean": 93.70590015948534, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2296800, "num_agent_steps_trained": 2296800, "num_env_steps_sampled": 574200, "num_env_steps_trained": 574200, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 33.232442663637364, "num_env_steps_trained_throughput_per_sec": 33.232442663637364, "timesteps_total": 574200, "num_env_steps_sampled_lifetime": 574200, "num_agent_steps_sampled_lifetime": 2296800, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2296800, "timers": {"training_iteration_time_ms": 264363.494, "restore_workers_time_ms": 31.516, "training_step_time_ms": 264284.002, "sample_time_ms": 41350.086, "learn_time_ms": 221682.91, "learn_throughput": 36.088, "synch_weights_time_ms": 1087.964}, "counters": {"num_env_steps_sampled": 574200, "num_env_steps_trained": 574200, "num_agent_steps_sampled": 2296800, "num_agent_steps_trained": 2296800}, "done": false, "training_iteration": 71, "trial_id": "cdf01_00000", "date": "2024-08-20_13-01-22", "timestamp": 1724139082, "time_this_iter_s": 242.96541595458984, "time_total_s": 9434.99445104599, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9434.99445104599, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 96.84526627218935, "ram_util_percent": 83.64349112426036}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.66873390504292, "cur_kl_coeff": 6.2450045135165065e-18, "cur_lr": 0.0001, "total_loss": 8.625015208834693, "policy_loss": -0.004445864698509612, "vf_loss": 8.629461063657487, "vf_explained_var": -0.09986889210958329, "kl": 0.002777830890375746, "entropy": 0.15661679599729794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 45535.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.273241446131752, "cur_kl_coeff": 5.684341886080801e-15, "cur_lr": 0.0001, "total_loss": 8.437326765060424, "policy_loss": -0.003947103981091271, "vf_loss": 8.441273873192923, "vf_explained_var": 0.3454226632912954, "kl": 0.003479719980452775, "entropy": 0.3509228691222176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 45535.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 582200, "num_env_steps_trained": 582200, "num_agent_steps_sampled": 2328800, "num_agent_steps_trained": 2328800}, "env_runners": {"episode_reward_max": 534.9124910748832, "episode_reward_min": -246.69216909769693, "episode_reward_mean": 115.39787088875626, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -795.5211204625928, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 610.2297534710301}, "policy_reward_mean": {"prey_policy": -268.41111649025754, "predator_policy": 326.11005193463575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.6000000000000032, 75.11553173152731, 15.198312612320777, 168.7287367161137, 237.2587376050106, 96.76596944745667, 133.1085874431126, 2.600000000000004, -1.0814280746686027, 162.4092050945653, 67.91112976621906, 107.98717825858655, 199.69999999999996, 72.28215648186833, 97.45586970923168, 6.470635983526401, 12.305177691903188, 249.40523444883613, 9.499999999999982, 160.26382967947276, 60.49704068062547, 313.59551451000704, 42.23112296051624, 91.33071648081197, 197.47944958257582, 68.7963329941357, 1.8702116382228957, 64.5416900813892, 178.96036051670828, 202.69999999999965, 20.47685517505399, 135.15414161195702, 56.022732556791, 238.22358964277896, 195.5, 284.14475716095365, -5.841687867333668, 124.01468588372857, 206.84252253481702, 170.9002787160471, -3.774758283725532e-15, 22.956378885973628, 257.2472024554625, 0.02756349898562238, 138.1756843950721, 33.811820444114204, 25.750797963373373, 19.928545408852663, 295.7701358996849, 58.0075313384937, 108.69198510621294, 27.789088509574412, 78.54796996887303, 210.69630070494784, 151.5890921233319, 318.32333728233186, 178.72292102859254, 165.1795004829001, 15.870800699048766, 26.742658386383017, 287.54127362014515, 7.05117625508021, 51.319052126401715, 224.1913878519885, 49.127076066648286, 79.31912144622413, 456.5321801861123, 35.642910399432175, 3.9386678020535912, 397.9205584989621, 7.6457143238173995, 44.16303859858812, 45.676747651236084, 155.03996926544443, 117.08716489347968, 216.87525310559985, 4.299999999999999, 3.501562814707574, 206.1516581414431, 171.80850429825284, 40.29672918805367, 143.55125720036352, 534.9124910748832, 127.57461863462048, 120.92863043907556, 7.872944006019569, -18.64767319157555, 26.814081588502045, 340.36346263024035, 302.9684044069956, 49.64132478946031, 314.03681274451094, 112.19032222493493, 139.62614995492868, 15.929445596430748, 5.000000000000002, 132.5121799144959, 2.600000000000003, 168.22056538869, -246.69216909769693], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-290.04360097993725, -382.40723680308787, -366.40326633322314, -381.93658449096745, -288.61475063272906, -339.0803230044148, -137.68803909420842, -337.3726353422564, -188.20423538534297, -334.7137335260179, -479.86312267042297, -247.33987380502344, -335.27198129486135, -283.5571396681431, -303.1086620086423, -266.70054147054435, -339.30545474501366, -370.71138574271436, -473.16813676057296, -97.94471007319919, -495.8699841912233, -133.83035454928626, -331.3846155979795, -154.79621288806834, -297.79360081505956, 197.29526622144135, -291.6471195247052, -401.5001934838969, -105.21614228734644, -475.4419809311126, -399.30005262600224, -314.77882348999344, -98.56488325380163, -256.9763405692238, 9.886361087378397, -598.5148842038202, -257.5915792113224, -398.91649271039415, -294.8561342350581, 117.43111759997134, -315.3177033063013, -115.58579818514097, 194.6, -470.76454709468516, -69.62663760531485, -379.87563140896657, -456.22678998850756, -265.47555365596855, -313.0286031047305, 171.1567902666528, -165.38238924517043, -387.5491921578748, -385.5015522363062, -592.9777433656564, -220.0565459345926, -313.9021081966243, -134.04342780051368, -470.8803158950289, -239.203440615635, 193.66219647085006, -375.682323751554, -377.2252667859357, -310.60092569789526, -342.4195688081333, -353.56027157045907, -299.8730553544094, -138.57275945653154, -432.3380800744299, -317.040133824974, 195.49999999999997, 199.1, -359.24763646806633, -344.9911222220295, -376.10572830118645, -130.3856358599232, -433.7378196039237, -395.29979764654104, -41.072749991373186, -391.7328529057444, 165.79999999999995, -299.59685648178225, -352.44779674490593, -38.661999506016635, -418.5269034587072, -478.82203334818655, -103.94790433853463, -354.0662239561368, -610.2297534710301, -216.03453555353437, -382.6772646791579, -337.06349980033616, -247.7961543975846, -163.1214217797997, -120.01996388913427, -358.9111861400846, -286.00862038568596, 146.0532458487642, -351.268018609082, -406.83360009257296, 14.31567925794989, -223.8989438209424, -402.2866002258215, -275.9186249187402, -412.90931527277013, -254.2769072459596, -331.3736657914532, -127.0649632665965, -460.9541037554098, -171.51823589724052, -302.95049227308704, -317.9908646711449, 170.66082647607794, -182.5691686558405, -273.8079584256046, -199.70020587978658, -456.05760062880006, -278.53798987208376, -247.940561576141, -388.7417986732566, -298.91800212943474, -687.7223734293857, -34.86575058318987, -320.8536108701135, -312.1624937879528, -417.9602199736092, -231.3458371007743, -484.32575481101253, 153.08016537186143, -376.60936429038406, -326.62054988919664, -501.49917971484376, -347.83681707847336, -329.9780077817874, 170.86602771645184, -339.476681785608, -513.4776980755349, -288.89726292325105, -506.6294380981485, 8.722614646072255, -795.5211204625928, -168.28581720452453, -396.0791827296663, -302.83553898223425, -288.4129197083014, -455.48750367879353, -229.63615086627135, -198.49306141421124, -300.6572707402198, -25.318363049065923, -371.85820321153136, 197.29999999999998, -360.1417553513297, -276.99115503580117, -198.03195337775128, -422.0248918354967, -315.38149581839684, 174.86479801826346, -382.15286894751677, -276.0472679550445, -308.5360035467239, -327.89413678119337, -311.98684109441314, -392.4734353461112, -36.735517397906705, -443.8743968597683, 190.6996921484765, 77.75790137384564, -259.1127791830643, -593.3334745741197, -269.35729786556317, -240.86864821550841, -251.72942436688953, -314.840229680241, -267.4331335546273, -437.37786464694983, -357.1634950156989, 185.9731283216092, -402.0712544173301, -139.2110817604106, -510.67720169143695, -229.07032412944542, -300.79780139452043, 159.2456674401612, -388.0431407517875, -393.8608637827251, -166.70103047217506, -504.6003106580821, -46.74226535264394, -434.27018616667334, -289.7203848837198, -289.2390509891317, -218.65166251710036, -272.5801954029655, -458.01039284845535, -249.5005231454094, -283.3350163151446, -338.38363232744877, -101.98151137836854, -331.44482689314214, -431.8196242162904], "policy_predator_policy_reward": [290.6436009799374, 382.40723680308787, 519.9712751562861, 303.48410739943336, 300.41319726033987, 342.4801889891256, 316.3313177955917, 327.458093356987, 427.92486942460306, 332.25183709176844, 381.00606611313634, 442.9628998097679, 316.60241116874556, 435.3352972373728, 303.1086620086423, 269.3005414705442, 321.6068991688715, 387.32851324418874, 443.0019534375898, 290.5200984907472, 474.0543822579641, 223.5570862487656, 271.1415932852073, 323.02641345942686, 299.3936008150599, 0.8047337785586307, 409.39443925809417, 356.03503023237664, 466.63200803818876, 211.48198488950206, 405.67068860952855, 314.87882348999347, 69.66584340724945, 298.1805581076798, 503.48513342100244, 334.5486241442762, 267.09157921132436, 398.91649271039415, 296.65613423505806, 41.03271207950146, 282.50245781479407, 208.89808435727338, 151.58604432991248, 438.1740172747797, 89.32306151972321, 402.4103304550756, 477.84446926445304, 335.188590860836, 311.2648877726995, 28.086374647954294, 416.16254544012344, 205.5653689570588, 387.3717638745294, 592.9777433656564, 334.43577974739355, 264.0645644652119, 471.1955114546737, 312.68859275757717, 245.80344061563463, 2.4378035291499205, 376.346529592729, 397.03791611981404, 357.98634899926054, 430.1882871187252, 317.9948625060458, 391.4611969756143, 452.32284772586365, 356.81158144787923, 317.040133824974, 0.0, 196.14514154534513, 248.1472520836749, 341.8283972167976, 373.4267654390855, 289.2998616570341, 398.8382796905401, 276.863442163425, 366.3516280093075, 391.7328529057444, 5.100278716047084, 299.59685648178225, 352.44779674490593, 195.88981702655641, 284.25546482414023, 407.6128295775673, 432.40431056461546, 354.0937874551224, 610.2297534710301, 363.5298605540982, 373.35762407366525, 352.7452999380821, 265.9261747039528, 19.067055121975898, 289.8251285103305, 364.2942778480068, 300.5540740866166, 158.09233774759727, 342.8925709124045, 406.83360009257296, 43.69185208054354, 360.1067098717173, 374.7708192812593, 297.4077134283147, 419.20931527276997, 301.37978565777354, 362.8187573485119, 436.1853367204966, 362.5300310064578, 332.88260845737454, 293.17521183628463, 305.02930335652906, 160.62407212086998, 324.0713248169661, 311.0287232930719, 403.95249706148405, 416.98480993000317, 278.80101250426395, 263.54833964300906, 388.7417986732566, 325.6606605158176, 510.6650869383963, 499.46431069432225, 323.9804340335859, 316.08684687956077, 460.1727457054652, 240.45236349532075, 467.18145714333684, 88.25552014780284, 373.97709285070084, 378.3798973955283, 514.46722218511, 414.1878960544305, 317.14914096562075, 298.4950192858271, 393.2364024326591, 495.36088782791677, 291.09726292325126, 508.3681059002024, 578.9169179642289, 605.8021463512499, 173.43153152834185, 398.57918272966685, 324.12243588240943, 311.2890614067143, 455.25464350858533, 275.54575868771536, 351.27787992560536, 302.9124214942727, 178.32747763620762, 335.9362535178701, 19.575253105599863, 360.1417553513297, 277.39115503580115, 201.93195337775109, 291.5648662694074, 449.34308419919324, 30.886860123179666, 382.55286894751674, 388.7974951966308, 367.59428060339184, 311.4222237012077, 368.75548336245294, 201.53671289397073, 371.2234970504103, 401.46609485659684, 386.6211009295779, 0.0, 308.9294964438394, 391.5784401175012, 592.0409627612586, 244.8415922215278, 255.6294243668893, 267.8205223171572, 295.8051677261363, 466.49194198971355, 354.863499261438, 188.37825211452025, 368.08333661144064, 484.6618994802751, 468.19478837856747, 237.7726963108276, 341.73675400259754, 207.15588913753615, 335.6783969186014, 379.9301925806012, 292.82202389923367, 296.7565259082328, 394.21220005742106, 478.8630837673081, 261.0569328795162, 289.8390509891318, 223.05166251710028, 400.0858834576083, 463.01688470830874, 252.10052314540926, 283.3350163151446, 325.3316080769826, 283.25410101752493, 253.20431533951677, 263.36796667222166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 82.23403941462914, "mean_inference_ms": 70.46898550952358, "mean_action_processing_ms": 25.297785393162425, "mean_env_wait_ms": 21.630248673268053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1872270107269287, "StateBufferConnector_ms": 2.0707461833953857, "ViewRequirementAgentConnector_ms": 5.91537344455719}, "num_episodes": 64, "episode_return_max": 534.9124910748832, "episode_return_min": -246.69216909769693, "episode_return_mean": 115.39787088875626, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2328800, "num_agent_steps_trained": 2328800, "num_env_steps_sampled": 582200, "num_env_steps_trained": 582200, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 38.84646777525831, "num_env_steps_trained_throughput_per_sec": 38.84646777525831, "timesteps_total": 582200, "num_env_steps_sampled_lifetime": 582200, "num_agent_steps_sampled_lifetime": 2328800, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2328800, "timers": {"training_iteration_time_ms": 253722.559, "restore_workers_time_ms": 15.474, "training_step_time_ms": 253681.957, "sample_time_ms": 37234.255, "learn_time_ms": 214875.3, "learn_throughput": 37.231, "synch_weights_time_ms": 1434.302}, "counters": {"num_env_steps_sampled": 582200, "num_env_steps_trained": 582200, "num_agent_steps_sampled": 2328800, "num_agent_steps_trained": 2328800}, "done": false, "training_iteration": 72, "trial_id": "cdf01_00000", "date": "2024-08-20_13-04-55", "timestamp": 1724139295, "time_this_iter_s": 208.43209719657898, "time_total_s": 9643.426548242569, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5390430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9643.426548242569, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 96.48793103448276, "ram_util_percent": 83.7803448275862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.246732750203874, "cur_kl_coeff": 3.1225022567582532e-18, "cur_lr": 0.0001, "total_loss": 8.930832010602193, "policy_loss": -0.0042274652898962066, "vf_loss": 8.935059486873566, "vf_explained_var": -0.42808330418571594, "kl": 0.004655396285708112, "entropy": 0.14317905250049773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 46165.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.872477509861901, "cur_kl_coeff": 2.8421709430404005e-15, "cur_lr": 0.0001, "total_loss": 8.687171167040628, "policy_loss": -0.0031913474749123293, "vf_loss": 8.690362560938276, "vf_explained_var": 0.30779373778237235, "kl": 0.0031984792626081754, "entropy": 0.3106194226987778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 46165.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 590200, "num_env_steps_trained": 590200, "num_agent_steps_sampled": 2360800, "num_agent_steps_trained": 2360800}, "env_runners": {"episode_reward_max": 534.9124910748832, "episode_reward_min": -246.69216909769693, "episode_reward_mean": 114.02761788808293, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -795.5211204625928, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 610.2297534710301}, "policy_reward_mean": {"prey_policy": -268.1706060658579, "predator_policy": 325.18441500989945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0814280746686027, 162.4092050945653, 67.91112976621906, 107.98717825858655, 199.69999999999996, 72.28215648186833, 97.45586970923168, 6.470635983526401, 12.305177691903188, 249.40523444883613, 9.499999999999982, 160.26382967947276, 60.49704068062547, 313.59551451000704, 42.23112296051624, 91.33071648081197, 197.47944958257582, 68.7963329941357, 1.8702116382228957, 64.5416900813892, 178.96036051670828, 202.69999999999965, 20.47685517505399, 135.15414161195702, 56.022732556791, 238.22358964277896, 195.5, 284.14475716095365, -5.841687867333668, 124.01468588372857, 206.84252253481702, 170.9002787160471, -3.774758283725532e-15, 22.956378885973628, 257.2472024554625, 0.02756349898562238, 138.1756843950721, 33.811820444114204, 25.750797963373373, 19.928545408852663, 295.7701358996849, 58.0075313384937, 108.69198510621294, 27.789088509574412, 78.54796996887303, 210.69630070494784, 151.5890921233319, 318.32333728233186, 178.72292102859254, 165.1795004829001, 15.870800699048766, 26.742658386383017, 287.54127362014515, 7.05117625508021, 51.319052126401715, 224.1913878519885, 49.127076066648286, 79.31912144622413, 456.5321801861123, 35.642910399432175, 3.9386678020535912, 397.9205584989621, 7.6457143238173995, 44.16303859858812, 45.676747651236084, 155.03996926544443, 117.08716489347968, 216.87525310559985, 4.299999999999999, 3.501562814707574, 206.1516581414431, 171.80850429825284, 40.29672918805367, 143.55125720036352, 534.9124910748832, 127.57461863462048, 120.92863043907556, 7.872944006019569, -18.64767319157555, 26.814081588502045, 340.36346263024035, 302.9684044069956, 49.64132478946031, 314.03681274451094, 112.19032222493493, 139.62614995492868, 15.929445596430748, 5.000000000000002, 132.5121799144959, 2.600000000000003, 168.22056538869, -246.69216909769693, 155.0637607966887, -4.850792059621592, 232.8522921664713, 60.603335801420535, 1.2658884799697523, 40.58451094484633, 85.74839622642342, 21.083183132009705], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-339.30545474501366, -370.71138574271436, -473.16813676057296, -97.94471007319919, -495.8699841912233, -133.83035454928626, -331.3846155979795, -154.79621288806834, -297.79360081505956, 197.29526622144135, -291.6471195247052, -401.5001934838969, -105.21614228734644, -475.4419809311126, -399.30005262600224, -314.77882348999344, -98.56488325380163, -256.9763405692238, 9.886361087378397, -598.5148842038202, -257.5915792113224, -398.91649271039415, -294.8561342350581, 117.43111759997134, -315.3177033063013, -115.58579818514097, 194.6, -470.76454709468516, -69.62663760531485, -379.87563140896657, -456.22678998850756, -265.47555365596855, -313.0286031047305, 171.1567902666528, -165.38238924517043, -387.5491921578748, -385.5015522363062, -592.9777433656564, -220.0565459345926, -313.9021081966243, -134.04342780051368, -470.8803158950289, -239.203440615635, 193.66219647085006, -375.682323751554, -377.2252667859357, -310.60092569789526, -342.4195688081333, -353.56027157045907, -299.8730553544094, -138.57275945653154, -432.3380800744299, -317.040133824974, 195.49999999999997, 199.1, -359.24763646806633, -344.9911222220295, -376.10572830118645, -130.3856358599232, -433.7378196039237, -395.29979764654104, -41.072749991373186, -391.7328529057444, 165.79999999999995, -299.59685648178225, -352.44779674490593, -38.661999506016635, -418.5269034587072, -478.82203334818655, -103.94790433853463, -354.0662239561368, -610.2297534710301, -216.03453555353437, -382.6772646791579, -337.06349980033616, -247.7961543975846, -163.1214217797997, -120.01996388913427, -358.9111861400846, -286.00862038568596, 146.0532458487642, -351.268018609082, -406.83360009257296, 14.31567925794989, -223.8989438209424, -402.2866002258215, -275.9186249187402, -412.90931527277013, -254.2769072459596, -331.3736657914532, -127.0649632665965, -460.9541037554098, -171.51823589724052, -302.95049227308704, -317.9908646711449, 170.66082647607794, -182.5691686558405, -273.8079584256046, -199.70020587978658, -456.05760062880006, -278.53798987208376, -247.940561576141, -388.7417986732566, -298.91800212943474, -687.7223734293857, -34.86575058318987, -320.8536108701135, -312.1624937879528, -417.9602199736092, -231.3458371007743, -484.32575481101253, 153.08016537186143, -376.60936429038406, -326.62054988919664, -501.49917971484376, -347.83681707847336, -329.9780077817874, 170.86602771645184, -339.476681785608, -513.4776980755349, -288.89726292325105, -506.6294380981485, 8.722614646072255, -795.5211204625928, -168.28581720452453, -396.0791827296663, -302.83553898223425, -288.4129197083014, -455.48750367879353, -229.63615086627135, -198.49306141421124, -300.6572707402198, -25.318363049065923, -371.85820321153136, 197.29999999999998, -360.1417553513297, -276.99115503580117, -198.03195337775128, -422.0248918354967, -315.38149581839684, 174.86479801826346, -382.15286894751677, -276.0472679550445, -308.5360035467239, -327.89413678119337, -311.98684109441314, -392.4734353461112, -36.735517397906705, -443.8743968597683, 190.6996921484765, 77.75790137384564, -259.1127791830643, -593.3334745741197, -269.35729786556317, -240.86864821550841, -251.72942436688953, -314.840229680241, -267.4331335546273, -437.37786464694983, -357.1634950156989, 185.9731283216092, -402.0712544173301, -139.2110817604106, -510.67720169143695, -229.07032412944542, -300.79780139452043, 159.2456674401612, -388.0431407517875, -393.8608637827251, -166.70103047217506, -504.6003106580821, -46.74226535264394, -434.27018616667334, -289.7203848837198, -289.2390509891317, -218.65166251710036, -272.5801954029655, -458.01039284845535, -249.5005231454094, -283.3350163151446, -338.38363232744877, -101.98151137836854, -331.44482689314214, -431.8196242162904, -521.7546005905288, -52.88597252345165, -377.75788776923986, -389.5845070164021, -134.09370461363875, -435.8607503207445, -414.4102320061953, -58.58705100291024, -417.8971966963399, -486.40769989960876, -258.87427987716467, -265.0950926260732, -303.56594314095776, -175.42534845369136, -387.1461854216478, -234.85718967130634], "policy_predator_policy_reward": [321.6068991688715, 387.32851324418874, 443.0019534375898, 290.5200984907472, 474.0543822579641, 223.5570862487656, 271.1415932852073, 323.02641345942686, 299.3936008150599, 0.8047337785586307, 409.39443925809417, 356.03503023237664, 466.63200803818876, 211.48198488950206, 405.67068860952855, 314.87882348999347, 69.66584340724945, 298.1805581076798, 503.48513342100244, 334.5486241442762, 267.09157921132436, 398.91649271039415, 296.65613423505806, 41.03271207950146, 282.50245781479407, 208.89808435727338, 151.58604432991248, 438.1740172747797, 89.32306151972321, 402.4103304550756, 477.84446926445304, 335.188590860836, 311.2648877726995, 28.086374647954294, 416.16254544012344, 205.5653689570588, 387.3717638745294, 592.9777433656564, 334.43577974739355, 264.0645644652119, 471.1955114546737, 312.68859275757717, 245.80344061563463, 2.4378035291499205, 376.346529592729, 397.03791611981404, 357.98634899926054, 430.1882871187252, 317.9948625060458, 391.4611969756143, 452.32284772586365, 356.81158144787923, 317.040133824974, 0.0, 196.14514154534513, 248.1472520836749, 341.8283972167976, 373.4267654390855, 289.2998616570341, 398.8382796905401, 276.863442163425, 366.3516280093075, 391.7328529057444, 5.100278716047084, 299.59685648178225, 352.44779674490593, 195.88981702655641, 284.25546482414023, 407.6128295775673, 432.40431056461546, 354.0937874551224, 610.2297534710301, 363.5298605540982, 373.35762407366525, 352.7452999380821, 265.9261747039528, 19.067055121975898, 289.8251285103305, 364.2942778480068, 300.5540740866166, 158.09233774759727, 342.8925709124045, 406.83360009257296, 43.69185208054354, 360.1067098717173, 374.7708192812593, 297.4077134283147, 419.20931527276997, 301.37978565777354, 362.8187573485119, 436.1853367204966, 362.5300310064578, 332.88260845737454, 293.17521183628463, 305.02930335652906, 160.62407212086998, 324.0713248169661, 311.0287232930719, 403.95249706148405, 416.98480993000317, 278.80101250426395, 263.54833964300906, 388.7417986732566, 325.6606605158176, 510.6650869383963, 499.46431069432225, 323.9804340335859, 316.08684687956077, 460.1727457054652, 240.45236349532075, 467.18145714333684, 88.25552014780284, 373.97709285070084, 378.3798973955283, 514.46722218511, 414.1878960544305, 317.14914096562075, 298.4950192858271, 393.2364024326591, 495.36088782791677, 291.09726292325126, 508.3681059002024, 578.9169179642289, 605.8021463512499, 173.43153152834185, 398.57918272966685, 324.12243588240943, 311.2890614067143, 455.25464350858533, 275.54575868771536, 351.27787992560536, 302.9124214942727, 178.32747763620762, 335.9362535178701, 19.575253105599863, 360.1417553513297, 277.39115503580115, 201.93195337775109, 291.5648662694074, 449.34308419919324, 30.886860123179666, 382.55286894751674, 388.7974951966308, 367.59428060339184, 311.4222237012077, 368.75548336245294, 201.53671289397073, 371.2234970504103, 401.46609485659684, 386.6211009295779, 0.0, 308.9294964438394, 391.5784401175012, 592.0409627612586, 244.8415922215278, 255.6294243668893, 267.8205223171572, 295.8051677261363, 466.49194198971355, 354.863499261438, 188.37825211452025, 368.08333661144064, 484.6618994802751, 468.19478837856747, 237.7726963108276, 341.73675400259754, 207.15588913753615, 335.6783969186014, 379.9301925806012, 292.82202389923367, 296.7565259082328, 394.21220005742106, 478.8630837673081, 261.0569328795162, 289.8390509891318, 223.05166251710028, 400.0858834576083, 463.01688470830874, 252.10052314540926, 283.3350163151446, 325.3316080769826, 283.25410101752493, 253.20431533951677, 263.36796667222166, 410.0980847059935, 319.6062492046763, 389.18106081495716, 373.3105419110632, 430.1699312046675, 372.6368158961865, 325.10707139341724, 208.49354741710866, 419.52230073023105, 486.04848434568737, 273.5841539628696, 290.9697294852151, 296.4229275475084, 268.316760273565, 206.33111302854735, 436.75544519641636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 82.37644117652444, "mean_inference_ms": 70.80322735466845, "mean_action_processing_ms": 25.259990946480922, "mean_env_wait_ms": 21.613765172475023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.18369948863983154, "StateBufferConnector_ms": 2.0711151361465454, "ViewRequirementAgentConnector_ms": 5.882716059684753}, "num_episodes": 8, "episode_return_max": 534.9124910748832, "episode_return_min": -246.69216909769693, "episode_return_mean": 114.02761788808293, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2360800, "num_agent_steps_trained": 2360800, "num_env_steps_sampled": 590200, "num_env_steps_trained": 590200, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 40.34468198931484, "num_env_steps_trained_throughput_per_sec": 40.34468198931484, "timesteps_total": 590200, "num_env_steps_sampled_lifetime": 590200, "num_agent_steps_sampled_lifetime": 2360800, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2360800, "timers": {"training_iteration_time_ms": 246825.965, "restore_workers_time_ms": 13.576, "training_step_time_ms": 246790.228, "sample_time_ms": 35958.493, "learn_time_ms": 209241.434, "learn_throughput": 38.233, "synch_weights_time_ms": 1444.902}, "counters": {"num_env_steps_sampled": 590200, "num_env_steps_trained": 590200, "num_agent_steps_sampled": 2360800, "num_agent_steps_trained": 2360800}, "done": false, "training_iteration": 73, "trial_id": "cdf01_00000", "date": "2024-08-20_13-08-20", "timestamp": 1724139500, "time_this_iter_s": 200.86599397659302, "time_total_s": 9844.292542219162, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e38940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9844.292542219162, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 92.47698744769875, "ram_util_percent": 83.69288702928871}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {}, "num_env_steps_sampled": 590200, "num_env_steps_trained": 590200, "num_agent_steps_sampled": 2360800, "num_agent_steps_trained": 2360800}, "env_runners": {"episode_reward_max": 534.9124910748832, "episode_reward_min": -246.69216909769693, "episode_reward_mean": 114.02761788808293, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -795.5211204625928, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 610.2297534710301}, "policy_reward_mean": {"prey_policy": -268.1706060658579, "predator_policy": 325.18441500989945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0814280746686027, 162.4092050945653, 67.91112976621906, 107.98717825858655, 199.69999999999996, 72.28215648186833, 97.45586970923168, 6.470635983526401, 12.305177691903188, 249.40523444883613, 9.499999999999982, 160.26382967947276, 60.49704068062547, 313.59551451000704, 42.23112296051624, 91.33071648081197, 197.47944958257582, 68.7963329941357, 1.8702116382228957, 64.5416900813892, 178.96036051670828, 202.69999999999965, 20.47685517505399, 135.15414161195702, 56.022732556791, 238.22358964277896, 195.5, 284.14475716095365, -5.841687867333668, 124.01468588372857, 206.84252253481702, 170.9002787160471, -3.774758283725532e-15, 22.956378885973628, 257.2472024554625, 0.02756349898562238, 138.1756843950721, 33.811820444114204, 25.750797963373373, 19.928545408852663, 295.7701358996849, 58.0075313384937, 108.69198510621294, 27.789088509574412, 78.54796996887303, 210.69630070494784, 151.5890921233319, 318.32333728233186, 178.72292102859254, 165.1795004829001, 15.870800699048766, 26.742658386383017, 287.54127362014515, 7.05117625508021, 51.319052126401715, 224.1913878519885, 49.127076066648286, 79.31912144622413, 456.5321801861123, 35.642910399432175, 3.9386678020535912, 397.9205584989621, 7.6457143238173995, 44.16303859858812, 45.676747651236084, 155.03996926544443, 117.08716489347968, 216.87525310559985, 4.299999999999999, 3.501562814707574, 206.1516581414431, 171.80850429825284, 40.29672918805367, 143.55125720036352, 534.9124910748832, 127.57461863462048, 120.92863043907556, 7.872944006019569, -18.64767319157555, 26.814081588502045, 340.36346263024035, 302.9684044069956, 49.64132478946031, 314.03681274451094, 112.19032222493493, 139.62614995492868, 15.929445596430748, 5.000000000000002, 132.5121799144959, 2.600000000000003, 168.22056538869, -246.69216909769693, 155.0637607966887, -4.850792059621592, 232.8522921664713, 60.603335801420535, 1.2658884799697523, 40.58451094484633, 85.74839622642342, 21.083183132009705], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-339.30545474501366, -370.71138574271436, -473.16813676057296, -97.94471007319919, -495.8699841912233, -133.83035454928626, -331.3846155979795, -154.79621288806834, -297.79360081505956, 197.29526622144135, -291.6471195247052, -401.5001934838969, -105.21614228734644, -475.4419809311126, -399.30005262600224, -314.77882348999344, -98.56488325380163, -256.9763405692238, 9.886361087378397, -598.5148842038202, -257.5915792113224, -398.91649271039415, -294.8561342350581, 117.43111759997134, -315.3177033063013, -115.58579818514097, 194.6, -470.76454709468516, -69.62663760531485, -379.87563140896657, -456.22678998850756, -265.47555365596855, -313.0286031047305, 171.1567902666528, -165.38238924517043, -387.5491921578748, -385.5015522363062, -592.9777433656564, -220.0565459345926, -313.9021081966243, -134.04342780051368, -470.8803158950289, -239.203440615635, 193.66219647085006, -375.682323751554, -377.2252667859357, -310.60092569789526, -342.4195688081333, -353.56027157045907, -299.8730553544094, -138.57275945653154, -432.3380800744299, -317.040133824974, 195.49999999999997, 199.1, -359.24763646806633, -344.9911222220295, -376.10572830118645, -130.3856358599232, -433.7378196039237, -395.29979764654104, -41.072749991373186, -391.7328529057444, 165.79999999999995, -299.59685648178225, -352.44779674490593, -38.661999506016635, -418.5269034587072, -478.82203334818655, -103.94790433853463, -354.0662239561368, -610.2297534710301, -216.03453555353437, -382.6772646791579, -337.06349980033616, -247.7961543975846, -163.1214217797997, -120.01996388913427, -358.9111861400846, -286.00862038568596, 146.0532458487642, -351.268018609082, -406.83360009257296, 14.31567925794989, -223.8989438209424, -402.2866002258215, -275.9186249187402, -412.90931527277013, -254.2769072459596, -331.3736657914532, -127.0649632665965, -460.9541037554098, -171.51823589724052, -302.95049227308704, -317.9908646711449, 170.66082647607794, -182.5691686558405, -273.8079584256046, -199.70020587978658, -456.05760062880006, -278.53798987208376, -247.940561576141, -388.7417986732566, -298.91800212943474, -687.7223734293857, -34.86575058318987, -320.8536108701135, -312.1624937879528, -417.9602199736092, -231.3458371007743, -484.32575481101253, 153.08016537186143, -376.60936429038406, -326.62054988919664, -501.49917971484376, -347.83681707847336, -329.9780077817874, 170.86602771645184, -339.476681785608, -513.4776980755349, -288.89726292325105, -506.6294380981485, 8.722614646072255, -795.5211204625928, -168.28581720452453, -396.0791827296663, -302.83553898223425, -288.4129197083014, -455.48750367879353, -229.63615086627135, -198.49306141421124, -300.6572707402198, -25.318363049065923, -371.85820321153136, 197.29999999999998, -360.1417553513297, -276.99115503580117, -198.03195337775128, -422.0248918354967, -315.38149581839684, 174.86479801826346, -382.15286894751677, -276.0472679550445, -308.5360035467239, -327.89413678119337, -311.98684109441314, -392.4734353461112, -36.735517397906705, -443.8743968597683, 190.6996921484765, 77.75790137384564, -259.1127791830643, -593.3334745741197, -269.35729786556317, -240.86864821550841, -251.72942436688953, -314.840229680241, -267.4331335546273, -437.37786464694983, -357.1634950156989, 185.9731283216092, -402.0712544173301, -139.2110817604106, -510.67720169143695, -229.07032412944542, -300.79780139452043, 159.2456674401612, -388.0431407517875, -393.8608637827251, -166.70103047217506, -504.6003106580821, -46.74226535264394, -434.27018616667334, -289.7203848837198, -289.2390509891317, -218.65166251710036, -272.5801954029655, -458.01039284845535, -249.5005231454094, -283.3350163151446, -338.38363232744877, -101.98151137836854, -331.44482689314214, -431.8196242162904, -521.7546005905288, -52.88597252345165, -377.75788776923986, -389.5845070164021, -134.09370461363875, -435.8607503207445, -414.4102320061953, -58.58705100291024, -417.8971966963399, -486.40769989960876, -258.87427987716467, -265.0950926260732, -303.56594314095776, -175.42534845369136, -387.1461854216478, -234.85718967130634], "policy_predator_policy_reward": [321.6068991688715, 387.32851324418874, 443.0019534375898, 290.5200984907472, 474.0543822579641, 223.5570862487656, 271.1415932852073, 323.02641345942686, 299.3936008150599, 0.8047337785586307, 409.39443925809417, 356.03503023237664, 466.63200803818876, 211.48198488950206, 405.67068860952855, 314.87882348999347, 69.66584340724945, 298.1805581076798, 503.48513342100244, 334.5486241442762, 267.09157921132436, 398.91649271039415, 296.65613423505806, 41.03271207950146, 282.50245781479407, 208.89808435727338, 151.58604432991248, 438.1740172747797, 89.32306151972321, 402.4103304550756, 477.84446926445304, 335.188590860836, 311.2648877726995, 28.086374647954294, 416.16254544012344, 205.5653689570588, 387.3717638745294, 592.9777433656564, 334.43577974739355, 264.0645644652119, 471.1955114546737, 312.68859275757717, 245.80344061563463, 2.4378035291499205, 376.346529592729, 397.03791611981404, 357.98634899926054, 430.1882871187252, 317.9948625060458, 391.4611969756143, 452.32284772586365, 356.81158144787923, 317.040133824974, 0.0, 196.14514154534513, 248.1472520836749, 341.8283972167976, 373.4267654390855, 289.2998616570341, 398.8382796905401, 276.863442163425, 366.3516280093075, 391.7328529057444, 5.100278716047084, 299.59685648178225, 352.44779674490593, 195.88981702655641, 284.25546482414023, 407.6128295775673, 432.40431056461546, 354.0937874551224, 610.2297534710301, 363.5298605540982, 373.35762407366525, 352.7452999380821, 265.9261747039528, 19.067055121975898, 289.8251285103305, 364.2942778480068, 300.5540740866166, 158.09233774759727, 342.8925709124045, 406.83360009257296, 43.69185208054354, 360.1067098717173, 374.7708192812593, 297.4077134283147, 419.20931527276997, 301.37978565777354, 362.8187573485119, 436.1853367204966, 362.5300310064578, 332.88260845737454, 293.17521183628463, 305.02930335652906, 160.62407212086998, 324.0713248169661, 311.0287232930719, 403.95249706148405, 416.98480993000317, 278.80101250426395, 263.54833964300906, 388.7417986732566, 325.6606605158176, 510.6650869383963, 499.46431069432225, 323.9804340335859, 316.08684687956077, 460.1727457054652, 240.45236349532075, 467.18145714333684, 88.25552014780284, 373.97709285070084, 378.3798973955283, 514.46722218511, 414.1878960544305, 317.14914096562075, 298.4950192858271, 393.2364024326591, 495.36088782791677, 291.09726292325126, 508.3681059002024, 578.9169179642289, 605.8021463512499, 173.43153152834185, 398.57918272966685, 324.12243588240943, 311.2890614067143, 455.25464350858533, 275.54575868771536, 351.27787992560536, 302.9124214942727, 178.32747763620762, 335.9362535178701, 19.575253105599863, 360.1417553513297, 277.39115503580115, 201.93195337775109, 291.5648662694074, 449.34308419919324, 30.886860123179666, 382.55286894751674, 388.7974951966308, 367.59428060339184, 311.4222237012077, 368.75548336245294, 201.53671289397073, 371.2234970504103, 401.46609485659684, 386.6211009295779, 0.0, 308.9294964438394, 391.5784401175012, 592.0409627612586, 244.8415922215278, 255.6294243668893, 267.8205223171572, 295.8051677261363, 466.49194198971355, 354.863499261438, 188.37825211452025, 368.08333661144064, 484.6618994802751, 468.19478837856747, 237.7726963108276, 341.73675400259754, 207.15588913753615, 335.6783969186014, 379.9301925806012, 292.82202389923367, 296.7565259082328, 394.21220005742106, 478.8630837673081, 261.0569328795162, 289.8390509891318, 223.05166251710028, 400.0858834576083, 463.01688470830874, 252.10052314540926, 283.3350163151446, 325.3316080769826, 283.25410101752493, 253.20431533951677, 263.36796667222166, 410.0980847059935, 319.6062492046763, 389.18106081495716, 373.3105419110632, 430.1699312046675, 372.6368158961865, 325.10707139341724, 208.49354741710866, 419.52230073023105, 486.04848434568737, 273.5841539628696, 290.9697294852151, 296.4229275475084, 268.316760273565, 206.33111302854735, 436.75544519641636]}, "sampler_perf": {"mean_raw_obs_processing_ms": 82.37644117652444, "mean_inference_ms": 70.80322735466845, "mean_action_processing_ms": 25.259990946480922, "mean_env_wait_ms": 21.613765172475023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.18369948863983154, "StateBufferConnector_ms": 2.0711151361465454, "ViewRequirementAgentConnector_ms": 5.882716059684753}, "num_episodes": 0, "episode_return_max": 534.9124910748832, "episode_return_min": -246.69216909769693, "episode_return_mean": 114.02761788808293, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2360800, "num_agent_steps_trained": 2360800, "num_env_steps_sampled": 590200, "num_env_steps_trained": 590200, "num_env_steps_sampled_this_iter": 0, "num_env_steps_trained_this_iter": 0, "num_env_steps_sampled_throughput_per_sec": 0.0, "num_env_steps_trained_throughput_per_sec": 0.0, "timesteps_total": 590200, "num_env_steps_sampled_lifetime": 590200, "num_agent_steps_sampled_lifetime": 2360800, "num_steps_trained_this_iter": 0, "agent_timesteps_total": 2360800, "timers": {"training_iteration_time_ms": 220843.079, "restore_workers_time_ms": 16.983, "training_step_time_ms": 220801.351, "sample_time_ms": 36240.281, "learn_time_ms": 209241.434, "learn_throughput": 38.233, "synch_weights_time_ms": 1444.902}, "counters": {"num_env_steps_sampled": 590200, "num_env_steps_trained": 590200, "num_agent_steps_sampled": 2360800, "num_agent_steps_trained": 2360800}, "done": false, "training_iteration": 74, "trial_id": "cdf01_00000", "date": "2024-08-20_13-10-28", "timestamp": 1724139628, "time_this_iter_s": 124.25319194793701, "time_total_s": 9968.545734167099, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e465e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9968.545734167099, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 91.81704545454545, "ram_util_percent": 83.75454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.41429059777941, "cur_kl_coeff": 1.5612511283791268e-18, "cur_lr": 0.00010000000000000003, "total_loss": 8.390300181706747, "policy_loss": -0.003657328730360383, "vf_loss": 8.393957494554066, "vf_explained_var": -0.06958704812186105, "kl": 0.00205463118381799, "entropy": 0.14126674590366228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 254.01904761904763, "num_grad_updates_lifetime": 47005.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.1975269455001465, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.00010000000000000003, "total_loss": 8.541477827798753, "policy_loss": -0.003115531915710086, "vf_loss": 8.54459335735866, "vf_explained_var": 0.30955505444889975, "kl": 0.004207292585892685, "entropy": 0.3257554207103593, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 254.01904761904763, "num_grad_updates_lifetime": 47005.5, "diff_num_grad_updates_vs_sampler_policy": 524.5}}, "num_env_steps_sampled": 603536, "num_env_steps_trained": 603536, "num_agent_steps_sampled": 2414144, "num_agent_steps_trained": 2414144}, "env_runners": {"episode_reward_max": 534.9124910748832, "episode_reward_min": -246.69216909769693, "episode_reward_mean": 98.2583431380977, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -814.4784410320098, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.6996921484765, "predator_policy": 705.0402350247441}, "policy_reward_mean": {"prey_policy": -278.51948538947335, "predator_policy": 327.64865695852217}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.29672918805367, 143.55125720036352, 534.9124910748832, 127.57461863462048, 120.92863043907556, 7.872944006019569, -18.64767319157555, 26.814081588502045, 340.36346263024035, 302.9684044069956, 49.64132478946031, 314.03681274451094, 112.19032222493493, 139.62614995492868, 15.929445596430748, 5.000000000000002, 132.5121799144959, 2.600000000000003, 168.22056538869, -246.69216909769693, 155.0637607966887, -4.850792059621592, 232.8522921664713, 60.603335801420535, 1.2658884799697523, 40.58451094484633, 85.74839622642342, 21.083183132009705, 72.002932646713, 52.19843782871274, -5.0891443280069835, 14.749002422899004, 114.4106134476835, 244.1817105611371, 228.3872258378899, 0.7241799734714851, -12.744417947709884, 85.76128477944368, 42.9084904232702, 23.440019346719495, 9.316625755824056, 153.4899755296097, -77.23790578821091, 56.99622622932905, 36.336821621440635, 6.980804441263183, 75.06855981817694, 351.7707633505748, 164.68632281964685, 34.86967996872277, 144.14212835874636, 70.10000000000004, 121.66700984285596, 346.8285435492214, 116.45713022037495, 193.65323113711764, 0.13949366297020438, 58.307485365565896, -59.21932142292479, 391.9538476312123, 162.16047748492954, -12.109997954282617, 190.59105065490752, -15.07626998049259, 7.8220315906054765, 235.66869360006342, -4.071174012402454, 55.07826718803588, -0.08659501136330316, 228.10076729000824, 173.5038981030951, 6.329191020365116, 170.1512119469935, 188.84429838026998, 162.9919272093347, -32.47391604324915, 179.68871442099712, 208.88939649007298, -23.668393468874093, 17.759036037008283, 44.371852220529604, 245.83507896156988, 4.5844689843677155, 119.41148766222504, 1.0633652641377755, -3.9968028886505635e-15, 79.26096027266249, 8.881784197001252e-16, 171.1772494498907, 105.30604412092262, 7.49999999999999, 255.48674875250077, 119.26141071812862, 146.05974908973968, 254.0592089941348, 128.38114565333007, 28.14773442127954, 218.36941124338907, -6.271995994435949, 34.44986898449051], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-327.89413678119337, -311.98684109441314, -392.4734353461112, -36.735517397906705, -443.8743968597683, 190.6996921484765, 77.75790137384564, -259.1127791830643, -593.3334745741197, -269.35729786556317, -240.86864821550841, -251.72942436688953, -314.840229680241, -267.4331335546273, -437.37786464694983, -357.1634950156989, 185.9731283216092, -402.0712544173301, -139.2110817604106, -510.67720169143695, -229.07032412944542, -300.79780139452043, 159.2456674401612, -388.0431407517875, -393.8608637827251, -166.70103047217506, -504.6003106580821, -46.74226535264394, -434.27018616667334, -289.7203848837198, -289.2390509891317, -218.65166251710036, -272.5801954029655, -458.01039284845535, -249.5005231454094, -283.3350163151446, -338.38363232744877, -101.98151137836854, -331.44482689314214, -431.8196242162904, -521.7546005905288, -52.88597252345165, -377.75788776923986, -389.5845070164021, -134.09370461363875, -435.8607503207445, -414.4102320061953, -58.58705100291024, -417.8971966963399, -486.40769989960876, -258.87427987716467, -265.0950926260732, -303.56594314095776, -175.42534845369136, -387.1461854216478, -234.85718967130634, -470.06962833871984, -406.29425280860727, -345.41270406196236, -18.951944634888896, -285.38685595188394, -348.1669977140716, -245.99503200637656, -358.8981536546028, -332.76594221503, -189.367108415591, 181.0470362857458, -401.83689907091065, -463.2012002819774, -43.97829083295224, -354.5778045370717, -410.3393305621282, -439.8036857687173, -394.8599154525315, -124.87737051997095, -352.7700554722745, -262.726675373697, -302.5721769323389, -264.8848601990646, -455.98981268992185, -349.04858364446727, -305.5628563997802, -152.895956633821, -398.2710687409461, -241.86340903005987, -183.18593490072226, -328.32998236683403, -330.99557299973605, -392.1080615631553, -399.9750960842705, -355.24237020376046, -327.37612248075965, -403.8617283366214, -201.45218083623027, -175.47026234698123, -568.3053972544824, 121.5732618186166, -543.2817875294951, -412.6108253541974, -242.75785627163611, -388.6393425177109, -42.93896332144591, 19.086281349042324, 36.13462309669733, -198.3069639740953, -502.5014042745343, -814.4784410320098, 9.969081602683447, 75.9243801289696, -382.67835698681847, -239.6366118452542, -270.22094297533556, -295.1827157755933, -336.16339385200126, -308.0585136810498, -418.8470760614615, -430.20445111932673, -273.945744512594, 93.01296505665512, -354.89012374878473, 138.47222156495997, -166.20980349506567, -373.97567128339045, -382.7108187008999, -320.6911512768411, -91.1515316371938, -347.10117053525846, -311.7792607330926, -344.9494815071807, -337.1779596680411, 50.41945777990993, -546.296011810513, -278.96055386018736, -282.1238891815285, -437.54818074199494, -409.3091380767575, -315.15840474340183, -291.5321380518651, -305.03905348826646, -115.80838184401429, 168.4999999999998, -392.5112277807638, -280.6159467308891, -278.1817934092652, 76.15931924198624, -408.90203802797936, 17.407676093630627, -599.6088108949016, -370.5398599612311, -213.68834592127416, -378.06390167052865, -279.71685072296674, -363.0170831983962, 133.71134285515012, -290.13199327099426, -466.18578516841075, -357.06543589489627, -371.3439728112537, -312.32112693881, -474.69136701989765, -425.11499141110266, -380.17198869897044, -232.8111749388159, -114.9908019517533, -316.2878678525086, -8.360602876692932, -400.4596535342479, -165.5986223843091, -334.0697633139016, -355.1731577686502, -355.63670729682536, -474.45486981340014, 11.443285351229498, -355.265400274636, -374.1757059692037, -420.9686305372261, -150.93833772375086, -290.1372146503381, -319.88213177351565, -211.19429967400706, -212.6508686086892, -297.82034303664443, -379.0153386273988, -110.05932890047393, -243.50529838440045, -347.3788950654204, -529.1058917891644, -274.0737523441467, -392.2952755018207, -63.25097391908075, 83.86216167841219, -440.4121135723378, -316.45632017900175, 8.781591342032844, -320.0504170151433, -45.47302666339447, -222.4387585253404, -282.2283314387231, -395.69883783996806, -449.2529246538969], "policy_predator_policy_reward": [311.4222237012077, 368.75548336245294, 201.53671289397073, 371.2234970504103, 401.46609485659684, 386.6211009295779, 0.0, 308.9294964438394, 391.5784401175012, 592.0409627612586, 244.8415922215278, 255.6294243668893, 267.8205223171572, 295.8051677261363, 466.49194198971355, 354.863499261438, 188.37825211452025, 368.08333661144064, 484.6618994802751, 468.19478837856747, 237.7726963108276, 341.73675400259754, 207.15588913753615, 335.6783969186014, 379.9301925806012, 292.82202389923367, 296.7565259082328, 394.21220005742106, 478.8630837673081, 261.0569328795162, 289.8390509891318, 223.05166251710028, 400.0858834576083, 463.01688470830874, 252.10052314540926, 283.3350163151446, 325.3316080769826, 283.25410101752493, 253.20431533951677, 263.36796667222166, 410.0980847059935, 319.6062492046763, 389.18106081495716, 373.3105419110632, 430.1699312046675, 372.6368158961865, 325.10707139341724, 208.49354741710866, 419.52230073023105, 486.04848434568737, 273.5841539628696, 290.9697294852151, 296.4229275475084, 268.316760273565, 206.33111302854735, 436.75544519641636, 325.279444068976, 623.0873697250665, 298.1558537896242, 118.40723273593932, 356.02372379939476, 272.4409855385538, 356.21475573577015, 263.4274323481078, 352.1185199367917, 284.42514414151293, 76.95550163614456, 388.01607171015763, 241.63791475681168, 493.92880219600767, 354.3991890833733, 411.2421259892981, 370.9652124077566, 450.95397086578225, 229.41328264093556, 333.9954281307531, 347.759399782167, 260.44794294713836, 269.46913301941294, 474.845559216292, 358.04858364446744, 305.8794821556042, 406.84535285856464, 297.8116480458138, 2.3146955304848595, 345.4967426120868, 368.9721756415444, 347.3496059543552, 356.5720803830854, 471.847898885782, 352.3541481655853, 337.245148960198, 495.77556763672266, 184.6069013543058, 576.771231141711, 518.775191810326, 59.58350648104733, 526.8113420494783, 392.5569884652497, 297.6813731293064, 375.9272043346677, 199.7932298632357, 14.87909555426055, 0.0, 424.9550650110076, 397.52031308047765, 446.2976679538032, 705.0402350247441, 384.1016458241628, 39.10946125406096, 351.7136448846674, 351.7971410730392, 282.0073539290235, 349.47824936154126, 338.9442788332324, 446.26879627484476, 348.5345419936791, 296.39633221531693, 272.96397102214655, 380.86703530119416, 167.9857840791547, 21.912275335880462, 397.4899183533477, 347.0865736766599, 312.74586000339673, 289.68787356554674, 312.2507106038342, 331.55345068402477, 315.1033955532964, 374.8460772125302, 515.6296439876277, 215.91560364303928, 257.9486428220949, 299.0646262072189, 443.1044621854319, 458.8311238213568, 314.09964646870486, 292.5043013151987, 308.2427085817168, 340.70549404057203, 4.803898103095274, 392.7112277807638, 326.74761857875967, 238.3793125817584, 171.60608681443986, 331.28784391854776, 278.07387311830166, 492.9715600632388, 325.5125251671458, 421.70760792469264, 437.9066913177611, 187.40014503248588, 365.71708319839684, 43.277371565847176, 530.4599871670715, 434.74718776241, 354.8754243147398, 349.8655909225361, 487.279142750098, 317.49238724561854, 466.0934087205686, 383.56542361003517, 283.25693031959844, 310.3801255325411, 329.2329397135691, 0.0, 258.98461815636597, 426.4851454244154, 330.2123566919652, 360.09392965472534, 355.63670729682536, 474.45486981340014, 139.74367682463188, 283.33939837143686, 374.1757059692037, 420.9686305372261, 344.25020718101825, 268.002594642961, 340.8522428021423, 295.53023276630176, 219.5508686086888, 298.4203430366444, 346.1715165550971, 398.38989972527474, 369.58663056833785, 340.5589735996116, 386.9984156096186, 562.2409776134341, 355.4941728146941, 354.1112856003432, 44.518983974917745, 440.4121135723378, 302.4664889166785, 33.355974341570125, 287.6698992188462, 296.2229557030814, 237.8264293847252, 260.5686645849017, 456.28323772944196, 423.1183937489136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 82.80380334153628, "mean_inference_ms": 70.74110707696641, "mean_action_processing_ms": 34.79200706118522, "mean_env_wait_ms": 21.679956982486498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.30217576026916504, "StateBufferConnector_ms": 1.4750218391418457, "ViewRequirementAgentConnector_ms": 3.6036312580108643}, "num_episodes": 72, "episode_return_max": 534.9124910748832, "episode_return_min": -246.69216909769693, "episode_return_mean": 98.2583431380977, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2414144, "num_agent_steps_trained": 2414144, "num_env_steps_sampled": 603536, "num_env_steps_trained": 603536, "num_env_steps_sampled_this_iter": 13336, "num_env_steps_trained_this_iter": 13336, "num_env_steps_sampled_throughput_per_sec": 36.830196650934354, "num_env_steps_trained_throughput_per_sec": 36.830196650934354, "timesteps_total": 603536, "num_env_steps_sampled_lifetime": 603536, "num_agent_steps_sampled_lifetime": 2414144, "num_steps_trained_this_iter": 13336, "agent_timesteps_total": 2414144, "timers": {"training_iteration_time_ms": 228911.251, "restore_workers_time_ms": 16.531, "training_step_time_ms": 228868.526, "sample_time_ms": 39929.942, "learn_time_ms": 210174.07, "learn_throughput": 40.603, "synch_weights_time_ms": 1485.945}, "counters": {"num_env_steps_sampled": 603536, "num_env_steps_trained": 603536, "num_agent_steps_sampled": 2414144, "num_agent_steps_trained": 2414144}, "done": false, "training_iteration": 75, "trial_id": "cdf01_00000", "date": "2024-08-20_13-16-42", "timestamp": 1724140002, "time_this_iter_s": 364.5925917625427, "time_total_s": 10333.138325929642, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e5f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10333.138325929642, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 95.88132295719845, "ram_util_percent": 83.57217898832684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.664617693991888, "cur_kl_coeff": 7.806255641895633e-19, "cur_lr": 0.0001, "total_loss": 8.861344891502744, "policy_loss": -0.0034203819167386326, "vf_loss": 8.86476529742044, "vf_explained_var": -0.2882181815684788, "kl": 0.0023190553132504677, "entropy": 0.1301792963629677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 47845.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.070863597355192, "cur_kl_coeff": 7.105427357601001e-16, "cur_lr": 0.0001, "total_loss": 8.794996273706829, "policy_loss": -0.004699718857568408, "vf_loss": 8.799695971655467, "vf_explained_var": 0.3838063637415568, "kl": 0.004171235009158004, "entropy": 0.3380248734402278, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 47845.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 611536, "num_env_steps_trained": 611536, "num_agent_steps_sampled": 2446144, "num_agent_steps_trained": 2446144}, "env_runners": {"episode_reward_max": 391.9538476312123, "episode_reward_min": -246.69216909769693, "episode_reward_mean": 95.4713409466825, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -814.4784410320098, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 185.9731283216092, "predator_policy": 705.0402350247441}, "policy_reward_mean": {"prey_policy": -279.22002314778825, "predator_policy": 326.9556936211295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.36346263024035, 302.9684044069956, 49.64132478946031, 314.03681274451094, 112.19032222493493, 139.62614995492868, 15.929445596430748, 5.000000000000002, 132.5121799144959, 2.600000000000003, 168.22056538869, -246.69216909769693, 155.0637607966887, -4.850792059621592, 232.8522921664713, 60.603335801420535, 1.2658884799697523, 40.58451094484633, 85.74839622642342, 21.083183132009705, 72.002932646713, 52.19843782871274, -5.0891443280069835, 14.749002422899004, 114.4106134476835, 244.1817105611371, 228.3872258378899, 0.7241799734714851, -12.744417947709884, 85.76128477944368, 42.9084904232702, 23.440019346719495, 9.316625755824056, 153.4899755296097, -77.23790578821091, 56.99622622932905, 36.336821621440635, 6.980804441263183, 75.06855981817694, 351.7707633505748, 164.68632281964685, 34.86967996872277, 144.14212835874636, 70.10000000000004, 121.66700984285596, 346.8285435492214, 116.45713022037495, 193.65323113711764, 0.13949366297020438, 58.307485365565896, -59.21932142292479, 391.9538476312123, 162.16047748492954, -12.109997954282617, 190.59105065490752, -15.07626998049259, 7.8220315906054765, 235.66869360006342, -4.071174012402454, 55.07826718803588, -0.08659501136330316, 228.10076729000824, 173.5038981030951, 6.329191020365116, 170.1512119469935, 188.84429838026998, 162.9919272093347, -32.47391604324915, 179.68871442099712, 208.88939649007298, -23.668393468874093, 17.759036037008283, 44.371852220529604, 245.83507896156988, 4.5844689843677155, 119.41148766222504, 1.0633652641377755, -3.9968028886505635e-15, 79.26096027266249, 8.881784197001252e-16, 171.1772494498907, 105.30604412092262, 7.49999999999999, 255.48674875250077, 119.26141071812862, 146.05974908973968, 254.0592089941348, 128.38114565333007, 28.14773442127954, 218.36941124338907, -6.271995994435949, 34.44986898449051, 34.55789517865197, -3.6134680024317802, 166.26098568561892, 156.19085759086477, 69.32175712128561, 85.64189672856773, 130.74728718892752, 65.49564830694034], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [185.9731283216092, -402.0712544173301, -139.2110817604106, -510.67720169143695, -229.07032412944542, -300.79780139452043, 159.2456674401612, -388.0431407517875, -393.8608637827251, -166.70103047217506, -504.6003106580821, -46.74226535264394, -434.27018616667334, -289.7203848837198, -289.2390509891317, -218.65166251710036, -272.5801954029655, -458.01039284845535, -249.5005231454094, -283.3350163151446, -338.38363232744877, -101.98151137836854, -331.44482689314214, -431.8196242162904, -521.7546005905288, -52.88597252345165, -377.75788776923986, -389.5845070164021, -134.09370461363875, -435.8607503207445, -414.4102320061953, -58.58705100291024, -417.8971966963399, -486.40769989960876, -258.87427987716467, -265.0950926260732, -303.56594314095776, -175.42534845369136, -387.1461854216478, -234.85718967130634, -470.06962833871984, -406.29425280860727, -345.41270406196236, -18.951944634888896, -285.38685595188394, -348.1669977140716, -245.99503200637656, -358.8981536546028, -332.76594221503, -189.367108415591, 181.0470362857458, -401.83689907091065, -463.2012002819774, -43.97829083295224, -354.5778045370717, -410.3393305621282, -439.8036857687173, -394.8599154525315, -124.87737051997095, -352.7700554722745, -262.726675373697, -302.5721769323389, -264.8848601990646, -455.98981268992185, -349.04858364446727, -305.5628563997802, -152.895956633821, -398.2710687409461, -241.86340903005987, -183.18593490072226, -328.32998236683403, -330.99557299973605, -392.1080615631553, -399.9750960842705, -355.24237020376046, -327.37612248075965, -403.8617283366214, -201.45218083623027, -175.47026234698123, -568.3053972544824, 121.5732618186166, -543.2817875294951, -412.6108253541974, -242.75785627163611, -388.6393425177109, -42.93896332144591, 19.086281349042324, 36.13462309669733, -198.3069639740953, -502.5014042745343, -814.4784410320098, 9.969081602683447, 75.9243801289696, -382.67835698681847, -239.6366118452542, -270.22094297533556, -295.1827157755933, -336.16339385200126, -308.0585136810498, -418.8470760614615, -430.20445111932673, -273.945744512594, 93.01296505665512, -354.89012374878473, 138.47222156495997, -166.20980349506567, -373.97567128339045, -382.7108187008999, -320.6911512768411, -91.1515316371938, -347.10117053525846, -311.7792607330926, -344.9494815071807, -337.1779596680411, 50.41945777990993, -546.296011810513, -278.96055386018736, -282.1238891815285, -437.54818074199494, -409.3091380767575, -315.15840474340183, -291.5321380518651, -305.03905348826646, -115.80838184401429, 168.4999999999998, -392.5112277807638, -280.6159467308891, -278.1817934092652, 76.15931924198624, -408.90203802797936, 17.407676093630627, -599.6088108949016, -370.5398599612311, -213.68834592127416, -378.06390167052865, -279.71685072296674, -363.0170831983962, 133.71134285515012, -290.13199327099426, -466.18578516841075, -357.06543589489627, -371.3439728112537, -312.32112693881, -474.69136701989765, -425.11499141110266, -380.17198869897044, -232.8111749388159, -114.9908019517533, -316.2878678525086, -8.360602876692932, -400.4596535342479, -165.5986223843091, -334.0697633139016, -355.1731577686502, -355.63670729682536, -474.45486981340014, 11.443285351229498, -355.265400274636, -374.1757059692037, -420.9686305372261, -150.93833772375086, -290.1372146503381, -319.88213177351565, -211.19429967400706, -212.6508686086892, -297.82034303664443, -379.0153386273988, -110.05932890047393, -243.50529838440045, -347.3788950654204, -529.1058917891644, -274.0737523441467, -392.2952755018207, -63.25097391908075, 83.86216167841219, -440.4121135723378, -316.45632017900175, 8.781591342032844, -320.0504170151433, -45.47302666339447, -222.4387585253404, -282.2283314387231, -395.69883783996806, -449.2529246538969, -351.3921991551295, -363.21661776611717, -331.78268961330815, -448.6039174078177, -205.64089162192235, -362.24398352473514, 46.867436003088706, -270.5334913096869, -392.6514250678202, -336.0199892724379, -423.4171761697615, 53.132473702361025, 13.586278764401074, -496.01881937958404, -202.9749465305987, -304.920674373642], "policy_predator_policy_reward": [188.37825211452025, 368.08333661144064, 484.6618994802751, 468.19478837856747, 237.7726963108276, 341.73675400259754, 207.15588913753615, 335.6783969186014, 379.9301925806012, 292.82202389923367, 296.7565259082328, 394.21220005742106, 478.8630837673081, 261.0569328795162, 289.8390509891318, 223.05166251710028, 400.0858834576083, 463.01688470830874, 252.10052314540926, 283.3350163151446, 325.3316080769826, 283.25410101752493, 253.20431533951677, 263.36796667222166, 410.0980847059935, 319.6062492046763, 389.18106081495716, 373.3105419110632, 430.1699312046675, 372.6368158961865, 325.10707139341724, 208.49354741710866, 419.52230073023105, 486.04848434568737, 273.5841539628696, 290.9697294852151, 296.4229275475084, 268.316760273565, 206.33111302854735, 436.75544519641636, 325.279444068976, 623.0873697250665, 298.1558537896242, 118.40723273593932, 356.02372379939476, 272.4409855385538, 356.21475573577015, 263.4274323481078, 352.1185199367917, 284.42514414151293, 76.95550163614456, 388.01607171015763, 241.63791475681168, 493.92880219600767, 354.3991890833733, 411.2421259892981, 370.9652124077566, 450.95397086578225, 229.41328264093556, 333.9954281307531, 347.759399782167, 260.44794294713836, 269.46913301941294, 474.845559216292, 358.04858364446744, 305.8794821556042, 406.84535285856464, 297.8116480458138, 2.3146955304848595, 345.4967426120868, 368.9721756415444, 347.3496059543552, 356.5720803830854, 471.847898885782, 352.3541481655853, 337.245148960198, 495.77556763672266, 184.6069013543058, 576.771231141711, 518.775191810326, 59.58350648104733, 526.8113420494783, 392.5569884652497, 297.6813731293064, 375.9272043346677, 199.7932298632357, 14.87909555426055, 0.0, 424.9550650110076, 397.52031308047765, 446.2976679538032, 705.0402350247441, 384.1016458241628, 39.10946125406096, 351.7136448846674, 351.7971410730392, 282.0073539290235, 349.47824936154126, 338.9442788332324, 446.26879627484476, 348.5345419936791, 296.39633221531693, 272.96397102214655, 380.86703530119416, 167.9857840791547, 21.912275335880462, 397.4899183533477, 347.0865736766599, 312.74586000339673, 289.68787356554674, 312.2507106038342, 331.55345068402477, 315.1033955532964, 374.8460772125302, 515.6296439876277, 215.91560364303928, 257.9486428220949, 299.0646262072189, 443.1044621854319, 458.8311238213568, 314.09964646870486, 292.5043013151987, 308.2427085817168, 340.70549404057203, 4.803898103095274, 392.7112277807638, 326.74761857875967, 238.3793125817584, 171.60608681443986, 331.28784391854776, 278.07387311830166, 492.9715600632388, 325.5125251671458, 421.70760792469264, 437.9066913177611, 187.40014503248588, 365.71708319839684, 43.277371565847176, 530.4599871670715, 434.74718776241, 354.8754243147398, 349.8655909225361, 487.279142750098, 317.49238724561854, 466.0934087205686, 383.56542361003517, 283.25693031959844, 310.3801255325411, 329.2329397135691, 0.0, 258.98461815636597, 426.4851454244154, 330.2123566919652, 360.09392965472534, 355.63670729682536, 474.45486981340014, 139.74367682463188, 283.33939837143686, 374.1757059692037, 420.9686305372261, 344.25020718101825, 268.002594642961, 340.8522428021423, 295.53023276630176, 219.5508686086888, 298.4203430366444, 346.1715165550971, 398.38989972527474, 369.58663056833785, 340.5589735996116, 386.9984156096186, 562.2409776134341, 355.4941728146941, 354.1112856003432, 44.518983974917745, 440.4121135723378, 302.4664889166785, 33.355974341570125, 287.6698992188462, 296.2229557030814, 237.8264293847252, 260.5686645849017, 456.28323772944196, 423.1183937489136, 358.22957327456, 390.93713882533945, 334.4754712311105, 442.2976677875842, 358.3918387617427, 375.7540220705342, 21.580966191164173, 358.2759467063002, 467.32905843469865, 330.664113026846, 36.81386709834436, 419.112732097624, 117.40811215972495, 495.7717156443858, 298.8840357492891, 274.50723346189113]}, "sampler_perf": {"mean_raw_obs_processing_ms": 82.62708913381411, "mean_inference_ms": 70.8392005868629, "mean_action_processing_ms": 35.75319094846931, "mean_env_wait_ms": 21.575148093689876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.2881896495819092, "StateBufferConnector_ms": 1.3479899168014526, "ViewRequirementAgentConnector_ms": 3.335655689239502}, "num_episodes": 8, "episode_return_max": 391.9538476312123, "episode_return_min": -246.69216909769693, "episode_return_mean": 95.4713409466825, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2446144, "num_agent_steps_trained": 2446144, "num_env_steps_sampled": 611536, "num_env_steps_trained": 611536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 38.8794687862543, "num_env_steps_trained_throughput_per_sec": 38.8794687862543, "timesteps_total": 611536, "num_env_steps_sampled_lifetime": 611536, "num_agent_steps_sampled_lifetime": 2446144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2446144, "timers": {"training_iteration_time_ms": 225957.568, "restore_workers_time_ms": 17.424, "training_step_time_ms": 225913.435, "sample_time_ms": 40690.193, "learn_time_ms": 206633.73, "learn_throughput": 41.298, "synch_weights_time_ms": 1197.88}, "counters": {"num_env_steps_sampled": 611536, "num_env_steps_trained": 611536, "num_agent_steps_sampled": 2446144, "num_agent_steps_trained": 2446144}, "done": false, "training_iteration": 76, "trial_id": "cdf01_00000", "date": "2024-08-20_13-20-12", "timestamp": 1724140212, "time_this_iter_s": 207.45897507667542, "time_total_s": 10540.597301006317, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a53b6700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10540.597301006317, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 97.04982698961938, "ram_util_percent": 83.59550173010382}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.835430138451713, "cur_kl_coeff": 3.9031278209478165e-19, "cur_lr": 0.0001, "total_loss": Infinity, "policy_loss": -0.004293224058069644, "vf_loss": 8.587014292156885, "vf_explained_var": -0.21747598780526056, "kl": Infinity, "entropy": 0.1253504429899511, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 48475.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.920032466214801, "cur_kl_coeff": 3.5527136788005006e-16, "cur_lr": 0.0001, "total_loss": 8.651722192764282, "policy_loss": -0.004233892120066143, "vf_loss": 8.655956056382921, "vf_explained_var": 0.3317477278293125, "kl": 0.0031260243782800525, "entropy": 0.30152084808500984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 48475.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 619536, "num_env_steps_trained": 619536, "num_agent_steps_sampled": 2478144, "num_agent_steps_trained": 2478144}, "env_runners": {"episode_reward_max": 514.5834783803426, "episode_reward_min": -232.014685528181, "episode_reward_mean": 92.8008164754496, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -603.0251026104851, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.4, "predator_policy": 603.0251026104851}, "policy_reward_mean": {"prey_policy": -282.866382543241, "predator_policy": 329.2667907809659}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.1512119469935, 188.84429838026998, 162.9919272093347, -32.47391604324915, 179.68871442099712, 208.88939649007298, -23.668393468874093, 17.759036037008283, 44.371852220529604, 245.83507896156988, 4.5844689843677155, 119.41148766222504, 1.0633652641377755, -3.9968028886505635e-15, 79.26096027266249, 8.881784197001252e-16, 171.1772494498907, 105.30604412092262, 7.49999999999999, 255.48674875250077, 119.26141071812862, 146.05974908973968, 254.0592089941348, 128.38114565333007, 28.14773442127954, 218.36941124338907, -6.271995994435949, 34.44986898449051, 34.55789517865197, -3.6134680024317802, 166.26098568561892, 156.19085759086477, 69.32175712128561, 85.64189672856773, 130.74728718892752, 65.49564830694034, -45.413548301858185, 244.65421613055747, 231.7382432317468, 11.099999999999975, 20.38089186098134, 55.15341840661239, 210.87418880026493, 4.800000000000001, 110.31336335724245, 0.03013136092993518, 4.0383453411319366, 2.2000000000000033, 167.2205189101051, 282.24853020373564, 185.11487296319106, -61.51023386533251, 185.0222460824595, 221.66801867714702, 64.58537110036556, 62.545200676350305, -43.59305554012659, 58.41875382258222, 237.27388652321414, 118.80209000026264, 55.300000000000225, 37.033549286392834, 17.199999999999942, 514.5834783803426, 202.25309215623037, 7.3451490735797496, 205.62358099733524, -232.014685528181, 176.02623677432604, 51.868068001403, 123.8791331359813, -7.888082606446286, 246.46473590791567, 80.01082477235578, -4.440892098500626e-16, 222.67966304268077, 228.07950750539845, 1.5758233108850312, 11.358494187112013, 68.84348853299548, 4.753818789602415, 1.937302557914197, 6.661338147750939e-16, 13.31786590380406, 198.59033942958933, 225.9798812895053, 1.834150817159271, -15.764673166044753, 433.94215565099523, 75.1778435124027, -59.10822120158467, 6.3541076141709, 129.48964718014977, 5.099999999999999, 77.2287505750307, -11.400076128073975, 161.60244336378767, 47.30618328399167, 23.721026534834188, 88.89267129601063], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [76.15931924198624, -408.90203802797936, 17.407676093630627, -599.6088108949016, -370.5398599612311, -213.68834592127416, -378.06390167052865, -279.71685072296674, -363.0170831983962, 133.71134285515012, -290.13199327099426, -466.18578516841075, -357.06543589489627, -371.3439728112537, -312.32112693881, -474.69136701989765, -425.11499141110266, -380.17198869897044, -232.8111749388159, -114.9908019517533, -316.2878678525086, -8.360602876692932, -400.4596535342479, -165.5986223843091, -334.0697633139016, -355.1731577686502, -355.63670729682536, -474.45486981340014, 11.443285351229498, -355.265400274636, -374.1757059692037, -420.9686305372261, -150.93833772375086, -290.1372146503381, -319.88213177351565, -211.19429967400706, -212.6508686086892, -297.82034303664443, -379.0153386273988, -110.05932890047393, -243.50529838440045, -347.3788950654204, -529.1058917891644, -274.0737523441467, -392.2952755018207, -63.25097391908075, 83.86216167841219, -440.4121135723378, -316.45632017900175, 8.781591342032844, -320.0504170151433, -45.47302666339447, -222.4387585253404, -282.2283314387231, -395.69883783996806, -449.2529246538969, -351.3921991551295, -363.21661776611717, -331.78268961330815, -448.6039174078177, -205.64089162192235, -362.24398352473514, 46.867436003088706, -270.5334913096869, -392.6514250678202, -336.0199892724379, -423.4171761697615, 53.132473702361025, 13.586278764401074, -496.01881937958404, -202.9749465305987, -304.920674373642, -261.4259953262905, -531.7422364598924, -192.90716148780706, -475.5019489797118, -37.80172448026646, -362.7218059381015, -325.19605239601947, -312.5945926344913, -19.96638589223746, -286.9501994317589, -278.2222884035379, -493.18519098803773, -467.917089295721, 164.86499740358644, -255.18596815827735, -290.3018312560538, -246.20518779693663, -407.9791219281206, -332.57962339602506, -519.3998164135394, -445.21263162751757, -404.67431622053573, -309.9819561699916, -515.8294269313226, -344.4829500946304, -34.601381006220564, -389.1344993915179, -139.58994786236772, -279.3350974890832, -213.85479203334415, -162.5975552453084, -438.32885729228644, -115.97201560576751, -368.6605847523247, -463.2879503505498, 155.33923673480723, -392.5470104192553, -120.82701866862865, -94.25827482044676, -437.1348512665494, -275.3966239423555, -315.47156001128116, -360.80724608855644, -165.0113246425423, -225.57567417778031, -243.7799299731548, -346.7188681155633, -35.98840114208721, 15.058784058637656, -276.53218010642206, -273.79061330473866, -325.31124409124754, -12.548604878563687, -311.33517725490316, -453.1580006595679, 190.9711545459182, -114.99087246283057, -355.28334286063273, -367.64187327516777, -351.1882374315765, -477.5499916084709, -220.65919844524927, -345.5469220300722, -522.9112718131088, -80.82457215313556, -425.9152544323129, -33.27935700103124, -303.04863822242, -306.4272450218989, -415.32187094036414, -544.6905874273358, -364.92358575748545, -116.73796194354404, -564.911434879682, -75.51140731396667, -243.96089499980906, -345.85173248210344, -484.32806690534824, -336.85755009441414, -73.53000186931527, -477.45785201339254, -136.9979513209881, -269.80766481405254, -241.90512549277597, -136.50938854456206, -418.6619470828366, -143.37352084361478, -301.75393986057077, -373.34551601993974, -363.41185483801576, -421.21648757596626, -267.0913106623417, -499.51956854847776, -603.0251026104851, -351.61135829819654, -441.4372550160133, -366.84411812299896, 177.50210258627354, -36.839149080144075, -409.92663963397735, -341.8464285697483, -342.9191524242917, -343.41113487448297, -321.84318454809835, 196.4, -281.42358617438094, -177.80625431581154, -181.8539356939101, -333.1386983313896, -375.44273491234065, -287.6474910853206, -300.6744525371954, -506.94458287872845, -25.652198238455874, -256.3523785692506, -210.60357469720492, -529.6184967758661, -375.2219986380752, -280.7039990780221, -304.82026293213863, -142.36079304739195, -360.4721253512013, -287.79794695727503, -354.9838983458044, -265.39779766903985, -421.23421800618775, -284.1140083431867, -520.378596762045], "policy_predator_policy_reward": [171.60608681443986, 331.28784391854776, 278.07387311830166, 492.9715600632388, 325.5125251671458, 421.70760792469264, 437.9066913177611, 187.40014503248588, 365.71708319839684, 43.277371565847176, 530.4599871670715, 434.74718776241, 354.8754243147398, 349.8655909225361, 487.279142750098, 317.49238724561854, 466.0934087205686, 383.56542361003517, 283.25693031959844, 310.3801255325411, 329.2329397135691, 0.0, 258.98461815636597, 426.4851454244154, 330.2123566919652, 360.09392965472534, 355.63670729682536, 474.45486981340014, 139.74367682463188, 283.33939837143686, 374.1757059692037, 420.9686305372261, 344.25020718101825, 268.002594642961, 340.8522428021423, 295.53023276630176, 219.5508686086888, 298.4203430366444, 346.1715165550971, 398.38989972527474, 369.58663056833785, 340.5589735996116, 386.9984156096186, 562.2409776134341, 355.4941728146941, 354.1112856003432, 44.518983974917745, 440.4121135723378, 302.4664889166785, 33.355974341570125, 287.6698992188462, 296.2229557030814, 237.8264293847252, 260.5686645849017, 456.28323772944196, 423.1183937489136, 358.22957327456, 390.93713882533945, 334.4754712311105, 442.2976677875842, 358.3918387617427, 375.7540220705342, 21.580966191164173, 358.2759467063002, 467.32905843469865, 330.664113026846, 36.81386709834436, 419.112732097624, 117.40811215972495, 495.7717156443858, 298.8840357492891, 274.50723346189113, 209.24318199128965, 538.5115014930358, 564.4647812173345, 348.5985453807415, 281.1863743473495, 351.07539930276613, 327.99605239601925, 320.89459263449316, 313.75923578092005, 13.538241404058327, 339.2233569261804, 487.3375408720083, 54.26452238738043, 459.661758305019, 257.5859681582772, 292.70183125605365, 358.9349866020136, 405.56268648028487, 332.94034648571966, 519.0692246847747, 448.8288493930368, 405.09644379614844, 309.9819561699916, 518.0294269313226, 172.99558602562317, 373.3092639853344, 405.38615975488614, 405.58681770273404, 326.4277842295652, 351.87697825605346, 453.7052300554218, 85.71094861684125, 330.71467685071883, 338.94016958983264, 73.20444374640591, 456.4122885464838, 361.99974390153477, 215.95965628671482, 394.11544601159, 199.8228807517563, 181.96312461051076, 365.3120038029996, 322.6416962889525, 261.5956282647277, 326.7391330016421, 379.8903576725075, 128.0581336126004, 373.4512256453129, 38.241215941362526, 278.53218010642206, 265.40609632740063, 370.729310354978, 29.748604878563686, 311.33517725490316, 399.4090392130348, 377.3612852809574, 342.5490141626657, 329.97829331702803, 375.2552992293968, 350.9199605509271, 414.1080274604015, 489.72474359065325, 45.823470283178715, 590.6200380318246, 263.109384928422, 419.6566784313532, 82.8474250024342, 305.3486382224205, 469.12251599659805, 376.5057331016496, 525.2644072939494, 376.46168328442576, 389.8564032155674, 538.2577295155737, 136.27854154916807, 263.20458553696284, 345.85173248210344, 484.32806690534824, 319.8034878004129, 313.26372720599767, 399.08435217518604, 443.45095866459246, 258.0605316889942, 255.2280819287191, 148.95801309782382, 417.5718167166869, 303.69582508993267, 210.27512414724774, 378.0993348095421, 363.41185483801576, 422.03802805245834, 268.2070727437636, 499.51956854847776, 603.0251026104851, 350.13209568602457, 456.23438353199, 25.39999916198986, 362.532355804325, 268.9196892698807, 403.82598073374515, 343.85222724153004, 342.74750456966916, 347.4651284660522, 302.02451779048374, 274.43918478366595, 244.52655704171053, 134.56913495591695, 300.26889856620744, 362.54281736966107, 286.93039467248406, 285.6015986994913, 309.0744525371952, 425.9076421955712, 236.17878610176473, 257.75237856925054, 214.3035746972047, 430.84691665006466, 551.2223293389079, 205.07298491889998, 369.05120096318575, 349.7965371365716, 314.6388246258089, 353.27902312919355, 336.80900545787784, 289.1675726278836, 421.18546958217917, 309.8795470627922, 583.5057293384524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 82.83488285045458, "mean_inference_ms": 70.22912370948401, "mean_action_processing_ms": 38.16306886232198, "mean_env_wait_ms": 21.64436931127234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5902936458587646, "StateBufferConnector_ms": 2.2343637943267822, "ViewRequirementAgentConnector_ms": 4.412975788116455}, "num_episodes": 64, "episode_return_max": 514.5834783803426, "episode_return_min": -232.014685528181, "episode_return_mean": 92.8008164754496, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2478144, "num_agent_steps_trained": 2478144, "num_env_steps_sampled": 619536, "num_env_steps_trained": 619536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 23.663092273565713, "num_env_steps_trained_throughput_per_sec": 23.663092273565713, "timesteps_total": 619536, "num_env_steps_sampled_lifetime": 619536, "num_agent_steps_sampled_lifetime": 2478144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2478144, "timers": {"training_iteration_time_ms": 229511.446, "restore_workers_time_ms": 17.452, "training_step_time_ms": 229458.732, "sample_time_ms": 39308.251, "learn_time_ms": 213064.369, "learn_throughput": 40.052, "synch_weights_time_ms": 2457.91}, "counters": {"num_env_steps_sampled": 619536, "num_env_steps_trained": 619536, "num_agent_steps_sampled": 2478144, "num_agent_steps_trained": 2478144}, "done": false, "training_iteration": 77, "trial_id": "cdf01_00000", "date": "2024-08-20_13-26-10", "timestamp": 1724140570, "time_this_iter_s": 355.81513381004333, "time_total_s": 10896.41243481636, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e63430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10896.41243481636, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 77.21558441558442, "ram_util_percent": 85.4396103896104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.828453823876758, "cur_kl_coeff": 5.854691731421723e-19, "cur_lr": 0.0001, "total_loss": 8.593623672969757, "policy_loss": -0.0036381422726821807, "vf_loss": 8.597261830738612, "vf_explained_var": -0.052545444170633955, "kl": 0.002676216587872926, "entropy": 0.12545151536663374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 49105.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.530280504150996, "cur_kl_coeff": 1.7763568394002503e-16, "cur_lr": 0.0001, "total_loss": 8.680303251932537, "policy_loss": -0.002961422950177202, "vf_loss": 8.683264662727478, "vf_explained_var": 0.4537687319611746, "kl": 0.002403203288211097, "entropy": 0.3619202549022342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 49105.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 627536, "num_env_steps_trained": 627536, "num_agent_steps_sampled": 2510144, "num_agent_steps_trained": 2510144}, "env_runners": {"episode_reward_max": 497.93977578783654, "episode_reward_min": -76.57334626297097, "episode_reward_mean": 97.27279271976751, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -607.5343597058479, "predator_policy": 1.5755271633186618}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 603.0251026104851}, "policy_reward_mean": {"prey_policy": -292.28433192394806, "predator_policy": 340.9207282838319}, "custom_metrics": {}, "hist_stats": {"episode_reward": [246.46473590791567, 80.01082477235578, -4.440892098500626e-16, 222.67966304268077, 228.07950750539845, 1.5758233108850312, 11.358494187112013, 68.84348853299548, 4.753818789602415, 1.937302557914197, 6.661338147750939e-16, 13.31786590380406, 198.59033942958933, 225.9798812895053, 1.834150817159271, -15.764673166044753, 433.94215565099523, 75.1778435124027, -59.10822120158467, 6.3541076141709, 129.48964718014977, 5.099999999999999, 77.2287505750307, -11.400076128073975, 161.60244336378767, 47.30618328399167, 23.721026534834188, 88.89267129601063, 35.87835164146763, 9.687909848935243, 30.767989948280057, 83.89463719630137, 0.8197716708877414, 121.95178994737026, 31.1533375510314, 115.26270309892202, 28.845486155885013, 101.39064972626201, 69.68443895059963, 10.630295567386296, 86.94693861307296, -1.488429229969935, -0.14369554350962455, 438.22613427885176, 117.65232919522218, 76.32804423310532, 279.0330394800327, 2.400000000000002, 95.8879087383421, 248.90403608747937, 206.55123033794735, 143.08315727479356, 383.5415267485519, 0.7000000000000048, 18.299999999999994, 318.30358888084146, 6.823646233706681, 0.2808288658283271, 52.348832382808155, 311.5782291338083, 4.5, 28.088491859906615, 58.65769623840286, 45.65964700610266, 407.7384358689933, -28.07605046576568, 4.655372283818227, 126.53223412896534, 2.2967638283616036, 141.44494393288065, 186.59999999999997, 121.15252929662216, 97.20170112349159, 3.8765673096196815, 187.6003584804432, 166.40269384599353, 198.4838834764831, 358.82096718120533, 28.413895193069727, 345.8818287016185, 497.93977578783654, 46.831578086423875, 89.02489536258683, 6.531376613944051, 28.57820269389307, -76.57334626297097, 185.71076301784245, 0.6999999999999942, 79.81256361533039, 20.290581174408324, 8.299999999999999, 83.10418939620878, 71.9854872501063, 236.0883067955201, 23.54598874487297, 39.048589949752035, -1.1102230246251565e-15, 27.586589350146905, 188.0625706048989, -8.413261071090355], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-116.73796194354404, -564.911434879682, -75.51140731396667, -243.96089499980906, -345.85173248210344, -484.32806690534824, -336.85755009441414, -73.53000186931527, -477.45785201339254, -136.9979513209881, -269.80766481405254, -241.90512549277597, -136.50938854456206, -418.6619470828366, -143.37352084361478, -301.75393986057077, -373.34551601993974, -363.41185483801576, -421.21648757596626, -267.0913106623417, -499.51956854847776, -603.0251026104851, -351.61135829819654, -441.4372550160133, -366.84411812299896, 177.50210258627354, -36.839149080144075, -409.92663963397735, -341.8464285697483, -342.9191524242917, -343.41113487448297, -321.84318454809835, 196.4, -281.42358617438094, -177.80625431581154, -181.8539356939101, -333.1386983313896, -375.44273491234065, -287.6474910853206, -300.6744525371954, -506.94458287872845, -25.652198238455874, -256.3523785692506, -210.60357469720492, -529.6184967758661, -375.2219986380752, -280.7039990780221, -304.82026293213863, -142.36079304739195, -360.4721253512013, -287.79794695727503, -354.9838983458044, -265.39779766903985, -421.23421800618775, -284.1140083431867, -520.378596762045, -264.5179570524967, -349.19799331517487, -230.72673146028419, -531.4175312734125, -424.6497071531355, -230.1501507810915, -50.17788913912194, -404.0183588956378, -322.3365813799949, -267.12357308059524, -484.12392045926595, -233.89405571383006, -199.1649712471202, -371.84365668349045, -289.69701109446834, -470.8024607907443, -286.2800155058502, 1.4209337149262737, -245.96755157195236, -327.0095785215907, -373.6279886879325, -445.6257137904474, -424.683407691564, -355.33521408044464, -421.94523398341215, -299.748201585166, -473.80270320502126, -380.4483192208968, -453.0426864023007, -283.192406534266, 188.15187213962162, -351.7145746380708, -408.0610958114572, -196.23189291688803, -275.0496885780322, -203.20601293339615, -357.3395917395517, 23.470608805771306, -314.54510214336506, -274.0340726368916, -372.7445526973543, -287.2203022321888, -41.58092219523823, -345.1780850263371, 200.0, -436.0632402234781, -325.5531193283132, -403.7231904639846, -42.802804882863434, -483.18827615082677, -469.0248665438766, -340.45705658366575, 3.086431852439298, -393.3792480972022, -42.26366446660893, -261.1013696807687, -344.2211517848154, -287.7745120009344, -334.16698180377244, -332.0214365567988, -357.2962554052204, -340.0975831513903, -354.5335165217027, 188.4957747694139, -276.67090518104646, -299.65727978032766, -266.3982293552934, -241.32183194565872, -501.42630018320494, -227.07161048349334, -403.40033560707815, -341.7634640703806, -607.5343597058479, 179.37724214384608, -508.87604977204114, -456.69745761210334, -307.91000216961606, -327.0852032510593, 32.402697640585224, -575.0725618398095, -309.09156395685636, -524.7478554398588, -462.3584005175483, -260.63618463823815, -307.37466846363304, 184.72447283668134, -376.94962653864064, -328.10350652860956, -496.1509675674128, -131.73847059372392, -488.9174527922543, -421.5485791465136, -257.28608244508484, -126.57839584150182, -332.4072032836378, -168.27571571997245, -256.38636549694615, 189.0387063855106, 48.10675052544025, -383.5262386018099, -329.7952134399174, -163.106568525189, -360.049298214222, 68.49706918694802, -397.6966188020609, 129.40801193610244, -510.47066310117015, -279.80739049692414, -305.53099527886866, -303.2864886260385, -258.8065267580339, -579.1679529760112, -197.18414209163893, -374.69797312989857, -357.05469127560195, -336.9561467776802, -297.7953187691413, -183.6693178856547, -514.0738076890351, -343.11338176677975, -555.857991485535, -0.40953897860655775, -278.68964350059775, -326.37719444211655, -356.58737919809903, -205.11516312980226, -271.0307723625716, -405.57594330378083, -324.35326060340344, -391.6044802916489, -194.20405692288432, -210.69222768925883, -349.6650206487333, -187.35881185908787, -442.7554560875223, -417.92058064058796, -469.40694945638006, -354.4667977750884, -300.6035310873695, -25.23756763815569, -404.61544493148216, -217.7134427782045, -380.9863660752849, -344.281606173825], "policy_predator_policy_reward": [389.8564032155674, 538.2577295155737, 136.27854154916807, 263.20458553696284, 345.85173248210344, 484.32806690534824, 319.8034878004129, 313.26372720599767, 399.08435217518604, 443.45095866459246, 258.0605316889942, 255.2280819287191, 148.95801309782382, 417.5718167166869, 303.69582508993267, 210.27512414724774, 378.0993348095421, 363.41185483801576, 422.03802805245834, 268.2070727437636, 499.51956854847776, 603.0251026104851, 350.13209568602457, 456.23438353199, 25.39999916198986, 362.532355804325, 268.9196892698807, 403.82598073374515, 343.85222724153004, 342.74750456966916, 347.4651284660522, 302.02451779048374, 274.43918478366595, 244.52655704171053, 134.56913495591695, 300.26889856620744, 362.54281736966107, 286.93039467248406, 285.6015986994913, 309.0744525371952, 425.9076421955712, 236.17878610176473, 257.75237856925054, 214.3035746972047, 430.84691665006466, 551.2223293389079, 205.07298491889998, 369.05120096318575, 349.7965371365716, 314.6388246258089, 353.27902312919355, 336.80900545787784, 289.1675726278836, 421.18546958217917, 309.8795470627922, 583.5057293384524, 308.5216117389621, 341.072690270177, 457.82439497985797, 314.0077776027736, 410.60416811460607, 274.9636797679011, 401.7511321505565, 136.33975308050535, 322.5365813799949, 267.7433447514829, 426.1715250867266, 413.7982410337397, 326.2135902074782, 275.9483752741636, 508.9972451379321, 366.7649298462043, 288.8800155058503, 24.824552440958726, 368.80612269279305, 305.56165712701113, 410.48018953287055, 478.45795189610914, 498.18353938424116, 292.4653779551536, 507.598360906534, 301.04201327511817, 478.4264776386725, 374.33611555727566, 453.11873142068225, 282.97266597237484, 265.9743103363755, 335.8145264409254, 385.3130340295211, 336.6322838940469, 269.48561336734736, 285.09813237718646, 335.80636316647656, 277.095659247337, 314.54510214336506, 276.43407263689147, 445.2100205569149, 310.64274311097114, 331.67238558981285, 303.9906577192426, 6.551230337947329, 436.0632402234781, 502.77041738134636, 369.5890496857466, 445.9566341350334, 463.5759736472075, 469.0248665438766, 341.15705658366574, 15.213568147560666, 393.3792480972022, 355.0398433189973, 266.62877970922233, 346.9890169895772, 291.83029302988075, 334.4478106696008, 332.0214365567988, 377.06548829600445, 372.67718264341494, 351.0857844395911, 126.5301864465063, 278.67090518104635, 302.1572797803275, 292.98971057186833, 242.81884258899083, 457.5625918546141, 329.5930150504867, 387.4797420474906, 403.3437046360702, 360.50940548467344, 475.38614794632235, 485.5766021034421, 451.92085481493723, 311.10028525983927, 328.55029244465493, 126.47786525307721, 542.7242330751122, 311.38832778521777, 524.7478554398588, 400.1276194785889, 464.3119096100793, 307.6746684636331, 1.5755271633186618, 346.3528533752314, 479.85280898864124, 417.831689633216, 307.25944965141235, 492.794020101874, 421.5485791465136, 285.66759124403, 285.79724552299905, 299.6710446140027, 367.4145682356025, 259.88636549694604, 5.945177090972564, 348.9114996900405, 345.3289555675336, 219.89638092601265, 301.41929623216345, 273.36675307553287, 364.06730465335926, 403.91975544452015, 362.30862720927513, 290.91973990408644, 546.189891780431, 350.8521542947411, 346.99022497275337, 265.33790337197894, 579.1679529760112, 234.39729684945854, 366.0630210659713, 226.56786057146553, 390.86963121884673, 316.04656458041467, 351.12883509222485, 514.0738076890351, 343.8133817667797, 499.67257867961627, 136.40751539985567, 289.63398071188806, 335.7234384052341, 357.8873791980993, 212.11516312980186, 380.0471138155651, 379.66379124699574, 405.9002295850757, 382.04299856008237, 337.53004558994, 303.4545458177225, 375.5129867512422, 185.0568345014514, 438.5320042472627, 461.1926224306001, 469.40694945638006, 354.4667977750884, 324.1121775837583, 29.3155104919139, 452.2045066465993, 358.18695166798636, 390.40824361323524, 326.44646756478517]}, "sampler_perf": {"mean_raw_obs_processing_ms": 83.56442427500723, "mean_inference_ms": 70.88716563167867, "mean_action_processing_ms": 37.7903929227151, "mean_env_wait_ms": 21.70995400646089, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5504060983657837, "StateBufferConnector_ms": 10.682928323745728, "ViewRequirementAgentConnector_ms": 8.368835091590881}, "num_episodes": 72, "episode_return_max": 497.93977578783654, "episode_return_min": -76.57334626297097, "episode_return_mean": 97.27279271976751, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2510144, "num_agent_steps_trained": 2510144, "num_env_steps_sampled": 627536, "num_env_steps_trained": 627536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 42.4419063047924, "num_env_steps_trained_throughput_per_sec": 42.4419063047924, "timesteps_total": 627536, "num_env_steps_sampled_lifetime": 627536, "num_agent_steps_sampled_lifetime": 2510144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2510144, "timers": {"training_iteration_time_ms": 221461.537, "restore_workers_time_ms": 54.737, "training_step_time_ms": 221307.269, "sample_time_ms": 42101.25, "learn_time_ms": 197098.643, "learn_throughput": 43.296, "synch_weights_time_ms": 4451.313}, "counters": {"num_env_steps_sampled": 627536, "num_env_steps_trained": 627536, "num_agent_steps_sampled": 2510144, "num_agent_steps_trained": 2510144}, "done": false, "training_iteration": 78, "trial_id": "cdf01_00000", "date": "2024-08-20_13-30-18", "timestamp": 1724140818, "time_this_iter_s": 219.5699179172516, "time_total_s": 11115.982352733612, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a53b6820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11115.982352733612, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 45.1816199376947, "ram_util_percent": 84.8417445482866}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.474667157256414, "cur_kl_coeff": 2.9273458657108617e-19, "cur_lr": 0.0001, "total_loss": 9.23026851926531, "policy_loss": -0.003876808952421896, "vf_loss": 9.234145311325316, "vf_explained_var": -0.3887442436483171, "kl": 0.0019132414515283132, "entropy": 0.10527938492004833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 49735.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.156186792017921, "cur_kl_coeff": 8.881784197001252e-17, "cur_lr": 0.0001, "total_loss": 8.925018905457996, "policy_loss": -0.004294174776176021, "vf_loss": 8.929313105628603, "vf_explained_var": 0.3712272667695606, "kl": 0.0035071987473952863, "entropy": 0.3072470099443481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 49735.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 635536, "num_env_steps_trained": 635536, "num_agent_steps_sampled": 2542144, "num_agent_steps_trained": 2542144}, "env_runners": {"episode_reward_max": 497.93977578783654, "episode_reward_min": -76.57334626297097, "episode_reward_mean": 102.72372238744514, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -607.5343597058479, "predator_policy": 1.5755271633186618}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 603.0251026104851}, "policy_reward_mean": {"prey_policy": -290.7514801374575, "predator_policy": 342.11334133118015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.753818789602415, 1.937302557914197, 6.661338147750939e-16, 13.31786590380406, 198.59033942958933, 225.9798812895053, 1.834150817159271, -15.764673166044753, 433.94215565099523, 75.1778435124027, -59.10822120158467, 6.3541076141709, 129.48964718014977, 5.099999999999999, 77.2287505750307, -11.400076128073975, 161.60244336378767, 47.30618328399167, 23.721026534834188, 88.89267129601063, 35.87835164146763, 9.687909848935243, 30.767989948280057, 83.89463719630137, 0.8197716708877414, 121.95178994737026, 31.1533375510314, 115.26270309892202, 28.845486155885013, 101.39064972626201, 69.68443895059963, 10.630295567386296, 86.94693861307296, -1.488429229969935, -0.14369554350962455, 438.22613427885176, 117.65232919522218, 76.32804423310532, 279.0330394800327, 2.400000000000002, 95.8879087383421, 248.90403608747937, 206.55123033794735, 143.08315727479356, 383.5415267485519, 0.7000000000000048, 18.299999999999994, 318.30358888084146, 6.823646233706681, 0.2808288658283271, 52.348832382808155, 311.5782291338083, 4.5, 28.088491859906615, 58.65769623840286, 45.65964700610266, 407.7384358689933, -28.07605046576568, 4.655372283818227, 126.53223412896534, 2.2967638283616036, 141.44494393288065, 186.59999999999997, 121.15252929662216, 97.20170112349159, 3.8765673096196815, 187.6003584804432, 166.40269384599353, 198.4838834764831, 358.82096718120533, 28.413895193069727, 345.8818287016185, 497.93977578783654, 46.831578086423875, 89.02489536258683, 6.531376613944051, 28.57820269389307, -76.57334626297097, 185.71076301784245, 0.6999999999999942, 79.81256361533039, 20.290581174408324, 8.299999999999999, 83.10418939620878, 71.9854872501063, 236.0883067955201, 23.54598874487297, 39.048589949752035, -1.1102230246251565e-15, 27.586589350146905, 188.0625706048989, -8.413261071090355, 0.016581175159881667, 155.96880953597375, 344.79802564420487, 438.57553418746085, 91.32952997066779, 20.663847635291894, 265.40908204967366, 87.34409382867366], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-373.34551601993974, -363.41185483801576, -421.21648757596626, -267.0913106623417, -499.51956854847776, -603.0251026104851, -351.61135829819654, -441.4372550160133, -366.84411812299896, 177.50210258627354, -36.839149080144075, -409.92663963397735, -341.8464285697483, -342.9191524242917, -343.41113487448297, -321.84318454809835, 196.4, -281.42358617438094, -177.80625431581154, -181.8539356939101, -333.1386983313896, -375.44273491234065, -287.6474910853206, -300.6744525371954, -506.94458287872845, -25.652198238455874, -256.3523785692506, -210.60357469720492, -529.6184967758661, -375.2219986380752, -280.7039990780221, -304.82026293213863, -142.36079304739195, -360.4721253512013, -287.79794695727503, -354.9838983458044, -265.39779766903985, -421.23421800618775, -284.1140083431867, -520.378596762045, -264.5179570524967, -349.19799331517487, -230.72673146028419, -531.4175312734125, -424.6497071531355, -230.1501507810915, -50.17788913912194, -404.0183588956378, -322.3365813799949, -267.12357308059524, -484.12392045926595, -233.89405571383006, -199.1649712471202, -371.84365668349045, -289.69701109446834, -470.8024607907443, -286.2800155058502, 1.4209337149262737, -245.96755157195236, -327.0095785215907, -373.6279886879325, -445.6257137904474, -424.683407691564, -355.33521408044464, -421.94523398341215, -299.748201585166, -473.80270320502126, -380.4483192208968, -453.0426864023007, -283.192406534266, 188.15187213962162, -351.7145746380708, -408.0610958114572, -196.23189291688803, -275.0496885780322, -203.20601293339615, -357.3395917395517, 23.470608805771306, -314.54510214336506, -274.0340726368916, -372.7445526973543, -287.2203022321888, -41.58092219523823, -345.1780850263371, 200.0, -436.0632402234781, -325.5531193283132, -403.7231904639846, -42.802804882863434, -483.18827615082677, -469.0248665438766, -340.45705658366575, 3.086431852439298, -393.3792480972022, -42.26366446660893, -261.1013696807687, -344.2211517848154, -287.7745120009344, -334.16698180377244, -332.0214365567988, -357.2962554052204, -340.0975831513903, -354.5335165217027, 188.4957747694139, -276.67090518104646, -299.65727978032766, -266.3982293552934, -241.32183194565872, -501.42630018320494, -227.07161048349334, -403.40033560707815, -341.7634640703806, -607.5343597058479, 179.37724214384608, -508.87604977204114, -456.69745761210334, -307.91000216961606, -327.0852032510593, 32.402697640585224, -575.0725618398095, -309.09156395685636, -524.7478554398588, -462.3584005175483, -260.63618463823815, -307.37466846363304, 184.72447283668134, -376.94962653864064, -328.10350652860956, -496.1509675674128, -131.73847059372392, -488.9174527922543, -421.5485791465136, -257.28608244508484, -126.57839584150182, -332.4072032836378, -168.27571571997245, -256.38636549694615, 189.0387063855106, 48.10675052544025, -383.5262386018099, -329.7952134399174, -163.106568525189, -360.049298214222, 68.49706918694802, -397.6966188020609, 129.40801193610244, -510.47066310117015, -279.80739049692414, -305.53099527886866, -303.2864886260385, -258.8065267580339, -579.1679529760112, -197.18414209163893, -374.69797312989857, -357.05469127560195, -336.9561467776802, -297.7953187691413, -183.6693178856547, -514.0738076890351, -343.11338176677975, -555.857991485535, -0.40953897860655775, -278.68964350059775, -326.37719444211655, -356.58737919809903, -205.11516312980226, -271.0307723625716, -405.57594330378083, -324.35326060340344, -391.6044802916489, -194.20405692288432, -210.69222768925883, -349.6650206487333, -187.35881185908787, -442.7554560875223, -417.92058064058796, -469.40694945638006, -354.4667977750884, -300.6035310873695, -25.23756763815569, -404.61544493148216, -217.7134427782045, -380.9863660752849, -344.281606173825, -371.07998488933714, -462.45587897986957, -328.8501773907204, -181.66134767774847, -459.4552562817271, 187.51829401118323, -574.7269769060888, 194.7573265248554, -550.3629693454495, -65.96272262720599, -316.94130096827956, -298.8411683919793, 96.40716574542648, -367.4365365814419, -153.3731465058264, -409.1214028986544], "policy_predator_policy_reward": [378.0993348095421, 363.41185483801576, 422.03802805245834, 268.2070727437636, 499.51956854847776, 603.0251026104851, 350.13209568602457, 456.23438353199, 25.39999916198986, 362.532355804325, 268.9196892698807, 403.82598073374515, 343.85222724153004, 342.74750456966916, 347.4651284660522, 302.02451779048374, 274.43918478366595, 244.52655704171053, 134.56913495591695, 300.26889856620744, 362.54281736966107, 286.93039467248406, 285.6015986994913, 309.0744525371952, 425.9076421955712, 236.17878610176473, 257.75237856925054, 214.3035746972047, 430.84691665006466, 551.2223293389079, 205.07298491889998, 369.05120096318575, 349.7965371365716, 314.6388246258089, 353.27902312919355, 336.80900545787784, 289.1675726278836, 421.18546958217917, 309.8795470627922, 583.5057293384524, 308.5216117389621, 341.072690270177, 457.82439497985797, 314.0077776027736, 410.60416811460607, 274.9636797679011, 401.7511321505565, 136.33975308050535, 322.5365813799949, 267.7433447514829, 426.1715250867266, 413.7982410337397, 326.2135902074782, 275.9483752741636, 508.9972451379321, 366.7649298462043, 288.8800155058503, 24.824552440958726, 368.80612269279305, 305.56165712701113, 410.48018953287055, 478.45795189610914, 498.18353938424116, 292.4653779551536, 507.598360906534, 301.04201327511817, 478.4264776386725, 374.33611555727566, 453.11873142068225, 282.97266597237484, 265.9743103363755, 335.8145264409254, 385.3130340295211, 336.6322838940469, 269.48561336734736, 285.09813237718646, 335.80636316647656, 277.095659247337, 314.54510214336506, 276.43407263689147, 445.2100205569149, 310.64274311097114, 331.67238558981285, 303.9906577192426, 6.551230337947329, 436.0632402234781, 502.77041738134636, 369.5890496857466, 445.9566341350334, 463.5759736472075, 469.0248665438766, 341.15705658366574, 15.213568147560666, 393.3792480972022, 355.0398433189973, 266.62877970922233, 346.9890169895772, 291.83029302988075, 334.4478106696008, 332.0214365567988, 377.06548829600445, 372.67718264341494, 351.0857844395911, 126.5301864465063, 278.67090518104635, 302.1572797803275, 292.98971057186833, 242.81884258899083, 457.5625918546141, 329.5930150504867, 387.4797420474906, 403.3437046360702, 360.50940548467344, 475.38614794632235, 485.5766021034421, 451.92085481493723, 311.10028525983927, 328.55029244465493, 126.47786525307721, 542.7242330751122, 311.38832778521777, 524.7478554398588, 400.1276194785889, 464.3119096100793, 307.6746684636331, 1.5755271633186618, 346.3528533752314, 479.85280898864124, 417.831689633216, 307.25944965141235, 492.794020101874, 421.5485791465136, 285.66759124403, 285.79724552299905, 299.6710446140027, 367.4145682356025, 259.88636549694604, 5.945177090972564, 348.9114996900405, 345.3289555675336, 219.89638092601265, 301.41929623216345, 273.36675307553287, 364.06730465335926, 403.91975544452015, 362.30862720927513, 290.91973990408644, 546.189891780431, 350.8521542947411, 346.99022497275337, 265.33790337197894, 579.1679529760112, 234.39729684945854, 366.0630210659713, 226.56786057146553, 390.86963121884673, 316.04656458041467, 351.12883509222485, 514.0738076890351, 343.8133817667797, 499.67257867961627, 136.40751539985567, 289.63398071188806, 335.7234384052341, 357.8873791980993, 212.11516312980186, 380.0471138155651, 379.66379124699574, 405.9002295850757, 382.04299856008237, 337.53004558994, 303.4545458177225, 375.5129867512422, 185.0568345014514, 438.5320042472627, 461.1926224306001, 469.40694945638006, 354.4667977750884, 324.1121775837583, 29.3155104919139, 452.2045066465993, 358.18695166798636, 390.40824361323524, 326.44646756478517, 371.07998488933714, 462.47246015502947, 348.185279970424, 318.2950546340179, 370.1361897558518, 246.598798158897, 300.7631803113621, 517.7820042573318, 552.7629693454502, 154.89225259787372, 305.47898150078635, 330.9673354947642, 189.88572791643557, 346.55272496925267, 309.9859022981651, 339.85274093499015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 83.82018814358517, "mean_inference_ms": 71.32152848068954, "mean_action_processing_ms": 37.68190760491822, "mean_env_wait_ms": 21.671063681271388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.5452039241790771, "StateBufferConnector_ms": 11.248575687408447, "ViewRequirementAgentConnector_ms": 8.505395650863647}, "num_episodes": 8, "episode_return_max": 497.93977578783654, "episode_return_min": -76.57334626297097, "episode_return_mean": 102.72372238744514, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2542144, "num_agent_steps_trained": 2542144, "num_env_steps_sampled": 635536, "num_env_steps_trained": 635536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 47.40525779477024, "num_env_steps_trained_throughput_per_sec": 47.40525779477024, "timesteps_total": 635536, "num_env_steps_sampled_lifetime": 635536, "num_agent_steps_sampled_lifetime": 2542144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2542144, "timers": {"training_iteration_time_ms": 219443.893, "restore_workers_time_ms": 85.98, "training_step_time_ms": 219202.679, "sample_time_ms": 45095.65, "learn_time_ms": 182090.745, "learn_throughput": 46.865, "synch_weights_time_ms": 6909.124}, "counters": {"num_env_steps_sampled": 635536, "num_env_steps_trained": 635536, "num_agent_steps_sampled": 2542144, "num_agent_steps_trained": 2542144}, "done": false, "training_iteration": 79, "trial_id": "cdf01_00000", "date": "2024-08-20_13-33-53", "timestamp": 1724141033, "time_this_iter_s": 182.51002192497253, "time_total_s": 11298.492374658585, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e8e0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11298.492374658585, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 34.48, "ram_util_percent": 85.28745098039215}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.377505672924102, "cur_kl_coeff": 1.4636729328554308e-19, "cur_lr": 0.0001, "total_loss": 8.829001965598454, "policy_loss": -0.004243845217639492, "vf_loss": 8.833245801168776, "vf_explained_var": -0.3053752971073938, "kl": 0.0027208788930165335, "entropy": 0.12963132646585268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 50365.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.386527525054084, "cur_kl_coeff": 4.440892098500626e-17, "cur_lr": 0.0001, "total_loss": 8.368007132363697, "policy_loss": -0.0027264998726812856, "vf_loss": 8.370733623656015, "vf_explained_var": 0.45556629829936557, "kl": 0.003138948720293012, "entropy": 0.3129535976146895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 50365.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 643536, "num_env_steps_trained": 643536, "num_agent_steps_sampled": 2574144, "num_agent_steps_trained": 2574144}, "env_runners": {"episode_reward_max": 519.0308075668167, "episode_reward_min": -107.35252014046316, "episode_reward_mean": 117.87684850619912, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -741.9789453537287, "predator_policy": 0.831889237250315}, "policy_reward_max": {"prey_policy": 198.2, "predator_policy": 707.2487566224124}, "policy_reward_mean": {"prey_policy": -294.5176960708658, "predator_policy": 353.45612032396537}, "custom_metrics": {}, "hist_stats": {"episode_reward": [97.20170112349159, 3.8765673096196815, 187.6003584804432, 166.40269384599353, 198.4838834764831, 358.82096718120533, 28.413895193069727, 345.8818287016185, 497.93977578783654, 46.831578086423875, 89.02489536258683, 6.531376613944051, 28.57820269389307, -76.57334626297097, 185.71076301784245, 0.6999999999999942, 79.81256361533039, 20.290581174408324, 8.299999999999999, 83.10418939620878, 71.9854872501063, 236.0883067955201, 23.54598874487297, 39.048589949752035, -1.1102230246251565e-15, 27.586589350146905, 188.0625706048989, -8.413261071090355, 0.016581175159881667, 155.96880953597375, 344.79802564420487, 438.57553418746085, 91.32952997066779, 20.663847635291894, 265.40908204967366, 87.34409382867366, 212.94453525159216, 74.93497695977773, 89.61828577899263, 235.37435686789487, 5.499999999999999, 183.80478354870954, 109.68244056233209, -38.7060496720158, 203.11936355294344, -0.06780125513118951, 2.700000000000003, 1.4010322523251122, 126.09150561991831, 292.37140765210887, 2.400000000000003, 242.56916101249286, 519.0308075668167, -0.09306514540347322, 67.13313946712384, 22.47734627331135, 75.11228607030839, 299.3250004156006, 20.831889237250344, 159.1418990986329, 322.31978752158454, -1.2873547844810713, 40.97731775239504, 192.18847905888558, -8.881784197001252e-16, 290.03187293900817, -4.440892098500626e-16, 257.4629144966832, 216.73293045982652, 100.3190563477373, 245.60947485658005, 35.85729420451633, 65.14515850089887, 2.6286315635730615, -51.87227508548743, 336.87932619738996, 268.1697152852148, 1.2000000000000008, 326.5373969863488, -9.25184880491268, 346.1137106656937, 27.97396632252124, 1.1102230246251565e-15, 120.53992700014459, 137.4371210248631, 155.85177448308576, 62.07480204858514, 169.80400878170747, 25.728227926561356, -107.35252014046316, 377.4391818373103, 196.18711242839325, 101.94567904199761, 44.25964781653045, 45.45373123303521, 15.556060019284477, -12.853484015335415, 8.777279213075651, 106.27787819095835, 81.18331768188006], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-496.1509675674128, -131.73847059372392, -488.9174527922543, -421.5485791465136, -257.28608244508484, -126.57839584150182, -332.4072032836378, -168.27571571997245, -256.38636549694615, 189.0387063855106, 48.10675052544025, -383.5262386018099, -329.7952134399174, -163.106568525189, -360.049298214222, 68.49706918694802, -397.6966188020609, 129.40801193610244, -510.47066310117015, -279.80739049692414, -305.53099527886866, -303.2864886260385, -258.8065267580339, -579.1679529760112, -197.18414209163893, -374.69797312989857, -357.05469127560195, -336.9561467776802, -297.7953187691413, -183.6693178856547, -514.0738076890351, -343.11338176677975, -555.857991485535, -0.40953897860655775, -278.68964350059775, -326.37719444211655, -356.58737919809903, -205.11516312980226, -271.0307723625716, -405.57594330378083, -324.35326060340344, -391.6044802916489, -194.20405692288432, -210.69222768925883, -349.6650206487333, -187.35881185908787, -442.7554560875223, -417.92058064058796, -469.40694945638006, -354.4667977750884, -300.6035310873695, -25.23756763815569, -404.61544493148216, -217.7134427782045, -380.9863660752849, -344.281606173825, -371.07998488933714, -462.45587897986957, -328.8501773907204, -181.66134767774847, -459.4552562817271, 187.51829401118323, -574.7269769060888, 194.7573265248554, -550.3629693454495, -65.96272262720599, -316.94130096827956, -298.8411683919793, 96.40716574542648, -367.4365365814419, -153.3731465058264, -409.1214028986544, -110.64548600107707, -336.6092295349796, -331.66574111758337, -226.96648891456564, -227.4739774755118, -343.3004131967626, -163.90139319278913, -330.8835006680941, -305.1701475737768, -251.95480397612124, -419.05494427222897, -61.55080621217053, -408.7126581734346, -245.96242584349775, -490.65343087110284, -416.42580222903, -215.03608632917795, -372.75325767278406, -334.58820931578634, -297.19811454770104, -479.859572359834, -344.8201934950823, -413.28816404184903, -267.854696537443, -130.96590691405504, -619.3517694211635, -154.53102071329545, -508.43983730369973, -316.05188958548416, -256.4203851847515, -76.7414310310279, -354.729978061252, -488.2830188838448, 179.07584120366658, -514.2810547402905, -413.7135766758964, -623.5565816284299, -133.10548614159083, -462.44163477830244, -263.97714899625254, -511.1196130358301, -196.94832344980182, -70.24307604893909, -490.69152268392276, 20.000000000000014, -416.4151983049246, -378.4338468815911, -200.77564835274796, -741.9789453537287, 99.01635099554667, -327.37133590692576, -325.0248339865995, -265.32363690030786, -318.6516075935796, -356.5424230285694, -270.2632704376857, -333.80063157474706, -377.5361839177171, -387.9916990879945, 195.6259720903786, -319.792878738016, -511.277562502565, 88.82039022342384, -337.47226675072756, -477.0961537389286, -126.73328619351707, -265.3306247275512, -346.2925909526283, -81.92855227209674, -453.7860513856963, -227.83184954081378, -246.12372784880426, -399.50472132291725, -240.35223951988473, -352.9379044692375, -293.6881115802468, -520.428325128109, -396.3332358806583, 179.01921527171885, -386.6380061773472, -200.00149416235158, -506.7847807625134, -310.15238196717166, -374.1408818186557, -434.52561995256883, 177.002109925794, -359.308864005358, -505.6416611621859, 198.2, -313.83370649008856, -475.80603283349006, -240.7939011755735, -285.0616700338802, -485.23870697525024, -257.54690320875795, -357.0565086365856, -220.6647597504685, -539.0233188703428, -552.8117370832738, -195.0913416999097, -301.53274470474486, -219.0162943576672, -150.51882641287978, -381.19291037328975, -416.07128906372947, -412.9419062275952, -460.7173944002056, -447.0998335724516, -364.75792328673833, 170.27851813580182, -156.27516079276015, -499.91514306884227, -240.9901823583145, -301.390027784855, -262.61068343604444, -466.8950368271338, -376.8750157155833, -226.90067465054696, -309.6251221247571, -314.7151062652408, -395.9438732506428, -284.2290974174412, -387.5820383285872, -158.68293346257352, -288.8731646295124, -365.17760408193556, -310.38598148460756, -233.47448518368748], "policy_predator_policy_reward": [417.831689633216, 307.25944965141235, 492.794020101874, 421.5485791465136, 285.66759124403, 285.79724552299905, 299.6710446140027, 367.4145682356025, 259.88636549694604, 5.945177090972564, 348.9114996900405, 345.3289555675336, 219.89638092601265, 301.41929623216345, 273.36675307553287, 364.06730465335926, 403.91975544452015, 362.30862720927513, 290.91973990408644, 546.189891780431, 350.8521542947411, 346.99022497275337, 265.33790337197894, 579.1679529760112, 234.39729684945854, 366.0630210659713, 226.56786057146553, 390.86963121884673, 316.04656458041467, 351.12883509222485, 514.0738076890351, 343.8133817667797, 499.67257867961627, 136.40751539985567, 289.63398071188806, 335.7234384052341, 357.8873791980993, 212.11516312980186, 380.0471138155651, 379.66379124699574, 405.9002295850757, 382.04299856008237, 337.53004558994, 303.4545458177225, 375.5129867512422, 185.0568345014514, 438.5320042472627, 461.1926224306001, 469.40694945638006, 354.4667977750884, 324.1121775837583, 29.3155104919139, 452.2045066465993, 358.18695166798636, 390.40824361323524, 326.44646756478517, 371.07998488933714, 462.47246015502947, 348.185279970424, 318.2950546340179, 370.1361897558518, 246.598798158897, 300.7631803113621, 517.7820042573318, 552.7629693454502, 154.89225259787372, 305.47898150078635, 330.9673354947642, 189.88572791643557, 346.55272496925267, 309.9859022981651, 339.85274093499015, 317.62028394750666, 342.57896684014247, 338.158228299673, 295.4089786922527, 345.8615975125096, 314.53107893875705, 389.8011307766504, 340.3581199521314, 305.87014757377676, 256.75480397612114, 413.6193304885068, 250.79120354460272, 404.0466541709191, 360.310870408345, 434.94933968757914, 433.42384374053756, 420.1737424285156, 370.7349651263919, 334.58820931578634, 297.13031329256984, 480.55957235983396, 346.8201934950822, 327.8537117619571, 354.69018106966035, 257.05741253397264, 619.3517694211635, 486.0940904696606, 469.24817519944236, 316.05188958548416, 258.82038518475144, 329.4808602111397, 344.55970989363203, 455.2943211468168, 372.94366410017847, 514.6626402306671, 413.2389260401164, 346.1042294840202, 477.69097775312423, 449.0120952002626, 299.88403484760363, 498.1276601768626, 285.05256237907787, 495.10632036281294, 365.15327878565034, 0.831889237250315, 416.4151983049246, 411.9252575478895, 326.42613678508314, 258.0336252573519, 707.2487566224124, 339.3782352632617, 311.7305798457833, 330.0583251628554, 294.8942370834266, 437.1132766839401, 381.88089584119956, 333.80063157474706, 377.5361839177171, 103.15221128573488, 379.24538865088937, 319.792878738016, 511.277562502565, 185.51340303040246, 320.6013879935846, 288.52407921051383, 532.038291181758, 364.72196487452936, 347.2203071533877, 353.3599692797323, 427.9641092346392, 259.83778853262345, 249.97508306150962, 396.2876400365063, 308.7144793071944, 262.2289232042183, 387.02572440883944, 552.8231202357166, 312.0661656875639, 185.76361126660018, 358.7345058364188, 514.9575077466347, 459.99848246344567, 311.35238196717194, 374.1408818186557, 402.4298126250875, 181.6310943880367, 353.81832012350606, 501.8803562391258, 239.86747337339443, 221.87994378238884, 362.16197248390546, 382.41192784767844, 285.0616700338802, 485.23870697525024, 321.11322404829957, 414.03011479718793, 400.15173409875007, 496.9734655469238, 485.73987030252084, 418.0149829637479, 211.7423195431082, 370.8815215678892, 348.102205608404, 353.41353995947276, 465.28328540550405, 389.4581378123818, 345.1577332550574, 455.30697457713745, 351.6510129078242, 220.26757408042366, 403.6382400627797, 448.7391762272156, 344.61123472842945, 299.71465445673743, 311.90023405822984, 461.86513402148, 375.691750917892, 273.53767068127326, 333.78917627505916, 306.1071121342229, 407.3082161272988, 260.0112705254494, 388.18203832858717, 166.86021267564905, 391.91123226369905, 368.4174146387072, 273.6829261938529, 351.36085815632157]}, "sampler_perf": {"mean_raw_obs_processing_ms": 84.02063354740226, "mean_inference_ms": 72.07264496106875, "mean_action_processing_ms": 37.39186859832197, "mean_env_wait_ms": 21.905326313559144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028473258018493652, "StateBufferConnector_ms": 6.0677021741867065, "ViewRequirementAgentConnector_ms": 4.6631669998168945}, "num_episodes": 64, "episode_return_max": 519.0308075668167, "episode_return_min": -107.35252014046316, "episode_return_mean": 117.87684850619912, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2574144, "num_agent_steps_trained": 2574144, "num_env_steps_sampled": 643536, "num_env_steps_trained": 643536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 39.552070657321536, "num_env_steps_trained_throughput_per_sec": 39.552070657321536, "timesteps_total": 643536, "num_env_steps_sampled_lifetime": 643536, "num_agent_steps_sampled_lifetime": 2574144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2574144, "timers": {"training_iteration_time_ms": 217235.19, "restore_workers_time_ms": 87.631, "training_step_time_ms": 216990.534, "sample_time_ms": 44816.841, "learn_time_ms": 183577.771, "learn_throughput": 46.485, "synch_weights_time_ms": 6966.093}, "counters": {"num_env_steps_sampled": 643536, "num_env_steps_trained": 643536, "num_agent_steps_sampled": 2574144, "num_agent_steps_trained": 2574144}, "done": false, "training_iteration": 80, "trial_id": "cdf01_00000", "date": "2024-08-20_13-37-40", "timestamp": 1724141260, "time_this_iter_s": 204.68426704406738, "time_total_s": 11503.176641702652, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a53b65e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11503.176641702652, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 89.34045307443365, "ram_util_percent": 84.92750809061488}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.389356248530131, "cur_kl_coeff": 7.318364664277154e-20, "cur_lr": 0.0001, "total_loss": 8.912431094759986, "policy_loss": -0.0030121723574305335, "vf_loss": 8.915443297794887, "vf_explained_var": -0.339357804873633, "kl": 0.001604534425141104, "entropy": 0.110215736890123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 50995.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.645057400824531, "cur_kl_coeff": 2.220446049250313e-17, "cur_lr": 0.0001, "total_loss": 8.564031810609121, "policy_loss": -0.0036677349318144105, "vf_loss": 8.567699556502085, "vf_explained_var": 0.3617444394126771, "kl": 0.0032752986519354304, "entropy": 0.29834027328188456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 50995.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 651536, "num_env_steps_trained": 651536, "num_agent_steps_sampled": 2606144, "num_agent_steps_trained": 2606144}, "env_runners": {"episode_reward_max": 519.0308075668167, "episode_reward_min": -117.65761973813504, "episode_reward_mean": 106.91882692231515, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -741.9789453537287, "predator_policy": 0.831889237250315}, "policy_reward_max": {"prey_policy": 198.2, "predator_policy": 707.2487566224124}, "policy_reward_mean": {"prey_policy": -300.08603037559243, "predator_policy": 353.54544383675005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [497.93977578783654, 46.831578086423875, 89.02489536258683, 6.531376613944051, 28.57820269389307, -76.57334626297097, 185.71076301784245, 0.6999999999999942, 79.81256361533039, 20.290581174408324, 8.299999999999999, 83.10418939620878, 71.9854872501063, 236.0883067955201, 23.54598874487297, 39.048589949752035, -1.1102230246251565e-15, 27.586589350146905, 188.0625706048989, -8.413261071090355, 0.016581175159881667, 155.96880953597375, 344.79802564420487, 438.57553418746085, 91.32952997066779, 20.663847635291894, 265.40908204967366, 87.34409382867366, 212.94453525159216, 74.93497695977773, 89.61828577899263, 235.37435686789487, 5.499999999999999, 183.80478354870954, 109.68244056233209, -38.7060496720158, 203.11936355294344, -0.06780125513118951, 2.700000000000003, 1.4010322523251122, 126.09150561991831, 292.37140765210887, 2.400000000000003, 242.56916101249286, 519.0308075668167, -0.09306514540347322, 67.13313946712384, 22.47734627331135, 75.11228607030839, 299.3250004156006, 20.831889237250344, 159.1418990986329, 322.31978752158454, -1.2873547844810713, 40.97731775239504, 192.18847905888558, -8.881784197001252e-16, 290.03187293900817, -4.440892098500626e-16, 257.4629144966832, 216.73293045982652, 100.3190563477373, 245.60947485658005, 35.85729420451633, 65.14515850089887, 2.6286315635730615, -51.87227508548743, 336.87932619738996, 268.1697152852148, 1.2000000000000008, 326.5373969863488, -9.25184880491268, 346.1137106656937, 27.97396632252124, 1.1102230246251565e-15, 120.53992700014459, 137.4371210248631, 155.85177448308576, 62.07480204858514, 169.80400878170747, 25.728227926561356, -107.35252014046316, 377.4391818373103, 196.18711242839325, 101.94567904199761, 44.25964781653045, 45.45373123303521, 15.556060019284477, -12.853484015335415, 8.777279213075651, 106.27787819095835, 81.18331768188006, 105.61881167381952, 7.699999999999989, 14.413614766982572, -117.65761973813504, 2.400000000000001, 146.14485283341534, 75.02077676464629, 57.2393006228006], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-397.6966188020609, 129.40801193610244, -510.47066310117015, -279.80739049692414, -305.53099527886866, -303.2864886260385, -258.8065267580339, -579.1679529760112, -197.18414209163893, -374.69797312989857, -357.05469127560195, -336.9561467776802, -297.7953187691413, -183.6693178856547, -514.0738076890351, -343.11338176677975, -555.857991485535, -0.40953897860655775, -278.68964350059775, -326.37719444211655, -356.58737919809903, -205.11516312980226, -271.0307723625716, -405.57594330378083, -324.35326060340344, -391.6044802916489, -194.20405692288432, -210.69222768925883, -349.6650206487333, -187.35881185908787, -442.7554560875223, -417.92058064058796, -469.40694945638006, -354.4667977750884, -300.6035310873695, -25.23756763815569, -404.61544493148216, -217.7134427782045, -380.9863660752849, -344.281606173825, -371.07998488933714, -462.45587897986957, -328.8501773907204, -181.66134767774847, -459.4552562817271, 187.51829401118323, -574.7269769060888, 194.7573265248554, -550.3629693454495, -65.96272262720599, -316.94130096827956, -298.8411683919793, 96.40716574542648, -367.4365365814419, -153.3731465058264, -409.1214028986544, -110.64548600107707, -336.6092295349796, -331.66574111758337, -226.96648891456564, -227.4739774755118, -343.3004131967626, -163.90139319278913, -330.8835006680941, -305.1701475737768, -251.95480397612124, -419.05494427222897, -61.55080621217053, -408.7126581734346, -245.96242584349775, -490.65343087110284, -416.42580222903, -215.03608632917795, -372.75325767278406, -334.58820931578634, -297.19811454770104, -479.859572359834, -344.8201934950823, -413.28816404184903, -267.854696537443, -130.96590691405504, -619.3517694211635, -154.53102071329545, -508.43983730369973, -316.05188958548416, -256.4203851847515, -76.7414310310279, -354.729978061252, -488.2830188838448, 179.07584120366658, -514.2810547402905, -413.7135766758964, -623.5565816284299, -133.10548614159083, -462.44163477830244, -263.97714899625254, -511.1196130358301, -196.94832344980182, -70.24307604893909, -490.69152268392276, 20.000000000000014, -416.4151983049246, -378.4338468815911, -200.77564835274796, -741.9789453537287, 99.01635099554667, -327.37133590692576, -325.0248339865995, -265.32363690030786, -318.6516075935796, -356.5424230285694, -270.2632704376857, -333.80063157474706, -377.5361839177171, -387.9916990879945, 195.6259720903786, -319.792878738016, -511.277562502565, 88.82039022342384, -337.47226675072756, -477.0961537389286, -126.73328619351707, -265.3306247275512, -346.2925909526283, -81.92855227209674, -453.7860513856963, -227.83184954081378, -246.12372784880426, -399.50472132291725, -240.35223951988473, -352.9379044692375, -293.6881115802468, -520.428325128109, -396.3332358806583, 179.01921527171885, -386.6380061773472, -200.00149416235158, -506.7847807625134, -310.15238196717166, -374.1408818186557, -434.52561995256883, 177.002109925794, -359.308864005358, -505.6416611621859, 198.2, -313.83370649008856, -475.80603283349006, -240.7939011755735, -285.0616700338802, -485.23870697525024, -257.54690320875795, -357.0565086365856, -220.6647597504685, -539.0233188703428, -552.8117370832738, -195.0913416999097, -301.53274470474486, -219.0162943576672, -150.51882641287978, -381.19291037328975, -416.07128906372947, -412.9419062275952, -460.7173944002056, -447.0998335724516, -364.75792328673833, 170.27851813580182, -156.27516079276015, -499.91514306884227, -240.9901823583145, -301.390027784855, -262.61068343604444, -466.8950368271338, -376.8750157155833, -226.90067465054696, -309.6251221247571, -314.7151062652408, -395.9438732506428, -284.2290974174412, -387.5820383285872, -158.68293346257352, -288.8731646295124, -365.17760408193556, -310.38598148460756, -233.47448518368748, -298.0747946267353, -312.6243524828641, -370.40715796525603, -240.50670714565987, -10.839829695777986, -333.59697490700455, -556.9156698348642, -345.3294486939002, -323.887664898854, -318.3206157689744, -113.61195085261446, -238.2282650609758, -162.1771097636581, -470.7610160676745, -385.6709062355778, -242.83842251523524], "policy_predator_policy_reward": [403.91975544452015, 362.30862720927513, 290.91973990408644, 546.189891780431, 350.8521542947411, 346.99022497275337, 265.33790337197894, 579.1679529760112, 234.39729684945854, 366.0630210659713, 226.56786057146553, 390.86963121884673, 316.04656458041467, 351.12883509222485, 514.0738076890351, 343.8133817667797, 499.67257867961627, 136.40751539985567, 289.63398071188806, 335.7234384052341, 357.8873791980993, 212.11516312980186, 380.0471138155651, 379.66379124699574, 405.9002295850757, 382.04299856008237, 337.53004558994, 303.4545458177225, 375.5129867512422, 185.0568345014514, 438.5320042472627, 461.1926224306001, 469.40694945638006, 354.4667977750884, 324.1121775837583, 29.3155104919139, 452.2045066465993, 358.18695166798636, 390.40824361323524, 326.44646756478517, 371.07998488933714, 462.47246015502947, 348.185279970424, 318.2950546340179, 370.1361897558518, 246.598798158897, 300.7631803113621, 517.7820042573318, 552.7629693454502, 154.89225259787372, 305.47898150078635, 330.9673354947642, 189.88572791643557, 346.55272496925267, 309.9859022981651, 339.85274093499015, 317.62028394750666, 342.57896684014247, 338.158228299673, 295.4089786922527, 345.8615975125096, 314.53107893875705, 389.8011307766504, 340.3581199521314, 305.87014757377676, 256.75480397612114, 413.6193304885068, 250.79120354460272, 404.0466541709191, 360.310870408345, 434.94933968757914, 433.42384374053756, 420.1737424285156, 370.7349651263919, 334.58820931578634, 297.13031329256984, 480.55957235983396, 346.8201934950822, 327.8537117619571, 354.69018106966035, 257.05741253397264, 619.3517694211635, 486.0940904696606, 469.24817519944236, 316.05188958548416, 258.82038518475144, 329.4808602111397, 344.55970989363203, 455.2943211468168, 372.94366410017847, 514.6626402306671, 413.2389260401164, 346.1042294840202, 477.69097775312423, 449.0120952002626, 299.88403484760363, 498.1276601768626, 285.05256237907787, 495.10632036281294, 365.15327878565034, 0.831889237250315, 416.4151983049246, 411.9252575478895, 326.42613678508314, 258.0336252573519, 707.2487566224124, 339.3782352632617, 311.7305798457833, 330.0583251628554, 294.8942370834266, 437.1132766839401, 381.88089584119956, 333.80063157474706, 377.5361839177171, 103.15221128573488, 379.24538865088937, 319.792878738016, 511.277562502565, 185.51340303040246, 320.6013879935846, 288.52407921051383, 532.038291181758, 364.72196487452936, 347.2203071533877, 353.3599692797323, 427.9641092346392, 259.83778853262345, 249.97508306150962, 396.2876400365063, 308.7144793071944, 262.2289232042183, 387.02572440883944, 552.8231202357166, 312.0661656875639, 185.76361126660018, 358.7345058364188, 514.9575077466347, 459.99848246344567, 311.35238196717194, 374.1408818186557, 402.4298126250875, 181.6310943880367, 353.81832012350606, 501.8803562391258, 239.86747337339443, 221.87994378238884, 362.16197248390546, 382.41192784767844, 285.0616700338802, 485.23870697525024, 321.11322404829957, 414.03011479718793, 400.15173409875007, 496.9734655469238, 485.73987030252084, 418.0149829637479, 211.7423195431082, 370.8815215678892, 348.102205608404, 353.41353995947276, 465.28328540550405, 389.4581378123818, 345.1577332550574, 455.30697457713745, 351.6510129078242, 220.26757408042366, 403.6382400627797, 448.7391762272156, 344.61123472842945, 299.71465445673743, 311.90023405822984, 461.86513402148, 375.691750917892, 273.53767068127326, 333.78917627505916, 306.1071121342229, 407.3082161272988, 260.0112705254494, 388.18203832858717, 166.86021267564905, 391.91123226369905, 368.4174146387072, 273.6829261938529, 351.36085815632157, 315.60778782191704, 400.71017096150257, 373.507157965256, 245.1067071456596, 2.7180441230921666, 356.1323752466732, 576.3709809142093, 208.21651787642034, 323.887664898854, 320.72061576897426, 269.47481983404384, 228.51024891296126, 269.1265587158346, 438.832343880144, 268.34270803488937, 417.40592133872343]}, "sampler_perf": {"mean_raw_obs_processing_ms": 84.20740107018165, "mean_inference_ms": 72.43887549312653, "mean_action_processing_ms": 37.27619884186186, "mean_env_wait_ms": 21.84987505095012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025029301643371582, "StateBufferConnector_ms": 5.116617202758789, "ViewRequirementAgentConnector_ms": 3.991634488105774}, "num_episodes": 8, "episode_return_max": 519.0308075668167, "episode_return_min": -117.65761973813504, "episode_return_mean": 106.91882692231515, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2606144, "num_agent_steps_trained": 2606144, "num_env_steps_sampled": 651536, "num_env_steps_trained": 651536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 34.327577683231965, "num_env_steps_trained_throughput_per_sec": 34.327577683231965, "timesteps_total": 651536, "num_env_steps_sampled_lifetime": 651536, "num_agent_steps_sampled_lifetime": 2606144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2606144, "timers": {"training_iteration_time_ms": 216467.229, "restore_workers_time_ms": 87.877, "training_step_time_ms": 216222.384, "sample_time_ms": 43067.429, "learn_time_ms": 185491.62, "learn_throughput": 46.005, "synch_weights_time_ms": 6968.721}, "counters": {"num_env_steps_sampled": 651536, "num_env_steps_trained": 651536, "num_agent_steps_sampled": 2606144, "num_agent_steps_trained": 2606144}, "done": false, "training_iteration": 81, "trial_id": "cdf01_00000", "date": "2024-08-20_13-41-38", "timestamp": 1724141498, "time_this_iter_s": 234.5540292263031, "time_total_s": 11737.730670928955, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a53b6550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11737.730670928955, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 96.3, "ram_util_percent": 83.61564417177915}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.379469457883683, "cur_kl_coeff": 3.659182332138577e-20, "cur_lr": 0.0001, "total_loss": 8.83453079556662, "policy_loss": -0.004327011268423308, "vf_loss": 8.838857785482256, "vf_explained_var": -0.1559262171624199, "kl": 0.004567452385730402, "entropy": 0.13730100098819958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 51625.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.083944343763685, "cur_kl_coeff": 1.1102230246251564e-17, "cur_lr": 0.0001, "total_loss": 8.583447835558937, "policy_loss": -0.004191774608463877, "vf_loss": 8.587639639112684, "vf_explained_var": 0.3351463570481255, "kl": 0.00441536725829431, "entropy": 0.3035338234570291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 51625.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 659536, "num_env_steps_trained": 659536, "num_agent_steps_sampled": 2638144, "num_agent_steps_trained": 2638144}, "env_runners": {"episode_reward_max": 470.95386686933114, "episode_reward_min": -117.65761973813504, "episode_reward_mean": 103.45574246624854, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -678.9620356736091, "predator_policy": 2.525768423896675}, "policy_reward_max": {"prey_policy": 198.2, "predator_policy": 617.3636206353844}, "policy_reward_mean": {"prey_policy": -298.1773059747257, "predator_policy": 349.90517720784993}, "custom_metrics": {}, "hist_stats": {"episode_reward": [65.14515850089887, 2.6286315635730615, -51.87227508548743, 336.87932619738996, 268.1697152852148, 1.2000000000000008, 326.5373969863488, -9.25184880491268, 346.1137106656937, 27.97396632252124, 1.1102230246251565e-15, 120.53992700014459, 137.4371210248631, 155.85177448308576, 62.07480204858514, 169.80400878170747, 25.728227926561356, -107.35252014046316, 377.4391818373103, 196.18711242839325, 101.94567904199761, 44.25964781653045, 45.45373123303521, 15.556060019284477, -12.853484015335415, 8.777279213075651, 106.27787819095835, 81.18331768188006, 105.61881167381952, 7.699999999999989, 14.413614766982572, -117.65761973813504, 2.400000000000001, 146.14485283341534, 75.02077676464629, 57.2393006228006, 178.02068004673234, 26.145648804347267, 217.46421525284856, 149.58502735616088, 347.2418797017047, 231.68490567177386, 148.8418825953282, 133.28242313795778, 16.267766952966333, 222.0787928423084, 148.36759705679944, 193.261798247569, 4.79687644409405, 112.91614700954844, -3.1759044862805377, 6.5419088690567175, 8.670199346579999, 26.78667190001096, 72.09607714111685, 165.94894693722512, 32.000000000000185, 319.9697812937704, 161.95776062143554, -36.612390666413795, 130.8219922339925, 12.53229015601814, 301.049012708125, 1.1000000000000028, 136.225988765423, 2.1000000000000014, 257.69064447464564, 20.086300002241696, 2.1000000000000023, 251.80328661966422, -6.173189998117367, 2.600000000000004, 100.39023752247297, 42.57088119344854, -85.91338102548032, 125.16651648442868, 331.45297787074054, 142.6629846851746, 1.698502679677955, 37.98296723510766, 46.611312910800706, 0.10000000000000209, 0.008559239791642748, 116.36516142284543, 470.95386686933114, 257.648022263741, 0.34618707512512115, 142.86615910455228, 11.069162370836333, 104.67170789189784, 343.1224415393884, -3.993429018757139, 264.21771501448904, 22.506990730221922, 115.02908641085988, 224.218482533244, -1.3322676295501878e-15, 166.7401466730913, 50.548811162492335, 187.74389562031587], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-399.50472132291725, -240.35223951988473, -352.9379044692375, -293.6881115802468, -520.428325128109, -396.3332358806583, 179.01921527171885, -386.6380061773472, -200.00149416235158, -506.7847807625134, -310.15238196717166, -374.1408818186557, -434.52561995256883, 177.002109925794, -359.308864005358, -505.6416611621859, 198.2, -313.83370649008856, -475.80603283349006, -240.7939011755735, -285.0616700338802, -485.23870697525024, -257.54690320875795, -357.0565086365856, -220.6647597504685, -539.0233188703428, -552.8117370832738, -195.0913416999097, -301.53274470474486, -219.0162943576672, -150.51882641287978, -381.19291037328975, -416.07128906372947, -412.9419062275952, -460.7173944002056, -447.0998335724516, -364.75792328673833, 170.27851813580182, -156.27516079276015, -499.91514306884227, -240.9901823583145, -301.390027784855, -262.61068343604444, -466.8950368271338, -376.8750157155833, -226.90067465054696, -309.6251221247571, -314.7151062652408, -395.9438732506428, -284.2290974174412, -387.5820383285872, -158.68293346257352, -288.8731646295124, -365.17760408193556, -310.38598148460756, -233.47448518368748, -298.0747946267353, -312.6243524828641, -370.40715796525603, -240.50670714565987, -10.839829695777986, -333.59697490700455, -556.9156698348642, -345.3294486939002, -323.887664898854, -318.3206157689744, -113.61195085261446, -238.2282650609758, -162.1771097636581, -470.7610160676745, -385.6709062355778, -242.83842251523524, -17.72906646027218, -560.0253901270543, 17.822437071088707, -470.4103088710797, 72.13588900944936, -377.9558537954413, -434.25770886960777, -58.6297873621605, -509.4392891461352, 12.13488515827906, -98.17489190708162, -659.4773800636414, -332.67034372610345, -383.90404685198735, -450.3399025370695, -272.94885719602223, -66.64849054518037, -317.1271205383982, -253.62232272274406, -323.6990155431034, -509.8075144958987, -307.50963912700877, 187.07875537357762, -483.33476003820005, -337.0851858756617, -293.1343446800344, -533.334646456784, -41.70580390033443, -325.41257617796794, -325.3252881517564, -304.56672883198917, -344.5543882563693, -371.76233222548353, -557.5519665034642, -344.2110959032583, -313.65448948705404, -113.95740311649652, -474.97120380359235, -152.01804403289702, -412.4323642401114, -124.77724340014699, 17.174231576103303, 8.122912826869552, -445.6839541388444, -463.82832998233886, -140.30992180495647, -395.824482888398, -507.29237131208424, -78.8122371239613, -365.1517597290262, -415.550705685577, -478.8552115385456, -441.2752341890737, -10.736405349053676, -338.84649600432425, -340.4104330719385, -190.9883385771365, -365.85659198327136, -273.3272677436977, -324.37506165800824, -93.48750852911107, -629.3296712597735, -363.31855387467994, -283.76127195410317, -333.1179302881886, -306.01460687699824, 153.09068826863728, -364.41589924521054, -342.11178860118804, -333.85470516179674, -277.5496214335884, -525.1178387026357, -383.68508640501886, -286.87867857864825, -336.720356527429, -264.510049495603, -158.8757840294817, -278.29820259723795, -200.1380804057716, -263.6500204134239, 184.80504867060665, -517.1955751232941, -327.12364842032076, -123.96100000276458, -502.8300617647695, -372.4698575033067, -457.2868021276608, -321.3274813262633, -320.4715416999881, -297.4404658676199, -391.8347846131625, -276.96502723448106, -343.54418759309016, -386.7956933500372, -504.44291967174803, -265.5695868863867, -461.74504322482557, 94.03054342392356, -35.31338477123872, -376.54956035328684, -336.7401820395228, -301.1414096259046, -252.04193025926082, -243.83293859827504, -512.4844627614272, -41.389250845205034, -118.86605407224387, -366.8199686587805, -117.25533670199556, -321.0038110346242, -309.3358137349, -272.34149084590115, -145.03669178606646, -552.5926132199818, -357.3353611945286, -275.190870348437, -315.9686973774853, -205.22888282196791, -431.4717600852979, -88.87915866911567, -353.4298737304433, -358.74627706258156, -95.36882423728224, -446.0411271952091, -183.3620340162663, -678.9620356736091, -422.98417717282143, -197.96336778107397], "policy_predator_policy_reward": [396.2876400365063, 308.7144793071944, 262.2289232042183, 387.02572440883944, 552.8231202357166, 312.0661656875639, 185.76361126660018, 358.7345058364188, 514.9575077466347, 459.99848246344567, 311.35238196717194, 374.1408818186557, 402.4298126250875, 181.6310943880367, 353.81832012350606, 501.8803562391258, 239.86747337339443, 221.87994378238884, 362.16197248390546, 382.41192784767844, 285.0616700338802, 485.23870697525024, 321.11322404829957, 414.03011479718793, 400.15173409875007, 496.9734655469238, 485.73987030252084, 418.0149829637479, 211.7423195431082, 370.8815215678892, 348.102205608404, 353.41353995947276, 465.28328540550405, 389.4581378123818, 345.1577332550574, 455.30697457713745, 351.6510129078242, 220.26757408042366, 403.6382400627797, 448.7391762272156, 344.61123472842945, 299.71465445673743, 311.90023405822984, 461.86513402148, 375.691750917892, 273.53767068127326, 333.78917627505916, 306.1071121342229, 407.3082161272988, 260.0112705254494, 388.18203832858717, 166.86021267564905, 391.91123226369905, 368.4174146387072, 273.6829261938529, 351.36085815632157, 315.60778782191704, 400.71017096150257, 373.507157965256, 245.1067071456596, 2.7180441230921666, 356.1323752466732, 576.3709809142093, 208.21651787642034, 323.887664898854, 320.72061576897426, 269.47481983404384, 228.51024891296126, 269.1265587158346, 438.832343880144, 268.34270803488937, 417.40592133872343, 536.5949220628721, 219.18021457118678, 470.4103088710797, 8.323211733258425, 332.176632036589, 191.10754800225186, 223.47593796600762, 418.99658562192167, 385.61273346685033, 458.93355022270975, 378.9990432475276, 610.3381343949719, 430.49787941225804, 434.91839376116167, 444.1672512654509, 412.4039316055992, 82.9162574981459, 317.1271205383982, 395.37031890627395, 404.02981220188184, 533.4701261638187, 432.2146245158885, 6.183042873991404, 483.33476003820005, 341.88206231975545, 293.1343446800344, 191.27474109798345, 496.6818562686841, 329.8620862294783, 317.69987361396534, 295.091389837931, 360.5716361194842, 380.4325315720639, 557.5519665034642, 340.33808075370365, 344.31417653661964, 246.1780338607636, 414.8466502004412, 360.3785360313817, 370.0208191788504, 137.07724340014695, 2.525768423896675, 370.90194891461516, 386.62887369112946, 368.00026380958684, 398.0957485991427, 370.862388849708, 495.6420746843593, 259.48240817933845, 315.3035809076409, 375.4247584374713, 531.5134489426689, 373.28816660445403, 379.77248564179774, 339.9464960043243, 340.4104330719385, 286.15378300376466, 406.9171363220665, 275.42726774369817, 324.37506165800824, 363.1442036281472, 617.3636206353844, 369.3185538746813, 297.8475719563447, 335.2179302881884, 306.01460687699824, 194.91686638800277, 268.21163120823394, 345.064383164248, 324.72892060061946, 280.1496214335882, 525.1178387026357, 368.5759636256643, 402.3780388804754, 341.1727251792372, 302.6285620372432, 228.01123655648047, 123.24936904475821, 301.2961929664786, 287.6584243371452, 147.57285329650816, 516.2706510269202, 337.124180310662, 256.62345279759967, 502.9366158493437, 374.06180609841044, 494.34058672179054, 322.25666396724193, 335.923035955169, 328.60028452323957, 391.8347846131625, 277.0650272344811, 343.54418759309016, 386.80425258982893, 366.76693499493905, 519.6107329860415, 435.77092356163695, 402.8974431085956, 309.66817310479763, 359.84279428347077, 336.7401820395228, 301.48759670103067, 333.60674278393, 305.13428517815703, 274.3522818420024, 290.59059413546555, 280.27335916744323, 310.0843714554784, 386.77603618317056, 394.6055530928386, 304.9538768514382, 272.7299987106058, 470.9330435493245, 490.91397647121147, 379.86310272761426, 275.1701195455741, 315.86241853334167, 320.3642480769706, 396.46332223931216, 348.1060790483447, 353.4298737304433, 358.74627706258156, 274.5907467816812, 433.55935132390164, 425.7013745249355, 487.17150632743176, 420.52731148383316, 388.1641290903776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 84.21796404609415, "mean_inference_ms": 72.41039263796482, "mean_action_processing_ms": 36.970395700583346, "mean_env_wait_ms": 21.990986921090997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.14670217037200928, "StateBufferConnector_ms": 1.524612545967102, "ViewRequirementAgentConnector_ms": 4.866457462310791}, "num_episodes": 64, "episode_return_max": 470.95386686933114, "episode_return_min": -117.65761973813504, "episode_return_mean": 103.45574246624854, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2638144, "num_agent_steps_trained": 2638144, "num_env_steps_sampled": 659536, "num_env_steps_trained": 659536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 20.573851307043704, "num_env_steps_trained_throughput_per_sec": 20.573851307043704, "timesteps_total": 659536, "num_env_steps_sampled_lifetime": 659536, "num_agent_steps_sampled_lifetime": 2638144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2638144, "timers": {"training_iteration_time_ms": 234756.897, "restore_workers_time_ms": 86.911, "training_step_time_ms": 234516.227, "sample_time_ms": 44098.601, "learn_time_ms": 201530.491, "learn_throughput": 42.344, "synch_weights_time_ms": 6862.382}, "counters": {"num_env_steps_sampled": 659536, "num_env_steps_trained": 659536, "num_agent_steps_sampled": 2638144, "num_agent_steps_trained": 2638144}, "done": false, "training_iteration": 82, "trial_id": "cdf01_00000", "date": "2024-08-20_13-48-09", "timestamp": 1724141889, "time_this_iter_s": 389.1669728755951, "time_total_s": 12126.89764380455, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5326c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12126.89764380455, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 74.64711111111112, "ram_util_percent": 85.24444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.400245990639641, "cur_kl_coeff": 1.8295911660692886e-20, "cur_lr": 0.0001, "total_loss": 9.01796881055075, "policy_loss": -0.003823635981802548, "vf_loss": 9.021792442079574, "vf_explained_var": -0.4265351648368533, "kl": 0.0021017203511075337, "entropy": 0.10705059369405111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 52255.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.726478955859229, "cur_kl_coeff": 5.551115123125782e-18, "cur_lr": 0.0001, "total_loss": 8.876825135851663, "policy_loss": -0.0034915004058607988, "vf_loss": 8.88031658142332, "vf_explained_var": 0.4739536117939722, "kl": 0.00399321760150636, "entropy": 0.3135286070051647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 52255.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 667536, "num_env_steps_trained": 667536, "num_agent_steps_sampled": 2670144, "num_agent_steps_trained": 2670144}, "env_runners": {"episode_reward_max": 470.95386686933114, "episode_reward_min": -117.65761973813504, "episode_reward_mean": 107.12871532288771, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -678.9620356736091, "predator_policy": 2.525768423896675}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 617.3636206353844}, "policy_reward_mean": {"prey_policy": -295.90390804887477, "predator_policy": 349.4682657103185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [346.1137106656937, 27.97396632252124, 1.1102230246251565e-15, 120.53992700014459, 137.4371210248631, 155.85177448308576, 62.07480204858514, 169.80400878170747, 25.728227926561356, -107.35252014046316, 377.4391818373103, 196.18711242839325, 101.94567904199761, 44.25964781653045, 45.45373123303521, 15.556060019284477, -12.853484015335415, 8.777279213075651, 106.27787819095835, 81.18331768188006, 105.61881167381952, 7.699999999999989, 14.413614766982572, -117.65761973813504, 2.400000000000001, 146.14485283341534, 75.02077676464629, 57.2393006228006, 178.02068004673234, 26.145648804347267, 217.46421525284856, 149.58502735616088, 347.2418797017047, 231.68490567177386, 148.8418825953282, 133.28242313795778, 16.267766952966333, 222.0787928423084, 148.36759705679944, 193.261798247569, 4.79687644409405, 112.91614700954844, -3.1759044862805377, 6.5419088690567175, 8.670199346579999, 26.78667190001096, 72.09607714111685, 165.94894693722512, 32.000000000000185, 319.9697812937704, 161.95776062143554, -36.612390666413795, 130.8219922339925, 12.53229015601814, 301.049012708125, 1.1000000000000028, 136.225988765423, 2.1000000000000014, 257.69064447464564, 20.086300002241696, 2.1000000000000023, 251.80328661966422, -6.173189998117367, 2.600000000000004, 100.39023752247297, 42.57088119344854, -85.91338102548032, 125.16651648442868, 331.45297787074054, 142.6629846851746, 1.698502679677955, 37.98296723510766, 46.611312910800706, 0.10000000000000209, 0.008559239791642748, 116.36516142284543, 470.95386686933114, 257.648022263741, 0.34618707512512115, 142.86615910455228, 11.069162370836333, 104.67170789189784, 343.1224415393884, -3.993429018757139, 264.21771501448904, 22.506990730221922, 115.02908641085988, 224.218482533244, -1.3322676295501878e-15, 166.7401466730913, 50.548811162492335, 187.74389562031587, 8.881784197001252e-16, 14.65451744352942, 269.114679723998, 22.441816483378943, 270.8050993093043, 306.2738742903947, 208.03959453649864, 215.40380851983815], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [198.2, -313.83370649008856, -475.80603283349006, -240.7939011755735, -285.0616700338802, -485.23870697525024, -257.54690320875795, -357.0565086365856, -220.6647597504685, -539.0233188703428, -552.8117370832738, -195.0913416999097, -301.53274470474486, -219.0162943576672, -150.51882641287978, -381.19291037328975, -416.07128906372947, -412.9419062275952, -460.7173944002056, -447.0998335724516, -364.75792328673833, 170.27851813580182, -156.27516079276015, -499.91514306884227, -240.9901823583145, -301.390027784855, -262.61068343604444, -466.8950368271338, -376.8750157155833, -226.90067465054696, -309.6251221247571, -314.7151062652408, -395.9438732506428, -284.2290974174412, -387.5820383285872, -158.68293346257352, -288.8731646295124, -365.17760408193556, -310.38598148460756, -233.47448518368748, -298.0747946267353, -312.6243524828641, -370.40715796525603, -240.50670714565987, -10.839829695777986, -333.59697490700455, -556.9156698348642, -345.3294486939002, -323.887664898854, -318.3206157689744, -113.61195085261446, -238.2282650609758, -162.1771097636581, -470.7610160676745, -385.6709062355778, -242.83842251523524, -17.72906646027218, -560.0253901270543, 17.822437071088707, -470.4103088710797, 72.13588900944936, -377.9558537954413, -434.25770886960777, -58.6297873621605, -509.4392891461352, 12.13488515827906, -98.17489190708162, -659.4773800636414, -332.67034372610345, -383.90404685198735, -450.3399025370695, -272.94885719602223, -66.64849054518037, -317.1271205383982, -253.62232272274406, -323.6990155431034, -509.8075144958987, -307.50963912700877, 187.07875537357762, -483.33476003820005, -337.0851858756617, -293.1343446800344, -533.334646456784, -41.70580390033443, -325.41257617796794, -325.3252881517564, -304.56672883198917, -344.5543882563693, -371.76233222548353, -557.5519665034642, -344.2110959032583, -313.65448948705404, -113.95740311649652, -474.97120380359235, -152.01804403289702, -412.4323642401114, -124.77724340014699, 17.174231576103303, 8.122912826869552, -445.6839541388444, -463.82832998233886, -140.30992180495647, -395.824482888398, -507.29237131208424, -78.8122371239613, -365.1517597290262, -415.550705685577, -478.8552115385456, -441.2752341890737, -10.736405349053676, -338.84649600432425, -340.4104330719385, -190.9883385771365, -365.85659198327136, -273.3272677436977, -324.37506165800824, -93.48750852911107, -629.3296712597735, -363.31855387467994, -283.76127195410317, -333.1179302881886, -306.01460687699824, 153.09068826863728, -364.41589924521054, -342.11178860118804, -333.85470516179674, -277.5496214335884, -525.1178387026357, -383.68508640501886, -286.87867857864825, -336.720356527429, -264.510049495603, -158.8757840294817, -278.29820259723795, -200.1380804057716, -263.6500204134239, 184.80504867060665, -517.1955751232941, -327.12364842032076, -123.96100000276458, -502.8300617647695, -372.4698575033067, -457.2868021276608, -321.3274813262633, -320.4715416999881, -297.4404658676199, -391.8347846131625, -276.96502723448106, -343.54418759309016, -386.7956933500372, -504.44291967174803, -265.5695868863867, -461.74504322482557, 94.03054342392356, -35.31338477123872, -376.54956035328684, -336.7401820395228, -301.1414096259046, -252.04193025926082, -243.83293859827504, -512.4844627614272, -41.389250845205034, -118.86605407224387, -366.8199686587805, -117.25533670199556, -321.0038110346242, -309.3358137349, -272.34149084590115, -145.03669178606646, -552.5926132199818, -357.3353611945286, -275.190870348437, -315.9686973774853, -205.22888282196791, -431.4717600852979, -88.87915866911567, -353.4298737304433, -358.74627706258156, -95.36882423728224, -446.0411271952091, -183.3620340162663, -678.9620356736091, -422.98417717282143, -197.96336778107397, -363.1597025918911, -514.3303564163524, -127.70954222479963, -363.8576952803905, -531.1708738427049, -85.78148004014224, -429.954840326345, -277.9644093457077, -400.7579870570454, -54.761800023883524, -191.23144163905323, -301.12028956426855, -311.9475321257058, -94.8594842990942, 200.0, -621.1298827641181], "policy_predator_policy_reward": [239.86747337339443, 221.87994378238884, 362.16197248390546, 382.41192784767844, 285.0616700338802, 485.23870697525024, 321.11322404829957, 414.03011479718793, 400.15173409875007, 496.9734655469238, 485.73987030252084, 418.0149829637479, 211.7423195431082, 370.8815215678892, 348.102205608404, 353.41353995947276, 465.28328540550405, 389.4581378123818, 345.1577332550574, 455.30697457713745, 351.6510129078242, 220.26757408042366, 403.6382400627797, 448.7391762272156, 344.61123472842945, 299.71465445673743, 311.90023405822984, 461.86513402148, 375.691750917892, 273.53767068127326, 333.78917627505916, 306.1071121342229, 407.3082161272988, 260.0112705254494, 388.18203832858717, 166.86021267564905, 391.91123226369905, 368.4174146387072, 273.6829261938529, 351.36085815632157, 315.60778782191704, 400.71017096150257, 373.507157965256, 245.1067071456596, 2.7180441230921666, 356.1323752466732, 576.3709809142093, 208.21651787642034, 323.887664898854, 320.72061576897426, 269.47481983404384, 228.51024891296126, 269.1265587158346, 438.832343880144, 268.34270803488937, 417.40592133872343, 536.5949220628721, 219.18021457118678, 470.4103088710797, 8.323211733258425, 332.176632036589, 191.10754800225186, 223.47593796600762, 418.99658562192167, 385.61273346685033, 458.93355022270975, 378.9990432475276, 610.3381343949719, 430.49787941225804, 434.91839376116167, 444.1672512654509, 412.4039316055992, 82.9162574981459, 317.1271205383982, 395.37031890627395, 404.02981220188184, 533.4701261638187, 432.2146245158885, 6.183042873991404, 483.33476003820005, 341.88206231975545, 293.1343446800344, 191.27474109798345, 496.6818562686841, 329.8620862294783, 317.69987361396534, 295.091389837931, 360.5716361194842, 380.4325315720639, 557.5519665034642, 340.33808075370365, 344.31417653661964, 246.1780338607636, 414.8466502004412, 360.3785360313817, 370.0208191788504, 137.07724340014695, 2.525768423896675, 370.90194891461516, 386.62887369112946, 368.00026380958684, 398.0957485991427, 370.862388849708, 495.6420746843593, 259.48240817933845, 315.3035809076409, 375.4247584374713, 531.5134489426689, 373.28816660445403, 379.77248564179774, 339.9464960043243, 340.4104330719385, 286.15378300376466, 406.9171363220665, 275.42726774369817, 324.37506165800824, 363.1442036281472, 617.3636206353844, 369.3185538746813, 297.8475719563447, 335.2179302881884, 306.01460687699824, 194.91686638800277, 268.21163120823394, 345.064383164248, 324.72892060061946, 280.1496214335882, 525.1178387026357, 368.5759636256643, 402.3780388804754, 341.1727251792372, 302.6285620372432, 228.01123655648047, 123.24936904475821, 301.2961929664786, 287.6584243371452, 147.57285329650816, 516.2706510269202, 337.124180310662, 256.62345279759967, 502.9366158493437, 374.06180609841044, 494.34058672179054, 322.25666396724193, 335.923035955169, 328.60028452323957, 391.8347846131625, 277.0650272344811, 343.54418759309016, 386.80425258982893, 366.76693499493905, 519.6107329860415, 435.77092356163695, 402.8974431085956, 309.66817310479763, 359.84279428347077, 336.7401820395228, 301.48759670103067, 333.60674278393, 305.13428517815703, 274.3522818420024, 290.59059413546555, 280.27335916744323, 310.0843714554784, 386.77603618317056, 394.6055530928386, 304.9538768514382, 272.7299987106058, 470.9330435493245, 490.91397647121147, 379.86310272761426, 275.1701195455741, 315.86241853334167, 320.3642480769706, 396.46332223931216, 348.1060790483447, 353.4298737304433, 358.74627706258156, 274.5907467816812, 433.55935132390164, 425.7013745249355, 487.17150632743176, 420.52731148383316, 388.1641290903776, 363.1597025918911, 514.3303564163524, 142.83236069286184, 363.3893942558571, 500.4050989284094, 385.6619346784345, 422.398286858262, 307.96277929716956, 353.8638877169379, 372.46099867329474, 399.6353055363044, 398.99029995741057, 313.46608238347596, 301.380528577822, 485.3215931163868, 151.21209816757107]}, "sampler_perf": {"mean_raw_obs_processing_ms": 84.38856049343158, "mean_inference_ms": 72.61657422095296, "mean_action_processing_ms": 36.85528820251469, "mean_env_wait_ms": 21.88101306832714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.14451003074645996, "StateBufferConnector_ms": 1.4065093994140625, "ViewRequirementAgentConnector_ms": 4.779611229896545}, "num_episodes": 8, "episode_return_max": 470.95386686933114, "episode_return_min": -117.65761973813504, "episode_return_mean": 107.12871532288771, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2670144, "num_agent_steps_trained": 2670144, "num_env_steps_sampled": 667536, "num_env_steps_trained": 667536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 95.28512177816502, "num_env_steps_trained_throughput_per_sec": 95.28512177816502, "timesteps_total": 667536, "num_env_steps_sampled_lifetime": 667536, "num_agent_steps_sampled_lifetime": 2670144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2670144, "timers": {"training_iteration_time_ms": 223319.93, "restore_workers_time_ms": 81.795, "training_step_time_ms": 223090.376, "sample_time_ms": 42654.001, "learn_time_ms": 191543.874, "learn_throughput": 44.552, "synch_weights_time_ms": 6434.577}, "counters": {"num_env_steps_sampled": 667536, "num_env_steps_trained": 667536, "num_agent_steps_sampled": 2670144, "num_agent_steps_trained": 2670144}, "done": false, "training_iteration": 83, "trial_id": "cdf01_00000", "date": "2024-08-20_13-49-34", "timestamp": 1724141974, "time_this_iter_s": 84.12088179588318, "time_total_s": 12211.018525600433, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5390b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12211.018525600433, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 86.55593220338983, "ram_util_percent": 82.61694915254236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.384703662281945, "cur_kl_coeff": 9.147955830346443e-21, "cur_lr": 0.0001, "total_loss": Infinity, "policy_loss": -0.0038101963947401456, "vf_loss": 8.684052983541337, "vf_explained_var": -0.10362902964864458, "kl": Infinity, "entropy": 0.1344621536041063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 52885.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.543094291005816, "cur_kl_coeff": 2.775557561562891e-18, "cur_lr": 0.0001, "total_loss": 8.773804236215259, "policy_loss": -0.003466177950539286, "vf_loss": 8.7772704109313, "vf_explained_var": 0.3722239211438194, "kl": 0.003247923342888094, "entropy": 0.316722221081219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 52885.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 675536, "num_env_steps_trained": 675536, "num_agent_steps_sampled": 2702144, "num_agent_steps_trained": 2702144}, "env_runners": {"episode_reward_max": 486.18025029780966, "episode_reward_min": -108.02335162796635, "episode_reward_mean": 120.10237391894489, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -682.8859644945052, "predator_policy": 2.7537536961489195}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 682.8859644945052}, "policy_reward_mean": {"prey_policy": -292.7148720782344, "predator_policy": 352.7660590377069}, "custom_metrics": {}, "hist_stats": {"episode_reward": [100.39023752247297, 42.57088119344854, -85.91338102548032, 125.16651648442868, 331.45297787074054, 142.6629846851746, 1.698502679677955, 37.98296723510766, 46.611312910800706, 0.10000000000000209, 0.008559239791642748, 116.36516142284543, 470.95386686933114, 257.648022263741, 0.34618707512512115, 142.86615910455228, 11.069162370836333, 104.67170789189784, 343.1224415393884, -3.993429018757139, 264.21771501448904, 22.506990730221922, 115.02908641085988, 224.218482533244, -1.3322676295501878e-15, 166.7401466730913, 50.548811162492335, 187.74389562031587, 8.881784197001252e-16, 14.65451744352942, 269.114679723998, 22.441816483378943, 270.8050993093043, 306.2738742903947, 208.03959453649864, 215.40380851983815, 0.37568566910687773, -0.4642615181267433, -1.1102230246251565e-15, 7.338657291990618, 256.2598825722527, 71.389152383697, 289.1332151453422, 0.4999999999999989, 93.03586506961064, 218.75146890971234, 0.49999999999999956, 84.41706066445705, 10.338114000021335, 19.906345169851225, 138.8673019665193, 78.19999344413316, 305.0239867412256, -13.642366728116203, 20.102107881976856, -108.02335162796635, 486.18025029780966, 411.7768428598379, 10.427194504956812, 15.4727950950022, 145.81341194797676, 225.8723395114436, 392.3114874797854, -5.9982261924630755, 44.09786216372757, 287.7327956071272, 65.0943855257124, 9.49999999999997, 30.069962322165573, 38.997198935794316, 7.0999999999999925, 46.19672741186416, 266.4553004209611, 42.11998592980448, 26.27714165946563, 213.62269517249405, 22.64414033286385, 350.20992960251004, 152.19069210246846, 130.81386153663186, 122.40751093155282, 345.08964209932583, 204.3129787622623, 1.700000000000001, 321.3379866375367, 37.228407841191704, 70.42319958066753, 138.46572917695963, 106.65138449359301, 78.19243685071118, 104.28957102371955, 250.08059865965674, -3.2692126550487224, 192.01580840728255, 2.2, 118.30187322317622, 280.84360980055305, 0.9999999999999999, 228.45887903094103, 2.220446049250313e-15], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-383.68508640501886, -286.87867857864825, -336.720356527429, -264.510049495603, -158.8757840294817, -278.29820259723795, -200.1380804057716, -263.6500204134239, 184.80504867060665, -517.1955751232941, -327.12364842032076, -123.96100000276458, -502.8300617647695, -372.4698575033067, -457.2868021276608, -321.3274813262633, -320.4715416999881, -297.4404658676199, -391.8347846131625, -276.96502723448106, -343.54418759309016, -386.7956933500372, -504.44291967174803, -265.5695868863867, -461.74504322482557, 94.03054342392356, -35.31338477123872, -376.54956035328684, -336.7401820395228, -301.1414096259046, -252.04193025926082, -243.83293859827504, -512.4844627614272, -41.389250845205034, -118.86605407224387, -366.8199686587805, -117.25533670199556, -321.0038110346242, -309.3358137349, -272.34149084590115, -145.03669178606646, -552.5926132199818, -357.3353611945286, -275.190870348437, -315.9686973774853, -205.22888282196791, -431.4717600852979, -88.87915866911567, -353.4298737304433, -358.74627706258156, -95.36882423728224, -446.0411271952091, -183.3620340162663, -678.9620356736091, -422.98417717282143, -197.96336778107397, -363.1597025918911, -514.3303564163524, -127.70954222479963, -363.8576952803905, -531.1708738427049, -85.78148004014224, -429.954840326345, -277.9644093457077, -400.7579870570454, -54.761800023883524, -191.23144163905323, -301.12028956426855, -311.9475321257058, -94.8594842990942, 200.0, -621.1298827641181, -238.53389362542984, -425.6849904079168, -496.3336128536215, -335.76469470116535, -565.5841806145833, -339.27096454346844, -367.2947570457238, -403.62713695172704, -399.63699963851013, 193.32456946805848, -389.8470651649865, -232.11681318137272, -15.257180185350478, -517.5679231223648, -363.62771626926883, -407.48635809249936, -304.7337817016352, -199.9827110888634, -343.97267807045455, -112.96525233131624, -302.62435898707383, -343.8549549890205, -329.3797800673683, -355.5092109592412, -430.28499996770427, -388.45163170483164, -326.80326061659747, -220.12082032211578, -374.9504977336142, -104.74398872696187, -419.9729408886218, -374.78342422547814, 185.7880464242016, -317.8172620965406, -610.3965379227659, -432.662138188729, -333.9112175712575, -294.64042713044734, -295.40336220389975, -324.7458556064053, -337.18928197703536, 196.10991573415015, 184.1691602419851, -408.11446219908544, -395.23145152373365, -344.2659056232053, -477.03290463480346, -276.26220936128294, -307.3518105456385, -178.41750489025478, -118.7547641301259, -521.8958614102203, -488.01628303202597, 138.74354782222866, -311.25233292194486, -254.63895084776422, -397.915208671506, -294.860813467037, -537.482186549945, 46.77536668922984, -566.8946378294191, -350.163829147829, -102.96588262673556, -313.82588027616055, -306.46279341558807, -286.1555363833669, -295.3853677758681, -399.7171639904678, -226.42194668277867, -269.5323194648383, -341.55658071978775, -315.69618381775416, 88.56267752313299, -454.9982164275924, -327.31063430957556, -230.46186591374425, -398.5967382940756, -278.8737679879028, 6.094395290288347, -330.83687413622295, -344.4362861408864, -290.9445307465399, 30.616804023892563, -497.71416654207763, -389.6714726201202, -84.58860355634685, -616.0124001077515, -277.1545795080176, -329.87291074600387, -223.38806162093329, -119.5563249914494, -560.6990036364589, -454.32667168449547, -18.770652089381684, -349.3944855583953, -332.3439552746838, -354.66895313742987, -34.83130693551311, -322.8255891178033, -442.5509522338704, -106.83881663132553, -380.15644158244925, -249.52582523429646, -154.94512150315398, -682.8859644945052, -225.1628947688355, -334.8909026586004, -379.86148170405755, -425.87592861643174, -147.78900069154034, 14.185473786726817, -380.4751827072955, -335.39907445627813, -372.4355751458042, -364.32493845090676, 169.3596469940588, -259.1447441171646, -337.22145236215454, -149.15614373064184, -389.9328431281343, -566.2403800211655, -158.31119986177467, -283.9232754538121, -314.81137364660316, -478.7193248006949, -110.42450638602284, -348.2026263266345, -383.0755574481019], "policy_predator_policy_reward": [368.5759636256643, 402.3780388804754, 341.1727251792372, 302.6285620372432, 228.01123655648047, 123.24936904475821, 301.2961929664786, 287.6584243371452, 147.57285329650816, 516.2706510269202, 337.124180310662, 256.62345279759967, 502.9366158493437, 374.06180609841044, 494.34058672179054, 322.25666396724193, 335.923035955169, 328.60028452323957, 391.8347846131625, 277.0650272344811, 343.54418759309016, 386.80425258982893, 366.76693499493905, 519.6107329860415, 435.77092356163695, 402.8974431085956, 309.66817310479763, 359.84279428347077, 336.7401820395228, 301.48759670103067, 333.60674278393, 305.13428517815703, 274.3522818420024, 290.59059413546555, 280.27335916744323, 310.0843714554784, 386.77603618317056, 394.6055530928386, 304.9538768514382, 272.7299987106058, 470.9330435493245, 490.91397647121147, 379.86310272761426, 275.1701195455741, 315.86241853334167, 320.3642480769706, 396.46332223931216, 348.1060790483447, 353.4298737304433, 358.74627706258156, 274.5907467816812, 433.55935132390164, 425.7013745249355, 487.17150632743176, 420.52731148383316, 388.1641290903776, 363.1597025918911, 514.3303564163524, 142.83236069286184, 363.3893942558571, 500.4050989284094, 385.6619346784345, 422.398286858262, 307.96277929716956, 353.8638877169379, 372.46099867329474, 399.6353055363044, 398.99029995741057, 313.46608238347596, 301.380528577822, 485.3215931163868, 151.21209816757107, 305.0256516937201, 359.5689180087334, 336.84313267780817, 494.790913358852, 565.5841806145833, 339.27096454346844, 367.4658907348242, 410.7946605546172, 388.708740803567, 73.86357193913724, 358.53453499496345, 334.81849573509203, 375.8166979599548, 446.1416204931031, 363.62771626926883, 407.98635809249936, 289.4093998647197, 308.34295799538864, 340.7160555118909, 334.97334379959307, 302.62435898707383, 344.3549549890205, 317.95641283975004, 451.34963885131714, 335.2933374043745, 493.78140826818344, 290.1921384944346, 276.63828761412924, 480.66660009434844, 137.89518833274917, 447.9215632702369, 425.03479528799556, 298.83991310629307, 138.21328930727148, 616.2122031749791, 413.2041062084002, 320.4817129308774, 328.17203965280345, 169.81624400982784, 342.30962217251147, 317.29688897150663, 309.96272756918853, 253.3802504388651, 382.3418943780733, 435.08861797642385, 314.83593367547246, 469.2880563117194, 299.47985277936937, 326.8865214576706, 304.6962059261988, 484.11685567795496, 382.40610937383497, 265.2442778840474, 476.3399448055353, 323.7124378791234, 236.18061969812103, 397.915208671506, 338.958675630765, 572.7818541494339, 205.6577613184083, 615.8260522571998, 366.32680024576155, 112.46588262673475, 313.82588027616055, 303.50937236396453, 319.1789197571562, 301.8261558621886, 432.2735748399414, 231.3219466827784, 271.73231946483816, 364.3722834279287, 339.0772085214772, 179.86681280522933, 453.0240265201912, 281.84815512437456, 318.04433102874987, 285.40460855746494, 418.3430393839807, 303.0229017773405, 235.34227224108878, 273.43949297805517, 384.58546424223465, 476.6059970706346, 340.70129505006065, 356.9268794196958, 269.52388885923835, 594.4250292222172, 429.55581193018537, 341.596920900933, 334.07156239755614, 512.8709542778683, 512.4740164493641, 387.3074666769452, 290.10283585919547, 351.0944855583953, 332.3439552746838, 352.9991720797985, 357.839074630681, 436.902803437444, 365.7021457554227, 65.14262237111281, 492.2758354233295, 201.15037807923053, 341.78629783517874, 682.8859644945052, 331.81427926242884, 365.6199594795399, 427.32486173383, 325.447355167028, 352.5071451646631, 324.4610161755747, 291.9092914046506, 354.3380658628431, 350.22737108419057, 384.2273461679814, 2.7537536961489195, 261.3447441171644, 337.22145236215454, 269.3206938477219, 388.07016623423056, 434.36287115025516, 571.0323185332375, 283.9232754538121, 315.8113736466033, 393.14363820701175, 424.4590720106475, 348.2026263266345, 383.0755574481019]}, "sampler_perf": {"mean_raw_obs_processing_ms": 83.33974045274078, "mean_inference_ms": 71.5219587504483, "mean_action_processing_ms": 36.360132533544295, "mean_env_wait_ms": 21.718704269694253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04385256767272949, "StateBufferConnector_ms": 0.5014934539794922, "ViewRequirementAgentConnector_ms": 2.050100564956665}, "num_episodes": 64, "episode_return_max": 486.18025029780966, "episode_return_min": -108.02335162796635, "episode_return_mean": 120.10237391894489, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2702144, "num_agent_steps_trained": 2702144, "num_env_steps_sampled": 675536, "num_env_steps_trained": 675536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 263.2967398682182, "num_env_steps_trained_throughput_per_sec": 263.2967398682182, "timesteps_total": 675536, "num_env_steps_sampled_lifetime": 675536, "num_agent_steps_sampled_lifetime": 2702144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2702144, "timers": {"training_iteration_time_ms": 220240.396, "restore_workers_time_ms": 78.059, "training_step_time_ms": 220019.24, "sample_time_ms": 36690.49, "learn_time_ms": 176562.069, "learn_throughput": 48.332, "synch_weights_time_ms": 6325.904}, "counters": {"num_env_steps_sampled": 675536, "num_env_steps_trained": 675536, "num_agent_steps_sampled": 2702144, "num_agent_steps_trained": 2702144}, "done": false, "training_iteration": 84, "trial_id": "cdf01_00000", "date": "2024-08-20_13-50-04", "timestamp": 1724142004, "time_this_iter_s": 30.415515184402466, "time_total_s": 12241.434040784836, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e38ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12241.434040784836, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 34.906818181818174, "ram_util_percent": 83.39318181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.672916742733547, "cur_kl_coeff": 1.3721933745519665e-20, "cur_lr": 0.0001, "total_loss": Infinity, "policy_loss": -0.003745339300838255, "vf_loss": 9.046535352676633, "vf_explained_var": -0.23764934823626563, "kl": Infinity, "entropy": 0.11282820323156932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 53515.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.494150671883235, "cur_kl_coeff": 1.3877787807814456e-18, "cur_lr": 0.0001, "total_loss": 9.114797953953818, "policy_loss": -0.003742158647242283, "vf_loss": 9.118540100824266, "vf_explained_var": 0.3853212960182674, "kl": 0.0038336163705213356, "entropy": 0.3066354761521021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 53515.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 683536, "num_env_steps_trained": 683536, "num_agent_steps_sampled": 2734144, "num_agent_steps_trained": 2734144}, "env_runners": {"episode_reward_max": 486.18025029780966, "episode_reward_min": -108.02335162796635, "episode_reward_mean": 126.55589781566542, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -682.8859644945052, "predator_policy": 2.7537536961489195}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 682.8859644945052}, "policy_reward_mean": {"prey_policy": -291.13424117969333, "predator_policy": 354.4121900875261}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.611312910800706, 0.10000000000000209, 0.008559239791642748, 116.36516142284543, 470.95386686933114, 257.648022263741, 0.34618707512512115, 142.86615910455228, 11.069162370836333, 104.67170789189784, 343.1224415393884, -3.993429018757139, 264.21771501448904, 22.506990730221922, 115.02908641085988, 224.218482533244, -1.3322676295501878e-15, 166.7401466730913, 50.548811162492335, 187.74389562031587, 8.881784197001252e-16, 14.65451744352942, 269.114679723998, 22.441816483378943, 270.8050993093043, 306.2738742903947, 208.03959453649864, 215.40380851983815, 0.37568566910687773, -0.4642615181267433, -1.1102230246251565e-15, 7.338657291990618, 256.2598825722527, 71.389152383697, 289.1332151453422, 0.4999999999999989, 93.03586506961064, 218.75146890971234, 0.49999999999999956, 84.41706066445705, 10.338114000021335, 19.906345169851225, 138.8673019665193, 78.19999344413316, 305.0239867412256, -13.642366728116203, 20.102107881976856, -108.02335162796635, 486.18025029780966, 411.7768428598379, 10.427194504956812, 15.4727950950022, 145.81341194797676, 225.8723395114436, 392.3114874797854, -5.9982261924630755, 44.09786216372757, 287.7327956071272, 65.0943855257124, 9.49999999999997, 30.069962322165573, 38.997198935794316, 7.0999999999999925, 46.19672741186416, 266.4553004209611, 42.11998592980448, 26.27714165946563, 213.62269517249405, 22.64414033286385, 350.20992960251004, 152.19069210246846, 130.81386153663186, 122.40751093155282, 345.08964209932583, 204.3129787622623, 1.700000000000001, 321.3379866375367, 37.228407841191704, 70.42319958066753, 138.46572917695963, 106.65138449359301, 78.19243685071118, 104.28957102371955, 250.08059865965674, -3.2692126550487224, 192.01580840728255, 2.2, 118.30187322317622, 280.84360980055305, 0.9999999999999999, 228.45887903094103, 2.220446049250313e-15, 470.0477142994148, 25.791575294778305, 222.7991825396639, 475.99052306936665, 71.7430434233223, 53.44571763405515, -6.790504469422576, 28.336824526444804], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-320.4715416999881, -297.4404658676199, -391.8347846131625, -276.96502723448106, -343.54418759309016, -386.7956933500372, -504.44291967174803, -265.5695868863867, -461.74504322482557, 94.03054342392356, -35.31338477123872, -376.54956035328684, -336.7401820395228, -301.1414096259046, -252.04193025926082, -243.83293859827504, -512.4844627614272, -41.389250845205034, -118.86605407224387, -366.8199686587805, -117.25533670199556, -321.0038110346242, -309.3358137349, -272.34149084590115, -145.03669178606646, -552.5926132199818, -357.3353611945286, -275.190870348437, -315.9686973774853, -205.22888282196791, -431.4717600852979, -88.87915866911567, -353.4298737304433, -358.74627706258156, -95.36882423728224, -446.0411271952091, -183.3620340162663, -678.9620356736091, -422.98417717282143, -197.96336778107397, -363.1597025918911, -514.3303564163524, -127.70954222479963, -363.8576952803905, -531.1708738427049, -85.78148004014224, -429.954840326345, -277.9644093457077, -400.7579870570454, -54.761800023883524, -191.23144163905323, -301.12028956426855, -311.9475321257058, -94.8594842990942, 200.0, -621.1298827641181, -238.53389362542984, -425.6849904079168, -496.3336128536215, -335.76469470116535, -565.5841806145833, -339.27096454346844, -367.2947570457238, -403.62713695172704, -399.63699963851013, 193.32456946805848, -389.8470651649865, -232.11681318137272, -15.257180185350478, -517.5679231223648, -363.62771626926883, -407.48635809249936, -304.7337817016352, -199.9827110888634, -343.97267807045455, -112.96525233131624, -302.62435898707383, -343.8549549890205, -329.3797800673683, -355.5092109592412, -430.28499996770427, -388.45163170483164, -326.80326061659747, -220.12082032211578, -374.9504977336142, -104.74398872696187, -419.9729408886218, -374.78342422547814, 185.7880464242016, -317.8172620965406, -610.3965379227659, -432.662138188729, -333.9112175712575, -294.64042713044734, -295.40336220389975, -324.7458556064053, -337.18928197703536, 196.10991573415015, 184.1691602419851, -408.11446219908544, -395.23145152373365, -344.2659056232053, -477.03290463480346, -276.26220936128294, -307.3518105456385, -178.41750489025478, -118.7547641301259, -521.8958614102203, -488.01628303202597, 138.74354782222866, -311.25233292194486, -254.63895084776422, -397.915208671506, -294.860813467037, -537.482186549945, 46.77536668922984, -566.8946378294191, -350.163829147829, -102.96588262673556, -313.82588027616055, -306.46279341558807, -286.1555363833669, -295.3853677758681, -399.7171639904678, -226.42194668277867, -269.5323194648383, -341.55658071978775, -315.69618381775416, 88.56267752313299, -454.9982164275924, -327.31063430957556, -230.46186591374425, -398.5967382940756, -278.8737679879028, 6.094395290288347, -330.83687413622295, -344.4362861408864, -290.9445307465399, 30.616804023892563, -497.71416654207763, -389.6714726201202, -84.58860355634685, -616.0124001077515, -277.1545795080176, -329.87291074600387, -223.38806162093329, -119.5563249914494, -560.6990036364589, -454.32667168449547, -18.770652089381684, -349.3944855583953, -332.3439552746838, -354.66895313742987, -34.83130693551311, -322.8255891178033, -442.5509522338704, -106.83881663132553, -380.15644158244925, -249.52582523429646, -154.94512150315398, -682.8859644945052, -225.1628947688355, -334.8909026586004, -379.86148170405755, -425.87592861643174, -147.78900069154034, 14.185473786726817, -380.4751827072955, -335.39907445627813, -372.4355751458042, -364.32493845090676, 169.3596469940588, -259.1447441171646, -337.22145236215454, -149.15614373064184, -389.9328431281343, -566.2403800211655, -158.31119986177467, -283.9232754538121, -314.81137364660316, -478.7193248006949, -110.42450638602284, -348.2026263266345, -383.0755574481019, 187.3692513479366, -401.65681976222686, -503.59552291747946, -351.5051691124386, -1.305284812874508, -294.6003259287949, 189.48035827574384, -403.01395413440684, -431.25678785521825, -329.2291888214554, -294.8451322081921, -385.21105147684744, -240.98998750980692, -291.28631143237976, -409.716872316558, -332.6566576771823], "policy_predator_policy_reward": [335.923035955169, 328.60028452323957, 391.8347846131625, 277.0650272344811, 343.54418759309016, 386.80425258982893, 366.76693499493905, 519.6107329860415, 435.77092356163695, 402.8974431085956, 309.66817310479763, 359.84279428347077, 336.7401820395228, 301.48759670103067, 333.60674278393, 305.13428517815703, 274.3522818420024, 290.59059413546555, 280.27335916744323, 310.0843714554784, 386.77603618317056, 394.6055530928386, 304.9538768514382, 272.7299987106058, 470.9330435493245, 490.91397647121147, 379.86310272761426, 275.1701195455741, 315.86241853334167, 320.3642480769706, 396.46332223931216, 348.1060790483447, 353.4298737304433, 358.74627706258156, 274.5907467816812, 433.55935132390164, 425.7013745249355, 487.17150632743176, 420.52731148383316, 388.1641290903776, 363.1597025918911, 514.3303564163524, 142.83236069286184, 363.3893942558571, 500.4050989284094, 385.6619346784345, 422.398286858262, 307.96277929716956, 353.8638877169379, 372.46099867329474, 399.6353055363044, 398.99029995741057, 313.46608238347596, 301.380528577822, 485.3215931163868, 151.21209816757107, 305.0256516937201, 359.5689180087334, 336.84313267780817, 494.790913358852, 565.5841806145833, 339.27096454346844, 367.4658907348242, 410.7946605546172, 388.708740803567, 73.86357193913724, 358.53453499496345, 334.81849573509203, 375.8166979599548, 446.1416204931031, 363.62771626926883, 407.98635809249936, 289.4093998647197, 308.34295799538864, 340.7160555118909, 334.97334379959307, 302.62435898707383, 344.3549549890205, 317.95641283975004, 451.34963885131714, 335.2933374043745, 493.78140826818344, 290.1921384944346, 276.63828761412924, 480.66660009434844, 137.89518833274917, 447.9215632702369, 425.03479528799556, 298.83991310629307, 138.21328930727148, 616.2122031749791, 413.2041062084002, 320.4817129308774, 328.17203965280345, 169.81624400982784, 342.30962217251147, 317.29688897150663, 309.96272756918853, 253.3802504388651, 382.3418943780733, 435.08861797642385, 314.83593367547246, 469.2880563117194, 299.47985277936937, 326.8865214576706, 304.6962059261988, 484.11685567795496, 382.40610937383497, 265.2442778840474, 476.3399448055353, 323.7124378791234, 236.18061969812103, 397.915208671506, 338.958675630765, 572.7818541494339, 205.6577613184083, 615.8260522571998, 366.32680024576155, 112.46588262673475, 313.82588027616055, 303.50937236396453, 319.1789197571562, 301.8261558621886, 432.2735748399414, 231.3219466827784, 271.73231946483816, 364.3722834279287, 339.0772085214772, 179.86681280522933, 453.0240265201912, 281.84815512437456, 318.04433102874987, 285.40460855746494, 418.3430393839807, 303.0229017773405, 235.34227224108878, 273.43949297805517, 384.58546424223465, 476.6059970706346, 340.70129505006065, 356.9268794196958, 269.52388885923835, 594.4250292222172, 429.55581193018537, 341.596920900933, 334.07156239755614, 512.8709542778683, 512.4740164493641, 387.3074666769452, 290.10283585919547, 351.0944855583953, 332.3439552746838, 352.9991720797985, 357.839074630681, 436.902803437444, 365.7021457554227, 65.14262237111281, 492.2758354233295, 201.15037807923053, 341.78629783517874, 682.8859644945052, 331.81427926242884, 365.6199594795399, 427.32486173383, 325.447355167028, 352.5071451646631, 324.4610161755747, 291.9092914046506, 354.3380658628431, 350.22737108419057, 384.2273461679814, 2.7537536961489195, 261.3447441171644, 337.22145236215454, 269.3206938477219, 388.07016623423056, 434.36287115025516, 571.0323185332375, 283.9232754538121, 315.8113736466033, 393.14363820701175, 424.4590720106475, 348.2026263266345, 383.0755574481019, 326.5374149555944, 357.7978677581122, 504.87259134437477, 376.0196759803223, 276.1783111247609, 242.52648215657274, 292.7168379135552, 396.80728101447437, 321.27266910395264, 510.9563509960434, 378.47251169903666, 355.0293896200587, 385.0007594322373, 140.4850350405274, 324.132212269753, 446.5781422504322]}, "sampler_perf": {"mean_raw_obs_processing_ms": 83.35509918003969, "mean_inference_ms": 71.60555050877241, "mean_action_processing_ms": 36.22533938673061, "mean_env_wait_ms": 21.57558837153307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03363466262817383, "StateBufferConnector_ms": 0.37671518325805664, "ViewRequirementAgentConnector_ms": 1.5804526805877686}, "num_episodes": 8, "episode_return_max": 486.18025029780966, "episode_return_min": -108.02335162796635, "episode_return_mean": 126.55589781566542, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2734144, "num_agent_steps_trained": 2734144, "num_env_steps_sampled": 683536, "num_env_steps_trained": 683536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 266.33694037151133, "num_env_steps_trained_throughput_per_sec": 266.33694037151133, "timesteps_total": 683536, "num_env_steps_sampled_lifetime": 683536, "num_agent_steps_sampled_lifetime": 2734144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2734144, "timers": {"training_iteration_time_ms": 187033.534, "restore_workers_time_ms": 74.424, "training_step_time_ms": 186822.43, "sample_time_ms": 27872.388, "learn_time_ms": 152323.315, "learn_throughput": 52.52, "synch_weights_time_ms": 6205.483}, "counters": {"num_env_steps_sampled": 683536, "num_env_steps_trained": 683536, "num_agent_steps_sampled": 2734144, "num_agent_steps_trained": 2734144}, "done": false, "training_iteration": 85, "trial_id": "cdf01_00000", "date": "2024-08-20_13-50-34", "timestamp": 1724142034, "time_this_iter_s": 30.07885503768921, "time_total_s": 12271.512895822525, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a528e040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12271.512895822525, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 34.61190476190476, "ram_util_percent": 83.41190476190476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.775551560189989, "cur_kl_coeff": 2.0582900618279502e-20, "cur_lr": 0.0001, "total_loss": 8.547938245440287, "policy_loss": -0.004174156555358971, "vf_loss": 8.55211239390903, "vf_explained_var": -0.1660237847812592, "kl": 0.0022394606889292847, "entropy": 0.13129013242229584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 54145.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.42389869273655, "cur_kl_coeff": 6.938893903907228e-19, "cur_lr": 0.0001, "total_loss": 8.603274052483695, "policy_loss": -0.002908546907923347, "vf_loss": 8.606182656212459, "vf_explained_var": 0.39907641808191935, "kl": 0.003503486834272605, "entropy": 0.32011792860806937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 54145.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 691536, "num_env_steps_trained": 691536, "num_agent_steps_sampled": 2766144, "num_agent_steps_trained": 2766144}, "env_runners": {"episode_reward_max": 475.99052306936665, "episode_reward_min": -25.078128753532223, "episode_reward_mean": 107.00263613144465, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -713.5806354496153, "predator_policy": 2.7537536961489195}, "policy_reward_max": {"prey_policy": 195.50526682047325, "predator_policy": 682.8859644945052}, "policy_reward_mean": {"prey_policy": -282.9557125899084, "predator_policy": 336.45703065563083}, "custom_metrics": {}, "hist_stats": {"episode_reward": [122.40751093155282, 345.08964209932583, 204.3129787622623, 1.700000000000001, 321.3379866375367, 37.228407841191704, 70.42319958066753, 138.46572917695963, 106.65138449359301, 78.19243685071118, 104.28957102371955, 250.08059865965674, -3.2692126550487224, 192.01580840728255, 2.2, 118.30187322317622, 280.84360980055305, 0.9999999999999999, 228.45887903094103, 2.220446049250313e-15, 470.0477142994148, 25.791575294778305, 222.7991825396639, 475.99052306936665, 71.7430434233223, 53.44571763405515, -6.790504469422576, 28.336824526444804, 172.7600674344519, 67.82250715347465, -3.7360026236498176, 116.24972400563499, 256.39765163361756, 82.96532279693935, 266.7754132637773, 0.4000000000000019, 13.8613613424282, 5.496731815196746, 245.53894216587548, 177.4123966770372, 15.5602239392003, 99.15459277710649, 6.661338147750939e-16, -25.078128753532223, 236.2338070966805, 127.69208070676109, 14.972885025075135, 196.25654136725848, 155.07444714557445, -10.714964466632368, -8.881784197001252e-16, 241.37014439446966, 325.6438842114401, 114.83026685538515, 1.9999999999999998, -0.12586986193181948, -3.849344537447474, 20.709121668818497, -16.967751547845403, 32.27881376719183, 19.66588618668516, 27.27646620105034, 200.83144664437043, 36.849902403909546, 356.5945957980577, 45.335159720127976, 186.9482878930013, 148.7755248405327, -4.052678192986301, -2.7849929323642155, 56.407970005295034, -9.574379685935758, 207.82294686117496, 82.84632683120232, 46.32293914469143, 43.32264216195144, 8.643161454363398, 337.6244502316119, 202.4948580198695, 3.503231236824381, -16.65808858660749, 45.0260505984495, 204.75827246388425, 286.60024128516375, 71.33676463915651, -4.606144844624876, 63.173486808219536, 28.598444086119308, 16.176284541322847, 10.529819168646155, 25.186352873742365, 59.70726337226738, 85.36616619337562, 15.897190180036553, 42.93783737026704, 395.15129853826244, 66.57877248542957, 71.85770221381752, 206.9391600178542, 162.77364928219217], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-329.87291074600387, -223.38806162093329, -119.5563249914494, -560.6990036364589, -454.32667168449547, -18.770652089381684, -349.3944855583953, -332.3439552746838, -354.66895313742987, -34.83130693551311, -322.8255891178033, -442.5509522338704, -106.83881663132553, -380.15644158244925, -249.52582523429646, -154.94512150315398, -682.8859644945052, -225.1628947688355, -334.8909026586004, -379.86148170405755, -425.87592861643174, -147.78900069154034, 14.185473786726817, -380.4751827072955, -335.39907445627813, -372.4355751458042, -364.32493845090676, 169.3596469940588, -259.1447441171646, -337.22145236215454, -149.15614373064184, -389.9328431281343, -566.2403800211655, -158.31119986177467, -283.9232754538121, -314.81137364660316, -478.7193248006949, -110.42450638602284, -348.2026263266345, -383.0755574481019, 187.3692513479366, -401.65681976222686, -503.59552291747946, -351.5051691124386, -1.305284812874508, -294.6003259287949, 189.48035827574384, -403.01395413440684, -431.25678785521825, -329.2291888214554, -294.8451322081921, -385.21105147684744, -240.98998750980692, -291.28631143237976, -409.716872316558, -332.6566576771823, 127.79457709914189, -382.07749223825994, -334.4135337817474, -376.9203615670741, -353.36243319830487, -107.69620342746671, -331.64095050350124, -97.13568558188629, 191.09628218893084, -378.3885114064369, -178.50814171045354, -197.432533494065, -71.8557413474516, -465.5538129751459, -542.2108271364958, -295.22989652401105, -283.40957782716555, -420.42786852523545, -290.456360108511, -323.67159779450975, 122.56641031923208, -233.15846783526678, 20.000000000000014, -353.7933794687886, -469.4921294850123, -338.31664818129127, -509.8000848520387, -194.6226492090063, -382.62198072064996, -373.85158354027607, -220.40634337799793, -396.32743146368983, 167.08233814255718, -436.504050535391, -368.21278179006634, -148.93557307969732, -235.5296320040301, -322.0477249526606, -419.562749876728, -410.56266963547677, -279.9963402003583, -298.73329835856254, -320.16048641985003, -304.0164611109547, -299.10817288133006, -315.93567328450604, -213.78021183763724, -105.83418384583045, -24.186749567160348, -397.9532692731289, -135.31749799413728, -467.24327578897896, -349.0142945336034, -384.2492197525655, -596.8538271961838, -442.0079072799555, -353.3494325926621, -346.39879104755084, -328.63866156562796, -259.70767828834073, -307.8566097842557, -402.0462921964016, -317.51440070880966, -171.76270593821502, -139.05959204462926, -437.9131213010529, -193.38988541709554, -347.92854569531494, -144.42471153439547, -306.8783712302873, -321.45613885277953, -339.11911998725714, -599.0759026436015, 185.80027888336332, -327.98951949469995, -338.72463399289603, -81.34583866681542, -713.5806354496153, -132.7728812903951, -412.27510111619, -164.38524809182022, -264.0776686995907, -294.5866524718022, -303.61989447719446, -160.83950155459448, -323.9743236756695, -266.5610092972768, -353.27007616568665, -361.2845334545217, -144.2505327559424, -219.74134594462188, -313.05882285975713, -343.41777101176586, -281.1000100928371, -363.8996704846242, -390.17883351566013, -170.8705680391601, -243.65142295475923, -304.9588429464217, 69.74855598096836, -392.97890467664405, 195.50526682047325, -255.14301580988362, -293.08801076809107, -368.70846995360245, -438.5768047218641, -60.71875664317589, -424.2544067397541, -446.03036369471386, 176.08904616641695, -306.313948548189, -59.39335954452517, -353.99944572787206, -269.55249728363947, -578.1996593159553, -324.28921172476447, -368.7789742947457, -464.00327765578106, -419.7994132165583, -447.8754578993213, -391.8258663761121, -293.0942948420852, -247.93280192913426, -210.52307754814416, -465.16299856800623, -359.04660863547906, -204.69737325653776, -297.6817358271985, -238.94917317371818, -409.36643112056544, -460.8618160262354, -93.30496116924014, -344.19645560120813, -379.0803777708636, -352.3390473529451, 174.9581711263302, -343.2604066816449, -296.62735197698316, -376.3023742515916, -293.7590434524009, 166.25161021789629, -351.32796989847805, -545.9557897040918, -218.13776521592135], "policy_predator_policy_reward": [341.596920900933, 334.07156239755614, 512.8709542778683, 512.4740164493641, 387.3074666769452, 290.10283585919547, 351.0944855583953, 332.3439552746838, 352.9991720797985, 357.839074630681, 436.902803437444, 365.7021457554227, 65.14262237111281, 492.2758354233295, 201.15037807923053, 341.78629783517874, 682.8859644945052, 331.81427926242884, 365.6199594795399, 427.32486173383, 325.447355167028, 352.5071451646631, 324.4610161755747, 291.9092914046506, 354.3380658628431, 350.22737108419057, 384.2273461679814, 2.7537536961489195, 261.3447441171644, 337.22145236215454, 269.3206938477219, 388.07016623423056, 434.36287115025516, 571.0323185332375, 283.9232754538121, 315.8113736466033, 393.14363820701175, 424.4590720106475, 348.2026263266345, 383.0755574481019, 326.5374149555944, 357.7978677581122, 504.87259134437477, 376.0196759803223, 276.1783111247609, 242.52648215657274, 292.7168379135552, 396.80728101447437, 321.27266910395264, 510.9563509960434, 378.47251169903666, 355.0293896200587, 385.0007594322373, 140.4850350405274, 324.132212269753, 446.5781422504322, 40.668611441197754, 386.3743711323721, 444.5002602416422, 334.6561422606535, 128.94326005409414, 328.37937394802697, 165.7869981729177, 379.2393619181047, 67.66921888759522, 376.0206619635286, 203.61382956603975, 255.29216843541784, 360.6105231007708, 443.57444448560335, 542.4108271364958, 295.42989652401104, 294.8709391695937, 422.827868525236, 290.85636010851096, 328.76832960970654, 222.52327076113062, 133.60772892077944, 160.51635102435898, 350.68942512146793, 475.2582136417461, 348.1107879637583, 514.2582786559893, 289.3190481821621, 382.62198072064996, 373.85158354027607, 193.52958617680935, 398.1260599113461, 78.3286164068844, 427.32690308263005, 351.61123507704633, 293.2292004994791, 239.32963200403012, 333.22060997773565, 373.45080332517716, 652.9311575542889, 433.94152690682637, 299.86255879767003, 327.42636812392504, 286.03561494024717, 299.10817288133006, 315.93567328450604, 266.7376013994208, 294.2469386785171, 390.56462917271523, 357.2192738790142, 252.12190163321108, 465.2691390052896, 350.9142945336034, 384.34921975256555, 597.3106052604294, 441.425259353778, 361.1765881686226, 334.72229093414313, 279.9111295431794, 329.1443319796073, 314.0787244289751, 378.8564260038367, 169.289992049081, 352.26592836513703, 438.07438682762734, 158.5642127047401, 397.44705030048334, 171.1478470129767, 330.93916346340905, 321.1953659456445, 387.14187150768294, 310.28328973626475, 543.5660546039045, 226.3041649543898, 379.96394779916767, 332.0853654085567, 679.0499624048873, 302.8247996045456, 317.154061717056, 376.669445530061, 141.45663084224944, 282.95360775617587, 290.8705287750666, 304.5510252415659, 215.89489027939194, 325.3269049561669, 253.440088572127, 356.81661720489944, 367.3253600342213, 346.03265303741847, 304.0240248539599, 311.6224707816222, 349.5788327885672, 321.26188746072705, 359.0552371662945, 438.3459089959411, 101.46805143364249, 321.6971010146395, 290.10644842714777, 282.72828876991707, 392.9675068728457, 7.000989003194584, 359.3900885161983, 192.34416929860112, 391.81550160929623, 398.8116844795623, 320.3937630019013, 209.60545097947792, 446.23036369471384, 28.469226297467333, 282.667723969513, 369.63982540836525, 367.8117196949411, 327.07698795572713, 595.8224407312647, 302.06028546483014, 463.59877006663004, 432.3569686921171, 460.57852146477023, 435.6947937372295, 407.05256869067193, 294.04387706884876, 220.30676475277184, 248.6789338931526, 465.4630591903233, 383.9329008869043, 249.74564694332116, 312.3407255126822, 409.09186687316156, 324.5899036144977, 459.3885086710804, 110.67545870443206, 333.8362295725072, 432.3784411698314, 257.4680249277326, 315.064149837146, 302.373638405661, 404.0928927383977, 244.6706008832814, 497.2485190345294, 119.24117822349736, 272.77434147493926, 498.07838630239974, 428.7888178998056]}, "sampler_perf": {"mean_raw_obs_processing_ms": 81.85181691138004, "mean_inference_ms": 70.29778571453453, "mean_action_processing_ms": 35.55561476262026, "mean_env_wait_ms": 21.181589629780145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003641963005065918, "StateBufferConnector_ms": 0.06458926200866699, "ViewRequirementAgentConnector_ms": 0.12687671184539795}, "num_episodes": 72, "episode_return_max": 475.99052306936665, "episode_return_min": -25.078128753532223, "episode_return_mean": 107.00263613144465, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2766144, "num_agent_steps_trained": 2766144, "num_env_steps_sampled": 691536, "num_env_steps_trained": 691536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 264.19898511542834, "num_env_steps_trained_throughput_per_sec": 264.19898511542834, "timesteps_total": 691536, "num_env_steps_sampled_lifetime": 691536, "num_agent_steps_sampled_lifetime": 2766144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2766144, "timers": {"training_iteration_time_ms": 169484.805, "restore_workers_time_ms": 73.027, "training_step_time_ms": 169276.329, "sample_time_ms": 26454.982, "learn_time_ms": 136278.953, "learn_throughput": 58.703, "synch_weights_time_ms": 6126.876}, "counters": {"num_env_steps_sampled": 691536, "num_env_steps_trained": 691536, "num_agent_steps_sampled": 2766144, "num_agent_steps_trained": 2766144}, "done": false, "training_iteration": 86, "trial_id": "cdf01_00000", "date": "2024-08-20_13-51-05", "timestamp": 1724142065, "time_this_iter_s": 30.316476345062256, "time_total_s": 12301.829372167587, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e38dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12301.829372167587, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 37.734883720930235, "ram_util_percent": 83.32093023255815}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.65726471193253, "cur_kl_coeff": 1.0291450309139751e-20, "cur_lr": 0.0001, "total_loss": 8.952667885734922, "policy_loss": -0.003007287845119006, "vf_loss": 8.955675165993826, "vf_explained_var": -0.44101414614253576, "kl": 0.0020020530742623946, "entropy": 0.1259598816907595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 54775.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.361462504144699, "cur_kl_coeff": 3.469446951953614e-19, "cur_lr": 0.0001, "total_loss": 8.877907668219672, "policy_loss": -0.0031433619891426392, "vf_loss": 8.881051002986847, "vf_explained_var": 0.40954159441448396, "kl": 0.0032071641511150135, "entropy": 0.3283813198407491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 54775.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 699536, "num_env_steps_trained": 699536, "num_agent_steps_sampled": 2798144, "num_agent_steps_trained": 2798144}, "env_runners": {"episode_reward_max": 490.59932254414156, "episode_reward_min": -43.66971624676578, "episode_reward_mean": 99.63822812799151, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -751.6304885650702, "predator_policy": 7.000989003194584}, "policy_reward_max": {"prey_policy": 196.9887008598437, "predator_policy": 720.5889156156068}, "policy_reward_mean": {"prey_policy": -294.36642762988436, "predator_policy": 344.18554169388017}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.5945957980577, 45.335159720127976, 186.9482878930013, 148.7755248405327, -4.052678192986301, -2.7849929323642155, 56.407970005295034, -9.574379685935758, 207.82294686117496, 82.84632683120232, 46.32293914469143, 43.32264216195144, 8.643161454363398, 337.6244502316119, 202.4948580198695, 3.503231236824381, -16.65808858660749, 45.0260505984495, 204.75827246388425, 286.60024128516375, 71.33676463915651, -4.606144844624876, 63.173486808219536, 28.598444086119308, 16.176284541322847, 10.529819168646155, 25.186352873742365, 59.70726337226738, 85.36616619337562, 15.897190180036553, 42.93783737026704, 395.15129853826244, 66.57877248542957, 71.85770221381752, 206.9391600178542, 162.77364928219217, -11.614816943763328, 177.8320797577831, 104.1334975233071, 361.2492394320804, 303.74001778359167, 95.25963631196795, 0.8, -13.343052658866101, 100.15186470743879, 296.42024864385854, 160.3464094435907, 231.77328291310894, 131.9562320985991, 74.97634558932461, 0.8000000000000034, 39.14216461081317, 263.15671836280416, 223.12672650631052, -3.1086244689504383e-15, 0.09999999999999831, 18.48701936228011, 1.832567856736346, 153.88366056771463, 193.94116797138958, 26.62298934485623, 136.87266820813377, -0.9399816928206104, 164.06236414884302, 15.899999999999972, 27.875686418248108, -1.3322676295501878e-15, 34.752952469903335, 172.38116298830266, 4.5, 11.588215883006956, 65.39223111738728, 104.42881758240631, 134.77338706584382, -2.054479307322128, 234.783050499749, 336.45613049512286, -2.799773584533591, 124.24562531477348, 490.59932254414156, 64.75654552819111, 7.014173395985422, 54.69348977927343, 59.17580914327222, 98.31401095803892, 78.48529897938437, 225.78328145737112, -43.66971624676578, -0.9600600988492265, -13.063651457186578, 2.700000000000002, -1.4557797467089935, 2.5000000000000027, 19.238046580249506, 8.339104970606332, 429.6057610794566, 4.823062122511116, 373.7839002442384, 58.30297887911894, 0.3046118204614596], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-599.0759026436015, 185.80027888336332, -327.98951949469995, -338.72463399289603, -81.34583866681542, -713.5806354496153, -132.7728812903951, -412.27510111619, -164.38524809182022, -264.0776686995907, -294.5866524718022, -303.61989447719446, -160.83950155459448, -323.9743236756695, -266.5610092972768, -353.27007616568665, -361.2845334545217, -144.2505327559424, -219.74134594462188, -313.05882285975713, -343.41777101176586, -281.1000100928371, -363.8996704846242, -390.17883351566013, -170.8705680391601, -243.65142295475923, -304.9588429464217, 69.74855598096836, -392.97890467664405, 195.50526682047325, -255.14301580988362, -293.08801076809107, -368.70846995360245, -438.5768047218641, -60.71875664317589, -424.2544067397541, -446.03036369471386, 176.08904616641695, -306.313948548189, -59.39335954452517, -353.99944572787206, -269.55249728363947, -578.1996593159553, -324.28921172476447, -368.7789742947457, -464.00327765578106, -419.7994132165583, -447.8754578993213, -391.8258663761121, -293.0942948420852, -247.93280192913426, -210.52307754814416, -465.16299856800623, -359.04660863547906, -204.69737325653776, -297.6817358271985, -238.94917317371818, -409.36643112056544, -460.8618160262354, -93.30496116924014, -344.19645560120813, -379.0803777708636, -352.3390473529451, 174.9581711263302, -343.2604066816449, -296.62735197698316, -376.3023742515916, -293.7590434524009, 166.25161021789629, -351.32796989847805, -545.9557897040918, -218.13776521592135, -231.85187609076428, -409.7006845392869, -144.44794741234708, -244.18235354179572, -371.49361642178593, -276.7022099622802, -519.8899979644531, -420.01914236714214, 177.16655758479052, -333.53309401945967, -254.4834536361007, -299.127927592241, -250.22432305190247, -450.3110433579117, -349.88655180739806, -337.1045053710568, -343.13479880945175, -309.1681732963339, 196.41849975701152, -400.2236201445928, 153.1763827622944, -438.001660558862, -438.509681601376, 129.4561931780966, -143.20141350585283, -238.56223697106705, -202.65937326150623, -365.97883869003863, -464.8701034708347, -544.8378694567094, -314.2907974962713, -269.71692709842307, 168.86009846861802, -442.0405307652711, -367.44795595965303, 0.4093099165388707, -562.5219680923757, -302.6961677438733, -300.7410632891539, -342.907170100145, -322.8156662039012, -312.5431369251731, -387.1842446733838, -366.65506687873, -360.630241861142, -177.44618236896065, -306.81695689289654, -85.57479428370586, -175.59671530353978, -366.0151992556543, -241.97883539357395, -419.37832644695095, -342.05374996724123, -387.784006203412, -26.23683431921464, -589.2352346004183, -132.26718936373172, -308.6330546106704, -407.1712315910565, -373.7477402657152, -497.47680111437745, -610.0371132089646, -200.57440362628543, -421.9134336831245, -312.457203733791, -226.89249787985358, -278.4440008107114, -340.80151384909726, -445.75246290879295, -494.67627261262464, -341.0647243572748, -236.38796088435288, -501.0189272896886, -88.60748079312884, -155.1526702912993, -302.9235980802944, -580.4912192309793, -388.36101794962957, 174.2910045597046, -536.6181397088593, -449.57900869760044, -3.748190207035439, -388.6650859472148, -189.85331177448182, -386.01992647050486, -174.52037939290554, 178.74015737625527, -364.4728891237815, -323.07476277342647, -253.49026180068316, -542.8647173554072, -251.1602383195736, -330.32858849864095, -66.84366182547154, -195.1241318584042, -350.30174776975025, -177.11768261067306, -476.83077030171046, -257.9357560530568, -259.27220029613034, -22.785818918968246, -276.4019417600199, -283.676928741028, -279.0953583065246, -321.51048170590866, -347.20011290084943, -420.93715328871497, -383.9404936805361, -453.4218098169704, -328.88025382818415, -375.5013980894371, -469.5642144445477, -356.72271612584836, -290.74117344141365, -435.4644508100616, -299.25874921626655, -459.9369741410332, -344.67812816084563, 196.9887008598437, -461.23479658271674, -351.00911492850975, -471.3310343278796, -21.116047868701543, -751.6304885650702, -345.0629097114069, -225.5644563383995, -588.3184434418154, -358.44273280185473], "policy_predator_policy_reward": [543.5660546039045, 226.3041649543898, 379.96394779916767, 332.0853654085567, 679.0499624048873, 302.8247996045456, 317.154061717056, 376.669445530061, 141.45663084224944, 282.95360775617587, 290.8705287750666, 304.5510252415659, 215.89489027939194, 325.3269049561669, 253.440088572127, 356.81661720489944, 367.3253600342213, 346.03265303741847, 304.0240248539599, 311.6224707816222, 349.5788327885672, 321.26188746072705, 359.0552371662945, 438.3459089959411, 101.46805143364249, 321.6971010146395, 290.10644842714777, 282.72828876991707, 392.9675068728457, 7.000989003194584, 359.3900885161983, 192.34416929860112, 391.81550160929623, 398.8116844795623, 320.3937630019013, 209.60545097947792, 446.23036369471384, 28.469226297467333, 282.667723969513, 369.63982540836525, 367.8117196949411, 327.07698795572713, 595.8224407312647, 302.06028546483014, 463.59877006663004, 432.3569686921171, 460.57852146477023, 435.6947937372295, 407.05256869067193, 294.04387706884876, 220.30676475277184, 248.6789338931526, 465.4630591903233, 383.9329008869043, 249.74564694332116, 312.3407255126822, 409.09186687316156, 324.5899036144977, 459.3885086710804, 110.67545870443206, 333.8362295725072, 432.3784411698314, 257.4680249277326, 315.064149837146, 302.373638405661, 404.0928927383977, 244.6706008832814, 497.2485190345294, 119.24117822349736, 272.77434147493926, 498.07838630239974, 428.7888178998056, 261.8110920422394, 368.1266516440488, 278.5752439758873, 287.8871367360377, 369.19068596780767, 383.13863793956585, 580.5694641480699, 720.5889156156068, 139.1297366499331, 320.97681756832696, 330.53171913667245, 318.3392984036373, 251.02432305190248, 450.3110433579117, 324.58844903925893, 349.05955548032966, 345.0241085013419, 407.43072831188255, 100.19529218613881, 400.0300768453009, 7.170026681296287, 438.001660558862, 297.32243394473824, 243.50433739165163, 296.6826693408051, 217.03721323471427, 525.7488114375029, 117.8657461033662, 464.8701034708347, 545.6378694567095, 234.12665331216465, 389.0232358933441, 114.35701432661443, 421.98013633284273, 254.98457939324038, 335.1807931561851, 562.5219680923757, 302.6961677438733, 300.7410632891539, 343.00717010014495, 336.87861163356047, 316.96721085779393, 389.01681253012015, 366.65506687873, 363.6590556822725, 328.3010291155459, 284.34908857192863, 301.98383057606173, 211.17923154020588, 357.0556723638445, 382.1764366849413, 416.05339336371617, 375.5963964585875, 353.3013780192456, 237.5637336668954, 541.9706994015819, 148.16718936373115, 308.6330546106704, 438.9456406465072, 369.8490176285128, 497.47680111437745, 610.0371132089646, 235.32735609618834, 421.9134336831245, 404.381466758138, 307.34939784380924, 280.7440008107113, 343.00151384909714, 451.47903809296554, 500.53791331145976, 277.2020335413188, 365.6428828176962, 179.03153446213966, 515.0236912030836, 325.6159515039569, 267.23370393348057, 386.306538642308, 580.4912192309793, 452.041912470755, 145.0682731781496, 405.74625257649865, 384.0370768232582, 195.46874018070594, 380.24988395645664, 334.5204942747903, 350.26543690339355, 350.4771184768563, 325.8549358148121, 323.7448416738785, 317.57672842842146, 542.8647173554072, 258.1744117155591, 133.4269573874877, 318.4387827158985, 254.2241318584042, 350.3775569130225, 213.46776340091577, 538.7947004695063, 329.90854014035, 265.78471518822073, 378.5238611800157, 146.4471809563428, 441.723307005763, 77.37926379502456, 322.33346172462666, 345.4170727832821, 420.43503974579767, 371.3789557662662, 453.4218098169704, 331.5802538281841, 371.61207587081736, 471.9977569164598, 356.72271612584836, 293.2411734414142, 369.83583817788497, 384.1254084286921, 457.62160495769484, 355.3326023147903, 419.13456918596523, 274.71728761636405, 338.6550738203331, 488.5081375585675, 560.4287794772212, 586.101657200791, 342.3867466111762, 286.54359831774883, 598.2711191301512, 348.7946689339803]}, "sampler_perf": {"mean_raw_obs_processing_ms": 78.68244974569156, "mean_inference_ms": 67.39527085925869, "mean_action_processing_ms": 34.96267113102747, "mean_env_wait_ms": 20.64026044146145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040302276611328125, "StateBufferConnector_ms": 0.01745021343231201, "ViewRequirementAgentConnector_ms": 0.09541702270507812}, "num_episodes": 64, "episode_return_max": 490.59932254414156, "episode_return_min": -43.66971624676578, "episode_return_mean": 99.63822812799151, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2798144, "num_agent_steps_trained": 2798144, "num_env_steps_sampled": 699536, "num_env_steps_trained": 699536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 264.2655069733882, "num_env_steps_trained_throughput_per_sec": 264.2655069733882, "timesteps_total": 699536, "num_env_steps_sampled_lifetime": 699536, "num_agent_steps_sampled_lifetime": 2798144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2798144, "timers": {"training_iteration_time_ms": 138703.59, "restore_workers_time_ms": 72.601, "training_step_time_ms": 138505.048, "sample_time_ms": 23298.833, "learn_time_ms": 110055.468, "learn_throughput": 72.691, "synch_weights_time_ms": 4818.894}, "counters": {"num_env_steps_sampled": 699536, "num_env_steps_trained": 699536, "num_agent_steps_sampled": 2798144, "num_agent_steps_trained": 2798144}, "done": false, "training_iteration": 87, "trial_id": "cdf01_00000", "date": "2024-08-20_13-51-35", "timestamp": 1724142095, "time_this_iter_s": 30.309432983398438, "time_total_s": 12332.138805150986, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a53b6b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12332.138805150986, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 36.893023255813944, "ram_util_percent": 82.93953488372092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.415695340292794, "cur_kl_coeff": 5.1457251545698755e-21, "cur_lr": 0.0001, "total_loss": 8.94840839930943, "policy_loss": -0.0040982485708174485, "vf_loss": 8.952506663307311, "vf_explained_var": -0.16040854993320647, "kl": 0.0018103210746746284, "entropy": 0.11563374971350034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 55405.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.11495664914449, "cur_kl_coeff": 1.734723475976807e-19, "cur_lr": 0.0001, "total_loss": 8.92138785104903, "policy_loss": -0.003831764015679558, "vf_loss": 8.925219572158086, "vf_explained_var": 0.3906203305910504, "kl": 0.0041551225535104526, "entropy": 0.30257663627465564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 55405.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 707536, "num_env_steps_trained": 707536, "num_agent_steps_sampled": 2830144, "num_agent_steps_trained": 2830144}, "env_runners": {"episode_reward_max": 490.59932254414156, "episode_reward_min": -43.66971624676578, "episode_reward_mean": 100.4572692623128, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -751.6304885650702, "predator_policy": 7.000989003194584}, "policy_reward_max": {"prey_policy": 196.9887008598437, "predator_policy": 720.5889156156068}, "policy_reward_mean": {"prey_policy": -295.13905246363737, "predator_policy": 345.3676870947938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [207.82294686117496, 82.84632683120232, 46.32293914469143, 43.32264216195144, 8.643161454363398, 337.6244502316119, 202.4948580198695, 3.503231236824381, -16.65808858660749, 45.0260505984495, 204.75827246388425, 286.60024128516375, 71.33676463915651, -4.606144844624876, 63.173486808219536, 28.598444086119308, 16.176284541322847, 10.529819168646155, 25.186352873742365, 59.70726337226738, 85.36616619337562, 15.897190180036553, 42.93783737026704, 395.15129853826244, 66.57877248542957, 71.85770221381752, 206.9391600178542, 162.77364928219217, -11.614816943763328, 177.8320797577831, 104.1334975233071, 361.2492394320804, 303.74001778359167, 95.25963631196795, 0.8, -13.343052658866101, 100.15186470743879, 296.42024864385854, 160.3464094435907, 231.77328291310894, 131.9562320985991, 74.97634558932461, 0.8000000000000034, 39.14216461081317, 263.15671836280416, 223.12672650631052, -3.1086244689504383e-15, 0.09999999999999831, 18.48701936228011, 1.832567856736346, 153.88366056771463, 193.94116797138958, 26.62298934485623, 136.87266820813377, -0.9399816928206104, 164.06236414884302, 15.899999999999972, 27.875686418248108, -1.3322676295501878e-15, 34.752952469903335, 172.38116298830266, 4.5, 11.588215883006956, 65.39223111738728, 104.42881758240631, 134.77338706584382, -2.054479307322128, 234.783050499749, 336.45613049512286, -2.799773584533591, 124.24562531477348, 490.59932254414156, 64.75654552819111, 7.014173395985422, 54.69348977927343, 59.17580914327222, 98.31401095803892, 78.48529897938437, 225.78328145737112, -43.66971624676578, -0.9600600988492265, -13.063651457186578, 2.700000000000002, -1.4557797467089935, 2.5000000000000027, 19.238046580249506, 8.339104970606332, 429.6057610794566, 4.823062122511116, 373.7839002442384, 58.30297887911894, 0.3046118204614596, 306.7987782323922, 7.244888600088629, -0.0371202670662556, 50.810412823945136, 22.21498714835652, 88.79043043487731, 169.85181626113692, 213.87940764412684], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-361.2845334545217, -144.2505327559424, -219.74134594462188, -313.05882285975713, -343.41777101176586, -281.1000100928371, -363.8996704846242, -390.17883351566013, -170.8705680391601, -243.65142295475923, -304.9588429464217, 69.74855598096836, -392.97890467664405, 195.50526682047325, -255.14301580988362, -293.08801076809107, -368.70846995360245, -438.5768047218641, -60.71875664317589, -424.2544067397541, -446.03036369471386, 176.08904616641695, -306.313948548189, -59.39335954452517, -353.99944572787206, -269.55249728363947, -578.1996593159553, -324.28921172476447, -368.7789742947457, -464.00327765578106, -419.7994132165583, -447.8754578993213, -391.8258663761121, -293.0942948420852, -247.93280192913426, -210.52307754814416, -465.16299856800623, -359.04660863547906, -204.69737325653776, -297.6817358271985, -238.94917317371818, -409.36643112056544, -460.8618160262354, -93.30496116924014, -344.19645560120813, -379.0803777708636, -352.3390473529451, 174.9581711263302, -343.2604066816449, -296.62735197698316, -376.3023742515916, -293.7590434524009, 166.25161021789629, -351.32796989847805, -545.9557897040918, -218.13776521592135, -231.85187609076428, -409.7006845392869, -144.44794741234708, -244.18235354179572, -371.49361642178593, -276.7022099622802, -519.8899979644531, -420.01914236714214, 177.16655758479052, -333.53309401945967, -254.4834536361007, -299.127927592241, -250.22432305190247, -450.3110433579117, -349.88655180739806, -337.1045053710568, -343.13479880945175, -309.1681732963339, 196.41849975701152, -400.2236201445928, 153.1763827622944, -438.001660558862, -438.509681601376, 129.4561931780966, -143.20141350585283, -238.56223697106705, -202.65937326150623, -365.97883869003863, -464.8701034708347, -544.8378694567094, -314.2907974962713, -269.71692709842307, 168.86009846861802, -442.0405307652711, -367.44795595965303, 0.4093099165388707, -562.5219680923757, -302.6961677438733, -300.7410632891539, -342.907170100145, -322.8156662039012, -312.5431369251731, -387.1842446733838, -366.65506687873, -360.630241861142, -177.44618236896065, -306.81695689289654, -85.57479428370586, -175.59671530353978, -366.0151992556543, -241.97883539357395, -419.37832644695095, -342.05374996724123, -387.784006203412, -26.23683431921464, -589.2352346004183, -132.26718936373172, -308.6330546106704, -407.1712315910565, -373.7477402657152, -497.47680111437745, -610.0371132089646, -200.57440362628543, -421.9134336831245, -312.457203733791, -226.89249787985358, -278.4440008107114, -340.80151384909726, -445.75246290879295, -494.67627261262464, -341.0647243572748, -236.38796088435288, -501.0189272896886, -88.60748079312884, -155.1526702912993, -302.9235980802944, -580.4912192309793, -388.36101794962957, 174.2910045597046, -536.6181397088593, -449.57900869760044, -3.748190207035439, -388.6650859472148, -189.85331177448182, -386.01992647050486, -174.52037939290554, 178.74015737625527, -364.4728891237815, -323.07476277342647, -253.49026180068316, -542.8647173554072, -251.1602383195736, -330.32858849864095, -66.84366182547154, -195.1241318584042, -350.30174776975025, -177.11768261067306, -476.83077030171046, -257.9357560530568, -259.27220029613034, -22.785818918968246, -276.4019417600199, -283.676928741028, -279.0953583065246, -321.51048170590866, -347.20011290084943, -420.93715328871497, -383.9404936805361, -453.4218098169704, -328.88025382818415, -375.5013980894371, -469.5642144445477, -356.72271612584836, -290.74117344141365, -435.4644508100616, -299.25874921626655, -459.9369741410332, -344.67812816084563, 196.9887008598437, -461.23479658271674, -351.00911492850975, -471.3310343278796, -21.116047868701543, -751.6304885650702, -345.0629097114069, -225.5644563383995, -588.3184434418154, -358.44273280185473, -311.77563304211014, 48.48359339583598, -292.77313433794484, -395.68418312609657, -385.04942486465444, -380.7341856614429, -353.2213208478402, -445.49491883164063, -170.4772945593876, -325.40159497984575, -412.25995249155346, -419.8740288290784, -90.74582531776865, -384.5776262814082, -191.86864356806257, -194.34940161209423], "policy_predator_policy_reward": [367.3253600342213, 346.03265303741847, 304.0240248539599, 311.6224707816222, 349.5788327885672, 321.26188746072705, 359.0552371662945, 438.3459089959411, 101.46805143364249, 321.6971010146395, 290.10644842714777, 282.72828876991707, 392.9675068728457, 7.000989003194584, 359.3900885161983, 192.34416929860112, 391.81550160929623, 398.8116844795623, 320.3937630019013, 209.60545097947792, 446.23036369471384, 28.469226297467333, 282.667723969513, 369.63982540836525, 367.8117196949411, 327.07698795572713, 595.8224407312647, 302.06028546483014, 463.59877006663004, 432.3569686921171, 460.57852146477023, 435.6947937372295, 407.05256869067193, 294.04387706884876, 220.30676475277184, 248.6789338931526, 465.4630591903233, 383.9329008869043, 249.74564694332116, 312.3407255126822, 409.09186687316156, 324.5899036144977, 459.3885086710804, 110.67545870443206, 333.8362295725072, 432.3784411698314, 257.4680249277326, 315.064149837146, 302.373638405661, 404.0928927383977, 244.6706008832814, 497.2485190345294, 119.24117822349736, 272.77434147493926, 498.07838630239974, 428.7888178998056, 261.8110920422394, 368.1266516440488, 278.5752439758873, 287.8871367360377, 369.19068596780767, 383.13863793956585, 580.5694641480699, 720.5889156156068, 139.1297366499331, 320.97681756832696, 330.53171913667245, 318.3392984036373, 251.02432305190248, 450.3110433579117, 324.58844903925893, 349.05955548032966, 345.0241085013419, 407.43072831188255, 100.19529218613881, 400.0300768453009, 7.170026681296287, 438.001660558862, 297.32243394473824, 243.50433739165163, 296.6826693408051, 217.03721323471427, 525.7488114375029, 117.8657461033662, 464.8701034708347, 545.6378694567095, 234.12665331216465, 389.0232358933441, 114.35701432661443, 421.98013633284273, 254.98457939324038, 335.1807931561851, 562.5219680923757, 302.6961677438733, 300.7410632891539, 343.00717010014495, 336.87861163356047, 316.96721085779393, 389.01681253012015, 366.65506687873, 363.6590556822725, 328.3010291155459, 284.34908857192863, 301.98383057606173, 211.17923154020588, 357.0556723638445, 382.1764366849413, 416.05339336371617, 375.5963964585875, 353.3013780192456, 237.5637336668954, 541.9706994015819, 148.16718936373115, 308.6330546106704, 438.9456406465072, 369.8490176285128, 497.47680111437745, 610.0371132089646, 235.32735609618834, 421.9134336831245, 404.381466758138, 307.34939784380924, 280.7440008107113, 343.00151384909714, 451.47903809296554, 500.53791331145976, 277.2020335413188, 365.6428828176962, 179.03153446213966, 515.0236912030836, 325.6159515039569, 267.23370393348057, 386.306538642308, 580.4912192309793, 452.041912470755, 145.0682731781496, 405.74625257649865, 384.0370768232582, 195.46874018070594, 380.24988395645664, 334.5204942747903, 350.26543690339355, 350.4771184768563, 325.8549358148121, 323.7448416738785, 317.57672842842146, 542.8647173554072, 258.1744117155591, 133.4269573874877, 318.4387827158985, 254.2241318584042, 350.3775569130225, 213.46776340091577, 538.7947004695063, 329.90854014035, 265.78471518822073, 378.5238611800157, 146.4471809563428, 441.723307005763, 77.37926379502456, 322.33346172462666, 345.4170727832821, 420.43503974579767, 371.3789557662662, 453.4218098169704, 331.5802538281841, 371.61207587081736, 471.9977569164598, 356.72271612584836, 293.2411734414142, 369.83583817788497, 384.1254084286921, 457.62160495769484, 355.3326023147903, 419.13456918596523, 274.71728761636405, 338.6550738203331, 488.5081375585675, 560.4287794772212, 586.101657200791, 342.3867466111762, 286.54359831774883, 598.2711191301512, 348.7946689339803, 278.76614002306377, 291.32467785560203, 306.8912261887998, 388.81097987533076, 385.0123045975882, 380.7341856614429, 444.8979934610724, 404.62865904235406, 192.93708714189958, 325.1567895456909, 517.6928583717772, 403.2315533837322, 279.8756105209133, 365.29965733940145, 373.5101621484628, 226.58729067582001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 80.64353782585783, "mean_inference_ms": 69.17893642524848, "mean_action_processing_ms": 35.167585537138386, "mean_env_wait_ms": 21.01255191351323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004094600677490234, "StateBufferConnector_ms": 0.014385819435119629, "ViewRequirementAgentConnector_ms": 0.09360146522521973}, "num_episodes": 8, "episode_return_max": 490.59932254414156, "episode_return_min": -43.66971624676578, "episode_return_mean": 100.4572692623128, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2830144, "num_agent_steps_trained": 2830144, "num_env_steps_sampled": 707536, "num_env_steps_trained": 707536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 272.4569289905218, "num_env_steps_trained_throughput_per_sec": 272.4569289905218, "timesteps_total": 707536, "num_env_steps_sampled_lifetime": 707536, "num_agent_steps_sampled_lifetime": 2830144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2830144, "timers": {"training_iteration_time_ms": 122759.216, "restore_workers_time_ms": 34.641, "training_step_time_ms": 122664.201, "sample_time_ms": 16440.682, "learn_time_ms": 103315.517, "learn_throughput": 77.433, "synch_weights_time_ms": 2764.468}, "counters": {"num_env_steps_sampled": 707536, "num_env_steps_trained": 707536, "num_agent_steps_sampled": 2830144, "num_agent_steps_trained": 2830144}, "done": false, "training_iteration": 88, "trial_id": "cdf01_00000", "date": "2024-08-20_13-52-04", "timestamp": 1724142124, "time_this_iter_s": 29.40650987625122, "time_total_s": 12361.545315027237, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5390b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12361.545315027237, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 36.8609756097561, "ram_util_percent": 83.20975609756097}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.33611744699024, "cur_kl_coeff": 2.5728625772849377e-21, "cur_lr": 0.0001, "total_loss": 8.805983697800409, "policy_loss": -0.00405347767093825, "vf_loss": 8.810037193601094, "vf_explained_var": -0.25053923763926067, "kl": 0.002721964550587003, "entropy": 0.12318946564244845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 56035.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.885559812424675, "cur_kl_coeff": 8.673617379884035e-20, "cur_lr": 0.0001, "total_loss": 8.720387196919274, "policy_loss": -0.0030768201878619574, "vf_loss": 8.72346400760469, "vf_explained_var": 0.3740686447847457, "kl": 0.003249784205667715, "entropy": 0.31608654156563776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 56035.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 715536, "num_env_steps_trained": 715536, "num_agent_steps_sampled": 2862144, "num_agent_steps_trained": 2862144}, "env_runners": {"episode_reward_max": 490.59932254414156, "episode_reward_min": -57.80469141582982, "episode_reward_mean": 104.97967047932188, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -751.6304885650702, "predator_policy": 14.590340085838317}, "policy_reward_max": {"prey_policy": 198.27528484449527, "predator_policy": 674.7659211623427}, "policy_reward_mean": {"prey_policy": -299.0905028439204, "predator_policy": 351.5803380835813}, "custom_metrics": {}, "hist_stats": {"episode_reward": [104.42881758240631, 134.77338706584382, -2.054479307322128, 234.783050499749, 336.45613049512286, -2.799773584533591, 124.24562531477348, 490.59932254414156, 64.75654552819111, 7.014173395985422, 54.69348977927343, 59.17580914327222, 98.31401095803892, 78.48529897938437, 225.78328145737112, -43.66971624676578, -0.9600600988492265, -13.063651457186578, 2.700000000000002, -1.4557797467089935, 2.5000000000000027, 19.238046580249506, 8.339104970606332, 429.6057610794566, 4.823062122511116, 373.7839002442384, 58.30297887911894, 0.3046118204614596, 306.7987782323922, 7.244888600088629, -0.0371202670662556, 50.810412823945136, 22.21498714835652, 88.79043043487731, 169.85181626113692, 213.87940764412684, 108.487997757806, 124.07397551772969, 28.110996956149982, 118.9678990937918, 188.65147413136458, 111.46845925713829, 0.5707420455638283, 100.0221250124801, -57.80469141582982, 0.31912469469810967, 422.9461950483702, 243.2832939743844, 0.8739765593310103, 17.995633416054062, -11.756457969051954, 10.404662907469536, 166.2327898551918, -0.9852736195090261, 25.570898758551433, 102.08477220188924, 275.81206122113, 49.32476747195278, 2.8267485481251415, 123.88427749104468, 0.14729337217615623, 6.675656412475236, 158.85915964047052, 103.82781566708879, -7.940216183294563, 2.1392008745275337, 236.78837805926491, 237.0047588844515, 17.237000764679063, 80.21510690606674, 3.8059908755879155, 1.0000000000000009, 85.01505604878658, 56.09559106054256, 14.637063751517328, 14.541539696160893, 415.089670486317, 42.260889845036196, 23.180100453283973, 246.2887727401272, 235.01103862394893, 62.470409617863034, 142.60168957730954, 458.15872077309814, 14.901448906183223, 6.052472943893241, 98.88588614028114, 162.4222550547975, 203.24671975483432, 231.39457711784922, 365.6232375987736, 257.56996791885405, 52.02880223064931, 0.002257035479579672, 147.71196044766307, 22.572560067665812, 375.7726652106977, 6.67713534109776, 56.84076101425985, 1.1306554092100858], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-501.0189272896886, -88.60748079312884, -155.1526702912993, -302.9235980802944, -580.4912192309793, -388.36101794962957, 174.2910045597046, -536.6181397088593, -449.57900869760044, -3.748190207035439, -388.6650859472148, -189.85331177448182, -386.01992647050486, -174.52037939290554, 178.74015737625527, -364.4728891237815, -323.07476277342647, -253.49026180068316, -542.8647173554072, -251.1602383195736, -330.32858849864095, -66.84366182547154, -195.1241318584042, -350.30174776975025, -177.11768261067306, -476.83077030171046, -257.9357560530568, -259.27220029613034, -22.785818918968246, -276.4019417600199, -283.676928741028, -279.0953583065246, -321.51048170590866, -347.20011290084943, -420.93715328871497, -383.9404936805361, -453.4218098169704, -328.88025382818415, -375.5013980894371, -469.5642144445477, -356.72271612584836, -290.74117344141365, -435.4644508100616, -299.25874921626655, -459.9369741410332, -344.67812816084563, 196.9887008598437, -461.23479658271674, -351.00911492850975, -471.3310343278796, -21.116047868701543, -751.6304885650702, -345.0629097114069, -225.5644563383995, -588.3184434418154, -358.44273280185473, -311.77563304211014, 48.48359339583598, -292.77313433794484, -395.68418312609657, -385.04942486465444, -380.7341856614429, -353.2213208478402, -445.49491883164063, -170.4772945593876, -325.40159497984575, -412.25995249155346, -419.8740288290784, -90.74582531776865, -384.5776262814082, -191.86864356806257, -194.34940161209423, -381.508657118765, -191.41138133436215, -413.97438301923034, -301.90569924094274, -439.556277443574, -267.57944829532426, -93.81862169535265, -338.38725700578743, -253.35303176765981, -86.68283250459297, -367.6064427816672, -240.2347779816646, -477.29796294437773, -339.18381056015176, -297.87272514252294, -223.29604890571858, -240.09809301370905, -349.2201305862234, -339.36557351912654, -329.4331033392922, 105.63267832662015, -406.94898245536973, 186.54548161211795, -561.2384882262859, -354.0197949500346, -619.5384505479075, -462.2952982024864, -403.0031555381774, -302.1297474066122, -308.03793404590755, -340.14622854680675, -395.92640097530966, -147.38441680196402, -481.25978147171276, -402.9753910177081, -400.9164168599915, -366.07867734915436, -311.3983385942619, -468.25743029764874, -220.004480635462, 198.27528484449527, -355.71894247212566, -271.99073485507614, -264.3598262115601, -310.1630708240227, -234.14893630801328, -439.1419777840773, -0.09255794086588248, -416.3405809503331, -417.73940827383535, -457.9558531929846, -265.65472997852936, -206.28526484719106, -345.4196128243426, -279.00578007785197, -543.8871121599152, -323.76059135927915, -431.8261739773937, -387.4613280379538, -363.6026912435514, -333.9066722903518, 188.18397345407658, 181.89509232265544, -385.22803479869907, -359.6696716265599, -354.2727459861037, -451.69432063993804, -647.088132692533, -304.60817899396994, -297.40081196917686, -379.59930919771415, -249.1580870312308, -297.8119780810899, -427.2122600369439, -312.77885594435367, -328.0174997780273, -335.47586267014395, -325.1930337580802, -406.39751017888034, -257.9549380056528, 99.37237031667445, -464.4489758617329, -292.0208893456175, -375.97702735678484, -305.14496812539454, -327.3323466809025, -107.46607664183145, -300.42579811770014, -525.7457429240525, -29.270922714046772, -492.11896122271463, -291.9405336649017, -571.8044320401567, 6.700028552632062, 168.96171200118775, -353.3707535273401, -322.926491215989, -98.46901034796991, -14.695471622450636, -350.4368092956129, -535.6230764969811, -372.8295559434746, -293.22046382313823, -376.87698477442234, 188.65637966899598, -340.86644540345605, -242.31775691377464, 198.15673343344685, 10.848484907992864, -420.6831080498751, -90.9065971103888, -503.58248170022443, -239.96542004347734, -437.69098570051233, -569.0024764087165, -304.4315111493223, -472.1894277328448, -180.27011875848746, -147.10850096287334, -336.87397596457214, -540.9491741381729, -45.97080976406513, -384.31711355210217, -321.25933197937024, -668.226189220318, -96.73920014596945, -362.9946732402305, -277.8811908986761], "policy_predator_policy_reward": [179.03153446213966, 515.0236912030836, 325.6159515039569, 267.23370393348057, 386.306538642308, 580.4912192309793, 452.041912470755, 145.0682731781496, 405.74625257649865, 384.0370768232582, 195.46874018070594, 380.24988395645664, 334.5204942747903, 350.26543690339355, 350.4771184768563, 325.8549358148121, 323.7448416738785, 317.57672842842146, 542.8647173554072, 258.1744117155591, 133.4269573874877, 318.4387827158985, 254.2241318584042, 350.3775569130225, 213.46776340091577, 538.7947004695063, 329.90854014035, 265.78471518822073, 378.5238611800157, 146.4471809563428, 441.723307005763, 77.37926379502456, 322.33346172462666, 345.4170727832821, 420.43503974579767, 371.3789557662662, 453.4218098169704, 331.5802538281841, 371.61207587081736, 471.9977569164598, 356.72271612584836, 293.2411734414142, 369.83583817788497, 384.1254084286921, 457.62160495769484, 355.3326023147903, 419.13456918596523, 274.71728761636405, 338.6550738203331, 488.5081375585675, 560.4287794772212, 586.101657200791, 342.3867466111762, 286.54359831774883, 598.2711191301512, 348.7946689339803, 278.76614002306377, 291.32467785560203, 306.8912261887998, 388.81097987533076, 385.0123045975882, 380.7341856614429, 444.8979934610724, 404.62865904235406, 192.93708714189958, 325.1567895456909, 517.6928583717772, 403.2315533837322, 279.8756105209133, 365.29965733940145, 373.5101621484628, 226.58729067582001, 368.7927103609682, 312.61532584996604, 339.7640101262401, 500.1900476516646, 437.6423481942901, 297.60437450075653, 389.82440341874, 161.3493743761922, 247.66004637685404, 281.02729202676284, 384.2348672907857, 335.07481272968363, 487.41794150099474, 329.6345740490992, 320.288362117897, 300.9025369428236, 355.6845214406608, 175.82901074344352, 339.36557351912654, 329.7522280339903, 353.41389068818927, 370.8486084889308, 56.73781236226632, 561.2384882262859, 381.49188359349773, 592.940338463776, 468.38133092114066, 414.9127562355766, 316.8003588414154, 281.61086464205215, 343.55089145427615, 402.92640097530966, 421.32917704938916, 373.5478110794786, 404.62610009346184, 398.2804341647288, 347.9916568885167, 355.0562578134528, 468.3099632196028, 322.0367199153961, 109.87176670547612, 323.3839521432848, 243.39931832715115, 342.2760102114374, 310.9630708240227, 236.1756848561384, 331.4817860384096, 231.63702717757752, 411.75679511818754, 422.47048747815677, 461.0094493189522, 269.2767902650369, 377.2397673386142, 333.3242699733897, 417.757745174459, 508.9629627303971, 314.23118502137294, 433.4153641320052, 365.19510826406633, 388.00811189196605, 344.47671035651916, 38.03436653902101, 69.53018723166893, 370.8075141288274, 387.4995130304247, 343.6799053469174, 633.6847911111245, 545.3127691274141, 300.4539149733836, 305.3610668653515, 379.59930919771415, 250.15808703123074, 405.69066721276687, 404.348626954053, 384.2892076195048, 312.60273916341896, 351.91771142273103, 323.3882487570103, 406.39751017888034, 272.4964777018136, 392.109716609452, 388.0565594219239, 332.2060222536739, 378.0527842937657, 264.9842163196621, 390.67319893991885, 342.5844407204308, 311.59620677922743, 492.7308039561733, 297.2969003058765, 455.4529567045501, 391.07694780093084, 499.89645284188765, 207.8096402229453, 340.2402225833417, 302.3275397159084, 323.62649121598906, 112.67045925415242, 19.713179485658056, 351.47157437629863, 674.7659211623427, 332.5725974183961, 428.0712974262588, 404.44840622609905, 14.590340085838317, 340.86644540345605, 200.23834658215824, 75.31725401601895, 400.4291187825199, 375.02874195813604, 415.8397904824726, 436.2192562469943, 442.0406230966713, 287.6445848779676, 569.0024764087165, 304.43376818480186, 456.4552680988858, 343.7162388401082, 168.85910379273577, 337.69593320237556, 486.43015998708256, 476.2624891258524, 350.47499696124254, 361.77858391132736, 156.16619915335116, 665.6399512271955, 363.77019280570477, 278.2363267424121]}, "sampler_perf": {"mean_raw_obs_processing_ms": 79.4982131590502, "mean_inference_ms": 68.19506279636609, "mean_action_processing_ms": 34.656484314658385, "mean_env_wait_ms": 20.712726519568026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004296779632568359, "StateBufferConnector_ms": 0.01567065715789795, "ViewRequirementAgentConnector_ms": 0.0954509973526001}, "num_episodes": 64, "episode_return_max": 490.59932254414156, "episode_return_min": -57.80469141582982, "episode_return_mean": 104.97967047932188, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2862144, "num_agent_steps_trained": 2862144, "num_env_steps_sampled": 715536, "num_env_steps_trained": 715536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 269.3186401575907, "num_env_steps_trained_throughput_per_sec": 269.3186401575907, "timesteps_total": 715536, "num_env_steps_sampled_lifetime": 715536, "num_agent_steps_sampled_lifetime": 2862144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2862144, "timers": {"training_iteration_time_ms": 108818.054, "restore_workers_time_ms": 3.134, "training_step_time_ms": 108810.78, "sample_time_ms": 10050.513, "learn_time_ms": 98502.621, "learn_throughput": 81.216, "synch_weights_time_ms": 234.553}, "counters": {"num_env_steps_sampled": 715536, "num_env_steps_trained": 715536, "num_agent_steps_sampled": 2862144, "num_agent_steps_trained": 2862144}, "done": false, "training_iteration": 89, "trial_id": "cdf01_00000", "date": "2024-08-20_13-52-34", "timestamp": 1724142154, "time_this_iter_s": 29.737195014953613, "time_total_s": 12391.28251004219, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5fcff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12391.28251004219, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 39.9, "ram_util_percent": 83.0142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.671602043462178, "cur_kl_coeff": 1.2864312886424689e-21, "cur_lr": 0.0001, "total_loss": 8.924143966795906, "policy_loss": -0.0043091221010342, "vf_loss": 8.928453107864138, "vf_explained_var": -0.368635214321197, "kl": 0.002449505892837131, "entropy": 0.12158975637857876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 56665.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.488639156591325, "cur_kl_coeff": 4.3368086899420174e-20, "cur_lr": 0.0001, "total_loss": 8.87797202912588, "policy_loss": -0.0055840838515746685, "vf_loss": 8.883556108626108, "vf_explained_var": 0.3368263037431808, "kl": 0.009381319844701393, "entropy": 0.34157832842024544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 56665.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 723536, "num_env_steps_trained": 723536, "num_agent_steps_sampled": 2894144, "num_agent_steps_trained": 2894144}, "env_runners": {"episode_reward_max": 458.15872077309814, "episode_reward_min": -57.80469141582982, "episode_reward_mean": 94.90219982272434, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -751.6304885650702, "predator_policy": 14.590340085838317}, "policy_reward_max": {"prey_policy": 198.27528484449527, "predator_policy": 674.7659211623427}, "policy_reward_mean": {"prey_policy": -306.6352321893271, "predator_policy": 354.08633210068933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.75654552819111, 7.014173395985422, 54.69348977927343, 59.17580914327222, 98.31401095803892, 78.48529897938437, 225.78328145737112, -43.66971624676578, -0.9600600988492265, -13.063651457186578, 2.700000000000002, -1.4557797467089935, 2.5000000000000027, 19.238046580249506, 8.339104970606332, 429.6057610794566, 4.823062122511116, 373.7839002442384, 58.30297887911894, 0.3046118204614596, 306.7987782323922, 7.244888600088629, -0.0371202670662556, 50.810412823945136, 22.21498714835652, 88.79043043487731, 169.85181626113692, 213.87940764412684, 108.487997757806, 124.07397551772969, 28.110996956149982, 118.9678990937918, 188.65147413136458, 111.46845925713829, 0.5707420455638283, 100.0221250124801, -57.80469141582982, 0.31912469469810967, 422.9461950483702, 243.2832939743844, 0.8739765593310103, 17.995633416054062, -11.756457969051954, 10.404662907469536, 166.2327898551918, -0.9852736195090261, 25.570898758551433, 102.08477220188924, 275.81206122113, 49.32476747195278, 2.8267485481251415, 123.88427749104468, 0.14729337217615623, 6.675656412475236, 158.85915964047052, 103.82781566708879, -7.940216183294563, 2.1392008745275337, 236.78837805926491, 237.0047588844515, 17.237000764679063, 80.21510690606674, 3.8059908755879155, 1.0000000000000009, 85.01505604878658, 56.09559106054256, 14.637063751517328, 14.541539696160893, 415.089670486317, 42.260889845036196, 23.180100453283973, 246.2887727401272, 235.01103862394893, 62.470409617863034, 142.60168957730954, 458.15872077309814, 14.901448906183223, 6.052472943893241, 98.88588614028114, 162.4222550547975, 203.24671975483432, 231.39457711784922, 365.6232375987736, 257.56996791885405, 52.02880223064931, 0.002257035479579672, 147.71196044766307, 22.572560067665812, 375.7726652106977, 6.67713534109776, 56.84076101425985, 1.1306554092100858, 84.53186345375894, 5.896953131740986, 5.713913472250459, 39.46732837617372, -9.548367285297932, 114.08183527577474, 3.5240439021662673, 169.01744462386344], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-323.07476277342647, -253.49026180068316, -542.8647173554072, -251.1602383195736, -330.32858849864095, -66.84366182547154, -195.1241318584042, -350.30174776975025, -177.11768261067306, -476.83077030171046, -257.9357560530568, -259.27220029613034, -22.785818918968246, -276.4019417600199, -283.676928741028, -279.0953583065246, -321.51048170590866, -347.20011290084943, -420.93715328871497, -383.9404936805361, -453.4218098169704, -328.88025382818415, -375.5013980894371, -469.5642144445477, -356.72271612584836, -290.74117344141365, -435.4644508100616, -299.25874921626655, -459.9369741410332, -344.67812816084563, 196.9887008598437, -461.23479658271674, -351.00911492850975, -471.3310343278796, -21.116047868701543, -751.6304885650702, -345.0629097114069, -225.5644563383995, -588.3184434418154, -358.44273280185473, -311.77563304211014, 48.48359339583598, -292.77313433794484, -395.68418312609657, -385.04942486465444, -380.7341856614429, -353.2213208478402, -445.49491883164063, -170.4772945593876, -325.40159497984575, -412.25995249155346, -419.8740288290784, -90.74582531776865, -384.5776262814082, -191.86864356806257, -194.34940161209423, -381.508657118765, -191.41138133436215, -413.97438301923034, -301.90569924094274, -439.556277443574, -267.57944829532426, -93.81862169535265, -338.38725700578743, -253.35303176765981, -86.68283250459297, -367.6064427816672, -240.2347779816646, -477.29796294437773, -339.18381056015176, -297.87272514252294, -223.29604890571858, -240.09809301370905, -349.2201305862234, -339.36557351912654, -329.4331033392922, 105.63267832662015, -406.94898245536973, 186.54548161211795, -561.2384882262859, -354.0197949500346, -619.5384505479075, -462.2952982024864, -403.0031555381774, -302.1297474066122, -308.03793404590755, -340.14622854680675, -395.92640097530966, -147.38441680196402, -481.25978147171276, -402.9753910177081, -400.9164168599915, -366.07867734915436, -311.3983385942619, -468.25743029764874, -220.004480635462, 198.27528484449527, -355.71894247212566, -271.99073485507614, -264.3598262115601, -310.1630708240227, -234.14893630801328, -439.1419777840773, -0.09255794086588248, -416.3405809503331, -417.73940827383535, -457.9558531929846, -265.65472997852936, -206.28526484719106, -345.4196128243426, -279.00578007785197, -543.8871121599152, -323.76059135927915, -431.8261739773937, -387.4613280379538, -363.6026912435514, -333.9066722903518, 188.18397345407658, 181.89509232265544, -385.22803479869907, -359.6696716265599, -354.2727459861037, -451.69432063993804, -647.088132692533, -304.60817899396994, -297.40081196917686, -379.59930919771415, -249.1580870312308, -297.8119780810899, -427.2122600369439, -312.77885594435367, -328.0174997780273, -335.47586267014395, -325.1930337580802, -406.39751017888034, -257.9549380056528, 99.37237031667445, -464.4489758617329, -292.0208893456175, -375.97702735678484, -305.14496812539454, -327.3323466809025, -107.46607664183145, -300.42579811770014, -525.7457429240525, -29.270922714046772, -492.11896122271463, -291.9405336649017, -571.8044320401567, 6.700028552632062, 168.96171200118775, -353.3707535273401, -322.926491215989, -98.46901034796991, -14.695471622450636, -350.4368092956129, -535.6230764969811, -372.8295559434746, -293.22046382313823, -376.87698477442234, 188.65637966899598, -340.86644540345605, -242.31775691377464, 198.15673343344685, 10.848484907992864, -420.6831080498751, -90.9065971103888, -503.58248170022443, -239.96542004347734, -437.69098570051233, -569.0024764087165, -304.4315111493223, -472.1894277328448, -180.27011875848746, -147.10850096287334, -336.87397596457214, -540.9491741381729, -45.97080976406513, -384.31711355210217, -321.25933197937024, -668.226189220318, -96.73920014596945, -362.9946732402305, -277.8811908986761, -217.8475157439845, -455.1131408867884, -390.51768414139144, -292.5975216684895, -387.2225549204208, -431.3242676969449, -201.72692291468783, -361.4963729291538, -467.47322262848485, -491.27680224814486, -391.3701619625329, -235.12281407502573, -535.9830109250639, -225.13625820870547, -411.23294566902234, -170.5053554839351], "policy_predator_policy_reward": [323.7448416738785, 317.57672842842146, 542.8647173554072, 258.1744117155591, 133.4269573874877, 318.4387827158985, 254.2241318584042, 350.3775569130225, 213.46776340091577, 538.7947004695063, 329.90854014035, 265.78471518822073, 378.5238611800157, 146.4471809563428, 441.723307005763, 77.37926379502456, 322.33346172462666, 345.4170727832821, 420.43503974579767, 371.3789557662662, 453.4218098169704, 331.5802538281841, 371.61207587081736, 471.9977569164598, 356.72271612584836, 293.2411734414142, 369.83583817788497, 384.1254084286921, 457.62160495769484, 355.3326023147903, 419.13456918596523, 274.71728761636405, 338.6550738203331, 488.5081375585675, 560.4287794772212, 586.101657200791, 342.3867466111762, 286.54359831774883, 598.2711191301512, 348.7946689339803, 278.76614002306377, 291.32467785560203, 306.8912261887998, 388.81097987533076, 385.0123045975882, 380.7341856614429, 444.8979934610724, 404.62865904235406, 192.93708714189958, 325.1567895456909, 517.6928583717772, 403.2315533837322, 279.8756105209133, 365.29965733940145, 373.5101621484628, 226.58729067582001, 368.7927103609682, 312.61532584996604, 339.7640101262401, 500.1900476516646, 437.6423481942901, 297.60437450075653, 389.82440341874, 161.3493743761922, 247.66004637685404, 281.02729202676284, 384.2348672907857, 335.07481272968363, 487.41794150099474, 329.6345740490992, 320.288362117897, 300.9025369428236, 355.6845214406608, 175.82901074344352, 339.36557351912654, 329.7522280339903, 353.41389068818927, 370.8486084889308, 56.73781236226632, 561.2384882262859, 381.49188359349773, 592.940338463776, 468.38133092114066, 414.9127562355766, 316.8003588414154, 281.61086464205215, 343.55089145427615, 402.92640097530966, 421.32917704938916, 373.5478110794786, 404.62610009346184, 398.2804341647288, 347.9916568885167, 355.0562578134528, 468.3099632196028, 322.0367199153961, 109.87176670547612, 323.3839521432848, 243.39931832715115, 342.2760102114374, 310.9630708240227, 236.1756848561384, 331.4817860384096, 231.63702717757752, 411.75679511818754, 422.47048747815677, 461.0094493189522, 269.2767902650369, 377.2397673386142, 333.3242699733897, 417.757745174459, 508.9629627303971, 314.23118502137294, 433.4153641320052, 365.19510826406633, 388.00811189196605, 344.47671035651916, 38.03436653902101, 69.53018723166893, 370.8075141288274, 387.4995130304247, 343.6799053469174, 633.6847911111245, 545.3127691274141, 300.4539149733836, 305.3610668653515, 379.59930919771415, 250.15808703123074, 405.69066721276687, 404.348626954053, 384.2892076195048, 312.60273916341896, 351.91771142273103, 323.3882487570103, 406.39751017888034, 272.4964777018136, 392.109716609452, 388.0565594219239, 332.2060222536739, 378.0527842937657, 264.9842163196621, 390.67319893991885, 342.5844407204308, 311.59620677922743, 492.7308039561733, 297.2969003058765, 455.4529567045501, 391.07694780093084, 499.89645284188765, 207.8096402229453, 340.2402225833417, 302.3275397159084, 323.62649121598906, 112.67045925415242, 19.713179485658056, 351.47157437629863, 674.7659211623427, 332.5725974183961, 428.0712974262588, 404.44840622609905, 14.590340085838317, 340.86644540345605, 200.23834658215824, 75.31725401601895, 400.4291187825199, 375.02874195813604, 415.8397904824726, 436.2192562469943, 442.0406230966713, 287.6445848779676, 569.0024764087165, 304.43376818480186, 456.4552680988858, 343.7162388401082, 168.85910379273577, 337.69593320237556, 486.43015998708256, 476.2624891258524, 350.47499696124254, 361.77858391132736, 156.16619915335116, 665.6399512271955, 363.77019280570477, 278.2363267424121, 262.49353722198424, 494.99898286254745, 390.51768414139144, 298.4944748002303, 390.9105018030956, 433.3502342865207, 350.9074309800182, 251.78319323999676, 477.62354012787785, 471.578117463454, 388.9655007295641, 351.60931058376985, 533.8301491525432, 230.8131638833924, 382.62759696880823, 368.1281488080116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 79.51342257190683, "mean_inference_ms": 68.27861849906525, "mean_action_processing_ms": 34.530238619926806, "mean_env_wait_ms": 20.577151905077322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004282593727111816, "StateBufferConnector_ms": 0.015695571899414062, "ViewRequirementAgentConnector_ms": 0.09536051750183105}, "num_episodes": 8, "episode_return_max": 458.15872077309814, "episode_return_min": -57.80469141582982, "episode_return_mean": 94.90219982272434, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2894144, "num_agent_steps_trained": 2894144, "num_env_steps_sampled": 723536, "num_env_steps_trained": 723536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 267.1319482599926, "num_env_steps_trained_throughput_per_sec": 267.1319482599926, "timesteps_total": 723536, "num_env_steps_sampled_lifetime": 723536, "num_agent_steps_sampled_lifetime": 2894144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2894144, "timers": {"training_iteration_time_ms": 91584.671, "restore_workers_time_ms": 1.141, "training_step_time_ms": 91582.221, "sample_time_ms": 6893.083, "learn_time_ms": 84561.428, "learn_throughput": 94.606, "synch_weights_time_ms": 113.021}, "counters": {"num_env_steps_sampled": 723536, "num_env_steps_trained": 723536, "num_agent_steps_sampled": 2894144, "num_agent_steps_trained": 2894144}, "done": false, "training_iteration": 90, "trial_id": "cdf01_00000", "date": "2024-08-20_13-53-04", "timestamp": 1724142184, "time_this_iter_s": 29.97812795639038, "time_total_s": 12421.260637998581, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e63430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12421.260637998581, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 37.867441860465114, "ram_util_percent": 83.16976744186044}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.933826289479695, "cur_kl_coeff": 6.432156443212344e-22, "cur_lr": 0.0001, "total_loss": 8.75911799536811, "policy_loss": -0.004466561881440972, "vf_loss": 8.763584533570304, "vf_explained_var": -0.33648134498369126, "kl": 0.0026983205139083383, "entropy": 0.13491010447106663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 57295.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.15518704444643, "cur_kl_coeff": 4.3368086899420174e-20, "cur_lr": 0.0001, "total_loss": 8.627666586164445, "policy_loss": -0.0052383930777155216, "vf_loss": 8.632904977647085, "vf_explained_var": 0.44619995365067133, "kl": 0.0063059434819609, "entropy": 0.3604957872912997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 57295.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 731536, "num_env_steps_trained": 731536, "num_agent_steps_sampled": 2926144, "num_agent_steps_trained": 2926144}, "env_runners": {"episode_reward_max": 525.1703662770295, "episode_reward_min": -141.18189666090223, "episode_reward_mean": 105.14831064293892, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -678.7802077333373, "predator_policy": 11.326401806304847}, "policy_reward_max": {"prey_policy": 198.15673343344685, "predator_policy": 674.7659211623427}, "policy_reward_mean": {"prey_policy": -293.16362983264685, "predator_policy": 345.73778515411635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.01505604878658, 56.09559106054256, 14.637063751517328, 14.541539696160893, 415.089670486317, 42.260889845036196, 23.180100453283973, 246.2887727401272, 235.01103862394893, 62.470409617863034, 142.60168957730954, 458.15872077309814, 14.901448906183223, 6.052472943893241, 98.88588614028114, 162.4222550547975, 203.24671975483432, 231.39457711784922, 365.6232375987736, 257.56996791885405, 52.02880223064931, 0.002257035479579672, 147.71196044766307, 22.572560067665812, 375.7726652106977, 6.67713534109776, 56.84076101425985, 1.1306554092100858, 84.53186345375894, 5.896953131740986, 5.713913472250459, 39.46732837617372, -9.548367285297932, 114.08183527577474, 3.5240439021662673, 169.01744462386344, 162.3918753093551, 49.393498689246414, 30.348221281347037, 66.59735307542681, 72.56735791032585, 368.3220546112036, 260.8782873023447, -129.1903263317865, -141.18189666090223, -30.447837339238188, 189.0613254280178, -1.1376514519525132, 71.81645996623371, 67.64600075459296, 7.908964438153533, 2.484951764654883, 99.97417757817921, 14.0, 1.7721359549995785, 21.827142006649687, -3.8867465961540493, 12.758838389022529, 198.24710322535427, 130.7975328951143, 397.3250030649693, 3.9968028886505635e-15, 137.2546565039733, 26.984808764935256, 207.23616204049583, 0.19999999999999774, 190.72927074114682, 6.632597564694711, 110.13454521679954, 158.06721309725125, 525.1703662770295, 233.36447895338242, 6.4395656109656185, 53.90376385758418, 21.853349318980808, 214.01858753152746, 174.76740679221524, 96.49547976350432, 57.31858560226447, -6.451916955523366, 24.184086846450136, -20.285013784724782, 72.71193980598966, 0.0752422924546634, 23.830448255875314, 3.7, 161.74778169155312, 209.78155177909485, 180.24576260789775, 119.73270044747704, 135.12463910028825, 408.07409746744554, -1.2196291206243774, 215.87422860570908, 11.099999999999993, 242.10641621629486, -3.03594626300624, 25.782791957188653, 102.09693546044575, 257.94136516508684], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-297.8119780810899, -427.2122600369439, -312.77885594435367, -328.0174997780273, -335.47586267014395, -325.1930337580802, -406.39751017888034, -257.9549380056528, 99.37237031667445, -464.4489758617329, -292.0208893456175, -375.97702735678484, -305.14496812539454, -327.3323466809025, -107.46607664183145, -300.42579811770014, -525.7457429240525, -29.270922714046772, -492.11896122271463, -291.9405336649017, -571.8044320401567, 6.700028552632062, 168.96171200118775, -353.3707535273401, -322.926491215989, -98.46901034796991, -14.695471622450636, -350.4368092956129, -535.6230764969811, -372.8295559434746, -293.22046382313823, -376.87698477442234, 188.65637966899598, -340.86644540345605, -242.31775691377464, 198.15673343344685, 10.848484907992864, -420.6831080498751, -90.9065971103888, -503.58248170022443, -239.96542004347734, -437.69098570051233, -569.0024764087165, -304.4315111493223, -472.1894277328448, -180.27011875848746, -147.10850096287334, -336.87397596457214, -540.9491741381729, -45.97080976406513, -384.31711355210217, -321.25933197937024, -668.226189220318, -96.73920014596945, -362.9946732402305, -277.8811908986761, -217.8475157439845, -455.1131408867884, -390.51768414139144, -292.5975216684895, -387.2225549204208, -431.3242676969449, -201.72692291468783, -361.4963729291538, -467.47322262848485, -491.27680224814486, -391.3701619625329, -235.12281407502573, -535.9830109250639, -225.13625820870547, -411.23294566902234, -170.5053554839351, 73.07926611845865, -141.06734017028305, -376.98421751243706, -128.14267372199154, -270.2733862818236, -355.4937140942143, -402.50840196072085, -158.87690477895185, -248.25562380852676, -291.8382896194263, -338.65369726846916, 4.554087438683354, -76.79459282335483, -396.0606885119492, -361.9390733174221, -334.58023846235824, -345.2086014791459, -189.4961181552873, -298.5967249358607, -294.12707481494834, -193.2132409333862, -445.61131970100234, -373.7754713928169, -299.7980316918174, -459.9952471618873, -493.3850779331945, -205.17597413429212, -354.5047201391417, -325.2349981377868, -348.975598365745, -378.2705972884368, -271.06139295109136, -233.34372853723187, -342.8816528371606, -342.7988822382665, -455.07003678443, -360.90362112704065, -220.91447197000463, -464.7506415439816, -249.79672932477305, -326.88030068347547, -339.4245852459288, -98.77354966256009, -239.61398775578303, -508.876667922822, -252.72455143600828, -434.48586812874885, -177.33822459489923, 186.2872380275876, -479.9134050618319, -450.1514964806881, -545.7541155044141, -149.25371040945373, -312.4298300856101, -366.6086542577786, -534.215980218874, 189.69308980240487, -424.39687643890676, -400.5022055397651, -361.12878791927875, -87.95720873680088, -424.1293341679518, -610.403301316334, -273.2629120910093, -252.67435846531828, -368.48926581287327, -507.27984763230666, -135.34033892857144, -563.585588567027, 193.59788106859068, -611.9856049156725, 182.4424790199315, -283.99624681829994, -204.17266872308252, -342.98849138701456, -302.6656624033566, -307.7112908808412, -410.9375063846221, -199.68137223209177, -402.3974525143611, -214.04720636799627, -678.7802077333373, -439.1511402258122, -87.78880170193234, -291.0386244301281, -275.5399069635648, -327.52750710638657, -360.3300437390891, -347.3820614715974, -293.7951125462604, -275.58316305679546, -434.1816778758367, -169.62084294938913, -65.09972246909705, -486.5546442109778, -455.50913520505617, -308.7730066548156, -234.85610037575793, -238.78422907954456, -355.9011197075383, -185.59813621540005, -398.001662721148, -338.5954040216208, -132.1860779324345, -134.13115048304496, -294.3456173560034, -43.38482661389484, -361.1534570988931, -137.29578639421715, -304.0340106850967, -432.3856274060231, 109.63885540225797, -419.75341338386875, -398.1867390806512, -387.64106905499557, 55.08290476184803, -234.79657823028475, -389.413398587356, -46.6052944777279, -595.0047328746858, -336.5509511300432, -340.0521908848041, -330.1390931557937, -454.91545449120736, -272.1583123042692, -218.7499871174911, -301.2257408075834, 190.40180570100713], "policy_predator_policy_reward": [405.69066721276687, 404.348626954053, 384.2892076195048, 312.60273916341896, 351.91771142273103, 323.3882487570103, 406.39751017888034, 272.4964777018136, 392.109716609452, 388.0565594219239, 332.2060222536739, 378.0527842937657, 264.9842163196621, 390.67319893991885, 342.5844407204308, 311.59620677922743, 492.7308039561733, 297.2969003058765, 455.4529567045501, 391.07694780093084, 499.89645284188765, 207.8096402229453, 340.2402225833417, 302.3275397159084, 323.62649121598906, 112.67045925415242, 19.713179485658056, 351.47157437629863, 674.7659211623427, 332.5725974183961, 428.0712974262588, 404.44840622609905, 14.590340085838317, 340.86644540345605, 200.23834658215824, 75.31725401601895, 400.4291187825199, 375.02874195813604, 415.8397904824726, 436.2192562469943, 442.0406230966713, 287.6445848779676, 569.0024764087165, 304.43376818480186, 456.4552680988858, 343.7162388401082, 168.85910379273577, 337.69593320237556, 486.43015998708256, 476.2624891258524, 350.47499696124254, 361.77858391132736, 156.16619915335116, 665.6399512271955, 363.77019280570477, 278.2363267424121, 262.49353722198424, 494.99898286254745, 390.51768414139144, 298.4944748002303, 390.9105018030956, 433.3502342865207, 350.9074309800182, 251.78319323999676, 477.62354012787785, 471.578117463454, 388.9655007295641, 351.60931058376985, 533.8301491525432, 230.8131638833924, 382.62759696880823, 368.1281488080116, 21.85661197693861, 208.52333738424053, 358.48970989034154, 196.0306800333328, 303.4210294064044, 352.6942922509811, 404.0084019607212, 223.97425785437903, 304.42571769794574, 308.2355536403337, 305.99540648377626, 396.4262579572146, 320.9254376512147, 412.808130986435, 165.165350529085, 402.16363491890957, 41.34533857297968, 352.17748440055124, 315.47160320134424, 246.80435921022686, 462.15744991205383, 365.72843615035345, 202.79209019508346, 469.6437614376009, 540.5080698271569, 484.68871523415834, 276.081643233265, 351.2450517947611, 283.0950966868477, 399.02446425483754, 379.228263007121, 272.58867899706183, 313.1294244371053, 363.07013451546624, 342.7988822382665, 469.07003678443004, 361.2036211270407, 222.38660792500417, 377.3372192753857, 359.037293600019, 323.67665226114406, 338.74148707210657, 291.5821668356003, 59.564208971765844, 430.7027348223892, 529.1455877617942, 439.6096772630967, 303.0119483556649, 302.22691874272766, 388.7242513564858, 450.1514964806881, 545.7541155044141, 260.13938000934144, 338.79881698969564, 383.1153536986497, 544.6940895429386, 17.543072238090982, 424.39687643890676, 400.5022055397651, 361.32878791927874, 335.91901742096525, 366.89679622493503, 570.1810857519296, 320.1177252201083, 341.4303573710959, 389.8678121238952, 424.66118717425474, 376.0262124838741, 477.1796597162171, 417.9784140592486, 612.3856049156725, 50.52199993345093, 285.6358124292658, 208.97266872308248, 333.2458330830468, 366.3120845649087, 323.6683228957037, 416.83382368874015, 424.16905550245434, 391.92835677552694, 636.3038732787088, 431.29094761483987, 219.80760965962952, 403.6278120316191, 424.43040307500917, 199.46671392094882, 360.7349010128205, 320.6707328771316, 324.92503027693874, 340.43623058736995, 252.81443358151907, 436.66539356638856, 11.326401806304847, 296.1061034181707, 486.5546442109778, 455.58437749751084, 237.85953907393358, 329.6000162125164, 242.38422907954453, 356.00111970753835, 325.55181948173475, 419.79576114636615, 312.3903952931486, 368.17263844000087, 319.4229541168841, 289.2995763300611, 290.56147165277633, 233.70951250749002, 315.16277971148077, 261.29165646812083, 381.44090489995756, 349.379964571252, 408.5874293508184, 408.13309399307667, 347.2748999437086, 201.15749295514826, 244.79657823028475, 390.5133985873563, 491.9638289524052, 391.7526146163051, 333.5150048670369, 340.0521908848041, 336.66592773833173, 474.1714118658581, 291.0192760874193, 301.98595879478626, 284.3183972593805, 84.44690301228414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 78.0511447115675, "mean_inference_ms": 66.94702894752369, "mean_action_processing_ms": 34.01826663315402, "mean_env_wait_ms": 20.335205429769324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004225730895996094, "StateBufferConnector_ms": 0.02316415309906006, "ViewRequirementAgentConnector_ms": 0.10557937622070312}, "num_episodes": 64, "episode_return_max": 525.1703662770295, "episode_return_min": -141.18189666090223, "episode_return_mean": 105.14831064293892, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2926144, "num_agent_steps_trained": 2926144, "num_env_steps_sampled": 731536, "num_env_steps_trained": 731536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 271.36435223933404, "num_env_steps_trained_throughput_per_sec": 271.36435223933404, "timesteps_total": 731536, "num_env_steps_sampled_lifetime": 731536, "num_agent_steps_sampled_lifetime": 2926144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2926144, "timers": {"training_iteration_time_ms": 71227.62, "restore_workers_time_ms": 0.637, "training_step_time_ms": 71226.112, "sample_time_ms": 4491.439, "learn_time_ms": 66681.058, "learn_throughput": 119.974, "synch_weights_time_ms": 45.383}, "counters": {"num_env_steps_sampled": 731536, "num_env_steps_trained": 731536, "num_agent_steps_sampled": 2926144, "num_agent_steps_trained": 2926144}, "done": false, "training_iteration": 91, "trial_id": "cdf01_00000", "date": "2024-08-20_13-53-34", "timestamp": 1724142214, "time_this_iter_s": 29.522665977478027, "time_total_s": 12450.783303976059, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x317e38310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12450.783303976059, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 38.03414634146342, "ram_util_percent": 82.99024390243903}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.256510901451112, "cur_kl_coeff": 3.216078221606172e-22, "cur_lr": 0.0001, "total_loss": 8.922261934431772, "policy_loss": -0.0031165283860727436, "vf_loss": 8.925378446730356, "vf_explained_var": -0.2783254959280529, "kl": 0.001930752565768339, "entropy": 0.12216340266759433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 57925.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.82615918394119, "cur_kl_coeff": 4.3368086899420174e-20, "cur_lr": 0.0001, "total_loss": 8.72991013602605, "policy_loss": -0.004166720773551672, "vf_loss": 8.734076845078242, "vf_explained_var": 0.4439156413078308, "kl": 0.004856462062231177, "entropy": 0.39644844342791846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 57925.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 739536, "num_env_steps_trained": 739536, "num_agent_steps_sampled": 2958144, "num_agent_steps_trained": 2958144}, "env_runners": {"episode_reward_max": 525.1703662770295, "episode_reward_min": -141.18189666090223, "episode_reward_mean": 105.47858622820183, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -678.7802077333373, "predator_policy": 11.326401806304847}, "policy_reward_max": {"prey_policy": 198.15673343344685, "predator_policy": 674.7659211623427}, "policy_reward_mean": {"prey_policy": -290.01329409437733, "predator_policy": 342.7525872084783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [235.01103862394893, 62.470409617863034, 142.60168957730954, 458.15872077309814, 14.901448906183223, 6.052472943893241, 98.88588614028114, 162.4222550547975, 203.24671975483432, 231.39457711784922, 365.6232375987736, 257.56996791885405, 52.02880223064931, 0.002257035479579672, 147.71196044766307, 22.572560067665812, 375.7726652106977, 6.67713534109776, 56.84076101425985, 1.1306554092100858, 84.53186345375894, 5.896953131740986, 5.713913472250459, 39.46732837617372, -9.548367285297932, 114.08183527577474, 3.5240439021662673, 169.01744462386344, 162.3918753093551, 49.393498689246414, 30.348221281347037, 66.59735307542681, 72.56735791032585, 368.3220546112036, 260.8782873023447, -129.1903263317865, -141.18189666090223, -30.447837339238188, 189.0613254280178, -1.1376514519525132, 71.81645996623371, 67.64600075459296, 7.908964438153533, 2.484951764654883, 99.97417757817921, 14.0, 1.7721359549995785, 21.827142006649687, -3.8867465961540493, 12.758838389022529, 198.24710322535427, 130.7975328951143, 397.3250030649693, 3.9968028886505635e-15, 137.2546565039733, 26.984808764935256, 207.23616204049583, 0.19999999999999774, 190.72927074114682, 6.632597564694711, 110.13454521679954, 158.06721309725125, 525.1703662770295, 233.36447895338242, 6.4395656109656185, 53.90376385758418, 21.853349318980808, 214.01858753152746, 174.76740679221524, 96.49547976350432, 57.31858560226447, -6.451916955523366, 24.184086846450136, -20.285013784724782, 72.71193980598966, 0.0752422924546634, 23.830448255875314, 3.7, 161.74778169155312, 209.78155177909485, 180.24576260789775, 119.73270044747704, 135.12463910028825, 408.07409746744554, -1.2196291206243774, 215.87422860570908, 11.099999999999993, 242.10641621629486, -3.03594626300624, 25.782791957188653, 102.09693546044575, 257.94136516508684, 92.81331522400795, 175.73776023841606, 43.03435551736143, 334.3673566029009, 126.42461070760847, 59.65402056700436, 0.5999999999999983, 97.50482375076554], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-525.7457429240525, -29.270922714046772, -492.11896122271463, -291.9405336649017, -571.8044320401567, 6.700028552632062, 168.96171200118775, -353.3707535273401, -322.926491215989, -98.46901034796991, -14.695471622450636, -350.4368092956129, -535.6230764969811, -372.8295559434746, -293.22046382313823, -376.87698477442234, 188.65637966899598, -340.86644540345605, -242.31775691377464, 198.15673343344685, 10.848484907992864, -420.6831080498751, -90.9065971103888, -503.58248170022443, -239.96542004347734, -437.69098570051233, -569.0024764087165, -304.4315111493223, -472.1894277328448, -180.27011875848746, -147.10850096287334, -336.87397596457214, -540.9491741381729, -45.97080976406513, -384.31711355210217, -321.25933197937024, -668.226189220318, -96.73920014596945, -362.9946732402305, -277.8811908986761, -217.8475157439845, -455.1131408867884, -390.51768414139144, -292.5975216684895, -387.2225549204208, -431.3242676969449, -201.72692291468783, -361.4963729291538, -467.47322262848485, -491.27680224814486, -391.3701619625329, -235.12281407502573, -535.9830109250639, -225.13625820870547, -411.23294566902234, -170.5053554839351, 73.07926611845865, -141.06734017028305, -376.98421751243706, -128.14267372199154, -270.2733862818236, -355.4937140942143, -402.50840196072085, -158.87690477895185, -248.25562380852676, -291.8382896194263, -338.65369726846916, 4.554087438683354, -76.79459282335483, -396.0606885119492, -361.9390733174221, -334.58023846235824, -345.2086014791459, -189.4961181552873, -298.5967249358607, -294.12707481494834, -193.2132409333862, -445.61131970100234, -373.7754713928169, -299.7980316918174, -459.9952471618873, -493.3850779331945, -205.17597413429212, -354.5047201391417, -325.2349981377868, -348.975598365745, -378.2705972884368, -271.06139295109136, -233.34372853723187, -342.8816528371606, -342.7988822382665, -455.07003678443, -360.90362112704065, -220.91447197000463, -464.7506415439816, -249.79672932477305, -326.88030068347547, -339.4245852459288, -98.77354966256009, -239.61398775578303, -508.876667922822, -252.72455143600828, -434.48586812874885, -177.33822459489923, 186.2872380275876, -479.9134050618319, -450.1514964806881, -545.7541155044141, -149.25371040945373, -312.4298300856101, -366.6086542577786, -534.215980218874, 189.69308980240487, -424.39687643890676, -400.5022055397651, -361.12878791927875, -87.95720873680088, -424.1293341679518, -610.403301316334, -273.2629120910093, -252.67435846531828, -368.48926581287327, -507.27984763230666, -135.34033892857144, -563.585588567027, 193.59788106859068, -611.9856049156725, 182.4424790199315, -283.99624681829994, -204.17266872308252, -342.98849138701456, -302.6656624033566, -307.7112908808412, -410.9375063846221, -199.68137223209177, -402.3974525143611, -214.04720636799627, -678.7802077333373, -439.1511402258122, -87.78880170193234, -291.0386244301281, -275.5399069635648, -327.52750710638657, -360.3300437390891, -347.3820614715974, -293.7951125462604, -275.58316305679546, -434.1816778758367, -169.62084294938913, -65.09972246909705, -486.5546442109778, -455.50913520505617, -308.7730066548156, -234.85610037575793, -238.78422907954456, -355.9011197075383, -185.59813621540005, -398.001662721148, -338.5954040216208, -132.1860779324345, -134.13115048304496, -294.3456173560034, -43.38482661389484, -361.1534570988931, -137.29578639421715, -304.0340106850967, -432.3856274060231, 109.63885540225797, -419.75341338386875, -398.1867390806512, -387.64106905499557, 55.08290476184803, -234.79657823028475, -389.413398587356, -46.6052944777279, -595.0047328746858, -336.5509511300432, -340.0521908848041, -330.1390931557937, -454.91545449120736, -272.1583123042692, -218.7499871174911, -301.2257408075834, 190.40180570100713, -209.5680622706944, -207.0856355409825, -363.81682428775804, -123.33255115725834, -281.19216303614246, -279.04936526625994, -442.4255511619268, 195.91006257737914, -340.04911367970783, -197.4444453969312, -350.6840883172946, -144.70356107471983, -347.57945193718365, -339.1195029859149, -455.87790735275905, -248.20034172440654], "policy_predator_policy_reward": [492.7308039561733, 297.2969003058765, 455.4529567045501, 391.07694780093084, 499.89645284188765, 207.8096402229453, 340.2402225833417, 302.3275397159084, 323.62649121598906, 112.67045925415242, 19.713179485658056, 351.47157437629863, 674.7659211623427, 332.5725974183961, 428.0712974262588, 404.44840622609905, 14.590340085838317, 340.86644540345605, 200.23834658215824, 75.31725401601895, 400.4291187825199, 375.02874195813604, 415.8397904824726, 436.2192562469943, 442.0406230966713, 287.6445848779676, 569.0024764087165, 304.43376818480186, 456.4552680988858, 343.7162388401082, 168.85910379273577, 337.69593320237556, 486.43015998708256, 476.2624891258524, 350.47499696124254, 361.77858391132736, 156.16619915335116, 665.6399512271955, 363.77019280570477, 278.2363267424121, 262.49353722198424, 494.99898286254745, 390.51768414139144, 298.4944748002303, 390.9105018030956, 433.3502342865207, 350.9074309800182, 251.78319323999676, 477.62354012787785, 471.578117463454, 388.9655007295641, 351.60931058376985, 533.8301491525432, 230.8131638833924, 382.62759696880823, 368.1281488080116, 21.85661197693861, 208.52333738424053, 358.48970989034154, 196.0306800333328, 303.4210294064044, 352.6942922509811, 404.0084019607212, 223.97425785437903, 304.42571769794574, 308.2355536403337, 305.99540648377626, 396.4262579572146, 320.9254376512147, 412.808130986435, 165.165350529085, 402.16363491890957, 41.34533857297968, 352.17748440055124, 315.47160320134424, 246.80435921022686, 462.15744991205383, 365.72843615035345, 202.79209019508346, 469.6437614376009, 540.5080698271569, 484.68871523415834, 276.081643233265, 351.2450517947611, 283.0950966868477, 399.02446425483754, 379.228263007121, 272.58867899706183, 313.1294244371053, 363.07013451546624, 342.7988822382665, 469.07003678443004, 361.2036211270407, 222.38660792500417, 377.3372192753857, 359.037293600019, 323.67665226114406, 338.74148707210657, 291.5821668356003, 59.564208971765844, 430.7027348223892, 529.1455877617942, 439.6096772630967, 303.0119483556649, 302.22691874272766, 388.7242513564858, 450.1514964806881, 545.7541155044141, 260.13938000934144, 338.79881698969564, 383.1153536986497, 544.6940895429386, 17.543072238090982, 424.39687643890676, 400.5022055397651, 361.32878791927874, 335.91901742096525, 366.89679622493503, 570.1810857519296, 320.1177252201083, 341.4303573710959, 389.8678121238952, 424.66118717425474, 376.0262124838741, 477.1796597162171, 417.9784140592486, 612.3856049156725, 50.52199993345093, 285.6358124292658, 208.97266872308248, 333.2458330830468, 366.3120845649087, 323.6683228957037, 416.83382368874015, 424.16905550245434, 391.92835677552694, 636.3038732787088, 431.29094761483987, 219.80760965962952, 403.6278120316191, 424.43040307500917, 199.46671392094882, 360.7349010128205, 320.6707328771316, 324.92503027693874, 340.43623058736995, 252.81443358151907, 436.66539356638856, 11.326401806304847, 296.1061034181707, 486.5546442109778, 455.58437749751084, 237.85953907393358, 329.6000162125164, 242.38422907954453, 356.00111970753835, 325.55181948173475, 419.79576114636615, 312.3903952931486, 368.17263844000087, 319.4229541168841, 289.2995763300611, 290.56147165277633, 233.70951250749002, 315.16277971148077, 261.29165646812083, 381.44090489995756, 349.379964571252, 408.5874293508184, 408.13309399307667, 347.2748999437086, 201.15749295514826, 244.79657823028475, 390.5133985873563, 491.9638289524052, 391.7526146163051, 333.5150048670369, 340.0521908848041, 336.66592773833173, 474.1714118658581, 291.0192760874193, 301.98595879478626, 284.3183972593805, 84.44690301228414, 277.0313033366833, 232.4357096990012, 324.16477276905795, 338.72236291437474, 281.32617394641716, 321.9497098733457, 419.60555842375237, 161.2772867636965, 325.585429505987, 338.33274027825985, 231.1023886273474, 323.93928133167293, 348.1794519371836, 339.1195029859149, 428.6912872157428, 372.89178561218665]}, "sampler_perf": {"mean_raw_obs_processing_ms": 78.06919490669327, "mean_inference_ms": 67.0315298966213, "mean_action_processing_ms": 33.89564066858562, "mean_env_wait_ms": 20.203087241199935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041779279708862305, "StateBufferConnector_ms": 0.02290201187133789, "ViewRequirementAgentConnector_ms": 0.1087799072265625}, "num_episodes": 8, "episode_return_max": 525.1703662770295, "episode_return_min": -141.18189666090223, "episode_return_mean": 105.47858622820183, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2958144, "num_agent_steps_trained": 2958144, "num_env_steps_sampled": 739536, "num_env_steps_trained": 739536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 270.9571195166098, "num_env_steps_trained_throughput_per_sec": 270.9571195166098, "timesteps_total": 739536, "num_env_steps_sampled_lifetime": 739536, "num_agent_steps_sampled_lifetime": 2958144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2958144, "timers": {"training_iteration_time_ms": 35295.335, "restore_workers_time_ms": 0.027, "training_step_time_ms": 35294.883, "sample_time_ms": 1452.284, "learn_time_ms": 33791.091, "learn_throughput": 236.749, "synch_weights_time_ms": 44.477}, "counters": {"num_env_steps_sampled": 739536, "num_env_steps_trained": 739536, "num_agent_steps_sampled": 2958144, "num_agent_steps_trained": 2958144}, "done": false, "training_iteration": 92, "trial_id": "cdf01_00000", "date": "2024-08-20_13-54-03", "timestamp": 1724142243, "time_this_iter_s": 29.567625999450684, "time_total_s": 12480.35092997551, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a528e1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12480.35092997551, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 38.34285714285715, "ram_util_percent": 82.68333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.165031136217571, "cur_kl_coeff": 1.608039110803086e-22, "cur_lr": 0.0001, "total_loss": Infinity, "policy_loss": -0.0037286689763681756, "vf_loss": 8.657519145238966, "vf_explained_var": -0.23896886583358523, "kl": Infinity, "entropy": 0.135255228952756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 58555.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.006862919292752, "cur_kl_coeff": 2.1684043449710087e-20, "cur_lr": 0.0001, "total_loss": 8.55888748623076, "policy_loss": -0.004998950694598967, "vf_loss": 8.56388641539074, "vf_explained_var": 0.4051165180546897, "kl": 0.005319341547793657, "entropy": 0.3756950517968526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 58555.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 747536, "num_env_steps_trained": 747536, "num_agent_steps_sampled": 2990144, "num_agent_steps_trained": 2990144}, "env_runners": {"episode_reward_max": 417.8597654012439, "episode_reward_min": -67.639741554252, "episode_reward_mean": 111.96913055534915, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -678.7802077333373, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.91006257737914, "predator_policy": 636.3038732787088}, "policy_reward_mean": {"prey_policy": -285.0153380591871, "predator_policy": 340.99990333686173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.4395656109656185, 53.90376385758418, 21.853349318980808, 214.01858753152746, 174.76740679221524, 96.49547976350432, 57.31858560226447, -6.451916955523366, 24.184086846450136, -20.285013784724782, 72.71193980598966, 0.0752422924546634, 23.830448255875314, 3.7, 161.74778169155312, 209.78155177909485, 180.24576260789775, 119.73270044747704, 135.12463910028825, 408.07409746744554, -1.2196291206243774, 215.87422860570908, 11.099999999999993, 242.10641621629486, -3.03594626300624, 25.782791957188653, 102.09693546044575, 257.94136516508684, 92.81331522400795, 175.73776023841606, 43.03435551736143, 334.3673566029009, 126.42461070760847, 59.65402056700436, 0.5999999999999983, 97.50482375076554, 216.48774455410128, 8.715321273298452, 359.4039716342624, 245.5817437802051, 149.86029250948485, 55.8415473072442, -0.3176082673554361, 44.993516502639274, 21.637119105443848, 177.0369082009414, 219.6203968175803, 228.50622576793518, 314.6276452126327, 71.6641573195653, 8.439387001421727, 79.71796945309629, 49.50054781821057, 118.0314406586081, 150.91690091824208, 132.5344896913261, 40.25695550697796, -67.639741554252, 291.00561807079305, 0.10000000000000231, 3.188020215717952, 413.4480358102672, 153.0237754741245, 194.85587519145753, 0.3202636480765544, 143.2316621922455, 250.64041702140068, 188.69941764456166, 228.88082997009246, 122.69355797753488, 417.8597654012439, 290.9117116283665, 252.7008531726242, 90.10126057885529, 93.08335878300113, 106.80076496648151, 0.8999999999999994, 28.543212723392443, 174.925663078541, -9.304929528924806, 23.355764741371853, 237.73995561897664, 7.375119088623669, 42.871826330631, 124.26789760014717, 159.83554894169413, 120.35214364956985, 2.200000000000002, 144.7384339906357, -57.152149393414355, 55.60164913559601, 270.1863787960168, 1.1896303482096662, 7.128945067634874, 101.2188680518627, -2.049109073885062, -0.8589545529436053, 135.12862367379125, 39.251192314134, 4.454763314321987], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-283.99624681829994, -204.17266872308252, -342.98849138701456, -302.6656624033566, -307.7112908808412, -410.9375063846221, -199.68137223209177, -402.3974525143611, -214.04720636799627, -678.7802077333373, -439.1511402258122, -87.78880170193234, -291.0386244301281, -275.5399069635648, -327.52750710638657, -360.3300437390891, -347.3820614715974, -293.7951125462604, -275.58316305679546, -434.1816778758367, -169.62084294938913, -65.09972246909705, -486.5546442109778, -455.50913520505617, -308.7730066548156, -234.85610037575793, -238.78422907954456, -355.9011197075383, -185.59813621540005, -398.001662721148, -338.5954040216208, -132.1860779324345, -134.13115048304496, -294.3456173560034, -43.38482661389484, -361.1534570988931, -137.29578639421715, -304.0340106850967, -432.3856274060231, 109.63885540225797, -419.75341338386875, -398.1867390806512, -387.64106905499557, 55.08290476184803, -234.79657823028475, -389.413398587356, -46.6052944777279, -595.0047328746858, -336.5509511300432, -340.0521908848041, -330.1390931557937, -454.91545449120736, -272.1583123042692, -218.7499871174911, -301.2257408075834, 190.40180570100713, -209.5680622706944, -207.0856355409825, -363.81682428775804, -123.33255115725834, -281.19216303614246, -279.04936526625994, -442.4255511619268, 195.91006257737914, -340.04911367970783, -197.4444453969312, -350.6840883172946, -144.70356107471983, -347.57945193718365, -339.1195029859149, -455.87790735275905, -248.20034172440654, -611.1916079440306, -39.57674003222127, -360.3287291241678, -380.3981536759767, -319.326385810523, 180.08574464904177, -180.820237134854, -315.6226828727933, -199.1722441041269, 46.58107678822081, -438.21584765803186, -304.6379941114795, -416.8518938577162, -308.02144770160044, -406.99094655729596, -175.72445448299104, -136.41719557015037, -405.4528660383718, -90.80734343854661, -428.94942681131954, -325.1962302588285, -73.84914938809601, -198.53534702090514, -324.70553668358264, -538.3027207232777, -113.66508527135693, -346.3953359738681, -227.2204932445275, -444.94205455751916, -340.1066592967625, -340.3531976732806, -353.5344815728594, -325.78775692373364, -354.19030309438654, -372.09360150631494, -144.8739643678505, -371.65933915701044, -158.62681151771127, -297.5177142062919, -144.54855287773648, -366.0366314819348, -591.0744925185968, -433.3714197399853, -520.7808391894324, -162.59810860668003, -577.4891899767135, -563.2240212007358, -307.66728047506604, -281.82424227600916, -256.5109880268447, -367.50112206777123, 179.28921601172487, -104.72620334246298, -457.6685428595587, 189.17587680731714, -358.0876674939648, -354.98752719219675, -605.4119911008256, -126.74132268340031, -416.74687978278985, -344.0949335442342, 118.09999999999948, -317.1601766358052, 174.28026371373244, -395.82766722489555, -30.029765154066155, -193.01669725769622, -455.638035595924, -646.7004476796598, -3.2774743702678615, -365.6956913952278, 184.33400358585294, -9.020497589081529, -319.8001419111157, -369.68843611415895, -143.19628483392856, -163.95767424342625, -461.46134533917484, -210.44094356522933, -383.04702859062513, -291.6459643957325, -455.4161674908365, -327.0420228108478, -298.95861973937343, -276.84161316554577, 165.87935319898693, -413.11603848888524, -573.0979095705266, -437.2877034356724, -311.0275479142488, -675.4554764251802, 64.2262718958068, -306.25025777602644, -608.125518042488, -367.90646931814007, -348.0162294864224, -153.8533769889242, -484.2192060313569, -219.00445739508285, -403.94509431140267, -351.50276393076894, -241.84696948321934, -263.4214620242398, -274.6044159465063, -350.53701031849357, -13.31169279492191, -279.2199289261453, -505.07986395321774, -237.55892342146007, -346.3615752863596, 3.1519129497670146, -294.93162692928746, -294.97062056950125, -320.0247022070868, -319.7394927546981, -319.82631882706795, -509.0984162650222, 12.209779517708693, -388.01645645273146, -341.2419913334067, -410.05274852686375, -295.0843611643041, -464.3752886834464, -173.94049206159562, -348.7540580754986, -320.0669489381898, -305.2697010552281, -361.0267704674807], "policy_predator_policy_reward": [285.6358124292658, 208.97266872308248, 333.2458330830468, 366.3120845649087, 323.6683228957037, 416.83382368874015, 424.16905550245434, 391.92835677552694, 636.3038732787088, 431.29094761483987, 219.80760965962952, 403.6278120316191, 424.43040307500917, 199.46671392094882, 360.7349010128205, 320.6707328771316, 324.92503027693874, 340.43623058736995, 252.81443358151907, 436.66539356638856, 11.326401806304847, 296.1061034181707, 486.5546442109778, 455.58437749751084, 237.85953907393358, 329.6000162125164, 242.38422907954453, 356.00111970753835, 325.55181948173475, 419.79576114636615, 312.3903952931486, 368.17263844000087, 319.4229541168841, 289.2995763300611, 290.56147165277633, 233.70951250749002, 315.16277971148077, 261.29165646812083, 381.44090489995756, 349.379964571252, 408.5874293508184, 408.13309399307667, 347.2748999437086, 201.15749295514826, 244.79657823028475, 390.5133985873563, 491.9638289524052, 391.7526146163051, 333.5150048670369, 340.0521908848041, 336.66592773833173, 474.1714118658581, 291.0192760874193, 301.98595879478626, 284.3183972593805, 84.44690301228414, 277.0313033366833, 232.4357096990012, 324.16477276905795, 338.72236291437474, 281.32617394641716, 321.9497098733457, 419.60555842375237, 161.2772867636965, 325.585429505987, 338.33274027825985, 231.1023886273474, 323.93928133167293, 348.1794519371836, 339.1195029859149, 428.6912872157428, 372.89178561218665, 552.0585357612316, 315.19755676912166, 407.04657127365414, 342.3956327997888, 216.17215825272243, 282.47245454302157, 319.50202443646805, 422.522639351382, 218.08793639265932, 84.36352343273124, 421.1162018829557, 377.5791871937988, 410.87202689056153, 313.6837064014002, 198.66069814068402, 429.0482194022413, 144.58440748414876, 418.9227732298163, 435.6034580362447, 261.19022041456395, 308.5280638157073, 310.13771264879705, 375.4376348036776, 376.30947466874755, 474.90720549642685, 491.68824571083917, 373.5360233183119, 271.7439632196488, 372.6644493141872, 420.8236515415166, 427.3649881397366, 346.24066055950124, 329.7534204509221, 399.7251873854095, 313.2488485044746, 321.75015802829887, 318.8359689940289, 362.3670825989343, 258.5547666818785, 316.0459900934756, 401.6089849362126, 595.7590945712972, 442.2226675489782, 444.28984982618977, 542.387320135718, 488.7055965184679, 563.2240212007358, 307.767280475066, 282.12424227600917, 259.3990082425626, 345.19766570873156, 256.4622761575821, 258.0139108390874, 457.4046108370585, 5.6799983841403545, 358.0876674939648, 355.02608970963627, 605.6936922314626, 316.09436728197744, 370.62549737645776, 272.8857009075929, 203.74964965804315, 317.1601766358052, 14.4191539308294, 303.4573074694408, 351.28095487961554, 315.7102552352305, 455.638035595924, 549.2358274508507, 518.6018600003193, 354.163385250285, 118.11001418745647, 303.6603146570953, 277.86117801572624, 474.28212844146117, 128.70385308548177, 361.8895158018746, 356.61286256372887, 317.0132749630494, 383.27546215928646, 292.5459643957327, 455.4161674908365, 341.07446193042193, 313.4693933431921, 0.0, 285.88792304509985, 402.70090019529147, 574.2081183351953, 437.95668960616604, 333.7143264851271, 604.1726469187524, 244.79651322959614, 313.6253768646501, 608.125518042488, 410.07829564877164, 348.7162294864224, 485.693938608359, 276.64654201206906, 427.46041153635366, 355.3246891118271, 333.7008947973992, 380.00098226615705, 265.5214620242396, 274.70441594650634, 222.98218864848184, 285.6049484555697, 217.8950988803504, 509.25254460559836, 428.41614787405763, 211.10599996935827, 264.75765247476124, 297.2084403007767, 317.3923851316526, 298.7925679931451, 295.4388189465363, 351.25593770286395, 481.58318147083315, 116.5243233283437, 385.96734737884617, 341.2419913334067, 402.1203366339827, 302.1578185042418, 452.18994567587896, 321.2544587429557, 307.7247874980628, 400.3474118297591, 312.9678396475465, 357.7833951894838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 76.65742070337481, "mean_inference_ms": 65.74407972243341, "mean_action_processing_ms": 33.40379003722384, "mean_env_wait_ms": 19.971232682039535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003617525100708008, "StateBufferConnector_ms": 0.018402457237243652, "ViewRequirementAgentConnector_ms": 0.09908437728881836}, "num_episodes": 64, "episode_return_max": 417.8597654012439, "episode_return_min": -67.639741554252, "episode_return_mean": 111.96913055534915, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2990144, "num_agent_steps_trained": 2990144, "num_env_steps_sampled": 747536, "num_env_steps_trained": 747536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 270.1978463107638, "num_env_steps_trained_throughput_per_sec": 270.1978463107638, "timesteps_total": 747536, "num_env_steps_sampled_lifetime": 747536, "num_agent_steps_sampled_lifetime": 2990144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 2990144, "timers": {"training_iteration_time_ms": 29860.275, "restore_workers_time_ms": 0.028, "training_step_time_ms": 29859.879, "sample_time_ms": 1194.365, "learn_time_ms": 28630.035, "learn_throughput": 279.427, "synch_weights_time_ms": 29.038}, "counters": {"num_env_steps_sampled": 747536, "num_env_steps_trained": 747536, "num_agent_steps_sampled": 2990144, "num_agent_steps_trained": 2990144}, "done": false, "training_iteration": 93, "trial_id": "cdf01_00000", "date": "2024-08-20_13-54-33", "timestamp": 1724142273, "time_this_iter_s": 29.64982509613037, "time_total_s": 12510.00075507164, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5383e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12510.00075507164, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 33.94523809523809, "ram_util_percent": 83.06904761904764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.052944246171013, "cur_kl_coeff": 2.4120586662046284e-22, "cur_lr": 0.0001, "total_loss": 8.994471147325303, "policy_loss": -0.0032551915665704105, "vf_loss": 8.99772635111733, "vf_explained_var": -0.42078117822843886, "kl": 0.001827122048758784, "entropy": 0.12278016890798296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 59185.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.02376693770999, "cur_kl_coeff": 2.1684043449710087e-20, "cur_lr": 0.0001, "total_loss": 8.640250837235223, "policy_loss": -0.0036021462756223857, "vf_loss": 8.643852981688484, "vf_explained_var": 0.5123919022461725, "kl": 0.004251583099262678, "entropy": 0.42160181284896914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 59185.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 755536, "num_env_steps_trained": 755536, "num_agent_steps_sampled": 3022144, "num_agent_steps_trained": 3022144}, "env_runners": {"episode_reward_max": 631.8343204377844, "episode_reward_min": -67.639741554252, "episode_reward_mean": 120.37320806411431, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -703.5332060861319, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 195.91006257737914, "predator_policy": 636.2810993410103}, "policy_reward_mean": {"prey_policy": -279.4286539322551, "predator_policy": 339.6152579643123}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.184086846450136, -20.285013784724782, 72.71193980598966, 0.0752422924546634, 23.830448255875314, 3.7, 161.74778169155312, 209.78155177909485, 180.24576260789775, 119.73270044747704, 135.12463910028825, 408.07409746744554, -1.2196291206243774, 215.87422860570908, 11.099999999999993, 242.10641621629486, -3.03594626300624, 25.782791957188653, 102.09693546044575, 257.94136516508684, 92.81331522400795, 175.73776023841606, 43.03435551736143, 334.3673566029009, 126.42461070760847, 59.65402056700436, 0.5999999999999983, 97.50482375076554, 216.48774455410128, 8.715321273298452, 359.4039716342624, 245.5817437802051, 149.86029250948485, 55.8415473072442, -0.3176082673554361, 44.993516502639274, 21.637119105443848, 177.0369082009414, 219.6203968175803, 228.50622576793518, 314.6276452126327, 71.6641573195653, 8.439387001421727, 79.71796945309629, 49.50054781821057, 118.0314406586081, 150.91690091824208, 132.5344896913261, 40.25695550697796, -67.639741554252, 291.00561807079305, 0.10000000000000231, 3.188020215717952, 413.4480358102672, 153.0237754741245, 194.85587519145753, 0.3202636480765544, 143.2316621922455, 250.64041702140068, 188.69941764456166, 228.88082997009246, 122.69355797753488, 417.8597654012439, 290.9117116283665, 252.7008531726242, 90.10126057885529, 93.08335878300113, 106.80076496648151, 0.8999999999999994, 28.543212723392443, 174.925663078541, -9.304929528924806, 23.355764741371853, 237.73995561897664, 7.375119088623669, 42.871826330631, 124.26789760014717, 159.83554894169413, 120.35214364956985, 2.200000000000002, 144.7384339906357, -57.152149393414355, 55.60164913559601, 270.1863787960168, 1.1896303482096662, 7.128945067634874, 101.2188680518627, -2.049109073885062, -0.8589545529436053, 135.12862367379125, 39.251192314134, 4.454763314321987, 0.3999999999999999, -14.01334434728448, 303.7162872480394, 66.43500424279775, 239.95980166577505, 29.969337081463163, 200.45116606945766, 631.8343204377844], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-347.3820614715974, -293.7951125462604, -275.58316305679546, -434.1816778758367, -169.62084294938913, -65.09972246909705, -486.5546442109778, -455.50913520505617, -308.7730066548156, -234.85610037575793, -238.78422907954456, -355.9011197075383, -185.59813621540005, -398.001662721148, -338.5954040216208, -132.1860779324345, -134.13115048304496, -294.3456173560034, -43.38482661389484, -361.1534570988931, -137.29578639421715, -304.0340106850967, -432.3856274060231, 109.63885540225797, -419.75341338386875, -398.1867390806512, -387.64106905499557, 55.08290476184803, -234.79657823028475, -389.413398587356, -46.6052944777279, -595.0047328746858, -336.5509511300432, -340.0521908848041, -330.1390931557937, -454.91545449120736, -272.1583123042692, -218.7499871174911, -301.2257408075834, 190.40180570100713, -209.5680622706944, -207.0856355409825, -363.81682428775804, -123.33255115725834, -281.19216303614246, -279.04936526625994, -442.4255511619268, 195.91006257737914, -340.04911367970783, -197.4444453969312, -350.6840883172946, -144.70356107471983, -347.57945193718365, -339.1195029859149, -455.87790735275905, -248.20034172440654, -611.1916079440306, -39.57674003222127, -360.3287291241678, -380.3981536759767, -319.326385810523, 180.08574464904177, -180.820237134854, -315.6226828727933, -199.1722441041269, 46.58107678822081, -438.21584765803186, -304.6379941114795, -416.8518938577162, -308.02144770160044, -406.99094655729596, -175.72445448299104, -136.41719557015037, -405.4528660383718, -90.80734343854661, -428.94942681131954, -325.1962302588285, -73.84914938809601, -198.53534702090514, -324.70553668358264, -538.3027207232777, -113.66508527135693, -346.3953359738681, -227.2204932445275, -444.94205455751916, -340.1066592967625, -340.3531976732806, -353.5344815728594, -325.78775692373364, -354.19030309438654, -372.09360150631494, -144.8739643678505, -371.65933915701044, -158.62681151771127, -297.5177142062919, -144.54855287773648, -366.0366314819348, -591.0744925185968, -433.3714197399853, -520.7808391894324, -162.59810860668003, -577.4891899767135, -563.2240212007358, -307.66728047506604, -281.82424227600916, -256.5109880268447, -367.50112206777123, 179.28921601172487, -104.72620334246298, -457.6685428595587, 189.17587680731714, -358.0876674939648, -354.98752719219675, -605.4119911008256, -126.74132268340031, -416.74687978278985, -344.0949335442342, 118.09999999999948, -317.1601766358052, 174.28026371373244, -395.82766722489555, -30.029765154066155, -193.01669725769622, -455.638035595924, -646.7004476796598, -3.2774743702678615, -365.6956913952278, 184.33400358585294, -9.020497589081529, -319.8001419111157, -369.68843611415895, -143.19628483392856, -163.95767424342625, -461.46134533917484, -210.44094356522933, -383.04702859062513, -291.6459643957325, -455.4161674908365, -327.0420228108478, -298.95861973937343, -276.84161316554577, 165.87935319898693, -413.11603848888524, -573.0979095705266, -437.2877034356724, -311.0275479142488, -675.4554764251802, 64.2262718958068, -306.25025777602644, -608.125518042488, -367.90646931814007, -348.0162294864224, -153.8533769889242, -484.2192060313569, -219.00445739508285, -403.94509431140267, -351.50276393076894, -241.84696948321934, -263.4214620242398, -274.6044159465063, -350.53701031849357, -13.31169279492191, -279.2199289261453, -505.07986395321774, -237.55892342146007, -346.3615752863596, 3.1519129497670146, -294.93162692928746, -294.97062056950125, -320.0247022070868, -319.7394927546981, -319.82631882706795, -509.0984162650222, 12.209779517708693, -388.01645645273146, -341.2419913334067, -410.05274852686375, -295.0843611643041, -464.3752886834464, -173.94049206159562, -348.7540580754986, -320.0669489381898, -305.2697010552281, -361.0267704674807, -362.6413355141709, -321.10320588161204, -395.72609311823317, -331.6896223311467, -239.05372617183275, -55.917143944394915, -473.2242368758561, -63.96807994775439, -336.7632845346867, 177.80107317688174, -256.1984084653384, -274.51588951400396, -107.03654142656633, -453.9265303551344, -703.5332060861319, 186.0789267644676], "policy_predator_policy_reward": [324.92503027693874, 340.43623058736995, 252.81443358151907, 436.66539356638856, 11.326401806304847, 296.1061034181707, 486.5546442109778, 455.58437749751084, 237.85953907393358, 329.6000162125164, 242.38422907954453, 356.00111970753835, 325.55181948173475, 419.79576114636615, 312.3903952931486, 368.17263844000087, 319.4229541168841, 289.2995763300611, 290.56147165277633, 233.70951250749002, 315.16277971148077, 261.29165646812083, 381.44090489995756, 349.379964571252, 408.5874293508184, 408.13309399307667, 347.2748999437086, 201.15749295514826, 244.79657823028475, 390.5133985873563, 491.9638289524052, 391.7526146163051, 333.5150048670369, 340.0521908848041, 336.66592773833173, 474.1714118658581, 291.0192760874193, 301.98595879478626, 284.3183972593805, 84.44690301228414, 277.0313033366833, 232.4357096990012, 324.16477276905795, 338.72236291437474, 281.32617394641716, 321.9497098733457, 419.60555842375237, 161.2772867636965, 325.585429505987, 338.33274027825985, 231.1023886273474, 323.93928133167293, 348.1794519371836, 339.1195029859149, 428.6912872157428, 372.89178561218665, 552.0585357612316, 315.19755676912166, 407.04657127365414, 342.3956327997888, 216.17215825272243, 282.47245454302157, 319.50202443646805, 422.522639351382, 218.08793639265932, 84.36352343273124, 421.1162018829557, 377.5791871937988, 410.87202689056153, 313.6837064014002, 198.66069814068402, 429.0482194022413, 144.58440748414876, 418.9227732298163, 435.6034580362447, 261.19022041456395, 308.5280638157073, 310.13771264879705, 375.4376348036776, 376.30947466874755, 474.90720549642685, 491.68824571083917, 373.5360233183119, 271.7439632196488, 372.6644493141872, 420.8236515415166, 427.3649881397366, 346.24066055950124, 329.7534204509221, 399.7251873854095, 313.2488485044746, 321.75015802829887, 318.8359689940289, 362.3670825989343, 258.5547666818785, 316.0459900934756, 401.6089849362126, 595.7590945712972, 442.2226675489782, 444.28984982618977, 542.387320135718, 488.7055965184679, 563.2240212007358, 307.767280475066, 282.12424227600917, 259.3990082425626, 345.19766570873156, 256.4622761575821, 258.0139108390874, 457.4046108370585, 5.6799983841403545, 358.0876674939648, 355.02608970963627, 605.6936922314626, 316.09436728197744, 370.62549737645776, 272.8857009075929, 203.74964965804315, 317.1601766358052, 14.4191539308294, 303.4573074694408, 351.28095487961554, 315.7102552352305, 455.638035595924, 549.2358274508507, 518.6018600003193, 354.163385250285, 118.11001418745647, 303.6603146570953, 277.86117801572624, 474.28212844146117, 128.70385308548177, 361.8895158018746, 356.61286256372887, 317.0132749630494, 383.27546215928646, 292.5459643957327, 455.4161674908365, 341.07446193042193, 313.4693933431921, 0.0, 285.88792304509985, 402.70090019529147, 574.2081183351953, 437.95668960616604, 333.7143264851271, 604.1726469187524, 244.79651322959614, 313.6253768646501, 608.125518042488, 410.07829564877164, 348.7162294864224, 485.693938608359, 276.64654201206906, 427.46041153635366, 355.3246891118271, 333.7008947973992, 380.00098226615705, 265.5214620242396, 274.70441594650634, 222.98218864848184, 285.6049484555697, 217.8950988803504, 509.25254460559836, 428.41614787405763, 211.10599996935827, 264.75765247476124, 297.2084403007767, 317.3923851316526, 298.7925679931451, 295.4388189465363, 351.25593770286395, 481.58318147083315, 116.5243233283437, 385.96734737884617, 341.2419913334067, 402.1203366339827, 302.1578185042418, 452.18994567587896, 321.2544587429557, 307.7247874980628, 400.3474118297591, 312.9678396475465, 357.7833951894838, 362.6413355141709, 321.503205881612, 379.31274877094904, 334.0896223311466, 284.3795314975504, 314.3076258667172, 146.69378746499933, 456.93353360140907, 215.9268146395191, 182.99519838406076, 268.5449437174375, 292.13869134336875, 334.181398772734, 427.2328390784239, 636.2810993410103, 513.0075004184376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 76.67826049970984, "mean_inference_ms": 65.8295283044761, "mean_action_processing_ms": 33.28465961550552, "mean_env_wait_ms": 19.842430374877345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003567218780517578, "StateBufferConnector_ms": 0.01738870143890381, "ViewRequirementAgentConnector_ms": 0.09970712661743164}, "num_episodes": 8, "episode_return_max": 631.8343204377844, "episode_return_min": -67.639741554252, "episode_return_mean": 120.37320806411431, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3022144, "num_agent_steps_trained": 3022144, "num_env_steps_sampled": 755536, "num_env_steps_trained": 755536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 271.510817763159, "num_env_steps_trained_throughput_per_sec": 271.510817763159, "timesteps_total": 755536, "num_env_steps_sampled_lifetime": 755536, "num_agent_steps_sampled_lifetime": 3022144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3022144, "timers": {"training_iteration_time_ms": 29768.351, "restore_workers_time_ms": 0.027, "training_step_time_ms": 29767.976, "sample_time_ms": 1160.515, "learn_time_ms": 28574.223, "learn_throughput": 279.973, "synch_weights_time_ms": 27.739}, "counters": {"num_env_steps_sampled": 755536, "num_env_steps_trained": 755536, "num_agent_steps_sampled": 3022144, "num_agent_steps_trained": 3022144}, "done": false, "training_iteration": 94, "trial_id": "cdf01_00000", "date": "2024-08-20_13-55-03", "timestamp": 1724142303, "time_this_iter_s": 29.476696252822876, "time_total_s": 12539.477451324463, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a528e550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12539.477451324463, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 26.435714285714283, "ram_util_percent": 83.07619047619049}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.484693016703167, "cur_kl_coeff": 1.2060293331023142e-22, "cur_lr": 0.0001, "total_loss": 8.63815611809019, "policy_loss": -0.0036524479665483037, "vf_loss": 8.641808564322336, "vf_explained_var": -0.026881067336551726, "kl": 0.002296909159959464, "entropy": 0.14618516094864362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 59815.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.903252953574771, "cur_kl_coeff": 1.0842021724855043e-20, "cur_lr": 0.0001, "total_loss": 8.940476712726412, "policy_loss": -0.004763527208244398, "vf_loss": 8.945240216028123, "vf_explained_var": 0.4560521195805262, "kl": 0.004394929029010763, "entropy": 0.37944631557615977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 59815.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 763536, "num_env_steps_trained": 763536, "num_agent_steps_sampled": 3054144, "num_agent_steps_trained": 3054144}, "env_runners": {"episode_reward_max": 631.8343204377844, "episode_reward_min": -57.152149393414355, "episode_reward_mean": 133.434273093633, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -782.8344868002051, "predator_policy": 0.7773806485001598}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 782.8344868002051}, "policy_reward_mean": {"prey_policy": -285.13337682005454, "predator_policy": 351.85051336687116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.355764741371853, 237.73995561897664, 7.375119088623669, 42.871826330631, 124.26789760014717, 159.83554894169413, 120.35214364956985, 2.200000000000002, 144.7384339906357, -57.152149393414355, 55.60164913559601, 270.1863787960168, 1.1896303482096662, 7.128945067634874, 101.2188680518627, -2.049109073885062, -0.8589545529436053, 135.12862367379125, 39.251192314134, 4.454763314321987, 0.3999999999999999, -14.01334434728448, 303.7162872480394, 66.43500424279775, 239.95980166577505, 29.969337081463163, 200.45116606945766, 631.8343204377844, 202.24246305595403, 144.94105496697625, 261.28562043844096, 1.6999999999999986, 585.1483275605892, 358.45191558748616, 279.5179996421563, 295.1498594188362, 236.86605990542793, 324.93286169694403, 25.105478643895374, 0.8000000000000003, 5.0, 6.663752946840005, 170.30178512788416, 12.94073339655985, 118.58070892424634, -0.7489177582784259, 16.03061838469135, 217.4603880913426, 367.44176641630526, 77.25987552451856, 253.68051675705703, 302.8541713402835, 171.3401301014707, 226.93420508812252, 227.2426262909968, 337.5998792374515, 93.6139449450168, 0.19036037888237578, -0.253347604537296, 204.13872753206303, -7.886488853439521, 19.885750189951825, 108.57455926701098, 175.943244409214, 94.62162910065028, 154.60404362319477, 32.27733679743042, 263.12928875026586, 78.46304785161794, 47.2725557018985, 6.661338147750939e-16, -2.220446049250313e-16, 187.01799797463192, 36.409701525782275, 222.9508070622915, 234.36069207676965, 165.62680429661856, 443.26795453437165, 3.2734606251848626, 234.98232392452226, 44.45804379037022, 185.79155215397222, -0.6135412177430823, 28.390336478340856, -1.3322676295501878e-15, 223.75070995663623, 204.1046190361062, 62.12855595784107, 265.54861533043567, 134.6046101404894, 236.01223431611123, 122.99082257527864, 90.97618657864054, 46.239906021904176, 208.57117730625404, 86.50012327554253, 29.30285346093001, 50.14644090615184, 434.74738531881525, -5.000696959373275], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-437.2877034356724, -311.0275479142488, -675.4554764251802, 64.2262718958068, -306.25025777602644, -608.125518042488, -367.90646931814007, -348.0162294864224, -153.8533769889242, -484.2192060313569, -219.00445739508285, -403.94509431140267, -351.50276393076894, -241.84696948321934, -263.4214620242398, -274.6044159465063, -350.53701031849357, -13.31169279492191, -279.2199289261453, -505.07986395321774, -237.55892342146007, -346.3615752863596, 3.1519129497670146, -294.93162692928746, -294.97062056950125, -320.0247022070868, -319.7394927546981, -319.82631882706795, -509.0984162650222, 12.209779517708693, -388.01645645273146, -341.2419913334067, -410.05274852686375, -295.0843611643041, -464.3752886834464, -173.94049206159562, -348.7540580754986, -320.0669489381898, -305.2697010552281, -361.0267704674807, -362.6413355141709, -321.10320588161204, -395.72609311823317, -331.6896223311467, -239.05372617183275, -55.917143944394915, -473.2242368758561, -63.96807994775439, -336.7632845346867, 177.80107317688174, -256.1984084653384, -274.51588951400396, -107.03654142656633, -453.9265303551344, -703.5332060861319, 186.0789267644676, -540.5542976795668, -137.84766695871502, -189.66518792625303, -316.7272261665275, -144.1318746722351, -462.1226122794722, -417.6484605054593, -428.1920524931595, 10.161063711170783, -690.2521015311466, -405.68107903268213, 136.9970686396847, -629.1503875194521, -51.55975560780726, 198.2, -368.7292490277352, -257.90803235803435, -153.21509234327712, 197.2352040192658, -338.9327206217606, -393.13436968839824, -311.397951593834, -258.3872917105321, -564.1807654203108, -260.3515085362085, -322.85547426852435, -332.2008050382151, -311.7119177363571, -550.8276781575896, -191.33800838083621, -333.231827765028, -478.65539036646135, -221.1562836951266, -378.2836476242374, -356.7976931053356, -334.5462395737963, -287.37285907014245, 14.64570854555842, 194.26430244677456, -782.8344868002051, 10.911202001078324, -493.9840828868343, -221.01932956687344, -457.82509425941004, -397.57773906094684, -13.263691910507767, -337.1566129264515, -88.13384172374606, -202.95479736953996, -334.06782986737977, -486.595015930576, -208.18691478322208, -351.73376140574635, -225.29869848373247, -340.2605969532636, 42.29679448940187, -268.904294590884, -384.8747618321053, -478.859059449723, -339.47185995042116, -285.72248494999604, -120.29927386645662, -162.54108402652858, -397.85754196147786, -325.1350666432593, -469.1163978235847, -366.6321152004686, -337.2674958076422, -49.61800070483838, -654.0836321642007, -387.55878105638647, -9.070799127393824, -161.86548634912762, -381.8494771283794, -319.11936341498557, -220.655803607639, -271.109186803688, -425.09083617375853, -423.4932288033657, -50.796837660723696, -349.0077609327417, -81.5884535645392, -378.36866045346864, -310.7079994004501, -299.4837326036247, -303.97427774098077, -316.7978774542803, -425.07914948910684, -511.5517007982221, -112.92954808507011, -421.67645886560445, -365.0388073358922, -380.77459650524503, -4.433239141266343, 89.9809223085683, -367.57329042267054, 146.0617792675796, -301.2869992881828, -351.58928067048447, 179.88709895259362, -365.45448861895454, -363.69179940685063, -73.99689523111446, -379.91263754090346, -361.4415671440459, -247.00536105792125, -78.6147695880984, -352.49265521781535, -384.3373806467036, -357.18842523436103, -405.6073856682765, -329.1874790398635, -499.4055895847644, -378.0686574065391, -519.4497716415349, -257.76635985851493, -344.5343688881505, 200.0, -423.14887023381334, -474.8511606764205, -534.5964152418493, 58.73911437707416, -251.2389342960009, -283.9307541332419, -452.5889319121048, -51.71824267391137, -385.5069042545958, -284.06874805167195, -213.76134226338547, -274.1606765702965, -259.7435068663331, -330.04604228378054, 187.4, -375.68183608756146, -313.67198056578115, -431.84828567442776, -473.73254544727763, -262.9562748701623, -313.7308742159745, -75.74775192220552, -425.81393125078404, 171.2330684140349, -438.76733852372325, -325.94176977854517], "policy_predator_policy_reward": [437.95668960616604, 333.7143264851271, 604.1726469187524, 244.79651322959614, 313.6253768646501, 608.125518042488, 410.07829564877164, 348.7162294864224, 485.693938608359, 276.64654201206906, 427.46041153635366, 355.3246891118271, 333.7008947973992, 380.00098226615705, 265.5214620242396, 274.70441594650634, 222.98218864848184, 285.6049484555697, 217.8950988803504, 509.25254460559836, 428.41614787405763, 211.10599996935827, 264.75765247476124, 297.2084403007767, 317.3923851316526, 298.7925679931451, 295.4388189465363, 351.25593770286395, 481.58318147083315, 116.5243233283437, 385.96734737884617, 341.2419913334067, 402.1203366339827, 302.1578185042418, 452.18994567587896, 321.2544587429557, 307.7247874980628, 400.3474118297591, 312.9678396475465, 357.7833951894838, 362.6413355141709, 321.503205881612, 379.31274877094904, 334.0896223311466, 284.3795314975504, 314.3076258667172, 146.69378746499933, 456.93353360140907, 215.9268146395191, 182.99519838406076, 268.5449437174375, 292.13869134336875, 334.181398772734, 427.2328390784239, 636.2810993410103, 513.0075004184376, 448.3911539795864, 432.25327371465215, 373.9593216471327, 277.37414741262324, 547.7559489168563, 319.7841584732933, 418.74846050545926, 428.79205249315964, 657.1612221954431, 608.0781431851206, 365.0032971877848, 262.1326287926978, 359.35708418992994, 600.8710585794861, 359.1412125242731, 106.53789592229802, 377.92596989553755, 270.06321471120145, 189.74032967550278, 276.89004862393625, 329.85258547422995, 399.7852144518981, 259.18729171053224, 564.1807654203108, 265.3515085362085, 322.85547426852435, 319.7460030584081, 330.83047266300423, 401.1982741244928, 511.2691975418178, 361.4394827141978, 463.3884688138514, 302.25787758481573, 415.7627626587952, 322.2271083995721, 368.36790652128235, 287.9803882607752, 0.7773806485001598, 23.196085644568083, 782.8344868002051, 371.1988496486349, 479.3157976534254, 325.24858972730937, 430.85570962349203, 289.136920730766, 375.3850269977446, 327.4221669648609, 400.7224590256203, 350.9649633810708, 357.3977939573194, 471.38855292909466, 450.32758287282394, 348.0508549916154, 456.2242311888593, 328.06275780518996, 307.5009238961232, 378.9350301698646, 368.4579711981423, 478.859059449723, 339.6622203293035, 287.20431381144584, 118.56409740046948, 328.5467004095391, 435.9906531105304, 425.48400609953785, 360.88096951386746, 366.9563181825987, 356.82904301546387, 196.51506682867407, 615.7611253073768, 249.81661670893556, 322.75620788405934, 284.2969632061938, 354.0396293719625, 397.1761952615094, 297.2030153843126, 254.98940968882258, 473.48795008605464, 420.1625002573819, 317.25685495697405, 341.6276905282135, 167.431571820686, 383.3148911226819, 353.0343244331351, 299.4837326036247, 303.97427774098077, 316.7978774542803, 425.07914948910684, 457.8903285369107, 353.608918321014, 453.02170193622663, 370.1032657910523, 282.5024462698324, 325.656196438972, 257.45858133345615, 254.49447885741753, 19.56502502903899, 301.2869992881828, 310.2325841898936, 304.7375520623691, 364.35454164182596, 368.0652070091643, 354.2501786724202, 334.64167802411976, 340.8707716455454, 312.0342003467921, 267.6024420311691, 349.29653492871654, 394.99161524718954, 345.92064941613154, 410.3877324351679, 352.79746875131167, 499.4055895847644, 378.0686574065391, 467.0069737750912, 533.9598676815949, 344.5343688881505, 4.104619036106202, 402.35931071796193, 557.7692761501139, 479.0939252809083, 262.31199091430295, 433.0397427809051, 236.73455578882783, 445.52108531555086, 294.7983235865772, 452.56328231041425, 340.0031925711345, 265.4504503077207, 313.4477551046024, 298.6316431174413, 337.3978120545767, 193.95746253487553, 202.89555085893997, 410.3465879105925, 421.6738016051602, 473.73193655344227, 292.2597372249279, 320.067820565389, 119.55724647894216, 351.51692137430854, 337.8113267812563, 427.2720607651295, 332.4363505777656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 75.39218152918822, "mean_inference_ms": 64.71999727622898, "mean_action_processing_ms": 32.71850860255023, "mean_env_wait_ms": 19.5087261369484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002921462059020996, "StateBufferConnector_ms": 0.011298537254333496, "ViewRequirementAgentConnector_ms": 0.08854925632476807}, "num_episodes": 72, "episode_return_max": 631.8343204377844, "episode_return_min": -57.152149393414355, "episode_return_mean": 133.434273093633, "episodes_this_iter": 72}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3054144, "num_agent_steps_trained": 3054144, "num_env_steps_sampled": 763536, "num_env_steps_trained": 763536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 274.53074574677953, "num_env_steps_trained_throughput_per_sec": 274.53074574677953, "timesteps_total": 763536, "num_env_steps_sampled_lifetime": 763536, "num_agent_steps_sampled_lifetime": 3054144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3054144, "timers": {"training_iteration_time_ms": 29678.704, "restore_workers_time_ms": 0.027, "training_step_time_ms": 29678.288, "sample_time_ms": 1148.922, "learn_time_ms": 28496.527, "learn_throughput": 280.736, "synch_weights_time_ms": 27.643}, "counters": {"num_env_steps_sampled": 763536, "num_env_steps_trained": 763536, "num_agent_steps_sampled": 3054144, "num_agent_steps_trained": 3054144}, "done": false, "training_iteration": 95, "trial_id": "cdf01_00000", "date": "2024-08-20_13-55-32", "timestamp": 1724142332, "time_this_iter_s": 29.19585108757019, "time_total_s": 12568.673302412033, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a53b63a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12568.673302412033, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 25.092682926829266, "ram_util_percent": 83.27560975609757}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.559347716778044, "cur_kl_coeff": 6.030146665511571e-23, "cur_lr": 0.0001, "total_loss": 8.560712781785027, "policy_loss": -0.00412539683193678, "vf_loss": 8.564838149055602, "vf_explained_var": -0.019537566673187984, "kl": 0.002820137470418544, "entropy": 0.1399909942750893, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 60445.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.268310588503641, "cur_kl_coeff": 5.421010862427522e-21, "cur_lr": 0.0001, "total_loss": 8.77325710190667, "policy_loss": -0.004335207242282137, "vf_loss": 8.777592279040624, "vf_explained_var": 0.5535055771706596, "kl": 0.0050144053457668435, "entropy": 0.41768863456589833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 60445.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 771536, "num_env_steps_trained": 771536, "num_agent_steps_sampled": 3086144, "num_agent_steps_trained": 3086144}, "env_runners": {"episode_reward_max": 519.6108606393143, "episode_reward_min": -6.906990669770692, "episode_reward_mean": 120.00017132557565, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -766.1518503991119, "predator_policy": 3.4155724063513437}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 664.2821960567484}, "policy_reward_mean": {"prey_policy": -288.5673857785881, "predator_policy": 348.567471441376}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.62162910065028, 154.60404362319477, 32.27733679743042, 263.12928875026586, 78.46304785161794, 47.2725557018985, 6.661338147750939e-16, -2.220446049250313e-16, 187.01799797463192, 36.409701525782275, 222.9508070622915, 234.36069207676965, 165.62680429661856, 443.26795453437165, 3.2734606251848626, 234.98232392452226, 44.45804379037022, 185.79155215397222, -0.6135412177430823, 28.390336478340856, -1.3322676295501878e-15, 223.75070995663623, 204.1046190361062, 62.12855595784107, 265.54861533043567, 134.6046101404894, 236.01223431611123, 122.99082257527864, 90.97618657864054, 46.239906021904176, 208.57117730625404, 86.50012327554253, 29.30285346093001, 50.14644090615184, 434.74738531881525, -5.000696959373275, 9.51619215656784, 0.10000000000000142, 11.16454324237241, 184.5624718946032, 3.200000000000003, -1.0358226557023524, 201.12414745687732, 88.92373616629376, 162.04580850592055, 20.947125916716388, 292.6303666108696, -3.785330382026048, 47.44763882340324, 22.75662124972144, 12.073128926040175, 1.2000000000000024, 1.4000000000000012, 519.6108606393143, 288.11268617498934, 262.89811443902664, 147.49002642914581, 202.66109617731226, 193.51557240635134, 81.89105697925466, 26.690750249255913, 119.04991579142472, 0.3412938496994291, 34.5530673504963, 264.3752950460202, 328.93929789944673, -8.881784197001252e-16, 0.0804645180707928, 75.14341518406657, 365.83417956390025, 85.27445830244608, 185.30000000000004, -0.3642832946175629, 1.9984014443252818e-15, 92.17688898219434, 43.614236855424515, 25.465015262184867, 421.7010071345402, 187.14103904249345, 116.42393936530954, 136.7505556247027, 33.32035747891103, 55.972075681651546, 205.86745581436648, 224.54321857055143, 67.29962235060891, 93.69996095555729, 23.32905421772514, 2.220446049250313e-16, -5.112311043299625, 10.483950650141503, 102.62123116377859, 14.274776693770544, 314.849792086793, 145.81632262139846, 77.39933261653898, -6.906990669770692, 328.6335096826363, 406.0044526439757, 2.073164886182969], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-161.86548634912762, -381.8494771283794, -319.11936341498557, -220.655803607639, -271.109186803688, -425.09083617375853, -423.4932288033657, -50.796837660723696, -349.0077609327417, -81.5884535645392, -378.36866045346864, -310.7079994004501, -299.4837326036247, -303.97427774098077, -316.7978774542803, -425.07914948910684, -511.5517007982221, -112.92954808507011, -421.67645886560445, -365.0388073358922, -380.77459650524503, -4.433239141266343, 89.9809223085683, -367.57329042267054, 146.0617792675796, -301.2869992881828, -351.58928067048447, 179.88709895259362, -365.45448861895454, -363.69179940685063, -73.99689523111446, -379.91263754090346, -361.4415671440459, -247.00536105792125, -78.6147695880984, -352.49265521781535, -384.3373806467036, -357.18842523436103, -405.6073856682765, -329.1874790398635, -499.4055895847644, -378.0686574065391, -519.4497716415349, -257.76635985851493, -344.5343688881505, 200.0, -423.14887023381334, -474.8511606764205, -534.5964152418493, 58.73911437707416, -251.2389342960009, -283.9307541332419, -452.5889319121048, -51.71824267391137, -385.5069042545958, -284.06874805167195, -213.76134226338547, -274.1606765702965, -259.7435068663331, -330.04604228378054, 187.4, -375.68183608756146, -313.67198056578115, -431.84828567442776, -473.73254544727763, -262.9562748701623, -313.7308742159745, -75.74775192220552, -425.81393125078404, 171.2330684140349, -438.76733852372325, -325.94176977854517, -230.09953033736934, -487.9749169218651, -288.3890063473964, -481.0492655433539, -428.7964196178175, -99.0749969465097, -132.46504123459525, -209.24470324674854, -428.2316371553478, -423.51730746956497, -510.18564131082815, -360.40838078009426, -310.8391359347525, -18.61922218084146, -319.6332104121543, -436.32085878006745, -143.62619653366872, -359.36984883907036, -312.4954858967955, -398.19539326749765, -145.48285502404462, -554.2991973665139, -319.32156126973547, -327.8609070557624, -606.1537055562288, -335.82184452410195, -509.217600015588, -267.5491854103234, -339.38114192319756, -124.69999860857646, -257.26760051647443, -366.3974972188473, -279.86826537939726, -363.77520347531987, -766.1518503991119, 187.96471253435172, -322.50128611675916, 196.4804665128505, -360.8102642029369, -219.10214463776526, -464.53796490516874, -354.36853723379687, -398.0292384749538, -98.21618181001372, 190.10000000000002, -368.69507448144776, -499.8322447274325, -63.174882014163394, -178.65247563437632, -394.5018143976142, -304.1038566346862, -373.0161877514576, -384.696322504317, -424.0558241849517, -268.53100290352967, -232.05051114915537, -693.0011997194632, -34.83871639825122, -442.7641952215569, 177.7039300536067, -280.9945400390534, -534.2439368905401, -326.78745582832903, -424.79672955503185, -277.6837126103407, -350.78758748037785, 190.5584447310061, -481.073928583484, -458.15210214254705, -439.1451845180302, -356.13959166283695, 174.4159112429135, -354.12630215940266, -284.74765170080155, -637.0114248161282, -356.3449260033722, -146.85202033723004, -405.5864586767675, -149.8837721219147, -484.4612137544745, -272.4087951050518, -15.933836002796214, 150.95506982420918, -320.67368754046555, -296.3219583977268, 174.97532266097159, -484.91925363219264, -299.71853709283346, -221.9609986268966, -558.5318270969514, -244.4411109039132, -351.53232014881354, -313.22418896045207, -456.19442489913337, 176.45925275242104, -356.824451423304, 182.697378370761, -595.1791873074116, -199.16015104159473, -540.1914813414777, -208.1714072902331, -313.55628685845664, -412.4117695864771, -376.7745841078371, -292.3035540244393, -376.52552763529, -502.67278539199805, -384.4078095156026, -396.9076333688058, -298.0689086158951, -292.41482148415776, -169.30122884266976, -428.35160946907644, -330.9861697704946, 186.66276158870724, -319.0508764320741, -458.4178420316593, -34.4197649720073, -478.9247286364178, -327.700903235067, -366.9171281461571, -496.99817479951173, -256.96103449745664, 2.3418824744710562, 180.83532215981703, -693.3217786040534, -407.79757427582774, -307.01564408510814], "policy_predator_policy_reward": [284.2969632061938, 354.0396293719625, 397.1761952615094, 297.2030153843126, 254.98940968882258, 473.48795008605464, 420.1625002573819, 317.25685495697405, 341.6276905282135, 167.431571820686, 383.3148911226819, 353.0343244331351, 299.4837326036247, 303.97427774098077, 316.7978774542803, 425.07914948910684, 457.8903285369107, 353.608918321014, 453.02170193622663, 370.1032657910523, 282.5024462698324, 325.656196438972, 257.45858133345615, 254.49447885741753, 19.56502502903899, 301.2869992881828, 310.2325841898936, 304.7375520623691, 364.35454164182596, 368.0652070091643, 354.2501786724202, 334.64167802411976, 340.8707716455454, 312.0342003467921, 267.6024420311691, 349.29653492871654, 394.99161524718954, 345.92064941613154, 410.3877324351679, 352.79746875131167, 499.4055895847644, 378.0686574065391, 467.0069737750912, 533.9598676815949, 344.5343688881505, 4.104619036106202, 402.35931071796193, 557.7692761501139, 479.0939252809083, 262.31199091430295, 433.0397427809051, 236.73455578882783, 445.52108531555086, 294.7983235865772, 452.56328231041425, 340.0031925711345, 265.4504503077207, 313.4477551046024, 298.6316431174413, 337.3978120545767, 193.95746253487553, 202.89555085893997, 410.3465879105925, 421.6738016051602, 473.73193655344227, 292.2597372249279, 320.067820565389, 119.55724647894216, 351.51692137430854, 337.8113267812563, 427.2720607651295, 332.4363505777656, 239.61572249393726, 487.9749169218651, 288.4890063473964, 481.0492655433539, 429.2964196178175, 109.73954018888143, 200.72449964097177, 325.54771673497544, 431.43163715534774, 423.51730746956497, 510.18564131082815, 359.3725581243919, 297.8993822979914, 232.6831232744801, 394.6999765198372, 450.1778288386806, 338.20118823625216, 326.84066564240624, 309.8754766742815, 421.7625284067271, 483.26481098138487, 509.14760802004145, 382.77344838056075, 260.62368956291095, 587.858868615468, 401.56432028826504, 507.28145865547816, 292.2419480201541, 339.38114192319756, 136.7731275346161, 258.46760051647436, 366.3974972188473, 281.0682653793973, 363.97520347531986, 582.1301282282417, 515.6678702758336, 306.45922203123183, 107.67428374766644, 312.43008840367247, 530.380434876058, 479.79705029336566, 486.5994782747459, 337.3715576915121, 361.53495877076807, 3.4155724063513437, 368.69507448144776, 465.6817534830077, 179.21643023784247, 356.1259777831157, 243.71906249813037, 454.95634123217116, 341.2136189453962, 384.696322504317, 424.3971180346511, 296.1588522807098, 238.97572912247185, 327.9330151069863, 664.2821960567484, 420.430178268043, 173.56938479935354, 280.9945400390534, 534.2439368905401, 326.78745582832903, 424.87719407310266, 378.79013540014114, 324.8245798746447, 473.035199154278, 183.31446426210098, 486.8252798277365, 495.74646513528614, 356.13959166283695, 10.884088757086507, 354.3313630912627, 284.17830747432396, 637.0114248161282, 356.3449260033722, 337.615214547528, 307.00015344866307, 357.30700695842404, 320.65221577339025, 11.74664275016829, 302.0610036198647, 287.62318031976554, 303.7964445310317, 296.3219583977268, 12.165716381521854, 407.6263405100448, 493.4353895802925, 486.62323547074385, 430.62014587780595, 288.53962770218783, 340.7541608294485, 457.5424894005576, 367.84820014067924, 29.208203061945483, 357.0244514233041, 41.845840199790615, 595.1791873074116, 511.2852874084899, 295.36596732519064, 353.08683571683986, 262.34081938740735, 412.7958237917851, 399.7195841202542, 292.3035540244393, 376.52552763529, 533.9756733321933, 347.9926105321072, 360.11945741720984, 345.3410352176336, 264.03117471477753, 300.306106775828, 440.126386162847, 333.48616977049517, 262.50945581378346, 184.72845111637662, 458.4178420316593, 180.23608759340567, 493.0775238979333, 390.9474405900905, 354.0842605047832, 502.9240517711148, 375.06356819364106, 208.18909351197982, 617.9454889997894, 300.54542008842225, 409.79757427582774, 307.0888089712911]}, "sampler_perf": {"mean_raw_obs_processing_ms": 72.55023416311887, "mean_inference_ms": 62.11400718684517, "mean_action_processing_ms": 32.203541369221, "mean_env_wait_ms": 19.028970815441916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031952857971191406, "StateBufferConnector_ms": 0.011758208274841309, "ViewRequirementAgentConnector_ms": 0.09420347213745117}, "num_episodes": 64, "episode_return_max": 519.6108606393143, "episode_return_min": -6.906990669770692, "episode_return_mean": 120.00017132557565, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3086144, "num_agent_steps_trained": 3086144, "num_env_steps_sampled": 771536, "num_env_steps_trained": 771536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 271.4760639293061, "num_env_steps_trained_throughput_per_sec": 271.4760639293061, "timesteps_total": 771536, "num_env_steps_sampled_lifetime": 771536, "num_agent_steps_sampled_lifetime": 3086144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3086144, "timers": {"training_iteration_time_ms": 29597.525, "restore_workers_time_ms": 0.027, "training_step_time_ms": 29597.098, "sample_time_ms": 1155.38, "learn_time_ms": 28409.932, "learn_throughput": 281.592, "synch_weights_time_ms": 27.075}, "counters": {"num_env_steps_sampled": 771536, "num_env_steps_trained": 771536, "num_agent_steps_sampled": 3086144, "num_agent_steps_trained": 3086144}, "done": false, "training_iteration": 96, "trial_id": "cdf01_00000", "date": "2024-08-20_13-56-01", "timestamp": 1724142361, "time_this_iter_s": 29.502191066741943, "time_total_s": 12598.175493478775, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5fcf820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12598.175493478775, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 25.35238095238096, "ram_util_percent": 83.08095238095237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.265582612582616, "cur_kl_coeff": 3.0150733327557855e-23, "cur_lr": 0.0001, "total_loss": 8.981429741874575, "policy_loss": -0.004384859811721577, "vf_loss": 8.985814597114684, "vf_explained_var": -0.2501747553310697, "kl": 0.0025088342473325266, "entropy": 0.12048633960740907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 61075.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.94330262380933, "cur_kl_coeff": 5.421010862427522e-21, "cur_lr": 0.0001, "total_loss": 9.001912136683389, "policy_loss": -0.004444658476859331, "vf_loss": 9.006356799413288, "vf_explained_var": 0.47949718255845325, "kl": 0.003563411045127843, "entropy": 0.3372180663404011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 61075.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 779536, "num_env_steps_trained": 779536, "num_agent_steps_sampled": 3118144, "num_agent_steps_trained": 3118144}, "env_runners": {"episode_reward_max": 519.6108606393143, "episode_reward_min": -6.906990669770692, "episode_reward_mean": 131.07085337788567, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -766.1518503991119, "predator_policy": 3.4155724063513437}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 664.2821960567484}, "policy_reward_mean": {"prey_policy": -280.91760030228596, "predator_policy": 346.45302699122885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [187.01799797463192, 36.409701525782275, 222.9508070622915, 234.36069207676965, 165.62680429661856, 443.26795453437165, 3.2734606251848626, 234.98232392452226, 44.45804379037022, 185.79155215397222, -0.6135412177430823, 28.390336478340856, -1.3322676295501878e-15, 223.75070995663623, 204.1046190361062, 62.12855595784107, 265.54861533043567, 134.6046101404894, 236.01223431611123, 122.99082257527864, 90.97618657864054, 46.239906021904176, 208.57117730625404, 86.50012327554253, 29.30285346093001, 50.14644090615184, 434.74738531881525, -5.000696959373275, 9.51619215656784, 0.10000000000000142, 11.16454324237241, 184.5624718946032, 3.200000000000003, -1.0358226557023524, 201.12414745687732, 88.92373616629376, 162.04580850592055, 20.947125916716388, 292.6303666108696, -3.785330382026048, 47.44763882340324, 22.75662124972144, 12.073128926040175, 1.2000000000000024, 1.4000000000000012, 519.6108606393143, 288.11268617498934, 262.89811443902664, 147.49002642914581, 202.66109617731226, 193.51557240635134, 81.89105697925466, 26.690750249255913, 119.04991579142472, 0.3412938496994291, 34.5530673504963, 264.3752950460202, 328.93929789944673, -8.881784197001252e-16, 0.0804645180707928, 75.14341518406657, 365.83417956390025, 85.27445830244608, 185.30000000000004, -0.3642832946175629, 1.9984014443252818e-15, 92.17688898219434, 43.614236855424515, 25.465015262184867, 421.7010071345402, 187.14103904249345, 116.42393936530954, 136.7505556247027, 33.32035747891103, 55.972075681651546, 205.86745581436648, 224.54321857055143, 67.29962235060891, 93.69996095555729, 23.32905421772514, 2.220446049250313e-16, -5.112311043299625, 10.483950650141503, 102.62123116377859, 14.274776693770544, 314.849792086793, 145.81632262139846, 77.39933261653898, -6.906990669770692, 328.6335096826363, 406.0044526439757, 2.073164886182969, 307.3324517062492, 5.467086360224982, 279.5985865630586, 321.16838846408257, 228.57694708861393, 104.82360048278713, 100.22772984949538, 430.2413165415506], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-511.5517007982221, -112.92954808507011, -421.67645886560445, -365.0388073358922, -380.77459650524503, -4.433239141266343, 89.9809223085683, -367.57329042267054, 146.0617792675796, -301.2869992881828, -351.58928067048447, 179.88709895259362, -365.45448861895454, -363.69179940685063, -73.99689523111446, -379.91263754090346, -361.4415671440459, -247.00536105792125, -78.6147695880984, -352.49265521781535, -384.3373806467036, -357.18842523436103, -405.6073856682765, -329.1874790398635, -499.4055895847644, -378.0686574065391, -519.4497716415349, -257.76635985851493, -344.5343688881505, 200.0, -423.14887023381334, -474.8511606764205, -534.5964152418493, 58.73911437707416, -251.2389342960009, -283.9307541332419, -452.5889319121048, -51.71824267391137, -385.5069042545958, -284.06874805167195, -213.76134226338547, -274.1606765702965, -259.7435068663331, -330.04604228378054, 187.4, -375.68183608756146, -313.67198056578115, -431.84828567442776, -473.73254544727763, -262.9562748701623, -313.7308742159745, -75.74775192220552, -425.81393125078404, 171.2330684140349, -438.76733852372325, -325.94176977854517, -230.09953033736934, -487.9749169218651, -288.3890063473964, -481.0492655433539, -428.7964196178175, -99.0749969465097, -132.46504123459525, -209.24470324674854, -428.2316371553478, -423.51730746956497, -510.18564131082815, -360.40838078009426, -310.8391359347525, -18.61922218084146, -319.6332104121543, -436.32085878006745, -143.62619653366872, -359.36984883907036, -312.4954858967955, -398.19539326749765, -145.48285502404462, -554.2991973665139, -319.32156126973547, -327.8609070557624, -606.1537055562288, -335.82184452410195, -509.217600015588, -267.5491854103234, -339.38114192319756, -124.69999860857646, -257.26760051647443, -366.3974972188473, -279.86826537939726, -363.77520347531987, -766.1518503991119, 187.96471253435172, -322.50128611675916, 196.4804665128505, -360.8102642029369, -219.10214463776526, -464.53796490516874, -354.36853723379687, -398.0292384749538, -98.21618181001372, 190.10000000000002, -368.69507448144776, -499.8322447274325, -63.174882014163394, -178.65247563437632, -394.5018143976142, -304.1038566346862, -373.0161877514576, -384.696322504317, -424.0558241849517, -268.53100290352967, -232.05051114915537, -693.0011997194632, -34.83871639825122, -442.7641952215569, 177.7039300536067, -280.9945400390534, -534.2439368905401, -326.78745582832903, -424.79672955503185, -277.6837126103407, -350.78758748037785, 190.5584447310061, -481.073928583484, -458.15210214254705, -439.1451845180302, -356.13959166283695, 174.4159112429135, -354.12630215940266, -284.74765170080155, -637.0114248161282, -356.3449260033722, -146.85202033723004, -405.5864586767675, -149.8837721219147, -484.4612137544745, -272.4087951050518, -15.933836002796214, 150.95506982420918, -320.67368754046555, -296.3219583977268, 174.97532266097159, -484.91925363219264, -299.71853709283346, -221.9609986268966, -558.5318270969514, -244.4411109039132, -351.53232014881354, -313.22418896045207, -456.19442489913337, 176.45925275242104, -356.824451423304, 182.697378370761, -595.1791873074116, -199.16015104159473, -540.1914813414777, -208.1714072902331, -313.55628685845664, -412.4117695864771, -376.7745841078371, -292.3035540244393, -376.52552763529, -502.67278539199805, -384.4078095156026, -396.9076333688058, -298.0689086158951, -292.41482148415776, -169.30122884266976, -428.35160946907644, -330.9861697704946, 186.66276158870724, -319.0508764320741, -458.4178420316593, -34.4197649720073, -478.9247286364178, -327.700903235067, -366.9171281461571, -496.99817479951173, -256.96103449745664, 2.3418824744710562, 180.83532215981703, -693.3217786040534, -407.79757427582774, -307.01564408510814, -42.734584144305465, -551.7722309142788, -360.88972527843663, -306.7086945232058, 187.77623643769797, -417.38091355574625, -374.51515390916035, 196.31969352516646, -278.5382454059095, 24.5380801680993, -345.8185912555158, -236.50811138018358, -191.60432078337323, -292.177555937436, -366.66103420742263, 167.64411484358993], "policy_predator_policy_reward": [457.8903285369107, 353.608918321014, 453.02170193622663, 370.1032657910523, 282.5024462698324, 325.656196438972, 257.45858133345615, 254.49447885741753, 19.56502502903899, 301.2869992881828, 310.2325841898936, 304.7375520623691, 364.35454164182596, 368.0652070091643, 354.2501786724202, 334.64167802411976, 340.8707716455454, 312.0342003467921, 267.6024420311691, 349.29653492871654, 394.99161524718954, 345.92064941613154, 410.3877324351679, 352.79746875131167, 499.4055895847644, 378.0686574065391, 467.0069737750912, 533.9598676815949, 344.5343688881505, 4.104619036106202, 402.35931071796193, 557.7692761501139, 479.0939252809083, 262.31199091430295, 433.0397427809051, 236.73455578882783, 445.52108531555086, 294.7983235865772, 452.56328231041425, 340.0031925711345, 265.4504503077207, 313.4477551046024, 298.6316431174413, 337.3978120545767, 193.95746253487553, 202.89555085893997, 410.3465879105925, 421.6738016051602, 473.73193655344227, 292.2597372249279, 320.067820565389, 119.55724647894216, 351.51692137430854, 337.8113267812563, 427.2720607651295, 332.4363505777656, 239.61572249393726, 487.9749169218651, 288.4890063473964, 481.0492655433539, 429.2964196178175, 109.73954018888143, 200.72449964097177, 325.54771673497544, 431.43163715534774, 423.51730746956497, 510.18564131082815, 359.3725581243919, 297.8993822979914, 232.6831232744801, 394.6999765198372, 450.1778288386806, 338.20118823625216, 326.84066564240624, 309.8754766742815, 421.7625284067271, 483.26481098138487, 509.14760802004145, 382.77344838056075, 260.62368956291095, 587.858868615468, 401.56432028826504, 507.28145865547816, 292.2419480201541, 339.38114192319756, 136.7731275346161, 258.46760051647436, 366.3974972188473, 281.0682653793973, 363.97520347531986, 582.1301282282417, 515.6678702758336, 306.45922203123183, 107.67428374766644, 312.43008840367247, 530.380434876058, 479.79705029336566, 486.5994782747459, 337.3715576915121, 361.53495877076807, 3.4155724063513437, 368.69507448144776, 465.6817534830077, 179.21643023784247, 356.1259777831157, 243.71906249813037, 454.95634123217116, 341.2136189453962, 384.696322504317, 424.3971180346511, 296.1588522807098, 238.97572912247185, 327.9330151069863, 664.2821960567484, 420.430178268043, 173.56938479935354, 280.9945400390534, 534.2439368905401, 326.78745582832903, 424.87719407310266, 378.79013540014114, 324.8245798746447, 473.035199154278, 183.31446426210098, 486.8252798277365, 495.74646513528614, 356.13959166283695, 10.884088757086507, 354.3313630912627, 284.17830747432396, 637.0114248161282, 356.3449260033722, 337.615214547528, 307.00015344866307, 357.30700695842404, 320.65221577339025, 11.74664275016829, 302.0610036198647, 287.62318031976554, 303.7964445310317, 296.3219583977268, 12.165716381521854, 407.6263405100448, 493.4353895802925, 486.62323547074385, 430.62014587780595, 288.53962770218783, 340.7541608294485, 457.5424894005576, 367.84820014067924, 29.208203061945483, 357.0244514233041, 41.845840199790615, 595.1791873074116, 511.2852874084899, 295.36596732519064, 353.08683571683986, 262.34081938740735, 412.7958237917851, 399.7195841202542, 292.3035540244393, 376.52552763529, 533.9756733321933, 347.9926105321072, 360.11945741720984, 345.3410352176336, 264.03117471477753, 300.306106775828, 440.126386162847, 333.48616977049517, 262.50945581378346, 184.72845111637662, 458.4178420316593, 180.23608759340567, 493.0775238979333, 390.9474405900905, 354.0842605047832, 502.9240517711148, 375.06356819364106, 208.18909351197982, 617.9454889997894, 300.54542008842225, 409.79757427582774, 307.0888089712911, 471.0592390057554, 430.7800277590775, 349.33484834354914, 323.7306578183191, 136.88176460012164, 372.321499080986, 355.23856371807085, 144.12528513000584, 159.84371068862114, 322.7334016378019, 452.81237866208386, 234.3379244564028, 277.81636026795564, 306.19324630234905, 292.8113700435653, 336.4468658618183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 74.3593852097956, "mean_inference_ms": 63.758620215032245, "mean_action_processing_ms": 32.39527717644811, "mean_env_wait_ms": 19.372758402046212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033031702041625977, "StateBufferConnector_ms": 0.012284398078918457, "ViewRequirementAgentConnector_ms": 0.09733736515045166}, "num_episodes": 8, "episode_return_max": 519.6108606393143, "episode_return_min": -6.906990669770692, "episode_return_mean": 131.07085337788567, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3118144, "num_agent_steps_trained": 3118144, "num_env_steps_sampled": 779536, "num_env_steps_trained": 779536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 272.4711814318177, "num_env_steps_trained_throughput_per_sec": 272.4711814318177, "timesteps_total": 779536, "num_env_steps_sampled_lifetime": 779536, "num_agent_steps_sampled_lifetime": 3118144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3118144, "timers": {"training_iteration_time_ms": 29506.356, "restore_workers_time_ms": 0.026, "training_step_time_ms": 29505.841, "sample_time_ms": 1144.414, "learn_time_ms": 28328.655, "learn_throughput": 282.4, "synch_weights_time_ms": 28.068}, "counters": {"num_env_steps_sampled": 779536, "num_env_steps_trained": 779536, "num_agent_steps_sampled": 3118144, "num_agent_steps_trained": 3118144}, "done": false, "training_iteration": 97, "trial_id": "cdf01_00000", "date": "2024-08-20_13-56-31", "timestamp": 1724142391, "time_this_iter_s": 29.40339994430542, "time_total_s": 12627.57889342308, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52be820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12627.57889342308, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 25.353658536585368, "ram_util_percent": 83.0390243902439}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.523364333311717, "cur_kl_coeff": 1.5075366663778928e-23, "cur_lr": 0.0001, "total_loss": 8.806100562262158, "policy_loss": -0.0036596805973362827, "vf_loss": 8.809760252634684, "vf_explained_var": -0.3242620487061758, "kl": 0.0018379346858853386, "entropy": 0.11720880301935332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 61705.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.671475447927203, "cur_kl_coeff": 2.710505431213761e-21, "cur_lr": 0.0001, "total_loss": 8.736984631371877, "policy_loss": -0.005001497782382464, "vf_loss": 8.741986118801057, "vf_explained_var": 0.5035777318099188, "kl": 0.0044277485390026294, "entropy": 0.35751794798979686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 61705.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 787536, "num_env_steps_trained": 787536, "num_agent_steps_sampled": 3150144, "num_agent_steps_trained": 3150144}, "env_runners": {"episode_reward_max": 502.0081368295881, "episode_reward_min": -11.758406154374192, "episode_reward_mean": 122.84978654141597, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -693.3217786040534, "predator_policy": 10.71110454275037}, "policy_reward_max": {"prey_policy": 198.2748174589842, "predator_policy": 735.643991421594}, "policy_reward_mean": {"prey_policy": -291.32023190416794, "predator_policy": 352.74512517487585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-0.3642832946175629, 1.9984014443252818e-15, 92.17688898219434, 43.614236855424515, 25.465015262184867, 421.7010071345402, 187.14103904249345, 116.42393936530954, 136.7505556247027, 33.32035747891103, 55.972075681651546, 205.86745581436648, 224.54321857055143, 67.29962235060891, 93.69996095555729, 23.32905421772514, 2.220446049250313e-16, -5.112311043299625, 10.483950650141503, 102.62123116377859, 14.274776693770544, 314.849792086793, 145.81632262139846, 77.39933261653898, -6.906990669770692, 328.6335096826363, 406.0044526439757, 2.073164886182969, 307.3324517062492, 5.467086360224982, 279.5985865630586, 321.16838846408257, 228.57694708861393, 104.82360048278713, 100.22772984949538, 430.2413165415506, 58.879411614633554, 1.022176967227764, 189.0, 106.7984994906437, 450.6117424168084, 321.5112255672082, 115.80925604331786, 47.131992124510305, 226.90622445198554, 152.58339076418193, 493.0283545454212, 117.73088932981722, -0.03356207863338456, 197.33595659076192, 2.714983502250116, 0.19999999999999707, 0.21778951332165386, 76.85269161360748, 182.21951790361828, 123.88733380591468, 5.514677683873037, 39.032107786483486, 4.582086095210545, -8.504423367435813, 32.43382993937518, 27.394675125874933, 75.34837948216564, 187.01704644681868, 29.52245611509285, 6.661338147750939e-16, 194.33936099454365, 8.147011980803466, 15.344464616826482, 48.20470453533812, -1.6253386366893063, -11.758406154374192, 0.04454461416830813, 360.9420533412925, 173.39674682905607, 97.05583258984318, 241.65314657052033, 110.12334226162773, 488.8367447275268, 84.49540200570901, 76.62268345504225, 2.400000000000001, 23.176619162328485, 160.29627658276624, 331.2564374059762, 13.399630830516228, 92.98255690621895, 13.693305130638265, 119.78849214738642, 48.395435200641785, -3.3306690738754696e-15, 3.600000000000003, 156.0521114672237, 2.5, 4.699999999999996, -4.440892098500626e-16, 438.9568460133388, 332.18832082987194, 502.0081368295881, 2.500000000000002], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-354.12630215940266, -284.74765170080155, -637.0114248161282, -356.3449260033722, -146.85202033723004, -405.5864586767675, -149.8837721219147, -484.4612137544745, -272.4087951050518, -15.933836002796214, 150.95506982420918, -320.67368754046555, -296.3219583977268, 174.97532266097159, -484.91925363219264, -299.71853709283346, -221.9609986268966, -558.5318270969514, -244.4411109039132, -351.53232014881354, -313.22418896045207, -456.19442489913337, 176.45925275242104, -356.824451423304, 182.697378370761, -595.1791873074116, -199.16015104159473, -540.1914813414777, -208.1714072902331, -313.55628685845664, -412.4117695864771, -376.7745841078371, -292.3035540244393, -376.52552763529, -502.67278539199805, -384.4078095156026, -396.9076333688058, -298.0689086158951, -292.41482148415776, -169.30122884266976, -428.35160946907644, -330.9861697704946, 186.66276158870724, -319.0508764320741, -458.4178420316593, -34.4197649720073, -478.9247286364178, -327.700903235067, -366.9171281461571, -496.99817479951173, -256.96103449745664, 2.3418824744710562, 180.83532215981703, -693.3217786040534, -407.79757427582774, -307.01564408510814, -42.734584144305465, -551.7722309142788, -360.88972527843663, -306.7086945232058, 187.77623643769797, -417.38091355574625, -374.51515390916035, 196.31969352516646, -278.5382454059095, 24.5380801680993, -345.8185912555158, -236.50811138018358, -191.60432078337323, -292.177555937436, -366.66103420742263, 167.64411484358993, -435.4992956864894, -388.27793626240134, -360.8982920533153, -335.0472876750172, 178.28889545724962, -407.35601624851785, -135.90359981264643, -325.4139490885476, -402.44496981868764, 197.94688410282916, -366.19329428615, -0.019891398443897007, -588.0857443618639, -389.4074534332325, -351.2169672172171, -226.77263035406256, 198.2748174589842, -582.5332319643252, -258.8915362569809, -366.5816032660227, -417.72108514990214, 185.15676438571748, -172.56502882761788, -451.6404123476471, -386.66111168065754, -371.5522601708831, -141.39973843861927, -167.11667245188477, -411.25111835924594, -267.5330954040105, -376.19471763096266, -456.5808513139103, -425.3171460268645, -450.3390749105923, -380.1023302161146, -303.5043130059524, -371.64202330399615, -124.886514125873, -193.68268321027486, -649.4478372957045, -326.2983291435172, -410.8635115428128, -300.2437955203666, -416.5867169707327, -237.00619329484795, -410.2809432774613, -384.71857305400147, -340.51705826235235, -324.6256169082218, -294.66002511159513, -295.79951401490905, -282.366979590673, -155.43066194506216, -473.0336753086621, -123.20762498141767, -323.4491793347395, -387.1005348484473, -435.47110361762213, -314.7244996677927, -302.6462502294881, -45.47460162909397, -618.745568391585, -452.36472783964786, -270.13484842315984, -413.0745530803946, -416.940046152491, -375.57164402576205, -315.0453528161991, -327.09088126292755, -414.6101570339964, -484.7125123921986, -276.81271246703494, -672.8066106867152, -364.59727448317796, -305.3396451919907, 72.43325336052176, -513.4942986404845, -121.46651777785043, -442.9985656594356, -22.403466747404018, -376.6953834791632, -273.39353153480556, -139.8941091358275, -371.74344102099764, 193.74725336398117, -374.9675340991564, -318.5468229329571, -351.0574867439143, -410.9121695178586, -157.9919808884148, -395.43771653923415, -230.3986759332124, -440.73867254225706, -409.0820418834964, 89.77137861602094, -413.95881062199436, 39.77065812160667, -610.2219317301029, -391.2334477142273, -84.7608209810718, -267.6145243881309, -597.8573185585208, -261.48967240622983, -500.592722550375, -415.0147677502306, -138.899211738513, -465.1077721856204, -268.4091893660564, -335.66878120835634, -382.2932840043626, -332.3237852884825, -307.51259476774294, -480.1826645157805, -308.92273964688013, -370.1956113748817, -487.296308324506, -319.5200266091474, -306.94553061355185, -316.15120536139636, -333.13071568326984, -305.5756511563772, 180.49917378692916, -284.9724202990289, 172.41386600095063, -557.2940505579928, 182.39887408924056, -260.9372085593666, -356.6958097262806], "policy_predator_policy_reward": [354.3313630912627, 284.17830747432396, 637.0114248161282, 356.3449260033722, 337.615214547528, 307.00015344866307, 357.30700695842404, 320.65221577339025, 11.74664275016829, 302.0610036198647, 287.62318031976554, 303.7964445310317, 296.3219583977268, 12.165716381521854, 407.6263405100448, 493.4353895802925, 486.62323547074385, 430.62014587780595, 288.53962770218783, 340.7541608294485, 457.5424894005576, 367.84820014067924, 29.208203061945483, 357.0244514233041, 41.845840199790615, 595.1791873074116, 511.2852874084899, 295.36596732519064, 353.08683571683986, 262.34081938740735, 412.7958237917851, 399.7195841202542, 292.3035540244393, 376.52552763529, 533.9756733321933, 347.9926105321072, 360.11945741720984, 345.3410352176336, 264.03117471477753, 300.306106775828, 440.126386162847, 333.48616977049517, 262.50945581378346, 184.72845111637662, 458.4178420316593, 180.23608759340567, 493.0775238979333, 390.9474405900905, 354.0842605047832, 502.9240517711148, 375.06356819364106, 208.18909351197982, 617.9454889997894, 300.54542008842225, 409.79757427582774, 307.0888089712911, 471.0592390057554, 430.7800277590775, 349.33484834354914, 323.7306578183191, 136.88176460012164, 372.321499080986, 355.23856371807085, 144.12528513000584, 159.84371068862114, 322.7334016378019, 452.81237866208386, 234.3379244564028, 277.81636026795564, 306.19324630234905, 292.8113700435653, 336.4468658618183, 393.60894726103703, 489.04769630248677, 361.94652843501376, 335.0212282605465, 10.71110454275037, 407.35601624851785, 242.9739663304373, 325.14208206140046, 389.5620227403498, 265.5478053923173, 323.0378002870328, 364.6866109647691, 465.90359810398314, 627.3988557344329, 349.7365411318737, 275.38504856391614, 28.756660154005235, 582.4079788033213, 401.5191247842487, 376.53740550293656, 393.2517530958968, 332.34092221370855, 344.3394807473721, 397.5968497577102, 386.66111168065754, 371.5186980922498, 386.1883770405523, 119.66399044071353, 407.1029641608627, 274.39623310464435, 376.39471763096265, 456.5808513139103, 413.02697550541853, 462.84703494535984, 489.8921302454449, 270.5672045902302, 294.3941880520864, 384.35386728140094, 489.8238494960164, 477.1940048158784, 430.76627965672066, 311.910238713483, 354.47268352279553, 401.38993675478935, 242.11760495572872, 409.7516177117908, 347.12779130398167, 369.60341664493603, 328.17543650717795, 323.5440354520152, 298.0238823826959, 307.5372863487624, 255.35237946386462, 448.4603372720254, 333.5359295669505, 300.1379211960275, 401.4903209028253, 450.60377367833775, 314.7244996677927, 302.6462502294881, 735.643991421594, 122.91553959362857, 452.36472783964786, 278.2818604039633, 390.7753057255265, 454.583758124184, 327.6685159841831, 411.153185393117, 319.50671834167946, 420.5689813185551, 395.687599283477, 354.07921942138034, 672.8066106867152, 364.64181909734623, 224.47153299627814, 369.3769121764839, 332.18135460069783, 476.1762086466931, 162.885832634055, 399.572032362629, 539.3324051546202, 352.4096564298716, 277.8876053907534, 343.8732870276985, 344.17854434831065, 325.8784811143907, 399.78256849896763, 354.3171431836134, 402.3377578577585, 243.18907600355712, 395.5377165392341, 232.6986759332124, 426.8789594899217, 446.1183740981586, 468.65884159577536, 15.82486699296422, 455.28589414136036, 446.4218168731112, 73.6041924323316, 415.78970709348283, 380.1214254716782, 578.3329743811931, 273.4722855841738, 502.30341450306884, 329.0512812370992, 344.65119039903084, 436.4109429384179, 345.50145381389825, 335.66878120835634, 382.2932840043626, 332.92378528848263, 310.5125947677427, 459.8093289096414, 485.34818672024477, 372.6956113748823, 487.296308324506, 319.5200266091474, 311.64553061355167, 316.15120536139636, 333.13071568326984, 290.64996375764844, 273.38335962513725, 278.8373122910685, 165.90956283688115, 478.6057156927642, 398.29759760557465, 262.43720855936647, 357.6958097262808]}, "sampler_perf": {"mean_raw_obs_processing_ms": 73.3925886329604, "mean_inference_ms": 62.92714787834827, "mean_action_processing_ms": 32.22186478025103, "mean_env_wait_ms": 19.119357189625006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038224458694458008, "StateBufferConnector_ms": 0.015421152114868164, "ViewRequirementAgentConnector_ms": 0.09682834148406982}, "num_episodes": 64, "episode_return_max": 502.0081368295881, "episode_return_min": -11.758406154374192, "episode_return_mean": 122.84978654141597, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3150144, "num_agent_steps_trained": 3150144, "num_env_steps_sampled": 787536, "num_env_steps_trained": 787536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 230.87740568971373, "num_env_steps_trained_throughput_per_sec": 230.87740568971373, "timesteps_total": 787536, "num_env_steps_sampled_lifetime": 787536, "num_agent_steps_sampled_lifetime": 3150144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3150144, "timers": {"training_iteration_time_ms": 30035.157, "restore_workers_time_ms": 0.028, "training_step_time_ms": 30034.688, "sample_time_ms": 1662.051, "learn_time_ms": 28342.754, "learn_throughput": 282.259, "synch_weights_time_ms": 25.391}, "counters": {"num_env_steps_sampled": 787536, "num_env_steps_trained": 787536, "num_agent_steps_sampled": 3150144, "num_agent_steps_trained": 3150144}, "done": false, "training_iteration": 98, "trial_id": "cdf01_00000", "date": "2024-08-20_13-57-06", "timestamp": 1724142426, "time_this_iter_s": 34.70398497581482, "time_total_s": 12662.282878398895, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a5326c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12662.282878398895, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 25.708163265306123, "ram_util_percent": 83.32040816326531}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.62019925155337, "cur_kl_coeff": 7.537683331889464e-24, "cur_lr": 0.0001, "total_loss": 9.013671883325728, "policy_loss": -0.004247597259809337, "vf_loss": 9.017919495749096, "vf_explained_var": -0.4900244466842167, "kl": 0.0028199573863432136, "entropy": 0.11996873545031699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 62335.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.026321500823611, "cur_kl_coeff": 1.3552527156068804e-21, "cur_lr": 0.0001, "total_loss": 9.080243955339704, "policy_loss": -0.004427764362966021, "vf_loss": 9.084671718355208, "vf_explained_var": 0.3727990235601153, "kl": 0.003459733511247231, "entropy": 0.3017841439161982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 62335.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 795536, "num_env_steps_trained": 795536, "num_agent_steps_sampled": 3182144, "num_agent_steps_trained": 3182144}, "env_runners": {"episode_reward_max": 502.0081368295881, "episode_reward_min": -11.758406154374192, "episode_reward_mean": 125.81980872079886, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -693.3217786040534, "predator_policy": 10.71110454275037}, "policy_reward_max": {"prey_policy": 198.2748174589842, "predator_policy": 735.643991421594}, "policy_reward_mean": {"prey_policy": -291.910292952644, "predator_policy": 354.8201973130435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [136.7505556247027, 33.32035747891103, 55.972075681651546, 205.86745581436648, 224.54321857055143, 67.29962235060891, 93.69996095555729, 23.32905421772514, 2.220446049250313e-16, -5.112311043299625, 10.483950650141503, 102.62123116377859, 14.274776693770544, 314.849792086793, 145.81632262139846, 77.39933261653898, -6.906990669770692, 328.6335096826363, 406.0044526439757, 2.073164886182969, 307.3324517062492, 5.467086360224982, 279.5985865630586, 321.16838846408257, 228.57694708861393, 104.82360048278713, 100.22772984949538, 430.2413165415506, 58.879411614633554, 1.022176967227764, 189.0, 106.7984994906437, 450.6117424168084, 321.5112255672082, 115.80925604331786, 47.131992124510305, 226.90622445198554, 152.58339076418193, 493.0283545454212, 117.73088932981722, -0.03356207863338456, 197.33595659076192, 2.714983502250116, 0.19999999999999707, 0.21778951332165386, 76.85269161360748, 182.21951790361828, 123.88733380591468, 5.514677683873037, 39.032107786483486, 4.582086095210545, -8.504423367435813, 32.43382993937518, 27.394675125874933, 75.34837948216564, 187.01704644681868, 29.52245611509285, 6.661338147750939e-16, 194.33936099454365, 8.147011980803466, 15.344464616826482, 48.20470453533812, -1.6253386366893063, -11.758406154374192, 0.04454461416830813, 360.9420533412925, 173.39674682905607, 97.05583258984318, 241.65314657052033, 110.12334226162773, 488.8367447275268, 84.49540200570901, 76.62268345504225, 2.400000000000001, 23.176619162328485, 160.29627658276624, 331.2564374059762, 13.399630830516228, 92.98255690621895, 13.693305130638265, 119.78849214738642, 48.395435200641785, -3.3306690738754696e-15, 3.600000000000003, 156.0521114672237, 2.5, 4.699999999999996, -4.440892098500626e-16, 438.9568460133388, 332.18832082987194, 502.0081368295881, 2.500000000000002, 30.580311163900355, 452.9967411543098, 102.70475317490106, 2.3000000000000007, 400.67613278566904, 0.46698719771687336, 8.33519523526791, 185.099940574055], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-221.9609986268966, -558.5318270969514, -244.4411109039132, -351.53232014881354, -313.22418896045207, -456.19442489913337, 176.45925275242104, -356.824451423304, 182.697378370761, -595.1791873074116, -199.16015104159473, -540.1914813414777, -208.1714072902331, -313.55628685845664, -412.4117695864771, -376.7745841078371, -292.3035540244393, -376.52552763529, -502.67278539199805, -384.4078095156026, -396.9076333688058, -298.0689086158951, -292.41482148415776, -169.30122884266976, -428.35160946907644, -330.9861697704946, 186.66276158870724, -319.0508764320741, -458.4178420316593, -34.4197649720073, -478.9247286364178, -327.700903235067, -366.9171281461571, -496.99817479951173, -256.96103449745664, 2.3418824744710562, 180.83532215981703, -693.3217786040534, -407.79757427582774, -307.01564408510814, -42.734584144305465, -551.7722309142788, -360.88972527843663, -306.7086945232058, 187.77623643769797, -417.38091355574625, -374.51515390916035, 196.31969352516646, -278.5382454059095, 24.5380801680993, -345.8185912555158, -236.50811138018358, -191.60432078337323, -292.177555937436, -366.66103420742263, 167.64411484358993, -435.4992956864894, -388.27793626240134, -360.8982920533153, -335.0472876750172, 178.28889545724962, -407.35601624851785, -135.90359981264643, -325.4139490885476, -402.44496981868764, 197.94688410282916, -366.19329428615, -0.019891398443897007, -588.0857443618639, -389.4074534332325, -351.2169672172171, -226.77263035406256, 198.2748174589842, -582.5332319643252, -258.8915362569809, -366.5816032660227, -417.72108514990214, 185.15676438571748, -172.56502882761788, -451.6404123476471, -386.66111168065754, -371.5522601708831, -141.39973843861927, -167.11667245188477, -411.25111835924594, -267.5330954040105, -376.19471763096266, -456.5808513139103, -425.3171460268645, -450.3390749105923, -380.1023302161146, -303.5043130059524, -371.64202330399615, -124.886514125873, -193.68268321027486, -649.4478372957045, -326.2983291435172, -410.8635115428128, -300.2437955203666, -416.5867169707327, -237.00619329484795, -410.2809432774613, -384.71857305400147, -340.51705826235235, -324.6256169082218, -294.66002511159513, -295.79951401490905, -282.366979590673, -155.43066194506216, -473.0336753086621, -123.20762498141767, -323.4491793347395, -387.1005348484473, -435.47110361762213, -314.7244996677927, -302.6462502294881, -45.47460162909397, -618.745568391585, -452.36472783964786, -270.13484842315984, -413.0745530803946, -416.940046152491, -375.57164402576205, -315.0453528161991, -327.09088126292755, -414.6101570339964, -484.7125123921986, -276.81271246703494, -672.8066106867152, -364.59727448317796, -305.3396451919907, 72.43325336052176, -513.4942986404845, -121.46651777785043, -442.9985656594356, -22.403466747404018, -376.6953834791632, -273.39353153480556, -139.8941091358275, -371.74344102099764, 193.74725336398117, -374.9675340991564, -318.5468229329571, -351.0574867439143, -410.9121695178586, -157.9919808884148, -395.43771653923415, -230.3986759332124, -440.73867254225706, -409.0820418834964, 89.77137861602094, -413.95881062199436, 39.77065812160667, -610.2219317301029, -391.2334477142273, -84.7608209810718, -267.6145243881309, -597.8573185585208, -261.48967240622983, -500.592722550375, -415.0147677502306, -138.899211738513, -465.1077721856204, -268.4091893660564, -335.66878120835634, -382.2932840043626, -332.3237852884825, -307.51259476774294, -480.1826645157805, -308.92273964688013, -370.1956113748817, -487.296308324506, -319.5200266091474, -306.94553061355185, -316.15120536139636, -333.13071568326984, -305.5756511563772, 180.49917378692916, -284.9724202990289, 172.41386600095063, -557.2940505579928, 182.39887408924056, -260.9372085593666, -356.6958097262806, -392.9801527813173, -267.5715052966646, -653.5717043388127, 192.6896023621905, -167.86324439750075, -469.9121914328343, -322.43112721439934, -439.1113592824507, 178.55989289872267, -366.8939635948481, -384.9516508606291, -329.62961121041303, -43.49733720021059, -288.2277886401396, -191.45406559973895, -354.2254479621435], "policy_predator_policy_reward": [486.62323547074385, 430.62014587780595, 288.53962770218783, 340.7541608294485, 457.5424894005576, 367.84820014067924, 29.208203061945483, 357.0244514233041, 41.845840199790615, 595.1791873074116, 511.2852874084899, 295.36596732519064, 353.08683571683986, 262.34081938740735, 412.7958237917851, 399.7195841202542, 292.3035540244393, 376.52552763529, 533.9756733321933, 347.9926105321072, 360.11945741720984, 345.3410352176336, 264.03117471477753, 300.306106775828, 440.126386162847, 333.48616977049517, 262.50945581378346, 184.72845111637662, 458.4178420316593, 180.23608759340567, 493.0775238979333, 390.9474405900905, 354.0842605047832, 502.9240517711148, 375.06356819364106, 208.18909351197982, 617.9454889997894, 300.54542008842225, 409.79757427582774, 307.0888089712911, 471.0592390057554, 430.7800277590775, 349.33484834354914, 323.7306578183191, 136.88176460012164, 372.321499080986, 355.23856371807085, 144.12528513000584, 159.84371068862114, 322.7334016378019, 452.81237866208386, 234.3379244564028, 277.81636026795564, 306.19324630234905, 292.8113700435653, 336.4468658618183, 393.60894726103703, 489.04769630248677, 361.94652843501376, 335.0212282605465, 10.71110454275037, 407.35601624851785, 242.9739663304373, 325.14208206140046, 389.5620227403498, 265.5478053923173, 323.0378002870328, 364.6866109647691, 465.90359810398314, 627.3988557344329, 349.7365411318737, 275.38504856391614, 28.756660154005235, 582.4079788033213, 401.5191247842487, 376.53740550293656, 393.2517530958968, 332.34092221370855, 344.3394807473721, 397.5968497577102, 386.66111168065754, 371.5186980922498, 386.1883770405523, 119.66399044071353, 407.1029641608627, 274.39623310464435, 376.39471763096265, 456.5808513139103, 413.02697550541853, 462.84703494535984, 489.8921302454449, 270.5672045902302, 294.3941880520864, 384.35386728140094, 489.8238494960164, 477.1940048158784, 430.76627965672066, 311.910238713483, 354.47268352279553, 401.38993675478935, 242.11760495572872, 409.7516177117908, 347.12779130398167, 369.60341664493603, 328.17543650717795, 323.5440354520152, 298.0238823826959, 307.5372863487624, 255.35237946386462, 448.4603372720254, 333.5359295669505, 300.1379211960275, 401.4903209028253, 450.60377367833775, 314.7244996677927, 302.6462502294881, 735.643991421594, 122.91553959362857, 452.36472783964786, 278.2818604039633, 390.7753057255265, 454.583758124184, 327.6685159841831, 411.153185393117, 319.50671834167946, 420.5689813185551, 395.687599283477, 354.07921942138034, 672.8066106867152, 364.64181909734623, 224.47153299627814, 369.3769121764839, 332.18135460069783, 476.1762086466931, 162.885832634055, 399.572032362629, 539.3324051546202, 352.4096564298716, 277.8876053907534, 343.8732870276985, 344.17854434831065, 325.8784811143907, 399.78256849896763, 354.3171431836134, 402.3377578577585, 243.18907600355712, 395.5377165392341, 232.6986759332124, 426.8789594899217, 446.1183740981586, 468.65884159577536, 15.82486699296422, 455.28589414136036, 446.4218168731112, 73.6041924323316, 415.78970709348283, 380.1214254716782, 578.3329743811931, 273.4722855841738, 502.30341450306884, 329.0512812370992, 344.65119039903084, 436.4109429384179, 345.50145381389825, 335.66878120835634, 382.2932840043626, 332.92378528848263, 310.5125947677427, 459.8093289096414, 485.34818672024477, 372.6956113748823, 487.296308324506, 319.5200266091474, 311.64553061355167, 316.15120536139636, 333.13071568326984, 290.64996375764844, 273.38335962513725, 278.8373122910685, 165.90956283688115, 478.6057156927642, 398.29759760557465, 262.43720855936647, 357.6958097262808, 276.015985678469, 415.11598356341455, 575.4429679768712, 338.43587515406006, 308.4134206603732, 432.0667683448627, 324.7311272143994, 439.1113592824507, 239.66442967658747, 349.34577380520676, 384.9516508606291, 330.09659840812986, 69.60475296197099, 270.45556811364736, 410.838491577378, 319.9409625585588]}, "sampler_perf": {"mean_raw_obs_processing_ms": 73.41928961146847, "mean_inference_ms": 63.01525302813821, "mean_action_processing_ms": 32.11941214603744, "mean_env_wait_ms": 18.998099532448045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003907322883605957, "StateBufferConnector_ms": 0.015267372131347656, "ViewRequirementAgentConnector_ms": 0.09632766246795654}, "num_episodes": 8, "episode_return_max": 502.0081368295881, "episode_return_min": -11.758406154374192, "episode_return_mean": 125.81980872079886, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3182144, "num_agent_steps_trained": 3182144, "num_env_steps_sampled": 795536, "num_env_steps_trained": 795536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 263.6797367065129, "num_env_steps_trained_throughput_per_sec": 263.6797367065129, "timesteps_total": 795536, "num_env_steps_sampled_lifetime": 795536, "num_agent_steps_sampled_lifetime": 3182144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3182144, "timers": {"training_iteration_time_ms": 30098.677, "restore_workers_time_ms": 0.026, "training_step_time_ms": 30098.182, "sample_time_ms": 1760.525, "learn_time_ms": 28310.209, "learn_throughput": 282.584, "synch_weights_time_ms": 23.134}, "counters": {"num_env_steps_sampled": 795536, "num_env_steps_trained": 795536, "num_agent_steps_sampled": 3182144, "num_agent_steps_trained": 3182144}, "done": false, "training_iteration": 99, "trial_id": "cdf01_00000", "date": "2024-08-20_13-57-36", "timestamp": 1724142456, "time_this_iter_s": 30.37676501274109, "time_total_s": 12692.659643411636, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a528edc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12692.659643411636, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 25.888372093023257, "ram_util_percent": 83.24418604651162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.498179122190626, "cur_kl_coeff": 3.768841665944732e-24, "cur_lr": 0.0001, "total_loss": Infinity, "policy_loss": -0.003948343383325707, "vf_loss": 8.715872204492962, "vf_explained_var": -0.22824655913171313, "kl": Infinity, "entropy": 0.1205095646873353, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 62965.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.035429897005596, "cur_kl_coeff": 6.776263578034402e-22, "cur_lr": 0.0001, "total_loss": 8.447229912924389, "policy_loss": -0.004542939364540553, "vf_loss": 8.451772820003448, "vf_explained_var": 0.4997647566454751, "kl": 0.004575965141831393, "entropy": 0.35930735095152777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 253.96825396825398, "num_grad_updates_lifetime": 62965.5, "diff_num_grad_updates_vs_sampler_policy": 314.5}}, "num_env_steps_sampled": 803536, "num_env_steps_trained": 803536, "num_agent_steps_sampled": 3214144, "num_agent_steps_trained": 3214144}, "env_runners": {"episode_reward_max": 505.27078684439124, "episode_reward_min": -51.37002795533889, "episode_reward_mean": 120.55130933084878, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -680.0165748969921, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 672.8066106867152}, "policy_reward_mean": {"prey_policy": -304.43666012031434, "predator_policy": 364.7123147857387}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.04454461416830813, 360.9420533412925, 173.39674682905607, 97.05583258984318, 241.65314657052033, 110.12334226162773, 488.8367447275268, 84.49540200570901, 76.62268345504225, 2.400000000000001, 23.176619162328485, 160.29627658276624, 331.2564374059762, 13.399630830516228, 92.98255690621895, 13.693305130638265, 119.78849214738642, 48.395435200641785, -3.3306690738754696e-15, 3.600000000000003, 156.0521114672237, 2.5, 4.699999999999996, -4.440892098500626e-16, 438.9568460133388, 332.18832082987194, 502.0081368295881, 2.500000000000002, 30.580311163900355, 452.9967411543098, 102.70475317490106, 2.3000000000000007, 400.67613278566904, 0.46698719771687336, 8.33519523526791, 185.099940574055, -0.5090786154711435, 264.90665283572025, 235.26919226231135, 15.42010226561673, 53.458022917864085, 5.272926462350634, 162.89512047366904, 173.9676363668485, 151.87023828960855, 94.8127306852305, 204.93261326822724, 96.76259635642106, 2.4424906541753444e-15, 173.733832336264, 89.46102027982575, 115.16619416013259, 1.7651897305928763, 46.60698797976721, 203.20651246854553, 74.77220598901616, 26.164450875550642, -1.751800173173301, 236.3354710317128, 170.78297310294238, 171.9000886911718, 117.29316207692848, 60.617301939110774, 44.450931550565734, -1.028322723421948, 84.33028308080583, 34.012875620746, 104.15737233826155, -15.026019100214135, 278.48618580061105, 59.890604929106026, 239.4503477276103, 78.13107921436101, 298.4881073526684, 26.346617940589745, 150.74412419947916, 164.04737158655533, 70.91160088679682, 505.27078684439124, 213.74757660179023, 36.8638082321029, 6.091009339470462, 411.5458834964577, 89.42123763647156, -1.3322676295501878e-15, 152.28491436296775, 259.9238911288005, 21.10000000000003, 187.30461639073624, 5.523108006561037, 107.17335918482955, 4.5, 0.09999999999999964, 42.68117991724787, -51.37002795533889, 202.04114296030443, 62.15036412350493, 6.918438922692896, 5.872974451791844, 159.2564387916901], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-672.8066106867152, -364.59727448317796, -305.3396451919907, 72.43325336052176, -513.4942986404845, -121.46651777785043, -442.9985656594356, -22.403466747404018, -376.6953834791632, -273.39353153480556, -139.8941091358275, -371.74344102099764, 193.74725336398117, -374.9675340991564, -318.5468229329571, -351.0574867439143, -410.9121695178586, -157.9919808884148, -395.43771653923415, -230.3986759332124, -440.73867254225706, -409.0820418834964, 89.77137861602094, -413.95881062199436, 39.77065812160667, -610.2219317301029, -391.2334477142273, -84.7608209810718, -267.6145243881309, -597.8573185585208, -261.48967240622983, -500.592722550375, -415.0147677502306, -138.899211738513, -465.1077721856204, -268.4091893660564, -335.66878120835634, -382.2932840043626, -332.3237852884825, -307.51259476774294, -480.1826645157805, -308.92273964688013, -370.1956113748817, -487.296308324506, -319.5200266091474, -306.94553061355185, -316.15120536139636, -333.13071568326984, -305.5756511563772, 180.49917378692916, -284.9724202990289, 172.41386600095063, -557.2940505579928, 182.39887408924056, -260.9372085593666, -356.6958097262806, -392.9801527813173, -267.5715052966646, -653.5717043388127, 192.6896023621905, -167.86324439750075, -469.9121914328343, -322.43112721439934, -439.1113592824507, 178.55989289872267, -366.8939635948481, -384.9516508606291, -329.62961121041303, -43.49733720021059, -288.2277886401396, -191.45406559973895, -354.2254479621435, -332.64430713082663, -548.5747129483331, -345.38279245559306, -28.507101654053443, -14.664465646000515, -347.9685129191264, -331.45395392286594, -380.86876694402633, -346.7704229787899, -358.1349432492553, -371.09574295051397, -418.1717228495019, -186.19907415243023, -306.6762436130253, -538.1954049196391, -348.16236595124934, -148.73374598487413, -369.511287819659, -549.7841933854202, -238.5578269469534, -327.12502572055143, 200.0, -457.01075780156276, -257.74834549701944, -332.5823171045956, -391.78371183591054, -164.21064102843948, -385.45928410939587, -680.0165748969921, -92.14669041821473, -247.55984653795323, -362.20451689822363, -494.2478907941948, -466.6943489966695, -354.1656702508853, -241.5961878040307, -383.6120711228846, -193.01859435053467, -201.1415627785258, -395.6976410595382, -312.4505639419815, -339.75955882223377, -395.41308134913606, -407.08411967966805, -430.39072908399277, 44.89753552816698, -426.22818468463606, -249.84267333344746, -438.79223443854727, -183.2478648977209, -272.33030324216566, -425.2641355441804, -464.6214417648919, -384.71716024389525, -401.953882674272, -312.3816708319437, -488.65913931114267, -371.4092858873478, -128.13708797835065, -357.1122127392524, -184.8521883938013, -278.13571196916104, -264.9027681720324, -518.2642333654915, -328.9971087304632, -453.0322444637633, -108.42001104727666, -458.48260363579794, -362.2015300089159, -413.9454517351059, -187.18718975488252, -492.32983794430635, -173.79041552752096, -331.67285845302496, -576.9530394072831, -80.67796093576796, -336.31132728083, -296.9528191417962, -592.0510835943844, -178.88583125969726, -495.5343452604909, -113.77569334263605, -227.68061020579768, -223.78289104100236, -529.3807131953764, 157.35670037565882, -369.8122544139182, -123.83865611833332, -375.93629946017353, -344.3945712555668, -336.37218235939616, -322.9940435420055, 150.25873002454762, -552.7227177985104, -269.6538915194186, -344.965435764269, -406.30445535839215, -556.3873660943219, -229.02419767622126, -446.72144088918554, -420.52840052517604, 200.0, -297.0727487143734, 20.000000000000014, -157.54316344797223, -364.2310866833912, -340.020446145609, -371.5143862883961, -554.1528785299629, -227.35200358770408, -357.16575694431435, -273.4992567418788, -431.75475897762385, -305.144868325792, -437.7243520060649, -196.56014039321377, -500.2993846099588, -325.860764301748, 196.8981683576448, -453.64625287948735, -146.68991580488822, -305.5409736928476, -412.1908830013659, -452.0032667028467, -339.0798524000867, -343.18519089971926, -279.8614773532409, -424.13665105907035], "policy_predator_policy_reward": [672.8066106867152, 364.64181909734623, 224.47153299627814, 369.3769121764839, 332.18135460069783, 476.1762086466931, 162.885832634055, 399.572032362629, 539.3324051546202, 352.4096564298716, 277.8876053907534, 343.8732870276985, 344.17854434831065, 325.8784811143907, 399.78256849896763, 354.3171431836134, 402.3377578577585, 243.18907600355712, 395.5377165392341, 232.6986759332124, 426.8789594899217, 446.1183740981586, 468.65884159577536, 15.82486699296422, 455.28589414136036, 446.4218168731112, 73.6041924323316, 415.78970709348283, 380.1214254716782, 578.3329743811931, 273.4722855841738, 502.30341450306884, 329.0512812370992, 344.65119039903084, 436.4109429384179, 345.50145381389825, 335.66878120835634, 382.2932840043626, 332.92378528848263, 310.5125947677427, 459.8093289096414, 485.34818672024477, 372.6956113748823, 487.296308324506, 319.5200266091474, 311.64553061355167, 316.15120536139636, 333.13071568326984, 290.64996375764844, 273.38335962513725, 278.8373122910685, 165.90956283688115, 478.6057156927642, 398.29759760557465, 262.43720855936647, 357.6958097262808, 276.015985678469, 415.11598356341455, 575.4429679768712, 338.43587515406006, 308.4134206603732, 432.0667683448627, 324.7311272143994, 439.1113592824507, 239.66442967658747, 349.34577380520676, 384.9516508606291, 330.09659840812986, 69.60475296197099, 270.45556811364736, 410.838491577378, 319.9409625585588, 332.1394956653556, 548.5704457983334, 301.44279413262234, 337.3537528127456, 337.34010575316194, 260.5620650742782, 346.72969183782556, 381.0131312946835, 364.34382039032624, 394.0195687555838, 372.36866941286456, 422.1717228495019, 315.6265996722699, 340.143838566855, 499.72044561497535, 560.6049616227634, 325.910868890565, 344.20440320357676, 535.4444527364358, 347.71029828116787, 211.89227479309523, 120.165364195684, 355.92071120878234, 455.60098844622087, 332.5823171045956, 391.78371183591054, 369.5973948781359, 353.8063625959644, 378.5598734278243, 483.06441216720975, 388.5117609376986, 336.4187966586111, 496.01308052478765, 466.6943489966695, 348.70127367564044, 293.6675723590415, 380.4057330591443, 399.43144488281916, 387.39968257730203, 284.2117272497778, 328.55379030238515, 349.82078333738036, 393.433716246244, 407.31168460938676, 193.21968758699705, 428.6089770005414, 410.1421437230444, 436.711687397982, 404.09206199628227, 389.848126031157, 399.9829747508641, 414.9046261124103, 397.38599351558537, 512.5699104323138, 398.9148778860392, 359.8716071707429, 467.3804666409685, 391.6596358341, 339.1136565245962, 230.4659272738127, 218.6960588389549, 278.3047171447529, 491.9323140619286, 395.39205981385936, 328.9971087304632, 438.0062253635495, 409.2640226615435, 436.12477782214074, 384.1612419465851, 451.87634472654224, 398.6945687136815, 520.2728067131178, 259.53534077403253, 324.05901242087583, 455.23539513363596, 500.88371256208416, 383.16004770373934, 276.4507166594765, 440.173435569073, 481.5076034844872, 425.80975397241264, 347.54765621726847, 253.9068726070625, 268.4682295265336, 462.844339247893, 414.45046041621583, 361.7050254871437, 345.6934616468991, 377.8353699268597, 379.3593090209834, 336.37218235939616, 329.08505288147717, 414.4322334410002, 399.57763782941976, 383.96958839759196, 320.07097652256766, 406.30445535839215, 556.3873660943219, 426.4497660577297, 401.58078687064466, 408.9311729647659, 71.52111868921087, 298.1727487143734, 0.0, 342.78656801198315, 366.29229851011627, 345.402936627832, 371.65500381273404, 537.2303666993922, 351.4478746031053, 357.2657569443144, 277.89925674187873, 431.75475897762385, 305.244868325792, 435.8751611320982, 241.09051118442738, 289.69867186935437, 485.09144908701353, 453.7462528794874, 5.042974602659662, 124.7142762575136, 389.6669773637277, 419.10932192405915, 452.0032667028467, 356.01460976784347, 332.1234079837546, 497.34733658754527, 365.90723061645537]}, "sampler_perf": {"mean_raw_obs_processing_ms": 72.16773710729065, "mean_inference_ms": 61.87114137773168, "mean_action_processing_ms": 31.798856320313927, "mean_env_wait_ms": 18.79960494143395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004220247268676758, "StateBufferConnector_ms": 0.014155030250549316, "ViewRequirementAgentConnector_ms": 0.09319508075714111}, "num_episodes": 64, "episode_return_max": 505.27078684439124, "episode_return_min": -51.37002795533889, "episode_return_mean": 120.55130933084878, "episodes_this_iter": 64}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3214144, "num_agent_steps_trained": 3214144, "num_env_steps_sampled": 803536, "num_env_steps_trained": 803536, "num_env_steps_sampled_this_iter": 8000, "num_env_steps_trained_this_iter": 8000, "num_env_steps_sampled_throughput_per_sec": 269.21048282848915, "num_env_steps_trained_throughput_per_sec": 269.21048282848915, "timesteps_total": 803536, "num_env_steps_sampled_lifetime": 803536, "num_agent_steps_sampled_lifetime": 3214144, "num_steps_trained_this_iter": 8000, "agent_timesteps_total": 3214144, "timers": {"training_iteration_time_ms": 30075.553, "restore_workers_time_ms": 0.026, "training_step_time_ms": 30074.999, "sample_time_ms": 1760.17, "learn_time_ms": 28286.709, "learn_throughput": 282.818, "synch_weights_time_ms": 23.659}, "counters": {"num_env_steps_sampled": 803536, "num_env_steps_trained": 803536, "num_agent_steps_sampled": 3214144, "num_agent_steps_trained": 3214144}, "done": true, "training_iteration": 100, "trial_id": "cdf01_00000", "date": "2024-08-20_13-58-06", "timestamp": 1724142486, "time_this_iter_s": 29.753541231155396, "time_total_s": 12722.413184642792, "pid": 15552, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "prey_view_size": 10, "predator_view_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 8, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 8000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3a52be8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 256, "mini_batch_size_per_learner": null, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12722.413184642792, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 26.826190476190476, "ram_util_percent": 83.17857142857144}}
