{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2680389335999886, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8694970733904963, "policy_loss": -0.0011254726194594273, "vf_loss": 3.8701718064212294, "vf_explained_var": 0.0006801144786612697, "kl": 0.002253755024783115, "entropy": 1.6072411494911032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.27666600860221674, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.752809577265745, "policy_loss": -0.0009909794885152705, "vf_loss": 6.753429544791974, "vf_explained_var": 0.008462195547800215, "kl": 0.0018549810584314501, "entropy": 1.6076415782883053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 178.0, "episode_reward_min": -109.0, "episode_reward_mean": 34.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -184.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.0, "predator_policy": 133.0}, "policy_reward_mean": {"prey_policy": -8.055555555555555, "predator_policy": 25.305555555555557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 73.0, 156.0, 91.0, 66.0, 17.0, -7.0, 33.0, 0.0, 95.0, 124.0, -77.0, 7.0, -33.0, -28.0, -11.0, -109.0, 178.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [48.0, -6.0, 2.0, -6.0, 14.0, 71.0, 0.0, 63.0, -94.0, 86.0, 43.0, -53.0, 75.0, -177.0, 95.0, -124.0, 0.0, 0.0, -62.0, 88.0, 103.0, 17.0, -26.0, -184.0, 6.0, 1.0, -8.0, -72.0, 0.0, -69.0, 53.0, -136.0, -118.0, -98.0, 0.0, 178.0], "policy_predator_policy_reward": [4.0, 0.0, 15.0, 62.0, 33.0, 38.0, 24.0, 4.0, 55.0, 19.0, 0.0, 27.0, 89.0, 6.0, 3.0, 59.0, 0.0, 0.0, 69.0, 0.0, 3.0, 1.0, 133.0, 0.0, 0.0, 0.0, 5.0, 42.0, 41.0, 0.0, 67.0, 5.0, 37.0, 70.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5853243937467572, "mean_inference_ms": 4.589153644050523, "mean_action_processing_ms": 0.6956461413282528, "mean_env_wait_ms": 0.6396149299345534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04130668110317654, "StateBufferConnector_ms": 0.14617376857333714, "ViewRequirementAgentConnector_ms": 0.3900759749942356}, "num_episodes": 18, "episode_return_max": 178.0, "episode_return_min": -109.0, "episode_return_mean": 34.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.8445984449821, "num_env_steps_trained_throughput_per_sec": 257.8445984449821, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 15513.236, "restore_workers_time_ms": 0.038, "training_step_time_ms": 15513.152, "sample_time_ms": 3694.449, "learn_time_ms": 11800.579, "learn_throughput": 338.966, "synch_weights_time_ms": 13.836}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "4f45b_00000", "date": "2024-08-13_01-17-51", "timestamp": 1723526271, "time_this_iter_s": 15.555602788925171, "time_total_s": 15.555602788925171, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c385e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.555602788925171, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 70.36521739130436, "ram_util_percent": 83.56086956521737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.24680966554140604, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7251046837953035, "policy_loss": -0.0022734046364252373, "vf_loss": 3.7266595612127316, "vf_explained_var": 0.0004536661836836073, "kl": 0.00718522161440355, "entropy": 1.6031012255047994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8236898240786066, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.487172566772138, "policy_loss": -0.0018104241479671112, "vf_loss": 6.488543986769581, "vf_explained_var": 0.020293234832703122, "kl": 0.004390178066598541, "entropy": 1.6010432329758135, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 178.0, "episode_reward_min": -109.0, "episode_reward_mean": 24.11111111111111, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -254.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.0, "predator_policy": 133.0}, "policy_reward_mean": {"prey_policy": -13.791666666666666, "predator_policy": 25.84722222222222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 73.0, 156.0, 91.0, 66.0, 17.0, -7.0, 33.0, 0.0, 95.0, 124.0, -77.0, 7.0, -33.0, -28.0, -11.0, -109.0, 178.0, -109.0, -3.0, 100.0, 29.0, 85.0, 53.0, -44.0, -22.0, 35.0, -103.0, 25.0, 11.0, 26.0, 42.0, 11.0, 113.0, -89.0, 87.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [48.0, -6.0, 2.0, -6.0, 14.0, 71.0, 0.0, 63.0, -94.0, 86.0, 43.0, -53.0, 75.0, -177.0, 95.0, -124.0, 0.0, 0.0, -62.0, 88.0, 103.0, 17.0, -26.0, -184.0, 6.0, 1.0, -8.0, -72.0, 0.0, -69.0, 53.0, -136.0, -118.0, -98.0, 0.0, 178.0, -224.0, 0.0, 21.0, -51.0, 35.0, 10.0, -19.0, -2.0, 2.0, 42.0, 39.0, -12.0, -254.0, 29.0, -64.0, 3.0, 32.0, 3.0, -151.0, -59.0, 22.0, 3.0, -15.0, -74.0, 0.0, 25.0, -48.0, 60.0, 57.0, -94.0, 17.0, 71.0, 0.0, -194.0, 23.0, 64.0], "policy_predator_policy_reward": [4.0, 0.0, 15.0, 62.0, 33.0, 38.0, 24.0, 4.0, 55.0, 19.0, 0.0, 27.0, 89.0, 6.0, 3.0, 59.0, 0.0, 0.0, 69.0, 0.0, 3.0, 1.0, 133.0, 0.0, 0.0, 0.0, 5.0, 42.0, 41.0, 0.0, 67.0, 5.0, 37.0, 70.0, 0.0, 0.0, 52.0, 63.0, 27.0, 0.0, 33.0, 22.0, 0.0, 50.0, 0.0, 41.0, 0.0, 26.0, 87.0, 94.0, 0.0, 39.0, 0.0, 0.0, 0.0, 107.0, 0.0, 0.0, 85.0, 15.0, 0.0, 1.0, 27.0, 3.0, 48.0, 0.0, 7.0, 18.0, 73.0, 32.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4142197794388007, "mean_inference_ms": 4.033099021174845, "mean_action_processing_ms": 0.6209200582912054, "mean_env_wait_ms": 0.5682233427852138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024193194177415635, "StateBufferConnector_ms": 0.07485681109958225, "ViewRequirementAgentConnector_ms": 0.2527581320868598}, "num_episodes": 18, "episode_return_max": 178.0, "episode_return_min": -109.0, "episode_return_mean": 24.11111111111111, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.8285412926153, "num_env_steps_trained_throughput_per_sec": 253.8285412926153, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 15636.005, "restore_workers_time_ms": 0.141, "training_step_time_ms": 15635.736, "sample_time_ms": 2817.924, "learn_time_ms": 12796.005, "learn_throughput": 312.598, "synch_weights_time_ms": 14.029}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "4f45b_00000", "date": "2024-08-13_01-18-13", "timestamp": 1723526293, "time_this_iter_s": 15.872656345367432, "time_total_s": 31.428259134292603, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1bd0e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 31.428259134292603, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 76.65806451612903, "ram_util_percent": 82.92258064516129}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.14671889114435072, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.662184444905589, "policy_loss": -0.0032092466371419727, "vf_loss": 1.664776940257461, "vf_explained_var": 0.001177948934060556, "kl": 0.006167535888813736, "entropy": 1.6074739593046683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0071365313239828, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.386067309833709, "policy_loss": -0.0034063912113813104, "vf_loss": 5.389224548188467, "vf_explained_var": 0.030100318016829313, "kl": 0.004983082003700965, "entropy": 1.5962252637696646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 290.0, "episode_reward_min": -109.0, "episode_reward_mean": 34.31481481481482, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -254.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.0, "predator_policy": 133.0}, "policy_reward_mean": {"prey_policy": -6.583333333333333, "predator_policy": 23.74074074074074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 73.0, 156.0, 91.0, 66.0, 17.0, -7.0, 33.0, 0.0, 95.0, 124.0, -77.0, 7.0, -33.0, -28.0, -11.0, -109.0, 178.0, -109.0, -3.0, 100.0, 29.0, 85.0, 53.0, -44.0, -22.0, 35.0, -103.0, 25.0, 11.0, 26.0, 42.0, 11.0, 113.0, -89.0, 87.0, 72.0, 76.0, 7.0, 145.0, 17.0, 24.0, -25.0, 100.0, -87.0, -94.0, -20.0, 290.0, 112.0, 30.0, 109.0, 131.0, -44.0, 142.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [48.0, -6.0, 2.0, -6.0, 14.0, 71.0, 0.0, 63.0, -94.0, 86.0, 43.0, -53.0, 75.0, -177.0, 95.0, -124.0, 0.0, 0.0, -62.0, 88.0, 103.0, 17.0, -26.0, -184.0, 6.0, 1.0, -8.0, -72.0, 0.0, -69.0, 53.0, -136.0, -118.0, -98.0, 0.0, 178.0, -224.0, 0.0, 21.0, -51.0, 35.0, 10.0, -19.0, -2.0, 2.0, 42.0, 39.0, -12.0, -254.0, 29.0, -64.0, 3.0, 32.0, 3.0, -151.0, -59.0, 22.0, 3.0, -15.0, -74.0, 0.0, 25.0, -48.0, 60.0, 57.0, -94.0, 17.0, 71.0, 0.0, -194.0, 23.0, 64.0, -20.0, 49.0, 50.0, 22.0, 7.0, 0.0, 39.0, 80.0, 3.0, 7.0, 34.0, -51.0, -69.0, -112.0, 7.0, 69.0, -2.0, -200.0, 30.0, -248.0, 0.0, -78.0, 116.0, 174.0, 2.0, 91.0, 4.0, 26.0, 84.0, 23.0, 67.0, 64.0, -103.0, 5.0, 65.0, 47.0], "policy_predator_policy_reward": [4.0, 0.0, 15.0, 62.0, 33.0, 38.0, 24.0, 4.0, 55.0, 19.0, 0.0, 27.0, 89.0, 6.0, 3.0, 59.0, 0.0, 0.0, 69.0, 0.0, 3.0, 1.0, 133.0, 0.0, 0.0, 0.0, 5.0, 42.0, 41.0, 0.0, 67.0, 5.0, 37.0, 70.0, 0.0, 0.0, 52.0, 63.0, 27.0, 0.0, 33.0, 22.0, 0.0, 50.0, 0.0, 41.0, 0.0, 26.0, 87.0, 94.0, 0.0, 39.0, 0.0, 0.0, 0.0, 107.0, 0.0, 0.0, 85.0, 15.0, 0.0, 1.0, 27.0, 3.0, 48.0, 0.0, 7.0, 18.0, 73.0, 32.0, 0.0, 0.0, 0.0, 43.0, 4.0, 0.0, 0.0, 0.0, 14.0, 12.0, 7.0, 0.0, 0.0, 41.0, 106.0, 50.0, 24.0, 0.0, 115.0, 0.0, 124.0, 0.0, 35.0, 23.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 54.0, 0.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3259064890668129, "mean_inference_ms": 3.753886484383759, "mean_action_processing_ms": 0.5822696791480402, "mean_env_wait_ms": 0.5284879960755325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02010133531358507, "StateBufferConnector_ms": 0.05110126954537851, "ViewRequirementAgentConnector_ms": 0.22783875465393066}, "num_episodes": 18, "episode_return_max": 290.0, "episode_return_min": -109.0, "episode_return_mean": 34.31481481481482, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 212.57166900225994, "num_env_steps_trained_throughput_per_sec": 212.57166900225994, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 16696.401, "restore_workers_time_ms": 0.1, "training_step_time_ms": 16696.204, "sample_time_ms": 2570.708, "learn_time_ms": 14089.194, "learn_throughput": 283.906, "synch_weights_time_ms": 27.609}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "4f45b_00000", "date": "2024-08-13_01-18-32", "timestamp": 1723526312, "time_this_iter_s": 18.90015411376953, "time_total_s": 50.328413248062134, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb9310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 50.328413248062134, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 82.63461538461539, "ram_util_percent": 83.74615384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41265388774887596, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.27959953477143, "policy_loss": -0.0016557645695727495, "vf_loss": 4.280761113494792, "vf_explained_var": 0.010442733575427342, "kl": 0.0049418990520779405, "entropy": 1.5971003114861786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0739091034761812, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.771286950287996, "policy_loss": -0.0019993234781804617, "vf_loss": 6.773152256264257, "vf_explained_var": 0.02045374358141864, "kl": 0.005360674056394171, "entropy": 1.593269057753225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 290.0, "episode_reward_min": -109.0, "episode_reward_mean": 33.458333333333336, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -254.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.0, "predator_policy": 133.0}, "policy_reward_mean": {"prey_policy": -6.965277777777778, "predator_policy": 23.694444444444443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 73.0, 156.0, 91.0, 66.0, 17.0, -7.0, 33.0, 0.0, 95.0, 124.0, -77.0, 7.0, -33.0, -28.0, -11.0, -109.0, 178.0, -109.0, -3.0, 100.0, 29.0, 85.0, 53.0, -44.0, -22.0, 35.0, -103.0, 25.0, 11.0, 26.0, 42.0, 11.0, 113.0, -89.0, 87.0, 72.0, 76.0, 7.0, 145.0, 17.0, 24.0, -25.0, 100.0, -87.0, -94.0, -20.0, 290.0, 112.0, 30.0, 109.0, 131.0, -44.0, 142.0, 6.0, -31.0, 81.0, 118.0, 268.0, 18.0, 95.0, 8.0, 46.0, -88.0, -63.0, 28.0, 32.0, 66.0, -44.0, 70.0, 0.0, -54.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [48.0, -6.0, 2.0, -6.0, 14.0, 71.0, 0.0, 63.0, -94.0, 86.0, 43.0, -53.0, 75.0, -177.0, 95.0, -124.0, 0.0, 0.0, -62.0, 88.0, 103.0, 17.0, -26.0, -184.0, 6.0, 1.0, -8.0, -72.0, 0.0, -69.0, 53.0, -136.0, -118.0, -98.0, 0.0, 178.0, -224.0, 0.0, 21.0, -51.0, 35.0, 10.0, -19.0, -2.0, 2.0, 42.0, 39.0, -12.0, -254.0, 29.0, -64.0, 3.0, 32.0, 3.0, -151.0, -59.0, 22.0, 3.0, -15.0, -74.0, 0.0, 25.0, -48.0, 60.0, 57.0, -94.0, 17.0, 71.0, 0.0, -194.0, 23.0, 64.0, -20.0, 49.0, 50.0, 22.0, 7.0, 0.0, 39.0, 80.0, 3.0, 7.0, 34.0, -51.0, -69.0, -112.0, 7.0, 69.0, -2.0, -200.0, 30.0, -248.0, 0.0, -78.0, 116.0, 174.0, 2.0, 91.0, 4.0, 26.0, 84.0, 23.0, 67.0, 64.0, -103.0, 5.0, 65.0, 47.0, -174.0, 93.0, -53.0, -32.0, 76.0, -59.0, 1.0, 91.0, 141.0, 106.0, -136.0, 65.0, 13.0, 82.0, -76.0, -21.0, 27.0, 5.0, -177.0, -44.0, -76.0, -69.0, 28.0, 0.0, 0.0, -8.0, 32.0, 17.0, -4.0, -80.0, 0.0, 70.0, 0.0, 0.0, -62.0, -68.0], "policy_predator_policy_reward": [4.0, 0.0, 15.0, 62.0, 33.0, 38.0, 24.0, 4.0, 55.0, 19.0, 0.0, 27.0, 89.0, 6.0, 3.0, 59.0, 0.0, 0.0, 69.0, 0.0, 3.0, 1.0, 133.0, 0.0, 0.0, 0.0, 5.0, 42.0, 41.0, 0.0, 67.0, 5.0, 37.0, 70.0, 0.0, 0.0, 52.0, 63.0, 27.0, 0.0, 33.0, 22.0, 0.0, 50.0, 0.0, 41.0, 0.0, 26.0, 87.0, 94.0, 0.0, 39.0, 0.0, 0.0, 0.0, 107.0, 0.0, 0.0, 85.0, 15.0, 0.0, 1.0, 27.0, 3.0, 48.0, 0.0, 7.0, 18.0, 73.0, 32.0, 0.0, 0.0, 0.0, 43.0, 4.0, 0.0, 0.0, 0.0, 14.0, 12.0, 7.0, 0.0, 0.0, 41.0, 106.0, 50.0, 24.0, 0.0, 115.0, 0.0, 124.0, 0.0, 35.0, 23.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 54.0, 0.0, 10.0, 20.0, 87.0, 0.0, 52.0, 2.0, 64.0, 0.0, 15.0, 11.0, 18.0, 3.0, 85.0, 4.0, 0.0, 0.0, 51.0, 54.0, 0.0, 14.0, 38.0, 95.0, 82.0, 0.0, 0.0, 0.0, 35.0, 5.0, 0.0, 17.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 65.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5281644957261418, "mean_inference_ms": 4.184162077580287, "mean_action_processing_ms": 0.651969556316602, "mean_env_wait_ms": 0.5848595803168102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02925693988800049, "StateBufferConnector_ms": 0.03921505477693346, "ViewRequirementAgentConnector_ms": 0.315787394841512}, "num_episodes": 18, "episode_return_max": 290.0, "episode_return_min": -109.0, "episode_return_mean": 33.458333333333336, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 113.88552709805622, "num_env_steps_trained_throughput_per_sec": 113.88552709805622, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 21303.055, "restore_workers_time_ms": 0.092, "training_step_time_ms": 21302.873, "sample_time_ms": 4697.684, "learn_time_ms": 16570.35, "learn_throughput": 241.395, "synch_weights_time_ms": 25.681}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "4f45b_00000", "date": "2024-08-13_01-19-09", "timestamp": 1723526349, "time_this_iter_s": 36.26438283920288, "time_total_s": 86.59279608726501, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cc43a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86.59279608726501, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 91.59200000000003, "ram_util_percent": 84.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5620013476443039, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.218279714180679, "policy_loss": -0.0006977050690837796, "vf_loss": 6.2186825883451595, "vf_explained_var": 0.004062292342463498, "kl": 0.005896852681207404, "entropy": 1.5907977230965145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1275158903822697, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.506165023077102, "policy_loss": -0.0037279145351103533, "vf_loss": 7.509752714823163, "vf_explained_var": 0.016291465046544554, "kl": 0.0056096352759240214, "entropy": 1.5915062849483792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 290.0, "episode_reward_min": -235.0, "episode_reward_mean": 16.464646464646464, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -312.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 178.0, "predator_policy": 180.0}, "policy_reward_mean": {"prey_policy": -21.651515151515152, "predator_policy": 29.883838383838384}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.0, 73.0, 156.0, 91.0, 66.0, 17.0, -7.0, 33.0, 0.0, 95.0, 124.0, -77.0, 7.0, -33.0, -28.0, -11.0, -109.0, 178.0, -109.0, -3.0, 100.0, 29.0, 85.0, 53.0, -44.0, -22.0, 35.0, -103.0, 25.0, 11.0, 26.0, 42.0, 11.0, 113.0, -89.0, 87.0, 72.0, 76.0, 7.0, 145.0, 17.0, 24.0, -25.0, 100.0, -87.0, -94.0, -20.0, 290.0, 112.0, 30.0, 109.0, 131.0, -44.0, 142.0, 6.0, -31.0, 81.0, 118.0, 268.0, 18.0, 95.0, 8.0, 46.0, -88.0, -63.0, 28.0, 32.0, 66.0, -44.0, 70.0, 0.0, -54.0, 54.0, 42.0, -137.0, -57.0, -235.0, -44.0, 31.0, -122.0, -147.0, -83.0, 87.0, -3.0, 41.0, 29.0, 174.0, -69.0, -37.0, -55.0, 0.0, -172.0, -45.0, -48.0, 12.0, -15.0, 13.0, 37.0, -30.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [48.0, -6.0, 2.0, -6.0, 14.0, 71.0, 0.0, 63.0, -94.0, 86.0, 43.0, -53.0, 75.0, -177.0, 95.0, -124.0, 0.0, 0.0, -62.0, 88.0, 103.0, 17.0, -26.0, -184.0, 6.0, 1.0, -8.0, -72.0, 0.0, -69.0, 53.0, -136.0, -118.0, -98.0, 0.0, 178.0, -224.0, 0.0, 21.0, -51.0, 35.0, 10.0, -19.0, -2.0, 2.0, 42.0, 39.0, -12.0, -254.0, 29.0, -64.0, 3.0, 32.0, 3.0, -151.0, -59.0, 22.0, 3.0, -15.0, -74.0, 0.0, 25.0, -48.0, 60.0, 57.0, -94.0, 17.0, 71.0, 0.0, -194.0, 23.0, 64.0, -20.0, 49.0, 50.0, 22.0, 7.0, 0.0, 39.0, 80.0, 3.0, 7.0, 34.0, -51.0, -69.0, -112.0, 7.0, 69.0, -2.0, -200.0, 30.0, -248.0, 0.0, -78.0, 116.0, 174.0, 2.0, 91.0, 4.0, 26.0, 84.0, 23.0, 67.0, 64.0, -103.0, 5.0, 65.0, 47.0, -174.0, 93.0, -53.0, -32.0, 76.0, -59.0, 1.0, 91.0, 141.0, 106.0, -136.0, 65.0, 13.0, 82.0, -76.0, -21.0, 27.0, 5.0, -177.0, -44.0, -76.0, -69.0, 28.0, 0.0, 0.0, -8.0, 32.0, 17.0, -4.0, -80.0, 0.0, 70.0, 0.0, 0.0, -62.0, -68.0, 44.0, -22.0, -67.0, 2.0, -201.0, -84.0, -221.0, -14.0, -189.0, -202.0, -75.0, -22.0, -206.0, 134.0, -142.0, -119.0, -312.0, -99.0, -154.0, -32.0, -84.0, 103.0, 17.0, -52.0, -29.0, 16.0, 0.0, 29.0, 36.0, 95.0, -25.0, -144.0, -14.0, -60.0, -228.0, -37.0, 0.0, -35.0, -229.0, -75.0, -18.0, -95.0, -100.0, 0.0, 0.0, -2.0, 18.0, -78.0, -14.0, -52.0, 32.0, -144.0, -32.0, -102.0], "policy_predator_policy_reward": [4.0, 0.0, 15.0, 62.0, 33.0, 38.0, 24.0, 4.0, 55.0, 19.0, 0.0, 27.0, 89.0, 6.0, 3.0, 59.0, 0.0, 0.0, 69.0, 0.0, 3.0, 1.0, 133.0, 0.0, 0.0, 0.0, 5.0, 42.0, 41.0, 0.0, 67.0, 5.0, 37.0, 70.0, 0.0, 0.0, 52.0, 63.0, 27.0, 0.0, 33.0, 22.0, 0.0, 50.0, 0.0, 41.0, 0.0, 26.0, 87.0, 94.0, 0.0, 39.0, 0.0, 0.0, 0.0, 107.0, 0.0, 0.0, 85.0, 15.0, 0.0, 1.0, 27.0, 3.0, 48.0, 0.0, 7.0, 18.0, 73.0, 32.0, 0.0, 0.0, 0.0, 43.0, 4.0, 0.0, 0.0, 0.0, 14.0, 12.0, 7.0, 0.0, 0.0, 41.0, 106.0, 50.0, 24.0, 0.0, 115.0, 0.0, 124.0, 0.0, 35.0, 23.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 54.0, 0.0, 10.0, 20.0, 87.0, 0.0, 52.0, 2.0, 64.0, 0.0, 15.0, 11.0, 18.0, 3.0, 85.0, 4.0, 0.0, 0.0, 51.0, 54.0, 0.0, 14.0, 38.0, 95.0, 82.0, 0.0, 0.0, 0.0, 35.0, 5.0, 0.0, 17.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 65.0, 11.0, 2.0, 30.0, 62.0, 45.0, 53.0, 95.0, 118.0, 60.0, 11.0, 145.0, 46.0, 7.0, 71.0, 32.0, 71.0, 68.0, 84.0, 180.0, 0.0, 103.0, 63.0, 5.0, 14.0, 18.0, 47.0, 7.0, 0.0, 0.0, 40.0, 3.0, 49.0, 51.0, 30.0, 7.0, 124.0, 86.0, 2.0, 33.0, 127.0, 5.0, 23.0, 45.0, 52.0, 0.0, 14.0, 0.0, 34.0, 11.0, 14.0, 65.0, 40.0, 109.0, 0.0, 104.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6782868760369392, "mean_inference_ms": 4.421949224891656, "mean_action_processing_ms": 0.6859708079178275, "mean_env_wait_ms": 0.6181455897958616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0435884552772599, "StateBufferConnector_ms": 0.03058175847987936, "ViewRequirementAgentConnector_ms": 0.2687180885160812}, "num_episodes": 27, "episode_return_max": 290.0, "episode_return_min": -235.0, "episode_return_mean": 16.464646464646464, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.1464770147052, "num_env_steps_trained_throughput_per_sec": 221.1464770147052, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 20659.963, "restore_workers_time_ms": 0.101, "training_step_time_ms": 20659.771, "sample_time_ms": 4349.757, "learn_time_ms": 16276.574, "learn_throughput": 245.752, "synch_weights_time_ms": 25.596}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "4f45b_00000", "date": "2024-08-13_01-19-27", "timestamp": 1723526367, "time_this_iter_s": 18.20382308959961, "time_total_s": 104.79661917686462, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cc4ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 104.79661917686462, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 84.52962962962964, "ram_util_percent": 83.85925925925929}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46224496336407445, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2555171619647396, "policy_loss": -0.00023651577078949207, "vf_loss": 3.255667859158188, "vf_explained_var": -0.001981674205689203, "kl": 0.0017164678909686053, "entropy": 1.587318045563168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.46554375682716, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.296670004930446, "policy_loss": -0.00090731874061502, "vf_loss": 6.29753553097841, "vf_explained_var": 0.06170701066022197, "kl": 0.001671087843063246, "entropy": 1.5868925428895093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 290.0, "episode_reward_min": -235.0, "episode_reward_mean": 20.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -312.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 180.0}, "policy_reward_mean": {"prey_policy": -19.485, "predator_policy": 29.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [178.0, -109.0, -3.0, 100.0, 29.0, 85.0, 53.0, -44.0, -22.0, 35.0, -103.0, 25.0, 11.0, 26.0, 42.0, 11.0, 113.0, -89.0, 87.0, 72.0, 76.0, 7.0, 145.0, 17.0, 24.0, -25.0, 100.0, -87.0, -94.0, -20.0, 290.0, 112.0, 30.0, 109.0, 131.0, -44.0, 142.0, 6.0, -31.0, 81.0, 118.0, 268.0, 18.0, 95.0, 8.0, 46.0, -88.0, -63.0, 28.0, 32.0, 66.0, -44.0, 70.0, 0.0, -54.0, 54.0, 42.0, -137.0, -57.0, -235.0, -44.0, 31.0, -122.0, -147.0, -83.0, 87.0, -3.0, 41.0, 29.0, 174.0, -69.0, -37.0, -55.0, 0.0, -172.0, -45.0, -48.0, 12.0, -15.0, 13.0, 37.0, -30.0, 7.0, 127.0, 152.0, 50.0, 6.0, -37.0, 30.0, 74.0, -19.0, 123.0, -28.0, -11.0, 113.0, -46.0, 189.0, 218.0, -99.0, 5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 178.0, -224.0, 0.0, 21.0, -51.0, 35.0, 10.0, -19.0, -2.0, 2.0, 42.0, 39.0, -12.0, -254.0, 29.0, -64.0, 3.0, 32.0, 3.0, -151.0, -59.0, 22.0, 3.0, -15.0, -74.0, 0.0, 25.0, -48.0, 60.0, 57.0, -94.0, 17.0, 71.0, 0.0, -194.0, 23.0, 64.0, -20.0, 49.0, 50.0, 22.0, 7.0, 0.0, 39.0, 80.0, 3.0, 7.0, 34.0, -51.0, -69.0, -112.0, 7.0, 69.0, -2.0, -200.0, 30.0, -248.0, 0.0, -78.0, 116.0, 174.0, 2.0, 91.0, 4.0, 26.0, 84.0, 23.0, 67.0, 64.0, -103.0, 5.0, 65.0, 47.0, -174.0, 93.0, -53.0, -32.0, 76.0, -59.0, 1.0, 91.0, 141.0, 106.0, -136.0, 65.0, 13.0, 82.0, -76.0, -21.0, 27.0, 5.0, -177.0, -44.0, -76.0, -69.0, 28.0, 0.0, 0.0, -8.0, 32.0, 17.0, -4.0, -80.0, 0.0, 70.0, 0.0, 0.0, -62.0, -68.0, 44.0, -22.0, -67.0, 2.0, -201.0, -84.0, -221.0, -14.0, -189.0, -202.0, -75.0, -22.0, -206.0, 134.0, -142.0, -119.0, -312.0, -99.0, -154.0, -32.0, -84.0, 103.0, 17.0, -52.0, -29.0, 16.0, 0.0, 29.0, 36.0, 95.0, -25.0, -144.0, -14.0, -60.0, -228.0, -37.0, 0.0, -35.0, -229.0, -75.0, -18.0, -95.0, -100.0, 0.0, 0.0, -2.0, 18.0, -78.0, -14.0, -52.0, 32.0, -144.0, -32.0, -102.0, -22.0, -28.0, 125.0, 0.0, 92.0, 27.0, -55.0, 37.0, -108.0, -78.0, -203.0, 42.0, -8.0, 11.0, 66.0, 0.0, -75.0, 3.0, -42.0, 137.0, -66.0, 0.0, 7.0, -64.0, 0.0, 69.0, -176.0, 8.0, 189.0, 0.0, 103.0, 115.0, -84.0, -101.0, 1.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 52.0, 63.0, 27.0, 0.0, 33.0, 22.0, 0.0, 50.0, 0.0, 41.0, 0.0, 26.0, 87.0, 94.0, 0.0, 39.0, 0.0, 0.0, 0.0, 107.0, 0.0, 0.0, 85.0, 15.0, 0.0, 1.0, 27.0, 3.0, 48.0, 0.0, 7.0, 18.0, 73.0, 32.0, 0.0, 0.0, 0.0, 43.0, 4.0, 0.0, 0.0, 0.0, 14.0, 12.0, 7.0, 0.0, 0.0, 41.0, 106.0, 50.0, 24.0, 0.0, 115.0, 0.0, 124.0, 0.0, 35.0, 23.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 54.0, 0.0, 10.0, 20.0, 87.0, 0.0, 52.0, 2.0, 64.0, 0.0, 15.0, 11.0, 18.0, 3.0, 85.0, 4.0, 0.0, 0.0, 51.0, 54.0, 0.0, 14.0, 38.0, 95.0, 82.0, 0.0, 0.0, 0.0, 35.0, 5.0, 0.0, 17.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 65.0, 11.0, 2.0, 30.0, 62.0, 45.0, 53.0, 95.0, 118.0, 60.0, 11.0, 145.0, 46.0, 7.0, 71.0, 32.0, 71.0, 68.0, 84.0, 180.0, 0.0, 103.0, 63.0, 5.0, 14.0, 18.0, 47.0, 7.0, 0.0, 0.0, 40.0, 3.0, 49.0, 51.0, 30.0, 7.0, 124.0, 86.0, 2.0, 33.0, 127.0, 5.0, 23.0, 45.0, 52.0, 0.0, 14.0, 0.0, 34.0, 11.0, 14.0, 65.0, 40.0, 109.0, 0.0, 104.0, 34.0, 23.0, 2.0, 0.0, 33.0, 0.0, 29.0, 39.0, 83.0, 109.0, 97.0, 27.0, 5.0, 22.0, 0.0, 8.0, 3.0, 50.0, 7.0, 21.0, 38.0, 0.0, 1.0, 45.0, 28.0, 16.0, 98.0, 24.0, 0.0, 0.0, 0.0, 0.0, 86.0, 0.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7316990713498859, "mean_inference_ms": 4.441130501152661, "mean_action_processing_ms": 0.6877117807047856, "mean_env_wait_ms": 0.619864668947403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03671073913574219, "StateBufferConnector_ms": 0.004653215408325195, "ViewRequirementAgentConnector_ms": 0.22066080570220947}, "num_episodes": 18, "episode_return_max": 290.0, "episode_return_min": -235.0, "episode_return_mean": 20.41, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.2249822031180315, "num_env_steps_trained_throughput_per_sec": 4.2249822031180315, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 175008.229, "restore_workers_time_ms": 0.088, "training_step_time_ms": 175008.061, "sample_time_ms": 3956.333, "learn_time_ms": 171017.032, "learn_throughput": 23.389, "synch_weights_time_ms": 27.142}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "4f45b_00000", "date": "2024-08-13_01-35-14", "timestamp": 1723527314, "time_this_iter_s": 946.8893921375275, "time_total_s": 1051.686011314392, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb9310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1051.686011314392, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 85.06666666666666, "ram_util_percent": 83.71666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.30474302593677766, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.442680794536752, "policy_loss": -0.0021360258366074905, "vf_loss": 2.4445728796499746, "vf_explained_var": 0.007578137658891224, "kl": 0.009757297123595493, "entropy": 1.564081318353219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.240418015873779, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.3313666121669545, "policy_loss": -0.0022327069356352603, "vf_loss": 5.333532535966742, "vf_explained_var": 0.03336446348321501, "kl": 0.005344794480644367, "entropy": 1.5789499495395276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 290.0, "episode_reward_min": -235.0, "episode_reward_mean": 23.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -312.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 180.0}, "policy_reward_mean": {"prey_policy": -16.44, "predator_policy": 28.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [87.0, 72.0, 76.0, 7.0, 145.0, 17.0, 24.0, -25.0, 100.0, -87.0, -94.0, -20.0, 290.0, 112.0, 30.0, 109.0, 131.0, -44.0, 142.0, 6.0, -31.0, 81.0, 118.0, 268.0, 18.0, 95.0, 8.0, 46.0, -88.0, -63.0, 28.0, 32.0, 66.0, -44.0, 70.0, 0.0, -54.0, 54.0, 42.0, -137.0, -57.0, -235.0, -44.0, 31.0, -122.0, -147.0, -83.0, 87.0, -3.0, 41.0, 29.0, 174.0, -69.0, -37.0, -55.0, 0.0, -172.0, -45.0, -48.0, 12.0, -15.0, 13.0, 37.0, -30.0, 7.0, 127.0, 152.0, 50.0, 6.0, -37.0, 30.0, 74.0, -19.0, 123.0, -28.0, -11.0, 113.0, -46.0, 189.0, 218.0, -99.0, 5.0, 71.0, -8.0, -25.0, -53.0, 115.0, -42.0, 136.0, 236.0, 6.0, -39.0, -16.0, 63.0, 232.0, 52.0, -8.0, -20.0, -40.0, 14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [23.0, 64.0, -20.0, 49.0, 50.0, 22.0, 7.0, 0.0, 39.0, 80.0, 3.0, 7.0, 34.0, -51.0, -69.0, -112.0, 7.0, 69.0, -2.0, -200.0, 30.0, -248.0, 0.0, -78.0, 116.0, 174.0, 2.0, 91.0, 4.0, 26.0, 84.0, 23.0, 67.0, 64.0, -103.0, 5.0, 65.0, 47.0, -174.0, 93.0, -53.0, -32.0, 76.0, -59.0, 1.0, 91.0, 141.0, 106.0, -136.0, 65.0, 13.0, 82.0, -76.0, -21.0, 27.0, 5.0, -177.0, -44.0, -76.0, -69.0, 28.0, 0.0, 0.0, -8.0, 32.0, 17.0, -4.0, -80.0, 0.0, 70.0, 0.0, 0.0, -62.0, -68.0, 44.0, -22.0, -67.0, 2.0, -201.0, -84.0, -221.0, -14.0, -189.0, -202.0, -75.0, -22.0, -206.0, 134.0, -142.0, -119.0, -312.0, -99.0, -154.0, -32.0, -84.0, 103.0, 17.0, -52.0, -29.0, 16.0, 0.0, 29.0, 36.0, 95.0, -25.0, -144.0, -14.0, -60.0, -228.0, -37.0, 0.0, -35.0, -229.0, -75.0, -18.0, -95.0, -100.0, 0.0, 0.0, -2.0, 18.0, -78.0, -14.0, -52.0, 32.0, -144.0, -32.0, -102.0, -22.0, -28.0, 125.0, 0.0, 92.0, 27.0, -55.0, 37.0, -108.0, -78.0, -203.0, 42.0, -8.0, 11.0, 66.0, 0.0, -75.0, 3.0, -42.0, 137.0, -66.0, 0.0, 7.0, -64.0, 0.0, 69.0, -176.0, 8.0, 189.0, 0.0, 103.0, 115.0, -84.0, -101.0, 1.0, 0.0, 0.0, 59.0, -16.0, 0.0, -21.0, -55.0, -16.0, -84.0, 0.0, 115.0, -152.0, 0.0, 96.0, 3.0, 161.0, 75.0, 3.0, 3.0, -6.0, -84.0, -32.0, 0.0, -27.0, 54.0, 180.0, 10.0, 0.0, 52.0, -53.0, -40.0, 16.0, -110.0, 8.0, -156.0, 0.0, 14.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 43.0, 4.0, 0.0, 0.0, 0.0, 14.0, 12.0, 7.0, 0.0, 0.0, 41.0, 106.0, 50.0, 24.0, 0.0, 115.0, 0.0, 124.0, 0.0, 35.0, 23.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 54.0, 0.0, 10.0, 20.0, 87.0, 0.0, 52.0, 2.0, 64.0, 0.0, 15.0, 11.0, 18.0, 3.0, 85.0, 4.0, 0.0, 0.0, 51.0, 54.0, 0.0, 14.0, 38.0, 95.0, 82.0, 0.0, 0.0, 0.0, 35.0, 5.0, 0.0, 17.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 65.0, 11.0, 2.0, 30.0, 62.0, 45.0, 53.0, 95.0, 118.0, 60.0, 11.0, 145.0, 46.0, 7.0, 71.0, 32.0, 71.0, 68.0, 84.0, 180.0, 0.0, 103.0, 63.0, 5.0, 14.0, 18.0, 47.0, 7.0, 0.0, 0.0, 40.0, 3.0, 49.0, 51.0, 30.0, 7.0, 124.0, 86.0, 2.0, 33.0, 127.0, 5.0, 23.0, 45.0, 52.0, 0.0, 14.0, 0.0, 34.0, 11.0, 14.0, 65.0, 40.0, 109.0, 0.0, 104.0, 34.0, 23.0, 2.0, 0.0, 33.0, 0.0, 29.0, 39.0, 83.0, 109.0, 97.0, 27.0, 5.0, 22.0, 0.0, 8.0, 3.0, 50.0, 7.0, 21.0, 38.0, 0.0, 1.0, 45.0, 28.0, 16.0, 98.0, 24.0, 0.0, 0.0, 0.0, 0.0, 86.0, 0.0, 0.0, 4.0, 0.0, 12.0, 0.0, 8.0, 51.0, 0.0, 47.0, 0.0, 0.0, 0.0, 82.0, 28.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 48.0, 3.0, 16.0, 0.0, 14.0, 22.0, 0.0, 42.0, 0.0, 0.0, 73.0, 12.0, 24.0, 50.0, 103.0, 5.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8636976202145759, "mean_inference_ms": 4.656861293729006, "mean_action_processing_ms": 0.7175009048917477, "mean_env_wait_ms": 0.6485708860836212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036722779273986816, "StateBufferConnector_ms": 0.0047109127044677734, "ViewRequirementAgentConnector_ms": 0.27080678939819336}, "num_episodes": 18, "episode_return_max": 290.0, "episode_return_min": -235.0, "episode_return_mean": 23.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.6620768759701, "num_env_steps_trained_throughput_per_sec": 128.6620768759701, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 154448.369, "restore_workers_time_ms": 0.077, "training_step_time_ms": 154448.181, "sample_time_ms": 4061.489, "learn_time_ms": 150351.593, "learn_throughput": 26.604, "synch_weights_time_ms": 26.435}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "4f45b_00000", "date": "2024-08-13_01-35-46", "timestamp": 1723527346, "time_this_iter_s": 31.3054461479187, "time_total_s": 1082.9914574623108, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c381f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1082.9914574623108, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 96.60232558139533, "ram_util_percent": 83.70232558139533}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2811009813750547, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2405474910029657, "policy_loss": 0.0007672148268847239, "vf_loss": 3.239697541950872, "vf_explained_var": -0.0004430924143110003, "kl": 0.0033093674609055617, "entropy": 1.5599300756025567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9408813359245422, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.446188915974249, "policy_loss": -0.0032960268151428964, "vf_loss": 5.449424020323173, "vf_explained_var": 0.02908898525767856, "kl": 0.004873758553153526, "entropy": 1.5753522168391596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 268.0, "episode_reward_min": -235.0, "episode_reward_mean": 18.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -312.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 180.0}, "policy_reward_mean": {"prey_policy": -19.86, "predator_policy": 28.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [142.0, 6.0, -31.0, 81.0, 118.0, 268.0, 18.0, 95.0, 8.0, 46.0, -88.0, -63.0, 28.0, 32.0, 66.0, -44.0, 70.0, 0.0, -54.0, 54.0, 42.0, -137.0, -57.0, -235.0, -44.0, 31.0, -122.0, -147.0, -83.0, 87.0, -3.0, 41.0, 29.0, 174.0, -69.0, -37.0, -55.0, 0.0, -172.0, -45.0, -48.0, 12.0, -15.0, 13.0, 37.0, -30.0, 7.0, 127.0, 152.0, 50.0, 6.0, -37.0, 30.0, 74.0, -19.0, 123.0, -28.0, -11.0, 113.0, -46.0, 189.0, 218.0, -99.0, 5.0, 71.0, -8.0, -25.0, -53.0, 115.0, -42.0, 136.0, 236.0, 6.0, -39.0, -16.0, 63.0, 232.0, 52.0, -8.0, -20.0, -40.0, 14.0, -58.0, 67.0, 71.0, 0.0, -53.0, 36.0, 0.0, 9.0, 30.0, -14.0, 36.0, -4.0, 42.0, 110.0, 17.0, -25.0, 106.0, -10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [65.0, 47.0, -174.0, 93.0, -53.0, -32.0, 76.0, -59.0, 1.0, 91.0, 141.0, 106.0, -136.0, 65.0, 13.0, 82.0, -76.0, -21.0, 27.0, 5.0, -177.0, -44.0, -76.0, -69.0, 28.0, 0.0, 0.0, -8.0, 32.0, 17.0, -4.0, -80.0, 0.0, 70.0, 0.0, 0.0, -62.0, -68.0, 44.0, -22.0, -67.0, 2.0, -201.0, -84.0, -221.0, -14.0, -189.0, -202.0, -75.0, -22.0, -206.0, 134.0, -142.0, -119.0, -312.0, -99.0, -154.0, -32.0, -84.0, 103.0, 17.0, -52.0, -29.0, 16.0, 0.0, 29.0, 36.0, 95.0, -25.0, -144.0, -14.0, -60.0, -228.0, -37.0, 0.0, -35.0, -229.0, -75.0, -18.0, -95.0, -100.0, 0.0, 0.0, -2.0, 18.0, -78.0, -14.0, -52.0, 32.0, -144.0, -32.0, -102.0, -22.0, -28.0, 125.0, 0.0, 92.0, 27.0, -55.0, 37.0, -108.0, -78.0, -203.0, 42.0, -8.0, 11.0, 66.0, 0.0, -75.0, 3.0, -42.0, 137.0, -66.0, 0.0, 7.0, -64.0, 0.0, 69.0, -176.0, 8.0, 189.0, 0.0, 103.0, 115.0, -84.0, -101.0, 1.0, 0.0, 0.0, 59.0, -16.0, 0.0, -21.0, -55.0, -16.0, -84.0, 0.0, 115.0, -152.0, 0.0, 96.0, 3.0, 161.0, 75.0, 3.0, 3.0, -6.0, -84.0, -32.0, 0.0, -27.0, 54.0, 180.0, 10.0, 0.0, 52.0, -53.0, -40.0, 16.0, -110.0, 8.0, -156.0, 0.0, 14.0, -120.0, 2.0, -1.0, 32.0, 0.0, 71.0, 0.0, 0.0, -90.0, -83.0, -1.0, 0.0, 0.0, 0.0, 0.0, 7.0, -20.0, -76.0, -140.0, 4.0, -6.0, 13.0, 0.0, -8.0, 42.0, 0.0, 87.0, 3.0, 17.0, 0.0, -8.0, -114.0, 150.0, -154.0, 0.0, -34.0], "policy_predator_policy_reward": [10.0, 20.0, 87.0, 0.0, 52.0, 2.0, 64.0, 0.0, 15.0, 11.0, 18.0, 3.0, 85.0, 4.0, 0.0, 0.0, 51.0, 54.0, 0.0, 14.0, 38.0, 95.0, 82.0, 0.0, 0.0, 0.0, 35.0, 5.0, 0.0, 17.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 65.0, 11.0, 2.0, 30.0, 62.0, 45.0, 53.0, 95.0, 118.0, 60.0, 11.0, 145.0, 46.0, 7.0, 71.0, 32.0, 71.0, 68.0, 84.0, 180.0, 0.0, 103.0, 63.0, 5.0, 14.0, 18.0, 47.0, 7.0, 0.0, 0.0, 40.0, 3.0, 49.0, 51.0, 30.0, 7.0, 124.0, 86.0, 2.0, 33.0, 127.0, 5.0, 23.0, 45.0, 52.0, 0.0, 14.0, 0.0, 34.0, 11.0, 14.0, 65.0, 40.0, 109.0, 0.0, 104.0, 34.0, 23.0, 2.0, 0.0, 33.0, 0.0, 29.0, 39.0, 83.0, 109.0, 97.0, 27.0, 5.0, 22.0, 0.0, 8.0, 3.0, 50.0, 7.0, 21.0, 38.0, 0.0, 1.0, 45.0, 28.0, 16.0, 98.0, 24.0, 0.0, 0.0, 0.0, 0.0, 86.0, 0.0, 0.0, 4.0, 0.0, 12.0, 0.0, 8.0, 51.0, 0.0, 47.0, 0.0, 0.0, 0.0, 82.0, 28.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 48.0, 3.0, 16.0, 0.0, 14.0, 22.0, 0.0, 42.0, 0.0, 0.0, 73.0, 12.0, 24.0, 50.0, 103.0, 5.0, 0.0, 0.0, 60.0, 0.0, 28.0, 8.0, 0.0, 0.0, 0.0, 0.0, 79.0, 41.0, 37.0, 0.0, 0.0, 0.0, 2.0, 0.0, 75.0, 51.0, 68.0, 54.0, 0.0, 29.0, 0.0, 4.0, 0.0, 0.0, 1.0, 19.0, 0.0, 0.0, 40.0, 57.0, 48.0, 62.0, 24.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0287097417649758, "mean_inference_ms": 4.990313279916145, "mean_action_processing_ms": 0.7665329363780239, "mean_env_wait_ms": 0.6894594835242833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.045015573501586914, "StateBufferConnector_ms": 0.005601763725280762, "ViewRequirementAgentConnector_ms": 0.36821937561035156}, "num_episodes": 18, "episode_return_max": 268.0, "episode_return_min": -235.0, "episode_return_mean": 18.07, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 205.33321215276453, "num_env_steps_trained_throughput_per_sec": 205.33321215276453, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 137577.392, "restore_workers_time_ms": 0.073, "training_step_time_ms": 137577.215, "sample_time_ms": 4267.346, "learn_time_ms": 133276.579, "learn_throughput": 30.013, "synch_weights_time_ms": 24.764}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "4f45b_00000", "date": "2024-08-13_01-36-06", "timestamp": 1723527366, "time_this_iter_s": 19.52610683441162, "time_total_s": 1102.5175642967224, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb4ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1102.5175642967224, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 89.20357142857144, "ram_util_percent": 83.7357142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2195902344322315, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5644999826080586, "policy_loss": -0.0018181728852035665, "vf_loss": 1.5662351402656112, "vf_explained_var": 0.001415323674994171, "kl": 0.006640950142875482, "entropy": 1.5406776966241302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.347473687327728, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8135859972585444, "policy_loss": -0.0022677478455647667, "vf_loss": 3.8158186400378193, "vf_explained_var": 0.048881142795401275, "kl": 0.005617586115869169, "entropy": 1.5349893556070076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 236.0, "episode_reward_min": -235.0, "episode_reward_mean": 20.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -312.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 180.0}, "policy_reward_mean": {"prey_policy": -17.155, "predator_policy": 27.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.0, -235.0, -44.0, 31.0, -122.0, -147.0, -83.0, 87.0, -3.0, 41.0, 29.0, 174.0, -69.0, -37.0, -55.0, 0.0, -172.0, -45.0, -48.0, 12.0, -15.0, 13.0, 37.0, -30.0, 7.0, 127.0, 152.0, 50.0, 6.0, -37.0, 30.0, 74.0, -19.0, 123.0, -28.0, -11.0, 113.0, -46.0, 189.0, 218.0, -99.0, 5.0, 71.0, -8.0, -25.0, -53.0, 115.0, -42.0, 136.0, 236.0, 6.0, -39.0, -16.0, 63.0, 232.0, 52.0, -8.0, -20.0, -40.0, 14.0, -58.0, 67.0, 71.0, 0.0, -53.0, 36.0, 0.0, 9.0, 30.0, -14.0, 36.0, -4.0, 42.0, 110.0, 17.0, -25.0, 106.0, -10.0, 139.0, 59.0, 33.0, -34.0, 153.0, 46.0, 5.0, 31.0, 79.0, 13.0, 65.0, 0.0, 103.0, 57.0, 9.0, 60.0, -33.0, 17.0, -48.0, 38.0, -71.0, 156.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-221.0, -14.0, -189.0, -202.0, -75.0, -22.0, -206.0, 134.0, -142.0, -119.0, -312.0, -99.0, -154.0, -32.0, -84.0, 103.0, 17.0, -52.0, -29.0, 16.0, 0.0, 29.0, 36.0, 95.0, -25.0, -144.0, -14.0, -60.0, -228.0, -37.0, 0.0, -35.0, -229.0, -75.0, -18.0, -95.0, -100.0, 0.0, 0.0, -2.0, 18.0, -78.0, -14.0, -52.0, 32.0, -144.0, -32.0, -102.0, -22.0, -28.0, 125.0, 0.0, 92.0, 27.0, -55.0, 37.0, -108.0, -78.0, -203.0, 42.0, -8.0, 11.0, 66.0, 0.0, -75.0, 3.0, -42.0, 137.0, -66.0, 0.0, 7.0, -64.0, 0.0, 69.0, -176.0, 8.0, 189.0, 0.0, 103.0, 115.0, -84.0, -101.0, 1.0, 0.0, 0.0, 59.0, -16.0, 0.0, -21.0, -55.0, -16.0, -84.0, 0.0, 115.0, -152.0, 0.0, 96.0, 3.0, 161.0, 75.0, 3.0, 3.0, -6.0, -84.0, -32.0, 0.0, -27.0, 54.0, 180.0, 10.0, 0.0, 52.0, -53.0, -40.0, 16.0, -110.0, 8.0, -156.0, 0.0, 14.0, -120.0, 2.0, -1.0, 32.0, 0.0, 71.0, 0.0, 0.0, -90.0, -83.0, -1.0, 0.0, 0.0, 0.0, 0.0, 7.0, -20.0, -76.0, -140.0, 4.0, -6.0, 13.0, 0.0, -8.0, 42.0, 0.0, 87.0, 3.0, 17.0, 0.0, -8.0, -114.0, 150.0, -154.0, 0.0, -34.0, 175.0, -90.0, 5.0, 53.0, 0.0, 16.0, 0.0, -68.0, 87.0, 48.0, 48.0, -4.0, -41.0, 25.0, 0.0, 31.0, 38.0, -11.0, -52.0, 37.0, 79.0, -119.0, 0.0, 0.0, 72.0, 0.0, -103.0, 74.0, 7.0, 2.0, 60.0, 0.0, -181.0, 10.0, 17.0, 0.0, -185.0, -10.0, 0.0, 38.0, -102.0, -79.0, 100.0, 56.0], "policy_predator_policy_reward": [118.0, 60.0, 11.0, 145.0, 46.0, 7.0, 71.0, 32.0, 71.0, 68.0, 84.0, 180.0, 0.0, 103.0, 63.0, 5.0, 14.0, 18.0, 47.0, 7.0, 0.0, 0.0, 40.0, 3.0, 49.0, 51.0, 30.0, 7.0, 124.0, 86.0, 2.0, 33.0, 127.0, 5.0, 23.0, 45.0, 52.0, 0.0, 14.0, 0.0, 34.0, 11.0, 14.0, 65.0, 40.0, 109.0, 0.0, 104.0, 34.0, 23.0, 2.0, 0.0, 33.0, 0.0, 29.0, 39.0, 83.0, 109.0, 97.0, 27.0, 5.0, 22.0, 0.0, 8.0, 3.0, 50.0, 7.0, 21.0, 38.0, 0.0, 1.0, 45.0, 28.0, 16.0, 98.0, 24.0, 0.0, 0.0, 0.0, 0.0, 86.0, 0.0, 0.0, 4.0, 0.0, 12.0, 0.0, 8.0, 51.0, 0.0, 47.0, 0.0, 0.0, 0.0, 82.0, 28.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 48.0, 3.0, 16.0, 0.0, 14.0, 22.0, 0.0, 42.0, 0.0, 0.0, 73.0, 12.0, 24.0, 50.0, 103.0, 5.0, 0.0, 0.0, 60.0, 0.0, 28.0, 8.0, 0.0, 0.0, 0.0, 0.0, 79.0, 41.0, 37.0, 0.0, 0.0, 0.0, 2.0, 0.0, 75.0, 51.0, 68.0, 54.0, 0.0, 29.0, 0.0, 4.0, 0.0, 0.0, 1.0, 19.0, 0.0, 0.0, 40.0, 57.0, 48.0, 62.0, 24.0, 0.0, 0.0, 54.0, 1.0, 0.0, 0.0, 17.0, 12.0, 22.0, 17.0, 1.0, 2.0, 0.0, 15.0, 6.0, 0.0, 0.0, 28.0, 24.0, 0.0, 28.0, 72.0, 33.0, 0.0, 0.0, 30.0, 1.0, 22.0, 64.0, 0.0, 0.0, 0.0, 0.0, 85.0, 53.0, 0.0, 0.0, 34.0, 113.0, 0.0, 0.0, 36.0, 74.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.020028725324902, "mean_inference_ms": 4.916591687708402, "mean_action_processing_ms": 0.7497702622038088, "mean_env_wait_ms": 0.6736514598254125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03446090221405029, "StateBufferConnector_ms": 0.006980299949645996, "ViewRequirementAgentConnector_ms": 0.33502066135406494}, "num_episodes": 22, "episode_return_max": 236.0, "episode_return_min": -235.0, "episode_return_mean": 20.27, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.9085945676102, "num_env_steps_trained_throughput_per_sec": 213.9085945676102, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 124368.746, "restore_workers_time_ms": 0.066, "training_step_time_ms": 124368.584, "sample_time_ms": 4182.429, "learn_time_ms": 120153.838, "learn_throughput": 33.291, "synch_weights_time_ms": 24.498}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "4f45b_00000", "date": "2024-08-13_01-36-24", "timestamp": 1723527384, "time_this_iter_s": 18.760955810546875, "time_total_s": 1121.2785201072693, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cd5280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1121.2785201072693, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 90.93846153846154, "ram_util_percent": 83.72692307692309}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2455692217581802, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.100911383338706, "policy_loss": -0.0005346459084037672, "vf_loss": 2.1014243815311047, "vf_explained_var": 0.0005307637825214043, "kl": 0.001732204867919154, "entropy": 1.5083487163145075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0110995917842187, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.033166570385928, "policy_loss": -0.004287225219159924, "vf_loss": 4.037426954350144, "vf_explained_var": 0.018033204476038615, "kl": 0.004292585495060571, "entropy": 1.5560391603954256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 236.0, "episode_reward_min": -108.0, "episode_reward_mean": 28.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -281.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 189.0, "predator_policy": 169.0}, "policy_reward_mean": {"prey_policy": -7.195, "predator_policy": 21.475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0, 7.0, 127.0, 152.0, 50.0, 6.0, -37.0, 30.0, 74.0, -19.0, 123.0, -28.0, -11.0, 113.0, -46.0, 189.0, 218.0, -99.0, 5.0, 71.0, -8.0, -25.0, -53.0, 115.0, -42.0, 136.0, 236.0, 6.0, -39.0, -16.0, 63.0, 232.0, 52.0, -8.0, -20.0, -40.0, 14.0, -58.0, 67.0, 71.0, 0.0, -53.0, 36.0, 0.0, 9.0, 30.0, -14.0, 36.0, -4.0, 42.0, 110.0, 17.0, -25.0, 106.0, -10.0, 139.0, 59.0, 33.0, -34.0, 153.0, 46.0, 5.0, 31.0, 79.0, 13.0, 65.0, 0.0, 103.0, 57.0, 9.0, 60.0, -33.0, 17.0, -48.0, 38.0, -71.0, 156.0, -41.0, -73.0, -17.0, -73.0, 0.0, 45.0, 58.0, 45.0, 61.0, 114.0, -91.0, 95.0, -38.0, 30.0, 35.0, -42.0, 82.0, 29.0, 33.0, 38.0, -108.0, -91.0, 30.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-32.0, -102.0, -22.0, -28.0, 125.0, 0.0, 92.0, 27.0, -55.0, 37.0, -108.0, -78.0, -203.0, 42.0, -8.0, 11.0, 66.0, 0.0, -75.0, 3.0, -42.0, 137.0, -66.0, 0.0, 7.0, -64.0, 0.0, 69.0, -176.0, 8.0, 189.0, 0.0, 103.0, 115.0, -84.0, -101.0, 1.0, 0.0, 0.0, 59.0, -16.0, 0.0, -21.0, -55.0, -16.0, -84.0, 0.0, 115.0, -152.0, 0.0, 96.0, 3.0, 161.0, 75.0, 3.0, 3.0, -6.0, -84.0, -32.0, 0.0, -27.0, 54.0, 180.0, 10.0, 0.0, 52.0, -53.0, -40.0, 16.0, -110.0, 8.0, -156.0, 0.0, 14.0, -120.0, 2.0, -1.0, 32.0, 0.0, 71.0, 0.0, 0.0, -90.0, -83.0, -1.0, 0.0, 0.0, 0.0, 0.0, 7.0, -20.0, -76.0, -140.0, 4.0, -6.0, 13.0, 0.0, -8.0, 42.0, 0.0, 87.0, 3.0, 17.0, 0.0, -8.0, -114.0, 150.0, -154.0, 0.0, -34.0, 175.0, -90.0, 5.0, 53.0, 0.0, 16.0, 0.0, -68.0, 87.0, 48.0, 48.0, -4.0, -41.0, 25.0, 0.0, 31.0, 38.0, -11.0, -52.0, 37.0, 79.0, -119.0, 0.0, 0.0, 72.0, 0.0, -103.0, 74.0, 7.0, 2.0, 60.0, 0.0, -181.0, 10.0, 17.0, 0.0, -185.0, -10.0, 0.0, 38.0, -102.0, -79.0, 100.0, 56.0, -30.0, -26.0, -8.0, -184.0, -6.0, -29.0, 0.0, -199.0, 0.0, 0.0, 65.0, -46.0, 39.0, 6.0, 9.0, 29.0, 52.0, 9.0, 0.0, 114.0, -202.0, 8.0, 95.0, 0.0, -120.0, -4.0, -25.0, 37.0, 0.0, 31.0, -95.0, 0.0, 42.0, 17.0, -92.0, 57.0, 56.0, -46.0, 3.0, 24.0, -281.0, 4.0, -49.0, -115.0, 0.0, 30.0], "policy_predator_policy_reward": [0.0, 104.0, 34.0, 23.0, 2.0, 0.0, 33.0, 0.0, 29.0, 39.0, 83.0, 109.0, 97.0, 27.0, 5.0, 22.0, 0.0, 8.0, 3.0, 50.0, 7.0, 21.0, 38.0, 0.0, 1.0, 45.0, 28.0, 16.0, 98.0, 24.0, 0.0, 0.0, 0.0, 0.0, 86.0, 0.0, 0.0, 4.0, 0.0, 12.0, 0.0, 8.0, 51.0, 0.0, 47.0, 0.0, 0.0, 0.0, 82.0, 28.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 48.0, 3.0, 16.0, 0.0, 14.0, 22.0, 0.0, 42.0, 0.0, 0.0, 73.0, 12.0, 24.0, 50.0, 103.0, 5.0, 0.0, 0.0, 60.0, 0.0, 28.0, 8.0, 0.0, 0.0, 0.0, 0.0, 79.0, 41.0, 37.0, 0.0, 0.0, 0.0, 2.0, 0.0, 75.0, 51.0, 68.0, 54.0, 0.0, 29.0, 0.0, 4.0, 0.0, 0.0, 1.0, 19.0, 0.0, 0.0, 40.0, 57.0, 48.0, 62.0, 24.0, 0.0, 0.0, 54.0, 1.0, 0.0, 0.0, 17.0, 12.0, 22.0, 17.0, 1.0, 2.0, 0.0, 15.0, 6.0, 0.0, 0.0, 28.0, 24.0, 0.0, 28.0, 72.0, 33.0, 0.0, 0.0, 30.0, 1.0, 22.0, 64.0, 0.0, 0.0, 0.0, 0.0, 85.0, 53.0, 0.0, 0.0, 34.0, 113.0, 0.0, 0.0, 36.0, 74.0, 0.0, 0.0, 15.0, 0.0, 0.0, 119.0, 15.0, 3.0, 24.0, 102.0, 0.0, 0.0, 0.0, 26.0, 0.0, 13.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 101.0, 0.0, 0.0, 59.0, 27.0, 2.0, 16.0, 4.0, 0.0, 53.0, 0.0, 1.0, 22.0, 0.0, 64.0, 0.0, 23.0, 11.0, 0.0, 169.0, 0.0, 73.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9901955763039398, "mean_inference_ms": 4.849116350467923, "mean_action_processing_ms": 0.7370745915621104, "mean_env_wait_ms": 0.6602075467334465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016500473022460938, "StateBufferConnector_ms": 0.007299184799194336, "ViewRequirementAgentConnector_ms": 0.37090981006622314}, "num_episodes": 23, "episode_return_max": 236.0, "episode_return_min": -108.0, "episode_return_mean": 28.56, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.8198394217018, "num_env_steps_trained_throughput_per_sec": 204.8198394217018, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 113884.808, "restore_workers_time_ms": 0.061, "training_step_time_ms": 113884.657, "sample_time_ms": 3979.618, "learn_time_ms": 109873.761, "learn_throughput": 36.405, "synch_weights_time_ms": 23.93}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "4f45b_00000", "date": "2024-08-13_01-36-44", "timestamp": 1723527404, "time_this_iter_s": 19.586575984954834, "time_total_s": 1140.8650960922241, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1ce3160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1140.8650960922241, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 90.89642857142857, "ram_util_percent": 83.675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.31112445018909596, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3283708686866458, "policy_loss": -0.003162047777955652, "vf_loss": 1.3314726907424825, "vf_explained_var": 0.012851089649099522, "kl": 0.009635818814938158, "entropy": 1.5105956119204325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8415172036678072, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6274723767603514, "policy_loss": -0.005430308483274919, "vf_loss": 2.632883913302548, "vf_explained_var": 0.037242712198741854, "kl": 0.0060083202742571935, "entropy": 1.535454481997818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 236.0, "episode_reward_min": -108.0, "episode_reward_mean": 22.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -281.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 180.0, "predator_policy": 169.0}, "policy_reward_mean": {"prey_policy": -7.01, "predator_policy": 18.095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 71.0, -8.0, -25.0, -53.0, 115.0, -42.0, 136.0, 236.0, 6.0, -39.0, -16.0, 63.0, 232.0, 52.0, -8.0, -20.0, -40.0, 14.0, -58.0, 67.0, 71.0, 0.0, -53.0, 36.0, 0.0, 9.0, 30.0, -14.0, 36.0, -4.0, 42.0, 110.0, 17.0, -25.0, 106.0, -10.0, 139.0, 59.0, 33.0, -34.0, 153.0, 46.0, 5.0, 31.0, 79.0, 13.0, 65.0, 0.0, 103.0, 57.0, 9.0, 60.0, -33.0, 17.0, -48.0, 38.0, -71.0, 156.0, -41.0, -73.0, -17.0, -73.0, 0.0, 45.0, 58.0, 45.0, 61.0, 114.0, -91.0, 95.0, -38.0, 30.0, 35.0, -42.0, 82.0, 29.0, 33.0, 38.0, -108.0, -91.0, 30.0, -48.0, 7.0, -1.0, 52.0, -9.0, 122.0, 85.0, -25.0, 0.0, 34.0, -6.0, 0.0, 0.0, -4.0, -17.0, -17.0, 8.0, -1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0, 0.0, 0.0, 59.0, -16.0, 0.0, -21.0, -55.0, -16.0, -84.0, 0.0, 115.0, -152.0, 0.0, 96.0, 3.0, 161.0, 75.0, 3.0, 3.0, -6.0, -84.0, -32.0, 0.0, -27.0, 54.0, 180.0, 10.0, 0.0, 52.0, -53.0, -40.0, 16.0, -110.0, 8.0, -156.0, 0.0, 14.0, -120.0, 2.0, -1.0, 32.0, 0.0, 71.0, 0.0, 0.0, -90.0, -83.0, -1.0, 0.0, 0.0, 0.0, 0.0, 7.0, -20.0, -76.0, -140.0, 4.0, -6.0, 13.0, 0.0, -8.0, 42.0, 0.0, 87.0, 3.0, 17.0, 0.0, -8.0, -114.0, 150.0, -154.0, 0.0, -34.0, 175.0, -90.0, 5.0, 53.0, 0.0, 16.0, 0.0, -68.0, 87.0, 48.0, 48.0, -4.0, -41.0, 25.0, 0.0, 31.0, 38.0, -11.0, -52.0, 37.0, 79.0, -119.0, 0.0, 0.0, 72.0, 0.0, -103.0, 74.0, 7.0, 2.0, 60.0, 0.0, -181.0, 10.0, 17.0, 0.0, -185.0, -10.0, 0.0, 38.0, -102.0, -79.0, 100.0, 56.0, -30.0, -26.0, -8.0, -184.0, -6.0, -29.0, 0.0, -199.0, 0.0, 0.0, 65.0, -46.0, 39.0, 6.0, 9.0, 29.0, 52.0, 9.0, 0.0, 114.0, -202.0, 8.0, 95.0, 0.0, -120.0, -4.0, -25.0, 37.0, 0.0, 31.0, -95.0, 0.0, 42.0, 17.0, -92.0, 57.0, 56.0, -46.0, 3.0, 24.0, -281.0, 4.0, -49.0, -115.0, 0.0, 30.0, -95.0, -29.0, 7.0, 0.0, -7.0, 0.0, 39.0, -33.0, -44.0, 0.0, 0.0, 122.0, 34.0, 33.0, -118.0, 3.0, 0.0, 0.0, 0.0, 31.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -34.0, 0.0, 0.0, -67.0, 8.0, 0.0, 0.0, -2.0], "policy_predator_policy_reward": [0.0, 4.0, 0.0, 12.0, 0.0, 8.0, 51.0, 0.0, 47.0, 0.0, 0.0, 0.0, 82.0, 28.0, 37.0, 0.0, 0.0, 0.0, 0.0, 0.0, 48.0, 3.0, 16.0, 0.0, 14.0, 22.0, 0.0, 42.0, 0.0, 0.0, 73.0, 12.0, 24.0, 50.0, 103.0, 5.0, 0.0, 0.0, 60.0, 0.0, 28.0, 8.0, 0.0, 0.0, 0.0, 0.0, 79.0, 41.0, 37.0, 0.0, 0.0, 0.0, 2.0, 0.0, 75.0, 51.0, 68.0, 54.0, 0.0, 29.0, 0.0, 4.0, 0.0, 0.0, 1.0, 19.0, 0.0, 0.0, 40.0, 57.0, 48.0, 62.0, 24.0, 0.0, 0.0, 54.0, 1.0, 0.0, 0.0, 17.0, 12.0, 22.0, 17.0, 1.0, 2.0, 0.0, 15.0, 6.0, 0.0, 0.0, 28.0, 24.0, 0.0, 28.0, 72.0, 33.0, 0.0, 0.0, 30.0, 1.0, 22.0, 64.0, 0.0, 0.0, 0.0, 0.0, 85.0, 53.0, 0.0, 0.0, 34.0, 113.0, 0.0, 0.0, 36.0, 74.0, 0.0, 0.0, 15.0, 0.0, 0.0, 119.0, 15.0, 3.0, 24.0, 102.0, 0.0, 0.0, 0.0, 26.0, 0.0, 13.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 101.0, 0.0, 0.0, 59.0, 27.0, 2.0, 16.0, 4.0, 0.0, 53.0, 0.0, 1.0, 22.0, 0.0, 64.0, 0.0, 23.0, 11.0, 0.0, 169.0, 0.0, 73.0, 0.0, 0.0, 0.0, 2.0, 74.0, 0.0, 0.0, 6.0, 0.0, 46.0, 0.0, 0.0, 35.0, 0.0, 0.0, 18.0, 0.0, 21.0, 69.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 17.0, 22.0, 28.0, 0.0, 0.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.990273065849663, "mean_inference_ms": 4.833571401524484, "mean_action_processing_ms": 0.734799674438263, "mean_env_wait_ms": 0.6541498667161484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016588330268859863, "StateBufferConnector_ms": 0.0073822736740112305, "ViewRequirementAgentConnector_ms": 0.3822970390319824}, "num_episodes": 18, "episode_return_max": 236.0, "episode_return_min": -108.0, "episode_return_mean": 22.17, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.9329616340566, "num_env_steps_trained_throughput_per_sec": 217.9329616340566, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 114168.912, "restore_workers_time_ms": 0.059, "training_step_time_ms": 114168.764, "sample_time_ms": 3855.194, "learn_time_ms": 110281.029, "learn_throughput": 36.271, "synch_weights_time_ms": 25.437}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "4f45b_00000", "date": "2024-08-13_01-37-02", "timestamp": 1723527422, "time_this_iter_s": 18.46284818649292, "time_total_s": 1159.327944278717, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cd5820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1159.327944278717, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 87.83461538461538, "ram_util_percent": 83.67692307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.2354145961700293, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6726051656972795, "policy_loss": -0.001774670756988661, "vf_loss": 0.6743479921526853, "vf_explained_var": 0.012546142194636916, "kl": 0.005095062967510665, "entropy": 1.547295382729283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.843027271231804, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.128719377959216, "policy_loss": 0.00012157696641725365, "vf_loss": 3.128580768209286, "vf_explained_var": 0.09104890577376835, "kl": 0.005451207978978973, "entropy": 1.4968718502887342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 280.0, "episode_reward_min": -108.0, "episode_reward_mean": 26.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -281.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 175.0, "predator_policy": 169.0}, "policy_reward_mean": {"prey_policy": -3.115, "predator_policy": 16.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, -58.0, 67.0, 71.0, 0.0, -53.0, 36.0, 0.0, 9.0, 30.0, -14.0, 36.0, -4.0, 42.0, 110.0, 17.0, -25.0, 106.0, -10.0, 139.0, 59.0, 33.0, -34.0, 153.0, 46.0, 5.0, 31.0, 79.0, 13.0, 65.0, 0.0, 103.0, 57.0, 9.0, 60.0, -33.0, 17.0, -48.0, 38.0, -71.0, 156.0, -41.0, -73.0, -17.0, -73.0, 0.0, 45.0, 58.0, 45.0, 61.0, 114.0, -91.0, 95.0, -38.0, 30.0, 35.0, -42.0, 82.0, 29.0, 33.0, 38.0, -108.0, -91.0, 30.0, -48.0, 7.0, -1.0, 52.0, -9.0, 122.0, 85.0, -25.0, 0.0, 34.0, -6.0, 0.0, 0.0, -4.0, -17.0, -17.0, 8.0, -1.0, 118.0, -2.0, 17.0, 51.0, 124.0, 73.0, -26.0, 92.0, 69.0, 82.0, 4.0, 101.0, 53.0, 37.0, 67.0, -47.0, 0.0, 280.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 14.0, -120.0, 2.0, -1.0, 32.0, 0.0, 71.0, 0.0, 0.0, -90.0, -83.0, -1.0, 0.0, 0.0, 0.0, 0.0, 7.0, -20.0, -76.0, -140.0, 4.0, -6.0, 13.0, 0.0, -8.0, 42.0, 0.0, 87.0, 3.0, 17.0, 0.0, -8.0, -114.0, 150.0, -154.0, 0.0, -34.0, 175.0, -90.0, 5.0, 53.0, 0.0, 16.0, 0.0, -68.0, 87.0, 48.0, 48.0, -4.0, -41.0, 25.0, 0.0, 31.0, 38.0, -11.0, -52.0, 37.0, 79.0, -119.0, 0.0, 0.0, 72.0, 0.0, -103.0, 74.0, 7.0, 2.0, 60.0, 0.0, -181.0, 10.0, 17.0, 0.0, -185.0, -10.0, 0.0, 38.0, -102.0, -79.0, 100.0, 56.0, -30.0, -26.0, -8.0, -184.0, -6.0, -29.0, 0.0, -199.0, 0.0, 0.0, 65.0, -46.0, 39.0, 6.0, 9.0, 29.0, 52.0, 9.0, 0.0, 114.0, -202.0, 8.0, 95.0, 0.0, -120.0, -4.0, -25.0, 37.0, 0.0, 31.0, -95.0, 0.0, 42.0, 17.0, -92.0, 57.0, 56.0, -46.0, 3.0, 24.0, -281.0, 4.0, -49.0, -115.0, 0.0, 30.0, -95.0, -29.0, 7.0, 0.0, -7.0, 0.0, 39.0, -33.0, -44.0, 0.0, 0.0, 122.0, 34.0, 33.0, -118.0, 3.0, 0.0, 0.0, 0.0, 31.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -34.0, 0.0, 0.0, -67.0, 8.0, 0.0, 0.0, -2.0, 37.0, 75.0, -4.0, 0.0, -38.0, 14.0, 0.0, 51.0, 0.0, 88.0, 0.0, 35.0, -8.0, -36.0, 0.0, 39.0, 0.0, 69.0, 82.0, 0.0, 0.0, -14.0, 119.0, -62.0, 21.0, 12.0, 0.0, 31.0, 0.0, 67.0, -36.0, -59.0, 0.0, 0.0, 170.0, 110.0], "policy_predator_policy_reward": [0.0, 0.0, 60.0, 0.0, 28.0, 8.0, 0.0, 0.0, 0.0, 0.0, 79.0, 41.0, 37.0, 0.0, 0.0, 0.0, 2.0, 0.0, 75.0, 51.0, 68.0, 54.0, 0.0, 29.0, 0.0, 4.0, 0.0, 0.0, 1.0, 19.0, 0.0, 0.0, 40.0, 57.0, 48.0, 62.0, 24.0, 0.0, 0.0, 54.0, 1.0, 0.0, 0.0, 17.0, 12.0, 22.0, 17.0, 1.0, 2.0, 0.0, 15.0, 6.0, 0.0, 0.0, 28.0, 24.0, 0.0, 28.0, 72.0, 33.0, 0.0, 0.0, 30.0, 1.0, 22.0, 64.0, 0.0, 0.0, 0.0, 0.0, 85.0, 53.0, 0.0, 0.0, 34.0, 113.0, 0.0, 0.0, 36.0, 74.0, 0.0, 0.0, 15.0, 0.0, 0.0, 119.0, 15.0, 3.0, 24.0, 102.0, 0.0, 0.0, 0.0, 26.0, 0.0, 13.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 101.0, 0.0, 0.0, 59.0, 27.0, 2.0, 16.0, 4.0, 0.0, 53.0, 0.0, 1.0, 22.0, 0.0, 64.0, 0.0, 23.0, 11.0, 0.0, 169.0, 0.0, 73.0, 0.0, 0.0, 0.0, 2.0, 74.0, 0.0, 0.0, 6.0, 0.0, 46.0, 0.0, 0.0, 35.0, 0.0, 0.0, 18.0, 0.0, 21.0, 69.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 17.0, 22.0, 28.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 2.0, 0.0, 7.0, 34.0, 0.0, 0.0, 29.0, 7.0, 0.0, 38.0, 18.0, 0.0, 25.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 32.0, 12.0, 2.0, 18.0, 0.0, 6.0, 0.0, 0.0, 30.0, 18.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9752586549743345, "mean_inference_ms": 4.813804666683515, "mean_action_processing_ms": 0.7330782779909032, "mean_env_wait_ms": 0.6483652934122657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018278837203979492, "StateBufferConnector_ms": 0.007665753364562988, "ViewRequirementAgentConnector_ms": 0.370373010635376}, "num_episodes": 18, "episode_return_max": 280.0, "episode_return_min": -108.0, "episode_return_mean": 26.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.89681009543887, "num_env_steps_trained_throughput_per_sec": 211.89681009543887, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 114480.747, "restore_workers_time_ms": 0.036, "training_step_time_ms": 114480.639, "sample_time_ms": 4065.996, "learn_time_ms": 110382.748, "learn_throughput": 36.238, "synch_weights_time_ms": 25.53}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "4f45b_00000", "date": "2024-08-13_01-37-21", "timestamp": 1723527441, "time_this_iter_s": 18.926558017730713, "time_total_s": 1178.2545022964478, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c32f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1178.2545022964478, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 85.81111111111112, "ram_util_percent": 83.27777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.286008478492183, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.269407736876654, "policy_loss": -0.004276878653074462, "vf_loss": 2.2736445130494536, "vf_explained_var": 0.007339285511188406, "kl": 0.006415621484232661, "entropy": 1.534993649916674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0284252919177845, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.10119437237896, "policy_loss": -0.0008438037009909749, "vf_loss": 4.102021838622118, "vf_explained_var": 0.03644395748143474, "kl": 0.005228424180946843, "entropy": 1.5090380939226302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 280.0, "episode_reward_min": -151.0, "episode_reward_mean": 31.48, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -288.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 175.0, "predator_policy": 169.0}, "policy_reward_mean": {"prey_policy": 0.315, "predator_policy": 15.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 139.0, 59.0, 33.0, -34.0, 153.0, 46.0, 5.0, 31.0, 79.0, 13.0, 65.0, 0.0, 103.0, 57.0, 9.0, 60.0, -33.0, 17.0, -48.0, 38.0, -71.0, 156.0, -41.0, -73.0, -17.0, -73.0, 0.0, 45.0, 58.0, 45.0, 61.0, 114.0, -91.0, 95.0, -38.0, 30.0, 35.0, -42.0, 82.0, 29.0, 33.0, 38.0, -108.0, -91.0, 30.0, -48.0, 7.0, -1.0, 52.0, -9.0, 122.0, 85.0, -25.0, 0.0, 34.0, -6.0, 0.0, 0.0, -4.0, -17.0, -17.0, 8.0, -1.0, 118.0, -2.0, 17.0, 51.0, 124.0, 73.0, -26.0, 92.0, 69.0, 82.0, 4.0, 101.0, 53.0, 37.0, 67.0, -47.0, 0.0, 280.0, 108.0, 140.0, 26.0, -34.0, 88.0, 42.0, -5.0, -1.0, 183.0, 0.0, 78.0, 158.0, 0.0, -59.0, 171.0, -151.0, 179.0, -36.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -34.0, 175.0, -90.0, 5.0, 53.0, 0.0, 16.0, 0.0, -68.0, 87.0, 48.0, 48.0, -4.0, -41.0, 25.0, 0.0, 31.0, 38.0, -11.0, -52.0, 37.0, 79.0, -119.0, 0.0, 0.0, 72.0, 0.0, -103.0, 74.0, 7.0, 2.0, 60.0, 0.0, -181.0, 10.0, 17.0, 0.0, -185.0, -10.0, 0.0, 38.0, -102.0, -79.0, 100.0, 56.0, -30.0, -26.0, -8.0, -184.0, -6.0, -29.0, 0.0, -199.0, 0.0, 0.0, 65.0, -46.0, 39.0, 6.0, 9.0, 29.0, 52.0, 9.0, 0.0, 114.0, -202.0, 8.0, 95.0, 0.0, -120.0, -4.0, -25.0, 37.0, 0.0, 31.0, -95.0, 0.0, 42.0, 17.0, -92.0, 57.0, 56.0, -46.0, 3.0, 24.0, -281.0, 4.0, -49.0, -115.0, 0.0, 30.0, -95.0, -29.0, 7.0, 0.0, -7.0, 0.0, 39.0, -33.0, -44.0, 0.0, 0.0, 122.0, 34.0, 33.0, -118.0, 3.0, 0.0, 0.0, 0.0, 31.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -34.0, 0.0, 0.0, -67.0, 8.0, 0.0, 0.0, -2.0, 37.0, 75.0, -4.0, 0.0, -38.0, 14.0, 0.0, 51.0, 0.0, 88.0, 0.0, 35.0, -8.0, -36.0, 0.0, 39.0, 0.0, 69.0, 82.0, 0.0, 0.0, -14.0, 119.0, -62.0, 21.0, 12.0, 0.0, 31.0, 0.0, 67.0, -36.0, -59.0, 0.0, 0.0, 170.0, 110.0, 68.0, 0.0, 35.0, 97.0, 8.0, 0.0, -14.0, -54.0, -12.0, 59.0, 0.0, 42.0, 0.0, -15.0, 0.0, -2.0, 17.0, 153.0, 0.0, 0.0, 0.0, 78.0, 171.0, -26.0, 0.0, 0.0, -51.0, -126.0, 156.0, 0.0, -288.0, -78.0, 175.0, 0.0, 0.0, -86.0], "policy_predator_policy_reward": [24.0, 0.0, 0.0, 54.0, 1.0, 0.0, 0.0, 17.0, 12.0, 22.0, 17.0, 1.0, 2.0, 0.0, 15.0, 6.0, 0.0, 0.0, 28.0, 24.0, 0.0, 28.0, 72.0, 33.0, 0.0, 0.0, 30.0, 1.0, 22.0, 64.0, 0.0, 0.0, 0.0, 0.0, 85.0, 53.0, 0.0, 0.0, 34.0, 113.0, 0.0, 0.0, 36.0, 74.0, 0.0, 0.0, 15.0, 0.0, 0.0, 119.0, 15.0, 3.0, 24.0, 102.0, 0.0, 0.0, 0.0, 26.0, 0.0, 13.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 101.0, 0.0, 0.0, 59.0, 27.0, 2.0, 16.0, 4.0, 0.0, 53.0, 0.0, 1.0, 22.0, 0.0, 64.0, 0.0, 23.0, 11.0, 0.0, 169.0, 0.0, 73.0, 0.0, 0.0, 0.0, 2.0, 74.0, 0.0, 0.0, 6.0, 0.0, 46.0, 0.0, 0.0, 35.0, 0.0, 0.0, 18.0, 0.0, 21.0, 69.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 17.0, 22.0, 28.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 2.0, 0.0, 7.0, 34.0, 0.0, 0.0, 29.0, 7.0, 0.0, 38.0, 18.0, 0.0, 25.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 32.0, 12.0, 2.0, 18.0, 0.0, 6.0, 0.0, 0.0, 30.0, 18.0, 0.0, 0.0, 0.0, 0.0, 39.0, 1.0, 8.0, 0.0, 17.0, 1.0, 34.0, 0.0, 28.0, 13.0, 0.0, 0.0, 10.0, 0.0, 1.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 118.0, 1.0, 14.0, 157.0, 58.0, 4.0, 0.0, 50.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9366592427850193, "mean_inference_ms": 4.714353582307355, "mean_action_processing_ms": 0.7190716186163811, "mean_env_wait_ms": 0.6371822950101422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008762359619140625, "StateBufferConnector_ms": 0.006945490837097168, "ViewRequirementAgentConnector_ms": 0.30089104175567627}, "num_episodes": 18, "episode_return_max": 280.0, "episode_return_min": -151.0, "episode_return_mean": 31.48, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.33537398537138, "num_env_steps_trained_throughput_per_sec": 204.33537398537138, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 114556.595, "restore_workers_time_ms": 0.036, "training_step_time_ms": 114556.487, "sample_time_ms": 4097.385, "learn_time_ms": 110431.046, "learn_throughput": 36.222, "synch_weights_time_ms": 22.221}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "4f45b_00000", "date": "2024-08-13_01-37-41", "timestamp": 1723527461, "time_this_iter_s": 19.712334871292114, "time_total_s": 1197.9668371677399, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c38430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1197.9668371677399, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 85.91428571428571, "ram_util_percent": 83.51785714285712}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45942731546583, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.746066384466868, "policy_loss": -0.0030242677897500693, "vf_loss": 4.7489963761082405, "vf_explained_var": 0.001674165580638502, "kl": 0.015085402771586376, "entropy": 1.479420823331863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6901553697765819, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.328856936712113, "policy_loss": -0.0017063184551372335, "vf_loss": 7.3305366483314955, "vf_explained_var": 0.046210147874065174, "kl": 0.008511276613495457, "entropy": 1.4764359481120235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 280.0, "episode_reward_min": -225.0, "episode_reward_mean": 34.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -322.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 175.0, "predator_policy": 171.0}, "policy_reward_mean": {"prey_policy": -2.17, "predator_policy": 19.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 45.0, 58.0, 45.0, 61.0, 114.0, -91.0, 95.0, -38.0, 30.0, 35.0, -42.0, 82.0, 29.0, 33.0, 38.0, -108.0, -91.0, 30.0, -48.0, 7.0, -1.0, 52.0, -9.0, 122.0, 85.0, -25.0, 0.0, 34.0, -6.0, 0.0, 0.0, -4.0, -17.0, -17.0, 8.0, -1.0, 118.0, -2.0, 17.0, 51.0, 124.0, 73.0, -26.0, 92.0, 69.0, 82.0, 4.0, 101.0, 53.0, 37.0, 67.0, -47.0, 0.0, 280.0, 108.0, 140.0, 26.0, -34.0, 88.0, 42.0, -5.0, -1.0, 183.0, 0.0, 78.0, 158.0, 0.0, -59.0, 171.0, -151.0, 179.0, -36.0, 73.0, -28.0, 123.0, 62.0, 151.0, -2.0, -28.0, 232.0, 39.0, 0.0, -225.0, 100.0, 106.0, 11.0, -58.0, 121.0, 26.0, 94.0, 125.0, -117.0, 62.0, -7.0, 13.0, -63.0, -8.0, 32.0, 128.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 65.0, -46.0, 39.0, 6.0, 9.0, 29.0, 52.0, 9.0, 0.0, 114.0, -202.0, 8.0, 95.0, 0.0, -120.0, -4.0, -25.0, 37.0, 0.0, 31.0, -95.0, 0.0, 42.0, 17.0, -92.0, 57.0, 56.0, -46.0, 3.0, 24.0, -281.0, 4.0, -49.0, -115.0, 0.0, 30.0, -95.0, -29.0, 7.0, 0.0, -7.0, 0.0, 39.0, -33.0, -44.0, 0.0, 0.0, 122.0, 34.0, 33.0, -118.0, 3.0, 0.0, 0.0, 0.0, 31.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -34.0, 0.0, 0.0, -67.0, 8.0, 0.0, 0.0, -2.0, 37.0, 75.0, -4.0, 0.0, -38.0, 14.0, 0.0, 51.0, 0.0, 88.0, 0.0, 35.0, -8.0, -36.0, 0.0, 39.0, 0.0, 69.0, 82.0, 0.0, 0.0, -14.0, 119.0, -62.0, 21.0, 12.0, 0.0, 31.0, 0.0, 67.0, -36.0, -59.0, 0.0, 0.0, 170.0, 110.0, 68.0, 0.0, 35.0, 97.0, 8.0, 0.0, -14.0, -54.0, -12.0, 59.0, 0.0, 42.0, 0.0, -15.0, 0.0, -2.0, 17.0, 153.0, 0.0, 0.0, 0.0, 78.0, 171.0, -26.0, 0.0, 0.0, -51.0, -126.0, 156.0, 0.0, -288.0, -78.0, 175.0, 0.0, 0.0, -86.0, 0.0, 56.0, 25.0, -134.0, 118.0, 0.0, -38.0, 72.0, 113.0, 38.0, -99.0, -34.0, -57.0, 0.0, 107.0, 99.0, 76.0, -74.0, 0.0, 0.0, -74.0, -322.0, -32.0, 116.0, 39.0, -19.0, -234.0, 57.0, -286.0, 17.0, -39.0, 101.0, 39.0, -44.0, 35.0, 59.0, -12.0, 115.0, -66.0, -112.0, 112.0, -164.0, -61.0, 0.0, -148.0, 25.0, 0.0, -126.0, -148.0, 15.0, 35.0, -98.0, -154.0, 126.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 26.0, 0.0, 13.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 101.0, 0.0, 0.0, 59.0, 27.0, 2.0, 16.0, 4.0, 0.0, 53.0, 0.0, 1.0, 22.0, 0.0, 64.0, 0.0, 23.0, 11.0, 0.0, 169.0, 0.0, 73.0, 0.0, 0.0, 0.0, 2.0, 74.0, 0.0, 0.0, 6.0, 0.0, 46.0, 0.0, 0.0, 35.0, 0.0, 0.0, 18.0, 0.0, 21.0, 69.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 17.0, 22.0, 28.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 2.0, 0.0, 7.0, 34.0, 0.0, 0.0, 29.0, 7.0, 0.0, 38.0, 18.0, 0.0, 25.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 32.0, 12.0, 2.0, 18.0, 0.0, 6.0, 0.0, 0.0, 30.0, 18.0, 0.0, 0.0, 0.0, 0.0, 39.0, 1.0, 8.0, 0.0, 17.0, 1.0, 34.0, 0.0, 28.0, 13.0, 0.0, 0.0, 10.0, 0.0, 1.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 118.0, 1.0, 14.0, 157.0, 58.0, 4.0, 0.0, 50.0, 0.0, 0.0, 17.0, 18.0, 63.0, 0.0, 5.0, 28.0, 0.0, 0.0, 0.0, 91.0, 40.0, 0.0, 29.0, 0.0, 26.0, 37.0, 0.0, 0.0, 0.0, 0.0, 171.0, 16.0, 0.0, 39.0, 47.0, 61.0, 127.0, 60.0, 151.0, 4.0, 55.0, 13.0, 18.0, 0.0, 0.0, 2.0, 20.0, 5.0, 56.0, 113.0, 1.0, 47.0, 7.0, 108.0, 28.0, 63.0, 0.0, 51.0, 74.0, 42.0, 53.0, 50.0, 106.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8729523338374003, "mean_inference_ms": 4.575981546335286, "mean_action_processing_ms": 0.6983082496565338, "mean_env_wait_ms": 0.6183345261615811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008458852767944336, "StateBufferConnector_ms": 0.005862593650817871, "ViewRequirementAgentConnector_ms": 0.2808161973953247}, "num_episodes": 27, "episode_return_max": 280.0, "episode_return_min": -225.0, "episode_return_mean": 34.47, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 176.57443625966462, "num_env_steps_trained_throughput_per_sec": 176.57443625966462, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 113309.628, "restore_workers_time_ms": 0.033, "training_step_time_ms": 113309.525, "sample_time_ms": 3235.034, "learn_time_ms": 110047.475, "learn_throughput": 36.348, "synch_weights_time_ms": 22.129}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "4f45b_00000", "date": "2024-08-13_01-38-04", "timestamp": 1723527484, "time_this_iter_s": 22.720139980316162, "time_total_s": 1220.686977148056, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cad160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1220.686977148056, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 86.940625, "ram_util_percent": 83.540625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3011683588502584, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.95114316196038, "policy_loss": -0.002934989636325371, "vf_loss": 3.9539906605210886, "vf_explained_var": -0.0007780529519237538, "kl": 0.013999488382626348, "entropy": 1.4336909680139451, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.646656175241584, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.435534563266411, "policy_loss": -0.0031171758617299103, "vf_loss": 6.438628366258409, "vf_explained_var": 0.03854939064020833, "kl": 0.007480418951162277, "entropy": 1.5001269624977516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 280.0, "episode_reward_min": -225.0, "episode_reward_mean": 34.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -444.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 175.0, "predator_policy": 243.0}, "policy_reward_mean": {"prey_policy": -8.235, "predator_policy": 25.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, -48.0, 7.0, -1.0, 52.0, -9.0, 122.0, 85.0, -25.0, 0.0, 34.0, -6.0, 0.0, 0.0, -4.0, -17.0, -17.0, 8.0, -1.0, 118.0, -2.0, 17.0, 51.0, 124.0, 73.0, -26.0, 92.0, 69.0, 82.0, 4.0, 101.0, 53.0, 37.0, 67.0, -47.0, 0.0, 280.0, 108.0, 140.0, 26.0, -34.0, 88.0, 42.0, -5.0, -1.0, 183.0, 0.0, 78.0, 158.0, 0.0, -59.0, 171.0, -151.0, 179.0, -36.0, 73.0, -28.0, 123.0, 62.0, 151.0, -2.0, -28.0, 232.0, 39.0, 0.0, -225.0, 100.0, 106.0, 11.0, -58.0, 121.0, 26.0, 94.0, 125.0, -117.0, 62.0, -7.0, 13.0, -63.0, -8.0, 32.0, 128.0, -35.0, 2.0, -92.0, -14.0, -39.0, -2.0, 48.0, 115.0, -7.0, 0.0, 99.0, 63.0, 30.0, -1.0, 20.0, -44.0, 176.0, 14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 30.0, -95.0, -29.0, 7.0, 0.0, -7.0, 0.0, 39.0, -33.0, -44.0, 0.0, 0.0, 122.0, 34.0, 33.0, -118.0, 3.0, 0.0, 0.0, 0.0, 31.0, -14.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -34.0, 0.0, 0.0, -67.0, 8.0, 0.0, 0.0, -2.0, 37.0, 75.0, -4.0, 0.0, -38.0, 14.0, 0.0, 51.0, 0.0, 88.0, 0.0, 35.0, -8.0, -36.0, 0.0, 39.0, 0.0, 69.0, 82.0, 0.0, 0.0, -14.0, 119.0, -62.0, 21.0, 12.0, 0.0, 31.0, 0.0, 67.0, -36.0, -59.0, 0.0, 0.0, 170.0, 110.0, 68.0, 0.0, 35.0, 97.0, 8.0, 0.0, -14.0, -54.0, -12.0, 59.0, 0.0, 42.0, 0.0, -15.0, 0.0, -2.0, 17.0, 153.0, 0.0, 0.0, 0.0, 78.0, 171.0, -26.0, 0.0, 0.0, -51.0, -126.0, 156.0, 0.0, -288.0, -78.0, 175.0, 0.0, 0.0, -86.0, 0.0, 56.0, 25.0, -134.0, 118.0, 0.0, -38.0, 72.0, 113.0, 38.0, -99.0, -34.0, -57.0, 0.0, 107.0, 99.0, 76.0, -74.0, 0.0, 0.0, -74.0, -322.0, -32.0, 116.0, 39.0, -19.0, -234.0, 57.0, -286.0, 17.0, -39.0, 101.0, 39.0, -44.0, 35.0, 59.0, -12.0, 115.0, -66.0, -112.0, 112.0, -164.0, -61.0, 0.0, -148.0, 25.0, 0.0, -126.0, -148.0, 15.0, 35.0, -98.0, -154.0, 126.0, -400.0, 29.0, 37.0, -444.0, -183.0, -55.0, -30.0, 0.0, -268.0, -6.0, -144.0, 8.0, 18.0, 4.0, 54.0, 56.0, -59.0, -68.0, 0.0, 0.0, 40.0, 59.0, -36.0, 81.0, 72.0, -134.0, -276.0, 50.0, 62.0, -84.0, -118.0, 0.0, 55.0, 108.0, 14.0, -33.0], "policy_predator_policy_reward": [0.0, 0.0, 2.0, 74.0, 0.0, 0.0, 6.0, 0.0, 46.0, 0.0, 0.0, 35.0, 0.0, 0.0, 18.0, 0.0, 21.0, 69.0, 0.0, 0.0, 0.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 17.0, 22.0, 28.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 2.0, 0.0, 7.0, 34.0, 0.0, 0.0, 29.0, 7.0, 0.0, 38.0, 18.0, 0.0, 25.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 32.0, 12.0, 2.0, 18.0, 0.0, 6.0, 0.0, 0.0, 30.0, 18.0, 0.0, 0.0, 0.0, 0.0, 39.0, 1.0, 8.0, 0.0, 17.0, 1.0, 34.0, 0.0, 28.0, 13.0, 0.0, 0.0, 10.0, 0.0, 1.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 118.0, 1.0, 14.0, 157.0, 58.0, 4.0, 0.0, 50.0, 0.0, 0.0, 17.0, 18.0, 63.0, 0.0, 5.0, 28.0, 0.0, 0.0, 0.0, 91.0, 40.0, 0.0, 29.0, 0.0, 26.0, 37.0, 0.0, 0.0, 0.0, 0.0, 171.0, 16.0, 0.0, 39.0, 47.0, 61.0, 127.0, 60.0, 151.0, 4.0, 55.0, 13.0, 18.0, 0.0, 0.0, 2.0, 20.0, 5.0, 56.0, 113.0, 1.0, 47.0, 7.0, 108.0, 28.0, 63.0, 0.0, 51.0, 74.0, 42.0, 53.0, 50.0, 106.0, 122.0, 214.0, 166.0, 243.0, 113.0, 33.0, 15.0, 1.0, 170.0, 65.0, 69.0, 65.0, 0.0, 26.0, 0.0, 5.0, 64.0, 56.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 92.0, 118.0, 107.0, 42.0, 0.0, 54.0, 20.0, 13.0, 0.0, 33.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8433686993656948, "mean_inference_ms": 4.493158070183828, "mean_action_processing_ms": 0.6904583177355502, "mean_env_wait_ms": 0.6106589043833476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008040904998779297, "StateBufferConnector_ms": 0.00496828556060791, "ViewRequirementAgentConnector_ms": 0.2892453670501709}, "num_episodes": 18, "episode_return_max": 280.0, "episode_return_min": -225.0, "episode_return_mean": 34.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 186.01190520737157, "num_env_steps_trained_throughput_per_sec": 186.01190520737157, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 113651.271, "restore_workers_time_ms": 0.022, "training_step_time_ms": 113651.183, "sample_time_ms": 3198.952, "learn_time_ms": 110426.329, "learn_throughput": 36.223, "synch_weights_time_ms": 21.158}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "4f45b_00000", "date": "2024-08-13_01-38-26", "timestamp": 1723527506, "time_this_iter_s": 21.556363821029663, "time_total_s": 1242.2433409690857, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cadd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1242.2433409690857, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 86.43666666666667, "ram_util_percent": 82.76666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.3455597282618915, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8490355382520687, "policy_loss": -0.001099051251544287, "vf_loss": 1.8500872573839924, "vf_explained_var": 0.004992613685194147, "kl": 0.007573267376229553, "entropy": 1.3836638642997339, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1188712620151735, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.302311179499147, "policy_loss": -0.006360289069981605, "vf_loss": 6.308641925942961, "vf_explained_var": 0.09209158130423732, "kl": 0.009454287129976802, "entropy": 1.4496069951662942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 280.0, "episode_reward_min": -225.0, "episode_reward_mean": 46.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -444.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 175.0, "predator_policy": 243.0}, "policy_reward_mean": {"prey_policy": -3.115, "predator_policy": 26.445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 118.0, -2.0, 17.0, 51.0, 124.0, 73.0, -26.0, 92.0, 69.0, 82.0, 4.0, 101.0, 53.0, 37.0, 67.0, -47.0, 0.0, 280.0, 108.0, 140.0, 26.0, -34.0, 88.0, 42.0, -5.0, -1.0, 183.0, 0.0, 78.0, 158.0, 0.0, -59.0, 171.0, -151.0, 179.0, -36.0, 73.0, -28.0, 123.0, 62.0, 151.0, -2.0, -28.0, 232.0, 39.0, 0.0, -225.0, 100.0, 106.0, 11.0, -58.0, 121.0, 26.0, 94.0, 125.0, -117.0, 62.0, -7.0, 13.0, -63.0, -8.0, 32.0, 128.0, -35.0, 2.0, -92.0, -14.0, -39.0, -2.0, 48.0, 115.0, -7.0, 0.0, 99.0, 63.0, 30.0, -1.0, 20.0, -44.0, 176.0, 14.0, 50.0, 12.0, -8.0, 115.0, -2.0, 18.0, 222.0, 95.0, 118.0, 96.0, 165.0, 10.0, 81.0, 41.0, 102.0, 172.0, 97.0, 8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -2.0, 37.0, 75.0, -4.0, 0.0, -38.0, 14.0, 0.0, 51.0, 0.0, 88.0, 0.0, 35.0, -8.0, -36.0, 0.0, 39.0, 0.0, 69.0, 82.0, 0.0, 0.0, -14.0, 119.0, -62.0, 21.0, 12.0, 0.0, 31.0, 0.0, 67.0, -36.0, -59.0, 0.0, 0.0, 170.0, 110.0, 68.0, 0.0, 35.0, 97.0, 8.0, 0.0, -14.0, -54.0, -12.0, 59.0, 0.0, 42.0, 0.0, -15.0, 0.0, -2.0, 17.0, 153.0, 0.0, 0.0, 0.0, 78.0, 171.0, -26.0, 0.0, 0.0, -51.0, -126.0, 156.0, 0.0, -288.0, -78.0, 175.0, 0.0, 0.0, -86.0, 0.0, 56.0, 25.0, -134.0, 118.0, 0.0, -38.0, 72.0, 113.0, 38.0, -99.0, -34.0, -57.0, 0.0, 107.0, 99.0, 76.0, -74.0, 0.0, 0.0, -74.0, -322.0, -32.0, 116.0, 39.0, -19.0, -234.0, 57.0, -286.0, 17.0, -39.0, 101.0, 39.0, -44.0, 35.0, 59.0, -12.0, 115.0, -66.0, -112.0, 112.0, -164.0, -61.0, 0.0, -148.0, 25.0, 0.0, -126.0, -148.0, 15.0, 35.0, -98.0, -154.0, 126.0, -400.0, 29.0, 37.0, -444.0, -183.0, -55.0, -30.0, 0.0, -268.0, -6.0, -144.0, 8.0, 18.0, 4.0, 54.0, 56.0, -59.0, -68.0, 0.0, 0.0, 40.0, 59.0, -36.0, 81.0, 72.0, -134.0, -276.0, 50.0, 62.0, -84.0, -118.0, 0.0, 55.0, 108.0, 14.0, -33.0, -32.0, 52.0, 0.0, 12.0, 26.0, -68.0, 67.0, 46.0, 0.0, -72.0, 56.0, -76.0, 145.0, 77.0, 32.0, 63.0, 38.0, 62.0, 48.0, 44.0, 80.0, 37.0, 0.0, -29.0, 33.0, 30.0, 4.0, 10.0, 80.0, 13.0, 95.0, 77.0, -3.0, 89.0, 50.0, -206.0], "policy_predator_policy_reward": [0.0, 1.0, 0.0, 6.0, 2.0, 0.0, 7.0, 34.0, 0.0, 0.0, 29.0, 7.0, 0.0, 38.0, 18.0, 0.0, 25.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 32.0, 12.0, 2.0, 18.0, 0.0, 6.0, 0.0, 0.0, 30.0, 18.0, 0.0, 0.0, 0.0, 0.0, 39.0, 1.0, 8.0, 0.0, 17.0, 1.0, 34.0, 0.0, 28.0, 13.0, 0.0, 0.0, 10.0, 0.0, 1.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 118.0, 1.0, 14.0, 157.0, 58.0, 4.0, 0.0, 50.0, 0.0, 0.0, 17.0, 18.0, 63.0, 0.0, 5.0, 28.0, 0.0, 0.0, 0.0, 91.0, 40.0, 0.0, 29.0, 0.0, 26.0, 37.0, 0.0, 0.0, 0.0, 0.0, 171.0, 16.0, 0.0, 39.0, 47.0, 61.0, 127.0, 60.0, 151.0, 4.0, 55.0, 13.0, 18.0, 0.0, 0.0, 2.0, 20.0, 5.0, 56.0, 113.0, 1.0, 47.0, 7.0, 108.0, 28.0, 63.0, 0.0, 51.0, 74.0, 42.0, 53.0, 50.0, 106.0, 122.0, 214.0, 166.0, 243.0, 113.0, 33.0, 15.0, 1.0, 170.0, 65.0, 69.0, 65.0, 0.0, 26.0, 0.0, 5.0, 64.0, 56.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 92.0, 118.0, 107.0, 42.0, 0.0, 54.0, 20.0, 13.0, 0.0, 33.0, 0.0, 30.0, 0.0, 0.0, 0.0, 34.0, 0.0, 2.0, 0.0, 0.0, 70.0, 22.0, 16.0, 0.0, 0.0, 0.0, 0.0, 16.0, 2.0, 1.0, 3.0, 38.0, 10.0, 21.0, 18.0, 9.0, 9.0, 14.0, 13.0, 2.0, 7.0, 0.0, 0.0, 11.0, 0.0, 93.0, 71.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8178110719103728, "mean_inference_ms": 4.439619377051771, "mean_action_processing_ms": 0.6847707951882467, "mean_env_wait_ms": 0.6047500094852307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009654641151428223, "StateBufferConnector_ms": 0.010298490524291992, "ViewRequirementAgentConnector_ms": 0.2998694181442261}, "num_episodes": 18, "episode_return_max": 280.0, "episode_return_min": -225.0, "episode_return_mean": 46.66, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.1016835730194, "num_env_steps_trained_throughput_per_sec": 161.1016835730194, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 21459.219, "restore_workers_time_ms": 0.022, "training_step_time_ms": 21459.132, "sample_time_ms": 3297.052, "learn_time_ms": 18138.272, "learn_throughput": 220.528, "synch_weights_time_ms": 19.531}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "4f45b_00000", "date": "2024-08-13_01-38-51", "timestamp": 1723527531, "time_this_iter_s": 24.897316932678223, "time_total_s": 1267.140657901764, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cadf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1267.140657901764, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 86.85999999999999, "ram_util_percent": 83.66571428571427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.35205900550046293, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3029325873763473, "policy_loss": -0.002442392813061517, "vf_loss": 3.305301970905728, "vf_explained_var": 0.008659632117659957, "kl": 0.011681079850001287, "entropy": 1.3779258728027344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0327109066818756, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.734614147963347, "policy_loss": -0.0032318583174692416, "vf_loss": 7.73781934263845, "vf_explained_var": 0.09770478836443058, "kl": 0.008531047864949801, "entropy": 1.3821607368963735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 280.0, "episode_reward_min": -225.0, "episode_reward_mean": 52.48, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -444.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 175.0, "predator_policy": 243.0}, "policy_reward_mean": {"prey_policy": -2.37, "predator_policy": 28.61}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.0, 108.0, 140.0, 26.0, -34.0, 88.0, 42.0, -5.0, -1.0, 183.0, 0.0, 78.0, 158.0, 0.0, -59.0, 171.0, -151.0, 179.0, -36.0, 73.0, -28.0, 123.0, 62.0, 151.0, -2.0, -28.0, 232.0, 39.0, 0.0, -225.0, 100.0, 106.0, 11.0, -58.0, 121.0, 26.0, 94.0, 125.0, -117.0, 62.0, -7.0, 13.0, -63.0, -8.0, 32.0, 128.0, -35.0, 2.0, -92.0, -14.0, -39.0, -2.0, 48.0, 115.0, -7.0, 0.0, 99.0, 63.0, 30.0, -1.0, 20.0, -44.0, 176.0, 14.0, 50.0, 12.0, -8.0, 115.0, -2.0, 18.0, 222.0, 95.0, 118.0, 96.0, 165.0, 10.0, 81.0, 41.0, 102.0, 172.0, 97.0, 8.0, 87.0, -29.0, 133.0, 163.0, 65.0, 0.0, 82.0, 95.0, 98.0, -19.0, 88.0, 163.0, 219.0, 117.0, 70.0, 46.0, 35.0, -19.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [170.0, 110.0, 68.0, 0.0, 35.0, 97.0, 8.0, 0.0, -14.0, -54.0, -12.0, 59.0, 0.0, 42.0, 0.0, -15.0, 0.0, -2.0, 17.0, 153.0, 0.0, 0.0, 0.0, 78.0, 171.0, -26.0, 0.0, 0.0, -51.0, -126.0, 156.0, 0.0, -288.0, -78.0, 175.0, 0.0, 0.0, -86.0, 0.0, 56.0, 25.0, -134.0, 118.0, 0.0, -38.0, 72.0, 113.0, 38.0, -99.0, -34.0, -57.0, 0.0, 107.0, 99.0, 76.0, -74.0, 0.0, 0.0, -74.0, -322.0, -32.0, 116.0, 39.0, -19.0, -234.0, 57.0, -286.0, 17.0, -39.0, 101.0, 39.0, -44.0, 35.0, 59.0, -12.0, 115.0, -66.0, -112.0, 112.0, -164.0, -61.0, 0.0, -148.0, 25.0, 0.0, -126.0, -148.0, 15.0, 35.0, -98.0, -154.0, 126.0, -400.0, 29.0, 37.0, -444.0, -183.0, -55.0, -30.0, 0.0, -268.0, -6.0, -144.0, 8.0, 18.0, 4.0, 54.0, 56.0, -59.0, -68.0, 0.0, 0.0, 40.0, 59.0, -36.0, 81.0, 72.0, -134.0, -276.0, 50.0, 62.0, -84.0, -118.0, 0.0, 55.0, 108.0, 14.0, -33.0, -32.0, 52.0, 0.0, 12.0, 26.0, -68.0, 67.0, 46.0, 0.0, -72.0, 56.0, -76.0, 145.0, 77.0, 32.0, 63.0, 38.0, 62.0, 48.0, 44.0, 80.0, 37.0, 0.0, -29.0, 33.0, 30.0, 4.0, 10.0, 80.0, 13.0, 95.0, 77.0, -3.0, 89.0, 50.0, -206.0, 50.0, -14.0, 62.0, -196.0, 50.0, 72.0, 49.0, 67.0, -117.0, 77.0, -27.0, -55.0, 58.0, 24.0, 12.0, 83.0, 0.0, 84.0, -60.0, 6.0, 47.0, 0.0, 79.0, 66.0, 148.0, 71.0, 23.0, 4.0, 45.0, 0.0, 19.0, -2.0, 4.0, 0.0, -7.0, -92.0], "policy_predator_policy_reward": [0.0, 0.0, 39.0, 1.0, 8.0, 0.0, 17.0, 1.0, 34.0, 0.0, 28.0, 13.0, 0.0, 0.0, 10.0, 0.0, 1.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 118.0, 1.0, 14.0, 157.0, 58.0, 4.0, 0.0, 50.0, 0.0, 0.0, 17.0, 18.0, 63.0, 0.0, 5.0, 28.0, 0.0, 0.0, 0.0, 91.0, 40.0, 0.0, 29.0, 0.0, 26.0, 37.0, 0.0, 0.0, 0.0, 0.0, 171.0, 16.0, 0.0, 39.0, 47.0, 61.0, 127.0, 60.0, 151.0, 4.0, 55.0, 13.0, 18.0, 0.0, 0.0, 2.0, 20.0, 5.0, 56.0, 113.0, 1.0, 47.0, 7.0, 108.0, 28.0, 63.0, 0.0, 51.0, 74.0, 42.0, 53.0, 50.0, 106.0, 122.0, 214.0, 166.0, 243.0, 113.0, 33.0, 15.0, 1.0, 170.0, 65.0, 69.0, 65.0, 0.0, 26.0, 0.0, 5.0, 64.0, 56.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 92.0, 118.0, 107.0, 42.0, 0.0, 54.0, 20.0, 13.0, 0.0, 33.0, 0.0, 30.0, 0.0, 0.0, 0.0, 34.0, 0.0, 2.0, 0.0, 0.0, 70.0, 22.0, 16.0, 0.0, 0.0, 0.0, 0.0, 16.0, 2.0, 1.0, 3.0, 38.0, 10.0, 21.0, 18.0, 9.0, 9.0, 14.0, 13.0, 2.0, 7.0, 0.0, 0.0, 11.0, 0.0, 93.0, 71.0, 0.0, 51.0, 2.0, 103.0, 0.0, 11.0, 47.0, 0.0, 68.0, 37.0, 82.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 33.0, 2.0, 26.0, 15.0, 0.0, 18.0, 0.0, 0.0, 49.0, 41.0, 0.0, 25.0, 13.0, 16.0, 9.0, 22.0, 80.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7936603926822061, "mean_inference_ms": 4.37928034404516, "mean_action_processing_ms": 0.6777038192718237, "mean_env_wait_ms": 0.598644307067811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008763670921325684, "StateBufferConnector_ms": 0.010659217834472656, "ViewRequirementAgentConnector_ms": 0.34439730644226074}, "num_episodes": 18, "episode_return_max": 280.0, "episode_return_min": -225.0, "episode_return_mean": 52.48, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.9311279192072, "num_env_steps_trained_throughput_per_sec": 170.9311279192072, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 20690.423, "restore_workers_time_ms": 0.023, "training_step_time_ms": 20690.36, "sample_time_ms": 3184.4, "learn_time_ms": 17482.978, "learn_throughput": 228.794, "synch_weights_time_ms": 19.484}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "4f45b_00000", "date": "2024-08-13_01-39-14", "timestamp": 1723527554, "time_this_iter_s": 23.457228899002075, "time_total_s": 1290.597886800766, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c32e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1290.597886800766, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 86.34242424242424, "ram_util_percent": 83.56060606060606}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5301150086734976, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6765555472601026, "policy_loss": -0.004372476201465048, "vf_loss": 3.6808187772357273, "vf_explained_var": 0.02528363721711295, "kl": 0.01748068873695533, "entropy": 1.344052347115108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.802514914340443, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.742718960494591, "policy_loss": -0.004533349268049712, "vf_loss": 7.747213566492475, "vf_explained_var": 0.08721556922115346, "kl": 0.012395947261578612, "entropy": 1.3150816517532187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 336.0, "episode_reward_min": -225.0, "episode_reward_mean": 60.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -444.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.0, "predator_policy": 243.0}, "policy_reward_mean": {"prey_policy": -2.16, "predator_policy": 32.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [62.0, 151.0, -2.0, -28.0, 232.0, 39.0, 0.0, -225.0, 100.0, 106.0, 11.0, -58.0, 121.0, 26.0, 94.0, 125.0, -117.0, 62.0, -7.0, 13.0, -63.0, -8.0, 32.0, 128.0, -35.0, 2.0, -92.0, -14.0, -39.0, -2.0, 48.0, 115.0, -7.0, 0.0, 99.0, 63.0, 30.0, -1.0, 20.0, -44.0, 176.0, 14.0, 50.0, 12.0, -8.0, 115.0, -2.0, 18.0, 222.0, 95.0, 118.0, 96.0, 165.0, 10.0, 81.0, 41.0, 102.0, 172.0, 97.0, 8.0, 87.0, -29.0, 133.0, 163.0, 65.0, 0.0, 82.0, 95.0, 98.0, -19.0, 88.0, 163.0, 219.0, 117.0, 70.0, 46.0, 35.0, -19.0, 101.0, 64.0, 69.0, 8.0, 336.0, 146.0, 187.0, 182.0, 257.0, 162.0, -34.0, 17.0, 44.0, -48.0, -33.0, 133.0, 149.0, 146.0, 123.0, 49.0, 155.0, -33.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-38.0, 72.0, 113.0, 38.0, -99.0, -34.0, -57.0, 0.0, 107.0, 99.0, 76.0, -74.0, 0.0, 0.0, -74.0, -322.0, -32.0, 116.0, 39.0, -19.0, -234.0, 57.0, -286.0, 17.0, -39.0, 101.0, 39.0, -44.0, 35.0, 59.0, -12.0, 115.0, -66.0, -112.0, 112.0, -164.0, -61.0, 0.0, -148.0, 25.0, 0.0, -126.0, -148.0, 15.0, 35.0, -98.0, -154.0, 126.0, -400.0, 29.0, 37.0, -444.0, -183.0, -55.0, -30.0, 0.0, -268.0, -6.0, -144.0, 8.0, 18.0, 4.0, 54.0, 56.0, -59.0, -68.0, 0.0, 0.0, 40.0, 59.0, -36.0, 81.0, 72.0, -134.0, -276.0, 50.0, 62.0, -84.0, -118.0, 0.0, 55.0, 108.0, 14.0, -33.0, -32.0, 52.0, 0.0, 12.0, 26.0, -68.0, 67.0, 46.0, 0.0, -72.0, 56.0, -76.0, 145.0, 77.0, 32.0, 63.0, 38.0, 62.0, 48.0, 44.0, 80.0, 37.0, 0.0, -29.0, 33.0, 30.0, 4.0, 10.0, 80.0, 13.0, 95.0, 77.0, -3.0, 89.0, 50.0, -206.0, 50.0, -14.0, 62.0, -196.0, 50.0, 72.0, 49.0, 67.0, -117.0, 77.0, -27.0, -55.0, 58.0, 24.0, 12.0, 83.0, 0.0, 84.0, -60.0, 6.0, 47.0, 0.0, 79.0, 66.0, 148.0, 71.0, 23.0, 4.0, 45.0, 0.0, 19.0, -2.0, 4.0, 0.0, -7.0, -92.0, 77.0, -90.0, 24.0, 12.0, -74.0, 6.0, -268.0, 44.0, 142.0, 191.0, 79.0, 13.0, 57.0, 74.0, 50.0, 98.0, 99.0, 152.0, 143.0, 19.0, -167.0, 1.0, -140.0, 19.0, -94.0, 90.0, -135.0, 0.0, -74.0, -39.0, 11.0, 83.0, 30.0, 61.0, 0.0, 146.0, -60.0, 141.0, -182.0, 125.0, 25.0, 117.0, -107.0, -5.0], "policy_predator_policy_reward": [28.0, 0.0, 0.0, 0.0, 91.0, 40.0, 0.0, 29.0, 0.0, 26.0, 37.0, 0.0, 0.0, 0.0, 0.0, 171.0, 16.0, 0.0, 39.0, 47.0, 61.0, 127.0, 60.0, 151.0, 4.0, 55.0, 13.0, 18.0, 0.0, 0.0, 2.0, 20.0, 5.0, 56.0, 113.0, 1.0, 47.0, 7.0, 108.0, 28.0, 63.0, 0.0, 51.0, 74.0, 42.0, 53.0, 50.0, 106.0, 122.0, 214.0, 166.0, 243.0, 113.0, 33.0, 15.0, 1.0, 170.0, 65.0, 69.0, 65.0, 0.0, 26.0, 0.0, 5.0, 64.0, 56.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 92.0, 118.0, 107.0, 42.0, 0.0, 54.0, 20.0, 13.0, 0.0, 33.0, 0.0, 30.0, 0.0, 0.0, 0.0, 34.0, 0.0, 2.0, 0.0, 0.0, 70.0, 22.0, 16.0, 0.0, 0.0, 0.0, 0.0, 16.0, 2.0, 1.0, 3.0, 38.0, 10.0, 21.0, 18.0, 9.0, 9.0, 14.0, 13.0, 2.0, 7.0, 0.0, 0.0, 11.0, 0.0, 93.0, 71.0, 0.0, 51.0, 2.0, 103.0, 0.0, 11.0, 47.0, 0.0, 68.0, 37.0, 82.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 33.0, 2.0, 26.0, 15.0, 0.0, 18.0, 0.0, 0.0, 49.0, 41.0, 0.0, 25.0, 13.0, 16.0, 9.0, 22.0, 80.0, 0.0, 43.0, 71.0, 28.0, 0.0, 75.0, 62.0, 155.0, 77.0, 0.0, 3.0, 37.0, 17.0, 2.0, 54.0, 0.0, 34.0, 0.0, 6.0, 0.0, 0.0, 91.0, 41.0, 134.0, 4.0, 0.0, 48.0, 9.0, 78.0, 75.0, 5.0, 0.0, 39.0, 52.0, 6.0, 0.0, 0.0, 24.0, 18.0, 43.0, 63.0, 0.0, 13.0, 60.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.771374633878915, "mean_inference_ms": 4.3269650992838, "mean_action_processing_ms": 0.6719508399412121, "mean_env_wait_ms": 0.5926067258099682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008996844291687012, "StateBufferConnector_ms": 0.010950326919555664, "ViewRequirementAgentConnector_ms": 0.3360414505004883}, "num_episodes": 22, "episode_return_max": 336.0, "episode_return_min": -225.0, "episode_return_mean": 60.93, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 180.1346593659009, "num_env_steps_trained_throughput_per_sec": 180.1346593659009, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 20962.93, "restore_workers_time_ms": 0.02, "training_step_time_ms": 20962.872, "sample_time_ms": 2906.286, "learn_time_ms": 18033.02, "learn_throughput": 221.815, "synch_weights_time_ms": 19.888}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "4f45b_00000", "date": "2024-08-13_01-39-36", "timestamp": 1723527576, "time_this_iter_s": 22.258234977722168, "time_total_s": 1312.8561217784882, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cd5430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1312.8561217784882, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 86.00645161290322, "ram_util_percent": 83.41935483870967}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.487142269892825, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.892791138502656, "policy_loss": -0.0022364576126660696, "vf_loss": 3.894962655930292, "vf_explained_var": 0.011377133074260894, "kl": 0.01039053524133002, "entropy": 1.4066007494926454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7148762631116723, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.26360411543064, "policy_loss": -0.004324934467495907, "vf_loss": 8.267886569512584, "vf_explained_var": 0.15809788401164707, "kl": 0.01359752818511933, "entropy": 1.2880047217878714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 387.0, "episode_reward_min": -92.0, "episode_reward_mean": 85.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -444.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 243.0}, "policy_reward_mean": {"prey_policy": 11.48, "predator_policy": 31.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [128.0, -35.0, 2.0, -92.0, -14.0, -39.0, -2.0, 48.0, 115.0, -7.0, 0.0, 99.0, 63.0, 30.0, -1.0, 20.0, -44.0, 176.0, 14.0, 50.0, 12.0, -8.0, 115.0, -2.0, 18.0, 222.0, 95.0, 118.0, 96.0, 165.0, 10.0, 81.0, 41.0, 102.0, 172.0, 97.0, 8.0, 87.0, -29.0, 133.0, 163.0, 65.0, 0.0, 82.0, 95.0, 98.0, -19.0, 88.0, 163.0, 219.0, 117.0, 70.0, 46.0, 35.0, -19.0, 101.0, 64.0, 69.0, 8.0, 336.0, 146.0, 187.0, 182.0, 257.0, 162.0, -34.0, 17.0, 44.0, -48.0, -33.0, 133.0, 149.0, 146.0, 123.0, 49.0, 155.0, -33.0, 288.0, -3.0, 30.0, 18.0, 295.0, 30.0, -14.0, 236.0, 268.0, -31.0, 248.0, 178.0, 209.0, 387.0, 97.0, 355.0, -9.0, 113.0, 63.0, -9.0, -16.0, 65.0, 281.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-154.0, 126.0, -400.0, 29.0, 37.0, -444.0, -183.0, -55.0, -30.0, 0.0, -268.0, -6.0, -144.0, 8.0, 18.0, 4.0, 54.0, 56.0, -59.0, -68.0, 0.0, 0.0, 40.0, 59.0, -36.0, 81.0, 72.0, -134.0, -276.0, 50.0, 62.0, -84.0, -118.0, 0.0, 55.0, 108.0, 14.0, -33.0, -32.0, 52.0, 0.0, 12.0, 26.0, -68.0, 67.0, 46.0, 0.0, -72.0, 56.0, -76.0, 145.0, 77.0, 32.0, 63.0, 38.0, 62.0, 48.0, 44.0, 80.0, 37.0, 0.0, -29.0, 33.0, 30.0, 4.0, 10.0, 80.0, 13.0, 95.0, 77.0, -3.0, 89.0, 50.0, -206.0, 50.0, -14.0, 62.0, -196.0, 50.0, 72.0, 49.0, 67.0, -117.0, 77.0, -27.0, -55.0, 58.0, 24.0, 12.0, 83.0, 0.0, 84.0, -60.0, 6.0, 47.0, 0.0, 79.0, 66.0, 148.0, 71.0, 23.0, 4.0, 45.0, 0.0, 19.0, -2.0, 4.0, 0.0, -7.0, -92.0, 77.0, -90.0, 24.0, 12.0, -74.0, 6.0, -268.0, 44.0, 142.0, 191.0, 79.0, 13.0, 57.0, 74.0, 50.0, 98.0, 99.0, 152.0, 143.0, 19.0, -167.0, 1.0, -140.0, 19.0, -94.0, 90.0, -135.0, 0.0, -74.0, -39.0, 11.0, 83.0, 30.0, 61.0, 0.0, 146.0, -60.0, 141.0, -182.0, 125.0, 25.0, 117.0, -107.0, -5.0, 172.0, 79.0, 0.0, -74.0, -38.0, 8.0, 0.0, 0.0, 193.0, 102.0, -88.0, 40.0, -89.0, 6.0, 131.0, 59.0, 80.0, 125.0, -5.0, -221.0, 100.0, 107.0, -8.0, 155.0, -50.0, 158.0, 194.0, 189.0, -43.0, 51.0, 151.0, 199.0, -8.0, -6.0, 113.0, 0.0, -120.0, 123.0, -23.0, -161.0, 0.0, -73.0, -198.0, 141.0, 114.0, 126.0], "policy_predator_policy_reward": [50.0, 106.0, 122.0, 214.0, 166.0, 243.0, 113.0, 33.0, 15.0, 1.0, 170.0, 65.0, 69.0, 65.0, 0.0, 26.0, 0.0, 5.0, 64.0, 56.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 0.0, 92.0, 118.0, 107.0, 42.0, 0.0, 54.0, 20.0, 13.0, 0.0, 33.0, 0.0, 30.0, 0.0, 0.0, 0.0, 34.0, 0.0, 2.0, 0.0, 0.0, 70.0, 22.0, 16.0, 0.0, 0.0, 0.0, 0.0, 16.0, 2.0, 1.0, 3.0, 38.0, 10.0, 21.0, 18.0, 9.0, 9.0, 14.0, 13.0, 2.0, 7.0, 0.0, 0.0, 11.0, 0.0, 93.0, 71.0, 0.0, 51.0, 2.0, 103.0, 0.0, 11.0, 47.0, 0.0, 68.0, 37.0, 82.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 33.0, 2.0, 26.0, 15.0, 0.0, 18.0, 0.0, 0.0, 49.0, 41.0, 0.0, 25.0, 13.0, 16.0, 9.0, 22.0, 80.0, 0.0, 43.0, 71.0, 28.0, 0.0, 75.0, 62.0, 155.0, 77.0, 0.0, 3.0, 37.0, 17.0, 2.0, 54.0, 0.0, 34.0, 0.0, 6.0, 0.0, 0.0, 91.0, 41.0, 134.0, 4.0, 0.0, 48.0, 9.0, 78.0, 75.0, 5.0, 0.0, 39.0, 52.0, 6.0, 0.0, 0.0, 24.0, 18.0, 43.0, 63.0, 0.0, 13.0, 60.0, 19.0, 37.0, 0.0, 71.0, 0.0, 8.0, 52.0, 0.0, 18.0, 0.0, 0.0, 0.0, 78.0, 65.0, 4.0, 0.0, 46.0, 2.0, 61.0, 96.0, 99.0, 40.0, 1.0, 0.0, 31.0, 69.0, 32.0, 0.0, 4.0, 72.0, 17.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 60.0, 40.0, 135.0, 57.0, 0.0, 34.0, 88.0, 15.0, 26.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7609239774458112, "mean_inference_ms": 4.296274924359222, "mean_action_processing_ms": 0.668017052969346, "mean_env_wait_ms": 0.5907478900066592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012377619743347168, "StateBufferConnector_ms": 0.015139222145080566, "ViewRequirementAgentConnector_ms": 0.33788084983825684}, "num_episodes": 23, "episode_return_max": 387.0, "episode_return_min": -92.0, "episode_return_mean": 85.06, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 175.26579085322, "num_env_steps_trained_throughput_per_sec": 175.26579085322, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 21375.221, "restore_workers_time_ms": 0.021, "training_step_time_ms": 21375.161, "sample_time_ms": 2899.701, "learn_time_ms": 18451.246, "learn_throughput": 216.788, "synch_weights_time_ms": 20.154}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "4f45b_00000", "date": "2024-08-13_01-39-59", "timestamp": 1723527599, "time_this_iter_s": 22.871542930603027, "time_total_s": 1335.7276647090912, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cd54c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1335.7276647090912, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 85.68181818181819, "ram_util_percent": 83.54848484848486}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4481163685323385, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.708935652586518, "policy_loss": -0.0037871194893750485, "vf_loss": 3.7126372864637425, "vf_explained_var": 0.027878106397295755, "kl": 0.013676661506227001, "entropy": 1.4084642812688515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.287635865476396, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.311887501661109, "policy_loss": 2.0730679376770264e-06, "vf_loss": 7.311877408607927, "vf_explained_var": 0.023544706869377662, "kl": 0.002568319884109624, "entropy": 1.3339481765631014, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 387.0, "episode_reward_min": -63.0, "episode_reward_mean": 91.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -268.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 155.0}, "policy_reward_mean": {"prey_policy": 18.92, "predator_policy": 26.93}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 50.0, 12.0, -8.0, 115.0, -2.0, 18.0, 222.0, 95.0, 118.0, 96.0, 165.0, 10.0, 81.0, 41.0, 102.0, 172.0, 97.0, 8.0, 87.0, -29.0, 133.0, 163.0, 65.0, 0.0, 82.0, 95.0, 98.0, -19.0, 88.0, 163.0, 219.0, 117.0, 70.0, 46.0, 35.0, -19.0, 101.0, 64.0, 69.0, 8.0, 336.0, 146.0, 187.0, 182.0, 257.0, 162.0, -34.0, 17.0, 44.0, -48.0, -33.0, 133.0, 149.0, 146.0, 123.0, 49.0, 155.0, -33.0, 288.0, -3.0, 30.0, 18.0, 295.0, 30.0, -14.0, 236.0, 268.0, -31.0, 248.0, 178.0, 209.0, 387.0, 97.0, 355.0, -9.0, 113.0, 63.0, -9.0, -16.0, 65.0, 281.0, 11.0, 146.0, 47.0, 92.0, 87.0, 66.0, 263.0, 61.0, -63.0, 56.0, -42.0, 19.0, 136.0, 91.0, 8.0, 6.0, 37.0, 90.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [14.0, -33.0, -32.0, 52.0, 0.0, 12.0, 26.0, -68.0, 67.0, 46.0, 0.0, -72.0, 56.0, -76.0, 145.0, 77.0, 32.0, 63.0, 38.0, 62.0, 48.0, 44.0, 80.0, 37.0, 0.0, -29.0, 33.0, 30.0, 4.0, 10.0, 80.0, 13.0, 95.0, 77.0, -3.0, 89.0, 50.0, -206.0, 50.0, -14.0, 62.0, -196.0, 50.0, 72.0, 49.0, 67.0, -117.0, 77.0, -27.0, -55.0, 58.0, 24.0, 12.0, 83.0, 0.0, 84.0, -60.0, 6.0, 47.0, 0.0, 79.0, 66.0, 148.0, 71.0, 23.0, 4.0, 45.0, 0.0, 19.0, -2.0, 4.0, 0.0, -7.0, -92.0, 77.0, -90.0, 24.0, 12.0, -74.0, 6.0, -268.0, 44.0, 142.0, 191.0, 79.0, 13.0, 57.0, 74.0, 50.0, 98.0, 99.0, 152.0, 143.0, 19.0, -167.0, 1.0, -140.0, 19.0, -94.0, 90.0, -135.0, 0.0, -74.0, -39.0, 11.0, 83.0, 30.0, 61.0, 0.0, 146.0, -60.0, 141.0, -182.0, 125.0, 25.0, 117.0, -107.0, -5.0, 172.0, 79.0, 0.0, -74.0, -38.0, 8.0, 0.0, 0.0, 193.0, 102.0, -88.0, 40.0, -89.0, 6.0, 131.0, 59.0, 80.0, 125.0, -5.0, -221.0, 100.0, 107.0, -8.0, 155.0, -50.0, 158.0, 194.0, 189.0, -43.0, 51.0, 151.0, 199.0, -8.0, -6.0, 113.0, 0.0, -120.0, 123.0, -23.0, -161.0, 0.0, -73.0, -198.0, 141.0, 114.0, 126.0, 0.0, 11.0, 108.0, -80.0, 0.0, 25.0, 17.0, 27.0, -7.0, 2.0, 25.0, 31.0, 179.0, 61.0, -4.0, 1.0, -169.0, -51.0, -22.0, -22.0, -94.0, -64.0, -184.0, 90.0, 53.0, -17.0, -20.0, 46.0, -70.0, 37.0, 0.0, 6.0, -22.0, 23.0, 52.0, -80.0], "policy_predator_policy_reward": [33.0, 0.0, 30.0, 0.0, 0.0, 0.0, 34.0, 0.0, 2.0, 0.0, 0.0, 70.0, 22.0, 16.0, 0.0, 0.0, 0.0, 0.0, 16.0, 2.0, 1.0, 3.0, 38.0, 10.0, 21.0, 18.0, 9.0, 9.0, 14.0, 13.0, 2.0, 7.0, 0.0, 0.0, 11.0, 0.0, 93.0, 71.0, 0.0, 51.0, 2.0, 103.0, 0.0, 11.0, 47.0, 0.0, 68.0, 37.0, 82.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 33.0, 2.0, 26.0, 15.0, 0.0, 18.0, 0.0, 0.0, 49.0, 41.0, 0.0, 25.0, 13.0, 16.0, 9.0, 22.0, 80.0, 0.0, 43.0, 71.0, 28.0, 0.0, 75.0, 62.0, 155.0, 77.0, 0.0, 3.0, 37.0, 17.0, 2.0, 54.0, 0.0, 34.0, 0.0, 6.0, 0.0, 0.0, 91.0, 41.0, 134.0, 4.0, 0.0, 48.0, 9.0, 78.0, 75.0, 5.0, 0.0, 39.0, 52.0, 6.0, 0.0, 0.0, 24.0, 18.0, 43.0, 63.0, 0.0, 13.0, 60.0, 19.0, 37.0, 0.0, 71.0, 0.0, 8.0, 52.0, 0.0, 18.0, 0.0, 0.0, 0.0, 78.0, 65.0, 4.0, 0.0, 46.0, 2.0, 61.0, 96.0, 99.0, 40.0, 1.0, 0.0, 31.0, 69.0, 32.0, 0.0, 4.0, 72.0, 17.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 60.0, 40.0, 135.0, 57.0, 0.0, 34.0, 88.0, 15.0, 26.0, 0.0, 0.0, 40.0, 78.0, 22.0, 0.0, 25.0, 23.0, 40.0, 52.0, 7.0, 3.0, 23.0, 0.0, 0.0, 64.0, 5.0, 152.0, 0.0, 100.0, 6.0, 110.0, 113.0, 0.0, 100.0, 0.0, 65.0, 0.0, 0.0, 41.0, 0.0, 0.0, 36.0, 0.0, 48.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7542964180891654, "mean_inference_ms": 4.279129830772031, "mean_action_processing_ms": 0.6667431248181981, "mean_env_wait_ms": 0.5897907844877696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012578964233398438, "StateBufferConnector_ms": 0.018646955490112305, "ViewRequirementAgentConnector_ms": 0.3372373580932617}, "num_episodes": 18, "episode_return_max": 387.0, "episode_return_min": -63.0, "episode_return_mean": 91.7, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 176.4478168373874, "num_env_steps_trained_throughput_per_sec": 176.4478168373874, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 21689.244, "restore_workers_time_ms": 0.021, "training_step_time_ms": 21689.184, "sample_time_ms": 2974.303, "learn_time_ms": 18687.899, "learn_throughput": 214.042, "synch_weights_time_ms": 23.1}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "4f45b_00000", "date": "2024-08-13_01-40-22", "timestamp": 1723527622, "time_this_iter_s": 22.704309940338135, "time_total_s": 1358.4319746494293, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1bd0160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1358.4319746494293, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 84.45625, "ram_util_percent": 83.49374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.42672478459657187, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.461173517994149, "policy_loss": -0.005856260620846004, "vf_loss": 4.466916912194913, "vf_explained_var": 0.013910529537806434, "kl": 0.018058674954796447, "entropy": 1.4333590174478197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.992241869937806, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.39899206893154, "policy_loss": -0.0033076594301583197, "vf_loss": 8.402281950895118, "vf_explained_var": 0.09694724388854213, "kl": 0.011380474067496121, "entropy": 1.3066074973691708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 387.0, "episode_reward_min": -107.0, "episode_reward_mean": 99.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -268.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 155.0}, "policy_reward_mean": {"prey_policy": 19.845, "predator_policy": 30.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.0, 87.0, -29.0, 133.0, 163.0, 65.0, 0.0, 82.0, 95.0, 98.0, -19.0, 88.0, 163.0, 219.0, 117.0, 70.0, 46.0, 35.0, -19.0, 101.0, 64.0, 69.0, 8.0, 336.0, 146.0, 187.0, 182.0, 257.0, 162.0, -34.0, 17.0, 44.0, -48.0, -33.0, 133.0, 149.0, 146.0, 123.0, 49.0, 155.0, -33.0, 288.0, -3.0, 30.0, 18.0, 295.0, 30.0, -14.0, 236.0, 268.0, -31.0, 248.0, 178.0, 209.0, 387.0, 97.0, 355.0, -9.0, 113.0, 63.0, -9.0, -16.0, 65.0, 281.0, 11.0, 146.0, 47.0, 92.0, 87.0, 66.0, 263.0, 61.0, -63.0, 56.0, -42.0, 19.0, 136.0, 91.0, 8.0, 6.0, 37.0, 90.0, 122.0, 24.0, 246.0, -15.0, 284.0, 90.0, 35.0, -33.0, 205.0, 40.0, 350.0, 358.0, -107.0, 174.0, 33.0, 317.0, 107.0, -33.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [50.0, -206.0, 50.0, -14.0, 62.0, -196.0, 50.0, 72.0, 49.0, 67.0, -117.0, 77.0, -27.0, -55.0, 58.0, 24.0, 12.0, 83.0, 0.0, 84.0, -60.0, 6.0, 47.0, 0.0, 79.0, 66.0, 148.0, 71.0, 23.0, 4.0, 45.0, 0.0, 19.0, -2.0, 4.0, 0.0, -7.0, -92.0, 77.0, -90.0, 24.0, 12.0, -74.0, 6.0, -268.0, 44.0, 142.0, 191.0, 79.0, 13.0, 57.0, 74.0, 50.0, 98.0, 99.0, 152.0, 143.0, 19.0, -167.0, 1.0, -140.0, 19.0, -94.0, 90.0, -135.0, 0.0, -74.0, -39.0, 11.0, 83.0, 30.0, 61.0, 0.0, 146.0, -60.0, 141.0, -182.0, 125.0, 25.0, 117.0, -107.0, -5.0, 172.0, 79.0, 0.0, -74.0, -38.0, 8.0, 0.0, 0.0, 193.0, 102.0, -88.0, 40.0, -89.0, 6.0, 131.0, 59.0, 80.0, 125.0, -5.0, -221.0, 100.0, 107.0, -8.0, 155.0, -50.0, 158.0, 194.0, 189.0, -43.0, 51.0, 151.0, 199.0, -8.0, -6.0, 113.0, 0.0, -120.0, 123.0, -23.0, -161.0, 0.0, -73.0, -198.0, 141.0, 114.0, 126.0, 0.0, 11.0, 108.0, -80.0, 0.0, 25.0, 17.0, 27.0, -7.0, 2.0, 25.0, 31.0, 179.0, 61.0, -4.0, 1.0, -169.0, -51.0, -22.0, -22.0, -94.0, -64.0, -184.0, 90.0, 53.0, -17.0, -20.0, 46.0, -70.0, 37.0, 0.0, 6.0, -22.0, 23.0, 52.0, -80.0, 50.0, 11.0, -7.0, -70.0, 77.0, 111.0, -11.0, -162.0, 180.0, 98.0, -94.0, 68.0, 0.0, 35.0, -220.0, 48.0, 79.0, 89.0, 13.0, -49.0, 156.0, 191.0, 200.0, 145.0, -67.0, -140.0, 46.0, 125.0, 33.0, 0.0, 161.0, 134.0, 66.0, 0.0, -107.0, 13.0], "policy_predator_policy_reward": [93.0, 71.0, 0.0, 51.0, 2.0, 103.0, 0.0, 11.0, 47.0, 0.0, 68.0, 37.0, 82.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 33.0, 2.0, 26.0, 15.0, 0.0, 18.0, 0.0, 0.0, 49.0, 41.0, 0.0, 25.0, 13.0, 16.0, 9.0, 22.0, 80.0, 0.0, 43.0, 71.0, 28.0, 0.0, 75.0, 62.0, 155.0, 77.0, 0.0, 3.0, 37.0, 17.0, 2.0, 54.0, 0.0, 34.0, 0.0, 6.0, 0.0, 0.0, 91.0, 41.0, 134.0, 4.0, 0.0, 48.0, 9.0, 78.0, 75.0, 5.0, 0.0, 39.0, 52.0, 6.0, 0.0, 0.0, 24.0, 18.0, 43.0, 63.0, 0.0, 13.0, 60.0, 19.0, 37.0, 0.0, 71.0, 0.0, 8.0, 52.0, 0.0, 18.0, 0.0, 0.0, 0.0, 78.0, 65.0, 4.0, 0.0, 46.0, 2.0, 61.0, 96.0, 99.0, 40.0, 1.0, 0.0, 31.0, 69.0, 32.0, 0.0, 4.0, 72.0, 17.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 60.0, 40.0, 135.0, 57.0, 0.0, 34.0, 88.0, 15.0, 26.0, 0.0, 0.0, 40.0, 78.0, 22.0, 0.0, 25.0, 23.0, 40.0, 52.0, 7.0, 3.0, 23.0, 0.0, 0.0, 64.0, 5.0, 152.0, 0.0, 100.0, 6.0, 110.0, 113.0, 0.0, 100.0, 0.0, 65.0, 0.0, 0.0, 41.0, 0.0, 0.0, 36.0, 0.0, 48.0, 70.0, 17.0, 44.0, 18.0, 83.0, 33.0, 25.0, 97.0, 61.0, 6.0, 0.0, 61.0, 55.0, 0.0, 0.0, 105.0, 34.0, 37.0, 0.0, 0.0, 76.0, 0.0, 3.0, 0.0, 13.0, 52.0, 48.0, 3.0, 0.0, 0.0, 0.0, 22.0, 0.0, 29.0, 12.0, 0.0, 61.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7494111143501585, "mean_inference_ms": 4.269452785569792, "mean_action_processing_ms": 0.6665459328296496, "mean_env_wait_ms": 0.589074389785025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011370420455932617, "StateBufferConnector_ms": 0.01373147964477539, "ViewRequirementAgentConnector_ms": 0.33020734786987305}, "num_episodes": 18, "episode_return_max": 387.0, "episode_return_min": -107.0, "episode_return_mean": 99.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.0130663922118925, "num_env_steps_trained_throughput_per_sec": 4.0130663922118925, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 119528.223, "restore_workers_time_ms": 0.023, "training_step_time_ms": 119528.158, "sample_time_ms": 3059.023, "learn_time_ms": 116440.367, "learn_throughput": 34.352, "synch_weights_time_ms": 24.13}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "4f45b_00000", "date": "2024-08-13_01-56-59", "timestamp": 1723528619, "time_this_iter_s": 996.9450900554657, "time_total_s": 2355.377064704895, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cd5280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2355.377064704895, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 85.39714285714287, "ram_util_percent": 83.4457142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6644601558684987, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.320791668614382, "policy_loss": -0.0037190834735396994, "vf_loss": 5.3244374200780555, "vf_explained_var": 0.0434191504168132, "kl": 0.011731588600283095, "entropy": 1.461771815479117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.832441669261014, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.951239627252811, "policy_loss": -0.011987375272142272, "vf_loss": 7.963204820824679, "vf_explained_var": -0.031577681580548564, "kl": 0.014196357544565361, "entropy": 1.278595630643229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 387.0, "episode_reward_min": -107.0, "episode_reward_mean": 97.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -268.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 155.0}, "policy_reward_mean": {"prey_policy": 15.55, "predator_policy": 33.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-19.0, 101.0, 64.0, 69.0, 8.0, 336.0, 146.0, 187.0, 182.0, 257.0, 162.0, -34.0, 17.0, 44.0, -48.0, -33.0, 133.0, 149.0, 146.0, 123.0, 49.0, 155.0, -33.0, 288.0, -3.0, 30.0, 18.0, 295.0, 30.0, -14.0, 236.0, 268.0, -31.0, 248.0, 178.0, 209.0, 387.0, 97.0, 355.0, -9.0, 113.0, 63.0, -9.0, -16.0, 65.0, 281.0, 11.0, 146.0, 47.0, 92.0, 87.0, 66.0, 263.0, 61.0, -63.0, 56.0, -42.0, 19.0, 136.0, 91.0, 8.0, 6.0, 37.0, 90.0, 122.0, 24.0, 246.0, -15.0, 284.0, 90.0, 35.0, -33.0, 205.0, 40.0, 350.0, 358.0, -107.0, 174.0, 33.0, 317.0, 107.0, -33.0, 98.0, -41.0, -77.0, 92.0, 7.0, -7.0, -39.0, 69.0, 19.0, 76.0, 186.0, 77.0, 135.0, 110.0, 163.0, 132.0, 19.0, 151.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-7.0, -92.0, 77.0, -90.0, 24.0, 12.0, -74.0, 6.0, -268.0, 44.0, 142.0, 191.0, 79.0, 13.0, 57.0, 74.0, 50.0, 98.0, 99.0, 152.0, 143.0, 19.0, -167.0, 1.0, -140.0, 19.0, -94.0, 90.0, -135.0, 0.0, -74.0, -39.0, 11.0, 83.0, 30.0, 61.0, 0.0, 146.0, -60.0, 141.0, -182.0, 125.0, 25.0, 117.0, -107.0, -5.0, 172.0, 79.0, 0.0, -74.0, -38.0, 8.0, 0.0, 0.0, 193.0, 102.0, -88.0, 40.0, -89.0, 6.0, 131.0, 59.0, 80.0, 125.0, -5.0, -221.0, 100.0, 107.0, -8.0, 155.0, -50.0, 158.0, 194.0, 189.0, -43.0, 51.0, 151.0, 199.0, -8.0, -6.0, 113.0, 0.0, -120.0, 123.0, -23.0, -161.0, 0.0, -73.0, -198.0, 141.0, 114.0, 126.0, 0.0, 11.0, 108.0, -80.0, 0.0, 25.0, 17.0, 27.0, -7.0, 2.0, 25.0, 31.0, 179.0, 61.0, -4.0, 1.0, -169.0, -51.0, -22.0, -22.0, -94.0, -64.0, -184.0, 90.0, 53.0, -17.0, -20.0, 46.0, -70.0, 37.0, 0.0, 6.0, -22.0, 23.0, 52.0, -80.0, 50.0, 11.0, -7.0, -70.0, 77.0, 111.0, -11.0, -162.0, 180.0, 98.0, -94.0, 68.0, 0.0, 35.0, -220.0, 48.0, 79.0, 89.0, 13.0, -49.0, 156.0, 191.0, 200.0, 145.0, -67.0, -140.0, 46.0, 125.0, 33.0, 0.0, 161.0, 134.0, 66.0, 0.0, -107.0, 13.0, 33.0, -31.0, -165.0, -2.0, -170.0, -88.0, 1.0, -32.0, 33.0, -167.0, -36.0, 11.0, 6.0, -166.0, 62.0, -38.0, 0.0, -76.0, 26.0, -57.0, 82.0, 78.0, -90.0, 24.0, 0.0, 99.0, 1.0, 85.0, 179.0, -95.0, 58.0, 33.0, -16.0, 0.0, 117.0, 15.0], "policy_predator_policy_reward": [80.0, 0.0, 43.0, 71.0, 28.0, 0.0, 75.0, 62.0, 155.0, 77.0, 0.0, 3.0, 37.0, 17.0, 2.0, 54.0, 0.0, 34.0, 0.0, 6.0, 0.0, 0.0, 91.0, 41.0, 134.0, 4.0, 0.0, 48.0, 9.0, 78.0, 75.0, 5.0, 0.0, 39.0, 52.0, 6.0, 0.0, 0.0, 24.0, 18.0, 43.0, 63.0, 0.0, 13.0, 60.0, 19.0, 37.0, 0.0, 71.0, 0.0, 8.0, 52.0, 0.0, 18.0, 0.0, 0.0, 0.0, 78.0, 65.0, 4.0, 0.0, 46.0, 2.0, 61.0, 96.0, 99.0, 40.0, 1.0, 0.0, 31.0, 69.0, 32.0, 0.0, 4.0, 72.0, 17.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 60.0, 40.0, 135.0, 57.0, 0.0, 34.0, 88.0, 15.0, 26.0, 0.0, 0.0, 40.0, 78.0, 22.0, 0.0, 25.0, 23.0, 40.0, 52.0, 7.0, 3.0, 23.0, 0.0, 0.0, 64.0, 5.0, 152.0, 0.0, 100.0, 6.0, 110.0, 113.0, 0.0, 100.0, 0.0, 65.0, 0.0, 0.0, 41.0, 0.0, 0.0, 36.0, 0.0, 48.0, 70.0, 17.0, 44.0, 18.0, 83.0, 33.0, 25.0, 97.0, 61.0, 6.0, 0.0, 61.0, 55.0, 0.0, 0.0, 105.0, 34.0, 37.0, 0.0, 0.0, 76.0, 0.0, 3.0, 0.0, 13.0, 52.0, 48.0, 3.0, 0.0, 0.0, 0.0, 22.0, 0.0, 29.0, 12.0, 0.0, 61.0, 63.0, 33.0, 92.0, 34.0, 50.0, 131.0, 67.0, 56.0, 9.0, 132.0, 0.0, 18.0, 26.0, 95.0, 25.0, 20.0, 3.0, 92.0, 59.0, 48.0, 0.0, 26.0, 87.0, 56.0, 28.0, 8.0, 7.0, 17.0, 67.0, 12.0, 23.0, 18.0, 1.0, 34.0, 0.0, 19.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.758135043411215, "mean_inference_ms": 4.307442516153585, "mean_action_processing_ms": 0.6713466113480818, "mean_env_wait_ms": 0.5937954661230874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026047468185424805, "StateBufferConnector_ms": 0.023645758628845215, "ViewRequirementAgentConnector_ms": 0.35854077339172363}, "num_episodes": 18, "episode_return_max": 387.0, "episode_return_min": -107.0, "episode_return_mean": 97.18, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.01768918927937, "num_env_steps_trained_throughput_per_sec": 159.01768918927937, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 120155.956, "restore_workers_time_ms": 0.026, "training_step_time_ms": 120155.875, "sample_time_ms": 3432.394, "learn_time_ms": 116693.34, "learn_throughput": 34.278, "synch_weights_time_ms": 24.164}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "4f45b_00000", "date": "2024-08-13_01-57-25", "timestamp": 1723528645, "time_this_iter_s": 25.261600017547607, "time_total_s": 2380.6386647224426, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb98b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2380.6386647224426, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 92.37777777777778, "ram_util_percent": 83.61666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6125023443035033, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.280377711947002, "policy_loss": -0.008451536838605842, "vf_loss": 5.2887116794232965, "vf_explained_var": 0.05061130006477316, "kl": 0.018811395123758064, "entropy": 1.4260534948142116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.983630195575416, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.683527932595954, "policy_loss": -0.007227743683363159, "vf_loss": 8.690730023762537, "vf_explained_var": 0.036526716827715515, "kl": 0.01642174274802121, "entropy": 1.2054296224836318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 387.0, "episode_reward_min": -147.0, "episode_reward_mean": 99.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -248.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 152.0}, "policy_reward_mean": {"prey_policy": 14.49, "predator_policy": 35.395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [295.0, 30.0, -14.0, 236.0, 268.0, -31.0, 248.0, 178.0, 209.0, 387.0, 97.0, 355.0, -9.0, 113.0, 63.0, -9.0, -16.0, 65.0, 281.0, 11.0, 146.0, 47.0, 92.0, 87.0, 66.0, 263.0, 61.0, -63.0, 56.0, -42.0, 19.0, 136.0, 91.0, 8.0, 6.0, 37.0, 90.0, 122.0, 24.0, 246.0, -15.0, 284.0, 90.0, 35.0, -33.0, 205.0, 40.0, 350.0, 358.0, -107.0, 174.0, 33.0, 317.0, 107.0, -33.0, 98.0, -41.0, -77.0, 92.0, 7.0, -7.0, -39.0, 69.0, 19.0, 76.0, 186.0, 77.0, 135.0, 110.0, 163.0, 132.0, 19.0, 151.0, -35.0, -147.0, 20.0, 22.0, 167.0, 12.0, 74.0, 174.0, 143.0, 50.0, 18.0, 41.0, 190.0, 207.0, 139.0, 92.0, 45.0, 112.0, 31.0, 137.0, 44.0, 200.0, 314.0, 178.0, 298.0, 124.0, 103.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [193.0, 102.0, -88.0, 40.0, -89.0, 6.0, 131.0, 59.0, 80.0, 125.0, -5.0, -221.0, 100.0, 107.0, -8.0, 155.0, -50.0, 158.0, 194.0, 189.0, -43.0, 51.0, 151.0, 199.0, -8.0, -6.0, 113.0, 0.0, -120.0, 123.0, -23.0, -161.0, 0.0, -73.0, -198.0, 141.0, 114.0, 126.0, 0.0, 11.0, 108.0, -80.0, 0.0, 25.0, 17.0, 27.0, -7.0, 2.0, 25.0, 31.0, 179.0, 61.0, -4.0, 1.0, -169.0, -51.0, -22.0, -22.0, -94.0, -64.0, -184.0, 90.0, 53.0, -17.0, -20.0, 46.0, -70.0, 37.0, 0.0, 6.0, -22.0, 23.0, 52.0, -80.0, 50.0, 11.0, -7.0, -70.0, 77.0, 111.0, -11.0, -162.0, 180.0, 98.0, -94.0, 68.0, 0.0, 35.0, -220.0, 48.0, 79.0, 89.0, 13.0, -49.0, 156.0, 191.0, 200.0, 145.0, -67.0, -140.0, 46.0, 125.0, 33.0, 0.0, 161.0, 134.0, 66.0, 0.0, -107.0, 13.0, 33.0, -31.0, -165.0, -2.0, -170.0, -88.0, 1.0, -32.0, 33.0, -167.0, -36.0, 11.0, 6.0, -166.0, 62.0, -38.0, 0.0, -76.0, 26.0, -57.0, 82.0, 78.0, -90.0, 24.0, 0.0, 99.0, 1.0, 85.0, 179.0, -95.0, 58.0, 33.0, -16.0, 0.0, 117.0, 15.0, -74.0, -140.0, -220.0, -156.0, 43.0, -87.0, -24.0, 11.0, 98.0, 33.0, -8.0, 13.0, 66.0, -55.0, 61.0, 29.0, 92.0, 21.0, 57.0, -207.0, 0.0, 18.0, -134.0, 78.0, -3.0, 109.0, 97.0, 49.0, 14.0, 30.0, -52.0, 57.0, 122.0, -248.0, 8.0, 59.0, -38.0, -28.0, 86.0, -20.0, 8.0, -59.0, 0.0, 200.0, 189.0, 125.0, 98.0, -19.0, 198.0, 34.0, 33.0, -2.0, -96.0, 64.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 78.0, 65.0, 4.0, 0.0, 46.0, 2.0, 61.0, 96.0, 99.0, 40.0, 1.0, 0.0, 31.0, 69.0, 32.0, 0.0, 4.0, 72.0, 17.0, 5.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 60.0, 40.0, 135.0, 57.0, 0.0, 34.0, 88.0, 15.0, 26.0, 0.0, 0.0, 40.0, 78.0, 22.0, 0.0, 25.0, 23.0, 40.0, 52.0, 7.0, 3.0, 23.0, 0.0, 0.0, 64.0, 5.0, 152.0, 0.0, 100.0, 6.0, 110.0, 113.0, 0.0, 100.0, 0.0, 65.0, 0.0, 0.0, 41.0, 0.0, 0.0, 36.0, 0.0, 48.0, 70.0, 17.0, 44.0, 18.0, 83.0, 33.0, 25.0, 97.0, 61.0, 6.0, 0.0, 61.0, 55.0, 0.0, 0.0, 105.0, 34.0, 37.0, 0.0, 0.0, 76.0, 0.0, 3.0, 0.0, 13.0, 52.0, 48.0, 3.0, 0.0, 0.0, 0.0, 22.0, 0.0, 29.0, 12.0, 0.0, 61.0, 63.0, 33.0, 92.0, 34.0, 50.0, 131.0, 67.0, 56.0, 9.0, 132.0, 0.0, 18.0, 26.0, 95.0, 25.0, 20.0, 3.0, 92.0, 59.0, 48.0, 0.0, 26.0, 87.0, 56.0, 28.0, 8.0, 7.0, 17.0, 67.0, 12.0, 23.0, 18.0, 1.0, 34.0, 0.0, 19.0, 73.0, 106.0, 93.0, 136.0, 64.0, 0.0, 15.0, 20.0, 18.0, 18.0, 4.0, 3.0, 63.0, 0.0, 74.0, 10.0, 0.0, 30.0, 75.0, 125.0, 0.0, 0.0, 30.0, 67.0, 0.0, 84.0, 42.0, 19.0, 61.0, 34.0, 83.0, 4.0, 82.0, 89.0, 21.0, 24.0, 97.0, 0.0, 22.0, 49.0, 72.0, 23.0, 0.0, 0.0, 0.0, 0.0, 29.0, 70.0, 11.0, 55.0, 41.0, 52.0, 65.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7656362996965111, "mean_inference_ms": 4.365097933189622, "mean_action_processing_ms": 0.676486125173687, "mean_env_wait_ms": 0.5990192441791322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027051806449890137, "StateBufferConnector_ms": 0.02268242835998535, "ViewRequirementAgentConnector_ms": 0.30325067043304443}, "num_episodes": 27, "episode_return_max": 387.0, "episode_return_min": -147.0, "episode_return_mean": 99.77, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 238.44052326454286, "num_env_steps_trained_throughput_per_sec": 238.44052326454286, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 119875.956, "restore_workers_time_ms": 0.026, "training_step_time_ms": 119875.876, "sample_time_ms": 3444.516, "learn_time_ms": 116402.356, "learn_throughput": 34.364, "synch_weights_time_ms": 23.299}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "4f45b_00000", "date": "2024-08-13_01-57-42", "timestamp": 1723528662, "time_this_iter_s": 16.82227087020874, "time_total_s": 2397.4609355926514, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cad040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2397.4609355926514, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 81.88333333333334, "ram_util_percent": 83.44583333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8564842271741736, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.914824486787988, "policy_loss": -0.005726386216178379, "vf_loss": 5.920422202064877, "vf_explained_var": 0.023990361148087436, "kl": 0.020586173231490493, "entropy": 1.353865535297091, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.8804021206955435, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.511166339955002, "policy_loss": -0.0016879684507363924, "vf_loss": 7.51284045718965, "vf_explained_var": -0.08375364504163227, "kl": 0.008857713527350571, "entropy": 1.308616042578662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -198.0, "episode_reward_mean": 82.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -306.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 162.0}, "policy_reward_mean": {"prey_policy": 3.675, "predator_policy": 37.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [281.0, 11.0, 146.0, 47.0, 92.0, 87.0, 66.0, 263.0, 61.0, -63.0, 56.0, -42.0, 19.0, 136.0, 91.0, 8.0, 6.0, 37.0, 90.0, 122.0, 24.0, 246.0, -15.0, 284.0, 90.0, 35.0, -33.0, 205.0, 40.0, 350.0, 358.0, -107.0, 174.0, 33.0, 317.0, 107.0, -33.0, 98.0, -41.0, -77.0, 92.0, 7.0, -7.0, -39.0, 69.0, 19.0, 76.0, 186.0, 77.0, 135.0, 110.0, 163.0, 132.0, 19.0, 151.0, -35.0, -147.0, 20.0, 22.0, 167.0, 12.0, 74.0, 174.0, 143.0, 50.0, 18.0, 41.0, 190.0, 207.0, 139.0, 92.0, 45.0, 112.0, 31.0, 137.0, 44.0, 200.0, 314.0, 178.0, 298.0, 124.0, 103.0, -198.0, -129.0, 122.0, 48.0, -47.0, 191.0, 146.0, -28.0, 178.0, 10.0, 46.0, 103.0, -50.0, 118.0, -12.0, 40.0, 121.0, 102.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [114.0, 126.0, 0.0, 11.0, 108.0, -80.0, 0.0, 25.0, 17.0, 27.0, -7.0, 2.0, 25.0, 31.0, 179.0, 61.0, -4.0, 1.0, -169.0, -51.0, -22.0, -22.0, -94.0, -64.0, -184.0, 90.0, 53.0, -17.0, -20.0, 46.0, -70.0, 37.0, 0.0, 6.0, -22.0, 23.0, 52.0, -80.0, 50.0, 11.0, -7.0, -70.0, 77.0, 111.0, -11.0, -162.0, 180.0, 98.0, -94.0, 68.0, 0.0, 35.0, -220.0, 48.0, 79.0, 89.0, 13.0, -49.0, 156.0, 191.0, 200.0, 145.0, -67.0, -140.0, 46.0, 125.0, 33.0, 0.0, 161.0, 134.0, 66.0, 0.0, -107.0, 13.0, 33.0, -31.0, -165.0, -2.0, -170.0, -88.0, 1.0, -32.0, 33.0, -167.0, -36.0, 11.0, 6.0, -166.0, 62.0, -38.0, 0.0, -76.0, 26.0, -57.0, 82.0, 78.0, -90.0, 24.0, 0.0, 99.0, 1.0, 85.0, 179.0, -95.0, 58.0, 33.0, -16.0, 0.0, 117.0, 15.0, -74.0, -140.0, -220.0, -156.0, 43.0, -87.0, -24.0, 11.0, 98.0, 33.0, -8.0, 13.0, 66.0, -55.0, 61.0, 29.0, 92.0, 21.0, 57.0, -207.0, 0.0, 18.0, -134.0, 78.0, -3.0, 109.0, 97.0, 49.0, 14.0, 30.0, -52.0, 57.0, 122.0, -248.0, 8.0, 59.0, -38.0, -28.0, 86.0, -20.0, 8.0, -59.0, 0.0, 200.0, 189.0, 125.0, 98.0, -19.0, 198.0, 34.0, 33.0, -2.0, -96.0, 64.0, -180.0, -189.0, -306.0, -29.0, 0.0, 105.0, 22.0, 12.0, -186.0, -18.0, 127.0, 63.0, 63.0, 81.0, 26.0, -184.0, 96.0, 82.0, 0.0, -77.0, -88.0, 28.0, 42.0, -86.0, -278.0, 36.0, 92.0, -73.0, -128.0, 2.0, 12.0, -32.0, 100.0, -18.0, -59.0, 103.0], "policy_predator_policy_reward": [15.0, 26.0, 0.0, 0.0, 40.0, 78.0, 22.0, 0.0, 25.0, 23.0, 40.0, 52.0, 7.0, 3.0, 23.0, 0.0, 0.0, 64.0, 5.0, 152.0, 0.0, 100.0, 6.0, 110.0, 113.0, 0.0, 100.0, 0.0, 65.0, 0.0, 0.0, 41.0, 0.0, 0.0, 36.0, 0.0, 48.0, 70.0, 17.0, 44.0, 18.0, 83.0, 33.0, 25.0, 97.0, 61.0, 6.0, 0.0, 61.0, 55.0, 0.0, 0.0, 105.0, 34.0, 37.0, 0.0, 0.0, 76.0, 0.0, 3.0, 0.0, 13.0, 52.0, 48.0, 3.0, 0.0, 0.0, 0.0, 22.0, 0.0, 29.0, 12.0, 0.0, 61.0, 63.0, 33.0, 92.0, 34.0, 50.0, 131.0, 67.0, 56.0, 9.0, 132.0, 0.0, 18.0, 26.0, 95.0, 25.0, 20.0, 3.0, 92.0, 59.0, 48.0, 0.0, 26.0, 87.0, 56.0, 28.0, 8.0, 7.0, 17.0, 67.0, 12.0, 23.0, 18.0, 1.0, 34.0, 0.0, 19.0, 73.0, 106.0, 93.0, 136.0, 64.0, 0.0, 15.0, 20.0, 18.0, 18.0, 4.0, 3.0, 63.0, 0.0, 74.0, 10.0, 0.0, 30.0, 75.0, 125.0, 0.0, 0.0, 30.0, 67.0, 0.0, 84.0, 42.0, 19.0, 61.0, 34.0, 83.0, 4.0, 82.0, 89.0, 21.0, 24.0, 97.0, 0.0, 22.0, 49.0, 72.0, 23.0, 0.0, 0.0, 0.0, 0.0, 29.0, 70.0, 11.0, 55.0, 41.0, 52.0, 65.0, 70.0, 50.0, 121.0, 153.0, 53.0, 17.0, 0.0, 10.0, 4.0, 72.0, 85.0, 1.0, 0.0, 2.0, 0.0, 51.0, 79.0, 0.0, 0.0, 0.0, 87.0, 95.0, 11.0, 68.0, 79.0, 162.0, 30.0, 80.0, 19.0, 89.0, 25.0, 14.0, 46.0, 0.0, 39.0, 37.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7902338089822178, "mean_inference_ms": 19.94985470664337, "mean_action_processing_ms": 0.6919435898890666, "mean_env_wait_ms": 0.6151295907885764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05643939971923828, "StateBufferConnector_ms": 0.019283056259155273, "ViewRequirementAgentConnector_ms": 0.4137989282608032}, "num_episodes": 18, "episode_return_max": 358.0, "episode_return_min": -198.0, "episode_return_mean": 82.73, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.212213243962311, "num_env_steps_trained_throughput_per_sec": 4.212213243962311, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 212572.576, "restore_workers_time_ms": 0.024, "training_step_time_ms": 212572.497, "sample_time_ms": 95978.509, "learn_time_ms": 116562.256, "learn_throughput": 34.316, "synch_weights_time_ms": 25.827}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "4f45b_00000", "date": "2024-08-13_02-13-32", "timestamp": 1723529612, "time_this_iter_s": 949.7615258693695, "time_total_s": 3347.222461462021, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cf95e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3347.222461462021, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 94.27777777777777, "ram_util_percent": 83.64000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5815098501702465, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3262799161451833, "policy_loss": -0.008912225738266315, "vf_loss": 3.3350348688938, "vf_explained_var": 0.05080113934461402, "kl": 0.016775778083864813, "entropy": 1.415959521197768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.316222236206922, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.852718340656745, "policy_loss": -0.0035958948959079052, "vf_loss": 6.8562996606978155, "vf_explained_var": -0.049008829694576365, "kl": 0.009325134411662949, "entropy": 1.3312737889390773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -198.0, "episode_reward_mean": 77.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -306.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 162.0}, "policy_reward_mean": {"prey_policy": 0.66, "predator_policy": 38.18}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 122.0, 24.0, 246.0, -15.0, 284.0, 90.0, 35.0, -33.0, 205.0, 40.0, 350.0, 358.0, -107.0, 174.0, 33.0, 317.0, 107.0, -33.0, 98.0, -41.0, -77.0, 92.0, 7.0, -7.0, -39.0, 69.0, 19.0, 76.0, 186.0, 77.0, 135.0, 110.0, 163.0, 132.0, 19.0, 151.0, -35.0, -147.0, 20.0, 22.0, 167.0, 12.0, 74.0, 174.0, 143.0, 50.0, 18.0, 41.0, 190.0, 207.0, 139.0, 92.0, 45.0, 112.0, 31.0, 137.0, 44.0, 200.0, 314.0, 178.0, 298.0, 124.0, 103.0, -198.0, -129.0, 122.0, 48.0, -47.0, 191.0, 146.0, -28.0, 178.0, 10.0, 46.0, 103.0, -50.0, 118.0, -12.0, 40.0, 121.0, 102.0, 64.0, 60.0, -106.0, 170.0, -14.0, -80.0, -18.0, 128.0, -13.0, 77.0, 140.0, 158.0, -19.0, -2.0, -16.0, 172.0, 42.0, 54.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [52.0, -80.0, 50.0, 11.0, -7.0, -70.0, 77.0, 111.0, -11.0, -162.0, 180.0, 98.0, -94.0, 68.0, 0.0, 35.0, -220.0, 48.0, 79.0, 89.0, 13.0, -49.0, 156.0, 191.0, 200.0, 145.0, -67.0, -140.0, 46.0, 125.0, 33.0, 0.0, 161.0, 134.0, 66.0, 0.0, -107.0, 13.0, 33.0, -31.0, -165.0, -2.0, -170.0, -88.0, 1.0, -32.0, 33.0, -167.0, -36.0, 11.0, 6.0, -166.0, 62.0, -38.0, 0.0, -76.0, 26.0, -57.0, 82.0, 78.0, -90.0, 24.0, 0.0, 99.0, 1.0, 85.0, 179.0, -95.0, 58.0, 33.0, -16.0, 0.0, 117.0, 15.0, -74.0, -140.0, -220.0, -156.0, 43.0, -87.0, -24.0, 11.0, 98.0, 33.0, -8.0, 13.0, 66.0, -55.0, 61.0, 29.0, 92.0, 21.0, 57.0, -207.0, 0.0, 18.0, -134.0, 78.0, -3.0, 109.0, 97.0, 49.0, 14.0, 30.0, -52.0, 57.0, 122.0, -248.0, 8.0, 59.0, -38.0, -28.0, 86.0, -20.0, 8.0, -59.0, 0.0, 200.0, 189.0, 125.0, 98.0, -19.0, 198.0, 34.0, 33.0, -2.0, -96.0, 64.0, -180.0, -189.0, -306.0, -29.0, 0.0, 105.0, 22.0, 12.0, -186.0, -18.0, 127.0, 63.0, 63.0, 81.0, 26.0, -184.0, 96.0, 82.0, 0.0, -77.0, -88.0, 28.0, 42.0, -86.0, -278.0, 36.0, 92.0, -73.0, -128.0, 2.0, 12.0, -32.0, 100.0, -18.0, -59.0, 103.0, -27.0, 62.0, -12.0, 20.0, 0.0, -249.0, 90.0, 50.0, -61.0, -73.0, -229.0, 12.0, -110.0, 1.0, 0.0, 106.0, -65.0, -70.0, 0.0, 24.0, 44.0, 61.0, 21.0, 80.0, -44.0, -83.0, 38.0, -154.0, 21.0, -106.0, 148.0, 23.0, -6.0, 4.0, 0.0, 37.0], "policy_predator_policy_reward": [48.0, 70.0, 17.0, 44.0, 18.0, 83.0, 33.0, 25.0, 97.0, 61.0, 6.0, 0.0, 61.0, 55.0, 0.0, 0.0, 105.0, 34.0, 37.0, 0.0, 0.0, 76.0, 0.0, 3.0, 0.0, 13.0, 52.0, 48.0, 3.0, 0.0, 0.0, 0.0, 22.0, 0.0, 29.0, 12.0, 0.0, 61.0, 63.0, 33.0, 92.0, 34.0, 50.0, 131.0, 67.0, 56.0, 9.0, 132.0, 0.0, 18.0, 26.0, 95.0, 25.0, 20.0, 3.0, 92.0, 59.0, 48.0, 0.0, 26.0, 87.0, 56.0, 28.0, 8.0, 7.0, 17.0, 67.0, 12.0, 23.0, 18.0, 1.0, 34.0, 0.0, 19.0, 73.0, 106.0, 93.0, 136.0, 64.0, 0.0, 15.0, 20.0, 18.0, 18.0, 4.0, 3.0, 63.0, 0.0, 74.0, 10.0, 0.0, 30.0, 75.0, 125.0, 0.0, 0.0, 30.0, 67.0, 0.0, 84.0, 42.0, 19.0, 61.0, 34.0, 83.0, 4.0, 82.0, 89.0, 21.0, 24.0, 97.0, 0.0, 22.0, 49.0, 72.0, 23.0, 0.0, 0.0, 0.0, 0.0, 29.0, 70.0, 11.0, 55.0, 41.0, 52.0, 65.0, 70.0, 50.0, 121.0, 153.0, 53.0, 17.0, 0.0, 10.0, 4.0, 72.0, 85.0, 1.0, 0.0, 2.0, 0.0, 51.0, 79.0, 0.0, 0.0, 0.0, 87.0, 95.0, 11.0, 68.0, 79.0, 162.0, 30.0, 80.0, 19.0, 89.0, 25.0, 14.0, 46.0, 0.0, 39.0, 37.0, 21.0, 0.0, 29.0, 52.0, 0.0, 47.0, 96.0, 5.0, 25.0, 61.0, 59.0, 0.0, 137.0, 52.0, 39.0, 2.0, 20.0, 99.0, 23.0, 0.0, 53.0, 0.0, 35.0, 43.0, 14.0, 59.0, 49.0, 114.0, 0.0, 69.0, 0.0, 0.0, 1.0, 14.0, 30.0, 6.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8090385692685962, "mean_inference_ms": 34.90617400228143, "mean_action_processing_ms": 0.7045054336243407, "mean_env_wait_ms": 0.6283312582217064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05673563480377197, "StateBufferConnector_ms": 0.015401482582092285, "ViewRequirementAgentConnector_ms": 0.38688814640045166}, "num_episodes": 18, "episode_return_max": 358.0, "episode_return_min": -198.0, "episode_return_mean": 77.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 249.89882110255692, "num_env_steps_trained_throughput_per_sec": 249.89882110255692, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 212022.823, "restore_workers_time_ms": 0.022, "training_step_time_ms": 212022.747, "sample_time_ms": 95909.375, "learn_time_ms": 116081.067, "learn_throughput": 34.459, "synch_weights_time_ms": 25.631}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "4f45b_00000", "date": "2024-08-13_02-13-48", "timestamp": 1723529628, "time_this_iter_s": 16.071320056915283, "time_total_s": 3363.293781518936, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cc4dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3363.293781518936, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 87.07826086956523, "ram_util_percent": 83.47391304347825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.634246159691817, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.923192328498477, "policy_loss": -0.00814935573297873, "vf_loss": 6.931178825620621, "vf_explained_var": 0.04291759098648394, "kl": 0.017372160881551156, "entropy": 1.3963518342013082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.139235983686472, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.528234780276263, "policy_loss": -0.003105245650469981, "vf_loss": 8.531320039052812, "vf_explained_var": -0.06701148745244143, "kl": 0.012797469292803829, "entropy": 1.1599844058985433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 314.0, "episode_reward_min": -198.0, "episode_reward_mean": 61.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -343.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 162.0}, "policy_reward_mean": {"prey_policy": -12.675, "predator_policy": 43.645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.0, 98.0, -41.0, -77.0, 92.0, 7.0, -7.0, -39.0, 69.0, 19.0, 76.0, 186.0, 77.0, 135.0, 110.0, 163.0, 132.0, 19.0, 151.0, -35.0, -147.0, 20.0, 22.0, 167.0, 12.0, 74.0, 174.0, 143.0, 50.0, 18.0, 41.0, 190.0, 207.0, 139.0, 92.0, 45.0, 112.0, 31.0, 137.0, 44.0, 200.0, 314.0, 178.0, 298.0, 124.0, 103.0, -198.0, -129.0, 122.0, 48.0, -47.0, 191.0, 146.0, -28.0, 178.0, 10.0, 46.0, 103.0, -50.0, 118.0, -12.0, 40.0, 121.0, 102.0, 64.0, 60.0, -106.0, 170.0, -14.0, -80.0, -18.0, 128.0, -13.0, 77.0, 140.0, 158.0, -19.0, -2.0, -16.0, 172.0, 42.0, 54.0, 270.0, 105.0, 27.0, -157.0, 59.0, 36.0, -7.0, -58.0, -174.0, -72.0, 49.0, -81.0, 23.0, 142.0, 196.0, 235.0, 276.0, -123.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-107.0, 13.0, 33.0, -31.0, -165.0, -2.0, -170.0, -88.0, 1.0, -32.0, 33.0, -167.0, -36.0, 11.0, 6.0, -166.0, 62.0, -38.0, 0.0, -76.0, 26.0, -57.0, 82.0, 78.0, -90.0, 24.0, 0.0, 99.0, 1.0, 85.0, 179.0, -95.0, 58.0, 33.0, -16.0, 0.0, 117.0, 15.0, -74.0, -140.0, -220.0, -156.0, 43.0, -87.0, -24.0, 11.0, 98.0, 33.0, -8.0, 13.0, 66.0, -55.0, 61.0, 29.0, 92.0, 21.0, 57.0, -207.0, 0.0, 18.0, -134.0, 78.0, -3.0, 109.0, 97.0, 49.0, 14.0, 30.0, -52.0, 57.0, 122.0, -248.0, 8.0, 59.0, -38.0, -28.0, 86.0, -20.0, 8.0, -59.0, 0.0, 200.0, 189.0, 125.0, 98.0, -19.0, 198.0, 34.0, 33.0, -2.0, -96.0, 64.0, -180.0, -189.0, -306.0, -29.0, 0.0, 105.0, 22.0, 12.0, -186.0, -18.0, 127.0, 63.0, 63.0, 81.0, 26.0, -184.0, 96.0, 82.0, 0.0, -77.0, -88.0, 28.0, 42.0, -86.0, -278.0, 36.0, 92.0, -73.0, -128.0, 2.0, 12.0, -32.0, 100.0, -18.0, -59.0, 103.0, -27.0, 62.0, -12.0, 20.0, 0.0, -249.0, 90.0, 50.0, -61.0, -73.0, -229.0, 12.0, -110.0, 1.0, 0.0, 106.0, -65.0, -70.0, 0.0, 24.0, 44.0, 61.0, 21.0, 80.0, -44.0, -83.0, 38.0, -154.0, 21.0, -106.0, 148.0, 23.0, -6.0, 4.0, 0.0, 37.0, 80.0, 179.0, 53.0, -16.0, 60.0, -180.0, -175.0, -169.0, 26.0, -75.0, 0.0, -67.0, 7.0, -31.0, -103.0, -86.0, -173.0, -284.0, -343.0, -5.0, -14.0, -6.0, -206.0, -38.0, 4.0, -50.0, -15.0, 38.0, 111.0, 37.0, 145.0, 34.0, 97.0, 179.0, -136.0, -277.0], "policy_predator_policy_reward": [0.0, 61.0, 63.0, 33.0, 92.0, 34.0, 50.0, 131.0, 67.0, 56.0, 9.0, 132.0, 0.0, 18.0, 26.0, 95.0, 25.0, 20.0, 3.0, 92.0, 59.0, 48.0, 0.0, 26.0, 87.0, 56.0, 28.0, 8.0, 7.0, 17.0, 67.0, 12.0, 23.0, 18.0, 1.0, 34.0, 0.0, 19.0, 73.0, 106.0, 93.0, 136.0, 64.0, 0.0, 15.0, 20.0, 18.0, 18.0, 4.0, 3.0, 63.0, 0.0, 74.0, 10.0, 0.0, 30.0, 75.0, 125.0, 0.0, 0.0, 30.0, 67.0, 0.0, 84.0, 42.0, 19.0, 61.0, 34.0, 83.0, 4.0, 82.0, 89.0, 21.0, 24.0, 97.0, 0.0, 22.0, 49.0, 72.0, 23.0, 0.0, 0.0, 0.0, 0.0, 29.0, 70.0, 11.0, 55.0, 41.0, 52.0, 65.0, 70.0, 50.0, 121.0, 153.0, 53.0, 17.0, 0.0, 10.0, 4.0, 72.0, 85.0, 1.0, 0.0, 2.0, 0.0, 51.0, 79.0, 0.0, 0.0, 0.0, 87.0, 95.0, 11.0, 68.0, 79.0, 162.0, 30.0, 80.0, 19.0, 89.0, 25.0, 14.0, 46.0, 0.0, 39.0, 37.0, 21.0, 0.0, 29.0, 52.0, 0.0, 47.0, 96.0, 5.0, 25.0, 61.0, 59.0, 0.0, 137.0, 52.0, 39.0, 2.0, 20.0, 99.0, 23.0, 0.0, 53.0, 0.0, 35.0, 43.0, 14.0, 59.0, 49.0, 114.0, 0.0, 69.0, 0.0, 0.0, 1.0, 14.0, 30.0, 6.0, 11.0, 11.0, 0.0, 29.0, 39.0, 49.0, 98.0, 124.0, 63.0, 70.0, 38.0, 44.0, 59.0, 0.0, 17.0, 127.0, 4.0, 154.0, 129.0, 139.0, 137.0, 69.0, 0.0, 118.0, 45.0, 45.0, 24.0, 50.0, 69.0, 36.0, 12.0, 36.0, 20.0, 0.0, 0.0, 134.0, 156.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8217857758836271, "mean_inference_ms": 49.272382683816, "mean_action_processing_ms": 0.71391401265104, "mean_env_wait_ms": 0.6394843424673652, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05661797523498535, "StateBufferConnector_ms": 0.01483619213104248, "ViewRequirementAgentConnector_ms": 0.3635300397872925}, "num_episodes": 18, "episode_return_max": 314.0, "episode_return_min": -198.0, "episode_return_mean": 61.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.09691413611827, "num_env_steps_trained_throughput_per_sec": 236.09691413611827, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 211234.139, "restore_workers_time_ms": 0.022, "training_step_time_ms": 211234.063, "sample_time_ms": 95788.039, "learn_time_ms": 115413.998, "learn_throughput": 34.658, "synch_weights_time_ms": 25.159}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "4f45b_00000", "date": "2024-08-13_02-14-05", "timestamp": 1723529645, "time_this_iter_s": 17.046534776687622, "time_total_s": 3380.340316295624, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cd51f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3380.340316295624, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 89.43333333333332, "ram_util_percent": 83.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8883995747755444, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.566992573006443, "policy_loss": -0.004864399708566014, "vf_loss": 8.571721438756065, "vf_explained_var": 0.002747276945719643, "kl": 0.014456132505077464, "entropy": 1.3252187052101054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.063469232114219, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.05700094636786, "policy_loss": -0.0010725890865263643, "vf_loss": 8.058055004240975, "vf_explained_var": -0.13098957721518462, "kl": 0.011857255276630233, "entropy": 1.2974220447439366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 314.0, "episode_reward_min": -375.0, "episode_reward_mean": 45.35, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -373.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 181.0}, "policy_reward_mean": {"prey_policy": -27.85, "predator_policy": 50.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, 167.0, 12.0, 74.0, 174.0, 143.0, 50.0, 18.0, 41.0, 190.0, 207.0, 139.0, 92.0, 45.0, 112.0, 31.0, 137.0, 44.0, 200.0, 314.0, 178.0, 298.0, 124.0, 103.0, -198.0, -129.0, 122.0, 48.0, -47.0, 191.0, 146.0, -28.0, 178.0, 10.0, 46.0, 103.0, -50.0, 118.0, -12.0, 40.0, 121.0, 102.0, 64.0, 60.0, -106.0, 170.0, -14.0, -80.0, -18.0, 128.0, -13.0, 77.0, 140.0, 158.0, -19.0, -2.0, -16.0, 172.0, 42.0, 54.0, 270.0, 105.0, 27.0, -157.0, 59.0, 36.0, -7.0, -58.0, -174.0, -72.0, 49.0, -81.0, 23.0, 142.0, 196.0, 235.0, 276.0, -123.0, 109.0, 19.0, 100.0, 29.0, 5.0, -123.0, -237.0, -77.0, 0.0, 78.0, 35.0, -56.0, 229.0, -179.0, -219.0, -15.0, -48.0, 59.0, -65.0, -375.0, 92.0, -45.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-24.0, 11.0, 98.0, 33.0, -8.0, 13.0, 66.0, -55.0, 61.0, 29.0, 92.0, 21.0, 57.0, -207.0, 0.0, 18.0, -134.0, 78.0, -3.0, 109.0, 97.0, 49.0, 14.0, 30.0, -52.0, 57.0, 122.0, -248.0, 8.0, 59.0, -38.0, -28.0, 86.0, -20.0, 8.0, -59.0, 0.0, 200.0, 189.0, 125.0, 98.0, -19.0, 198.0, 34.0, 33.0, -2.0, -96.0, 64.0, -180.0, -189.0, -306.0, -29.0, 0.0, 105.0, 22.0, 12.0, -186.0, -18.0, 127.0, 63.0, 63.0, 81.0, 26.0, -184.0, 96.0, 82.0, 0.0, -77.0, -88.0, 28.0, 42.0, -86.0, -278.0, 36.0, 92.0, -73.0, -128.0, 2.0, 12.0, -32.0, 100.0, -18.0, -59.0, 103.0, -27.0, 62.0, -12.0, 20.0, 0.0, -249.0, 90.0, 50.0, -61.0, -73.0, -229.0, 12.0, -110.0, 1.0, 0.0, 106.0, -65.0, -70.0, 0.0, 24.0, 44.0, 61.0, 21.0, 80.0, -44.0, -83.0, 38.0, -154.0, 21.0, -106.0, 148.0, 23.0, -6.0, 4.0, 0.0, 37.0, 80.0, 179.0, 53.0, -16.0, 60.0, -180.0, -175.0, -169.0, 26.0, -75.0, 0.0, -67.0, 7.0, -31.0, -103.0, -86.0, -173.0, -284.0, -343.0, -5.0, -14.0, -6.0, -206.0, -38.0, 4.0, -50.0, -15.0, 38.0, 111.0, 37.0, 145.0, 34.0, 97.0, 179.0, -136.0, -277.0, 23.0, 49.0, -90.0, -16.0, 51.0, -2.0, 15.0, -60.0, -53.0, -79.0, -173.0, -223.0, -190.0, -309.0, -69.0, -291.0, -198.0, 20.0, 7.0, 15.0, 25.0, -94.0, -188.0, 0.0, 70.0, 76.0, -282.0, -214.0, -258.0, -259.0, -24.0, -131.0, 0.0, -151.0, 34.0, -12.0, -55.0, -212.0, -349.0, -373.0, 5.0, 76.0, -150.0, -10.0], "policy_predator_policy_reward": [15.0, 20.0, 18.0, 18.0, 4.0, 3.0, 63.0, 0.0, 74.0, 10.0, 0.0, 30.0, 75.0, 125.0, 0.0, 0.0, 30.0, 67.0, 0.0, 84.0, 42.0, 19.0, 61.0, 34.0, 83.0, 4.0, 82.0, 89.0, 21.0, 24.0, 97.0, 0.0, 22.0, 49.0, 72.0, 23.0, 0.0, 0.0, 0.0, 0.0, 29.0, 70.0, 11.0, 55.0, 41.0, 52.0, 65.0, 70.0, 50.0, 121.0, 153.0, 53.0, 17.0, 0.0, 10.0, 4.0, 72.0, 85.0, 1.0, 0.0, 2.0, 0.0, 51.0, 79.0, 0.0, 0.0, 0.0, 87.0, 95.0, 11.0, 68.0, 79.0, 162.0, 30.0, 80.0, 19.0, 89.0, 25.0, 14.0, 46.0, 0.0, 39.0, 37.0, 21.0, 0.0, 29.0, 52.0, 0.0, 47.0, 96.0, 5.0, 25.0, 61.0, 59.0, 0.0, 137.0, 52.0, 39.0, 2.0, 20.0, 99.0, 23.0, 0.0, 53.0, 0.0, 35.0, 43.0, 14.0, 59.0, 49.0, 114.0, 0.0, 69.0, 0.0, 0.0, 1.0, 14.0, 30.0, 6.0, 11.0, 11.0, 0.0, 29.0, 39.0, 49.0, 98.0, 124.0, 63.0, 70.0, 38.0, 44.0, 59.0, 0.0, 17.0, 127.0, 4.0, 154.0, 129.0, 139.0, 137.0, 69.0, 0.0, 118.0, 45.0, 45.0, 24.0, 50.0, 69.0, 36.0, 12.0, 36.0, 20.0, 0.0, 0.0, 134.0, 156.0, 18.0, 19.0, 58.0, 67.0, 34.0, 17.0, 52.0, 22.0, 79.0, 58.0, 125.0, 148.0, 175.0, 87.0, 129.0, 154.0, 118.0, 60.0, 0.0, 56.0, 41.0, 63.0, 55.0, 77.0, 72.0, 11.0, 173.0, 144.0, 176.0, 122.0, 75.0, 65.0, 103.0, 0.0, 11.0, 26.0, 131.0, 71.0, 181.0, 166.0, 0.0, 11.0, 78.0, 37.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8134595630291923, "mean_inference_ms": 66.10816609409547, "mean_action_processing_ms": 0.7167320294253219, "mean_env_wait_ms": 0.6429844994790354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04124641418457031, "StateBufferConnector_ms": 0.004703044891357422, "ViewRequirementAgentConnector_ms": 0.27738142013549805}, "num_episodes": 22, "episode_return_max": 314.0, "episode_return_min": -375.0, "episode_return_mean": 45.35, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.42564371322416, "num_env_steps_trained_throughput_per_sec": 230.42564371322416, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 210629.934, "restore_workers_time_ms": 0.023, "training_step_time_ms": 210629.855, "sample_time_ms": 95659.352, "learn_time_ms": 114939.404, "learn_throughput": 34.801, "synch_weights_time_ms": 24.522}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "4f45b_00000", "date": "2024-08-13_02-14-23", "timestamp": 1723529663, "time_this_iter_s": 17.417541027069092, "time_total_s": 3397.757857322693, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb40d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3397.757857322693, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 91.75200000000001, "ram_util_percent": 83.624}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.015044053837105, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.825937428045525, "policy_loss": -0.0059980617626693355, "vf_loss": 6.831763887405396, "vf_explained_var": -0.002747614831520767, "kl": 0.018306195437613283, "entropy": 1.3163797960710273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.137947233707186, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.538493337580767, "policy_loss": -0.004805117367308528, "vf_loss": 7.54328013904511, "vf_explained_var": -0.09475139694869833, "kl": 0.011721797604680255, "entropy": 1.3999223524931246, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 276.0, "episode_reward_min": -375.0, "episode_reward_mean": 6.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -373.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 181.0}, "policy_reward_mean": {"prey_policy": -57.0, "predator_policy": 60.16}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.0, -198.0, -129.0, 122.0, 48.0, -47.0, 191.0, 146.0, -28.0, 178.0, 10.0, 46.0, 103.0, -50.0, 118.0, -12.0, 40.0, 121.0, 102.0, 64.0, 60.0, -106.0, 170.0, -14.0, -80.0, -18.0, 128.0, -13.0, 77.0, 140.0, 158.0, -19.0, -2.0, -16.0, 172.0, 42.0, 54.0, 270.0, 105.0, 27.0, -157.0, 59.0, 36.0, -7.0, -58.0, -174.0, -72.0, 49.0, -81.0, 23.0, 142.0, 196.0, 235.0, 276.0, -123.0, 109.0, 19.0, 100.0, 29.0, 5.0, -123.0, -237.0, -77.0, 0.0, 78.0, 35.0, -56.0, 229.0, -179.0, -219.0, -15.0, -48.0, 59.0, -65.0, -375.0, 92.0, -45.0, -31.0, 50.0, 100.0, -166.0, 14.0, 11.0, -100.0, -193.0, -8.0, -7.0, -26.0, -150.0, 22.0, -16.0, -16.0, -34.0, 26.0, -124.0, -40.0, -261.0, -33.0, -42.0, -67.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-96.0, 64.0, -180.0, -189.0, -306.0, -29.0, 0.0, 105.0, 22.0, 12.0, -186.0, -18.0, 127.0, 63.0, 63.0, 81.0, 26.0, -184.0, 96.0, 82.0, 0.0, -77.0, -88.0, 28.0, 42.0, -86.0, -278.0, 36.0, 92.0, -73.0, -128.0, 2.0, 12.0, -32.0, 100.0, -18.0, -59.0, 103.0, -27.0, 62.0, -12.0, 20.0, 0.0, -249.0, 90.0, 50.0, -61.0, -73.0, -229.0, 12.0, -110.0, 1.0, 0.0, 106.0, -65.0, -70.0, 0.0, 24.0, 44.0, 61.0, 21.0, 80.0, -44.0, -83.0, 38.0, -154.0, 21.0, -106.0, 148.0, 23.0, -6.0, 4.0, 0.0, 37.0, 80.0, 179.0, 53.0, -16.0, 60.0, -180.0, -175.0, -169.0, 26.0, -75.0, 0.0, -67.0, 7.0, -31.0, -103.0, -86.0, -173.0, -284.0, -343.0, -5.0, -14.0, -6.0, -206.0, -38.0, 4.0, -50.0, -15.0, 38.0, 111.0, 37.0, 145.0, 34.0, 97.0, 179.0, -136.0, -277.0, 23.0, 49.0, -90.0, -16.0, 51.0, -2.0, 15.0, -60.0, -53.0, -79.0, -173.0, -223.0, -190.0, -309.0, -69.0, -291.0, -198.0, 20.0, 7.0, 15.0, 25.0, -94.0, -188.0, 0.0, 70.0, 76.0, -282.0, -214.0, -258.0, -259.0, -24.0, -131.0, 0.0, -151.0, 34.0, -12.0, -55.0, -212.0, -349.0, -373.0, 5.0, 76.0, -150.0, -10.0, -267.0, 33.0, 40.0, -2.0, 51.0, 42.0, -193.0, -95.0, -109.0, -47.0, -149.0, -2.0, -148.0, -195.0, -230.0, -106.0, 0.0, -218.0, -14.0, 0.0, 0.0, -81.0, -236.0, -184.0, 9.0, -10.0, -101.0, 4.0, -3.0, -220.0, 4.0, -174.0, -87.0, 27.0, -168.0, -238.0, -13.0, -143.0, -256.0, -293.0, -335.0, -25.0, -6.0, -266.0, -71.0, -159.0], "policy_predator_policy_reward": [65.0, 70.0, 50.0, 121.0, 153.0, 53.0, 17.0, 0.0, 10.0, 4.0, 72.0, 85.0, 1.0, 0.0, 2.0, 0.0, 51.0, 79.0, 0.0, 0.0, 0.0, 87.0, 95.0, 11.0, 68.0, 79.0, 162.0, 30.0, 80.0, 19.0, 89.0, 25.0, 14.0, 46.0, 0.0, 39.0, 37.0, 21.0, 0.0, 29.0, 52.0, 0.0, 47.0, 96.0, 5.0, 25.0, 61.0, 59.0, 0.0, 137.0, 52.0, 39.0, 2.0, 20.0, 99.0, 23.0, 0.0, 53.0, 0.0, 35.0, 43.0, 14.0, 59.0, 49.0, 114.0, 0.0, 69.0, 0.0, 0.0, 1.0, 14.0, 30.0, 6.0, 11.0, 11.0, 0.0, 29.0, 39.0, 49.0, 98.0, 124.0, 63.0, 70.0, 38.0, 44.0, 59.0, 0.0, 17.0, 127.0, 4.0, 154.0, 129.0, 139.0, 137.0, 69.0, 0.0, 118.0, 45.0, 45.0, 24.0, 50.0, 69.0, 36.0, 12.0, 36.0, 20.0, 0.0, 0.0, 134.0, 156.0, 18.0, 19.0, 58.0, 67.0, 34.0, 17.0, 52.0, 22.0, 79.0, 58.0, 125.0, 148.0, 175.0, 87.0, 129.0, 154.0, 118.0, 60.0, 0.0, 56.0, 41.0, 63.0, 55.0, 77.0, 72.0, 11.0, 173.0, 144.0, 176.0, 122.0, 75.0, 65.0, 103.0, 0.0, 11.0, 26.0, 131.0, 71.0, 181.0, 166.0, 0.0, 11.0, 78.0, 37.0, 133.0, 70.0, 0.0, 12.0, 6.0, 1.0, 117.0, 5.0, 59.0, 111.0, 91.0, 71.0, 123.0, 120.0, 43.0, 100.0, 86.0, 124.0, 5.0, 2.0, 34.0, 21.0, 139.0, 131.0, 6.0, 17.0, 36.0, 45.0, 116.0, 91.0, 94.0, 42.0, 48.0, 38.0, 147.0, 135.0, 55.0, 61.0, 140.0, 148.0, 167.0, 160.0, 137.0, 93.0, 72.0, 91.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.808612209173391, "mean_inference_ms": 83.0816008047007, "mean_action_processing_ms": 0.7678812992268798, "mean_env_wait_ms": 0.6476550665142136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04098689556121826, "StateBufferConnector_ms": 0.004701137542724609, "ViewRequirementAgentConnector_ms": 0.27329957485198975}, "num_episodes": 23, "episode_return_max": 276.0, "episode_return_min": -375.0, "episode_return_mean": 6.32, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 183.11190778857568, "num_env_steps_trained_throughput_per_sec": 183.11190778857568, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 210593.83, "restore_workers_time_ms": 0.023, "training_step_time_ms": 210593.751, "sample_time_ms": 95882.642, "learn_time_ms": 114680.196, "learn_throughput": 34.88, "synch_weights_time_ms": 24.391}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "4f45b_00000", "date": "2024-08-13_02-14-44", "timestamp": 1723529684, "time_this_iter_s": 21.89434003829956, "time_total_s": 3419.6521973609924, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1ce0160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3419.6521973609924, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 92.64516129032255, "ram_util_percent": 83.741935483871}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9419129290987575, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.712492132817626, "policy_loss": -0.0035098172644172946, "vf_loss": 4.715843683071237, "vf_explained_var": 0.0018273644031040251, "kl": 0.01688108646138031, "entropy": 1.3124585858097784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.093145564427136, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4948923502018845, "policy_loss": -0.0017448278536980667, "vf_loss": 5.496624973842076, "vf_explained_var": -0.09886707130563323, "kl": 0.007809531436746138, "entropy": 1.5087160599294793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 276.0, "episode_reward_min": -375.0, "episode_reward_mean": -3.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -373.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 181.0}, "policy_reward_mean": {"prey_policy": -59.875, "predator_policy": 57.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [102.0, 64.0, 60.0, -106.0, 170.0, -14.0, -80.0, -18.0, 128.0, -13.0, 77.0, 140.0, 158.0, -19.0, -2.0, -16.0, 172.0, 42.0, 54.0, 270.0, 105.0, 27.0, -157.0, 59.0, 36.0, -7.0, -58.0, -174.0, -72.0, 49.0, -81.0, 23.0, 142.0, 196.0, 235.0, 276.0, -123.0, 109.0, 19.0, 100.0, 29.0, 5.0, -123.0, -237.0, -77.0, 0.0, 78.0, 35.0, -56.0, 229.0, -179.0, -219.0, -15.0, -48.0, 59.0, -65.0, -375.0, 92.0, -45.0, -31.0, 50.0, 100.0, -166.0, 14.0, 11.0, -100.0, -193.0, -8.0, -7.0, -26.0, -150.0, 22.0, -16.0, -16.0, -34.0, 26.0, -124.0, -40.0, -261.0, -33.0, -42.0, -67.0, -21.0, 26.0, -84.0, -8.0, 25.0, -44.0, -65.0, -2.0, 32.0, 42.0, -20.0, -35.0, 28.0, -11.0, -51.0, 40.0, -91.0, -12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-59.0, 103.0, -27.0, 62.0, -12.0, 20.0, 0.0, -249.0, 90.0, 50.0, -61.0, -73.0, -229.0, 12.0, -110.0, 1.0, 0.0, 106.0, -65.0, -70.0, 0.0, 24.0, 44.0, 61.0, 21.0, 80.0, -44.0, -83.0, 38.0, -154.0, 21.0, -106.0, 148.0, 23.0, -6.0, 4.0, 0.0, 37.0, 80.0, 179.0, 53.0, -16.0, 60.0, -180.0, -175.0, -169.0, 26.0, -75.0, 0.0, -67.0, 7.0, -31.0, -103.0, -86.0, -173.0, -284.0, -343.0, -5.0, -14.0, -6.0, -206.0, -38.0, 4.0, -50.0, -15.0, 38.0, 111.0, 37.0, 145.0, 34.0, 97.0, 179.0, -136.0, -277.0, 23.0, 49.0, -90.0, -16.0, 51.0, -2.0, 15.0, -60.0, -53.0, -79.0, -173.0, -223.0, -190.0, -309.0, -69.0, -291.0, -198.0, 20.0, 7.0, 15.0, 25.0, -94.0, -188.0, 0.0, 70.0, 76.0, -282.0, -214.0, -258.0, -259.0, -24.0, -131.0, 0.0, -151.0, 34.0, -12.0, -55.0, -212.0, -349.0, -373.0, 5.0, 76.0, -150.0, -10.0, -267.0, 33.0, 40.0, -2.0, 51.0, 42.0, -193.0, -95.0, -109.0, -47.0, -149.0, -2.0, -148.0, -195.0, -230.0, -106.0, 0.0, -218.0, -14.0, 0.0, 0.0, -81.0, -236.0, -184.0, 9.0, -10.0, -101.0, 4.0, -3.0, -220.0, 4.0, -174.0, -87.0, 27.0, -168.0, -238.0, -13.0, -143.0, -256.0, -293.0, -335.0, -25.0, -6.0, -266.0, -71.0, -159.0, -9.0, -81.0, -63.0, 2.0, -91.0, -165.0, -31.0, -60.0, 11.0, -9.0, 30.0, -170.0, -101.0, -111.0, -4.0, 0.0, 22.0, 6.0, 16.0, 4.0, 0.0, -53.0, -33.0, -94.0, 11.0, 17.0, -101.0, -36.0, -19.0, -154.0, -34.0, 33.0, -145.0, -49.0, -20.0, -9.0], "policy_predator_policy_reward": [37.0, 21.0, 0.0, 29.0, 52.0, 0.0, 47.0, 96.0, 5.0, 25.0, 61.0, 59.0, 0.0, 137.0, 52.0, 39.0, 2.0, 20.0, 99.0, 23.0, 0.0, 53.0, 0.0, 35.0, 43.0, 14.0, 59.0, 49.0, 114.0, 0.0, 69.0, 0.0, 0.0, 1.0, 14.0, 30.0, 6.0, 11.0, 11.0, 0.0, 29.0, 39.0, 49.0, 98.0, 124.0, 63.0, 70.0, 38.0, 44.0, 59.0, 0.0, 17.0, 127.0, 4.0, 154.0, 129.0, 139.0, 137.0, 69.0, 0.0, 118.0, 45.0, 45.0, 24.0, 50.0, 69.0, 36.0, 12.0, 36.0, 20.0, 0.0, 0.0, 134.0, 156.0, 18.0, 19.0, 58.0, 67.0, 34.0, 17.0, 52.0, 22.0, 79.0, 58.0, 125.0, 148.0, 175.0, 87.0, 129.0, 154.0, 118.0, 60.0, 0.0, 56.0, 41.0, 63.0, 55.0, 77.0, 72.0, 11.0, 173.0, 144.0, 176.0, 122.0, 75.0, 65.0, 103.0, 0.0, 11.0, 26.0, 131.0, 71.0, 181.0, 166.0, 0.0, 11.0, 78.0, 37.0, 133.0, 70.0, 0.0, 12.0, 6.0, 1.0, 117.0, 5.0, 59.0, 111.0, 91.0, 71.0, 123.0, 120.0, 43.0, 100.0, 86.0, 124.0, 5.0, 2.0, 34.0, 21.0, 139.0, 131.0, 6.0, 17.0, 36.0, 45.0, 116.0, 91.0, 94.0, 42.0, 48.0, 38.0, 147.0, 135.0, 55.0, 61.0, 140.0, 148.0, 167.0, 160.0, 137.0, 93.0, 72.0, 91.0, 13.0, 56.0, 35.0, 52.0, 101.0, 71.0, 39.0, 44.0, 23.0, 0.0, 64.0, 32.0, 87.0, 60.0, 2.0, 0.0, 0.0, 4.0, 22.0, 0.0, 4.0, 29.0, 48.0, 44.0, 0.0, 0.0, 35.0, 91.0, 73.0, 49.0, 28.0, 13.0, 95.0, 8.0, 13.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.782594281667731, "mean_inference_ms": 81.20419191887014, "mean_action_processing_ms": 0.7937749294209538, "mean_env_wait_ms": 0.6380123958928187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007772326469421387, "StateBufferConnector_ms": 0.004184246063232422, "ViewRequirementAgentConnector_ms": 0.13777446746826172}, "num_episodes": 18, "episode_return_max": 276.0, "episode_return_min": -375.0, "episode_return_mean": -3.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 224.41714593407502, "num_env_steps_trained_throughput_per_sec": 224.41714593407502, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 210093.976, "restore_workers_time_ms": 0.022, "training_step_time_ms": 210093.898, "sample_time_ms": 95763.913, "learn_time_ms": 114299.471, "learn_throughput": 34.996, "synch_weights_time_ms": 23.966}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "4f45b_00000", "date": "2024-08-13_02-15-02", "timestamp": 1723529702, "time_this_iter_s": 17.895041942596436, "time_total_s": 3437.547239303589, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cd51f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3437.547239303589, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 87.41599999999998, "ram_util_percent": 83.332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9524877863270896, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.9160862324729795, "policy_loss": -0.0055571517772805045, "vf_loss": 5.921465562386487, "vf_explained_var": -0.0027823326133546377, "kl": 0.01896795068051231, "entropy": 1.2852176658060186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5814705168719962, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.349696839675701, "policy_loss": 0.0018241680026419027, "vf_loss": 5.347845809926431, "vf_explained_var": -0.02578469227861475, "kl": 0.017184000995932057, "entropy": 1.5625873635685632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 276.0, "episode_reward_min": -375.0, "episode_reward_mean": -17.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -373.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 179.0, "predator_policy": 181.0}, "policy_reward_mean": {"prey_policy": -67.785, "predator_policy": 59.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [54.0, 270.0, 105.0, 27.0, -157.0, 59.0, 36.0, -7.0, -58.0, -174.0, -72.0, 49.0, -81.0, 23.0, 142.0, 196.0, 235.0, 276.0, -123.0, 109.0, 19.0, 100.0, 29.0, 5.0, -123.0, -237.0, -77.0, 0.0, 78.0, 35.0, -56.0, 229.0, -179.0, -219.0, -15.0, -48.0, 59.0, -65.0, -375.0, 92.0, -45.0, -31.0, 50.0, 100.0, -166.0, 14.0, 11.0, -100.0, -193.0, -8.0, -7.0, -26.0, -150.0, 22.0, -16.0, -16.0, -34.0, 26.0, -124.0, -40.0, -261.0, -33.0, -42.0, -67.0, -21.0, 26.0, -84.0, -8.0, 25.0, -44.0, -65.0, -2.0, 32.0, 42.0, -20.0, -35.0, 28.0, -11.0, -51.0, 40.0, -91.0, -12.0, -37.0, 0.0, -11.0, -40.0, -54.0, -88.0, -58.0, 3.0, -127.0, -151.0, 4.0, -22.0, 43.0, 23.0, 31.0, -25.0, -21.0, 9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 37.0, 80.0, 179.0, 53.0, -16.0, 60.0, -180.0, -175.0, -169.0, 26.0, -75.0, 0.0, -67.0, 7.0, -31.0, -103.0, -86.0, -173.0, -284.0, -343.0, -5.0, -14.0, -6.0, -206.0, -38.0, 4.0, -50.0, -15.0, 38.0, 111.0, 37.0, 145.0, 34.0, 97.0, 179.0, -136.0, -277.0, 23.0, 49.0, -90.0, -16.0, 51.0, -2.0, 15.0, -60.0, -53.0, -79.0, -173.0, -223.0, -190.0, -309.0, -69.0, -291.0, -198.0, 20.0, 7.0, 15.0, 25.0, -94.0, -188.0, 0.0, 70.0, 76.0, -282.0, -214.0, -258.0, -259.0, -24.0, -131.0, 0.0, -151.0, 34.0, -12.0, -55.0, -212.0, -349.0, -373.0, 5.0, 76.0, -150.0, -10.0, -267.0, 33.0, 40.0, -2.0, 51.0, 42.0, -193.0, -95.0, -109.0, -47.0, -149.0, -2.0, -148.0, -195.0, -230.0, -106.0, 0.0, -218.0, -14.0, 0.0, 0.0, -81.0, -236.0, -184.0, 9.0, -10.0, -101.0, 4.0, -3.0, -220.0, 4.0, -174.0, -87.0, 27.0, -168.0, -238.0, -13.0, -143.0, -256.0, -293.0, -335.0, -25.0, -6.0, -266.0, -71.0, -159.0, -9.0, -81.0, -63.0, 2.0, -91.0, -165.0, -31.0, -60.0, 11.0, -9.0, 30.0, -170.0, -101.0, -111.0, -4.0, 0.0, 22.0, 6.0, 16.0, 4.0, 0.0, -53.0, -33.0, -94.0, 11.0, 17.0, -101.0, -36.0, -19.0, -154.0, -34.0, 33.0, -145.0, -49.0, -20.0, -9.0, -62.0, -67.0, -49.0, 0.0, -39.0, 5.0, -50.0, -148.0, -13.0, -194.0, -174.0, -46.0, 0.0, -289.0, 13.0, -51.0, -246.0, -90.0, -102.0, -160.0, 0.0, -38.0, -113.0, -10.0, 15.0, 24.0, 1.0, 0.0, 14.0, 10.0, -14.0, -91.0, -26.0, -20.0, -4.0, -8.0], "policy_predator_policy_reward": [6.0, 11.0, 11.0, 0.0, 29.0, 39.0, 49.0, 98.0, 124.0, 63.0, 70.0, 38.0, 44.0, 59.0, 0.0, 17.0, 127.0, 4.0, 154.0, 129.0, 139.0, 137.0, 69.0, 0.0, 118.0, 45.0, 45.0, 24.0, 50.0, 69.0, 36.0, 12.0, 36.0, 20.0, 0.0, 0.0, 134.0, 156.0, 18.0, 19.0, 58.0, 67.0, 34.0, 17.0, 52.0, 22.0, 79.0, 58.0, 125.0, 148.0, 175.0, 87.0, 129.0, 154.0, 118.0, 60.0, 0.0, 56.0, 41.0, 63.0, 55.0, 77.0, 72.0, 11.0, 173.0, 144.0, 176.0, 122.0, 75.0, 65.0, 103.0, 0.0, 11.0, 26.0, 131.0, 71.0, 181.0, 166.0, 0.0, 11.0, 78.0, 37.0, 133.0, 70.0, 0.0, 12.0, 6.0, 1.0, 117.0, 5.0, 59.0, 111.0, 91.0, 71.0, 123.0, 120.0, 43.0, 100.0, 86.0, 124.0, 5.0, 2.0, 34.0, 21.0, 139.0, 131.0, 6.0, 17.0, 36.0, 45.0, 116.0, 91.0, 94.0, 42.0, 48.0, 38.0, 147.0, 135.0, 55.0, 61.0, 140.0, 148.0, 167.0, 160.0, 137.0, 93.0, 72.0, 91.0, 13.0, 56.0, 35.0, 52.0, 101.0, 71.0, 39.0, 44.0, 23.0, 0.0, 64.0, 32.0, 87.0, 60.0, 2.0, 0.0, 0.0, 4.0, 22.0, 0.0, 4.0, 29.0, 48.0, 44.0, 0.0, 0.0, 35.0, 91.0, 73.0, 49.0, 28.0, 13.0, 95.0, 8.0, 13.0, 4.0, 24.0, 68.0, 14.0, 35.0, 14.0, 9.0, 107.0, 51.0, 80.0, 73.0, 60.0, 72.0, 142.0, 89.0, 18.0, 23.0, 145.0, 64.0, 74.0, 37.0, 6.0, 36.0, 48.0, 53.0, 1.0, 3.0, 14.0, 8.0, 1.0, 6.0, 45.0, 35.0, 24.0, 1.0, 21.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.757818262318458, "mean_inference_ms": 78.627165042532, "mean_action_processing_ms": 0.8186660985859335, "mean_env_wait_ms": 0.628739313396754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007834553718566895, "StateBufferConnector_ms": 0.004408001899719238, "ViewRequirementAgentConnector_ms": 0.14621412754058838}, "num_episodes": 18, "episode_return_max": 276.0, "episode_return_min": -375.0, "episode_return_mean": -17.47, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.97049226186664, "num_env_steps_trained_throughput_per_sec": 214.97049226186664, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 209687.737, "restore_workers_time_ms": 0.022, "training_step_time_ms": 209687.661, "sample_time_ms": 95699.167, "learn_time_ms": 113955.732, "learn_throughput": 35.101, "synch_weights_time_ms": 26.2}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "4f45b_00000", "date": "2024-08-13_02-15-21", "timestamp": 1723529721, "time_this_iter_s": 18.654279947280884, "time_total_s": 3456.2015192508698, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cd54c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3456.2015192508698, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 87.71923076923076, "ram_util_percent": 83.65384615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7908821604081563, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.132881729691117, "policy_loss": -0.007818863007102024, "vf_loss": 6.140498224641911, "vf_explained_var": -0.00014928232425104372, "kl": 0.021587195063900347, "entropy": 1.2227324593634832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.678689605111956, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.425491598926524, "policy_loss": -0.009139595958330329, "vf_loss": 5.434612744447415, "vf_explained_var": -0.001535992458383873, "kl": 0.011815320120472754, "entropy": 1.5450351734640737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 229.0, "episode_reward_min": -375.0, "episode_reward_mean": -37.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -373.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 76.0, "predator_policy": 181.0}, "policy_reward_mean": {"prey_policy": -80.34, "predator_policy": 61.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-123.0, 109.0, 19.0, 100.0, 29.0, 5.0, -123.0, -237.0, -77.0, 0.0, 78.0, 35.0, -56.0, 229.0, -179.0, -219.0, -15.0, -48.0, 59.0, -65.0, -375.0, 92.0, -45.0, -31.0, 50.0, 100.0, -166.0, 14.0, 11.0, -100.0, -193.0, -8.0, -7.0, -26.0, -150.0, 22.0, -16.0, -16.0, -34.0, 26.0, -124.0, -40.0, -261.0, -33.0, -42.0, -67.0, -21.0, 26.0, -84.0, -8.0, 25.0, -44.0, -65.0, -2.0, 32.0, 42.0, -20.0, -35.0, 28.0, -11.0, -51.0, 40.0, -91.0, -12.0, -37.0, 0.0, -11.0, -40.0, -54.0, -88.0, -58.0, 3.0, -127.0, -151.0, 4.0, -22.0, 43.0, 23.0, 31.0, -25.0, -21.0, 9.0, -110.0, -67.0, -3.0, -165.0, -30.0, 8.0, -7.0, 2.0, -67.0, -33.0, -143.0, -111.0, -85.0, -4.0, -132.0, -1.0, -54.0, -109.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-136.0, -277.0, 23.0, 49.0, -90.0, -16.0, 51.0, -2.0, 15.0, -60.0, -53.0, -79.0, -173.0, -223.0, -190.0, -309.0, -69.0, -291.0, -198.0, 20.0, 7.0, 15.0, 25.0, -94.0, -188.0, 0.0, 70.0, 76.0, -282.0, -214.0, -258.0, -259.0, -24.0, -131.0, 0.0, -151.0, 34.0, -12.0, -55.0, -212.0, -349.0, -373.0, 5.0, 76.0, -150.0, -10.0, -267.0, 33.0, 40.0, -2.0, 51.0, 42.0, -193.0, -95.0, -109.0, -47.0, -149.0, -2.0, -148.0, -195.0, -230.0, -106.0, 0.0, -218.0, -14.0, 0.0, 0.0, -81.0, -236.0, -184.0, 9.0, -10.0, -101.0, 4.0, -3.0, -220.0, 4.0, -174.0, -87.0, 27.0, -168.0, -238.0, -13.0, -143.0, -256.0, -293.0, -335.0, -25.0, -6.0, -266.0, -71.0, -159.0, -9.0, -81.0, -63.0, 2.0, -91.0, -165.0, -31.0, -60.0, 11.0, -9.0, 30.0, -170.0, -101.0, -111.0, -4.0, 0.0, 22.0, 6.0, 16.0, 4.0, 0.0, -53.0, -33.0, -94.0, 11.0, 17.0, -101.0, -36.0, -19.0, -154.0, -34.0, 33.0, -145.0, -49.0, -20.0, -9.0, -62.0, -67.0, -49.0, 0.0, -39.0, 5.0, -50.0, -148.0, -13.0, -194.0, -174.0, -46.0, 0.0, -289.0, 13.0, -51.0, -246.0, -90.0, -102.0, -160.0, 0.0, -38.0, -113.0, -10.0, 15.0, 24.0, 1.0, 0.0, 14.0, 10.0, -14.0, -91.0, -26.0, -20.0, -4.0, -8.0, -107.0, -169.0, -123.0, -75.0, -32.0, -2.0, -225.0, -149.0, 1.0, -99.0, -108.0, -14.0, -68.0, 2.0, 0.0, 2.0, -180.0, -30.0, 0.0, -270.0, -149.0, -188.0, -6.0, -307.0, -186.0, -61.0, -39.0, -79.0, -196.0, -121.0, 3.0, -56.0, -26.0, -113.0, -81.0, -209.0], "policy_predator_policy_reward": [134.0, 156.0, 18.0, 19.0, 58.0, 67.0, 34.0, 17.0, 52.0, 22.0, 79.0, 58.0, 125.0, 148.0, 175.0, 87.0, 129.0, 154.0, 118.0, 60.0, 0.0, 56.0, 41.0, 63.0, 55.0, 77.0, 72.0, 11.0, 173.0, 144.0, 176.0, 122.0, 75.0, 65.0, 103.0, 0.0, 11.0, 26.0, 131.0, 71.0, 181.0, 166.0, 0.0, 11.0, 78.0, 37.0, 133.0, 70.0, 0.0, 12.0, 6.0, 1.0, 117.0, 5.0, 59.0, 111.0, 91.0, 71.0, 123.0, 120.0, 43.0, 100.0, 86.0, 124.0, 5.0, 2.0, 34.0, 21.0, 139.0, 131.0, 6.0, 17.0, 36.0, 45.0, 116.0, 91.0, 94.0, 42.0, 48.0, 38.0, 147.0, 135.0, 55.0, 61.0, 140.0, 148.0, 167.0, 160.0, 137.0, 93.0, 72.0, 91.0, 13.0, 56.0, 35.0, 52.0, 101.0, 71.0, 39.0, 44.0, 23.0, 0.0, 64.0, 32.0, 87.0, 60.0, 2.0, 0.0, 0.0, 4.0, 22.0, 0.0, 4.0, 29.0, 48.0, 44.0, 0.0, 0.0, 35.0, 91.0, 73.0, 49.0, 28.0, 13.0, 95.0, 8.0, 13.0, 4.0, 24.0, 68.0, 14.0, 35.0, 14.0, 9.0, 107.0, 51.0, 80.0, 73.0, 60.0, 72.0, 142.0, 89.0, 18.0, 23.0, 145.0, 64.0, 74.0, 37.0, 6.0, 36.0, 48.0, 53.0, 1.0, 3.0, 14.0, 8.0, 1.0, 6.0, 45.0, 35.0, 24.0, 1.0, 21.0, 0.0, 97.0, 69.0, 59.0, 72.0, 19.0, 12.0, 62.0, 147.0, 55.0, 13.0, 66.0, 64.0, 17.0, 42.0, 0.0, 0.0, 70.0, 73.0, 107.0, 130.0, 77.0, 117.0, 74.0, 128.0, 77.0, 85.0, 43.0, 71.0, 102.0, 83.0, 18.0, 34.0, 53.0, 32.0, 107.0, 74.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.738046150310672, "mean_inference_ms": 76.24030905471, "mean_action_processing_ms": 0.8445282737627889, "mean_env_wait_ms": 0.621245519514134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008014440536499023, "StateBufferConnector_ms": 0.0047757625579833984, "ViewRequirementAgentConnector_ms": 0.18230605125427246}, "num_episodes": 18, "episode_return_max": 229.0, "episode_return_min": -375.0, "episode_return_mean": -37.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 203.63051900693526, "num_env_steps_trained_throughput_per_sec": 203.63051900693526, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 111977.674, "restore_workers_time_ms": 0.02, "training_step_time_ms": 111977.601, "sample_time_ms": 95691.249, "learn_time_ms": 16256.305, "learn_throughput": 246.058, "synch_weights_time_ms": 24.211}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "4f45b_00000", "date": "2024-08-13_02-15-41", "timestamp": 1723529741, "time_this_iter_s": 19.69221568107605, "time_total_s": 3475.893734931946, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cc4af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3475.893734931946, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 86.01428571428573, "ram_util_percent": 83.63928571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7556246722028369, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5594434231046646, "policy_loss": -0.006523842279301592, "vf_loss": 3.565709103856768, "vf_explained_var": -0.003912770968896371, "kl": 0.018357827896493796, "entropy": 1.144473690709109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6301761670954644, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0644569243072834, "policy_loss": -0.004664193132951382, "vf_loss": 3.0691078010690274, "vf_explained_var": 0.011636483416986212, "kl": 0.008519708143722425, "entropy": 1.5083765069643655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 43.0, "episode_reward_min": -261.0, "episode_reward_mean": -40.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -335.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 33.0, "predator_policy": 167.0}, "policy_reward_mean": {"prey_policy": -72.705, "predator_policy": 52.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 11.0, -100.0, -193.0, -8.0, -7.0, -26.0, -150.0, 22.0, -16.0, -16.0, -34.0, 26.0, -124.0, -40.0, -261.0, -33.0, -42.0, -67.0, -21.0, 26.0, -84.0, -8.0, 25.0, -44.0, -65.0, -2.0, 32.0, 42.0, -20.0, -35.0, 28.0, -11.0, -51.0, 40.0, -91.0, -12.0, -37.0, 0.0, -11.0, -40.0, -54.0, -88.0, -58.0, 3.0, -127.0, -151.0, 4.0, -22.0, 43.0, 23.0, 31.0, -25.0, -21.0, 9.0, -110.0, -67.0, -3.0, -165.0, -30.0, 8.0, -7.0, 2.0, -67.0, -33.0, -143.0, -111.0, -85.0, -4.0, -132.0, -1.0, -54.0, -109.0, -99.0, -64.0, -9.0, -11.0, -20.0, -46.0, -146.0, -12.0, -92.0, -88.0, -12.0, 15.0, -161.0, -25.0, -16.0, -24.0, 0.0, -53.0, -14.0, -2.0, -36.0, -16.0, 0.0, -60.0, -45.0, -76.0, 16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-109.0, -47.0, -149.0, -2.0, -148.0, -195.0, -230.0, -106.0, 0.0, -218.0, -14.0, 0.0, 0.0, -81.0, -236.0, -184.0, 9.0, -10.0, -101.0, 4.0, -3.0, -220.0, 4.0, -174.0, -87.0, 27.0, -168.0, -238.0, -13.0, -143.0, -256.0, -293.0, -335.0, -25.0, -6.0, -266.0, -71.0, -159.0, -9.0, -81.0, -63.0, 2.0, -91.0, -165.0, -31.0, -60.0, 11.0, -9.0, 30.0, -170.0, -101.0, -111.0, -4.0, 0.0, 22.0, 6.0, 16.0, 4.0, 0.0, -53.0, -33.0, -94.0, 11.0, 17.0, -101.0, -36.0, -19.0, -154.0, -34.0, 33.0, -145.0, -49.0, -20.0, -9.0, -62.0, -67.0, -49.0, 0.0, -39.0, 5.0, -50.0, -148.0, -13.0, -194.0, -174.0, -46.0, 0.0, -289.0, 13.0, -51.0, -246.0, -90.0, -102.0, -160.0, 0.0, -38.0, -113.0, -10.0, 15.0, 24.0, 1.0, 0.0, 14.0, 10.0, -14.0, -91.0, -26.0, -20.0, -4.0, -8.0, -107.0, -169.0, -123.0, -75.0, -32.0, -2.0, -225.0, -149.0, 1.0, -99.0, -108.0, -14.0, -68.0, 2.0, 0.0, 2.0, -180.0, -30.0, 0.0, -270.0, -149.0, -188.0, -6.0, -307.0, -186.0, -61.0, -39.0, -79.0, -196.0, -121.0, 3.0, -56.0, -26.0, -113.0, -81.0, -209.0, -290.0, -133.0, -53.0, -82.0, 0.0, -22.0, 0.0, -28.0, 0.0, -60.0, -4.0, -138.0, -109.0, -145.0, -2.0, -80.0, -116.0, -63.0, -82.0, -158.0, -35.0, -10.0, 16.0, -44.0, -88.0, -232.0, -46.0, -4.0, 0.0, -81.0, -12.0, -166.0, 0.0, 0.0, -94.0, -30.0, -47.0, -25.0, -113.0, 0.0, -129.0, -8.0, -8.0, -24.0, 0.0, 0.0, -62.0, -81.0, -38.0, -133.0, -144.0, -60.0, -32.0, -31.0], "policy_predator_policy_reward": [59.0, 111.0, 91.0, 71.0, 123.0, 120.0, 43.0, 100.0, 86.0, 124.0, 5.0, 2.0, 34.0, 21.0, 139.0, 131.0, 6.0, 17.0, 36.0, 45.0, 116.0, 91.0, 94.0, 42.0, 48.0, 38.0, 147.0, 135.0, 55.0, 61.0, 140.0, 148.0, 167.0, 160.0, 137.0, 93.0, 72.0, 91.0, 13.0, 56.0, 35.0, 52.0, 101.0, 71.0, 39.0, 44.0, 23.0, 0.0, 64.0, 32.0, 87.0, 60.0, 2.0, 0.0, 0.0, 4.0, 22.0, 0.0, 4.0, 29.0, 48.0, 44.0, 0.0, 0.0, 35.0, 91.0, 73.0, 49.0, 28.0, 13.0, 95.0, 8.0, 13.0, 4.0, 24.0, 68.0, 14.0, 35.0, 14.0, 9.0, 107.0, 51.0, 80.0, 73.0, 60.0, 72.0, 142.0, 89.0, 18.0, 23.0, 145.0, 64.0, 74.0, 37.0, 6.0, 36.0, 48.0, 53.0, 1.0, 3.0, 14.0, 8.0, 1.0, 6.0, 45.0, 35.0, 24.0, 1.0, 21.0, 0.0, 97.0, 69.0, 59.0, 72.0, 19.0, 12.0, 62.0, 147.0, 55.0, 13.0, 66.0, 64.0, 17.0, 42.0, 0.0, 0.0, 70.0, 73.0, 107.0, 130.0, 77.0, 117.0, 74.0, 128.0, 77.0, 85.0, 43.0, 71.0, 102.0, 83.0, 18.0, 34.0, 53.0, 32.0, 107.0, 74.0, 167.0, 157.0, 26.0, 45.0, 13.0, 0.0, 4.0, 13.0, 25.0, 15.0, 49.0, 47.0, 0.0, 108.0, 15.0, 55.0, 15.0, 72.0, 67.0, 85.0, 5.0, 28.0, 23.0, 20.0, 123.0, 36.0, 23.0, 2.0, 32.0, 33.0, 69.0, 85.0, 0.0, 0.0, 55.0, 16.0, 4.0, 54.0, 63.0, 48.0, 61.0, 40.0, 11.0, 5.0, 0.0, 0.0, 44.0, 39.0, 69.0, 57.0, 52.0, 76.0, 29.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7130856487185366, "mean_inference_ms": 73.04420853814837, "mean_action_processing_ms": 0.8777815680380485, "mean_env_wait_ms": 0.6125844417265665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011792659759521484, "StateBufferConnector_ms": 0.004704594612121582, "ViewRequirementAgentConnector_ms": 0.24395668506622314}, "num_episodes": 27, "episode_return_max": 43.0, "episode_return_min": -261.0, "episode_return_mean": -40.23, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.66950364078627, "num_env_steps_trained_throughput_per_sec": 202.66950364078627, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 111435.887, "restore_workers_time_ms": 0.017, "training_step_time_ms": 111435.821, "sample_time_ms": 95241.453, "learn_time_ms": 16165.125, "learn_throughput": 247.446, "synch_weights_time_ms": 24.791}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "4f45b_00000", "date": "2024-08-13_02-16-01", "timestamp": 1723529761, "time_this_iter_s": 19.79615592956543, "time_total_s": 3495.6898908615112, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1ce0160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3495.6898908615112, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 85.96785714285714, "ram_util_percent": 83.3892857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7301366865871445, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0859559748538588, "policy_loss": -0.004361226279214616, "vf_loss": 3.090208307523576, "vf_explained_var": -0.004731323857786794, "kl": 0.007743524936948164, "entropy": 1.0980926335804047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.644755841834993, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.727422003014378, "policy_loss": -0.00476420863516747, "vf_loss": 3.7321710761892732, "vf_explained_var": 0.004018810249510265, "kl": 0.00969178348583497, "entropy": 1.5096359887451092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 43.0, "episode_reward_min": -220.0, "episode_reward_mean": -37.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 37.0, "predator_policy": 187.0}, "policy_reward_mean": {"prey_policy": -61.585, "predator_policy": 42.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-67.0, -21.0, 26.0, -84.0, -8.0, 25.0, -44.0, -65.0, -2.0, 32.0, 42.0, -20.0, -35.0, 28.0, -11.0, -51.0, 40.0, -91.0, -12.0, -37.0, 0.0, -11.0, -40.0, -54.0, -88.0, -58.0, 3.0, -127.0, -151.0, 4.0, -22.0, 43.0, 23.0, 31.0, -25.0, -21.0, 9.0, -110.0, -67.0, -3.0, -165.0, -30.0, 8.0, -7.0, 2.0, -67.0, -33.0, -143.0, -111.0, -85.0, -4.0, -132.0, -1.0, -54.0, -109.0, -99.0, -64.0, -9.0, -11.0, -20.0, -46.0, -146.0, -12.0, -92.0, -88.0, -12.0, 15.0, -161.0, -25.0, -16.0, -24.0, 0.0, -53.0, -14.0, -2.0, -36.0, -16.0, 0.0, -60.0, -45.0, -76.0, 16.0, 11.0, -13.0, -130.0, 13.0, -69.0, -13.0, -48.0, -220.0, -43.0, 5.0, 0.0, -3.0, -30.0, -121.0, -22.0, -26.0, -1.0, -33.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-71.0, -159.0, -9.0, -81.0, -63.0, 2.0, -91.0, -165.0, -31.0, -60.0, 11.0, -9.0, 30.0, -170.0, -101.0, -111.0, -4.0, 0.0, 22.0, 6.0, 16.0, 4.0, 0.0, -53.0, -33.0, -94.0, 11.0, 17.0, -101.0, -36.0, -19.0, -154.0, -34.0, 33.0, -145.0, -49.0, -20.0, -9.0, -62.0, -67.0, -49.0, 0.0, -39.0, 5.0, -50.0, -148.0, -13.0, -194.0, -174.0, -46.0, 0.0, -289.0, 13.0, -51.0, -246.0, -90.0, -102.0, -160.0, 0.0, -38.0, -113.0, -10.0, 15.0, 24.0, 1.0, 0.0, 14.0, 10.0, -14.0, -91.0, -26.0, -20.0, -4.0, -8.0, -107.0, -169.0, -123.0, -75.0, -32.0, -2.0, -225.0, -149.0, 1.0, -99.0, -108.0, -14.0, -68.0, 2.0, 0.0, 2.0, -180.0, -30.0, 0.0, -270.0, -149.0, -188.0, -6.0, -307.0, -186.0, -61.0, -39.0, -79.0, -196.0, -121.0, 3.0, -56.0, -26.0, -113.0, -81.0, -209.0, -290.0, -133.0, -53.0, -82.0, 0.0, -22.0, 0.0, -28.0, 0.0, -60.0, -4.0, -138.0, -109.0, -145.0, -2.0, -80.0, -116.0, -63.0, -82.0, -158.0, -35.0, -10.0, 16.0, -44.0, -88.0, -232.0, -46.0, -4.0, 0.0, -81.0, -12.0, -166.0, 0.0, 0.0, -94.0, -30.0, -47.0, -25.0, -113.0, 0.0, -129.0, -8.0, -8.0, -24.0, 0.0, 0.0, -62.0, -81.0, -38.0, -133.0, -144.0, -60.0, -32.0, -31.0, 11.0, -6.0, -30.0, 0.0, -80.0, -144.0, -44.0, -40.0, -70.0, -40.0, -76.0, 9.0, -8.0, -92.0, -364.0, -44.0, -34.0, -86.0, -64.0, 37.0, 0.0, 0.0, -2.0, -4.0, -105.0, 0.0, -196.0, -48.0, -45.0, -40.0, -31.0, -37.0, 0.0, -2.0, -114.0, 0.0], "policy_predator_policy_reward": [72.0, 91.0, 13.0, 56.0, 35.0, 52.0, 101.0, 71.0, 39.0, 44.0, 23.0, 0.0, 64.0, 32.0, 87.0, 60.0, 2.0, 0.0, 0.0, 4.0, 22.0, 0.0, 4.0, 29.0, 48.0, 44.0, 0.0, 0.0, 35.0, 91.0, 73.0, 49.0, 28.0, 13.0, 95.0, 8.0, 13.0, 4.0, 24.0, 68.0, 14.0, 35.0, 14.0, 9.0, 107.0, 51.0, 80.0, 73.0, 60.0, 72.0, 142.0, 89.0, 18.0, 23.0, 145.0, 64.0, 74.0, 37.0, 6.0, 36.0, 48.0, 53.0, 1.0, 3.0, 14.0, 8.0, 1.0, 6.0, 45.0, 35.0, 24.0, 1.0, 21.0, 0.0, 97.0, 69.0, 59.0, 72.0, 19.0, 12.0, 62.0, 147.0, 55.0, 13.0, 66.0, 64.0, 17.0, 42.0, 0.0, 0.0, 70.0, 73.0, 107.0, 130.0, 77.0, 117.0, 74.0, 128.0, 77.0, 85.0, 43.0, 71.0, 102.0, 83.0, 18.0, 34.0, 53.0, 32.0, 107.0, 74.0, 167.0, 157.0, 26.0, 45.0, 13.0, 0.0, 4.0, 13.0, 25.0, 15.0, 49.0, 47.0, 0.0, 108.0, 15.0, 55.0, 15.0, 72.0, 67.0, 85.0, 5.0, 28.0, 23.0, 20.0, 123.0, 36.0, 23.0, 2.0, 32.0, 33.0, 69.0, 85.0, 0.0, 0.0, 55.0, 16.0, 4.0, 54.0, 63.0, 48.0, 61.0, 40.0, 11.0, 5.0, 0.0, 0.0, 44.0, 39.0, 69.0, 57.0, 52.0, 76.0, 29.0, 50.0, 1.0, 5.0, 2.0, 15.0, 85.0, 9.0, 48.0, 49.0, 41.0, 0.0, 25.0, 29.0, 4.0, 48.0, 1.0, 187.0, 50.0, 27.0, 0.0, 32.0, 0.0, 0.0, 1.0, 2.0, 53.0, 22.0, 108.0, 15.0, 32.0, 31.0, 1.0, 41.0, 0.0, 1.0, 57.0, 24.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6992023131464686, "mean_inference_ms": 70.9896720411351, "mean_action_processing_ms": 0.8641265171625441, "mean_env_wait_ms": 0.6068239441056319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010717511177062988, "StateBufferConnector_ms": 0.004784107208251953, "ViewRequirementAgentConnector_ms": 0.2459508180618286}, "num_episodes": 18, "episode_return_max": 43.0, "episode_return_min": -220.0, "episode_return_mean": -37.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.4036186394019, "num_env_steps_trained_throughput_per_sec": 194.4036186394019, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 111815.894, "restore_workers_time_ms": 0.017, "training_step_time_ms": 111815.83, "sample_time_ms": 95239.088, "learn_time_ms": 16547.071, "learn_throughput": 241.735, "synch_weights_time_ms": 25.288}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "4f45b_00000", "date": "2024-08-13_02-16-21", "timestamp": 1723529781, "time_this_iter_s": 20.615144968032837, "time_total_s": 3516.305035829544, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1ce0ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3516.305035829544, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 86.21034482758623, "ram_util_percent": 83.61724137931034}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9113130569221481, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.6396617837683864, "policy_loss": -0.00391516469963506, "vf_loss": 4.643353946499093, "vf_explained_var": 0.008329407437137826, "kl": 0.015856965206852845, "entropy": 1.0494816942189735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4253822785245363, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.769058029235356, "policy_loss": -0.006735793315120554, "vf_loss": 5.77576942670913, "vf_explained_var": 0.002804873513166236, "kl": 0.015618978003971728, "entropy": 1.4588373983347858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 43.0, "episode_reward_min": -254.0, "episode_reward_mean": -45.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 37.0, "predator_policy": 187.0}, "policy_reward_mean": {"prey_policy": -65.595, "predator_policy": 42.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -37.0, 0.0, -11.0, -40.0, -54.0, -88.0, -58.0, 3.0, -127.0, -151.0, 4.0, -22.0, 43.0, 23.0, 31.0, -25.0, -21.0, 9.0, -110.0, -67.0, -3.0, -165.0, -30.0, 8.0, -7.0, 2.0, -67.0, -33.0, -143.0, -111.0, -85.0, -4.0, -132.0, -1.0, -54.0, -109.0, -99.0, -64.0, -9.0, -11.0, -20.0, -46.0, -146.0, -12.0, -92.0, -88.0, -12.0, 15.0, -161.0, -25.0, -16.0, -24.0, 0.0, -53.0, -14.0, -2.0, -36.0, -16.0, 0.0, -60.0, -45.0, -76.0, 16.0, 11.0, -13.0, -130.0, 13.0, -69.0, -13.0, -48.0, -220.0, -43.0, 5.0, 0.0, -3.0, -30.0, -121.0, -22.0, -26.0, -1.0, -33.0, -1.0, -67.0, -11.0, -16.0, -254.0, -201.0, -15.0, -63.0, -119.0, -34.0, -28.0, -64.0, -72.0, -103.0, -27.0, -43.0, -16.0, 21.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, -9.0, -62.0, -67.0, -49.0, 0.0, -39.0, 5.0, -50.0, -148.0, -13.0, -194.0, -174.0, -46.0, 0.0, -289.0, 13.0, -51.0, -246.0, -90.0, -102.0, -160.0, 0.0, -38.0, -113.0, -10.0, 15.0, 24.0, 1.0, 0.0, 14.0, 10.0, -14.0, -91.0, -26.0, -20.0, -4.0, -8.0, -107.0, -169.0, -123.0, -75.0, -32.0, -2.0, -225.0, -149.0, 1.0, -99.0, -108.0, -14.0, -68.0, 2.0, 0.0, 2.0, -180.0, -30.0, 0.0, -270.0, -149.0, -188.0, -6.0, -307.0, -186.0, -61.0, -39.0, -79.0, -196.0, -121.0, 3.0, -56.0, -26.0, -113.0, -81.0, -209.0, -290.0, -133.0, -53.0, -82.0, 0.0, -22.0, 0.0, -28.0, 0.0, -60.0, -4.0, -138.0, -109.0, -145.0, -2.0, -80.0, -116.0, -63.0, -82.0, -158.0, -35.0, -10.0, 16.0, -44.0, -88.0, -232.0, -46.0, -4.0, 0.0, -81.0, -12.0, -166.0, 0.0, 0.0, -94.0, -30.0, -47.0, -25.0, -113.0, 0.0, -129.0, -8.0, -8.0, -24.0, 0.0, 0.0, -62.0, -81.0, -38.0, -133.0, -144.0, -60.0, -32.0, -31.0, 11.0, -6.0, -30.0, 0.0, -80.0, -144.0, -44.0, -40.0, -70.0, -40.0, -76.0, 9.0, -8.0, -92.0, -364.0, -44.0, -34.0, -86.0, -64.0, 37.0, 0.0, 0.0, -2.0, -4.0, -105.0, 0.0, -196.0, -48.0, -45.0, -40.0, -31.0, -37.0, 0.0, -2.0, -114.0, 0.0, -2.0, 0.0, -136.0, 0.0, -26.0, 0.0, 0.0, -54.0, -140.0, -318.0, -296.0, -78.0, -62.0, 0.0, -14.0, -182.0, -69.0, -165.0, -58.0, -29.0, -44.0, -18.0, -72.0, -58.0, -59.0, -80.0, -72.0, -193.0, 0.0, -87.0, -38.0, -64.0, -4.0, -88.0, 5.0, 8.0], "policy_predator_policy_reward": [13.0, 4.0, 24.0, 68.0, 14.0, 35.0, 14.0, 9.0, 107.0, 51.0, 80.0, 73.0, 60.0, 72.0, 142.0, 89.0, 18.0, 23.0, 145.0, 64.0, 74.0, 37.0, 6.0, 36.0, 48.0, 53.0, 1.0, 3.0, 14.0, 8.0, 1.0, 6.0, 45.0, 35.0, 24.0, 1.0, 21.0, 0.0, 97.0, 69.0, 59.0, 72.0, 19.0, 12.0, 62.0, 147.0, 55.0, 13.0, 66.0, 64.0, 17.0, 42.0, 0.0, 0.0, 70.0, 73.0, 107.0, 130.0, 77.0, 117.0, 74.0, 128.0, 77.0, 85.0, 43.0, 71.0, 102.0, 83.0, 18.0, 34.0, 53.0, 32.0, 107.0, 74.0, 167.0, 157.0, 26.0, 45.0, 13.0, 0.0, 4.0, 13.0, 25.0, 15.0, 49.0, 47.0, 0.0, 108.0, 15.0, 55.0, 15.0, 72.0, 67.0, 85.0, 5.0, 28.0, 23.0, 20.0, 123.0, 36.0, 23.0, 2.0, 32.0, 33.0, 69.0, 85.0, 0.0, 0.0, 55.0, 16.0, 4.0, 54.0, 63.0, 48.0, 61.0, 40.0, 11.0, 5.0, 0.0, 0.0, 44.0, 39.0, 69.0, 57.0, 52.0, 76.0, 29.0, 50.0, 1.0, 5.0, 2.0, 15.0, 85.0, 9.0, 48.0, 49.0, 41.0, 0.0, 25.0, 29.0, 4.0, 48.0, 1.0, 187.0, 50.0, 27.0, 0.0, 32.0, 0.0, 0.0, 1.0, 2.0, 53.0, 22.0, 108.0, 15.0, 32.0, 31.0, 1.0, 41.0, 0.0, 1.0, 57.0, 24.0, 1.0, 0.0, 67.0, 2.0, 5.0, 10.0, 14.0, 24.0, 35.0, 169.0, 139.0, 34.0, 29.0, 18.0, 95.0, 38.0, 11.0, 104.0, 14.0, 39.0, 22.0, 12.0, 27.0, 39.0, 16.0, 51.0, 96.0, 66.0, 15.0, 45.0, 6.0, 53.0, 46.0, 30.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6855469623977557, "mean_inference_ms": 69.04631446377124, "mean_action_processing_ms": 0.8536961127380213, "mean_env_wait_ms": 0.6019247530346018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010878682136535645, "StateBufferConnector_ms": 0.0049811601638793945, "ViewRequirementAgentConnector_ms": 0.25522100925445557}, "num_episodes": 18, "episode_return_max": 43.0, "episode_return_min": -254.0, "episode_return_mean": -45.96, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.8430221526777, "num_env_steps_trained_throughput_per_sec": 199.8430221526777, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 18855.513, "restore_workers_time_ms": 0.021, "training_step_time_ms": 18855.442, "sample_time_ms": 2709.409, "learn_time_ms": 16119.254, "learn_throughput": 248.15, "synch_weights_time_ms": 22.345}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "4f45b_00000", "date": "2024-08-13_02-16-42", "timestamp": 1723529802, "time_this_iter_s": 20.06288194656372, "time_total_s": 3536.367917776108, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb7a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3536.367917776108, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 84.26428571428572, "ram_util_percent": 83.5642857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8417714810245251, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.822859770154196, "policy_loss": -0.011223065884162981, "vf_loss": 6.8337444764596444, "vf_explained_var": 0.006397017032381088, "kl": 0.024061767179974294, "entropy": 1.008805102929867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4459865074703302, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.029168130733348, "policy_loss": -0.0031441349879882874, "vf_loss": 9.032283853601527, "vf_explained_var": 0.00029810048915721753, "kl": 0.01817611018527631, "entropy": 1.435318691452975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 21.0, "episode_reward_min": -402.0, "episode_reward_mean": -76.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -462.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 37.0, "predator_policy": 380.0}, "policy_reward_mean": {"prey_policy": -87.245, "predator_policy": 49.13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, -110.0, -67.0, -3.0, -165.0, -30.0, 8.0, -7.0, 2.0, -67.0, -33.0, -143.0, -111.0, -85.0, -4.0, -132.0, -1.0, -54.0, -109.0, -99.0, -64.0, -9.0, -11.0, -20.0, -46.0, -146.0, -12.0, -92.0, -88.0, -12.0, 15.0, -161.0, -25.0, -16.0, -24.0, 0.0, -53.0, -14.0, -2.0, -36.0, -16.0, 0.0, -60.0, -45.0, -76.0, 16.0, 11.0, -13.0, -130.0, 13.0, -69.0, -13.0, -48.0, -220.0, -43.0, 5.0, 0.0, -3.0, -30.0, -121.0, -22.0, -26.0, -1.0, -33.0, -1.0, -67.0, -11.0, -16.0, -254.0, -201.0, -15.0, -63.0, -119.0, -34.0, -28.0, -64.0, -72.0, -103.0, -27.0, -43.0, -16.0, 21.0, -334.0, -402.0, -72.0, -215.0, -260.0, -185.0, -243.0, -358.0, -2.0, -40.0, -3.0, -334.0, -25.0, -215.0, -25.0, -311.0, -287.0, -258.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, -8.0, -107.0, -169.0, -123.0, -75.0, -32.0, -2.0, -225.0, -149.0, 1.0, -99.0, -108.0, -14.0, -68.0, 2.0, 0.0, 2.0, -180.0, -30.0, 0.0, -270.0, -149.0, -188.0, -6.0, -307.0, -186.0, -61.0, -39.0, -79.0, -196.0, -121.0, 3.0, -56.0, -26.0, -113.0, -81.0, -209.0, -290.0, -133.0, -53.0, -82.0, 0.0, -22.0, 0.0, -28.0, 0.0, -60.0, -4.0, -138.0, -109.0, -145.0, -2.0, -80.0, -116.0, -63.0, -82.0, -158.0, -35.0, -10.0, 16.0, -44.0, -88.0, -232.0, -46.0, -4.0, 0.0, -81.0, -12.0, -166.0, 0.0, 0.0, -94.0, -30.0, -47.0, -25.0, -113.0, 0.0, -129.0, -8.0, -8.0, -24.0, 0.0, 0.0, -62.0, -81.0, -38.0, -133.0, -144.0, -60.0, -32.0, -31.0, 11.0, -6.0, -30.0, 0.0, -80.0, -144.0, -44.0, -40.0, -70.0, -40.0, -76.0, 9.0, -8.0, -92.0, -364.0, -44.0, -34.0, -86.0, -64.0, 37.0, 0.0, 0.0, -2.0, -4.0, -105.0, 0.0, -196.0, -48.0, -45.0, -40.0, -31.0, -37.0, 0.0, -2.0, -114.0, 0.0, -2.0, 0.0, -136.0, 0.0, -26.0, 0.0, 0.0, -54.0, -140.0, -318.0, -296.0, -78.0, -62.0, 0.0, -14.0, -182.0, -69.0, -165.0, -58.0, -29.0, -44.0, -18.0, -72.0, -58.0, -59.0, -80.0, -72.0, -193.0, 0.0, -87.0, -38.0, -64.0, -4.0, -88.0, 5.0, 8.0, -268.0, -200.0, -336.0, -428.0, -48.0, -66.0, -316.0, -223.0, -222.0, -211.0, -162.0, -150.0, -242.0, -180.0, -348.0, -244.0, 0.0, -4.0, -48.0, -36.0, 6.0, -30.0, -266.0, -462.0, -8.0, -42.0, -185.0, -140.0, -20.0, -39.0, -299.0, -234.0, -236.0, -254.0, -252.0, -176.0], "policy_predator_policy_reward": [21.0, 0.0, 97.0, 69.0, 59.0, 72.0, 19.0, 12.0, 62.0, 147.0, 55.0, 13.0, 66.0, 64.0, 17.0, 42.0, 0.0, 0.0, 70.0, 73.0, 107.0, 130.0, 77.0, 117.0, 74.0, 128.0, 77.0, 85.0, 43.0, 71.0, 102.0, 83.0, 18.0, 34.0, 53.0, 32.0, 107.0, 74.0, 167.0, 157.0, 26.0, 45.0, 13.0, 0.0, 4.0, 13.0, 25.0, 15.0, 49.0, 47.0, 0.0, 108.0, 15.0, 55.0, 15.0, 72.0, 67.0, 85.0, 5.0, 28.0, 23.0, 20.0, 123.0, 36.0, 23.0, 2.0, 32.0, 33.0, 69.0, 85.0, 0.0, 0.0, 55.0, 16.0, 4.0, 54.0, 63.0, 48.0, 61.0, 40.0, 11.0, 5.0, 0.0, 0.0, 44.0, 39.0, 69.0, 57.0, 52.0, 76.0, 29.0, 50.0, 1.0, 5.0, 2.0, 15.0, 85.0, 9.0, 48.0, 49.0, 41.0, 0.0, 25.0, 29.0, 4.0, 48.0, 1.0, 187.0, 50.0, 27.0, 0.0, 32.0, 0.0, 0.0, 1.0, 2.0, 53.0, 22.0, 108.0, 15.0, 32.0, 31.0, 1.0, 41.0, 0.0, 1.0, 57.0, 24.0, 1.0, 0.0, 67.0, 2.0, 5.0, 10.0, 14.0, 24.0, 35.0, 169.0, 139.0, 34.0, 29.0, 18.0, 95.0, 38.0, 11.0, 104.0, 14.0, 39.0, 22.0, 12.0, 27.0, 39.0, 16.0, 51.0, 96.0, 66.0, 15.0, 45.0, 6.0, 53.0, 46.0, 30.0, 8.0, 0.0, 59.0, 75.0, 361.0, 1.0, 25.0, 17.0, 52.0, 272.0, 153.0, 20.0, 38.0, 89.0, 56.0, 123.0, 234.0, 0.0, 1.0, 1.0, 17.0, 27.0, 15.0, 6.0, 14.0, 380.0, 17.0, 8.0, 97.0, 13.0, 16.0, 18.0, 18.0, 204.0, 195.0, 8.0, 36.0, 134.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6743854318684515, "mean_inference_ms": 67.22357828989736, "mean_action_processing_ms": 0.8445936348951539, "mean_env_wait_ms": 0.5975077304941978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01049351692199707, "StateBufferConnector_ms": 0.005082964897155762, "ViewRequirementAgentConnector_ms": 0.2557891607284546}, "num_episodes": 18, "episode_return_max": 21.0, "episode_return_min": -402.0, "episode_return_mean": -76.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.785396721726057, "num_env_steps_trained_throughput_per_sec": 3.785396721726057, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 122924.107, "restore_workers_time_ms": 0.022, "training_step_time_ms": 122924.035, "sample_time_ms": 2781.611, "learn_time_ms": 120115.981, "learn_throughput": 33.301, "synch_weights_time_ms": 22.7}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "4f45b_00000", "date": "2024-08-13_02-34-18", "timestamp": 1723530858, "time_this_iter_s": 1056.7619922161102, "time_total_s": 4593.129909992218, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cad5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4593.129909992218, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 93.49545454545455, "ram_util_percent": 83.43863636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6192352961334917, "cur_kl_coeff": 0.02109375, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.407590452325406, "policy_loss": -0.00992212966035204, "vf_loss": 9.417044547247508, "vf_explained_var": 0.0035685444950426695, "kl": 0.02218746630507613, "entropy": 0.9587091978895601, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9928616343312477, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.8112532161531, "policy_loss": -0.0032297218457435963, "vf_loss": 9.814459209341221, "vf_explained_var": 0.0025351222230013087, "kl": 0.015177222782776448, "entropy": 1.3939294471942558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 21.0, "episode_reward_min": -411.0, "episode_reward_mean": -121.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -714.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 37.0, "predator_policy": 560.0}, "policy_reward_mean": {"prey_policy": -139.005, "predator_policy": 78.415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, -20.0, -46.0, -146.0, -12.0, -92.0, -88.0, -12.0, 15.0, -161.0, -25.0, -16.0, -24.0, 0.0, -53.0, -14.0, -2.0, -36.0, -16.0, 0.0, -60.0, -45.0, -76.0, 16.0, 11.0, -13.0, -130.0, 13.0, -69.0, -13.0, -48.0, -220.0, -43.0, 5.0, 0.0, -3.0, -30.0, -121.0, -22.0, -26.0, -1.0, -33.0, -1.0, -67.0, -11.0, -16.0, -254.0, -201.0, -15.0, -63.0, -119.0, -34.0, -28.0, -64.0, -72.0, -103.0, -27.0, -43.0, -16.0, 21.0, -334.0, -402.0, -72.0, -215.0, -260.0, -185.0, -243.0, -358.0, -2.0, -40.0, -3.0, -334.0, -25.0, -215.0, -25.0, -311.0, -287.0, -258.0, -176.0, -205.0, -272.0, -353.0, -258.0, -237.0, -186.0, -411.0, -401.0, -297.0, -164.0, -309.0, -109.0, -395.0, -373.0, -228.0, -256.0, -358.0, -125.0, -383.0, -96.0, -177.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -28.0, 0.0, -60.0, -4.0, -138.0, -109.0, -145.0, -2.0, -80.0, -116.0, -63.0, -82.0, -158.0, -35.0, -10.0, 16.0, -44.0, -88.0, -232.0, -46.0, -4.0, 0.0, -81.0, -12.0, -166.0, 0.0, 0.0, -94.0, -30.0, -47.0, -25.0, -113.0, 0.0, -129.0, -8.0, -8.0, -24.0, 0.0, 0.0, -62.0, -81.0, -38.0, -133.0, -144.0, -60.0, -32.0, -31.0, 11.0, -6.0, -30.0, 0.0, -80.0, -144.0, -44.0, -40.0, -70.0, -40.0, -76.0, 9.0, -8.0, -92.0, -364.0, -44.0, -34.0, -86.0, -64.0, 37.0, 0.0, 0.0, -2.0, -4.0, -105.0, 0.0, -196.0, -48.0, -45.0, -40.0, -31.0, -37.0, 0.0, -2.0, -114.0, 0.0, -2.0, 0.0, -136.0, 0.0, -26.0, 0.0, 0.0, -54.0, -140.0, -318.0, -296.0, -78.0, -62.0, 0.0, -14.0, -182.0, -69.0, -165.0, -58.0, -29.0, -44.0, -18.0, -72.0, -58.0, -59.0, -80.0, -72.0, -193.0, 0.0, -87.0, -38.0, -64.0, -4.0, -88.0, 5.0, 8.0, -268.0, -200.0, -336.0, -428.0, -48.0, -66.0, -316.0, -223.0, -222.0, -211.0, -162.0, -150.0, -242.0, -180.0, -348.0, -244.0, 0.0, -4.0, -48.0, -36.0, 6.0, -30.0, -266.0, -462.0, -8.0, -42.0, -185.0, -140.0, -20.0, -39.0, -299.0, -234.0, -236.0, -254.0, -252.0, -176.0, -161.0, -311.0, -316.0, -306.0, -316.0, -340.0, -224.0, -410.0, -324.0, -342.0, -333.0, -551.0, -160.0, -120.0, -505.0, -406.0, -414.0, -486.0, -217.0, -350.0, -136.0, -216.0, -428.0, -370.0, -82.0, -122.0, -442.0, -468.0, -413.0, -412.0, -328.0, -520.0, -335.0, -324.0, -414.0, -484.0, -83.0, -214.0, -660.0, -714.0, -56.0, -101.0, -248.0, -242.0], "policy_predator_policy_reward": [4.0, 13.0, 25.0, 15.0, 49.0, 47.0, 0.0, 108.0, 15.0, 55.0, 15.0, 72.0, 67.0, 85.0, 5.0, 28.0, 23.0, 20.0, 123.0, 36.0, 23.0, 2.0, 32.0, 33.0, 69.0, 85.0, 0.0, 0.0, 55.0, 16.0, 4.0, 54.0, 63.0, 48.0, 61.0, 40.0, 11.0, 5.0, 0.0, 0.0, 44.0, 39.0, 69.0, 57.0, 52.0, 76.0, 29.0, 50.0, 1.0, 5.0, 2.0, 15.0, 85.0, 9.0, 48.0, 49.0, 41.0, 0.0, 25.0, 29.0, 4.0, 48.0, 1.0, 187.0, 50.0, 27.0, 0.0, 32.0, 0.0, 0.0, 1.0, 2.0, 53.0, 22.0, 108.0, 15.0, 32.0, 31.0, 1.0, 41.0, 0.0, 1.0, 57.0, 24.0, 1.0, 0.0, 67.0, 2.0, 5.0, 10.0, 14.0, 24.0, 35.0, 169.0, 139.0, 34.0, 29.0, 18.0, 95.0, 38.0, 11.0, 104.0, 14.0, 39.0, 22.0, 12.0, 27.0, 39.0, 16.0, 51.0, 96.0, 66.0, 15.0, 45.0, 6.0, 53.0, 46.0, 30.0, 8.0, 0.0, 59.0, 75.0, 361.0, 1.0, 25.0, 17.0, 52.0, 272.0, 153.0, 20.0, 38.0, 89.0, 56.0, 123.0, 234.0, 0.0, 1.0, 1.0, 17.0, 27.0, 15.0, 6.0, 14.0, 380.0, 17.0, 8.0, 97.0, 13.0, 16.0, 18.0, 18.0, 204.0, 195.0, 8.0, 36.0, 134.0, 156.0, 140.0, 161.0, 256.0, 249.0, 135.0, 278.0, 3.0, 273.0, 135.0, 470.0, 177.0, 15.0, 79.0, 414.0, 86.0, 430.0, 69.0, 192.0, 78.0, 113.0, 75.0, 100.0, 389.0, 68.0, 27.0, 40.0, 475.0, 419.0, 33.0, 343.0, 277.0, 143.0, 260.0, 230.0, 310.0, 128.0, 44.0, 431.0, 560.0, 61.0, 0.0, 131.0, 182.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6586482566621015, "mean_inference_ms": 65.18774179958042, "mean_action_processing_ms": 0.8319014007990646, "mean_env_wait_ms": 0.5909191363484682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0107499361038208, "StateBufferConnector_ms": 0.0073729753494262695, "ViewRequirementAgentConnector_ms": 0.2393510341644287}, "num_episodes": 22, "episode_return_max": 21.0, "episode_return_min": -411.0, "episode_return_mean": -121.18, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 225.91273352706074, "num_env_steps_trained_throughput_per_sec": 225.91273352706074, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 123000.484, "restore_workers_time_ms": 0.022, "training_step_time_ms": 123000.408, "sample_time_ms": 2860.148, "learn_time_ms": 120113.8, "learn_throughput": 33.302, "synch_weights_time_ms": 22.679}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "4f45b_00000", "date": "2024-08-13_02-34-36", "timestamp": 1723530876, "time_this_iter_s": 17.76637077331543, "time_total_s": 4610.896280765533, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cd5f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4610.896280765533, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 86.66153846153847, "ram_util_percent": 83.5076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.826530033913712, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.581462514968145, "policy_loss": -0.005214617529233533, "vf_loss": 9.586178521756773, "vf_explained_var": 0.00471632890600376, "kl": 0.015757541629973552, "entropy": 0.8816426622489142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.166366794303296, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.601316807762025, "policy_loss": -0.007456030931678556, "vf_loss": 9.608743774575531, "vf_explained_var": 0.007177361672517484, "kl": 0.018606756841653964, "entropy": 1.4786496626006231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 239.0, "episode_reward_min": -422.0, "episode_reward_mean": -154.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -936.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 37.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": -256.68, "predator_policy": 179.47}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, 11.0, -13.0, -130.0, 13.0, -69.0, -13.0, -48.0, -220.0, -43.0, 5.0, 0.0, -3.0, -30.0, -121.0, -22.0, -26.0, -1.0, -33.0, -1.0, -67.0, -11.0, -16.0, -254.0, -201.0, -15.0, -63.0, -119.0, -34.0, -28.0, -64.0, -72.0, -103.0, -27.0, -43.0, -16.0, 21.0, -334.0, -402.0, -72.0, -215.0, -260.0, -185.0, -243.0, -358.0, -2.0, -40.0, -3.0, -334.0, -25.0, -215.0, -25.0, -311.0, -287.0, -258.0, -176.0, -205.0, -272.0, -353.0, -258.0, -237.0, -186.0, -411.0, -401.0, -297.0, -164.0, -309.0, -109.0, -395.0, -373.0, -228.0, -256.0, -358.0, -125.0, -383.0, -96.0, -177.0, -373.0, -26.0, -202.0, 239.0, 72.0, -22.0, -395.0, -396.0, -422.0, -176.0, -33.0, -194.0, 59.0, -106.0, -310.0, -332.0, -102.0, -210.0, -336.0, -253.0, -320.0, -88.0, -338.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-32.0, -31.0, 11.0, -6.0, -30.0, 0.0, -80.0, -144.0, -44.0, -40.0, -70.0, -40.0, -76.0, 9.0, -8.0, -92.0, -364.0, -44.0, -34.0, -86.0, -64.0, 37.0, 0.0, 0.0, -2.0, -4.0, -105.0, 0.0, -196.0, -48.0, -45.0, -40.0, -31.0, -37.0, 0.0, -2.0, -114.0, 0.0, -2.0, 0.0, -136.0, 0.0, -26.0, 0.0, 0.0, -54.0, -140.0, -318.0, -296.0, -78.0, -62.0, 0.0, -14.0, -182.0, -69.0, -165.0, -58.0, -29.0, -44.0, -18.0, -72.0, -58.0, -59.0, -80.0, -72.0, -193.0, 0.0, -87.0, -38.0, -64.0, -4.0, -88.0, 5.0, 8.0, -268.0, -200.0, -336.0, -428.0, -48.0, -66.0, -316.0, -223.0, -222.0, -211.0, -162.0, -150.0, -242.0, -180.0, -348.0, -244.0, 0.0, -4.0, -48.0, -36.0, 6.0, -30.0, -266.0, -462.0, -8.0, -42.0, -185.0, -140.0, -20.0, -39.0, -299.0, -234.0, -236.0, -254.0, -252.0, -176.0, -161.0, -311.0, -316.0, -306.0, -316.0, -340.0, -224.0, -410.0, -324.0, -342.0, -333.0, -551.0, -160.0, -120.0, -505.0, -406.0, -414.0, -486.0, -217.0, -350.0, -136.0, -216.0, -428.0, -370.0, -82.0, -122.0, -442.0, -468.0, -413.0, -412.0, -328.0, -520.0, -335.0, -324.0, -414.0, -484.0, -83.0, -214.0, -660.0, -714.0, -56.0, -101.0, -248.0, -242.0, -575.0, -796.0, -301.0, -562.0, -746.0, -560.0, -44.0, -802.0, -240.0, -780.0, -850.0, -592.0, -924.0, -844.0, -558.0, -512.0, -519.0, -483.0, -526.0, -770.0, -408.0, -715.0, -206.0, -168.0, -558.0, -117.0, -599.0, -704.0, -490.0, -405.0, -413.0, -388.0, -568.0, -233.0, -503.0, -484.0, -864.0, -844.0, -882.0, -873.0, -326.0, -566.0, -777.0, -367.0, -840.0, -936.0], "policy_predator_policy_reward": [29.0, 50.0, 1.0, 5.0, 2.0, 15.0, 85.0, 9.0, 48.0, 49.0, 41.0, 0.0, 25.0, 29.0, 4.0, 48.0, 1.0, 187.0, 50.0, 27.0, 0.0, 32.0, 0.0, 0.0, 1.0, 2.0, 53.0, 22.0, 108.0, 15.0, 32.0, 31.0, 1.0, 41.0, 0.0, 1.0, 57.0, 24.0, 1.0, 0.0, 67.0, 2.0, 5.0, 10.0, 14.0, 24.0, 35.0, 169.0, 139.0, 34.0, 29.0, 18.0, 95.0, 38.0, 11.0, 104.0, 14.0, 39.0, 22.0, 12.0, 27.0, 39.0, 16.0, 51.0, 96.0, 66.0, 15.0, 45.0, 6.0, 53.0, 46.0, 30.0, 8.0, 0.0, 59.0, 75.0, 361.0, 1.0, 25.0, 17.0, 52.0, 272.0, 153.0, 20.0, 38.0, 89.0, 56.0, 123.0, 234.0, 0.0, 1.0, 1.0, 17.0, 27.0, 15.0, 6.0, 14.0, 380.0, 17.0, 8.0, 97.0, 13.0, 16.0, 18.0, 18.0, 204.0, 195.0, 8.0, 36.0, 134.0, 156.0, 140.0, 161.0, 256.0, 249.0, 135.0, 278.0, 3.0, 273.0, 135.0, 470.0, 177.0, 15.0, 79.0, 414.0, 86.0, 430.0, 69.0, 192.0, 78.0, 113.0, 75.0, 100.0, 389.0, 68.0, 27.0, 40.0, 475.0, 419.0, 33.0, 343.0, 277.0, 143.0, 260.0, 230.0, 310.0, 128.0, 44.0, 431.0, 560.0, 61.0, 0.0, 131.0, 182.0, 155.0, 843.0, 451.0, 386.0, 449.0, 655.0, 574.0, 511.0, 572.0, 520.0, 619.0, 801.0, 884.0, 489.0, 525.0, 149.0, 570.0, 10.0, 651.0, 469.0, 526.0, 564.0, 79.0, 101.0, 410.0, 324.0, 769.0, 428.0, 196.0, 389.0, 116.0, 353.0, 406.0, 293.0, 321.0, 456.0, 920.0, 452.0, 717.0, 785.0, 410.0, 162.0, 399.0, 657.0, 880.0, 558.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6429087554944652, "mean_inference_ms": 63.134747173507876, "mean_action_processing_ms": 0.8216743644474467, "mean_env_wait_ms": 0.5850625739249461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006010532379150391, "StateBufferConnector_ms": 0.0071114301681518555, "ViewRequirementAgentConnector_ms": 0.1924530267715454}, "num_episodes": 23, "episode_return_max": 239.0, "episode_return_min": -422.0, "episode_return_mean": -154.42, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 12.274476580444004, "num_env_steps_trained_throughput_per_sec": 12.274476580444004, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 153852.512, "restore_workers_time_ms": 0.021, "training_step_time_ms": 153852.434, "sample_time_ms": 2799.051, "learn_time_ms": 151026.73, "learn_throughput": 26.485, "synch_weights_time_ms": 22.988}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "4f45b_00000", "date": "2024-08-13_02-40-02", "timestamp": 1723531202, "time_this_iter_s": 325.93997406959534, "time_total_s": 4936.836254835129, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb74c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4936.836254835129, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 89.1, "ram_util_percent": 83.58378378378382}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8233949137230714, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.561378042533915, "policy_loss": -0.00561180546603821, "vf_loss": 9.566564507963797, "vf_explained_var": 0.002102203091616353, "kl": 0.013442444017118528, "entropy": 0.8343002059156932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7978647898823497, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.871293582613506, "policy_loss": -0.009407236313240395, "vf_loss": 8.880669866289411, "vf_explained_var": 0.00553607527541105, "kl": 0.019817178341919067, "entropy": 1.5494738855059185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 239.0, "episode_reward_min": -422.0, "episode_reward_mean": -144.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -998.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 8.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": -331.87, "predator_policy": 259.57}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.0, -1.0, -67.0, -11.0, -16.0, -254.0, -201.0, -15.0, -63.0, -119.0, -34.0, -28.0, -64.0, -72.0, -103.0, -27.0, -43.0, -16.0, 21.0, -334.0, -402.0, -72.0, -215.0, -260.0, -185.0, -243.0, -358.0, -2.0, -40.0, -3.0, -334.0, -25.0, -215.0, -25.0, -311.0, -287.0, -258.0, -176.0, -205.0, -272.0, -353.0, -258.0, -237.0, -186.0, -411.0, -401.0, -297.0, -164.0, -309.0, -109.0, -395.0, -373.0, -228.0, -256.0, -358.0, -125.0, -383.0, -96.0, -177.0, -373.0, -26.0, -202.0, 239.0, 72.0, -22.0, -395.0, -396.0, -422.0, -176.0, -33.0, -194.0, 59.0, -106.0, -310.0, -332.0, -102.0, -210.0, -336.0, -253.0, -320.0, -88.0, -338.0, 181.0, 102.0, -79.0, 137.0, -73.0, -195.0, -85.0, -67.0, 125.0, -97.0, -175.0, 6.0, 153.0, 34.0, 21.0, -64.0, 161.0, 203.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-114.0, 0.0, -2.0, 0.0, -136.0, 0.0, -26.0, 0.0, 0.0, -54.0, -140.0, -318.0, -296.0, -78.0, -62.0, 0.0, -14.0, -182.0, -69.0, -165.0, -58.0, -29.0, -44.0, -18.0, -72.0, -58.0, -59.0, -80.0, -72.0, -193.0, 0.0, -87.0, -38.0, -64.0, -4.0, -88.0, 5.0, 8.0, -268.0, -200.0, -336.0, -428.0, -48.0, -66.0, -316.0, -223.0, -222.0, -211.0, -162.0, -150.0, -242.0, -180.0, -348.0, -244.0, 0.0, -4.0, -48.0, -36.0, 6.0, -30.0, -266.0, -462.0, -8.0, -42.0, -185.0, -140.0, -20.0, -39.0, -299.0, -234.0, -236.0, -254.0, -252.0, -176.0, -161.0, -311.0, -316.0, -306.0, -316.0, -340.0, -224.0, -410.0, -324.0, -342.0, -333.0, -551.0, -160.0, -120.0, -505.0, -406.0, -414.0, -486.0, -217.0, -350.0, -136.0, -216.0, -428.0, -370.0, -82.0, -122.0, -442.0, -468.0, -413.0, -412.0, -328.0, -520.0, -335.0, -324.0, -414.0, -484.0, -83.0, -214.0, -660.0, -714.0, -56.0, -101.0, -248.0, -242.0, -575.0, -796.0, -301.0, -562.0, -746.0, -560.0, -44.0, -802.0, -240.0, -780.0, -850.0, -592.0, -924.0, -844.0, -558.0, -512.0, -519.0, -483.0, -526.0, -770.0, -408.0, -715.0, -206.0, -168.0, -558.0, -117.0, -599.0, -704.0, -490.0, -405.0, -413.0, -388.0, -568.0, -233.0, -503.0, -484.0, -864.0, -844.0, -882.0, -873.0, -326.0, -566.0, -777.0, -367.0, -840.0, -936.0, -998.0, -116.0, -510.0, -12.0, -234.0, -724.0, -589.0, -618.0, -195.0, -516.0, -573.0, -490.0, -616.0, -658.0, -157.0, -189.0, -6.0, -589.0, -446.0, -726.0, -730.0, -586.0, -621.0, 0.0, -289.0, -918.0, -270.0, -816.0, -534.0, -48.0, -376.0, -450.0, -726.0, -524.0, -308.0, -618.0], "policy_predator_policy_reward": [57.0, 24.0, 1.0, 0.0, 67.0, 2.0, 5.0, 10.0, 14.0, 24.0, 35.0, 169.0, 139.0, 34.0, 29.0, 18.0, 95.0, 38.0, 11.0, 104.0, 14.0, 39.0, 22.0, 12.0, 27.0, 39.0, 16.0, 51.0, 96.0, 66.0, 15.0, 45.0, 6.0, 53.0, 46.0, 30.0, 8.0, 0.0, 59.0, 75.0, 361.0, 1.0, 25.0, 17.0, 52.0, 272.0, 153.0, 20.0, 38.0, 89.0, 56.0, 123.0, 234.0, 0.0, 1.0, 1.0, 17.0, 27.0, 15.0, 6.0, 14.0, 380.0, 17.0, 8.0, 97.0, 13.0, 16.0, 18.0, 18.0, 204.0, 195.0, 8.0, 36.0, 134.0, 156.0, 140.0, 161.0, 256.0, 249.0, 135.0, 278.0, 3.0, 273.0, 135.0, 470.0, 177.0, 15.0, 79.0, 414.0, 86.0, 430.0, 69.0, 192.0, 78.0, 113.0, 75.0, 100.0, 389.0, 68.0, 27.0, 40.0, 475.0, 419.0, 33.0, 343.0, 277.0, 143.0, 260.0, 230.0, 310.0, 128.0, 44.0, 431.0, 560.0, 61.0, 0.0, 131.0, 182.0, 155.0, 843.0, 451.0, 386.0, 449.0, 655.0, 574.0, 511.0, 572.0, 520.0, 619.0, 801.0, 884.0, 489.0, 525.0, 149.0, 570.0, 10.0, 651.0, 469.0, 526.0, 564.0, 79.0, 101.0, 410.0, 324.0, 769.0, 428.0, 196.0, 389.0, 116.0, 353.0, 406.0, 293.0, 321.0, 456.0, 920.0, 452.0, 717.0, 785.0, 410.0, 162.0, 399.0, 657.0, 880.0, 558.0, 737.0, 558.0, 275.0, 349.0, 512.0, 367.0, 653.0, 691.0, 428.0, 210.0, 504.0, 364.0, 568.0, 621.0, 87.0, 192.0, 417.0, 303.0, 502.0, 573.0, 630.0, 511.0, 305.0, 322.0, 525.0, 835.0, 503.0, 617.0, 171.0, 432.0, 390.0, 372.0, 710.0, 701.0, 550.0, 579.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6285323481426541, "mean_inference_ms": 61.5950084411044, "mean_action_processing_ms": 0.8121146776299508, "mean_env_wait_ms": 0.57942603986481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005933046340942383, "StateBufferConnector_ms": 0.006910800933837891, "ViewRequirementAgentConnector_ms": 0.21403825283050537}, "num_episodes": 18, "episode_return_max": 239.0, "episode_return_min": -422.0, "episode_return_mean": -144.6, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 226.98142751120727, "num_env_steps_trained_throughput_per_sec": 226.98142751120727, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 153430.314, "restore_workers_time_ms": 0.021, "training_step_time_ms": 153430.229, "sample_time_ms": 2497.881, "learn_time_ms": 150906.402, "learn_throughput": 26.506, "synch_weights_time_ms": 22.989}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "4f45b_00000", "date": "2024-08-13_02-40-20", "timestamp": 1723531220, "time_this_iter_s": 17.678985834121704, "time_total_s": 4954.5152406692505, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20ab040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4954.5152406692505, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 85.0, "ram_util_percent": 83.74400000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.282116260939332, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.44982787868964, "policy_loss": -0.0016056771720291446, "vf_loss": 8.451196419498908, "vf_explained_var": 0.0009650883220490955, "kl": 0.007494068318398981, "entropy": 0.8979962105158145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.853079161923083, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.488890538896833, "policy_loss": -0.007659849738850007, "vf_loss": 7.496518024817976, "vf_explained_var": 0.00897466606563992, "kl": 0.02070254046951097, "entropy": 1.5713769184218513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 239.0, "episode_reward_min": -422.0, "episode_reward_mean": -137.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -998.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 59.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": -359.87, "predator_policy": 290.955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, -334.0, -402.0, -72.0, -215.0, -260.0, -185.0, -243.0, -358.0, -2.0, -40.0, -3.0, -334.0, -25.0, -215.0, -25.0, -311.0, -287.0, -258.0, -176.0, -205.0, -272.0, -353.0, -258.0, -237.0, -186.0, -411.0, -401.0, -297.0, -164.0, -309.0, -109.0, -395.0, -373.0, -228.0, -256.0, -358.0, -125.0, -383.0, -96.0, -177.0, -373.0, -26.0, -202.0, 239.0, 72.0, -22.0, -395.0, -396.0, -422.0, -176.0, -33.0, -194.0, 59.0, -106.0, -310.0, -332.0, -102.0, -210.0, -336.0, -253.0, -320.0, -88.0, -338.0, 181.0, 102.0, -79.0, 137.0, -73.0, -195.0, -85.0, -67.0, 125.0, -97.0, -175.0, 6.0, 153.0, 34.0, 21.0, -64.0, 161.0, 203.0, 60.0, 86.0, -40.0, 41.0, 30.0, 21.0, 61.0, -6.0, -64.0, -38.0, 0.0, -224.0, 44.0, -4.0, -63.0, -176.0, -130.0, -88.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5.0, 8.0, -268.0, -200.0, -336.0, -428.0, -48.0, -66.0, -316.0, -223.0, -222.0, -211.0, -162.0, -150.0, -242.0, -180.0, -348.0, -244.0, 0.0, -4.0, -48.0, -36.0, 6.0, -30.0, -266.0, -462.0, -8.0, -42.0, -185.0, -140.0, -20.0, -39.0, -299.0, -234.0, -236.0, -254.0, -252.0, -176.0, -161.0, -311.0, -316.0, -306.0, -316.0, -340.0, -224.0, -410.0, -324.0, -342.0, -333.0, -551.0, -160.0, -120.0, -505.0, -406.0, -414.0, -486.0, -217.0, -350.0, -136.0, -216.0, -428.0, -370.0, -82.0, -122.0, -442.0, -468.0, -413.0, -412.0, -328.0, -520.0, -335.0, -324.0, -414.0, -484.0, -83.0, -214.0, -660.0, -714.0, -56.0, -101.0, -248.0, -242.0, -575.0, -796.0, -301.0, -562.0, -746.0, -560.0, -44.0, -802.0, -240.0, -780.0, -850.0, -592.0, -924.0, -844.0, -558.0, -512.0, -519.0, -483.0, -526.0, -770.0, -408.0, -715.0, -206.0, -168.0, -558.0, -117.0, -599.0, -704.0, -490.0, -405.0, -413.0, -388.0, -568.0, -233.0, -503.0, -484.0, -864.0, -844.0, -882.0, -873.0, -326.0, -566.0, -777.0, -367.0, -840.0, -936.0, -998.0, -116.0, -510.0, -12.0, -234.0, -724.0, -589.0, -618.0, -195.0, -516.0, -573.0, -490.0, -616.0, -658.0, -157.0, -189.0, -6.0, -589.0, -446.0, -726.0, -730.0, -586.0, -621.0, 0.0, -289.0, -918.0, -270.0, -816.0, -534.0, -48.0, -376.0, -450.0, -726.0, -524.0, -308.0, -618.0, -30.0, -684.0, -106.0, 59.0, -428.0, -720.0, 21.0, -15.0, 0.0, -370.0, 0.0, -140.0, -326.0, -488.0, -34.0, -2.0, -114.0, -254.0, 0.0, -314.0, -62.0, 0.0, -212.0, -352.0, 34.0, 8.0, -114.0, 0.0, -188.0, -428.0, -642.0, -500.0, -790.0, -525.0, -144.0, -360.0], "policy_predator_policy_reward": [8.0, 0.0, 59.0, 75.0, 361.0, 1.0, 25.0, 17.0, 52.0, 272.0, 153.0, 20.0, 38.0, 89.0, 56.0, 123.0, 234.0, 0.0, 1.0, 1.0, 17.0, 27.0, 15.0, 6.0, 14.0, 380.0, 17.0, 8.0, 97.0, 13.0, 16.0, 18.0, 18.0, 204.0, 195.0, 8.0, 36.0, 134.0, 156.0, 140.0, 161.0, 256.0, 249.0, 135.0, 278.0, 3.0, 273.0, 135.0, 470.0, 177.0, 15.0, 79.0, 414.0, 86.0, 430.0, 69.0, 192.0, 78.0, 113.0, 75.0, 100.0, 389.0, 68.0, 27.0, 40.0, 475.0, 419.0, 33.0, 343.0, 277.0, 143.0, 260.0, 230.0, 310.0, 128.0, 44.0, 431.0, 560.0, 61.0, 0.0, 131.0, 182.0, 155.0, 843.0, 451.0, 386.0, 449.0, 655.0, 574.0, 511.0, 572.0, 520.0, 619.0, 801.0, 884.0, 489.0, 525.0, 149.0, 570.0, 10.0, 651.0, 469.0, 526.0, 564.0, 79.0, 101.0, 410.0, 324.0, 769.0, 428.0, 196.0, 389.0, 116.0, 353.0, 406.0, 293.0, 321.0, 456.0, 920.0, 452.0, 717.0, 785.0, 410.0, 162.0, 399.0, 657.0, 880.0, 558.0, 737.0, 558.0, 275.0, 349.0, 512.0, 367.0, 653.0, 691.0, 428.0, 210.0, 504.0, 364.0, 568.0, 621.0, 87.0, 192.0, 417.0, 303.0, 502.0, 573.0, 630.0, 511.0, 305.0, 322.0, 525.0, 835.0, 503.0, 617.0, 171.0, 432.0, 390.0, 372.0, 710.0, 701.0, 550.0, 579.0, 419.0, 355.0, 70.0, 63.0, 512.0, 596.0, 13.0, 22.0, 241.0, 159.0, 101.0, 60.0, 446.0, 429.0, 16.0, 14.0, 141.0, 163.0, 126.0, 150.0, 31.0, 31.0, 221.0, 119.0, 1.0, 1.0, 55.0, 55.0, 270.0, 283.0, 518.0, 448.0, 739.0, 446.0, 241.0, 175.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6128737719837014, "mean_inference_ms": 60.13576249586029, "mean_action_processing_ms": 0.8022546401946391, "mean_env_wait_ms": 0.5735324455429256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005689501762390137, "StateBufferConnector_ms": 0.006577491760253906, "ViewRequirementAgentConnector_ms": 0.2025376558303833}, "num_episodes": 18, "episode_return_max": 239.0, "episode_return_min": -422.0, "episode_return_mean": -137.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.4018534076072, "num_env_steps_trained_throughput_per_sec": 284.4018534076072, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 153054.38, "restore_workers_time_ms": 0.021, "training_step_time_ms": 153054.295, "sample_time_ms": 2455.685, "learn_time_ms": 150570.844, "learn_throughput": 26.566, "synch_weights_time_ms": 25.098}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "4f45b_00000", "date": "2024-08-13_02-40-34", "timestamp": 1723531234, "time_this_iter_s": 14.141913175582886, "time_total_s": 4968.657153844833, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb7a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4968.657153844833, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 83.9, "ram_util_percent": 83.55999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3039323928337248, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8702371262999438, "policy_loss": -0.0021037177697671625, "vf_loss": 3.871899785818877, "vf_explained_var": -0.0007554624761853899, "kl": 0.013940080531168521, "entropy": 0.8451157043850611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0749092625247108, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.223023165218414, "policy_loss": -0.010875503091565358, "vf_loss": 4.233850497038907, "vf_explained_var": 0.020028677850804002, "kl": 0.020550613272131642, "entropy": 1.5498431099154961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 239.0, "episode_reward_min": -422.0, "episode_reward_mean": -93.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -998.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 70.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": -334.425, "predator_policy": 287.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-353.0, -258.0, -237.0, -186.0, -411.0, -401.0, -297.0, -164.0, -309.0, -109.0, -395.0, -373.0, -228.0, -256.0, -358.0, -125.0, -383.0, -96.0, -177.0, -373.0, -26.0, -202.0, 239.0, 72.0, -22.0, -395.0, -396.0, -422.0, -176.0, -33.0, -194.0, 59.0, -106.0, -310.0, -332.0, -102.0, -210.0, -336.0, -253.0, -320.0, -88.0, -338.0, 181.0, 102.0, -79.0, 137.0, -73.0, -195.0, -85.0, -67.0, 125.0, -97.0, -175.0, 6.0, 153.0, 34.0, 21.0, -64.0, 161.0, 203.0, 60.0, 86.0, -40.0, 41.0, 30.0, 21.0, 61.0, -6.0, -64.0, -38.0, 0.0, -224.0, 44.0, -4.0, -63.0, -176.0, -130.0, -88.0, 85.0, 19.0, 6.0, -17.0, 13.0, -34.0, -128.0, 35.0, -36.0, -37.0, 90.0, 29.0, 40.0, 109.0, -20.0, 45.0, 120.0, 0.0, -18.0, 5.0, -60.0, 29.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-224.0, -410.0, -324.0, -342.0, -333.0, -551.0, -160.0, -120.0, -505.0, -406.0, -414.0, -486.0, -217.0, -350.0, -136.0, -216.0, -428.0, -370.0, -82.0, -122.0, -442.0, -468.0, -413.0, -412.0, -328.0, -520.0, -335.0, -324.0, -414.0, -484.0, -83.0, -214.0, -660.0, -714.0, -56.0, -101.0, -248.0, -242.0, -575.0, -796.0, -301.0, -562.0, -746.0, -560.0, -44.0, -802.0, -240.0, -780.0, -850.0, -592.0, -924.0, -844.0, -558.0, -512.0, -519.0, -483.0, -526.0, -770.0, -408.0, -715.0, -206.0, -168.0, -558.0, -117.0, -599.0, -704.0, -490.0, -405.0, -413.0, -388.0, -568.0, -233.0, -503.0, -484.0, -864.0, -844.0, -882.0, -873.0, -326.0, -566.0, -777.0, -367.0, -840.0, -936.0, -998.0, -116.0, -510.0, -12.0, -234.0, -724.0, -589.0, -618.0, -195.0, -516.0, -573.0, -490.0, -616.0, -658.0, -157.0, -189.0, -6.0, -589.0, -446.0, -726.0, -730.0, -586.0, -621.0, 0.0, -289.0, -918.0, -270.0, -816.0, -534.0, -48.0, -376.0, -450.0, -726.0, -524.0, -308.0, -618.0, -30.0, -684.0, -106.0, 59.0, -428.0, -720.0, 21.0, -15.0, 0.0, -370.0, 0.0, -140.0, -326.0, -488.0, -34.0, -2.0, -114.0, -254.0, 0.0, -314.0, -62.0, 0.0, -212.0, -352.0, 34.0, 8.0, -114.0, 0.0, -188.0, -428.0, -642.0, -500.0, -790.0, -525.0, -144.0, -360.0, 44.0, 34.0, 10.0, 0.0, 0.0, 4.0, -124.0, 23.0, 12.0, -42.0, -22.0, -34.0, -415.0, -302.0, 0.0, 23.0, -294.0, 0.0, -526.0, -228.0, 0.0, 70.0, 1.0, 0.0, 64.0, -133.0, 50.0, -4.0, -75.0, -50.0, -4.0, 4.0, -456.0, 53.0, -49.0, 8.0, -32.0, -95.0, 0.0, 5.0, -260.0, -285.0, 34.0, -26.0], "policy_predator_policy_reward": [278.0, 3.0, 273.0, 135.0, 470.0, 177.0, 15.0, 79.0, 414.0, 86.0, 430.0, 69.0, 192.0, 78.0, 113.0, 75.0, 100.0, 389.0, 68.0, 27.0, 40.0, 475.0, 419.0, 33.0, 343.0, 277.0, 143.0, 260.0, 230.0, 310.0, 128.0, 44.0, 431.0, 560.0, 61.0, 0.0, 131.0, 182.0, 155.0, 843.0, 451.0, 386.0, 449.0, 655.0, 574.0, 511.0, 572.0, 520.0, 619.0, 801.0, 884.0, 489.0, 525.0, 149.0, 570.0, 10.0, 651.0, 469.0, 526.0, 564.0, 79.0, 101.0, 410.0, 324.0, 769.0, 428.0, 196.0, 389.0, 116.0, 353.0, 406.0, 293.0, 321.0, 456.0, 920.0, 452.0, 717.0, 785.0, 410.0, 162.0, 399.0, 657.0, 880.0, 558.0, 737.0, 558.0, 275.0, 349.0, 512.0, 367.0, 653.0, 691.0, 428.0, 210.0, 504.0, 364.0, 568.0, 621.0, 87.0, 192.0, 417.0, 303.0, 502.0, 573.0, 630.0, 511.0, 305.0, 322.0, 525.0, 835.0, 503.0, 617.0, 171.0, 432.0, 390.0, 372.0, 710.0, 701.0, 550.0, 579.0, 419.0, 355.0, 70.0, 63.0, 512.0, 596.0, 13.0, 22.0, 241.0, 159.0, 101.0, 60.0, 446.0, 429.0, 16.0, 14.0, 141.0, 163.0, 126.0, 150.0, 31.0, 31.0, 221.0, 119.0, 1.0, 1.0, 55.0, 55.0, 270.0, 283.0, 518.0, 448.0, 739.0, 446.0, 241.0, 175.0, 3.0, 4.0, 8.0, 1.0, 0.0, 2.0, 40.0, 44.0, 22.0, 21.0, 22.0, 0.0, 294.0, 295.0, 0.0, 12.0, 112.0, 146.0, 359.0, 358.0, 5.0, 15.0, 14.0, 14.0, 66.0, 43.0, 20.0, 43.0, 49.0, 56.0, 14.0, 31.0, 266.0, 257.0, 25.0, 16.0, 42.0, 67.0, 0.0, 0.0, 247.0, 238.0, 8.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5919521647644348, "mean_inference_ms": 58.49593990635769, "mean_action_processing_ms": 0.7881221941505723, "mean_env_wait_ms": 0.5655411866969422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070188045501708984, "StateBufferConnector_ms": 0.006138324737548828, "ViewRequirementAgentConnector_ms": 0.20376813411712646}, "num_episodes": 22, "episode_return_max": 239.0, "episode_return_min": -422.0, "episode_return_mean": -93.07, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.78399674608085, "num_env_steps_trained_throughput_per_sec": 281.78399674608085, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 152613.187, "restore_workers_time_ms": 0.023, "training_step_time_ms": 152613.098, "sample_time_ms": 2474.33, "learn_time_ms": 150116.44, "learn_throughput": 26.646, "synch_weights_time_ms": 19.673}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "4f45b_00000", "date": "2024-08-13_02-40-49", "timestamp": 1723531249, "time_this_iter_s": 14.25581693649292, "time_total_s": 4982.912970781326, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1b8a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4982.912970781326, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 83.52, "ram_util_percent": 83.55999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9054219891548787, "cur_kl_coeff": 0.03164062499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0153445381966848, "policy_loss": -0.005105866716248254, "vf_loss": 1.0195225221612465, "vf_explained_var": -0.04608974299102864, "kl": 0.02932565238824806, "entropy": 1.0112282390316958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3906145821803462, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8692885176845326, "policy_loss": -0.004732683045966994, "vf_loss": 3.8739780692196395, "vf_explained_var": 0.07093887146187838, "kl": 0.012270227652819248, "entropy": 1.5514709277127785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 203.0, "episode_reward_min": -422.0, "episode_reward_mean": -25.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -998.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 102.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": -245.575, "predator_policy": 232.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [72.0, -22.0, -395.0, -396.0, -422.0, -176.0, -33.0, -194.0, 59.0, -106.0, -310.0, -332.0, -102.0, -210.0, -336.0, -253.0, -320.0, -88.0, -338.0, 181.0, 102.0, -79.0, 137.0, -73.0, -195.0, -85.0, -67.0, 125.0, -97.0, -175.0, 6.0, 153.0, 34.0, 21.0, -64.0, 161.0, 203.0, 60.0, 86.0, -40.0, 41.0, 30.0, 21.0, 61.0, -6.0, -64.0, -38.0, 0.0, -224.0, 44.0, -4.0, -63.0, -176.0, -130.0, -88.0, 85.0, 19.0, 6.0, -17.0, 13.0, -34.0, -128.0, 35.0, -36.0, -37.0, 90.0, 29.0, 40.0, 109.0, -20.0, 45.0, 120.0, 0.0, -18.0, 5.0, -60.0, 29.0, 11.0, 87.0, 34.0, -5.0, 195.0, 20.0, 47.0, 102.0, 30.0, 109.0, 4.0, 0.0, -7.0, 122.0, 113.0, 0.0, 79.0, 5.0, 31.0, 113.0, 62.0, 111.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-240.0, -780.0, -850.0, -592.0, -924.0, -844.0, -558.0, -512.0, -519.0, -483.0, -526.0, -770.0, -408.0, -715.0, -206.0, -168.0, -558.0, -117.0, -599.0, -704.0, -490.0, -405.0, -413.0, -388.0, -568.0, -233.0, -503.0, -484.0, -864.0, -844.0, -882.0, -873.0, -326.0, -566.0, -777.0, -367.0, -840.0, -936.0, -998.0, -116.0, -510.0, -12.0, -234.0, -724.0, -589.0, -618.0, -195.0, -516.0, -573.0, -490.0, -616.0, -658.0, -157.0, -189.0, -6.0, -589.0, -446.0, -726.0, -730.0, -586.0, -621.0, 0.0, -289.0, -918.0, -270.0, -816.0, -534.0, -48.0, -376.0, -450.0, -726.0, -524.0, -308.0, -618.0, -30.0, -684.0, -106.0, 59.0, -428.0, -720.0, 21.0, -15.0, 0.0, -370.0, 0.0, -140.0, -326.0, -488.0, -34.0, -2.0, -114.0, -254.0, 0.0, -314.0, -62.0, 0.0, -212.0, -352.0, 34.0, 8.0, -114.0, 0.0, -188.0, -428.0, -642.0, -500.0, -790.0, -525.0, -144.0, -360.0, 44.0, 34.0, 10.0, 0.0, 0.0, 4.0, -124.0, 23.0, 12.0, -42.0, -22.0, -34.0, -415.0, -302.0, 0.0, 23.0, -294.0, 0.0, -526.0, -228.0, 0.0, 70.0, 1.0, 0.0, 64.0, -133.0, 50.0, -4.0, -75.0, -50.0, -4.0, 4.0, -456.0, 53.0, -49.0, 8.0, -32.0, -95.0, 0.0, 5.0, -260.0, -285.0, 34.0, -26.0, 0.0, 5.0, 0.0, 87.0, 20.0, 0.0, 0.0, -12.0, 66.0, 102.0, -3.0, -19.0, 0.0, 17.0, 32.0, 70.0, 5.0, 10.0, 55.0, 1.0, 0.0, -2.0, 0.0, 0.0, 0.0, -16.0, 29.0, 40.0, -6.0, 72.0, 0.0, 0.0, -4.0, 64.0, -50.0, 0.0, 0.0, 31.0, -32.0, 96.0, 0.0, 26.0, 85.0, 6.0, 0.0, -45.0], "policy_predator_policy_reward": [572.0, 520.0, 619.0, 801.0, 884.0, 489.0, 525.0, 149.0, 570.0, 10.0, 651.0, 469.0, 526.0, 564.0, 79.0, 101.0, 410.0, 324.0, 769.0, 428.0, 196.0, 389.0, 116.0, 353.0, 406.0, 293.0, 321.0, 456.0, 920.0, 452.0, 717.0, 785.0, 410.0, 162.0, 399.0, 657.0, 880.0, 558.0, 737.0, 558.0, 275.0, 349.0, 512.0, 367.0, 653.0, 691.0, 428.0, 210.0, 504.0, 364.0, 568.0, 621.0, 87.0, 192.0, 417.0, 303.0, 502.0, 573.0, 630.0, 511.0, 305.0, 322.0, 525.0, 835.0, 503.0, 617.0, 171.0, 432.0, 390.0, 372.0, 710.0, 701.0, 550.0, 579.0, 419.0, 355.0, 70.0, 63.0, 512.0, 596.0, 13.0, 22.0, 241.0, 159.0, 101.0, 60.0, 446.0, 429.0, 16.0, 14.0, 141.0, 163.0, 126.0, 150.0, 31.0, 31.0, 221.0, 119.0, 1.0, 1.0, 55.0, 55.0, 270.0, 283.0, 518.0, 448.0, 739.0, 446.0, 241.0, 175.0, 3.0, 4.0, 8.0, 1.0, 0.0, 2.0, 40.0, 44.0, 22.0, 21.0, 22.0, 0.0, 294.0, 295.0, 0.0, 12.0, 112.0, 146.0, 359.0, 358.0, 5.0, 15.0, 14.0, 14.0, 66.0, 43.0, 20.0, 43.0, 49.0, 56.0, 14.0, 31.0, 266.0, 257.0, 25.0, 16.0, 42.0, 67.0, 0.0, 0.0, 247.0, 238.0, 8.0, 13.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 13.0, 14.0, 42.0, 0.0, 13.0, 17.0, 0.0, 0.0, 15.0, 0.0, 28.0, 25.0, 0.0, 6.0, 0.0, 0.0, 0.0, 9.0, 0.0, 53.0, 37.0, 10.0, 0.0, 0.0, 16.0, 3.0, 37.0, 18.0, 0.0, 0.0, 22.0, 27.0, 22.0, 14.0, 0.0, 20.0, 40.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5731121675534112, "mean_inference_ms": 56.90883730324883, "mean_action_processing_ms": 0.7793621523282858, "mean_env_wait_ms": 0.5589210846911538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006592273712158203, "StateBufferConnector_ms": 0.003354310989379883, "ViewRequirementAgentConnector_ms": 0.1860429048538208}, "num_episodes": 23, "episode_return_max": 203.0, "episode_return_min": -422.0, "episode_return_mean": -25.69, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.7273292332289, "num_env_steps_trained_throughput_per_sec": 264.7273292332289, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 152159.834, "restore_workers_time_ms": 0.022, "training_step_time_ms": 152159.746, "sample_time_ms": 2352.653, "learn_time_ms": 149784.379, "learn_throughput": 26.705, "synch_weights_time_ms": 20.17}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "4f45b_00000", "date": "2024-08-13_02-41-04", "timestamp": 1723531264, "time_this_iter_s": 15.224197149276733, "time_total_s": 4998.137167930603, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cadca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4998.137167930603, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 85.95909090909092, "ram_util_percent": 83.56363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7245265109750328, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1953103496599449, "policy_loss": -0.004018956851817805, "vf_loss": 1.198667776285025, "vf_explained_var": -0.0025137310936337426, "kl": 0.013938399365763654, "entropy": 1.1002453290280843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6200493559241296, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.21028040704273, "policy_loss": -0.0028757858922872593, "vf_loss": 5.2131210376345924, "vf_explained_var": 0.12591355827750353, "kl": 0.009995511381697266, "entropy": 1.5300021889979247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 231.0, "episode_reward_min": -338.0, "episode_reward_mean": 28.38, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -998.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 141.0, "predator_policy": 880.0}, "policy_reward_mean": {"prey_policy": -138.045, "predator_policy": 152.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-338.0, 181.0, 102.0, -79.0, 137.0, -73.0, -195.0, -85.0, -67.0, 125.0, -97.0, -175.0, 6.0, 153.0, 34.0, 21.0, -64.0, 161.0, 203.0, 60.0, 86.0, -40.0, 41.0, 30.0, 21.0, 61.0, -6.0, -64.0, -38.0, 0.0, -224.0, 44.0, -4.0, -63.0, -176.0, -130.0, -88.0, 85.0, 19.0, 6.0, -17.0, 13.0, -34.0, -128.0, 35.0, -36.0, -37.0, 90.0, 29.0, 40.0, 109.0, -20.0, 45.0, 120.0, 0.0, -18.0, 5.0, -60.0, 29.0, 11.0, 87.0, 34.0, -5.0, 195.0, 20.0, 47.0, 102.0, 30.0, 109.0, 4.0, 0.0, -7.0, 122.0, 113.0, 0.0, 79.0, 5.0, 31.0, 113.0, 62.0, 111.0, -3.0, 46.0, -25.0, 149.0, 176.0, -2.0, 0.0, -16.0, 199.0, 29.0, 92.0, 129.0, 202.0, 231.0, 122.0, 152.0, 96.0, 100.0, 163.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-840.0, -936.0, -998.0, -116.0, -510.0, -12.0, -234.0, -724.0, -589.0, -618.0, -195.0, -516.0, -573.0, -490.0, -616.0, -658.0, -157.0, -189.0, -6.0, -589.0, -446.0, -726.0, -730.0, -586.0, -621.0, 0.0, -289.0, -918.0, -270.0, -816.0, -534.0, -48.0, -376.0, -450.0, -726.0, -524.0, -308.0, -618.0, -30.0, -684.0, -106.0, 59.0, -428.0, -720.0, 21.0, -15.0, 0.0, -370.0, 0.0, -140.0, -326.0, -488.0, -34.0, -2.0, -114.0, -254.0, 0.0, -314.0, -62.0, 0.0, -212.0, -352.0, 34.0, 8.0, -114.0, 0.0, -188.0, -428.0, -642.0, -500.0, -790.0, -525.0, -144.0, -360.0, 44.0, 34.0, 10.0, 0.0, 0.0, 4.0, -124.0, 23.0, 12.0, -42.0, -22.0, -34.0, -415.0, -302.0, 0.0, 23.0, -294.0, 0.0, -526.0, -228.0, 0.0, 70.0, 1.0, 0.0, 64.0, -133.0, 50.0, -4.0, -75.0, -50.0, -4.0, 4.0, -456.0, 53.0, -49.0, 8.0, -32.0, -95.0, 0.0, 5.0, -260.0, -285.0, 34.0, -26.0, 0.0, 5.0, 0.0, 87.0, 20.0, 0.0, 0.0, -12.0, 66.0, 102.0, -3.0, -19.0, 0.0, 17.0, 32.0, 70.0, 5.0, 10.0, 55.0, 1.0, 0.0, -2.0, 0.0, 0.0, 0.0, -16.0, 29.0, 40.0, -6.0, 72.0, 0.0, 0.0, -4.0, 64.0, -50.0, 0.0, 0.0, 31.0, -32.0, 96.0, 0.0, 26.0, 85.0, 6.0, 0.0, -45.0, 0.0, 46.0, -28.0, -22.0, 109.0, 38.0, 56.0, 59.0, 0.0, -4.0, 0.0, 0.0, -36.0, 0.0, 110.0, 61.0, 0.0, 3.0, 53.0, 0.0, 71.0, 30.0, 128.0, 71.0, 97.0, 94.0, 70.0, 0.0, 0.0, 141.0, 85.0, 0.0, 100.0, 0.0, 23.0, 95.0], "policy_predator_policy_reward": [880.0, 558.0, 737.0, 558.0, 275.0, 349.0, 512.0, 367.0, 653.0, 691.0, 428.0, 210.0, 504.0, 364.0, 568.0, 621.0, 87.0, 192.0, 417.0, 303.0, 502.0, 573.0, 630.0, 511.0, 305.0, 322.0, 525.0, 835.0, 503.0, 617.0, 171.0, 432.0, 390.0, 372.0, 710.0, 701.0, 550.0, 579.0, 419.0, 355.0, 70.0, 63.0, 512.0, 596.0, 13.0, 22.0, 241.0, 159.0, 101.0, 60.0, 446.0, 429.0, 16.0, 14.0, 141.0, 163.0, 126.0, 150.0, 31.0, 31.0, 221.0, 119.0, 1.0, 1.0, 55.0, 55.0, 270.0, 283.0, 518.0, 448.0, 739.0, 446.0, 241.0, 175.0, 3.0, 4.0, 8.0, 1.0, 0.0, 2.0, 40.0, 44.0, 22.0, 21.0, 22.0, 0.0, 294.0, 295.0, 0.0, 12.0, 112.0, 146.0, 359.0, 358.0, 5.0, 15.0, 14.0, 14.0, 66.0, 43.0, 20.0, 43.0, 49.0, 56.0, 14.0, 31.0, 266.0, 257.0, 25.0, 16.0, 42.0, 67.0, 0.0, 0.0, 247.0, 238.0, 8.0, 13.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 13.0, 14.0, 42.0, 0.0, 13.0, 17.0, 0.0, 0.0, 15.0, 0.0, 28.0, 25.0, 0.0, 6.0, 0.0, 0.0, 0.0, 9.0, 0.0, 53.0, 37.0, 10.0, 0.0, 0.0, 16.0, 3.0, 37.0, 18.0, 0.0, 0.0, 22.0, 27.0, 22.0, 14.0, 0.0, 20.0, 40.0, 2.0, 0.0, 0.0, 14.0, 11.0, 2.0, 0.0, 26.0, 35.0, 2.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 28.0, 26.0, 0.0, 0.0, 39.0, 28.0, 0.0, 0.0, 3.0, 27.0, 13.0, 25.0, 27.0, 9.0, 2.0, 11.0, 0.0, 0.0, 0.0, 25.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5605452470458556, "mean_inference_ms": 55.675434251691165, "mean_action_processing_ms": 0.7690241296447473, "mean_env_wait_ms": 0.5540022123906106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008877158164978027, "StateBufferConnector_ms": 0.003505110740661621, "ViewRequirementAgentConnector_ms": 0.1900317668914795}, "num_episodes": 18, "episode_return_max": 231.0, "episode_return_min": -338.0, "episode_return_mean": 28.38, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.95130719443918, "num_env_steps_trained_throughput_per_sec": 241.95130719443918, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 151839.402, "restore_workers_time_ms": 0.022, "training_step_time_ms": 151839.324, "sample_time_ms": 2235.845, "learn_time_ms": 149577.785, "learn_throughput": 26.742, "synch_weights_time_ms": 23.393}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "4f45b_00000", "date": "2024-08-13_02-41-20", "timestamp": 1723531280, "time_this_iter_s": 16.59830093383789, "time_total_s": 5014.735468864441, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20bf280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5014.735468864441, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 85.29130434782607, "ram_util_percent": 83.53478260869564}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.658528872461073, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0848647201975818, "policy_loss": -0.003941882674572447, "vf_loss": 1.088508043103117, "vf_explained_var": 0.003996999774660383, "kl": 0.006290613545042721, "entropy": 1.1180620065441838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.547553205442807, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.950337179375704, "policy_loss": -0.00887433475329388, "vf_loss": 6.9591637863683955, "vf_explained_var": 0.09345708905704438, "kl": 0.013578870397517795, "entropy": 1.5411448286323952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 289.0, "episode_reward_min": -224.0, "episode_reward_mean": 53.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -790.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 158.0, "predator_policy": 739.0}, "policy_reward_mean": {"prey_policy": -41.69, "predator_policy": 68.62}, "custom_metrics": {}, "hist_stats": {"episode_reward": [203.0, 60.0, 86.0, -40.0, 41.0, 30.0, 21.0, 61.0, -6.0, -64.0, -38.0, 0.0, -224.0, 44.0, -4.0, -63.0, -176.0, -130.0, -88.0, 85.0, 19.0, 6.0, -17.0, 13.0, -34.0, -128.0, 35.0, -36.0, -37.0, 90.0, 29.0, 40.0, 109.0, -20.0, 45.0, 120.0, 0.0, -18.0, 5.0, -60.0, 29.0, 11.0, 87.0, 34.0, -5.0, 195.0, 20.0, 47.0, 102.0, 30.0, 109.0, 4.0, 0.0, -7.0, 122.0, 113.0, 0.0, 79.0, 5.0, 31.0, 113.0, 62.0, 111.0, -3.0, 46.0, -25.0, 149.0, 176.0, -2.0, 0.0, -16.0, 199.0, 29.0, 92.0, 129.0, 202.0, 231.0, 122.0, 152.0, 96.0, 100.0, 163.0, 106.0, 100.0, 174.0, 233.0, 170.0, 70.0, 289.0, 120.0, 201.0, 190.0, -2.0, 108.0, 197.0, 4.0, 150.0, 96.0, 88.0, 1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-308.0, -618.0, -30.0, -684.0, -106.0, 59.0, -428.0, -720.0, 21.0, -15.0, 0.0, -370.0, 0.0, -140.0, -326.0, -488.0, -34.0, -2.0, -114.0, -254.0, 0.0, -314.0, -62.0, 0.0, -212.0, -352.0, 34.0, 8.0, -114.0, 0.0, -188.0, -428.0, -642.0, -500.0, -790.0, -525.0, -144.0, -360.0, 44.0, 34.0, 10.0, 0.0, 0.0, 4.0, -124.0, 23.0, 12.0, -42.0, -22.0, -34.0, -415.0, -302.0, 0.0, 23.0, -294.0, 0.0, -526.0, -228.0, 0.0, 70.0, 1.0, 0.0, 64.0, -133.0, 50.0, -4.0, -75.0, -50.0, -4.0, 4.0, -456.0, 53.0, -49.0, 8.0, -32.0, -95.0, 0.0, 5.0, -260.0, -285.0, 34.0, -26.0, 0.0, 5.0, 0.0, 87.0, 20.0, 0.0, 0.0, -12.0, 66.0, 102.0, -3.0, -19.0, 0.0, 17.0, 32.0, 70.0, 5.0, 10.0, 55.0, 1.0, 0.0, -2.0, 0.0, 0.0, 0.0, -16.0, 29.0, 40.0, -6.0, 72.0, 0.0, 0.0, -4.0, 64.0, -50.0, 0.0, 0.0, 31.0, -32.0, 96.0, 0.0, 26.0, 85.0, 6.0, 0.0, -45.0, 0.0, 46.0, -28.0, -22.0, 109.0, 38.0, 56.0, 59.0, 0.0, -4.0, 0.0, 0.0, -36.0, 0.0, 110.0, 61.0, 0.0, 3.0, 53.0, 0.0, 71.0, 30.0, 128.0, 71.0, 97.0, 94.0, 70.0, 0.0, 0.0, 141.0, 85.0, 0.0, 100.0, 0.0, 23.0, 95.0, -6.0, 90.0, 2.0, 33.0, 60.0, 79.0, 82.0, 151.0, 98.0, 27.0, 66.0, -50.0, 158.0, 71.0, 8.0, 112.0, 155.0, 8.0, 90.0, 57.0, -16.0, -5.0, 29.0, 55.0, 123.0, 57.0, 14.0, -20.0, 113.0, 26.0, 73.0, -6.0, -6.0, 62.0, -103.0, -42.0], "policy_predator_policy_reward": [550.0, 579.0, 419.0, 355.0, 70.0, 63.0, 512.0, 596.0, 13.0, 22.0, 241.0, 159.0, 101.0, 60.0, 446.0, 429.0, 16.0, 14.0, 141.0, 163.0, 126.0, 150.0, 31.0, 31.0, 221.0, 119.0, 1.0, 1.0, 55.0, 55.0, 270.0, 283.0, 518.0, 448.0, 739.0, 446.0, 241.0, 175.0, 3.0, 4.0, 8.0, 1.0, 0.0, 2.0, 40.0, 44.0, 22.0, 21.0, 22.0, 0.0, 294.0, 295.0, 0.0, 12.0, 112.0, 146.0, 359.0, 358.0, 5.0, 15.0, 14.0, 14.0, 66.0, 43.0, 20.0, 43.0, 49.0, 56.0, 14.0, 31.0, 266.0, 257.0, 25.0, 16.0, 42.0, 67.0, 0.0, 0.0, 247.0, 238.0, 8.0, 13.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 13.0, 14.0, 42.0, 0.0, 13.0, 17.0, 0.0, 0.0, 15.0, 0.0, 28.0, 25.0, 0.0, 6.0, 0.0, 0.0, 0.0, 9.0, 0.0, 53.0, 37.0, 10.0, 0.0, 0.0, 16.0, 3.0, 37.0, 18.0, 0.0, 0.0, 22.0, 27.0, 22.0, 14.0, 0.0, 20.0, 40.0, 2.0, 0.0, 0.0, 14.0, 11.0, 2.0, 0.0, 26.0, 35.0, 2.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 28.0, 26.0, 0.0, 0.0, 39.0, 28.0, 0.0, 0.0, 3.0, 27.0, 13.0, 25.0, 27.0, 9.0, 2.0, 11.0, 0.0, 0.0, 0.0, 25.0, 20.0, 0.0, 22.0, 21.0, 44.0, 19.0, 16.0, 0.0, 0.0, 17.0, 28.0, 39.0, 15.0, 23.0, 37.0, 0.0, 0.0, 20.0, 18.0, 18.0, 25.0, 0.0, 19.0, 24.0, 0.0, 0.0, 17.0, 10.0, 0.0, 11.0, 0.0, 26.0, 3.0, 32.0, 0.0, 56.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5479491372264074, "mean_inference_ms": 54.492431695881315, "mean_action_processing_ms": 0.7608908612126729, "mean_env_wait_ms": 0.5495694661617418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008916974067687988, "StateBufferConnector_ms": 0.0047380924224853516, "ViewRequirementAgentConnector_ms": 0.17570924758911133}, "num_episodes": 18, "episode_return_max": 289.0, "episode_return_min": -224.0, "episode_return_mean": 53.86, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.52179639654574, "num_env_steps_trained_throughput_per_sec": 242.52179639654574, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 151431.164, "restore_workers_time_ms": 0.022, "training_step_time_ms": 151431.085, "sample_time_ms": 2255.887, "learn_time_ms": 149148.59, "learn_throughput": 26.819, "synch_weights_time_ms": 24.177}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "4f45b_00000", "date": "2024-08-13_02-41-37", "timestamp": 1723531297, "time_this_iter_s": 16.647315979003906, "time_total_s": 5031.382784843445, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1b8a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5031.382784843445, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 83.56086956521739, "ram_util_percent": 83.26086956521738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6845230970275465, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9753079172795411, "policy_loss": -0.006237724431785484, "vf_loss": 0.9811812546991167, "vf_explained_var": 0.015140545210510335, "kl": 0.007677622596515879, "entropy": 1.1397131931844842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.344614296694281, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.841535116377331, "policy_loss": -0.006069794339595964, "vf_loss": 5.847547829340375, "vf_explained_var": 0.24711983967079687, "kl": 0.016237704380424284, "entropy": 1.5315168950923537, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 305.0, "episode_reward_min": -128.0, "episode_reward_mean": 80.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -526.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 159.0, "predator_policy": 359.0}, "policy_reward_mean": {"prey_policy": 11.295, "predator_policy": 29.09}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.0, 85.0, 19.0, 6.0, -17.0, 13.0, -34.0, -128.0, 35.0, -36.0, -37.0, 90.0, 29.0, 40.0, 109.0, -20.0, 45.0, 120.0, 0.0, -18.0, 5.0, -60.0, 29.0, 11.0, 87.0, 34.0, -5.0, 195.0, 20.0, 47.0, 102.0, 30.0, 109.0, 4.0, 0.0, -7.0, 122.0, 113.0, 0.0, 79.0, 5.0, 31.0, 113.0, 62.0, 111.0, -3.0, 46.0, -25.0, 149.0, 176.0, -2.0, 0.0, -16.0, 199.0, 29.0, 92.0, 129.0, 202.0, 231.0, 122.0, 152.0, 96.0, 100.0, 163.0, 106.0, 100.0, 174.0, 233.0, 170.0, 70.0, 289.0, 120.0, 201.0, 190.0, -2.0, 108.0, 197.0, 4.0, 150.0, 96.0, 88.0, 1.0, 192.0, 252.0, 191.0, 76.0, 63.0, -12.0, 174.0, 117.0, 150.0, 135.0, -42.0, 305.0, 150.0, 119.0, 186.0, 262.0, 104.0, 70.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-144.0, -360.0, 44.0, 34.0, 10.0, 0.0, 0.0, 4.0, -124.0, 23.0, 12.0, -42.0, -22.0, -34.0, -415.0, -302.0, 0.0, 23.0, -294.0, 0.0, -526.0, -228.0, 0.0, 70.0, 1.0, 0.0, 64.0, -133.0, 50.0, -4.0, -75.0, -50.0, -4.0, 4.0, -456.0, 53.0, -49.0, 8.0, -32.0, -95.0, 0.0, 5.0, -260.0, -285.0, 34.0, -26.0, 0.0, 5.0, 0.0, 87.0, 20.0, 0.0, 0.0, -12.0, 66.0, 102.0, -3.0, -19.0, 0.0, 17.0, 32.0, 70.0, 5.0, 10.0, 55.0, 1.0, 0.0, -2.0, 0.0, 0.0, 0.0, -16.0, 29.0, 40.0, -6.0, 72.0, 0.0, 0.0, -4.0, 64.0, -50.0, 0.0, 0.0, 31.0, -32.0, 96.0, 0.0, 26.0, 85.0, 6.0, 0.0, -45.0, 0.0, 46.0, -28.0, -22.0, 109.0, 38.0, 56.0, 59.0, 0.0, -4.0, 0.0, 0.0, -36.0, 0.0, 110.0, 61.0, 0.0, 3.0, 53.0, 0.0, 71.0, 30.0, 128.0, 71.0, 97.0, 94.0, 70.0, 0.0, 0.0, 141.0, 85.0, 0.0, 100.0, 0.0, 23.0, 95.0, -6.0, 90.0, 2.0, 33.0, 60.0, 79.0, 82.0, 151.0, 98.0, 27.0, 66.0, -50.0, 158.0, 71.0, 8.0, 112.0, 155.0, 8.0, 90.0, 57.0, -16.0, -5.0, 29.0, 55.0, 123.0, 57.0, 14.0, -20.0, 113.0, 26.0, 73.0, -6.0, -6.0, 62.0, -103.0, -42.0, 110.0, 46.0, 134.0, 87.0, 49.0, 67.0, 0.0, 70.0, 63.0, 0.0, 0.0, -24.0, 87.0, 86.0, 0.0, 98.0, 49.0, 21.0, 15.0, 120.0, -61.0, -78.0, 146.0, 159.0, 150.0, -4.0, -14.0, 110.0, 89.0, 97.0, 120.0, 108.0, -4.0, 93.0, -18.0, -16.0], "policy_predator_policy_reward": [241.0, 175.0, 3.0, 4.0, 8.0, 1.0, 0.0, 2.0, 40.0, 44.0, 22.0, 21.0, 22.0, 0.0, 294.0, 295.0, 0.0, 12.0, 112.0, 146.0, 359.0, 358.0, 5.0, 15.0, 14.0, 14.0, 66.0, 43.0, 20.0, 43.0, 49.0, 56.0, 14.0, 31.0, 266.0, 257.0, 25.0, 16.0, 42.0, 67.0, 0.0, 0.0, 247.0, 238.0, 8.0, 13.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 13.0, 14.0, 42.0, 0.0, 13.0, 17.0, 0.0, 0.0, 15.0, 0.0, 28.0, 25.0, 0.0, 6.0, 0.0, 0.0, 0.0, 9.0, 0.0, 53.0, 37.0, 10.0, 0.0, 0.0, 16.0, 3.0, 37.0, 18.0, 0.0, 0.0, 22.0, 27.0, 22.0, 14.0, 0.0, 20.0, 40.0, 2.0, 0.0, 0.0, 14.0, 11.0, 2.0, 0.0, 26.0, 35.0, 2.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 28.0, 26.0, 0.0, 0.0, 39.0, 28.0, 0.0, 0.0, 3.0, 27.0, 13.0, 25.0, 27.0, 9.0, 2.0, 11.0, 0.0, 0.0, 0.0, 25.0, 20.0, 0.0, 22.0, 21.0, 44.0, 19.0, 16.0, 0.0, 0.0, 17.0, 28.0, 39.0, 15.0, 23.0, 37.0, 0.0, 0.0, 20.0, 18.0, 18.0, 25.0, 0.0, 19.0, 24.0, 0.0, 0.0, 17.0, 10.0, 0.0, 11.0, 0.0, 26.0, 3.0, 32.0, 0.0, 56.0, 90.0, 25.0, 11.0, 31.0, 0.0, 30.0, 45.0, 6.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 16.0, 3.0, 18.0, 62.0, 0.0, 0.0, 95.0, 2.0, 0.0, 0.0, 2.0, 2.0, 18.0, 5.0, 0.0, 0.0, 0.0, 34.0, 0.0, 15.0, 52.0, 52.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5385854311438814, "mean_inference_ms": 53.3722444936878, "mean_action_processing_ms": 0.7545715520090761, "mean_env_wait_ms": 0.5462239787698264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014041423797607422, "StateBufferConnector_ms": 0.009707450866699219, "ViewRequirementAgentConnector_ms": 0.20700538158416748}, "num_episodes": 18, "episode_return_max": 305.0, "episode_return_min": -128.0, "episode_return_mean": 80.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.89559007643254, "num_env_steps_trained_throughput_per_sec": 229.89559007643254, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 151169.511, "restore_workers_time_ms": 0.019, "training_step_time_ms": 151169.441, "sample_time_ms": 2327.25, "learn_time_ms": 148815.783, "learn_throughput": 26.879, "synch_weights_time_ms": 24.207}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "4f45b_00000", "date": "2024-08-13_02-41-55", "timestamp": 1723531315, "time_this_iter_s": 17.449965000152588, "time_total_s": 5048.832749843597, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cda8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5048.832749843597, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 86.096, "ram_util_percent": 83.26}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.751913364326197, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2915526781132611, "policy_loss": -0.003131350382753505, "vf_loss": 1.294340593332336, "vf_explained_var": 0.019270654582472704, "kl": 0.007236153388844551, "entropy": 1.133667086230384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.51183229702175, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.836406830631236, "policy_loss": -0.004833335116525333, "vf_loss": 6.841194715954009, "vf_explained_var": 0.26700197931319947, "kl": 0.012923885877286493, "entropy": 1.4823351995654839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 320.0, "episode_reward_min": -42.0, "episode_reward_mean": 111.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -103.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0, "predator_policy": 95.0}, "policy_reward_mean": {"prey_policy": 42.045, "predator_policy": 13.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.0, 11.0, 87.0, 34.0, -5.0, 195.0, 20.0, 47.0, 102.0, 30.0, 109.0, 4.0, 0.0, -7.0, 122.0, 113.0, 0.0, 79.0, 5.0, 31.0, 113.0, 62.0, 111.0, -3.0, 46.0, -25.0, 149.0, 176.0, -2.0, 0.0, -16.0, 199.0, 29.0, 92.0, 129.0, 202.0, 231.0, 122.0, 152.0, 96.0, 100.0, 163.0, 106.0, 100.0, 174.0, 233.0, 170.0, 70.0, 289.0, 120.0, 201.0, 190.0, -2.0, 108.0, 197.0, 4.0, 150.0, 96.0, 88.0, 1.0, 192.0, 252.0, 191.0, 76.0, 63.0, -12.0, 174.0, 117.0, 150.0, 135.0, -42.0, 305.0, 150.0, 119.0, 186.0, 262.0, 104.0, 70.0, 150.0, 187.0, 109.0, 0.0, 161.0, -36.0, 0.0, 290.0, 136.0, 101.0, 142.0, 100.0, 60.0, 273.0, 93.0, 234.0, 180.0, 320.0, 98.0, 152.0, 217.0, 301.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [34.0, -26.0, 0.0, 5.0, 0.0, 87.0, 20.0, 0.0, 0.0, -12.0, 66.0, 102.0, -3.0, -19.0, 0.0, 17.0, 32.0, 70.0, 5.0, 10.0, 55.0, 1.0, 0.0, -2.0, 0.0, 0.0, 0.0, -16.0, 29.0, 40.0, -6.0, 72.0, 0.0, 0.0, -4.0, 64.0, -50.0, 0.0, 0.0, 31.0, -32.0, 96.0, 0.0, 26.0, 85.0, 6.0, 0.0, -45.0, 0.0, 46.0, -28.0, -22.0, 109.0, 38.0, 56.0, 59.0, 0.0, -4.0, 0.0, 0.0, -36.0, 0.0, 110.0, 61.0, 0.0, 3.0, 53.0, 0.0, 71.0, 30.0, 128.0, 71.0, 97.0, 94.0, 70.0, 0.0, 0.0, 141.0, 85.0, 0.0, 100.0, 0.0, 23.0, 95.0, -6.0, 90.0, 2.0, 33.0, 60.0, 79.0, 82.0, 151.0, 98.0, 27.0, 66.0, -50.0, 158.0, 71.0, 8.0, 112.0, 155.0, 8.0, 90.0, 57.0, -16.0, -5.0, 29.0, 55.0, 123.0, 57.0, 14.0, -20.0, 113.0, 26.0, 73.0, -6.0, -6.0, 62.0, -103.0, -42.0, 110.0, 46.0, 134.0, 87.0, 49.0, 67.0, 0.0, 70.0, 63.0, 0.0, 0.0, -24.0, 87.0, 86.0, 0.0, 98.0, 49.0, 21.0, 15.0, 120.0, -61.0, -78.0, 146.0, 159.0, 150.0, -4.0, -14.0, 110.0, 89.0, 97.0, 120.0, 108.0, -4.0, 93.0, -18.0, -16.0, 118.0, -20.0, 0.0, 187.0, 0.0, 64.0, 0.0, 0.0, 0.0, 150.0, -32.0, -20.0, 0.0, 0.0, 145.0, 128.0, 50.0, 7.0, 0.0, 71.0, 126.0, -16.0, -16.0, 63.0, 0.0, 60.0, -23.0, 168.0, -6.0, 65.0, 89.0, 33.0, 0.0, 180.0, 183.0, 121.0, 0.0, 98.0, 152.0, -14.0, 84.0, 133.0, 145.0, 148.0], "policy_predator_policy_reward": [8.0, 13.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 13.0, 14.0, 42.0, 0.0, 13.0, 17.0, 0.0, 0.0, 15.0, 0.0, 28.0, 25.0, 0.0, 6.0, 0.0, 0.0, 0.0, 9.0, 0.0, 53.0, 37.0, 10.0, 0.0, 0.0, 16.0, 3.0, 37.0, 18.0, 0.0, 0.0, 22.0, 27.0, 22.0, 14.0, 0.0, 20.0, 40.0, 2.0, 0.0, 0.0, 14.0, 11.0, 2.0, 0.0, 26.0, 35.0, 2.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 28.0, 26.0, 0.0, 0.0, 39.0, 28.0, 0.0, 0.0, 3.0, 27.0, 13.0, 25.0, 27.0, 9.0, 2.0, 11.0, 0.0, 0.0, 0.0, 25.0, 20.0, 0.0, 22.0, 21.0, 44.0, 19.0, 16.0, 0.0, 0.0, 17.0, 28.0, 39.0, 15.0, 23.0, 37.0, 0.0, 0.0, 20.0, 18.0, 18.0, 25.0, 0.0, 19.0, 24.0, 0.0, 0.0, 17.0, 10.0, 0.0, 11.0, 0.0, 26.0, 3.0, 32.0, 0.0, 56.0, 90.0, 25.0, 11.0, 31.0, 0.0, 30.0, 45.0, 6.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 16.0, 3.0, 18.0, 62.0, 0.0, 0.0, 95.0, 2.0, 0.0, 0.0, 2.0, 2.0, 18.0, 5.0, 0.0, 0.0, 0.0, 34.0, 0.0, 15.0, 52.0, 52.0, 2.0, 50.0, 0.0, 0.0, 44.0, 1.0, 0.0, 0.0, 0.0, 11.0, 16.0, 0.0, 0.0, 0.0, 4.0, 13.0, 29.0, 50.0, 12.0, 18.0, 23.0, 9.0, 11.0, 42.0, 0.0, 0.0, 59.0, 69.0, 24.0, 10.0, 61.0, 51.0, 0.0, 0.0, 2.0, 14.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5303420355879036, "mean_inference_ms": 52.076490299301874, "mean_action_processing_ms": 0.7484860941440706, "mean_env_wait_ms": 0.5432739963147847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013574957847595215, "StateBufferConnector_ms": 0.013268709182739258, "ViewRequirementAgentConnector_ms": 0.2151939868927002}, "num_episodes": 22, "episode_return_max": 320.0, "episode_return_min": -42.0, "episode_return_mean": 111.87, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 209.2153061778014, "num_env_steps_trained_throughput_per_sec": 209.2153061778014, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 47412.175, "restore_workers_time_ms": 0.018, "training_step_time_ms": 47412.107, "sample_time_ms": 2422.828, "learn_time_ms": 44962.675, "learn_throughput": 88.963, "synch_weights_time_ms": 24.252}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "4f45b_00000", "date": "2024-08-13_02-42-14", "timestamp": 1723531334, "time_this_iter_s": 19.166243076324463, "time_total_s": 5067.998992919922, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1ce0670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5067.998992919922, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 87.11481481481479, "ram_util_percent": 83.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7487806724571677, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3173129419801097, "policy_loss": -0.003920380223453755, "vf_loss": 2.320588060157009, "vf_explained_var": 0.0073436403085315035, "kl": 0.013595725077755201, "entropy": 1.0228327063025622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9863846092785478, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.58684444679785, "policy_loss": -0.00990992264881257, "vf_loss": 7.596701337673046, "vf_explained_var": 0.1882791654142753, "kl": 0.015086505290859404, "entropy": 1.4328912437277497, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -42.0, "episode_reward_mean": 147.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -103.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 194.0, "predator_policy": 95.0}, "policy_reward_mean": {"prey_policy": 58.585, "predator_policy": 15.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, 46.0, -25.0, 149.0, 176.0, -2.0, 0.0, -16.0, 199.0, 29.0, 92.0, 129.0, 202.0, 231.0, 122.0, 152.0, 96.0, 100.0, 163.0, 106.0, 100.0, 174.0, 233.0, 170.0, 70.0, 289.0, 120.0, 201.0, 190.0, -2.0, 108.0, 197.0, 4.0, 150.0, 96.0, 88.0, 1.0, 192.0, 252.0, 191.0, 76.0, 63.0, -12.0, 174.0, 117.0, 150.0, 135.0, -42.0, 305.0, 150.0, 119.0, 186.0, 262.0, 104.0, 70.0, 150.0, 187.0, 109.0, 0.0, 161.0, -36.0, 0.0, 290.0, 136.0, 101.0, 142.0, 100.0, 60.0, 273.0, 93.0, 234.0, 180.0, 320.0, 98.0, 152.0, 217.0, 301.0, 223.0, 355.0, 364.0, 111.0, 254.0, 310.0, 147.0, 124.0, 246.0, 376.0, 100.0, 138.0, 138.0, 96.0, 375.0, 193.0, 222.0, 114.0, 89.0, 186.0, 226.0, 334.0, 111.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -45.0, 0.0, 46.0, -28.0, -22.0, 109.0, 38.0, 56.0, 59.0, 0.0, -4.0, 0.0, 0.0, -36.0, 0.0, 110.0, 61.0, 0.0, 3.0, 53.0, 0.0, 71.0, 30.0, 128.0, 71.0, 97.0, 94.0, 70.0, 0.0, 0.0, 141.0, 85.0, 0.0, 100.0, 0.0, 23.0, 95.0, -6.0, 90.0, 2.0, 33.0, 60.0, 79.0, 82.0, 151.0, 98.0, 27.0, 66.0, -50.0, 158.0, 71.0, 8.0, 112.0, 155.0, 8.0, 90.0, 57.0, -16.0, -5.0, 29.0, 55.0, 123.0, 57.0, 14.0, -20.0, 113.0, 26.0, 73.0, -6.0, -6.0, 62.0, -103.0, -42.0, 110.0, 46.0, 134.0, 87.0, 49.0, 67.0, 0.0, 70.0, 63.0, 0.0, 0.0, -24.0, 87.0, 86.0, 0.0, 98.0, 49.0, 21.0, 15.0, 120.0, -61.0, -78.0, 146.0, 159.0, 150.0, -4.0, -14.0, 110.0, 89.0, 97.0, 120.0, 108.0, -4.0, 93.0, -18.0, -16.0, 118.0, -20.0, 0.0, 187.0, 0.0, 64.0, 0.0, 0.0, 0.0, 150.0, -32.0, -20.0, 0.0, 0.0, 145.0, 128.0, 50.0, 7.0, 0.0, 71.0, 126.0, -16.0, -16.0, 63.0, 0.0, 60.0, -23.0, 168.0, -6.0, 65.0, 89.0, 33.0, 0.0, 180.0, 183.0, 121.0, 0.0, 98.0, 152.0, -14.0, 84.0, 133.0, 145.0, 148.0, 5.0, 182.0, 178.0, 158.0, 180.0, 176.0, 0.0, 110.0, -10.0, 194.0, 139.0, 143.0, 147.0, 0.0, 0.0, 124.0, 84.0, 162.0, 188.0, 188.0, 36.0, 6.0, 126.0, 0.0, 117.0, 0.0, 0.0, 96.0, 191.0, 182.0, 4.0, 189.0, 36.0, 138.0, 0.0, 57.0, 0.0, -15.0, 75.0, -50.0, 28.0, 136.0, 188.0, 146.0, 64.0, -7.0], "policy_predator_policy_reward": [40.0, 2.0, 0.0, 0.0, 14.0, 11.0, 2.0, 0.0, 26.0, 35.0, 2.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 28.0, 26.0, 0.0, 0.0, 39.0, 28.0, 0.0, 0.0, 3.0, 27.0, 13.0, 25.0, 27.0, 9.0, 2.0, 11.0, 0.0, 0.0, 0.0, 25.0, 20.0, 0.0, 22.0, 21.0, 44.0, 19.0, 16.0, 0.0, 0.0, 17.0, 28.0, 39.0, 15.0, 23.0, 37.0, 0.0, 0.0, 20.0, 18.0, 18.0, 25.0, 0.0, 19.0, 24.0, 0.0, 0.0, 17.0, 10.0, 0.0, 11.0, 0.0, 26.0, 3.0, 32.0, 0.0, 56.0, 90.0, 25.0, 11.0, 31.0, 0.0, 30.0, 45.0, 6.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 16.0, 3.0, 18.0, 62.0, 0.0, 0.0, 95.0, 2.0, 0.0, 0.0, 2.0, 2.0, 18.0, 5.0, 0.0, 0.0, 0.0, 34.0, 0.0, 15.0, 52.0, 52.0, 2.0, 50.0, 0.0, 0.0, 44.0, 1.0, 0.0, 0.0, 0.0, 11.0, 16.0, 0.0, 0.0, 0.0, 4.0, 13.0, 29.0, 50.0, 12.0, 18.0, 23.0, 9.0, 11.0, 42.0, 0.0, 0.0, 59.0, 69.0, 24.0, 10.0, 61.0, 51.0, 0.0, 0.0, 2.0, 14.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 1.0, 36.0, 0.0, 19.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 70.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 34.0, 24.0, 0.0, 12.0, 4.0, 17.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 16.0, 32.0, 38.0, 19.0, 55.0, 49.0, 94.0, 67.0, 53.0, 9.0, 0.0, 0.0, 15.0, 39.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5251113717806835, "mean_inference_ms": 50.79053101104719, "mean_action_processing_ms": 0.7436154348355948, "mean_env_wait_ms": 0.5410444712797552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013884186744689941, "StateBufferConnector_ms": 0.013585090637207031, "ViewRequirementAgentConnector_ms": 0.2229921817779541}, "num_episodes": 23, "episode_return_max": 376.0, "episode_return_min": -42.0, "episode_return_mean": 147.27, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.92095990719793, "num_env_steps_trained_throughput_per_sec": 200.92095990719793, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 47632.412, "restore_workers_time_ms": 0.017, "training_step_time_ms": 47632.347, "sample_time_ms": 2510.991, "learn_time_ms": 45094.862, "learn_throughput": 88.702, "synch_weights_time_ms": 24.185}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "4f45b_00000", "date": "2024-08-13_02-42-34", "timestamp": 1723531354, "time_this_iter_s": 19.960717916488647, "time_total_s": 5087.9597108364105, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cd9040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5087.9597108364105, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 87.07142857142856, "ram_util_percent": 83.45714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7918507749441439, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.26990498695424, "policy_loss": -0.005052016857055523, "vf_loss": 1.2746451971234467, "vf_explained_var": 0.023696882289553446, "kl": 0.006569735969424034, "entropy": 0.9908348115032943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.523438832100737, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.725322122927066, "policy_loss": -0.008985329747801184, "vf_loss": 8.734239673614502, "vf_explained_var": 0.26573665615112063, "kl": 0.019286813349252113, "entropy": 1.3791045717461399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -42.0, "episode_reward_mean": 176.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -103.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 95.0}, "policy_reward_mean": {"prey_policy": 72.31, "predator_policy": 16.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.0, 106.0, 100.0, 174.0, 233.0, 170.0, 70.0, 289.0, 120.0, 201.0, 190.0, -2.0, 108.0, 197.0, 4.0, 150.0, 96.0, 88.0, 1.0, 192.0, 252.0, 191.0, 76.0, 63.0, -12.0, 174.0, 117.0, 150.0, 135.0, -42.0, 305.0, 150.0, 119.0, 186.0, 262.0, 104.0, 70.0, 150.0, 187.0, 109.0, 0.0, 161.0, -36.0, 0.0, 290.0, 136.0, 101.0, 142.0, 100.0, 60.0, 273.0, 93.0, 234.0, 180.0, 320.0, 98.0, 152.0, 217.0, 301.0, 223.0, 355.0, 364.0, 111.0, 254.0, 310.0, 147.0, 124.0, 246.0, 376.0, 100.0, 138.0, 138.0, 96.0, 375.0, 193.0, 222.0, 114.0, 89.0, 186.0, 226.0, 334.0, 111.0, 250.0, 284.0, 281.0, 306.0, 238.0, 335.0, 136.0, 298.0, 278.0, 272.0, 203.0, 226.0, 347.0, 265.0, 226.0, 261.0, 290.0, 141.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [23.0, 95.0, -6.0, 90.0, 2.0, 33.0, 60.0, 79.0, 82.0, 151.0, 98.0, 27.0, 66.0, -50.0, 158.0, 71.0, 8.0, 112.0, 155.0, 8.0, 90.0, 57.0, -16.0, -5.0, 29.0, 55.0, 123.0, 57.0, 14.0, -20.0, 113.0, 26.0, 73.0, -6.0, -6.0, 62.0, -103.0, -42.0, 110.0, 46.0, 134.0, 87.0, 49.0, 67.0, 0.0, 70.0, 63.0, 0.0, 0.0, -24.0, 87.0, 86.0, 0.0, 98.0, 49.0, 21.0, 15.0, 120.0, -61.0, -78.0, 146.0, 159.0, 150.0, -4.0, -14.0, 110.0, 89.0, 97.0, 120.0, 108.0, -4.0, 93.0, -18.0, -16.0, 118.0, -20.0, 0.0, 187.0, 0.0, 64.0, 0.0, 0.0, 0.0, 150.0, -32.0, -20.0, 0.0, 0.0, 145.0, 128.0, 50.0, 7.0, 0.0, 71.0, 126.0, -16.0, -16.0, 63.0, 0.0, 60.0, -23.0, 168.0, -6.0, 65.0, 89.0, 33.0, 0.0, 180.0, 183.0, 121.0, 0.0, 98.0, 152.0, -14.0, 84.0, 133.0, 145.0, 148.0, 5.0, 182.0, 178.0, 158.0, 180.0, 176.0, 0.0, 110.0, -10.0, 194.0, 139.0, 143.0, 147.0, 0.0, 0.0, 124.0, 84.0, 162.0, 188.0, 188.0, 36.0, 6.0, 126.0, 0.0, 117.0, 0.0, 0.0, 96.0, 191.0, 182.0, 4.0, 189.0, 36.0, 138.0, 0.0, 57.0, 0.0, -15.0, 75.0, -50.0, 28.0, 136.0, 188.0, 146.0, 64.0, -7.0, 32.0, 162.0, 127.0, 137.0, 190.0, 88.0, 124.0, 158.0, 158.0, 31.0, 153.0, 173.0, 0.0, 107.0, 128.0, 148.0, 158.0, 43.0, 81.0, 145.0, 100.0, 90.0, 147.0, 53.0, 185.0, 157.0, 44.0, 142.0, 67.0, 91.0, 109.0, 121.0, 196.0, 70.0, 71.0, 46.0], "policy_predator_policy_reward": [25.0, 20.0, 0.0, 22.0, 21.0, 44.0, 19.0, 16.0, 0.0, 0.0, 17.0, 28.0, 39.0, 15.0, 23.0, 37.0, 0.0, 0.0, 20.0, 18.0, 18.0, 25.0, 0.0, 19.0, 24.0, 0.0, 0.0, 17.0, 10.0, 0.0, 11.0, 0.0, 26.0, 3.0, 32.0, 0.0, 56.0, 90.0, 25.0, 11.0, 31.0, 0.0, 30.0, 45.0, 6.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 16.0, 3.0, 18.0, 62.0, 0.0, 0.0, 95.0, 2.0, 0.0, 0.0, 2.0, 2.0, 18.0, 5.0, 0.0, 0.0, 0.0, 34.0, 0.0, 15.0, 52.0, 52.0, 2.0, 50.0, 0.0, 0.0, 44.0, 1.0, 0.0, 0.0, 0.0, 11.0, 16.0, 0.0, 0.0, 0.0, 4.0, 13.0, 29.0, 50.0, 12.0, 18.0, 23.0, 9.0, 11.0, 42.0, 0.0, 0.0, 59.0, 69.0, 24.0, 10.0, 61.0, 51.0, 0.0, 0.0, 2.0, 14.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 1.0, 36.0, 0.0, 19.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 70.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 34.0, 24.0, 0.0, 12.0, 4.0, 17.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 16.0, 32.0, 38.0, 19.0, 55.0, 49.0, 94.0, 67.0, 53.0, 9.0, 0.0, 0.0, 15.0, 39.0, 50.0, 6.0, 15.0, 5.0, 3.0, 0.0, 0.0, 24.0, 49.0, 0.0, 0.0, 9.0, 15.0, 14.0, 22.0, 0.0, 42.0, 35.0, 26.0, 20.0, 0.0, 13.0, 17.0, 9.0, 0.0, 5.0, 33.0, 46.0, 34.0, 34.0, 31.0, 0.0, 0.0, 24.0, 10.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5227797611273255, "mean_inference_ms": 49.82927076677246, "mean_action_processing_ms": 0.7406367351004336, "mean_env_wait_ms": 0.5397495821291354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01438438892364502, "StateBufferConnector_ms": 0.014689445495605469, "ViewRequirementAgentConnector_ms": 0.2276991605758667}, "num_episodes": 18, "episode_return_max": 376.0, "episode_return_min": -42.0, "episode_return_mean": 176.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.3447467444569, "num_env_steps_trained_throughput_per_sec": 204.3447467444569, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 17001.941, "restore_workers_time_ms": 0.017, "training_step_time_ms": 17001.882, "sample_time_ms": 2623.876, "learn_time_ms": 14351.821, "learn_throughput": 278.71, "synch_weights_time_ms": 23.788}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "4f45b_00000", "date": "2024-08-13_02-42-54", "timestamp": 1723531374, "time_this_iter_s": 19.630615949630737, "time_total_s": 5107.590326786041, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb73a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5107.590326786041, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 87.3, "ram_util_percent": 83.17777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.900462194977614, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.094239818986762, "policy_loss": -0.004103283978328503, "vf_loss": 5.097795650820252, "vf_explained_var": 0.007485750427952519, "kl": 0.011534741350241198, "entropy": 0.9412516956291501, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.963268847077612, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.768163609126258, "policy_loss": -0.011048969254636812, "vf_loss": 8.779148654584532, "vf_explained_var": 0.08668907505494577, "kl": 0.01817931088527952, "entropy": 1.2940997324923358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -42.0, "episode_reward_mean": 191.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -193.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 125.0}, "policy_reward_mean": {"prey_policy": 77.04, "predator_policy": 18.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0, 192.0, 252.0, 191.0, 76.0, 63.0, -12.0, 174.0, 117.0, 150.0, 135.0, -42.0, 305.0, 150.0, 119.0, 186.0, 262.0, 104.0, 70.0, 150.0, 187.0, 109.0, 0.0, 161.0, -36.0, 0.0, 290.0, 136.0, 101.0, 142.0, 100.0, 60.0, 273.0, 93.0, 234.0, 180.0, 320.0, 98.0, 152.0, 217.0, 301.0, 223.0, 355.0, 364.0, 111.0, 254.0, 310.0, 147.0, 124.0, 246.0, 376.0, 100.0, 138.0, 138.0, 96.0, 375.0, 193.0, 222.0, 114.0, 89.0, 186.0, 226.0, 334.0, 111.0, 250.0, 284.0, 281.0, 306.0, 238.0, 335.0, 136.0, 298.0, 278.0, 272.0, 203.0, 226.0, 347.0, 265.0, 226.0, 261.0, 290.0, 141.0, 235.0, 135.0, 201.0, 388.0, 192.0, 217.0, 172.0, 96.0, 312.0, 165.0, 298.0, 298.0, 182.0, 256.0, 307.0, 158.0, 146.0, 185.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-103.0, -42.0, 110.0, 46.0, 134.0, 87.0, 49.0, 67.0, 0.0, 70.0, 63.0, 0.0, 0.0, -24.0, 87.0, 86.0, 0.0, 98.0, 49.0, 21.0, 15.0, 120.0, -61.0, -78.0, 146.0, 159.0, 150.0, -4.0, -14.0, 110.0, 89.0, 97.0, 120.0, 108.0, -4.0, 93.0, -18.0, -16.0, 118.0, -20.0, 0.0, 187.0, 0.0, 64.0, 0.0, 0.0, 0.0, 150.0, -32.0, -20.0, 0.0, 0.0, 145.0, 128.0, 50.0, 7.0, 0.0, 71.0, 126.0, -16.0, -16.0, 63.0, 0.0, 60.0, -23.0, 168.0, -6.0, 65.0, 89.0, 33.0, 0.0, 180.0, 183.0, 121.0, 0.0, 98.0, 152.0, -14.0, 84.0, 133.0, 145.0, 148.0, 5.0, 182.0, 178.0, 158.0, 180.0, 176.0, 0.0, 110.0, -10.0, 194.0, 139.0, 143.0, 147.0, 0.0, 0.0, 124.0, 84.0, 162.0, 188.0, 188.0, 36.0, 6.0, 126.0, 0.0, 117.0, 0.0, 0.0, 96.0, 191.0, 182.0, 4.0, 189.0, 36.0, 138.0, 0.0, 57.0, 0.0, -15.0, 75.0, -50.0, 28.0, 136.0, 188.0, 146.0, 64.0, -7.0, 32.0, 162.0, 127.0, 137.0, 190.0, 88.0, 124.0, 158.0, 158.0, 31.0, 153.0, 173.0, 0.0, 107.0, 128.0, 148.0, 158.0, 43.0, 81.0, 145.0, 100.0, 90.0, 147.0, 53.0, 185.0, 157.0, 44.0, 142.0, 67.0, 91.0, 109.0, 121.0, 196.0, 70.0, 71.0, 46.0, 169.0, 66.0, -107.0, -5.0, 91.0, 83.0, 192.0, 194.0, 68.0, 68.0, 98.0, 12.0, 152.0, -6.0, -193.0, 103.0, 173.0, 117.0, 154.0, 0.0, 127.0, 154.0, 154.0, 77.0, 61.0, 41.0, 71.0, 147.0, 140.0, 151.0, -136.0, 141.0, 121.0, 0.0, 176.0, 0.0], "policy_predator_policy_reward": [56.0, 90.0, 25.0, 11.0, 31.0, 0.0, 30.0, 45.0, 6.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 16.0, 3.0, 18.0, 62.0, 0.0, 0.0, 95.0, 2.0, 0.0, 0.0, 2.0, 2.0, 18.0, 5.0, 0.0, 0.0, 0.0, 34.0, 0.0, 15.0, 52.0, 52.0, 2.0, 50.0, 0.0, 0.0, 44.0, 1.0, 0.0, 0.0, 0.0, 11.0, 16.0, 0.0, 0.0, 0.0, 4.0, 13.0, 29.0, 50.0, 12.0, 18.0, 23.0, 9.0, 11.0, 42.0, 0.0, 0.0, 59.0, 69.0, 24.0, 10.0, 61.0, 51.0, 0.0, 0.0, 2.0, 14.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 1.0, 36.0, 0.0, 19.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 70.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 34.0, 24.0, 0.0, 12.0, 4.0, 17.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 16.0, 32.0, 38.0, 19.0, 55.0, 49.0, 94.0, 67.0, 53.0, 9.0, 0.0, 0.0, 15.0, 39.0, 50.0, 6.0, 15.0, 5.0, 3.0, 0.0, 0.0, 24.0, 49.0, 0.0, 0.0, 9.0, 15.0, 14.0, 22.0, 0.0, 42.0, 35.0, 26.0, 20.0, 0.0, 13.0, 17.0, 9.0, 0.0, 5.0, 33.0, 46.0, 34.0, 34.0, 31.0, 0.0, 0.0, 24.0, 10.0, 14.0, 0.0, 0.0, 122.0, 125.0, 24.0, 3.0, 0.0, 2.0, 25.0, 31.0, 75.0, 32.0, 14.0, 12.0, 95.0, 91.0, 0.0, 22.0, 0.0, 11.0, 11.0, 6.0, 31.0, 36.0, 27.0, 53.0, 0.0, 38.0, 8.0, 8.0, 81.0, 72.0, 13.0, 12.0, 2.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5202714904571866, "mean_inference_ms": 48.910031147785666, "mean_action_processing_ms": 0.7375255708910662, "mean_env_wait_ms": 0.5382702011902637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015230536460876465, "StateBufferConnector_ms": 0.01376962661743164, "ViewRequirementAgentConnector_ms": 0.24316072463989258}, "num_episodes": 18, "episode_return_max": 388.0, "episode_return_min": -42.0, "episode_return_mean": 191.73, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 198.66956222907908, "num_env_steps_trained_throughput_per_sec": 198.66956222907908, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 17253.075, "restore_workers_time_ms": 0.017, "training_step_time_ms": 17253.023, "sample_time_ms": 2651.397, "learn_time_ms": 14572.995, "learn_throughput": 274.48, "synch_weights_time_ms": 26.026}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "4f45b_00000", "date": "2024-08-13_02-43-14", "timestamp": 1723531394, "time_this_iter_s": 20.205655097961426, "time_total_s": 5127.795981884003, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cda5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5127.795981884003, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 87.01034482758621, "ram_util_percent": 83.4344827586207}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9350401655785621, "cur_kl_coeff": 0.047460937500000015, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7546086938292893, "policy_loss": -0.0016296657160781915, "vf_loss": 2.7560653258883763, "vf_explained_var": -0.020639989836506112, "kl": 0.0036456691034650068, "entropy": 0.889417879385923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.637168786103133, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.488057502615389, "policy_loss": -0.005132547825594585, "vf_loss": 8.493142134802682, "vf_explained_var": 0.34393124391162205, "kl": 0.0136308058666647, "entropy": 1.3471475299073274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -36.0, "episode_reward_mean": 210.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -193.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 125.0}, "policy_reward_mean": {"prey_policy": 83.415, "predator_policy": 21.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 161.0, -36.0, 0.0, 290.0, 136.0, 101.0, 142.0, 100.0, 60.0, 273.0, 93.0, 234.0, 180.0, 320.0, 98.0, 152.0, 217.0, 301.0, 223.0, 355.0, 364.0, 111.0, 254.0, 310.0, 147.0, 124.0, 246.0, 376.0, 100.0, 138.0, 138.0, 96.0, 375.0, 193.0, 222.0, 114.0, 89.0, 186.0, 226.0, 334.0, 111.0, 250.0, 284.0, 281.0, 306.0, 238.0, 335.0, 136.0, 298.0, 278.0, 272.0, 203.0, 226.0, 347.0, 265.0, 226.0, 261.0, 290.0, 141.0, 235.0, 135.0, 201.0, 388.0, 192.0, 217.0, 172.0, 96.0, 312.0, 165.0, 298.0, 298.0, 182.0, 256.0, 307.0, 158.0, 146.0, 185.0, 195.0, 282.0, 146.0, 282.0, 277.0, 335.0, 263.0, 267.0, 295.0, 165.0, 210.0, -1.0, 243.0, 118.0, 172.0, 323.0, 212.0, 207.0, 70.0, 324.0, 267.0, 157.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 150.0, -32.0, -20.0, 0.0, 0.0, 145.0, 128.0, 50.0, 7.0, 0.0, 71.0, 126.0, -16.0, -16.0, 63.0, 0.0, 60.0, -23.0, 168.0, -6.0, 65.0, 89.0, 33.0, 0.0, 180.0, 183.0, 121.0, 0.0, 98.0, 152.0, -14.0, 84.0, 133.0, 145.0, 148.0, 5.0, 182.0, 178.0, 158.0, 180.0, 176.0, 0.0, 110.0, -10.0, 194.0, 139.0, 143.0, 147.0, 0.0, 0.0, 124.0, 84.0, 162.0, 188.0, 188.0, 36.0, 6.0, 126.0, 0.0, 117.0, 0.0, 0.0, 96.0, 191.0, 182.0, 4.0, 189.0, 36.0, 138.0, 0.0, 57.0, 0.0, -15.0, 75.0, -50.0, 28.0, 136.0, 188.0, 146.0, 64.0, -7.0, 32.0, 162.0, 127.0, 137.0, 190.0, 88.0, 124.0, 158.0, 158.0, 31.0, 153.0, 173.0, 0.0, 107.0, 128.0, 148.0, 158.0, 43.0, 81.0, 145.0, 100.0, 90.0, 147.0, 53.0, 185.0, 157.0, 44.0, 142.0, 67.0, 91.0, 109.0, 121.0, 196.0, 70.0, 71.0, 46.0, 169.0, 66.0, -107.0, -5.0, 91.0, 83.0, 192.0, 194.0, 68.0, 68.0, 98.0, 12.0, 152.0, -6.0, -193.0, 103.0, 173.0, 117.0, 154.0, 0.0, 127.0, 154.0, 154.0, 77.0, 61.0, 41.0, 71.0, 147.0, 140.0, 151.0, -136.0, 141.0, 121.0, 0.0, 176.0, 0.0, -160.0, 156.0, 113.0, 127.0, 148.0, -44.0, 143.0, 55.0, 97.0, 140.0, 150.0, 176.0, 40.0, 137.0, 86.0, 142.0, 136.0, 134.0, 19.0, -53.0, 105.0, 49.0, 0.0, -2.0, -106.0, 187.0, 165.0, -94.0, 141.0, 9.0, 152.0, 147.0, 62.0, 87.0, 142.0, 24.0, 44.0, -72.0, 137.0, 157.0, 125.0, 92.0, 153.0, -12.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 11.0, 16.0, 0.0, 0.0, 0.0, 4.0, 13.0, 29.0, 50.0, 12.0, 18.0, 23.0, 9.0, 11.0, 42.0, 0.0, 0.0, 59.0, 69.0, 24.0, 10.0, 61.0, 51.0, 0.0, 0.0, 2.0, 14.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 7.0, 1.0, 36.0, 0.0, 19.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 70.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 34.0, 24.0, 0.0, 12.0, 4.0, 17.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 16.0, 32.0, 38.0, 19.0, 55.0, 49.0, 94.0, 67.0, 53.0, 9.0, 0.0, 0.0, 15.0, 39.0, 50.0, 6.0, 15.0, 5.0, 3.0, 0.0, 0.0, 24.0, 49.0, 0.0, 0.0, 9.0, 15.0, 14.0, 22.0, 0.0, 42.0, 35.0, 26.0, 20.0, 0.0, 13.0, 17.0, 9.0, 0.0, 5.0, 33.0, 46.0, 34.0, 34.0, 31.0, 0.0, 0.0, 24.0, 10.0, 14.0, 0.0, 0.0, 122.0, 125.0, 24.0, 3.0, 0.0, 2.0, 25.0, 31.0, 75.0, 32.0, 14.0, 12.0, 95.0, 91.0, 0.0, 22.0, 0.0, 11.0, 11.0, 6.0, 31.0, 36.0, 27.0, 53.0, 0.0, 38.0, 8.0, 8.0, 81.0, 72.0, 13.0, 12.0, 2.0, 7.0, 81.0, 118.0, 34.0, 8.0, 16.0, 26.0, 38.0, 46.0, 34.0, 6.0, 7.0, 2.0, 38.0, 48.0, 18.0, 21.0, 24.0, 1.0, 88.0, 111.0, 34.0, 22.0, 0.0, 1.0, 87.0, 75.0, 0.0, 47.0, 21.0, 1.0, 0.0, 24.0, 17.0, 46.0, 29.0, 12.0, 2.0, 96.0, 9.0, 21.0, 39.0, 11.0, 10.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.514846712804344, "mean_inference_ms": 47.85911406982531, "mean_action_processing_ms": 0.7310619221801651, "mean_env_wait_ms": 0.5353176801059095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011337757110595703, "StateBufferConnector_ms": 0.009150862693786621, "ViewRequirementAgentConnector_ms": 0.22500157356262207}, "num_episodes": 22, "episode_return_max": 388.0, "episode_return_min": -36.0, "episode_return_mean": 210.43, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.45508114464917, "num_env_steps_trained_throughput_per_sec": 210.45508114464917, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 17747.258, "restore_workers_time_ms": 0.018, "training_step_time_ms": 17747.206, "sample_time_ms": 2726.009, "learn_time_ms": 14995.439, "learn_throughput": 266.748, "synch_weights_time_ms": 23.391}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "4f45b_00000", "date": "2024-08-13_02-43-33", "timestamp": 1723531413, "time_this_iter_s": 19.053693056106567, "time_total_s": 5146.849674940109, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24704c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5146.849674940109, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 84.55185185185185, "ram_util_percent": 83.41111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8330337781202857, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.278699463795102, "policy_loss": -0.003804580022694257, "vf_loss": 1.282315532043182, "vf_explained_var": 0.005423966728190266, "kl": 0.007943962461815028, "entropy": 0.8665136381431863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.112484636808198, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.268241521038076, "policy_loss": -0.006050769940743016, "vf_loss": 9.27422438525649, "vf_explained_var": 0.19066854459898813, "kl": 0.01931149456579191, "entropy": 1.3071568776060034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -26.0, "episode_reward_mean": 230.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -193.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 125.0}, "policy_reward_mean": {"prey_policy": 93.455, "predator_policy": 21.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [254.0, 310.0, 147.0, 124.0, 246.0, 376.0, 100.0, 138.0, 138.0, 96.0, 375.0, 193.0, 222.0, 114.0, 89.0, 186.0, 226.0, 334.0, 111.0, 250.0, 284.0, 281.0, 306.0, 238.0, 335.0, 136.0, 298.0, 278.0, 272.0, 203.0, 226.0, 347.0, 265.0, 226.0, 261.0, 290.0, 141.0, 235.0, 135.0, 201.0, 388.0, 192.0, 217.0, 172.0, 96.0, 312.0, 165.0, 298.0, 298.0, 182.0, 256.0, 307.0, 158.0, 146.0, 185.0, 195.0, 282.0, 146.0, 282.0, 277.0, 335.0, 263.0, 267.0, 295.0, 165.0, 210.0, -1.0, 243.0, 118.0, 172.0, 323.0, 212.0, 207.0, 70.0, 324.0, 267.0, 157.0, 254.0, 316.0, 313.0, 245.0, 157.0, 303.0, 303.0, 264.0, 291.0, 254.0, 251.0, 350.0, 265.0, 323.0, -26.0, 314.0, 257.0, 302.0, 198.0, 282.0, 310.0, 249.0, 123.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, 194.0, 139.0, 143.0, 147.0, 0.0, 0.0, 124.0, 84.0, 162.0, 188.0, 188.0, 36.0, 6.0, 126.0, 0.0, 117.0, 0.0, 0.0, 96.0, 191.0, 182.0, 4.0, 189.0, 36.0, 138.0, 0.0, 57.0, 0.0, -15.0, 75.0, -50.0, 28.0, 136.0, 188.0, 146.0, 64.0, -7.0, 32.0, 162.0, 127.0, 137.0, 190.0, 88.0, 124.0, 158.0, 158.0, 31.0, 153.0, 173.0, 0.0, 107.0, 128.0, 148.0, 158.0, 43.0, 81.0, 145.0, 100.0, 90.0, 147.0, 53.0, 185.0, 157.0, 44.0, 142.0, 67.0, 91.0, 109.0, 121.0, 196.0, 70.0, 71.0, 46.0, 169.0, 66.0, -107.0, -5.0, 91.0, 83.0, 192.0, 194.0, 68.0, 68.0, 98.0, 12.0, 152.0, -6.0, -193.0, 103.0, 173.0, 117.0, 154.0, 0.0, 127.0, 154.0, 154.0, 77.0, 61.0, 41.0, 71.0, 147.0, 140.0, 151.0, -136.0, 141.0, 121.0, 0.0, 176.0, 0.0, -160.0, 156.0, 113.0, 127.0, 148.0, -44.0, 143.0, 55.0, 97.0, 140.0, 150.0, 176.0, 40.0, 137.0, 86.0, 142.0, 136.0, 134.0, 19.0, -53.0, 105.0, 49.0, 0.0, -2.0, -106.0, 187.0, 165.0, -94.0, 141.0, 9.0, 152.0, 147.0, 62.0, 87.0, 142.0, 24.0, 44.0, -72.0, 137.0, 157.0, 125.0, 92.0, 153.0, -12.0, 164.0, 72.0, 102.0, 179.0, 162.0, 151.0, 85.0, 129.0, -19.0, 119.0, 147.0, 138.0, 193.0, 66.0, 98.0, 136.0, 136.0, 133.0, 151.0, 99.0, 149.0, 92.0, 178.0, 156.0, 139.0, 112.0, 130.0, 193.0, 39.0, -166.0, 186.0, 97.0, 108.0, 127.0, 141.0, 144.0, 151.0, 31.0, 111.0, 171.0, 161.0, 125.0, 117.0, 83.0, -96.0, 149.0], "policy_predator_policy_reward": [0.0, 70.0, 28.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 34.0, 24.0, 0.0, 12.0, 4.0, 17.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 16.0, 32.0, 38.0, 19.0, 55.0, 49.0, 94.0, 67.0, 53.0, 9.0, 0.0, 0.0, 15.0, 39.0, 50.0, 6.0, 15.0, 5.0, 3.0, 0.0, 0.0, 24.0, 49.0, 0.0, 0.0, 9.0, 15.0, 14.0, 22.0, 0.0, 42.0, 35.0, 26.0, 20.0, 0.0, 13.0, 17.0, 9.0, 0.0, 5.0, 33.0, 46.0, 34.0, 34.0, 31.0, 0.0, 0.0, 24.0, 10.0, 14.0, 0.0, 0.0, 122.0, 125.0, 24.0, 3.0, 0.0, 2.0, 25.0, 31.0, 75.0, 32.0, 14.0, 12.0, 95.0, 91.0, 0.0, 22.0, 0.0, 11.0, 11.0, 6.0, 31.0, 36.0, 27.0, 53.0, 0.0, 38.0, 8.0, 8.0, 81.0, 72.0, 13.0, 12.0, 2.0, 7.0, 81.0, 118.0, 34.0, 8.0, 16.0, 26.0, 38.0, 46.0, 34.0, 6.0, 7.0, 2.0, 38.0, 48.0, 18.0, 21.0, 24.0, 1.0, 88.0, 111.0, 34.0, 22.0, 0.0, 1.0, 87.0, 75.0, 0.0, 47.0, 21.0, 1.0, 0.0, 24.0, 17.0, 46.0, 29.0, 12.0, 2.0, 96.0, 9.0, 21.0, 39.0, 11.0, 10.0, 6.0, 18.0, 0.0, 27.0, 8.0, 0.0, 0.0, 15.0, 16.0, 16.0, 41.0, 18.0, 0.0, 28.0, 16.0, 0.0, 30.0, 22.0, 0.0, 0.0, 4.0, 0.0, 10.0, 16.0, 0.0, 10.0, 4.0, 0.0, 0.0, 83.0, 18.0, 29.0, 2.0, 12.0, 10.0, 12.0, 5.0, 0.0, 16.0, 0.0, 0.0, 23.0, 1.0, 22.0, 27.0, 6.0, 64.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5135251567434318, "mean_inference_ms": 46.8396688138758, "mean_action_processing_ms": 0.7300018341092465, "mean_env_wait_ms": 0.5349327162831767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011652946472167969, "StateBufferConnector_ms": 0.0062448978424072266, "ViewRequirementAgentConnector_ms": 0.21893978118896484}, "num_episodes": 23, "episode_return_max": 388.0, "episode_return_min": -26.0, "episode_return_mean": 230.66, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.1100118132939, "num_env_steps_trained_throughput_per_sec": 179.1100118132939, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 18560.995, "restore_workers_time_ms": 0.016, "training_step_time_ms": 18560.945, "sample_time_ms": 2913.612, "learn_time_ms": 15621.501, "learn_throughput": 256.057, "synch_weights_time_ms": 23.331}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "4f45b_00000", "date": "2024-08-13_02-43-55", "timestamp": 1723531435, "time_this_iter_s": 22.37612009048462, "time_total_s": 5169.225795030594, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb7160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5169.225795030594, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 87.109375, "ram_util_percent": 83.303125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9791609061379282, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.590389061604858, "policy_loss": -0.002325236677344908, "vf_loss": 3.592467140520691, "vf_explained_var": 0.02559771323330188, "kl": 0.010415145325666746, "entropy": 0.8632424669921713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.594457530754584, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.233692376575773, "policy_loss": -0.004857070027067075, "vf_loss": 9.238501013902129, "vf_explained_var": 0.2637813376371192, "kl": 0.013776168162257858, "entropy": 1.2851133061464501, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -26.0, "episode_reward_mean": 239.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -193.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 125.0}, "policy_reward_mean": {"prey_policy": 98.04, "predator_policy": 21.61}, "custom_metrics": {}, "hist_stats": {"episode_reward": [111.0, 250.0, 284.0, 281.0, 306.0, 238.0, 335.0, 136.0, 298.0, 278.0, 272.0, 203.0, 226.0, 347.0, 265.0, 226.0, 261.0, 290.0, 141.0, 235.0, 135.0, 201.0, 388.0, 192.0, 217.0, 172.0, 96.0, 312.0, 165.0, 298.0, 298.0, 182.0, 256.0, 307.0, 158.0, 146.0, 185.0, 195.0, 282.0, 146.0, 282.0, 277.0, 335.0, 263.0, 267.0, 295.0, 165.0, 210.0, -1.0, 243.0, 118.0, 172.0, 323.0, 212.0, 207.0, 70.0, 324.0, 267.0, 157.0, 254.0, 316.0, 313.0, 245.0, 157.0, 303.0, 303.0, 264.0, 291.0, 254.0, 251.0, 350.0, 265.0, 323.0, -26.0, 314.0, 257.0, 302.0, 198.0, 282.0, 310.0, 249.0, 123.0, 272.0, 200.0, 301.0, 209.0, 315.0, 202.0, 338.0, 120.0, 311.0, 351.0, 298.0, 93.0, 290.0, 129.0, 358.0, 138.0, 310.0, 297.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [64.0, -7.0, 32.0, 162.0, 127.0, 137.0, 190.0, 88.0, 124.0, 158.0, 158.0, 31.0, 153.0, 173.0, 0.0, 107.0, 128.0, 148.0, 158.0, 43.0, 81.0, 145.0, 100.0, 90.0, 147.0, 53.0, 185.0, 157.0, 44.0, 142.0, 67.0, 91.0, 109.0, 121.0, 196.0, 70.0, 71.0, 46.0, 169.0, 66.0, -107.0, -5.0, 91.0, 83.0, 192.0, 194.0, 68.0, 68.0, 98.0, 12.0, 152.0, -6.0, -193.0, 103.0, 173.0, 117.0, 154.0, 0.0, 127.0, 154.0, 154.0, 77.0, 61.0, 41.0, 71.0, 147.0, 140.0, 151.0, -136.0, 141.0, 121.0, 0.0, 176.0, 0.0, -160.0, 156.0, 113.0, 127.0, 148.0, -44.0, 143.0, 55.0, 97.0, 140.0, 150.0, 176.0, 40.0, 137.0, 86.0, 142.0, 136.0, 134.0, 19.0, -53.0, 105.0, 49.0, 0.0, -2.0, -106.0, 187.0, 165.0, -94.0, 141.0, 9.0, 152.0, 147.0, 62.0, 87.0, 142.0, 24.0, 44.0, -72.0, 137.0, 157.0, 125.0, 92.0, 153.0, -12.0, 164.0, 72.0, 102.0, 179.0, 162.0, 151.0, 85.0, 129.0, -19.0, 119.0, 147.0, 138.0, 193.0, 66.0, 98.0, 136.0, 136.0, 133.0, 151.0, 99.0, 149.0, 92.0, 178.0, 156.0, 139.0, 112.0, 130.0, 193.0, 39.0, -166.0, 186.0, 97.0, 108.0, 127.0, 141.0, 144.0, 151.0, 31.0, 111.0, 171.0, 161.0, 125.0, 117.0, 83.0, -96.0, 149.0, 77.0, 194.0, 86.0, 84.0, 131.0, 157.0, 33.0, 128.0, 197.0, 117.0, -59.0, 122.0, 159.0, 162.0, -46.0, 142.0, 80.0, 191.0, 149.0, 200.0, 121.0, 162.0, -72.0, 69.0, 150.0, 124.0, 13.0, 78.0, 165.0, 191.0, 84.0, 4.0, 160.0, 138.0, 136.0, 135.0], "policy_predator_policy_reward": [15.0, 39.0, 50.0, 6.0, 15.0, 5.0, 3.0, 0.0, 0.0, 24.0, 49.0, 0.0, 0.0, 9.0, 15.0, 14.0, 22.0, 0.0, 42.0, 35.0, 26.0, 20.0, 0.0, 13.0, 17.0, 9.0, 0.0, 5.0, 33.0, 46.0, 34.0, 34.0, 31.0, 0.0, 0.0, 24.0, 10.0, 14.0, 0.0, 0.0, 122.0, 125.0, 24.0, 3.0, 0.0, 2.0, 25.0, 31.0, 75.0, 32.0, 14.0, 12.0, 95.0, 91.0, 0.0, 22.0, 0.0, 11.0, 11.0, 6.0, 31.0, 36.0, 27.0, 53.0, 0.0, 38.0, 8.0, 8.0, 81.0, 72.0, 13.0, 12.0, 2.0, 7.0, 81.0, 118.0, 34.0, 8.0, 16.0, 26.0, 38.0, 46.0, 34.0, 6.0, 7.0, 2.0, 38.0, 48.0, 18.0, 21.0, 24.0, 1.0, 88.0, 111.0, 34.0, 22.0, 0.0, 1.0, 87.0, 75.0, 0.0, 47.0, 21.0, 1.0, 0.0, 24.0, 17.0, 46.0, 29.0, 12.0, 2.0, 96.0, 9.0, 21.0, 39.0, 11.0, 10.0, 6.0, 18.0, 0.0, 27.0, 8.0, 0.0, 0.0, 15.0, 16.0, 16.0, 41.0, 18.0, 0.0, 28.0, 16.0, 0.0, 30.0, 22.0, 0.0, 0.0, 4.0, 0.0, 10.0, 16.0, 0.0, 10.0, 4.0, 0.0, 0.0, 83.0, 18.0, 29.0, 2.0, 12.0, 10.0, 12.0, 5.0, 0.0, 16.0, 0.0, 0.0, 23.0, 1.0, 22.0, 27.0, 6.0, 64.0, 1.0, 0.0, 30.0, 0.0, 11.0, 2.0, 26.0, 22.0, 0.0, 1.0, 59.0, 80.0, 3.0, 14.0, 23.0, 1.0, 40.0, 0.0, 0.0, 2.0, 0.0, 15.0, 60.0, 36.0, 4.0, 12.0, 19.0, 19.0, 0.0, 2.0, 40.0, 10.0, 4.0, 8.0, 26.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.512878671279253, "mean_inference_ms": 46.03914662876225, "mean_action_processing_ms": 0.7264041725554571, "mean_env_wait_ms": 0.5343805700043341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01129770278930664, "StateBufferConnector_ms": 0.013224244117736816, "ViewRequirementAgentConnector_ms": 0.22285330295562744}, "num_episodes": 18, "episode_return_max": 388.0, "episode_return_min": -26.0, "episode_return_mean": 239.3, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 173.3691542992682, "num_env_steps_trained_throughput_per_sec": 173.3691542992682, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 19357.222, "restore_workers_time_ms": 0.016, "training_step_time_ms": 19357.171, "sample_time_ms": 2989.808, "learn_time_ms": 16342.374, "learn_throughput": 244.762, "synch_weights_time_ms": 22.444}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "4f45b_00000", "date": "2024-08-13_02-44-19", "timestamp": 1723531459, "time_this_iter_s": 23.12874174118042, "time_total_s": 5192.354536771774, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5192.354536771774, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 87.334375, "ram_util_percent": 83.4875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9489956919872572, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2440654553118207, "policy_loss": -0.00604773997550919, "vf_loss": 1.2498294960569452, "vf_explained_var": 0.011076927941942972, "kl": 0.01195518946495588, "entropy": 0.8331235147027112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.482371963757687, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.420754539651215, "policy_loss": -0.0037731460641783777, "vf_loss": 9.42448142571424, "vf_explained_var": 0.16217093691624032, "kl": 0.013166674962762736, "entropy": 1.2829304063761675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 388.0, "episode_reward_min": -26.0, "episode_reward_mean": 239.48, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -193.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 125.0}, "policy_reward_mean": {"prey_policy": 99.54, "predator_policy": 20.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [141.0, 235.0, 135.0, 201.0, 388.0, 192.0, 217.0, 172.0, 96.0, 312.0, 165.0, 298.0, 298.0, 182.0, 256.0, 307.0, 158.0, 146.0, 185.0, 195.0, 282.0, 146.0, 282.0, 277.0, 335.0, 263.0, 267.0, 295.0, 165.0, 210.0, -1.0, 243.0, 118.0, 172.0, 323.0, 212.0, 207.0, 70.0, 324.0, 267.0, 157.0, 254.0, 316.0, 313.0, 245.0, 157.0, 303.0, 303.0, 264.0, 291.0, 254.0, 251.0, 350.0, 265.0, 323.0, -26.0, 314.0, 257.0, 302.0, 198.0, 282.0, 310.0, 249.0, 123.0, 272.0, 200.0, 301.0, 209.0, 315.0, 202.0, 338.0, 120.0, 311.0, 351.0, 298.0, 93.0, 290.0, 129.0, 358.0, 138.0, 310.0, 297.0, 255.0, 223.0, 221.0, 325.0, 180.0, 318.0, 304.0, 213.0, 218.0, 234.0, 350.0, 192.0, 310.0, 276.0, 238.0, 322.0, 266.0, 180.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [71.0, 46.0, 169.0, 66.0, -107.0, -5.0, 91.0, 83.0, 192.0, 194.0, 68.0, 68.0, 98.0, 12.0, 152.0, -6.0, -193.0, 103.0, 173.0, 117.0, 154.0, 0.0, 127.0, 154.0, 154.0, 77.0, 61.0, 41.0, 71.0, 147.0, 140.0, 151.0, -136.0, 141.0, 121.0, 0.0, 176.0, 0.0, -160.0, 156.0, 113.0, 127.0, 148.0, -44.0, 143.0, 55.0, 97.0, 140.0, 150.0, 176.0, 40.0, 137.0, 86.0, 142.0, 136.0, 134.0, 19.0, -53.0, 105.0, 49.0, 0.0, -2.0, -106.0, 187.0, 165.0, -94.0, 141.0, 9.0, 152.0, 147.0, 62.0, 87.0, 142.0, 24.0, 44.0, -72.0, 137.0, 157.0, 125.0, 92.0, 153.0, -12.0, 164.0, 72.0, 102.0, 179.0, 162.0, 151.0, 85.0, 129.0, -19.0, 119.0, 147.0, 138.0, 193.0, 66.0, 98.0, 136.0, 136.0, 133.0, 151.0, 99.0, 149.0, 92.0, 178.0, 156.0, 139.0, 112.0, 130.0, 193.0, 39.0, -166.0, 186.0, 97.0, 108.0, 127.0, 141.0, 144.0, 151.0, 31.0, 111.0, 171.0, 161.0, 125.0, 117.0, 83.0, -96.0, 149.0, 77.0, 194.0, 86.0, 84.0, 131.0, 157.0, 33.0, 128.0, 197.0, 117.0, -59.0, 122.0, 159.0, 162.0, -46.0, 142.0, 80.0, 191.0, 149.0, 200.0, 121.0, 162.0, -72.0, 69.0, 150.0, 124.0, 13.0, 78.0, 165.0, 191.0, 84.0, 4.0, 160.0, 138.0, 136.0, 135.0, 101.0, 114.0, 121.0, 90.0, 55.0, 118.0, 150.0, 167.0, 47.0, 112.0, 158.0, 139.0, 140.0, 130.0, 75.0, 113.0, 122.0, 52.0, 148.0, 86.0, 200.0, 134.0, 111.0, 77.0, 148.0, 148.0, 120.0, 110.0, 159.0, 78.0, 174.0, 147.0, 176.0, 75.0, 170.0, 7.0], "policy_predator_policy_reward": [10.0, 14.0, 0.0, 0.0, 122.0, 125.0, 24.0, 3.0, 0.0, 2.0, 25.0, 31.0, 75.0, 32.0, 14.0, 12.0, 95.0, 91.0, 0.0, 22.0, 0.0, 11.0, 11.0, 6.0, 31.0, 36.0, 27.0, 53.0, 0.0, 38.0, 8.0, 8.0, 81.0, 72.0, 13.0, 12.0, 2.0, 7.0, 81.0, 118.0, 34.0, 8.0, 16.0, 26.0, 38.0, 46.0, 34.0, 6.0, 7.0, 2.0, 38.0, 48.0, 18.0, 21.0, 24.0, 1.0, 88.0, 111.0, 34.0, 22.0, 0.0, 1.0, 87.0, 75.0, 0.0, 47.0, 21.0, 1.0, 0.0, 24.0, 17.0, 46.0, 29.0, 12.0, 2.0, 96.0, 9.0, 21.0, 39.0, 11.0, 10.0, 6.0, 18.0, 0.0, 27.0, 8.0, 0.0, 0.0, 15.0, 16.0, 16.0, 41.0, 18.0, 0.0, 28.0, 16.0, 0.0, 30.0, 22.0, 0.0, 0.0, 4.0, 0.0, 10.0, 16.0, 0.0, 10.0, 4.0, 0.0, 0.0, 83.0, 18.0, 29.0, 2.0, 12.0, 10.0, 12.0, 5.0, 0.0, 16.0, 0.0, 0.0, 23.0, 1.0, 22.0, 27.0, 6.0, 64.0, 1.0, 0.0, 30.0, 0.0, 11.0, 2.0, 26.0, 22.0, 0.0, 1.0, 59.0, 80.0, 3.0, 14.0, 23.0, 1.0, 40.0, 0.0, 0.0, 2.0, 0.0, 15.0, 60.0, 36.0, 4.0, 12.0, 19.0, 19.0, 0.0, 2.0, 40.0, 10.0, 4.0, 8.0, 26.0, 0.0, 20.0, 20.0, 5.0, 7.0, 17.0, 31.0, 3.0, 5.0, 18.0, 3.0, 21.0, 0.0, 22.0, 12.0, 11.0, 14.0, 27.0, 17.0, 0.0, 0.0, 16.0, 0.0, 4.0, 0.0, 14.0, 0.0, 16.0, 30.0, 1.0, 0.0, 0.0, 1.0, 15.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5108439482989937, "mean_inference_ms": 45.262154205320385, "mean_action_processing_ms": 0.7234087625062985, "mean_env_wait_ms": 0.5336040392690864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008933782577514648, "StateBufferConnector_ms": 0.012456893920898438, "ViewRequirementAgentConnector_ms": 0.2121495008468628}, "num_episodes": 18, "episode_return_max": 388.0, "episode_return_min": -26.0, "episode_return_mean": 239.48, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 176.35659595135374, "num_env_steps_trained_throughput_per_sec": 176.35659595135374, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 19972.128, "restore_workers_time_ms": 0.017, "training_step_time_ms": 19972.077, "sample_time_ms": 3064.712, "learn_time_ms": 16885.865, "learn_throughput": 236.885, "synch_weights_time_ms": 18.759}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "4f45b_00000", "date": "2024-08-13_02-44-41", "timestamp": 1723531481, "time_this_iter_s": 22.760724782943726, "time_total_s": 5215.115261554718, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20bf0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5215.115261554718, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 85.746875, "ram_util_percent": 82.953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1302781788918077, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.77458465257019, "policy_loss": -0.0030870589237936116, "vf_loss": 2.777401636517237, "vf_explained_var": 0.02760374385213095, "kl": 0.011381284238502794, "entropy": 0.8288124122001507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.232457967047338, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.403078065095125, "policy_loss": -0.003965584767203797, "vf_loss": 9.40699048975788, "vf_explained_var": 0.06712399364779235, "kl": 0.01511473878151779, "entropy": 1.2213434991382417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -26.0, "episode_reward_mean": 251.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -166.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 118.0}, "policy_reward_mean": {"prey_policy": 108.235, "predator_policy": 17.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [185.0, 195.0, 282.0, 146.0, 282.0, 277.0, 335.0, 263.0, 267.0, 295.0, 165.0, 210.0, -1.0, 243.0, 118.0, 172.0, 323.0, 212.0, 207.0, 70.0, 324.0, 267.0, 157.0, 254.0, 316.0, 313.0, 245.0, 157.0, 303.0, 303.0, 264.0, 291.0, 254.0, 251.0, 350.0, 265.0, 323.0, -26.0, 314.0, 257.0, 302.0, 198.0, 282.0, 310.0, 249.0, 123.0, 272.0, 200.0, 301.0, 209.0, 315.0, 202.0, 338.0, 120.0, 311.0, 351.0, 298.0, 93.0, 290.0, 129.0, 358.0, 138.0, 310.0, 297.0, 255.0, 223.0, 221.0, 325.0, 180.0, 318.0, 304.0, 213.0, 218.0, 234.0, 350.0, 192.0, 310.0, 276.0, 238.0, 322.0, 266.0, 180.0, 289.0, 287.0, 281.0, 327.0, 350.0, 215.0, 329.0, 229.0, 194.0, 327.0, 227.0, 300.0, 233.0, 279.0, 376.0, 306.0, 329.0, 225.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [176.0, 0.0, -160.0, 156.0, 113.0, 127.0, 148.0, -44.0, 143.0, 55.0, 97.0, 140.0, 150.0, 176.0, 40.0, 137.0, 86.0, 142.0, 136.0, 134.0, 19.0, -53.0, 105.0, 49.0, 0.0, -2.0, -106.0, 187.0, 165.0, -94.0, 141.0, 9.0, 152.0, 147.0, 62.0, 87.0, 142.0, 24.0, 44.0, -72.0, 137.0, 157.0, 125.0, 92.0, 153.0, -12.0, 164.0, 72.0, 102.0, 179.0, 162.0, 151.0, 85.0, 129.0, -19.0, 119.0, 147.0, 138.0, 193.0, 66.0, 98.0, 136.0, 136.0, 133.0, 151.0, 99.0, 149.0, 92.0, 178.0, 156.0, 139.0, 112.0, 130.0, 193.0, 39.0, -166.0, 186.0, 97.0, 108.0, 127.0, 141.0, 144.0, 151.0, 31.0, 111.0, 171.0, 161.0, 125.0, 117.0, 83.0, -96.0, 149.0, 77.0, 194.0, 86.0, 84.0, 131.0, 157.0, 33.0, 128.0, 197.0, 117.0, -59.0, 122.0, 159.0, 162.0, -46.0, 142.0, 80.0, 191.0, 149.0, 200.0, 121.0, 162.0, -72.0, 69.0, 150.0, 124.0, 13.0, 78.0, 165.0, 191.0, 84.0, 4.0, 160.0, 138.0, 136.0, 135.0, 101.0, 114.0, 121.0, 90.0, 55.0, 118.0, 150.0, 167.0, 47.0, 112.0, 158.0, 139.0, 140.0, 130.0, 75.0, 113.0, 122.0, 52.0, 148.0, 86.0, 200.0, 134.0, 111.0, 77.0, 148.0, 148.0, 120.0, 110.0, 159.0, 78.0, 174.0, 147.0, 176.0, 75.0, 170.0, 7.0, 185.0, 91.0, 109.0, 149.0, 116.0, 153.0, 140.0, 172.0, 161.0, 180.0, 97.0, -1.0, 155.0, 167.0, 135.0, 63.0, 116.0, 16.0, 179.0, 139.0, 115.0, 68.0, 102.0, 149.0, 119.0, 114.0, 69.0, 185.0, 159.0, 199.0, 153.0, 123.0, 139.0, 161.0, 146.0, 11.0], "policy_predator_policy_reward": [2.0, 7.0, 81.0, 118.0, 34.0, 8.0, 16.0, 26.0, 38.0, 46.0, 34.0, 6.0, 7.0, 2.0, 38.0, 48.0, 18.0, 21.0, 24.0, 1.0, 88.0, 111.0, 34.0, 22.0, 0.0, 1.0, 87.0, 75.0, 0.0, 47.0, 21.0, 1.0, 0.0, 24.0, 17.0, 46.0, 29.0, 12.0, 2.0, 96.0, 9.0, 21.0, 39.0, 11.0, 10.0, 6.0, 18.0, 0.0, 27.0, 8.0, 0.0, 0.0, 15.0, 16.0, 16.0, 41.0, 18.0, 0.0, 28.0, 16.0, 0.0, 30.0, 22.0, 0.0, 0.0, 4.0, 0.0, 10.0, 16.0, 0.0, 10.0, 4.0, 0.0, 0.0, 83.0, 18.0, 29.0, 2.0, 12.0, 10.0, 12.0, 5.0, 0.0, 16.0, 0.0, 0.0, 23.0, 1.0, 22.0, 27.0, 6.0, 64.0, 1.0, 0.0, 30.0, 0.0, 11.0, 2.0, 26.0, 22.0, 0.0, 1.0, 59.0, 80.0, 3.0, 14.0, 23.0, 1.0, 40.0, 0.0, 0.0, 2.0, 0.0, 15.0, 60.0, 36.0, 4.0, 12.0, 19.0, 19.0, 0.0, 2.0, 40.0, 10.0, 4.0, 8.0, 26.0, 0.0, 20.0, 20.0, 5.0, 7.0, 17.0, 31.0, 3.0, 5.0, 18.0, 3.0, 21.0, 0.0, 22.0, 12.0, 11.0, 14.0, 27.0, 17.0, 0.0, 0.0, 16.0, 0.0, 4.0, 0.0, 14.0, 0.0, 16.0, 30.0, 1.0, 0.0, 0.0, 1.0, 15.0, 0.0, 3.0, 0.0, 3.0, 10.0, 29.0, 0.0, 1.0, 11.0, 15.0, 0.0, 7.0, 2.0, 67.0, 52.0, 7.0, 0.0, 5.0, 26.0, 26.0, 36.0, 4.0, 5.0, 44.0, 0.0, 21.0, 28.0, 0.0, 0.0, 11.0, 14.0, 11.0, 7.0, 22.0, 8.0, 18.0, 11.0, 51.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5101397137826822, "mean_inference_ms": 44.51932801464967, "mean_action_processing_ms": 0.7209376066765771, "mean_env_wait_ms": 0.5335221729176288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008413195610046387, "StateBufferConnector_ms": 0.014396309852600098, "ViewRequirementAgentConnector_ms": 0.20440900325775146}, "num_episodes": 18, "episode_return_max": 376.0, "episode_return_min": -26.0, "episode_return_mean": 251.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.03073390521982, "num_env_steps_trained_throughput_per_sec": 163.03073390521982, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 20776.317, "restore_workers_time_ms": 0.017, "training_step_time_ms": 20776.266, "sample_time_ms": 3126.116, "learn_time_ms": 17629.478, "learn_throughput": 226.893, "synch_weights_time_ms": 17.878}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "4f45b_00000", "date": "2024-08-13_02-45-06", "timestamp": 1723531506, "time_this_iter_s": 24.585906982421875, "time_total_s": 5239.70116853714, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2470310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5239.70116853714, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 87.9542857142857, "ram_util_percent": 83.33428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1167667159248913, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9968746228192849, "policy_loss": -0.005584733425664208, "vf_loss": 2.0021565495660067, "vf_explained_var": 0.03365624414549934, "kl": 0.01276019261310094, "entropy": 0.797477930658078, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.641135157668401, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.006681213177071, "policy_loss": -0.006146031727758113, "vf_loss": 9.012762558144868, "vf_explained_var": 0.2957189855752168, "kl": 0.018411285018860555, "entropy": 1.243457037935812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -26.0, "episode_reward_mean": 258.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -166.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 83.0}, "policy_reward_mean": {"prey_policy": 115.85, "predator_policy": 13.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [157.0, 254.0, 316.0, 313.0, 245.0, 157.0, 303.0, 303.0, 264.0, 291.0, 254.0, 251.0, 350.0, 265.0, 323.0, -26.0, 314.0, 257.0, 302.0, 198.0, 282.0, 310.0, 249.0, 123.0, 272.0, 200.0, 301.0, 209.0, 315.0, 202.0, 338.0, 120.0, 311.0, 351.0, 298.0, 93.0, 290.0, 129.0, 358.0, 138.0, 310.0, 297.0, 255.0, 223.0, 221.0, 325.0, 180.0, 318.0, 304.0, 213.0, 218.0, 234.0, 350.0, 192.0, 310.0, 276.0, 238.0, 322.0, 266.0, 180.0, 289.0, 287.0, 281.0, 327.0, 350.0, 215.0, 329.0, 229.0, 194.0, 327.0, 227.0, 300.0, 233.0, 279.0, 376.0, 306.0, 329.0, 225.0, 270.0, 253.0, 333.0, 311.0, 274.0, 233.0, 339.0, 241.0, 97.0, 314.0, 286.0, 281.0, 328.0, 213.0, 269.0, 220.0, 200.0, 320.0, 270.0, 259.0, 79.0, 155.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [153.0, -12.0, 164.0, 72.0, 102.0, 179.0, 162.0, 151.0, 85.0, 129.0, -19.0, 119.0, 147.0, 138.0, 193.0, 66.0, 98.0, 136.0, 136.0, 133.0, 151.0, 99.0, 149.0, 92.0, 178.0, 156.0, 139.0, 112.0, 130.0, 193.0, 39.0, -166.0, 186.0, 97.0, 108.0, 127.0, 141.0, 144.0, 151.0, 31.0, 111.0, 171.0, 161.0, 125.0, 117.0, 83.0, -96.0, 149.0, 77.0, 194.0, 86.0, 84.0, 131.0, 157.0, 33.0, 128.0, 197.0, 117.0, -59.0, 122.0, 159.0, 162.0, -46.0, 142.0, 80.0, 191.0, 149.0, 200.0, 121.0, 162.0, -72.0, 69.0, 150.0, 124.0, 13.0, 78.0, 165.0, 191.0, 84.0, 4.0, 160.0, 138.0, 136.0, 135.0, 101.0, 114.0, 121.0, 90.0, 55.0, 118.0, 150.0, 167.0, 47.0, 112.0, 158.0, 139.0, 140.0, 130.0, 75.0, 113.0, 122.0, 52.0, 148.0, 86.0, 200.0, 134.0, 111.0, 77.0, 148.0, 148.0, 120.0, 110.0, 159.0, 78.0, 174.0, 147.0, 176.0, 75.0, 170.0, 7.0, 185.0, 91.0, 109.0, 149.0, 116.0, 153.0, 140.0, 172.0, 161.0, 180.0, 97.0, -1.0, 155.0, 167.0, 135.0, 63.0, 116.0, 16.0, 179.0, 139.0, 115.0, 68.0, 102.0, 149.0, 119.0, 114.0, 69.0, 185.0, 159.0, 199.0, 153.0, 123.0, 139.0, 161.0, 146.0, 11.0, 76.0, 192.0, 120.0, 100.0, 180.0, 153.0, 80.0, 190.0, 71.0, 158.0, 65.0, 163.0, 140.0, 194.0, 42.0, 165.0, 8.0, 70.0, 171.0, 120.0, 116.0, 155.0, 138.0, 122.0, 173.0, 137.0, 24.0, 184.0, 159.0, 74.0, 91.0, 87.0, 51.0, 130.0, 159.0, 140.0, 142.0, 100.0, 196.0, 63.0, -1.0, -31.0, 38.0, 87.0], "policy_predator_policy_reward": [10.0, 6.0, 18.0, 0.0, 27.0, 8.0, 0.0, 0.0, 15.0, 16.0, 16.0, 41.0, 18.0, 0.0, 28.0, 16.0, 0.0, 30.0, 22.0, 0.0, 0.0, 4.0, 0.0, 10.0, 16.0, 0.0, 10.0, 4.0, 0.0, 0.0, 83.0, 18.0, 29.0, 2.0, 12.0, 10.0, 12.0, 5.0, 0.0, 16.0, 0.0, 0.0, 23.0, 1.0, 22.0, 27.0, 6.0, 64.0, 1.0, 0.0, 30.0, 0.0, 11.0, 2.0, 26.0, 22.0, 0.0, 1.0, 59.0, 80.0, 3.0, 14.0, 23.0, 1.0, 40.0, 0.0, 0.0, 2.0, 0.0, 15.0, 60.0, 36.0, 4.0, 12.0, 19.0, 19.0, 0.0, 2.0, 40.0, 10.0, 4.0, 8.0, 26.0, 0.0, 20.0, 20.0, 5.0, 7.0, 17.0, 31.0, 3.0, 5.0, 18.0, 3.0, 21.0, 0.0, 22.0, 12.0, 11.0, 14.0, 27.0, 17.0, 0.0, 0.0, 16.0, 0.0, 4.0, 0.0, 14.0, 0.0, 16.0, 30.0, 1.0, 0.0, 0.0, 1.0, 15.0, 0.0, 3.0, 0.0, 3.0, 10.0, 29.0, 0.0, 1.0, 11.0, 15.0, 0.0, 7.0, 2.0, 67.0, 52.0, 7.0, 0.0, 5.0, 26.0, 26.0, 36.0, 4.0, 5.0, 44.0, 0.0, 21.0, 28.0, 0.0, 0.0, 11.0, 14.0, 11.0, 7.0, 22.0, 8.0, 18.0, 11.0, 51.0, 17.0, 0.0, 2.0, 22.0, 11.0, 0.0, 0.0, 0.0, 41.0, 19.0, 26.0, 5.0, 0.0, 5.0, 0.0, 32.0, 2.0, 11.0, 8.0, 6.0, 17.0, 15.0, 0.0, 20.0, 1.0, 0.0, 18.0, 0.0, 5.0, 21.0, 15.0, 14.0, 28.0, 16.0, 3.0, 17.0, 4.0, 28.0, 0.0, 0.0, 0.0, 64.0, 47.0, 17.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5110625951588643, "mean_inference_ms": 43.65495490382055, "mean_action_processing_ms": 0.7188547875770801, "mean_env_wait_ms": 0.5341233633512978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007726907730102539, "StateBufferConnector_ms": 0.015094518661499023, "ViewRequirementAgentConnector_ms": 0.20491516590118408}, "num_episodes": 22, "episode_return_max": 376.0, "episode_return_min": -26.0, "episode_return_mean": 258.6, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 166.03960315689903, "num_env_steps_trained_throughput_per_sec": 166.03960315689903, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 21445.461, "restore_workers_time_ms": 0.017, "training_step_time_ms": 21445.409, "sample_time_ms": 3168.116, "learn_time_ms": 18256.162, "learn_throughput": 219.104, "synch_weights_time_ms": 18.204}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "4f45b_00000", "date": "2024-08-13_02-45-30", "timestamp": 1723531530, "time_this_iter_s": 24.14405393600464, "time_total_s": 5263.8452224731445, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24709d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5263.8452224731445, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 87.53235294117647, "ram_util_percent": 83.45588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0044631729602183, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.98155082546214, "policy_loss": -0.004510215464634476, "vf_loss": 4.985681098100369, "vf_explained_var": 0.003459118030689381, "kl": 0.01601031215889959, "entropy": 0.8170863110867758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.678012370400959, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.12614789841667, "policy_loss": -0.010336403069012458, "vf_loss": 9.13643168393897, "vf_explained_var": 0.05935396738153286, "kl": 0.01496541645406653, "entropy": 1.1758993749896054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": 24.0, "episode_reward_mean": 247.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -122.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 103.0}, "policy_reward_mean": {"prey_policy": 106.36, "predator_policy": 17.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [123.0, 272.0, 200.0, 301.0, 209.0, 315.0, 202.0, 338.0, 120.0, 311.0, 351.0, 298.0, 93.0, 290.0, 129.0, 358.0, 138.0, 310.0, 297.0, 255.0, 223.0, 221.0, 325.0, 180.0, 318.0, 304.0, 213.0, 218.0, 234.0, 350.0, 192.0, 310.0, 276.0, 238.0, 322.0, 266.0, 180.0, 289.0, 287.0, 281.0, 327.0, 350.0, 215.0, 329.0, 229.0, 194.0, 327.0, 227.0, 300.0, 233.0, 279.0, 376.0, 306.0, 329.0, 225.0, 270.0, 253.0, 333.0, 311.0, 274.0, 233.0, 339.0, 241.0, 97.0, 314.0, 286.0, 281.0, 328.0, 213.0, 269.0, 220.0, 200.0, 320.0, 270.0, 259.0, 79.0, 155.0, 254.0, 82.0, 118.0, 266.0, 242.0, 225.0, 269.0, 114.0, 261.0, 198.0, 339.0, 311.0, 244.0, 195.0, 231.0, 200.0, 233.0, 259.0, 292.0, 121.0, 156.0, 24.0, 192.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-96.0, 149.0, 77.0, 194.0, 86.0, 84.0, 131.0, 157.0, 33.0, 128.0, 197.0, 117.0, -59.0, 122.0, 159.0, 162.0, -46.0, 142.0, 80.0, 191.0, 149.0, 200.0, 121.0, 162.0, -72.0, 69.0, 150.0, 124.0, 13.0, 78.0, 165.0, 191.0, 84.0, 4.0, 160.0, 138.0, 136.0, 135.0, 101.0, 114.0, 121.0, 90.0, 55.0, 118.0, 150.0, 167.0, 47.0, 112.0, 158.0, 139.0, 140.0, 130.0, 75.0, 113.0, 122.0, 52.0, 148.0, 86.0, 200.0, 134.0, 111.0, 77.0, 148.0, 148.0, 120.0, 110.0, 159.0, 78.0, 174.0, 147.0, 176.0, 75.0, 170.0, 7.0, 185.0, 91.0, 109.0, 149.0, 116.0, 153.0, 140.0, 172.0, 161.0, 180.0, 97.0, -1.0, 155.0, 167.0, 135.0, 63.0, 116.0, 16.0, 179.0, 139.0, 115.0, 68.0, 102.0, 149.0, 119.0, 114.0, 69.0, 185.0, 159.0, 199.0, 153.0, 123.0, 139.0, 161.0, 146.0, 11.0, 76.0, 192.0, 120.0, 100.0, 180.0, 153.0, 80.0, 190.0, 71.0, 158.0, 65.0, 163.0, 140.0, 194.0, 42.0, 165.0, 8.0, 70.0, 171.0, 120.0, 116.0, 155.0, 138.0, 122.0, 173.0, 137.0, 24.0, 184.0, 159.0, 74.0, 91.0, 87.0, 51.0, 130.0, 159.0, 140.0, 142.0, 100.0, 196.0, 63.0, -1.0, -31.0, 38.0, 87.0, 134.0, 105.0, 11.0, -122.0, -81.0, 74.0, 133.0, 128.0, 83.0, 157.0, 167.0, -15.0, 17.0, 171.0, 41.0, 20.0, 131.0, 130.0, 81.0, 41.0, 125.0, 192.0, 145.0, 122.0, 107.0, 27.0, 59.0, 132.0, 48.0, 142.0, 24.0, 93.0, 97.0, 100.0, 80.0, 160.0, 172.0, 119.0, 69.0, -97.0, 45.0, 102.0, -83.0, -37.0, 183.0, -73.0], "policy_predator_policy_reward": [6.0, 64.0, 1.0, 0.0, 30.0, 0.0, 11.0, 2.0, 26.0, 22.0, 0.0, 1.0, 59.0, 80.0, 3.0, 14.0, 23.0, 1.0, 40.0, 0.0, 0.0, 2.0, 0.0, 15.0, 60.0, 36.0, 4.0, 12.0, 19.0, 19.0, 0.0, 2.0, 40.0, 10.0, 4.0, 8.0, 26.0, 0.0, 20.0, 20.0, 5.0, 7.0, 17.0, 31.0, 3.0, 5.0, 18.0, 3.0, 21.0, 0.0, 22.0, 12.0, 11.0, 14.0, 27.0, 17.0, 0.0, 0.0, 16.0, 0.0, 4.0, 0.0, 14.0, 0.0, 16.0, 30.0, 1.0, 0.0, 0.0, 1.0, 15.0, 0.0, 3.0, 0.0, 3.0, 10.0, 29.0, 0.0, 1.0, 11.0, 15.0, 0.0, 7.0, 2.0, 67.0, 52.0, 7.0, 0.0, 5.0, 26.0, 26.0, 36.0, 4.0, 5.0, 44.0, 0.0, 21.0, 28.0, 0.0, 0.0, 11.0, 14.0, 11.0, 7.0, 22.0, 8.0, 18.0, 11.0, 51.0, 17.0, 0.0, 2.0, 22.0, 11.0, 0.0, 0.0, 0.0, 41.0, 19.0, 26.0, 5.0, 0.0, 5.0, 0.0, 32.0, 2.0, 11.0, 8.0, 6.0, 17.0, 15.0, 0.0, 20.0, 1.0, 0.0, 18.0, 0.0, 5.0, 21.0, 15.0, 14.0, 28.0, 16.0, 3.0, 17.0, 4.0, 28.0, 0.0, 0.0, 0.0, 64.0, 47.0, 17.0, 13.0, 6.0, 9.0, 103.0, 90.0, 51.0, 74.0, 5.0, 0.0, 0.0, 2.0, 26.0, 47.0, 45.0, 36.0, 15.0, 38.0, 0.0, 0.0, 45.0, 31.0, 2.0, 20.0, 20.0, 24.0, 43.0, 67.0, 4.0, 0.0, 22.0, 19.0, 28.0, 55.0, 18.0, 18.0, 0.0, 19.0, 1.0, 0.0, 53.0, 96.0, 7.0, 2.0, 75.0, 69.0, 54.0, 28.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5106014619982568, "mean_inference_ms": 42.7795328834691, "mean_action_processing_ms": 0.7158580150912125, "mean_env_wait_ms": 0.5333036794332989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008577227592468262, "StateBufferConnector_ms": 0.015051484107971191, "ViewRequirementAgentConnector_ms": 0.21269762516021729}, "num_episodes": 23, "episode_return_max": 376.0, "episode_return_min": 24.0, "episode_return_mean": 247.54, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.1302555104097, "num_env_steps_trained_throughput_per_sec": 170.1302555104097, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 21884.694, "restore_workers_time_ms": 0.017, "training_step_time_ms": 21884.643, "sample_time_ms": 3102.031, "learn_time_ms": 18761.776, "learn_throughput": 213.199, "synch_weights_time_ms": 18.121}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "4f45b_00000", "date": "2024-08-13_02-45-54", "timestamp": 1723531554, "time_this_iter_s": 23.55273199081421, "time_total_s": 5287.397954463959, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20bfd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5287.397954463959, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 87.03333333333333, "ram_util_percent": 83.13030303030304}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0572788571948728, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.615908781813566, "policy_loss": -0.002768527781073418, "vf_loss": 2.6185066038338594, "vf_explained_var": 0.0003170936826675657, "kl": 0.00719340410524209, "entropy": 0.8309419670432964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.273238646542585, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.013360390839754, "policy_loss": -0.008453957494545392, "vf_loss": 9.021749360725362, "vf_explained_var": 0.25913087933782547, "kl": 0.01847657105238857, "entropy": 1.2674289359617485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": 24.0, "episode_reward_mean": 248.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -122.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 103.0}, "policy_reward_mean": {"prey_policy": 105.43, "predator_policy": 18.735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [297.0, 255.0, 223.0, 221.0, 325.0, 180.0, 318.0, 304.0, 213.0, 218.0, 234.0, 350.0, 192.0, 310.0, 276.0, 238.0, 322.0, 266.0, 180.0, 289.0, 287.0, 281.0, 327.0, 350.0, 215.0, 329.0, 229.0, 194.0, 327.0, 227.0, 300.0, 233.0, 279.0, 376.0, 306.0, 329.0, 225.0, 270.0, 253.0, 333.0, 311.0, 274.0, 233.0, 339.0, 241.0, 97.0, 314.0, 286.0, 281.0, 328.0, 213.0, 269.0, 220.0, 200.0, 320.0, 270.0, 259.0, 79.0, 155.0, 254.0, 82.0, 118.0, 266.0, 242.0, 225.0, 269.0, 114.0, 261.0, 198.0, 339.0, 311.0, 244.0, 195.0, 231.0, 200.0, 233.0, 259.0, 292.0, 121.0, 156.0, 24.0, 192.0, 247.0, 208.0, 91.0, 316.0, 219.0, 231.0, 342.0, 311.0, 205.0, 243.0, 211.0, 204.0, 316.0, 185.0, 358.0, 310.0, 270.0, 170.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [136.0, 135.0, 101.0, 114.0, 121.0, 90.0, 55.0, 118.0, 150.0, 167.0, 47.0, 112.0, 158.0, 139.0, 140.0, 130.0, 75.0, 113.0, 122.0, 52.0, 148.0, 86.0, 200.0, 134.0, 111.0, 77.0, 148.0, 148.0, 120.0, 110.0, 159.0, 78.0, 174.0, 147.0, 176.0, 75.0, 170.0, 7.0, 185.0, 91.0, 109.0, 149.0, 116.0, 153.0, 140.0, 172.0, 161.0, 180.0, 97.0, -1.0, 155.0, 167.0, 135.0, 63.0, 116.0, 16.0, 179.0, 139.0, 115.0, 68.0, 102.0, 149.0, 119.0, 114.0, 69.0, 185.0, 159.0, 199.0, 153.0, 123.0, 139.0, 161.0, 146.0, 11.0, 76.0, 192.0, 120.0, 100.0, 180.0, 153.0, 80.0, 190.0, 71.0, 158.0, 65.0, 163.0, 140.0, 194.0, 42.0, 165.0, 8.0, 70.0, 171.0, 120.0, 116.0, 155.0, 138.0, 122.0, 173.0, 137.0, 24.0, 184.0, 159.0, 74.0, 91.0, 87.0, 51.0, 130.0, 159.0, 140.0, 142.0, 100.0, 196.0, 63.0, -1.0, -31.0, 38.0, 87.0, 134.0, 105.0, 11.0, -122.0, -81.0, 74.0, 133.0, 128.0, 83.0, 157.0, 167.0, -15.0, 17.0, 171.0, 41.0, 20.0, 131.0, 130.0, 81.0, 41.0, 125.0, 192.0, 145.0, 122.0, 107.0, 27.0, 59.0, 132.0, 48.0, 142.0, 24.0, 93.0, 97.0, 100.0, 80.0, 160.0, 172.0, 119.0, 69.0, -97.0, 45.0, 102.0, -83.0, -37.0, 183.0, -73.0, 88.0, 53.0, 89.0, 37.0, -80.0, 23.0, 119.0, 163.0, 144.0, 53.0, 117.0, 60.0, 164.0, 158.0, 138.0, 152.0, 63.0, 54.0, 95.0, 124.0, 114.0, 21.0, 7.0, 131.0, 175.0, 115.0, 110.0, 40.0, 172.0, 186.0, 164.0, 138.0, 129.0, 86.0, 125.0, 31.0], "policy_predator_policy_reward": [26.0, 0.0, 20.0, 20.0, 5.0, 7.0, 17.0, 31.0, 3.0, 5.0, 18.0, 3.0, 21.0, 0.0, 22.0, 12.0, 11.0, 14.0, 27.0, 17.0, 0.0, 0.0, 16.0, 0.0, 4.0, 0.0, 14.0, 0.0, 16.0, 30.0, 1.0, 0.0, 0.0, 1.0, 15.0, 0.0, 3.0, 0.0, 3.0, 10.0, 29.0, 0.0, 1.0, 11.0, 15.0, 0.0, 7.0, 2.0, 67.0, 52.0, 7.0, 0.0, 5.0, 26.0, 26.0, 36.0, 4.0, 5.0, 44.0, 0.0, 21.0, 28.0, 0.0, 0.0, 11.0, 14.0, 11.0, 7.0, 22.0, 8.0, 18.0, 11.0, 51.0, 17.0, 0.0, 2.0, 22.0, 11.0, 0.0, 0.0, 0.0, 41.0, 19.0, 26.0, 5.0, 0.0, 5.0, 0.0, 32.0, 2.0, 11.0, 8.0, 6.0, 17.0, 15.0, 0.0, 20.0, 1.0, 0.0, 18.0, 0.0, 5.0, 21.0, 15.0, 14.0, 28.0, 16.0, 3.0, 17.0, 4.0, 28.0, 0.0, 0.0, 0.0, 64.0, 47.0, 17.0, 13.0, 6.0, 9.0, 103.0, 90.0, 51.0, 74.0, 5.0, 0.0, 0.0, 2.0, 26.0, 47.0, 45.0, 36.0, 15.0, 38.0, 0.0, 0.0, 45.0, 31.0, 2.0, 20.0, 20.0, 24.0, 43.0, 67.0, 4.0, 0.0, 22.0, 19.0, 28.0, 55.0, 18.0, 18.0, 0.0, 19.0, 1.0, 0.0, 53.0, 96.0, 7.0, 2.0, 75.0, 69.0, 54.0, 28.0, 50.0, 56.0, 39.0, 43.0, 71.0, 77.0, 12.0, 22.0, 22.0, 0.0, 20.0, 34.0, 1.0, 19.0, 6.0, 15.0, 45.0, 43.0, 12.0, 12.0, 34.0, 42.0, 12.0, 54.0, 8.0, 18.0, 22.0, 13.0, 0.0, 0.0, 6.0, 2.0, 42.0, 13.0, 14.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5101432291729668, "mean_inference_ms": 42.11883371805121, "mean_action_processing_ms": 0.7135795138448299, "mean_env_wait_ms": 0.5330084578949424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008675098419189453, "StateBufferConnector_ms": 0.008348822593688965, "ViewRequirementAgentConnector_ms": 0.21278834342956543}, "num_episodes": 18, "episode_return_max": 376.0, "episode_return_min": 24.0, "episode_return_mean": 248.33, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 170.72056910221144, "num_env_steps_trained_throughput_per_sec": 170.72056910221144, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 22236.872, "restore_workers_time_ms": 0.017, "training_step_time_ms": 22236.818, "sample_time_ms": 3048.048, "learn_time_ms": 19167.342, "learn_throughput": 208.688, "synch_weights_time_ms": 18.738}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "4f45b_00000", "date": "2024-08-13_02-46-17", "timestamp": 1723531577, "time_this_iter_s": 23.51712393760681, "time_total_s": 5310.915078401566, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20bfca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5310.915078401566, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 86.70606060606062, "ram_util_percent": 82.85151515151513}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0772594380552176, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5755697560058068, "policy_loss": -0.005063199939171749, "vf_loss": 1.5804043754068002, "vf_explained_var": 0.0012286752935439821, "kl": 0.009632402811338646, "entropy": 0.8513616556213015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.569282456822497, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.781679133006504, "policy_loss": 0.004387218156021344, "vf_loss": 8.777240614159398, "vf_explained_var": 0.32152727239977114, "kl": 0.01458973751636489, "entropy": 1.3070624037394447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": 24.0, "episode_reward_mean": 247.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -122.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.0, "predator_policy": 103.0}, "policy_reward_mean": {"prey_policy": 104.08, "predator_policy": 19.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.0, 289.0, 287.0, 281.0, 327.0, 350.0, 215.0, 329.0, 229.0, 194.0, 327.0, 227.0, 300.0, 233.0, 279.0, 376.0, 306.0, 329.0, 225.0, 270.0, 253.0, 333.0, 311.0, 274.0, 233.0, 339.0, 241.0, 97.0, 314.0, 286.0, 281.0, 328.0, 213.0, 269.0, 220.0, 200.0, 320.0, 270.0, 259.0, 79.0, 155.0, 254.0, 82.0, 118.0, 266.0, 242.0, 225.0, 269.0, 114.0, 261.0, 198.0, 339.0, 311.0, 244.0, 195.0, 231.0, 200.0, 233.0, 259.0, 292.0, 121.0, 156.0, 24.0, 192.0, 247.0, 208.0, 91.0, 316.0, 219.0, 231.0, 342.0, 311.0, 205.0, 243.0, 211.0, 204.0, 316.0, 185.0, 358.0, 310.0, 270.0, 170.0, 204.0, 322.0, 225.0, 207.0, 289.0, 319.0, 179.0, 339.0, 264.0, 300.0, 132.0, 286.0, 222.0, 320.0, 311.0, 262.0, 245.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [170.0, 7.0, 185.0, 91.0, 109.0, 149.0, 116.0, 153.0, 140.0, 172.0, 161.0, 180.0, 97.0, -1.0, 155.0, 167.0, 135.0, 63.0, 116.0, 16.0, 179.0, 139.0, 115.0, 68.0, 102.0, 149.0, 119.0, 114.0, 69.0, 185.0, 159.0, 199.0, 153.0, 123.0, 139.0, 161.0, 146.0, 11.0, 76.0, 192.0, 120.0, 100.0, 180.0, 153.0, 80.0, 190.0, 71.0, 158.0, 65.0, 163.0, 140.0, 194.0, 42.0, 165.0, 8.0, 70.0, 171.0, 120.0, 116.0, 155.0, 138.0, 122.0, 173.0, 137.0, 24.0, 184.0, 159.0, 74.0, 91.0, 87.0, 51.0, 130.0, 159.0, 140.0, 142.0, 100.0, 196.0, 63.0, -1.0, -31.0, 38.0, 87.0, 134.0, 105.0, 11.0, -122.0, -81.0, 74.0, 133.0, 128.0, 83.0, 157.0, 167.0, -15.0, 17.0, 171.0, 41.0, 20.0, 131.0, 130.0, 81.0, 41.0, 125.0, 192.0, 145.0, 122.0, 107.0, 27.0, 59.0, 132.0, 48.0, 142.0, 24.0, 93.0, 97.0, 100.0, 80.0, 160.0, 172.0, 119.0, 69.0, -97.0, 45.0, 102.0, -83.0, -37.0, 183.0, -73.0, 88.0, 53.0, 89.0, 37.0, -80.0, 23.0, 119.0, 163.0, 144.0, 53.0, 117.0, 60.0, 164.0, 158.0, 138.0, 152.0, 63.0, 54.0, 95.0, 124.0, 114.0, 21.0, 7.0, 131.0, 175.0, 115.0, 110.0, 40.0, 172.0, 186.0, 164.0, 138.0, 129.0, 86.0, 125.0, 31.0, 49.0, 129.0, 149.0, 152.0, 54.0, 97.0, 74.0, 93.0, 117.0, 146.0, 127.0, 187.0, 164.0, -70.0, 175.0, 139.0, 144.0, 96.0, 131.0, 150.0, 93.0, 0.0, 165.0, 101.0, 130.0, 85.0, 178.0, 136.0, 148.0, 156.0, 167.0, 87.0, 134.0, 111.0, 150.0, -48.0], "policy_predator_policy_reward": [3.0, 0.0, 3.0, 10.0, 29.0, 0.0, 1.0, 11.0, 15.0, 0.0, 7.0, 2.0, 67.0, 52.0, 7.0, 0.0, 5.0, 26.0, 26.0, 36.0, 4.0, 5.0, 44.0, 0.0, 21.0, 28.0, 0.0, 0.0, 11.0, 14.0, 11.0, 7.0, 22.0, 8.0, 18.0, 11.0, 51.0, 17.0, 0.0, 2.0, 22.0, 11.0, 0.0, 0.0, 0.0, 41.0, 19.0, 26.0, 5.0, 0.0, 5.0, 0.0, 32.0, 2.0, 11.0, 8.0, 6.0, 17.0, 15.0, 0.0, 20.0, 1.0, 0.0, 18.0, 0.0, 5.0, 21.0, 15.0, 14.0, 28.0, 16.0, 3.0, 17.0, 4.0, 28.0, 0.0, 0.0, 0.0, 64.0, 47.0, 17.0, 13.0, 6.0, 9.0, 103.0, 90.0, 51.0, 74.0, 5.0, 0.0, 0.0, 2.0, 26.0, 47.0, 45.0, 36.0, 15.0, 38.0, 0.0, 0.0, 45.0, 31.0, 2.0, 20.0, 20.0, 24.0, 43.0, 67.0, 4.0, 0.0, 22.0, 19.0, 28.0, 55.0, 18.0, 18.0, 0.0, 19.0, 1.0, 0.0, 53.0, 96.0, 7.0, 2.0, 75.0, 69.0, 54.0, 28.0, 50.0, 56.0, 39.0, 43.0, 71.0, 77.0, 12.0, 22.0, 22.0, 0.0, 20.0, 34.0, 1.0, 19.0, 6.0, 15.0, 45.0, 43.0, 12.0, 12.0, 34.0, 42.0, 12.0, 54.0, 8.0, 18.0, 22.0, 13.0, 0.0, 0.0, 6.0, 2.0, 42.0, 13.0, 14.0, 0.0, 12.0, 14.0, 8.0, 13.0, 34.0, 40.0, 0.0, 40.0, 0.0, 26.0, 0.0, 5.0, 79.0, 6.0, 13.0, 12.0, 3.0, 21.0, 0.0, 19.0, 18.0, 21.0, 17.0, 3.0, 7.0, 0.0, 0.0, 6.0, 5.0, 2.0, 1.0, 7.0, 0.0, 0.0, 62.0, 36.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5098615228367087, "mean_inference_ms": 41.482599787930276, "mean_action_processing_ms": 0.7115080579770455, "mean_env_wait_ms": 0.5327810557264514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008837699890136719, "StateBufferConnector_ms": 0.00835418701171875, "ViewRequirementAgentConnector_ms": 0.21892130374908447}, "num_episodes": 18, "episode_return_max": 376.0, "episode_return_min": 24.0, "episode_return_mean": 247.17, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 173.56415734527826, "num_env_steps_trained_throughput_per_sec": 173.56415734527826, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 22584.019, "restore_workers_time_ms": 0.018, "training_step_time_ms": 22583.964, "sample_time_ms": 3055.571, "learn_time_ms": 19505.368, "learn_throughput": 205.072, "synch_weights_time_ms": 20.451}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "4f45b_00000", "date": "2024-08-13_02-46-41", "timestamp": 1723531601, "time_this_iter_s": 23.124208688735962, "time_total_s": 5334.0392870903015, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb7160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5334.0392870903015, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 87.24848484848485, "ram_util_percent": 83.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2538998414915075, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.945600885562796, "policy_loss": -0.0042632820449335865, "vf_loss": 4.949683994590921, "vf_explained_var": 0.0012285496192003685, "kl": 0.007591900472638488, "entropy": 0.8845659295402507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.334052330476267, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.801426649598218, "policy_loss": -0.004958228417549026, "vf_loss": 8.80632682704421, "vf_explained_var": 0.08923086539778129, "kl": 0.01651316507961456, "entropy": 1.3680989177138716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -6.0, "episode_reward_mean": 228.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -288.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": 89.57, "predator_policy": 24.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.0, 274.0, 233.0, 339.0, 241.0, 97.0, 314.0, 286.0, 281.0, 328.0, 213.0, 269.0, 220.0, 200.0, 320.0, 270.0, 259.0, 79.0, 155.0, 254.0, 82.0, 118.0, 266.0, 242.0, 225.0, 269.0, 114.0, 261.0, 198.0, 339.0, 311.0, 244.0, 195.0, 231.0, 200.0, 233.0, 259.0, 292.0, 121.0, 156.0, 24.0, 192.0, 247.0, 208.0, 91.0, 316.0, 219.0, 231.0, 342.0, 311.0, 205.0, 243.0, 211.0, 204.0, 316.0, 185.0, 358.0, 310.0, 270.0, 170.0, 204.0, 322.0, 225.0, 207.0, 289.0, 319.0, 179.0, 339.0, 264.0, 300.0, 132.0, 286.0, 222.0, 320.0, 311.0, 262.0, 245.0, 200.0, 315.0, 193.0, 93.0, 264.0, 233.0, -6.0, 294.0, 107.0, 159.0, 272.0, 293.0, 89.0, 96.0, 187.0, 269.0, 114.0, 315.0, 166.0, 248.0, 164.0, 243.0, 121.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [80.0, 190.0, 71.0, 158.0, 65.0, 163.0, 140.0, 194.0, 42.0, 165.0, 8.0, 70.0, 171.0, 120.0, 116.0, 155.0, 138.0, 122.0, 173.0, 137.0, 24.0, 184.0, 159.0, 74.0, 91.0, 87.0, 51.0, 130.0, 159.0, 140.0, 142.0, 100.0, 196.0, 63.0, -1.0, -31.0, 38.0, 87.0, 134.0, 105.0, 11.0, -122.0, -81.0, 74.0, 133.0, 128.0, 83.0, 157.0, 167.0, -15.0, 17.0, 171.0, 41.0, 20.0, 131.0, 130.0, 81.0, 41.0, 125.0, 192.0, 145.0, 122.0, 107.0, 27.0, 59.0, 132.0, 48.0, 142.0, 24.0, 93.0, 97.0, 100.0, 80.0, 160.0, 172.0, 119.0, 69.0, -97.0, 45.0, 102.0, -83.0, -37.0, 183.0, -73.0, 88.0, 53.0, 89.0, 37.0, -80.0, 23.0, 119.0, 163.0, 144.0, 53.0, 117.0, 60.0, 164.0, 158.0, 138.0, 152.0, 63.0, 54.0, 95.0, 124.0, 114.0, 21.0, 7.0, 131.0, 175.0, 115.0, 110.0, 40.0, 172.0, 186.0, 164.0, 138.0, 129.0, 86.0, 125.0, 31.0, 49.0, 129.0, 149.0, 152.0, 54.0, 97.0, 74.0, 93.0, 117.0, 146.0, 127.0, 187.0, 164.0, -70.0, 175.0, 139.0, 144.0, 96.0, 131.0, 150.0, 93.0, 0.0, 165.0, 101.0, 130.0, 85.0, 178.0, 136.0, 148.0, 156.0, 167.0, 87.0, 134.0, 111.0, 150.0, -48.0, 149.0, 163.0, 75.0, 70.0, -53.0, 10.0, 126.0, 108.0, 75.0, 121.0, 52.0, -288.0, 136.0, 151.0, 0.0, 33.0, -67.0, 62.0, 102.0, 124.0, 168.0, 114.0, 26.0, -107.0, 0.0, 96.0, 111.0, -94.0, 108.0, 75.0, -58.0, 18.0, 149.0, 140.0, 0.0, 164.0, 76.0, 125.0, -6.0, 67.0, 64.0, 124.0, 121.0, 0.0], "policy_predator_policy_reward": [0.0, 41.0, 19.0, 26.0, 5.0, 0.0, 5.0, 0.0, 32.0, 2.0, 11.0, 8.0, 6.0, 17.0, 15.0, 0.0, 20.0, 1.0, 0.0, 18.0, 0.0, 5.0, 21.0, 15.0, 14.0, 28.0, 16.0, 3.0, 17.0, 4.0, 28.0, 0.0, 0.0, 0.0, 64.0, 47.0, 17.0, 13.0, 6.0, 9.0, 103.0, 90.0, 51.0, 74.0, 5.0, 0.0, 0.0, 2.0, 26.0, 47.0, 45.0, 36.0, 15.0, 38.0, 0.0, 0.0, 45.0, 31.0, 2.0, 20.0, 20.0, 24.0, 43.0, 67.0, 4.0, 0.0, 22.0, 19.0, 28.0, 55.0, 18.0, 18.0, 0.0, 19.0, 1.0, 0.0, 53.0, 96.0, 7.0, 2.0, 75.0, 69.0, 54.0, 28.0, 50.0, 56.0, 39.0, 43.0, 71.0, 77.0, 12.0, 22.0, 22.0, 0.0, 20.0, 34.0, 1.0, 19.0, 6.0, 15.0, 45.0, 43.0, 12.0, 12.0, 34.0, 42.0, 12.0, 54.0, 8.0, 18.0, 22.0, 13.0, 0.0, 0.0, 6.0, 2.0, 42.0, 13.0, 14.0, 0.0, 12.0, 14.0, 8.0, 13.0, 34.0, 40.0, 0.0, 40.0, 0.0, 26.0, 0.0, 5.0, 79.0, 6.0, 13.0, 12.0, 3.0, 21.0, 0.0, 19.0, 18.0, 21.0, 17.0, 3.0, 7.0, 0.0, 0.0, 6.0, 5.0, 2.0, 1.0, 7.0, 0.0, 0.0, 62.0, 36.0, 3.0, 0.0, 48.0, 0.0, 69.0, 67.0, 1.0, 29.0, 10.0, 27.0, 73.0, 157.0, 1.0, 6.0, 37.0, 37.0, 73.0, 91.0, 19.0, 27.0, 1.0, 10.0, 111.0, 59.0, 0.0, 0.0, 73.0, 97.0, 42.0, 44.0, 98.0, 56.0, 18.0, 8.0, 0.0, 2.0, 31.0, 16.0, 68.0, 35.0, 41.0, 14.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5067777351911602, "mean_inference_ms": 40.746762366052955, "mean_action_processing_ms": 0.7071619399676178, "mean_env_wait_ms": 0.5311819545047244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010190963745117188, "StateBufferConnector_ms": 0.006585955619812012, "ViewRequirementAgentConnector_ms": 0.22312283515930176}, "num_episodes": 22, "episode_return_max": 358.0, "episode_return_min": -6.0, "episode_return_mean": 228.07, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 178.04070010852735, "num_env_steps_trained_throughput_per_sec": 178.04070010852735, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 22817.303, "restore_workers_time_ms": 0.018, "training_step_time_ms": 22817.248, "sample_time_ms": 3103.1, "learn_time_ms": 19693.187, "learn_throughput": 203.116, "synch_weights_time_ms": 18.67}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "4f45b_00000", "date": "2024-08-13_02-47-03", "timestamp": 1723531623, "time_this_iter_s": 22.532185077667236, "time_total_s": 5356.571472167969, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2488790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5356.571472167969, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 86.284375, "ram_util_percent": 83.225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.261898335294118, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.150185246694656, "policy_loss": -0.005569229367627669, "vf_loss": 3.155507113315441, "vf_explained_var": 0.009573385166743446, "kl": 0.010423947402841676, "entropy": 0.9028683274195939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.546512545511206, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.498585621263615, "policy_loss": -0.0026732928418953506, "vf_loss": 8.50120789815509, "vf_explained_var": 0.34973542936264523, "kl": 0.014515961121577969, "entropy": 1.3745593467086712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -6.0, "episode_reward_mean": 211.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -288.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 192.0, "predator_policy": 157.0}, "policy_reward_mean": {"prey_policy": 78.64, "predator_policy": 27.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [155.0, 254.0, 82.0, 118.0, 266.0, 242.0, 225.0, 269.0, 114.0, 261.0, 198.0, 339.0, 311.0, 244.0, 195.0, 231.0, 200.0, 233.0, 259.0, 292.0, 121.0, 156.0, 24.0, 192.0, 247.0, 208.0, 91.0, 316.0, 219.0, 231.0, 342.0, 311.0, 205.0, 243.0, 211.0, 204.0, 316.0, 185.0, 358.0, 310.0, 270.0, 170.0, 204.0, 322.0, 225.0, 207.0, 289.0, 319.0, 179.0, 339.0, 264.0, 300.0, 132.0, 286.0, 222.0, 320.0, 311.0, 262.0, 245.0, 200.0, 315.0, 193.0, 93.0, 264.0, 233.0, -6.0, 294.0, 107.0, 159.0, 272.0, 293.0, 89.0, 96.0, 187.0, 269.0, 114.0, 315.0, 166.0, 248.0, 164.0, 243.0, 121.0, 224.0, 210.0, 177.0, 132.0, 103.0, 219.0, 116.0, 152.0, 224.0, 207.0, 209.0, 134.0, 186.0, 170.0, 44.0, 143.0, 194.0, 67.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [38.0, 87.0, 134.0, 105.0, 11.0, -122.0, -81.0, 74.0, 133.0, 128.0, 83.0, 157.0, 167.0, -15.0, 17.0, 171.0, 41.0, 20.0, 131.0, 130.0, 81.0, 41.0, 125.0, 192.0, 145.0, 122.0, 107.0, 27.0, 59.0, 132.0, 48.0, 142.0, 24.0, 93.0, 97.0, 100.0, 80.0, 160.0, 172.0, 119.0, 69.0, -97.0, 45.0, 102.0, -83.0, -37.0, 183.0, -73.0, 88.0, 53.0, 89.0, 37.0, -80.0, 23.0, 119.0, 163.0, 144.0, 53.0, 117.0, 60.0, 164.0, 158.0, 138.0, 152.0, 63.0, 54.0, 95.0, 124.0, 114.0, 21.0, 7.0, 131.0, 175.0, 115.0, 110.0, 40.0, 172.0, 186.0, 164.0, 138.0, 129.0, 86.0, 125.0, 31.0, 49.0, 129.0, 149.0, 152.0, 54.0, 97.0, 74.0, 93.0, 117.0, 146.0, 127.0, 187.0, 164.0, -70.0, 175.0, 139.0, 144.0, 96.0, 131.0, 150.0, 93.0, 0.0, 165.0, 101.0, 130.0, 85.0, 178.0, 136.0, 148.0, 156.0, 167.0, 87.0, 134.0, 111.0, 150.0, -48.0, 149.0, 163.0, 75.0, 70.0, -53.0, 10.0, 126.0, 108.0, 75.0, 121.0, 52.0, -288.0, 136.0, 151.0, 0.0, 33.0, -67.0, 62.0, 102.0, 124.0, 168.0, 114.0, 26.0, -107.0, 0.0, 96.0, 111.0, -94.0, 108.0, 75.0, -58.0, 18.0, 149.0, 140.0, 0.0, 164.0, 76.0, 125.0, -6.0, 67.0, 64.0, 124.0, 121.0, 0.0, 67.0, 123.0, 41.0, 122.0, 61.0, 25.0, 0.0, 112.0, 41.0, 29.0, 113.0, 59.0, 0.0, 110.0, 0.0, 138.0, 95.0, 83.0, 160.0, 43.0, 162.0, -73.0, 62.0, -49.0, 165.0, -12.0, 79.0, 40.0, 76.0, -208.0, 100.0, -71.0, 8.0, 113.0, 46.0, 0.0], "policy_predator_policy_reward": [17.0, 13.0, 6.0, 9.0, 103.0, 90.0, 51.0, 74.0, 5.0, 0.0, 0.0, 2.0, 26.0, 47.0, 45.0, 36.0, 15.0, 38.0, 0.0, 0.0, 45.0, 31.0, 2.0, 20.0, 20.0, 24.0, 43.0, 67.0, 4.0, 0.0, 22.0, 19.0, 28.0, 55.0, 18.0, 18.0, 0.0, 19.0, 1.0, 0.0, 53.0, 96.0, 7.0, 2.0, 75.0, 69.0, 54.0, 28.0, 50.0, 56.0, 39.0, 43.0, 71.0, 77.0, 12.0, 22.0, 22.0, 0.0, 20.0, 34.0, 1.0, 19.0, 6.0, 15.0, 45.0, 43.0, 12.0, 12.0, 34.0, 42.0, 12.0, 54.0, 8.0, 18.0, 22.0, 13.0, 0.0, 0.0, 6.0, 2.0, 42.0, 13.0, 14.0, 0.0, 12.0, 14.0, 8.0, 13.0, 34.0, 40.0, 0.0, 40.0, 0.0, 26.0, 0.0, 5.0, 79.0, 6.0, 13.0, 12.0, 3.0, 21.0, 0.0, 19.0, 18.0, 21.0, 17.0, 3.0, 7.0, 0.0, 0.0, 6.0, 5.0, 2.0, 1.0, 7.0, 0.0, 0.0, 62.0, 36.0, 3.0, 0.0, 48.0, 0.0, 69.0, 67.0, 1.0, 29.0, 10.0, 27.0, 73.0, 157.0, 1.0, 6.0, 37.0, 37.0, 73.0, 91.0, 19.0, 27.0, 1.0, 10.0, 111.0, 59.0, 0.0, 0.0, 73.0, 97.0, 42.0, 44.0, 98.0, 56.0, 18.0, 8.0, 0.0, 2.0, 31.0, 16.0, 68.0, 35.0, 41.0, 14.0, 0.0, 0.0, 11.0, 23.0, 21.0, 26.0, 40.0, 51.0, 12.0, 8.0, 2.0, 31.0, 27.0, 20.0, 6.0, 0.0, 14.0, 0.0, 32.0, 14.0, 0.0, 4.0, 61.0, 59.0, 68.0, 53.0, 4.0, 29.0, 40.0, 11.0, 108.0, 68.0, 58.0, 56.0, 38.0, 35.0, 0.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5071690936149222, "mean_inference_ms": 40.16506858077563, "mean_action_processing_ms": 0.7073216818158534, "mean_env_wait_ms": 0.531376760757431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010066390037536621, "StateBufferConnector_ms": 0.005995035171508789, "ViewRequirementAgentConnector_ms": 0.22283172607421875}, "num_episodes": 18, "episode_return_max": 358.0, "episode_return_min": -6.0, "episode_return_mean": 211.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 153.39341836877577, "num_env_steps_trained_throughput_per_sec": 153.39341836877577, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 23524.334, "restore_workers_time_ms": 0.017, "training_step_time_ms": 23524.102, "sample_time_ms": 3144.891, "learn_time_ms": 20356.031, "learn_throughput": 196.502, "synch_weights_time_ms": 20.043}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "4f45b_00000", "date": "2024-08-13_02-47-29", "timestamp": 1723531649, "time_this_iter_s": 26.152245044708252, "time_total_s": 5382.723717212677, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1ce05e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5382.723717212677, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 87.7527777777778, "ram_util_percent": 83.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2996302586541604, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.811481930969884, "policy_loss": -0.002469880853794397, "vf_loss": 7.81379829714538, "vf_explained_var": 0.0009002519347680309, "kl": 0.006468775053855535, "entropy": 0.919320639510634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.011268957392879, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.054808127186286, "policy_loss": -0.008102155123743668, "vf_loss": 9.06285399129151, "vf_explained_var": -0.06886187113782086, "kl": 0.016009986448004623, "entropy": 1.4068884394786976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 358.0, "episode_reward_min": -246.0, "episode_reward_mean": 185.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -310.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 58.445, "predator_policy": 34.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.0, 247.0, 208.0, 91.0, 316.0, 219.0, 231.0, 342.0, 311.0, 205.0, 243.0, 211.0, 204.0, 316.0, 185.0, 358.0, 310.0, 270.0, 170.0, 204.0, 322.0, 225.0, 207.0, 289.0, 319.0, 179.0, 339.0, 264.0, 300.0, 132.0, 286.0, 222.0, 320.0, 311.0, 262.0, 245.0, 200.0, 315.0, 193.0, 93.0, 264.0, 233.0, -6.0, 294.0, 107.0, 159.0, 272.0, 293.0, 89.0, 96.0, 187.0, 269.0, 114.0, 315.0, 166.0, 248.0, 164.0, 243.0, 121.0, 224.0, 210.0, 177.0, 132.0, 103.0, 219.0, 116.0, 152.0, 224.0, 207.0, 209.0, 134.0, 186.0, 170.0, 44.0, 143.0, 194.0, 67.0, 146.0, 149.0, 184.0, 168.0, 96.0, 109.0, 163.0, -246.0, 12.0, 41.0, -35.0, 205.0, -94.0, 234.0, 236.0, 172.0, 38.0, 231.0, 175.0, 170.0, 61.0, 26.0, -102.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [183.0, -73.0, 88.0, 53.0, 89.0, 37.0, -80.0, 23.0, 119.0, 163.0, 144.0, 53.0, 117.0, 60.0, 164.0, 158.0, 138.0, 152.0, 63.0, 54.0, 95.0, 124.0, 114.0, 21.0, 7.0, 131.0, 175.0, 115.0, 110.0, 40.0, 172.0, 186.0, 164.0, 138.0, 129.0, 86.0, 125.0, 31.0, 49.0, 129.0, 149.0, 152.0, 54.0, 97.0, 74.0, 93.0, 117.0, 146.0, 127.0, 187.0, 164.0, -70.0, 175.0, 139.0, 144.0, 96.0, 131.0, 150.0, 93.0, 0.0, 165.0, 101.0, 130.0, 85.0, 178.0, 136.0, 148.0, 156.0, 167.0, 87.0, 134.0, 111.0, 150.0, -48.0, 149.0, 163.0, 75.0, 70.0, -53.0, 10.0, 126.0, 108.0, 75.0, 121.0, 52.0, -288.0, 136.0, 151.0, 0.0, 33.0, -67.0, 62.0, 102.0, 124.0, 168.0, 114.0, 26.0, -107.0, 0.0, 96.0, 111.0, -94.0, 108.0, 75.0, -58.0, 18.0, 149.0, 140.0, 0.0, 164.0, 76.0, 125.0, -6.0, 67.0, 64.0, 124.0, 121.0, 0.0, 67.0, 123.0, 41.0, 122.0, 61.0, 25.0, 0.0, 112.0, 41.0, 29.0, 113.0, 59.0, 0.0, 110.0, 0.0, 138.0, 95.0, 83.0, 160.0, 43.0, 162.0, -73.0, 62.0, -49.0, 165.0, -12.0, 79.0, 40.0, 76.0, -208.0, 100.0, -71.0, 8.0, 113.0, 46.0, 0.0, -70.0, 91.0, 41.0, 28.0, -84.0, 160.0, 38.0, 101.0, 4.0, 22.0, 49.0, 36.0, 95.0, -17.0, -250.0, -304.0, -39.0, -20.0, -63.0, -112.0, -310.0, 0.0, 85.0, 92.0, -148.0, -191.0, 117.0, -14.0, 131.0, 57.0, -57.0, 166.0, -16.0, -52.0, 78.0, 89.0, 25.0, 63.0, -14.0, 115.0, 0.0, 61.0, -93.0, -112.0, -232.0, -111.0], "policy_predator_policy_reward": [54.0, 28.0, 50.0, 56.0, 39.0, 43.0, 71.0, 77.0, 12.0, 22.0, 22.0, 0.0, 20.0, 34.0, 1.0, 19.0, 6.0, 15.0, 45.0, 43.0, 12.0, 12.0, 34.0, 42.0, 12.0, 54.0, 8.0, 18.0, 22.0, 13.0, 0.0, 0.0, 6.0, 2.0, 42.0, 13.0, 14.0, 0.0, 12.0, 14.0, 8.0, 13.0, 34.0, 40.0, 0.0, 40.0, 0.0, 26.0, 0.0, 5.0, 79.0, 6.0, 13.0, 12.0, 3.0, 21.0, 0.0, 19.0, 18.0, 21.0, 17.0, 3.0, 7.0, 0.0, 0.0, 6.0, 5.0, 2.0, 1.0, 7.0, 0.0, 0.0, 62.0, 36.0, 3.0, 0.0, 48.0, 0.0, 69.0, 67.0, 1.0, 29.0, 10.0, 27.0, 73.0, 157.0, 1.0, 6.0, 37.0, 37.0, 73.0, 91.0, 19.0, 27.0, 1.0, 10.0, 111.0, 59.0, 0.0, 0.0, 73.0, 97.0, 42.0, 44.0, 98.0, 56.0, 18.0, 8.0, 0.0, 2.0, 31.0, 16.0, 68.0, 35.0, 41.0, 14.0, 0.0, 0.0, 11.0, 23.0, 21.0, 26.0, 40.0, 51.0, 12.0, 8.0, 2.0, 31.0, 27.0, 20.0, 6.0, 0.0, 14.0, 0.0, 32.0, 14.0, 0.0, 4.0, 61.0, 59.0, 68.0, 53.0, 4.0, 29.0, 40.0, 11.0, 108.0, 68.0, 58.0, 56.0, 38.0, 35.0, 0.0, 21.0, 60.0, 65.0, 40.0, 40.0, 23.0, 85.0, 15.0, 14.0, 16.0, 54.0, 19.0, 5.0, 33.0, 52.0, 120.0, 188.0, 42.0, 29.0, 140.0, 76.0, 114.0, 161.0, 1.0, 27.0, 133.0, 112.0, 61.0, 70.0, 21.0, 27.0, 26.0, 37.0, 34.0, 72.0, 24.0, 40.0, 40.0, 47.0, 4.0, 65.0, 0.0, 0.0, 141.0, 90.0, 111.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.508325570649771, "mean_inference_ms": 39.43960485116963, "mean_action_processing_ms": 0.7060712214002131, "mean_env_wait_ms": 0.5314268617367065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01224219799041748, "StateBufferConnector_ms": 0.00651097297668457, "ViewRequirementAgentConnector_ms": 0.26566100120544434}, "num_episodes": 23, "episode_return_max": 358.0, "episode_return_min": -246.0, "episode_return_mean": 185.34, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 164.54684439367077, "num_env_steps_trained_throughput_per_sec": 164.54684439367077, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 23721.988, "restore_workers_time_ms": 0.017, "training_step_time_ms": 23721.757, "sample_time_ms": 3192.384, "learn_time_ms": 20504.936, "learn_throughput": 195.075, "synch_weights_time_ms": 20.428}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "4f45b_00000", "date": "2024-08-13_02-47-54", "timestamp": 1723531674, "time_this_iter_s": 24.37188696861267, "time_total_s": 5407.09560418129, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cc4e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5407.09560418129, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 86.86571428571426, "ram_util_percent": 83.59142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2623612659475791, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.738299379651509, "policy_loss": -0.007104777897062598, "vf_loss": 6.74519913814686, "vf_explained_var": 0.0026020713584132926, "kl": 0.008639628134691973, "entropy": 0.9116577296345322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.107887956484285, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.33005654673097, "policy_loss": -0.006934334520896078, "vf_loss": 9.336946675134083, "vf_explained_var": -0.09159984348942994, "kl": 0.01256886351496071, "entropy": 1.3770548285630646, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 339.0, "episode_reward_min": -246.0, "episode_reward_mean": 147.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -310.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 187.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 32.515, "predator_policy": 41.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.0, 204.0, 322.0, 225.0, 207.0, 289.0, 319.0, 179.0, 339.0, 264.0, 300.0, 132.0, 286.0, 222.0, 320.0, 311.0, 262.0, 245.0, 200.0, 315.0, 193.0, 93.0, 264.0, 233.0, -6.0, 294.0, 107.0, 159.0, 272.0, 293.0, 89.0, 96.0, 187.0, 269.0, 114.0, 315.0, 166.0, 248.0, 164.0, 243.0, 121.0, 224.0, 210.0, 177.0, 132.0, 103.0, 219.0, 116.0, 152.0, 224.0, 207.0, 209.0, 134.0, 186.0, 170.0, 44.0, 143.0, 194.0, 67.0, 146.0, 149.0, 184.0, 168.0, 96.0, 109.0, 163.0, -246.0, 12.0, 41.0, -35.0, 205.0, -94.0, 234.0, 236.0, 172.0, 38.0, 231.0, 175.0, 170.0, 61.0, 26.0, -102.0, 76.0, -140.0, 30.0, 93.0, 140.0, -149.0, -128.0, 150.0, 27.0, 84.0, 31.0, 39.0, 133.0, -9.0, 75.0, 19.0, 110.0, 105.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [125.0, 31.0, 49.0, 129.0, 149.0, 152.0, 54.0, 97.0, 74.0, 93.0, 117.0, 146.0, 127.0, 187.0, 164.0, -70.0, 175.0, 139.0, 144.0, 96.0, 131.0, 150.0, 93.0, 0.0, 165.0, 101.0, 130.0, 85.0, 178.0, 136.0, 148.0, 156.0, 167.0, 87.0, 134.0, 111.0, 150.0, -48.0, 149.0, 163.0, 75.0, 70.0, -53.0, 10.0, 126.0, 108.0, 75.0, 121.0, 52.0, -288.0, 136.0, 151.0, 0.0, 33.0, -67.0, 62.0, 102.0, 124.0, 168.0, 114.0, 26.0, -107.0, 0.0, 96.0, 111.0, -94.0, 108.0, 75.0, -58.0, 18.0, 149.0, 140.0, 0.0, 164.0, 76.0, 125.0, -6.0, 67.0, 64.0, 124.0, 121.0, 0.0, 67.0, 123.0, 41.0, 122.0, 61.0, 25.0, 0.0, 112.0, 41.0, 29.0, 113.0, 59.0, 0.0, 110.0, 0.0, 138.0, 95.0, 83.0, 160.0, 43.0, 162.0, -73.0, 62.0, -49.0, 165.0, -12.0, 79.0, 40.0, 76.0, -208.0, 100.0, -71.0, 8.0, 113.0, 46.0, 0.0, -70.0, 91.0, 41.0, 28.0, -84.0, 160.0, 38.0, 101.0, 4.0, 22.0, 49.0, 36.0, 95.0, -17.0, -250.0, -304.0, -39.0, -20.0, -63.0, -112.0, -310.0, 0.0, 85.0, 92.0, -148.0, -191.0, 117.0, -14.0, 131.0, 57.0, -57.0, 166.0, -16.0, -52.0, 78.0, 89.0, 25.0, 63.0, -14.0, 115.0, 0.0, 61.0, -93.0, -112.0, -232.0, -111.0, -62.0, 21.0, -88.0, -278.0, -211.0, 21.0, -62.0, 59.0, 84.0, -16.0, -125.0, -254.0, -162.0, -192.0, -25.0, 90.0, -76.0, -29.0, -67.0, 16.0, 26.0, -132.0, -22.0, -9.0, 128.0, 0.0, -186.0, 29.0, 94.0, -156.0, 41.0, -132.0, -14.0, 34.0, -92.0, 73.0], "policy_predator_policy_reward": [14.0, 0.0, 12.0, 14.0, 8.0, 13.0, 34.0, 40.0, 0.0, 40.0, 0.0, 26.0, 0.0, 5.0, 79.0, 6.0, 13.0, 12.0, 3.0, 21.0, 0.0, 19.0, 18.0, 21.0, 17.0, 3.0, 7.0, 0.0, 0.0, 6.0, 5.0, 2.0, 1.0, 7.0, 0.0, 0.0, 62.0, 36.0, 3.0, 0.0, 48.0, 0.0, 69.0, 67.0, 1.0, 29.0, 10.0, 27.0, 73.0, 157.0, 1.0, 6.0, 37.0, 37.0, 73.0, 91.0, 19.0, 27.0, 1.0, 10.0, 111.0, 59.0, 0.0, 0.0, 73.0, 97.0, 42.0, 44.0, 98.0, 56.0, 18.0, 8.0, 0.0, 2.0, 31.0, 16.0, 68.0, 35.0, 41.0, 14.0, 0.0, 0.0, 11.0, 23.0, 21.0, 26.0, 40.0, 51.0, 12.0, 8.0, 2.0, 31.0, 27.0, 20.0, 6.0, 0.0, 14.0, 0.0, 32.0, 14.0, 0.0, 4.0, 61.0, 59.0, 68.0, 53.0, 4.0, 29.0, 40.0, 11.0, 108.0, 68.0, 58.0, 56.0, 38.0, 35.0, 0.0, 21.0, 60.0, 65.0, 40.0, 40.0, 23.0, 85.0, 15.0, 14.0, 16.0, 54.0, 19.0, 5.0, 33.0, 52.0, 120.0, 188.0, 42.0, 29.0, 140.0, 76.0, 114.0, 161.0, 1.0, 27.0, 133.0, 112.0, 61.0, 70.0, 21.0, 27.0, 26.0, 37.0, 34.0, 72.0, 24.0, 40.0, 40.0, 47.0, 4.0, 65.0, 0.0, 0.0, 141.0, 90.0, 111.0, 130.0, 55.0, 62.0, 154.0, 72.0, 124.0, 96.0, 72.0, 24.0, 13.0, 59.0, 63.0, 167.0, 83.0, 143.0, 54.0, 31.0, 21.0, 111.0, 79.0, 56.0, 57.0, 80.0, 45.0, 25.0, 0.0, 5.0, 34.0, 114.0, 28.0, 109.0, 23.0, 87.0, 14.0, 76.0, 45.0, 79.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.509586266269372, "mean_inference_ms": 38.890687531592405, "mean_action_processing_ms": 0.7052173264900232, "mean_env_wait_ms": 0.5316293177064161, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016317367553710938, "StateBufferConnector_ms": 0.00641179084777832, "ViewRequirementAgentConnector_ms": 0.27722060680389404}, "num_episodes": 18, "episode_return_max": 339.0, "episode_return_min": -246.0, "episode_return_mean": 147.61, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.3561838037265, "num_env_steps_trained_throughput_per_sec": 156.3561838037265, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 23973.034, "restore_workers_time_ms": 0.019, "training_step_time_ms": 23972.801, "sample_time_ms": 3219.643, "learn_time_ms": 20728.554, "learn_throughput": 192.971, "synch_weights_time_ms": 20.507}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "4f45b_00000", "date": "2024-08-13_02-48-20", "timestamp": 1723531700, "time_this_iter_s": 25.633615016937256, "time_total_s": 5432.729219198227, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2470940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5432.729219198227, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 87.25833333333333, "ram_util_percent": 83.52499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3982584675153096, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.338960358957765, "policy_loss": -0.005344087418622126, "vf_loss": 7.344108357505193, "vf_explained_var": -0.0012942777739630806, "kl": 0.008262944811907128, "entropy": 0.8879746891518749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.199078147026597, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.473736743321494, "policy_loss": -0.0069920914677567975, "vf_loss": 9.480668898486586, "vf_explained_var": -0.10930165695765662, "kl": 0.017044812300582923, "entropy": 1.3785114285176394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 315.0, "episode_reward_min": -246.0, "episode_reward_mean": 107.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -310.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 168.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": 4.845, "predator_policy": 48.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 315.0, 193.0, 93.0, 264.0, 233.0, -6.0, 294.0, 107.0, 159.0, 272.0, 293.0, 89.0, 96.0, 187.0, 269.0, 114.0, 315.0, 166.0, 248.0, 164.0, 243.0, 121.0, 224.0, 210.0, 177.0, 132.0, 103.0, 219.0, 116.0, 152.0, 224.0, 207.0, 209.0, 134.0, 186.0, 170.0, 44.0, 143.0, 194.0, 67.0, 146.0, 149.0, 184.0, 168.0, 96.0, 109.0, 163.0, -246.0, 12.0, 41.0, -35.0, 205.0, -94.0, 234.0, 236.0, 172.0, 38.0, 231.0, 175.0, 170.0, 61.0, 26.0, -102.0, 76.0, -140.0, 30.0, 93.0, 140.0, -149.0, -128.0, 150.0, 27.0, 84.0, 31.0, 39.0, 133.0, -9.0, 75.0, 19.0, 110.0, 105.0, 194.0, -29.0, 93.0, -25.0, 76.0, 43.0, 53.0, 84.0, -23.0, -32.0, -56.0, 39.0, 40.0, 90.0, 91.0, 84.0, -158.0, -27.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [150.0, -48.0, 149.0, 163.0, 75.0, 70.0, -53.0, 10.0, 126.0, 108.0, 75.0, 121.0, 52.0, -288.0, 136.0, 151.0, 0.0, 33.0, -67.0, 62.0, 102.0, 124.0, 168.0, 114.0, 26.0, -107.0, 0.0, 96.0, 111.0, -94.0, 108.0, 75.0, -58.0, 18.0, 149.0, 140.0, 0.0, 164.0, 76.0, 125.0, -6.0, 67.0, 64.0, 124.0, 121.0, 0.0, 67.0, 123.0, 41.0, 122.0, 61.0, 25.0, 0.0, 112.0, 41.0, 29.0, 113.0, 59.0, 0.0, 110.0, 0.0, 138.0, 95.0, 83.0, 160.0, 43.0, 162.0, -73.0, 62.0, -49.0, 165.0, -12.0, 79.0, 40.0, 76.0, -208.0, 100.0, -71.0, 8.0, 113.0, 46.0, 0.0, -70.0, 91.0, 41.0, 28.0, -84.0, 160.0, 38.0, 101.0, 4.0, 22.0, 49.0, 36.0, 95.0, -17.0, -250.0, -304.0, -39.0, -20.0, -63.0, -112.0, -310.0, 0.0, 85.0, 92.0, -148.0, -191.0, 117.0, -14.0, 131.0, 57.0, -57.0, 166.0, -16.0, -52.0, 78.0, 89.0, 25.0, 63.0, -14.0, 115.0, 0.0, 61.0, -93.0, -112.0, -232.0, -111.0, -62.0, 21.0, -88.0, -278.0, -211.0, 21.0, -62.0, 59.0, 84.0, -16.0, -125.0, -254.0, -162.0, -192.0, -25.0, 90.0, -76.0, -29.0, -67.0, 16.0, 26.0, -132.0, -22.0, -9.0, 128.0, 0.0, -186.0, 29.0, 94.0, -156.0, 41.0, -132.0, -14.0, 34.0, -92.0, 73.0, 43.0, 115.0, 34.0, -208.0, 62.0, -61.0, 16.0, -187.0, -177.0, 84.0, -6.0, 5.0, -43.0, -21.0, 40.0, 26.0, 32.0, -185.0, -185.0, -20.0, -34.0, -207.0, -112.0, 54.0, 11.0, -15.0, -2.0, 82.0, -23.0, 56.0, 29.0, -35.0, -132.0, -201.0, -129.0, -90.0], "policy_predator_policy_reward": [62.0, 36.0, 3.0, 0.0, 48.0, 0.0, 69.0, 67.0, 1.0, 29.0, 10.0, 27.0, 73.0, 157.0, 1.0, 6.0, 37.0, 37.0, 73.0, 91.0, 19.0, 27.0, 1.0, 10.0, 111.0, 59.0, 0.0, 0.0, 73.0, 97.0, 42.0, 44.0, 98.0, 56.0, 18.0, 8.0, 0.0, 2.0, 31.0, 16.0, 68.0, 35.0, 41.0, 14.0, 0.0, 0.0, 11.0, 23.0, 21.0, 26.0, 40.0, 51.0, 12.0, 8.0, 2.0, 31.0, 27.0, 20.0, 6.0, 0.0, 14.0, 0.0, 32.0, 14.0, 0.0, 4.0, 61.0, 59.0, 68.0, 53.0, 4.0, 29.0, 40.0, 11.0, 108.0, 68.0, 58.0, 56.0, 38.0, 35.0, 0.0, 21.0, 60.0, 65.0, 40.0, 40.0, 23.0, 85.0, 15.0, 14.0, 16.0, 54.0, 19.0, 5.0, 33.0, 52.0, 120.0, 188.0, 42.0, 29.0, 140.0, 76.0, 114.0, 161.0, 1.0, 27.0, 133.0, 112.0, 61.0, 70.0, 21.0, 27.0, 26.0, 37.0, 34.0, 72.0, 24.0, 40.0, 40.0, 47.0, 4.0, 65.0, 0.0, 0.0, 141.0, 90.0, 111.0, 130.0, 55.0, 62.0, 154.0, 72.0, 124.0, 96.0, 72.0, 24.0, 13.0, 59.0, 63.0, 167.0, 83.0, 143.0, 54.0, 31.0, 21.0, 111.0, 79.0, 56.0, 57.0, 80.0, 45.0, 25.0, 0.0, 5.0, 34.0, 114.0, 28.0, 109.0, 23.0, 87.0, 14.0, 76.0, 45.0, 79.0, 21.0, 15.0, 85.0, 60.0, 30.0, 62.0, 38.0, 108.0, 104.0, 65.0, 20.0, 24.0, 92.0, 25.0, 16.0, 2.0, 23.0, 107.0, 93.0, 80.0, 59.0, 126.0, 37.0, 60.0, 17.0, 27.0, 7.0, 3.0, 7.0, 51.0, 40.0, 50.0, 59.0, 116.0, 101.0, 91.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.514918674423895, "mean_inference_ms": 38.36826232591882, "mean_action_processing_ms": 0.7060574761642049, "mean_env_wait_ms": 0.5327948879869195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016434431076049805, "StateBufferConnector_ms": 0.006545901298522949, "ViewRequirementAgentConnector_ms": 0.34263598918914795}, "num_episodes": 18, "episode_return_max": 315.0, "episode_return_min": -246.0, "episode_return_mean": 107.02, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.6972719679393, "num_env_steps_trained_throughput_per_sec": 137.6972719679393, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 24609.826, "restore_workers_time_ms": 0.019, "training_step_time_ms": 24609.592, "sample_time_ms": 3497.372, "learn_time_ms": 21086.301, "learn_throughput": 189.697, "synch_weights_time_ms": 21.227}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "4f45b_00000", "date": "2024-08-13_02-48-49", "timestamp": 1723531729, "time_this_iter_s": 29.101113080978394, "time_total_s": 5461.830332279205, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cd5ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5461.830332279205, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 90.19512195121952, "ram_util_percent": 83.61463414634147}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6195332281961643, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.0398005122230165, "policy_loss": -0.007350161932926211, "vf_loss": 7.046910350284879, "vf_explained_var": -0.0026134814850237004, "kl": 0.010126985415685729, "entropy": 0.8884496182676346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.466401864801134, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.392144024561322, "policy_loss": -0.0057729423201332486, "vf_loss": 9.39785685766311, "vf_explained_var": -0.1205080646055716, "kl": 0.017101273200082895, "entropy": 1.4135532220835407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 236.0, "episode_reward_min": -246.0, "episode_reward_mean": 71.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -310.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 166.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": -14.82, "predator_policy": 50.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.0, 224.0, 210.0, 177.0, 132.0, 103.0, 219.0, 116.0, 152.0, 224.0, 207.0, 209.0, 134.0, 186.0, 170.0, 44.0, 143.0, 194.0, 67.0, 146.0, 149.0, 184.0, 168.0, 96.0, 109.0, 163.0, -246.0, 12.0, 41.0, -35.0, 205.0, -94.0, 234.0, 236.0, 172.0, 38.0, 231.0, 175.0, 170.0, 61.0, 26.0, -102.0, 76.0, -140.0, 30.0, 93.0, 140.0, -149.0, -128.0, 150.0, 27.0, 84.0, 31.0, 39.0, 133.0, -9.0, 75.0, 19.0, 110.0, 105.0, 194.0, -29.0, 93.0, -25.0, 76.0, 43.0, 53.0, 84.0, -23.0, -32.0, -56.0, 39.0, 40.0, 90.0, 91.0, 84.0, -158.0, -27.0, -31.0, -89.0, 4.0, -14.0, 71.0, -41.0, 67.0, 57.0, 174.0, 29.0, 105.0, 24.0, 53.0, 125.0, 75.0, 33.0, 22.0, 53.0, -121.0, 77.0, 20.0, 34.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [121.0, 0.0, 67.0, 123.0, 41.0, 122.0, 61.0, 25.0, 0.0, 112.0, 41.0, 29.0, 113.0, 59.0, 0.0, 110.0, 0.0, 138.0, 95.0, 83.0, 160.0, 43.0, 162.0, -73.0, 62.0, -49.0, 165.0, -12.0, 79.0, 40.0, 76.0, -208.0, 100.0, -71.0, 8.0, 113.0, 46.0, 0.0, -70.0, 91.0, 41.0, 28.0, -84.0, 160.0, 38.0, 101.0, 4.0, 22.0, 49.0, 36.0, 95.0, -17.0, -250.0, -304.0, -39.0, -20.0, -63.0, -112.0, -310.0, 0.0, 85.0, 92.0, -148.0, -191.0, 117.0, -14.0, 131.0, 57.0, -57.0, 166.0, -16.0, -52.0, 78.0, 89.0, 25.0, 63.0, -14.0, 115.0, 0.0, 61.0, -93.0, -112.0, -232.0, -111.0, -62.0, 21.0, -88.0, -278.0, -211.0, 21.0, -62.0, 59.0, 84.0, -16.0, -125.0, -254.0, -162.0, -192.0, -25.0, 90.0, -76.0, -29.0, -67.0, 16.0, 26.0, -132.0, -22.0, -9.0, 128.0, 0.0, -186.0, 29.0, 94.0, -156.0, 41.0, -132.0, -14.0, 34.0, -92.0, 73.0, 43.0, 115.0, 34.0, -208.0, 62.0, -61.0, 16.0, -187.0, -177.0, 84.0, -6.0, 5.0, -43.0, -21.0, 40.0, 26.0, 32.0, -185.0, -185.0, -20.0, -34.0, -207.0, -112.0, 54.0, 11.0, -15.0, -2.0, 82.0, -23.0, 56.0, 29.0, -35.0, -132.0, -201.0, -129.0, -90.0, -77.0, -74.0, -115.0, -118.0, -71.0, -32.0, -55.0, -58.0, 14.0, 35.0, -173.0, -30.0, -78.0, 48.0, 36.0, -48.0, -16.0, 122.0, -47.0, 26.0, -20.0, 56.0, -4.0, 0.0, -200.0, 88.0, 66.0, 17.0, 18.0, -28.0, -58.0, 31.0, 62.0, -180.0, -22.0, 14.0, -191.0, -105.0, 34.0, -29.0, 45.0, -138.0, -106.0, 39.0], "policy_predator_policy_reward": [0.0, 0.0, 11.0, 23.0, 21.0, 26.0, 40.0, 51.0, 12.0, 8.0, 2.0, 31.0, 27.0, 20.0, 6.0, 0.0, 14.0, 0.0, 32.0, 14.0, 0.0, 4.0, 61.0, 59.0, 68.0, 53.0, 4.0, 29.0, 40.0, 11.0, 108.0, 68.0, 58.0, 56.0, 38.0, 35.0, 0.0, 21.0, 60.0, 65.0, 40.0, 40.0, 23.0, 85.0, 15.0, 14.0, 16.0, 54.0, 19.0, 5.0, 33.0, 52.0, 120.0, 188.0, 42.0, 29.0, 140.0, 76.0, 114.0, 161.0, 1.0, 27.0, 133.0, 112.0, 61.0, 70.0, 21.0, 27.0, 26.0, 37.0, 34.0, 72.0, 24.0, 40.0, 40.0, 47.0, 4.0, 65.0, 0.0, 0.0, 141.0, 90.0, 111.0, 130.0, 55.0, 62.0, 154.0, 72.0, 124.0, 96.0, 72.0, 24.0, 13.0, 59.0, 63.0, 167.0, 83.0, 143.0, 54.0, 31.0, 21.0, 111.0, 79.0, 56.0, 57.0, 80.0, 45.0, 25.0, 0.0, 5.0, 34.0, 114.0, 28.0, 109.0, 23.0, 87.0, 14.0, 76.0, 45.0, 79.0, 21.0, 15.0, 85.0, 60.0, 30.0, 62.0, 38.0, 108.0, 104.0, 65.0, 20.0, 24.0, 92.0, 25.0, 16.0, 2.0, 23.0, 107.0, 93.0, 80.0, 59.0, 126.0, 37.0, 60.0, 17.0, 27.0, 7.0, 3.0, 7.0, 51.0, 40.0, 50.0, 59.0, 116.0, 101.0, 91.0, 36.0, 84.0, 97.0, 47.0, 37.0, 70.0, 34.0, 65.0, 14.0, 8.0, 42.0, 120.0, 27.0, 70.0, 24.0, 45.0, 19.0, 49.0, 36.0, 14.0, 37.0, 32.0, 14.0, 14.0, 99.0, 66.0, 5.0, 37.0, 45.0, 40.0, 18.0, 42.0, 78.0, 62.0, 28.0, 33.0, 130.0, 45.0, 38.0, 34.0, 80.0, 33.0, 23.0, 78.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5224509472180634, "mean_inference_ms": 37.754145198136364, "mean_action_processing_ms": 0.707468543634383, "mean_env_wait_ms": 0.5343725420498735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0172041654586792, "StateBufferConnector_ms": 0.006793856620788574, "ViewRequirementAgentConnector_ms": 0.35283875465393066}, "num_episodes": 22, "episode_return_max": 236.0, "episode_return_min": -246.0, "episode_return_mean": 71.21, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 110.28330639018291, "num_env_steps_trained_throughput_per_sec": 110.28330639018291, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 25783.323, "restore_workers_time_ms": 0.019, "training_step_time_ms": 25783.088, "sample_time_ms": 3493.911, "learn_time_ms": 22262.325, "learn_throughput": 179.676, "synch_weights_time_ms": 21.366}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "4f45b_00000", "date": "2024-08-13_02-49-25", "timestamp": 1723531765, "time_this_iter_s": 36.33716297149658, "time_total_s": 5498.167495250702, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2488550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5498.167495250702, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 93.84313725490196, "ram_util_percent": 83.52745098039215}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.481027573583618, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.198986903952543, "policy_loss": -0.006233684325137387, "vf_loss": 7.204931972644947, "vf_explained_var": 0.0016976511667645166, "kl": 0.012162087318789658, "entropy": 0.9180498111184943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.749997132606607, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.323833182501415, "policy_loss": -0.004346352943007357, "vf_loss": 9.32813238719153, "vf_explained_var": -0.14641666727722005, "kl": 0.01341421271852665, "entropy": 1.406121051500714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 236.0, "episode_reward_min": -246.0, "episode_reward_mean": 43.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -310.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 166.0, "predator_policy": 188.0}, "policy_reward_mean": {"prey_policy": -32.815, "predator_policy": 54.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [96.0, 109.0, 163.0, -246.0, 12.0, 41.0, -35.0, 205.0, -94.0, 234.0, 236.0, 172.0, 38.0, 231.0, 175.0, 170.0, 61.0, 26.0, -102.0, 76.0, -140.0, 30.0, 93.0, 140.0, -149.0, -128.0, 150.0, 27.0, 84.0, 31.0, 39.0, 133.0, -9.0, 75.0, 19.0, 110.0, 105.0, 194.0, -29.0, 93.0, -25.0, 76.0, 43.0, 53.0, 84.0, -23.0, -32.0, -56.0, 39.0, 40.0, 90.0, 91.0, 84.0, -158.0, -27.0, -31.0, -89.0, 4.0, -14.0, 71.0, -41.0, 67.0, 57.0, 174.0, 29.0, 105.0, 24.0, 53.0, 125.0, 75.0, 33.0, 22.0, 53.0, -121.0, 77.0, 20.0, 34.0, 119.0, 57.0, 30.0, -101.0, 34.0, 105.0, 39.0, 62.0, 111.0, -168.0, 60.0, 112.0, 84.0, 178.0, 67.0, -52.0, 18.0, 4.0, -3.0, -66.0, 120.0, 119.0, -30.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.0, 22.0, 49.0, 36.0, 95.0, -17.0, -250.0, -304.0, -39.0, -20.0, -63.0, -112.0, -310.0, 0.0, 85.0, 92.0, -148.0, -191.0, 117.0, -14.0, 131.0, 57.0, -57.0, 166.0, -16.0, -52.0, 78.0, 89.0, 25.0, 63.0, -14.0, 115.0, 0.0, 61.0, -93.0, -112.0, -232.0, -111.0, -62.0, 21.0, -88.0, -278.0, -211.0, 21.0, -62.0, 59.0, 84.0, -16.0, -125.0, -254.0, -162.0, -192.0, -25.0, 90.0, -76.0, -29.0, -67.0, 16.0, 26.0, -132.0, -22.0, -9.0, 128.0, 0.0, -186.0, 29.0, 94.0, -156.0, 41.0, -132.0, -14.0, 34.0, -92.0, 73.0, 43.0, 115.0, 34.0, -208.0, 62.0, -61.0, 16.0, -187.0, -177.0, 84.0, -6.0, 5.0, -43.0, -21.0, 40.0, 26.0, 32.0, -185.0, -185.0, -20.0, -34.0, -207.0, -112.0, 54.0, 11.0, -15.0, -2.0, 82.0, -23.0, 56.0, 29.0, -35.0, -132.0, -201.0, -129.0, -90.0, -77.0, -74.0, -115.0, -118.0, -71.0, -32.0, -55.0, -58.0, 14.0, 35.0, -173.0, -30.0, -78.0, 48.0, 36.0, -48.0, -16.0, 122.0, -47.0, 26.0, -20.0, 56.0, -4.0, 0.0, -200.0, 88.0, 66.0, 17.0, 18.0, -28.0, -58.0, 31.0, 62.0, -180.0, -22.0, 14.0, -191.0, -105.0, 34.0, -29.0, 45.0, -138.0, -106.0, 39.0, 76.0, 12.0, 59.0, -61.0, -107.0, 23.0, -205.0, -90.0, 38.0, -88.0, 83.0, -13.0, -92.0, 75.0, 76.0, -123.0, 11.0, 36.0, -102.0, -247.0, 14.0, -89.0, 17.0, 26.0, 43.0, 38.0, 103.0, 68.0, 31.0, -21.0, -22.0, -261.0, 34.0, -160.0, -125.0, -50.0, -52.0, -72.0, -105.0, -153.0, 46.0, 62.0, 37.0, 78.0, -197.0, 36.0], "policy_predator_policy_reward": [16.0, 54.0, 19.0, 5.0, 33.0, 52.0, 120.0, 188.0, 42.0, 29.0, 140.0, 76.0, 114.0, 161.0, 1.0, 27.0, 133.0, 112.0, 61.0, 70.0, 21.0, 27.0, 26.0, 37.0, 34.0, 72.0, 24.0, 40.0, 40.0, 47.0, 4.0, 65.0, 0.0, 0.0, 141.0, 90.0, 111.0, 130.0, 55.0, 62.0, 154.0, 72.0, 124.0, 96.0, 72.0, 24.0, 13.0, 59.0, 63.0, 167.0, 83.0, 143.0, 54.0, 31.0, 21.0, 111.0, 79.0, 56.0, 57.0, 80.0, 45.0, 25.0, 0.0, 5.0, 34.0, 114.0, 28.0, 109.0, 23.0, 87.0, 14.0, 76.0, 45.0, 79.0, 21.0, 15.0, 85.0, 60.0, 30.0, 62.0, 38.0, 108.0, 104.0, 65.0, 20.0, 24.0, 92.0, 25.0, 16.0, 2.0, 23.0, 107.0, 93.0, 80.0, 59.0, 126.0, 37.0, 60.0, 17.0, 27.0, 7.0, 3.0, 7.0, 51.0, 40.0, 50.0, 59.0, 116.0, 101.0, 91.0, 36.0, 84.0, 97.0, 47.0, 37.0, 70.0, 34.0, 65.0, 14.0, 8.0, 42.0, 120.0, 27.0, 70.0, 24.0, 45.0, 19.0, 49.0, 36.0, 14.0, 37.0, 32.0, 14.0, 14.0, 99.0, 66.0, 5.0, 37.0, 45.0, 40.0, 18.0, 42.0, 78.0, 62.0, 28.0, 33.0, 130.0, 45.0, 38.0, 34.0, 80.0, 33.0, 23.0, 78.0, 16.0, 15.0, 31.0, 28.0, 61.0, 53.0, 105.0, 89.0, 43.0, 41.0, 17.0, 18.0, 8.0, 48.0, 57.0, 52.0, 38.0, 26.0, 44.0, 137.0, 64.0, 71.0, 26.0, 43.0, 3.0, 0.0, 4.0, 3.0, 16.0, 41.0, 78.0, 153.0, 90.0, 54.0, 105.0, 74.0, 55.0, 66.0, 105.0, 87.0, 4.0, 8.0, 2.0, 2.0, 105.0, 26.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.530700164073798, "mean_inference_ms": 37.15523428541612, "mean_action_processing_ms": 0.7091696080556632, "mean_env_wait_ms": 0.5356895425499422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01839768886566162, "StateBufferConnector_ms": 0.007028460502624512, "ViewRequirementAgentConnector_ms": 0.36049139499664307}, "num_episodes": 23, "episode_return_max": 236.0, "episode_return_min": -246.0, "episode_return_mean": 43.41, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.77771280234157, "num_env_steps_trained_throughput_per_sec": 147.77771280234157, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 26081.027, "restore_workers_time_ms": 0.019, "training_step_time_ms": 26080.791, "sample_time_ms": 3494.603, "learn_time_ms": 22558.914, "learn_throughput": 177.313, "synch_weights_time_ms": 21.264}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "4f45b_00000", "date": "2024-08-13_02-49-52", "timestamp": 1723531792, "time_this_iter_s": 27.13064408302307, "time_total_s": 5525.298139333725, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2488940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5525.298139333725, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 89.82631578947367, "ram_util_percent": 83.58947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6010823740372582, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.037494858358272, "policy_loss": -0.0041479006360368754, "vf_loss": 5.041401850609552, "vf_explained_var": -0.0023328200219169494, "kl": 0.010151704322229558, "entropy": 0.9589243935529517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.127063986611745, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.952345866248722, "policy_loss": -0.006584066859195156, "vf_loss": 8.958863616115833, "vf_explained_var": -0.08965069692601603, "kl": 0.018867885804868714, "entropy": 1.401848051850758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 229.0, "episode_reward_min": -168.0, "episode_reward_mean": 43.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 128.0, "predator_policy": 167.0}, "policy_reward_mean": {"prey_policy": -29.88, "predator_policy": 51.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-102.0, 76.0, -140.0, 30.0, 93.0, 140.0, -149.0, -128.0, 150.0, 27.0, 84.0, 31.0, 39.0, 133.0, -9.0, 75.0, 19.0, 110.0, 105.0, 194.0, -29.0, 93.0, -25.0, 76.0, 43.0, 53.0, 84.0, -23.0, -32.0, -56.0, 39.0, 40.0, 90.0, 91.0, 84.0, -158.0, -27.0, -31.0, -89.0, 4.0, -14.0, 71.0, -41.0, 67.0, 57.0, 174.0, 29.0, 105.0, 24.0, 53.0, 125.0, 75.0, 33.0, 22.0, 53.0, -121.0, 77.0, 20.0, 34.0, 119.0, 57.0, 30.0, -101.0, 34.0, 105.0, 39.0, 62.0, 111.0, -168.0, 60.0, 112.0, 84.0, 178.0, 67.0, -52.0, 18.0, 4.0, -3.0, -66.0, 120.0, 119.0, -30.0, 113.0, 41.0, 38.0, 79.0, 143.0, 32.0, 63.0, 70.0, 82.0, 111.0, 229.0, 144.0, 22.0, 115.0, -30.0, 139.0, 107.0, 55.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-232.0, -111.0, -62.0, 21.0, -88.0, -278.0, -211.0, 21.0, -62.0, 59.0, 84.0, -16.0, -125.0, -254.0, -162.0, -192.0, -25.0, 90.0, -76.0, -29.0, -67.0, 16.0, 26.0, -132.0, -22.0, -9.0, 128.0, 0.0, -186.0, 29.0, 94.0, -156.0, 41.0, -132.0, -14.0, 34.0, -92.0, 73.0, 43.0, 115.0, 34.0, -208.0, 62.0, -61.0, 16.0, -187.0, -177.0, 84.0, -6.0, 5.0, -43.0, -21.0, 40.0, 26.0, 32.0, -185.0, -185.0, -20.0, -34.0, -207.0, -112.0, 54.0, 11.0, -15.0, -2.0, 82.0, -23.0, 56.0, 29.0, -35.0, -132.0, -201.0, -129.0, -90.0, -77.0, -74.0, -115.0, -118.0, -71.0, -32.0, -55.0, -58.0, 14.0, 35.0, -173.0, -30.0, -78.0, 48.0, 36.0, -48.0, -16.0, 122.0, -47.0, 26.0, -20.0, 56.0, -4.0, 0.0, -200.0, 88.0, 66.0, 17.0, 18.0, -28.0, -58.0, 31.0, 62.0, -180.0, -22.0, 14.0, -191.0, -105.0, 34.0, -29.0, 45.0, -138.0, -106.0, 39.0, 76.0, 12.0, 59.0, -61.0, -107.0, 23.0, -205.0, -90.0, 38.0, -88.0, 83.0, -13.0, -92.0, 75.0, 76.0, -123.0, 11.0, 36.0, -102.0, -247.0, 14.0, -89.0, 17.0, 26.0, 43.0, 38.0, 103.0, 68.0, 31.0, -21.0, -22.0, -261.0, 34.0, -160.0, -125.0, -50.0, -52.0, -72.0, -105.0, -153.0, 46.0, 62.0, 37.0, 78.0, -197.0, 36.0, 31.0, 68.0, 8.0, -9.0, -53.0, -27.0, -9.0, 21.0, 14.0, 61.0, -157.0, 17.0, -196.0, 102.0, 96.0, -150.0, 0.0, 82.0, 40.0, 42.0, 121.0, 96.0, 31.0, 58.0, -10.0, -56.0, 107.0, -73.0, 7.0, -318.0, 60.0, 42.0, 47.0, 39.0, 71.0, -143.0], "policy_predator_policy_reward": [111.0, 130.0, 55.0, 62.0, 154.0, 72.0, 124.0, 96.0, 72.0, 24.0, 13.0, 59.0, 63.0, 167.0, 83.0, 143.0, 54.0, 31.0, 21.0, 111.0, 79.0, 56.0, 57.0, 80.0, 45.0, 25.0, 0.0, 5.0, 34.0, 114.0, 28.0, 109.0, 23.0, 87.0, 14.0, 76.0, 45.0, 79.0, 21.0, 15.0, 85.0, 60.0, 30.0, 62.0, 38.0, 108.0, 104.0, 65.0, 20.0, 24.0, 92.0, 25.0, 16.0, 2.0, 23.0, 107.0, 93.0, 80.0, 59.0, 126.0, 37.0, 60.0, 17.0, 27.0, 7.0, 3.0, 7.0, 51.0, 40.0, 50.0, 59.0, 116.0, 101.0, 91.0, 36.0, 84.0, 97.0, 47.0, 37.0, 70.0, 34.0, 65.0, 14.0, 8.0, 42.0, 120.0, 27.0, 70.0, 24.0, 45.0, 19.0, 49.0, 36.0, 14.0, 37.0, 32.0, 14.0, 14.0, 99.0, 66.0, 5.0, 37.0, 45.0, 40.0, 18.0, 42.0, 78.0, 62.0, 28.0, 33.0, 130.0, 45.0, 38.0, 34.0, 80.0, 33.0, 23.0, 78.0, 16.0, 15.0, 31.0, 28.0, 61.0, 53.0, 105.0, 89.0, 43.0, 41.0, 17.0, 18.0, 8.0, 48.0, 57.0, 52.0, 38.0, 26.0, 44.0, 137.0, 64.0, 71.0, 26.0, 43.0, 3.0, 0.0, 4.0, 3.0, 16.0, 41.0, 78.0, 153.0, 90.0, 54.0, 105.0, 74.0, 55.0, 66.0, 105.0, 87.0, 4.0, 8.0, 2.0, 2.0, 105.0, 26.0, 3.0, 11.0, 24.0, 18.0, 81.0, 37.0, 30.0, 37.0, 29.0, 39.0, 102.0, 70.0, 69.0, 88.0, 46.0, 78.0, 0.0, 0.0, 11.0, 18.0, 0.0, 12.0, 18.0, 37.0, 53.0, 35.0, 47.0, 34.0, 138.0, 143.0, 26.0, 11.0, 11.0, 10.0, 59.0, 68.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.536783766004979, "mean_inference_ms": 36.691162126140604, "mean_action_processing_ms": 0.7095678099374755, "mean_env_wait_ms": 0.5372921905295853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01410675048828125, "StateBufferConnector_ms": 0.006630659103393555, "ViewRequirementAgentConnector_ms": 0.3354074954986572}, "num_episodes": 18, "episode_return_max": 229.0, "episode_return_min": -168.0, "episode_return_mean": 43.0, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.98101999372602, "num_env_steps_trained_throughput_per_sec": 162.98101999372602, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 26184.161, "restore_workers_time_ms": 0.019, "training_step_time_ms": 26183.926, "sample_time_ms": 3498.221, "learn_time_ms": 22657.599, "learn_throughput": 176.541, "synch_weights_time_ms": 22.094}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "4f45b_00000", "date": "2024-08-13_02-50-17", "timestamp": 1723531817, "time_this_iter_s": 24.586041688919067, "time_total_s": 5549.884181022644, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b243ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5549.884181022644, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 87.78285714285714, "ram_util_percent": 83.40000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.551258449768894, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8289880201299353, "policy_loss": -0.0029707580129739153, "vf_loss": 2.8316482279666517, "vf_explained_var": -0.0041640826949366815, "kl": 0.013086377918490058, "entropy": 0.9871395203802321, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.244241616713307, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.037280361992972, "policy_loss": -0.0070777379069970085, "vf_loss": 9.044307128966802, "vf_explained_var": 0.07279186330775105, "kl": 0.014496238671604284, "entropy": 1.4682175974997262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 229.0, "episode_reward_min": -168.0, "episode_reward_mean": 52.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 122.0, "predator_policy": 153.0}, "policy_reward_mean": {"prey_policy": -16.295, "predator_policy": 42.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.0, 194.0, -29.0, 93.0, -25.0, 76.0, 43.0, 53.0, 84.0, -23.0, -32.0, -56.0, 39.0, 40.0, 90.0, 91.0, 84.0, -158.0, -27.0, -31.0, -89.0, 4.0, -14.0, 71.0, -41.0, 67.0, 57.0, 174.0, 29.0, 105.0, 24.0, 53.0, 125.0, 75.0, 33.0, 22.0, 53.0, -121.0, 77.0, 20.0, 34.0, 119.0, 57.0, 30.0, -101.0, 34.0, 105.0, 39.0, 62.0, 111.0, -168.0, 60.0, 112.0, 84.0, 178.0, 67.0, -52.0, 18.0, 4.0, -3.0, -66.0, 120.0, 119.0, -30.0, 113.0, 41.0, 38.0, 79.0, 143.0, 32.0, 63.0, 70.0, 82.0, 111.0, 229.0, 144.0, 22.0, 115.0, -30.0, 139.0, 107.0, 55.0, 170.0, 42.0, 65.0, 102.0, 87.0, 93.0, 98.0, 103.0, 0.0, 119.0, 97.0, 58.0, 144.0, 61.0, 75.0, 15.0, 92.0, 41.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-92.0, 73.0, 43.0, 115.0, 34.0, -208.0, 62.0, -61.0, 16.0, -187.0, -177.0, 84.0, -6.0, 5.0, -43.0, -21.0, 40.0, 26.0, 32.0, -185.0, -185.0, -20.0, -34.0, -207.0, -112.0, 54.0, 11.0, -15.0, -2.0, 82.0, -23.0, 56.0, 29.0, -35.0, -132.0, -201.0, -129.0, -90.0, -77.0, -74.0, -115.0, -118.0, -71.0, -32.0, -55.0, -58.0, 14.0, 35.0, -173.0, -30.0, -78.0, 48.0, 36.0, -48.0, -16.0, 122.0, -47.0, 26.0, -20.0, 56.0, -4.0, 0.0, -200.0, 88.0, 66.0, 17.0, 18.0, -28.0, -58.0, 31.0, 62.0, -180.0, -22.0, 14.0, -191.0, -105.0, 34.0, -29.0, 45.0, -138.0, -106.0, 39.0, 76.0, 12.0, 59.0, -61.0, -107.0, 23.0, -205.0, -90.0, 38.0, -88.0, 83.0, -13.0, -92.0, 75.0, 76.0, -123.0, 11.0, 36.0, -102.0, -247.0, 14.0, -89.0, 17.0, 26.0, 43.0, 38.0, 103.0, 68.0, 31.0, -21.0, -22.0, -261.0, 34.0, -160.0, -125.0, -50.0, -52.0, -72.0, -105.0, -153.0, 46.0, 62.0, 37.0, 78.0, -197.0, 36.0, 31.0, 68.0, 8.0, -9.0, -53.0, -27.0, -9.0, 21.0, 14.0, 61.0, -157.0, 17.0, -196.0, 102.0, 96.0, -150.0, 0.0, 82.0, 40.0, 42.0, 121.0, 96.0, 31.0, 58.0, -10.0, -56.0, 107.0, -73.0, 7.0, -318.0, 60.0, 42.0, 47.0, 39.0, 71.0, -143.0, 37.0, 84.0, 0.0, -18.0, 5.0, 16.0, 58.0, 40.0, 42.0, 40.0, 32.0, 50.0, 29.0, -50.0, 68.0, 30.0, 0.0, 0.0, 38.0, 60.0, 19.0, 48.0, 38.0, -4.0, 32.0, 85.0, -28.0, -71.0, 44.0, 12.0, 11.0, 0.0, 68.0, -110.0, 6.0, 8.0], "policy_predator_policy_reward": [45.0, 79.0, 21.0, 15.0, 85.0, 60.0, 30.0, 62.0, 38.0, 108.0, 104.0, 65.0, 20.0, 24.0, 92.0, 25.0, 16.0, 2.0, 23.0, 107.0, 93.0, 80.0, 59.0, 126.0, 37.0, 60.0, 17.0, 27.0, 7.0, 3.0, 7.0, 51.0, 40.0, 50.0, 59.0, 116.0, 101.0, 91.0, 36.0, 84.0, 97.0, 47.0, 37.0, 70.0, 34.0, 65.0, 14.0, 8.0, 42.0, 120.0, 27.0, 70.0, 24.0, 45.0, 19.0, 49.0, 36.0, 14.0, 37.0, 32.0, 14.0, 14.0, 99.0, 66.0, 5.0, 37.0, 45.0, 40.0, 18.0, 42.0, 78.0, 62.0, 28.0, 33.0, 130.0, 45.0, 38.0, 34.0, 80.0, 33.0, 23.0, 78.0, 16.0, 15.0, 31.0, 28.0, 61.0, 53.0, 105.0, 89.0, 43.0, 41.0, 17.0, 18.0, 8.0, 48.0, 57.0, 52.0, 38.0, 26.0, 44.0, 137.0, 64.0, 71.0, 26.0, 43.0, 3.0, 0.0, 4.0, 3.0, 16.0, 41.0, 78.0, 153.0, 90.0, 54.0, 105.0, 74.0, 55.0, 66.0, 105.0, 87.0, 4.0, 8.0, 2.0, 2.0, 105.0, 26.0, 3.0, 11.0, 24.0, 18.0, 81.0, 37.0, 30.0, 37.0, 29.0, 39.0, 102.0, 70.0, 69.0, 88.0, 46.0, 78.0, 0.0, 0.0, 11.0, 18.0, 0.0, 12.0, 18.0, 37.0, 53.0, 35.0, 47.0, 34.0, 138.0, 143.0, 26.0, 11.0, 11.0, 10.0, 59.0, 68.0, 29.0, 20.0, 22.0, 38.0, 18.0, 26.0, 2.0, 2.0, 4.0, 1.0, 4.0, 7.0, 63.0, 56.0, 3.0, 2.0, 0.0, 0.0, 7.0, 14.0, 20.0, 10.0, 22.0, 2.0, 15.0, 12.0, 88.0, 72.0, 6.0, 13.0, 0.0, 4.0, 50.0, 84.0, 5.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5420553548222704, "mean_inference_ms": 36.232229076337205, "mean_action_processing_ms": 0.7102198876354945, "mean_env_wait_ms": 0.5382278253654941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010366082191467285, "StateBufferConnector_ms": 0.006853580474853516, "ViewRequirementAgentConnector_ms": 0.342850923538208}, "num_episodes": 18, "episode_return_max": 229.0, "episode_return_min": -168.0, "episode_return_mean": 52.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 161.1814799109235, "num_env_steps_trained_throughput_per_sec": 161.1814799109235, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 26322.826, "restore_workers_time_ms": 0.019, "training_step_time_ms": 26322.592, "sample_time_ms": 3533.21, "learn_time_ms": 22760.966, "learn_throughput": 175.739, "synch_weights_time_ms": 22.337}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "4f45b_00000", "date": "2024-08-13_02-50-42", "timestamp": 1723531842, "time_this_iter_s": 24.889281034469604, "time_total_s": 5574.773462057114, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb98b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5574.773462057114, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 86.74857142857144, "ram_util_percent": 83.54285714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.480070641069185, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5312976652983004, "policy_loss": -0.004445950255024606, "vf_loss": 3.5354413204092197, "vf_explained_var": 0.0008110720644552241, "kl": 0.012738878533418973, "entropy": 1.0181100124719913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.992053691640733, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.82761734402369, "policy_loss": -0.005936453130993026, "vf_loss": 8.83350768644343, "vf_explained_var": -0.039599297444025676, "kl": 0.013110591580056865, "entropy": 1.4317939791729841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 229.0, "episode_reward_min": -168.0, "episode_reward_mean": 71.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 122.0, "predator_policy": 153.0}, "policy_reward_mean": {"prey_policy": 0.495, "predator_policy": 35.145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.0, 71.0, -41.0, 67.0, 57.0, 174.0, 29.0, 105.0, 24.0, 53.0, 125.0, 75.0, 33.0, 22.0, 53.0, -121.0, 77.0, 20.0, 34.0, 119.0, 57.0, 30.0, -101.0, 34.0, 105.0, 39.0, 62.0, 111.0, -168.0, 60.0, 112.0, 84.0, 178.0, 67.0, -52.0, 18.0, 4.0, -3.0, -66.0, 120.0, 119.0, -30.0, 113.0, 41.0, 38.0, 79.0, 143.0, 32.0, 63.0, 70.0, 82.0, 111.0, 229.0, 144.0, 22.0, 115.0, -30.0, 139.0, 107.0, 55.0, 170.0, 42.0, 65.0, 102.0, 87.0, 93.0, 98.0, 103.0, 0.0, 119.0, 97.0, 58.0, 144.0, 61.0, 75.0, 15.0, 92.0, 41.0, 41.0, 156.0, 133.0, -10.0, 93.0, 48.0, 101.0, 126.0, 75.0, 148.0, 186.0, 92.0, 169.0, 114.0, 58.0, 130.0, 133.0, 102.0, 155.0, 155.0, 109.0, 57.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-55.0, -58.0, 14.0, 35.0, -173.0, -30.0, -78.0, 48.0, 36.0, -48.0, -16.0, 122.0, -47.0, 26.0, -20.0, 56.0, -4.0, 0.0, -200.0, 88.0, 66.0, 17.0, 18.0, -28.0, -58.0, 31.0, 62.0, -180.0, -22.0, 14.0, -191.0, -105.0, 34.0, -29.0, 45.0, -138.0, -106.0, 39.0, 76.0, 12.0, 59.0, -61.0, -107.0, 23.0, -205.0, -90.0, 38.0, -88.0, 83.0, -13.0, -92.0, 75.0, 76.0, -123.0, 11.0, 36.0, -102.0, -247.0, 14.0, -89.0, 17.0, 26.0, 43.0, 38.0, 103.0, 68.0, 31.0, -21.0, -22.0, -261.0, 34.0, -160.0, -125.0, -50.0, -52.0, -72.0, -105.0, -153.0, 46.0, 62.0, 37.0, 78.0, -197.0, 36.0, 31.0, 68.0, 8.0, -9.0, -53.0, -27.0, -9.0, 21.0, 14.0, 61.0, -157.0, 17.0, -196.0, 102.0, 96.0, -150.0, 0.0, 82.0, 40.0, 42.0, 121.0, 96.0, 31.0, 58.0, -10.0, -56.0, 107.0, -73.0, 7.0, -318.0, 60.0, 42.0, 47.0, 39.0, 71.0, -143.0, 37.0, 84.0, 0.0, -18.0, 5.0, 16.0, 58.0, 40.0, 42.0, 40.0, 32.0, 50.0, 29.0, -50.0, 68.0, 30.0, 0.0, 0.0, 38.0, 60.0, 19.0, 48.0, 38.0, -4.0, 32.0, 85.0, -28.0, -71.0, 44.0, 12.0, 11.0, 0.0, 68.0, -110.0, 6.0, 8.0, 14.0, -29.0, 90.0, 23.0, 59.0, 55.0, 0.0, -144.0, 88.0, -89.0, 18.0, 17.0, 69.0, 14.0, 68.0, 29.0, -16.0, -25.0, 30.0, 88.0, 97.0, 72.0, 68.0, -32.0, 33.0, 111.0, 35.0, 71.0, -10.0, -51.0, 61.0, 51.0, 38.0, 82.0, 49.0, 46.0, 89.0, 32.0, 49.0, 79.0, 58.0, 41.0, 0.0, 40.0], "policy_predator_policy_reward": [34.0, 65.0, 14.0, 8.0, 42.0, 120.0, 27.0, 70.0, 24.0, 45.0, 19.0, 49.0, 36.0, 14.0, 37.0, 32.0, 14.0, 14.0, 99.0, 66.0, 5.0, 37.0, 45.0, 40.0, 18.0, 42.0, 78.0, 62.0, 28.0, 33.0, 130.0, 45.0, 38.0, 34.0, 80.0, 33.0, 23.0, 78.0, 16.0, 15.0, 31.0, 28.0, 61.0, 53.0, 105.0, 89.0, 43.0, 41.0, 17.0, 18.0, 8.0, 48.0, 57.0, 52.0, 38.0, 26.0, 44.0, 137.0, 64.0, 71.0, 26.0, 43.0, 3.0, 0.0, 4.0, 3.0, 16.0, 41.0, 78.0, 153.0, 90.0, 54.0, 105.0, 74.0, 55.0, 66.0, 105.0, 87.0, 4.0, 8.0, 2.0, 2.0, 105.0, 26.0, 3.0, 11.0, 24.0, 18.0, 81.0, 37.0, 30.0, 37.0, 29.0, 39.0, 102.0, 70.0, 69.0, 88.0, 46.0, 78.0, 0.0, 0.0, 11.0, 18.0, 0.0, 12.0, 18.0, 37.0, 53.0, 35.0, 47.0, 34.0, 138.0, 143.0, 26.0, 11.0, 11.0, 10.0, 59.0, 68.0, 29.0, 20.0, 22.0, 38.0, 18.0, 26.0, 2.0, 2.0, 4.0, 1.0, 4.0, 7.0, 63.0, 56.0, 3.0, 2.0, 0.0, 0.0, 7.0, 14.0, 20.0, 10.0, 22.0, 2.0, 15.0, 12.0, 88.0, 72.0, 6.0, 13.0, 0.0, 4.0, 50.0, 84.0, 5.0, 22.0, 22.0, 34.0, 36.0, 7.0, 10.0, 9.0, 54.0, 80.0, 46.0, 48.0, 13.0, 0.0, 10.0, 8.0, 13.0, 16.0, 65.0, 51.0, 1.0, 29.0, 5.0, 12.0, 20.0, 36.0, 23.0, 2.0, 8.0, 0.0, 59.0, 60.0, 12.0, 6.0, 13.0, 0.0, 7.0, 0.0, 5.0, 29.0, 10.0, 17.0, 8.0, 2.0, 9.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.542153151605758, "mean_inference_ms": 35.691390984731036, "mean_action_processing_ms": 0.7073266575911048, "mean_env_wait_ms": 0.5377571738080931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009904026985168457, "StateBufferConnector_ms": 0.006526470184326172, "ViewRequirementAgentConnector_ms": 0.27839767932891846}, "num_episodes": 22, "episode_return_max": 229.0, "episode_return_min": -168.0, "episode_return_mean": 71.28, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.21543466760977, "num_env_steps_trained_throughput_per_sec": 155.21543466760977, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 26595.266, "restore_workers_time_ms": 0.019, "training_step_time_ms": 26595.031, "sample_time_ms": 3617.323, "learn_time_ms": 22950.443, "learn_throughput": 174.289, "synch_weights_time_ms": 20.894}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "4f45b_00000", "date": "2024-08-13_02-51-08", "timestamp": 1723531868, "time_this_iter_s": 25.82039999961853, "time_total_s": 5600.593862056732, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2470a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5600.593862056732, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 89.03055555555554, "ram_util_percent": 83.56666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6545281659831446, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.220941560230558, "policy_loss": -0.005998235802220368, "vf_loss": 6.226637235015788, "vf_explained_var": 0.001886659135263433, "kl": 0.01275036354896839, "entropy": 1.0207151048397891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.34269678122783, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.936662939112022, "policy_loss": -0.007983362979240833, "vf_loss": 8.944596358707972, "vf_explained_var": -0.12329443671085216, "kl": 0.014211697386793964, "entropy": 1.424749981726288, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 229.0, "episode_reward_min": -168.0, "episode_reward_mean": 77.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 121.0, "predator_policy": 153.0}, "policy_reward_mean": {"prey_policy": 3.98, "predator_policy": 34.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.0, 119.0, 57.0, 30.0, -101.0, 34.0, 105.0, 39.0, 62.0, 111.0, -168.0, 60.0, 112.0, 84.0, 178.0, 67.0, -52.0, 18.0, 4.0, -3.0, -66.0, 120.0, 119.0, -30.0, 113.0, 41.0, 38.0, 79.0, 143.0, 32.0, 63.0, 70.0, 82.0, 111.0, 229.0, 144.0, 22.0, 115.0, -30.0, 139.0, 107.0, 55.0, 170.0, 42.0, 65.0, 102.0, 87.0, 93.0, 98.0, 103.0, 0.0, 119.0, 97.0, 58.0, 144.0, 61.0, 75.0, 15.0, 92.0, 41.0, 41.0, 156.0, 133.0, -10.0, 93.0, 48.0, 101.0, 126.0, 75.0, 148.0, 186.0, 92.0, 169.0, 114.0, 58.0, 130.0, 133.0, 102.0, 155.0, 155.0, 109.0, 57.0, 99.0, 66.0, 64.0, -21.0, 121.0, 133.0, -29.0, 68.0, 11.0, 38.0, 118.0, 108.0, 124.0, 106.0, 131.0, 70.0, 123.0, 65.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-106.0, 39.0, 76.0, 12.0, 59.0, -61.0, -107.0, 23.0, -205.0, -90.0, 38.0, -88.0, 83.0, -13.0, -92.0, 75.0, 76.0, -123.0, 11.0, 36.0, -102.0, -247.0, 14.0, -89.0, 17.0, 26.0, 43.0, 38.0, 103.0, 68.0, 31.0, -21.0, -22.0, -261.0, 34.0, -160.0, -125.0, -50.0, -52.0, -72.0, -105.0, -153.0, 46.0, 62.0, 37.0, 78.0, -197.0, 36.0, 31.0, 68.0, 8.0, -9.0, -53.0, -27.0, -9.0, 21.0, 14.0, 61.0, -157.0, 17.0, -196.0, 102.0, 96.0, -150.0, 0.0, 82.0, 40.0, 42.0, 121.0, 96.0, 31.0, 58.0, -10.0, -56.0, 107.0, -73.0, 7.0, -318.0, 60.0, 42.0, 47.0, 39.0, 71.0, -143.0, 37.0, 84.0, 0.0, -18.0, 5.0, 16.0, 58.0, 40.0, 42.0, 40.0, 32.0, 50.0, 29.0, -50.0, 68.0, 30.0, 0.0, 0.0, 38.0, 60.0, 19.0, 48.0, 38.0, -4.0, 32.0, 85.0, -28.0, -71.0, 44.0, 12.0, 11.0, 0.0, 68.0, -110.0, 6.0, 8.0, 14.0, -29.0, 90.0, 23.0, 59.0, 55.0, 0.0, -144.0, 88.0, -89.0, 18.0, 17.0, 69.0, 14.0, 68.0, 29.0, -16.0, -25.0, 30.0, 88.0, 97.0, 72.0, 68.0, -32.0, 33.0, 111.0, 35.0, 71.0, -10.0, -51.0, 61.0, 51.0, 38.0, 82.0, 49.0, 46.0, 89.0, 32.0, 49.0, 79.0, 58.0, 41.0, 0.0, 40.0, -8.0, 84.0, -12.0, -10.0, 42.0, -79.0, -15.0, -164.0, 46.0, 32.0, 65.0, 33.0, -268.0, 15.0, 0.0, 30.0, -176.0, 20.0, 0.0, 8.0, 47.0, 59.0, 31.0, 4.0, 37.0, 45.0, -62.0, 73.0, 31.0, 86.0, -85.0, 6.0, 49.0, 22.0, 53.0, -110.0], "policy_predator_policy_reward": [23.0, 78.0, 16.0, 15.0, 31.0, 28.0, 61.0, 53.0, 105.0, 89.0, 43.0, 41.0, 17.0, 18.0, 8.0, 48.0, 57.0, 52.0, 38.0, 26.0, 44.0, 137.0, 64.0, 71.0, 26.0, 43.0, 3.0, 0.0, 4.0, 3.0, 16.0, 41.0, 78.0, 153.0, 90.0, 54.0, 105.0, 74.0, 55.0, 66.0, 105.0, 87.0, 4.0, 8.0, 2.0, 2.0, 105.0, 26.0, 3.0, 11.0, 24.0, 18.0, 81.0, 37.0, 30.0, 37.0, 29.0, 39.0, 102.0, 70.0, 69.0, 88.0, 46.0, 78.0, 0.0, 0.0, 11.0, 18.0, 0.0, 12.0, 18.0, 37.0, 53.0, 35.0, 47.0, 34.0, 138.0, 143.0, 26.0, 11.0, 11.0, 10.0, 59.0, 68.0, 29.0, 20.0, 22.0, 38.0, 18.0, 26.0, 2.0, 2.0, 4.0, 1.0, 4.0, 7.0, 63.0, 56.0, 3.0, 2.0, 0.0, 0.0, 7.0, 14.0, 20.0, 10.0, 22.0, 2.0, 15.0, 12.0, 88.0, 72.0, 6.0, 13.0, 0.0, 4.0, 50.0, 84.0, 5.0, 22.0, 22.0, 34.0, 36.0, 7.0, 10.0, 9.0, 54.0, 80.0, 46.0, 48.0, 13.0, 0.0, 10.0, 8.0, 13.0, 16.0, 65.0, 51.0, 1.0, 29.0, 5.0, 12.0, 20.0, 36.0, 23.0, 2.0, 8.0, 0.0, 59.0, 60.0, 12.0, 6.0, 13.0, 0.0, 7.0, 0.0, 5.0, 29.0, 10.0, 17.0, 8.0, 2.0, 9.0, 8.0, 16.0, 7.0, 39.0, 49.0, 20.0, 81.0, 73.0, 85.0, 26.0, 17.0, 18.0, 17.0, 87.0, 137.0, 19.0, 19.0, 113.0, 54.0, 7.0, 23.0, 3.0, 9.0, 49.0, 24.0, 29.0, 13.0, 47.0, 48.0, 1.0, 13.0, 86.0, 63.0, 13.0, 39.0, 76.0, 46.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5482619033166811, "mean_inference_ms": 35.271664287571504, "mean_action_processing_ms": 0.7091280843680398, "mean_env_wait_ms": 0.5394979028314517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008607864379882812, "StateBufferConnector_ms": 0.006528258323669434, "ViewRequirementAgentConnector_ms": 0.3048774003982544}, "num_episodes": 18, "episode_return_max": 229.0, "episode_return_min": -168.0, "episode_return_mean": 77.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.780026032875, "num_env_steps_trained_throughput_per_sec": 151.780026032875, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 26983.982, "restore_workers_time_ms": 0.019, "training_step_time_ms": 26983.746, "sample_time_ms": 3787.659, "learn_time_ms": 23168.749, "learn_throughput": 172.646, "synch_weights_time_ms": 20.74}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "4f45b_00000", "date": "2024-08-13_02-51-34", "timestamp": 1723531894, "time_this_iter_s": 26.4091899394989, "time_total_s": 5627.003051996231, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cc4b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5627.003051996231, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 87.49736842105263, "ram_util_percent": 83.3973684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8622740114492082, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.1834561875257545, "policy_loss": -0.01004252731011658, "vf_loss": 6.193026173808588, "vf_explained_var": 0.007182526241534601, "kl": 0.019913291010399427, "entropy": 1.0229935030773203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.342864672374473, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.324539305671813, "policy_loss": -0.002817193168171105, "vf_loss": 9.32732381517925, "vf_explained_var": -0.3460014951922906, "kl": 0.009292770910046369, "entropy": 1.4496664877921817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 229.0, "episode_reward_min": -67.0, "episode_reward_mean": 75.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 121.0, "predator_policy": 143.0}, "policy_reward_mean": {"prey_policy": 6.475, "predator_policy": 31.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-30.0, 113.0, 41.0, 38.0, 79.0, 143.0, 32.0, 63.0, 70.0, 82.0, 111.0, 229.0, 144.0, 22.0, 115.0, -30.0, 139.0, 107.0, 55.0, 170.0, 42.0, 65.0, 102.0, 87.0, 93.0, 98.0, 103.0, 0.0, 119.0, 97.0, 58.0, 144.0, 61.0, 75.0, 15.0, 92.0, 41.0, 41.0, 156.0, 133.0, -10.0, 93.0, 48.0, 101.0, 126.0, 75.0, 148.0, 186.0, 92.0, 169.0, 114.0, 58.0, 130.0, 133.0, 102.0, 155.0, 155.0, 109.0, 57.0, 99.0, 66.0, 64.0, -21.0, 121.0, 133.0, -29.0, 68.0, 11.0, 38.0, 118.0, 108.0, 124.0, 106.0, 131.0, 70.0, 123.0, 65.0, 24.0, 4.0, -67.0, 17.0, 18.0, 29.0, 13.0, 32.0, 110.0, 45.0, 6.0, 99.0, -6.0, 33.0, 96.0, 4.0, 66.0, 81.0, 25.0, 12.0, 52.0, 4.0, 85.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-197.0, 36.0, 31.0, 68.0, 8.0, -9.0, -53.0, -27.0, -9.0, 21.0, 14.0, 61.0, -157.0, 17.0, -196.0, 102.0, 96.0, -150.0, 0.0, 82.0, 40.0, 42.0, 121.0, 96.0, 31.0, 58.0, -10.0, -56.0, 107.0, -73.0, 7.0, -318.0, 60.0, 42.0, 47.0, 39.0, 71.0, -143.0, 37.0, 84.0, 0.0, -18.0, 5.0, 16.0, 58.0, 40.0, 42.0, 40.0, 32.0, 50.0, 29.0, -50.0, 68.0, 30.0, 0.0, 0.0, 38.0, 60.0, 19.0, 48.0, 38.0, -4.0, 32.0, 85.0, -28.0, -71.0, 44.0, 12.0, 11.0, 0.0, 68.0, -110.0, 6.0, 8.0, 14.0, -29.0, 90.0, 23.0, 59.0, 55.0, 0.0, -144.0, 88.0, -89.0, 18.0, 17.0, 69.0, 14.0, 68.0, 29.0, -16.0, -25.0, 30.0, 88.0, 97.0, 72.0, 68.0, -32.0, 33.0, 111.0, 35.0, 71.0, -10.0, -51.0, 61.0, 51.0, 38.0, 82.0, 49.0, 46.0, 89.0, 32.0, 49.0, 79.0, 58.0, 41.0, 0.0, 40.0, -8.0, 84.0, -12.0, -10.0, 42.0, -79.0, -15.0, -164.0, 46.0, 32.0, 65.0, 33.0, -268.0, 15.0, 0.0, 30.0, -176.0, 20.0, 0.0, 8.0, 47.0, 59.0, 31.0, 4.0, 37.0, 45.0, -62.0, 73.0, 31.0, 86.0, -85.0, 6.0, 49.0, 22.0, 53.0, -110.0, -85.0, 5.0, -17.0, -57.0, -158.0, -75.0, -44.0, 20.0, -64.0, -8.0, -40.0, 11.0, -44.0, 20.0, 20.0, -31.0, 46.0, 18.0, 9.0, -18.0, 0.0, -16.0, 26.0, 5.0, -16.0, -34.0, 40.0, -97.0, -22.0, 25.0, -1.0, -45.0, 11.0, -1.0, -85.0, 70.0, 21.0, -53.0, -25.0, -1.0, 11.0, -5.0, -48.0, -10.0, 18.0, 4.0], "policy_predator_policy_reward": [105.0, 26.0, 3.0, 11.0, 24.0, 18.0, 81.0, 37.0, 30.0, 37.0, 29.0, 39.0, 102.0, 70.0, 69.0, 88.0, 46.0, 78.0, 0.0, 0.0, 11.0, 18.0, 0.0, 12.0, 18.0, 37.0, 53.0, 35.0, 47.0, 34.0, 138.0, 143.0, 26.0, 11.0, 11.0, 10.0, 59.0, 68.0, 29.0, 20.0, 22.0, 38.0, 18.0, 26.0, 2.0, 2.0, 4.0, 1.0, 4.0, 7.0, 63.0, 56.0, 3.0, 2.0, 0.0, 0.0, 7.0, 14.0, 20.0, 10.0, 22.0, 2.0, 15.0, 12.0, 88.0, 72.0, 6.0, 13.0, 0.0, 4.0, 50.0, 84.0, 5.0, 22.0, 22.0, 34.0, 36.0, 7.0, 10.0, 9.0, 54.0, 80.0, 46.0, 48.0, 13.0, 0.0, 10.0, 8.0, 13.0, 16.0, 65.0, 51.0, 1.0, 29.0, 5.0, 12.0, 20.0, 36.0, 23.0, 2.0, 8.0, 0.0, 59.0, 60.0, 12.0, 6.0, 13.0, 0.0, 7.0, 0.0, 5.0, 29.0, 10.0, 17.0, 8.0, 2.0, 9.0, 8.0, 16.0, 7.0, 39.0, 49.0, 20.0, 81.0, 73.0, 85.0, 26.0, 17.0, 18.0, 17.0, 87.0, 137.0, 19.0, 19.0, 113.0, 54.0, 7.0, 23.0, 3.0, 9.0, 49.0, 24.0, 29.0, 13.0, 47.0, 48.0, 1.0, 13.0, 86.0, 63.0, 13.0, 39.0, 76.0, 46.0, 72.0, 32.0, 50.0, 28.0, 61.0, 105.0, 19.0, 22.0, 39.0, 51.0, 28.0, 30.0, 21.0, 16.0, 19.0, 24.0, 13.0, 33.0, 25.0, 29.0, 4.0, 18.0, 37.0, 31.0, 23.0, 21.0, 29.0, 61.0, 45.0, 48.0, 30.0, 20.0, 27.0, 29.0, 41.0, 55.0, 29.0, 28.0, 11.0, 27.0, 5.0, 41.0, 46.0, 16.0, 24.0, 39.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5544522291331029, "mean_inference_ms": 34.74071903112658, "mean_action_processing_ms": 0.7098146603386885, "mean_env_wait_ms": 0.541098826136171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01175689697265625, "StateBufferConnector_ms": 0.008783936500549316, "ViewRequirementAgentConnector_ms": 0.4110909700393677}, "num_episodes": 23, "episode_return_max": 229.0, "episode_return_min": -67.0, "episode_return_mean": 75.33, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 158.22006351694125, "num_env_steps_trained_throughput_per_sec": 158.22006351694125, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 26904.432, "restore_workers_time_ms": 0.019, "training_step_time_ms": 26904.373, "sample_time_ms": 3985.856, "learn_time_ms": 22890.412, "learn_throughput": 174.746, "synch_weights_time_ms": 21.543}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "4f45b_00000", "date": "2024-08-13_02-52-00", "timestamp": 1723531920, "time_this_iter_s": 25.36922788619995, "time_total_s": 5652.372279882431, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24e14c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5652.372279882431, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 85.98285714285713, "ram_util_percent": 83.50285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8822420779359403, "cur_kl_coeff": 0.023730468750000008, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.001559520903088, "policy_loss": -0.015378091805405107, "vf_loss": 8.016289395630045, "vf_explained_var": 0.0073538045088450115, "kl": 0.027316291570331577, "entropy": 0.9777762656174008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.153270367324037, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.31274365470523, "policy_loss": -0.0029177593818752383, "vf_loss": 9.315607606292401, "vf_explained_var": -0.24617612841268066, "kl": 0.015310553525089981, "entropy": 1.413434143798061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 186.0, "episode_reward_min": -205.0, "episode_reward_mean": 49.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -268.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 111.0, "predator_policy": 137.0}, "policy_reward_mean": {"prey_policy": -9.705, "predator_policy": 34.645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.0, 170.0, 42.0, 65.0, 102.0, 87.0, 93.0, 98.0, 103.0, 0.0, 119.0, 97.0, 58.0, 144.0, 61.0, 75.0, 15.0, 92.0, 41.0, 41.0, 156.0, 133.0, -10.0, 93.0, 48.0, 101.0, 126.0, 75.0, 148.0, 186.0, 92.0, 169.0, 114.0, 58.0, 130.0, 133.0, 102.0, 155.0, 155.0, 109.0, 57.0, 99.0, 66.0, 64.0, -21.0, 121.0, 133.0, -29.0, 68.0, 11.0, 38.0, 118.0, 108.0, 124.0, 106.0, 131.0, 70.0, 123.0, 65.0, 24.0, 4.0, -67.0, 17.0, 18.0, 29.0, 13.0, 32.0, 110.0, 45.0, 6.0, 99.0, -6.0, 33.0, 96.0, 4.0, 66.0, 81.0, 25.0, 12.0, 52.0, 4.0, 85.0, -88.0, -87.0, 31.0, -91.0, -28.0, -15.0, -30.0, -17.0, -35.0, -130.0, -205.0, -164.0, 37.0, -57.0, -25.0, -78.0, -95.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [71.0, -143.0, 37.0, 84.0, 0.0, -18.0, 5.0, 16.0, 58.0, 40.0, 42.0, 40.0, 32.0, 50.0, 29.0, -50.0, 68.0, 30.0, 0.0, 0.0, 38.0, 60.0, 19.0, 48.0, 38.0, -4.0, 32.0, 85.0, -28.0, -71.0, 44.0, 12.0, 11.0, 0.0, 68.0, -110.0, 6.0, 8.0, 14.0, -29.0, 90.0, 23.0, 59.0, 55.0, 0.0, -144.0, 88.0, -89.0, 18.0, 17.0, 69.0, 14.0, 68.0, 29.0, -16.0, -25.0, 30.0, 88.0, 97.0, 72.0, 68.0, -32.0, 33.0, 111.0, 35.0, 71.0, -10.0, -51.0, 61.0, 51.0, 38.0, 82.0, 49.0, 46.0, 89.0, 32.0, 49.0, 79.0, 58.0, 41.0, 0.0, 40.0, -8.0, 84.0, -12.0, -10.0, 42.0, -79.0, -15.0, -164.0, 46.0, 32.0, 65.0, 33.0, -268.0, 15.0, 0.0, 30.0, -176.0, 20.0, 0.0, 8.0, 47.0, 59.0, 31.0, 4.0, 37.0, 45.0, -62.0, 73.0, 31.0, 86.0, -85.0, 6.0, 49.0, 22.0, 53.0, -110.0, -85.0, 5.0, -17.0, -57.0, -158.0, -75.0, -44.0, 20.0, -64.0, -8.0, -40.0, 11.0, -44.0, 20.0, 20.0, -31.0, 46.0, 18.0, 9.0, -18.0, 0.0, -16.0, 26.0, 5.0, -16.0, -34.0, 40.0, -97.0, -22.0, 25.0, -1.0, -45.0, 11.0, -1.0, -85.0, 70.0, 21.0, -53.0, -25.0, -1.0, 11.0, -5.0, -48.0, -10.0, 18.0, 4.0, -124.0, -82.0, -76.0, -157.0, -29.0, -62.0, -107.0, -85.0, -18.0, -157.0, -41.0, -104.0, -115.0, 0.0, -72.0, -31.0, -21.0, -123.0, -173.0, -139.0, -191.0, -225.0, -124.0, -184.0, -10.0, -31.0, -166.0, -29.0, -148.0, 29.0, -115.0, -83.0, -90.0, -140.0, -42.0, 0.0], "policy_predator_policy_reward": [59.0, 68.0, 29.0, 20.0, 22.0, 38.0, 18.0, 26.0, 2.0, 2.0, 4.0, 1.0, 4.0, 7.0, 63.0, 56.0, 3.0, 2.0, 0.0, 0.0, 7.0, 14.0, 20.0, 10.0, 22.0, 2.0, 15.0, 12.0, 88.0, 72.0, 6.0, 13.0, 0.0, 4.0, 50.0, 84.0, 5.0, 22.0, 22.0, 34.0, 36.0, 7.0, 10.0, 9.0, 54.0, 80.0, 46.0, 48.0, 13.0, 0.0, 10.0, 8.0, 13.0, 16.0, 65.0, 51.0, 1.0, 29.0, 5.0, 12.0, 20.0, 36.0, 23.0, 2.0, 8.0, 0.0, 59.0, 60.0, 12.0, 6.0, 13.0, 0.0, 7.0, 0.0, 5.0, 29.0, 10.0, 17.0, 8.0, 2.0, 9.0, 8.0, 16.0, 7.0, 39.0, 49.0, 20.0, 81.0, 73.0, 85.0, 26.0, 17.0, 18.0, 17.0, 87.0, 137.0, 19.0, 19.0, 113.0, 54.0, 7.0, 23.0, 3.0, 9.0, 49.0, 24.0, 29.0, 13.0, 47.0, 48.0, 1.0, 13.0, 86.0, 63.0, 13.0, 39.0, 76.0, 46.0, 72.0, 32.0, 50.0, 28.0, 61.0, 105.0, 19.0, 22.0, 39.0, 51.0, 28.0, 30.0, 21.0, 16.0, 19.0, 24.0, 13.0, 33.0, 25.0, 29.0, 4.0, 18.0, 37.0, 31.0, 23.0, 21.0, 29.0, 61.0, 45.0, 48.0, 30.0, 20.0, 27.0, 29.0, 41.0, 55.0, 29.0, 28.0, 11.0, 27.0, 5.0, 41.0, 46.0, 16.0, 24.0, 39.0, 44.0, 74.0, 72.0, 74.0, 59.0, 63.0, 59.0, 42.0, 84.0, 63.0, 53.0, 77.0, 44.0, 41.0, 28.0, 58.0, 41.0, 68.0, 100.0, 82.0, 103.0, 108.0, 37.0, 107.0, 48.0, 30.0, 81.0, 57.0, 40.0, 54.0, 44.0, 76.0, 54.0, 81.0, 16.0, 26.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5628000213619213, "mean_inference_ms": 34.34640823116453, "mean_action_processing_ms": 0.7119618104631479, "mean_env_wait_ms": 0.5439671860991632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026470065116882324, "StateBufferConnector_ms": 0.009067296981811523, "ViewRequirementAgentConnector_ms": 0.43844664096832275}, "num_episodes": 18, "episode_return_max": 186.0, "episode_return_min": -205.0, "episode_return_mean": 49.88, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.27433670613442, "num_env_steps_trained_throughput_per_sec": 155.27433670613442, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 27049.601, "restore_workers_time_ms": 0.022, "training_step_time_ms": 27049.536, "sample_time_ms": 4140.921, "learn_time_ms": 22879.147, "learn_throughput": 174.832, "synch_weights_time_ms": 22.869}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "4f45b_00000", "date": "2024-08-13_02-52-26", "timestamp": 1723531946, "time_this_iter_s": 25.885726928710938, "time_total_s": 5678.258006811142, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cda790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5678.258006811142, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 85.85405405405405, "ram_util_percent": 83.45675675675675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.552808934505339, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.394840579562716, "policy_loss": -0.006644322939103755, "vf_loss": 9.400893962194049, "vf_explained_var": 0.0009029823005514801, "kl": 0.016600791501185114, "entropy": 0.9163662852433624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.439602926562703, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.423189824724954, "policy_loss": -0.0036932601666117395, "vf_loss": 9.42682444658229, "vf_explained_var": -0.11592398976522779, "kl": 0.016688813880884983, "entropy": 1.404153495995456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 186.0, "episode_reward_min": -292.0, "episode_reward_mean": 7.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -319.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 111.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": -44.065, "predator_policy": 47.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.0, 41.0, 156.0, 133.0, -10.0, 93.0, 48.0, 101.0, 126.0, 75.0, 148.0, 186.0, 92.0, 169.0, 114.0, 58.0, 130.0, 133.0, 102.0, 155.0, 155.0, 109.0, 57.0, 99.0, 66.0, 64.0, -21.0, 121.0, 133.0, -29.0, 68.0, 11.0, 38.0, 118.0, 108.0, 124.0, 106.0, 131.0, 70.0, 123.0, 65.0, 24.0, 4.0, -67.0, 17.0, 18.0, 29.0, 13.0, 32.0, 110.0, 45.0, 6.0, 99.0, -6.0, 33.0, 96.0, 4.0, 66.0, 81.0, 25.0, 12.0, 52.0, 4.0, 85.0, -88.0, -87.0, 31.0, -91.0, -28.0, -15.0, -30.0, -17.0, -35.0, -130.0, -205.0, -164.0, 37.0, -57.0, -25.0, -78.0, -95.0, 0.0, -240.0, -115.0, -120.0, -237.0, -160.0, -149.0, -15.0, -231.0, -29.0, -142.0, -213.0, -110.0, -33.0, -292.0, -144.0, -207.0, -137.0, -213.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, 8.0, 14.0, -29.0, 90.0, 23.0, 59.0, 55.0, 0.0, -144.0, 88.0, -89.0, 18.0, 17.0, 69.0, 14.0, 68.0, 29.0, -16.0, -25.0, 30.0, 88.0, 97.0, 72.0, 68.0, -32.0, 33.0, 111.0, 35.0, 71.0, -10.0, -51.0, 61.0, 51.0, 38.0, 82.0, 49.0, 46.0, 89.0, 32.0, 49.0, 79.0, 58.0, 41.0, 0.0, 40.0, -8.0, 84.0, -12.0, -10.0, 42.0, -79.0, -15.0, -164.0, 46.0, 32.0, 65.0, 33.0, -268.0, 15.0, 0.0, 30.0, -176.0, 20.0, 0.0, 8.0, 47.0, 59.0, 31.0, 4.0, 37.0, 45.0, -62.0, 73.0, 31.0, 86.0, -85.0, 6.0, 49.0, 22.0, 53.0, -110.0, -85.0, 5.0, -17.0, -57.0, -158.0, -75.0, -44.0, 20.0, -64.0, -8.0, -40.0, 11.0, -44.0, 20.0, 20.0, -31.0, 46.0, 18.0, 9.0, -18.0, 0.0, -16.0, 26.0, 5.0, -16.0, -34.0, 40.0, -97.0, -22.0, 25.0, -1.0, -45.0, 11.0, -1.0, -85.0, 70.0, 21.0, -53.0, -25.0, -1.0, 11.0, -5.0, -48.0, -10.0, 18.0, 4.0, -124.0, -82.0, -76.0, -157.0, -29.0, -62.0, -107.0, -85.0, -18.0, -157.0, -41.0, -104.0, -115.0, 0.0, -72.0, -31.0, -21.0, -123.0, -173.0, -139.0, -191.0, -225.0, -124.0, -184.0, -10.0, -31.0, -166.0, -29.0, -148.0, 29.0, -115.0, -83.0, -90.0, -140.0, -42.0, 0.0, -173.0, -254.0, -115.0, -188.0, -229.0, -59.0, -221.0, -256.0, -152.0, -156.0, -178.0, -159.0, -83.0, -29.0, -255.0, -203.0, 0.0, -120.0, -256.0, -129.0, -261.0, -174.0, -78.0, -208.0, -168.0, 0.0, -319.0, -271.0, -135.0, -194.0, -254.0, -196.0, -183.0, -128.0, -289.0, -166.0], "policy_predator_policy_reward": [5.0, 22.0, 22.0, 34.0, 36.0, 7.0, 10.0, 9.0, 54.0, 80.0, 46.0, 48.0, 13.0, 0.0, 10.0, 8.0, 13.0, 16.0, 65.0, 51.0, 1.0, 29.0, 5.0, 12.0, 20.0, 36.0, 23.0, 2.0, 8.0, 0.0, 59.0, 60.0, 12.0, 6.0, 13.0, 0.0, 7.0, 0.0, 5.0, 29.0, 10.0, 17.0, 8.0, 2.0, 9.0, 8.0, 16.0, 7.0, 39.0, 49.0, 20.0, 81.0, 73.0, 85.0, 26.0, 17.0, 18.0, 17.0, 87.0, 137.0, 19.0, 19.0, 113.0, 54.0, 7.0, 23.0, 3.0, 9.0, 49.0, 24.0, 29.0, 13.0, 47.0, 48.0, 1.0, 13.0, 86.0, 63.0, 13.0, 39.0, 76.0, 46.0, 72.0, 32.0, 50.0, 28.0, 61.0, 105.0, 19.0, 22.0, 39.0, 51.0, 28.0, 30.0, 21.0, 16.0, 19.0, 24.0, 13.0, 33.0, 25.0, 29.0, 4.0, 18.0, 37.0, 31.0, 23.0, 21.0, 29.0, 61.0, 45.0, 48.0, 30.0, 20.0, 27.0, 29.0, 41.0, 55.0, 29.0, 28.0, 11.0, 27.0, 5.0, 41.0, 46.0, 16.0, 24.0, 39.0, 44.0, 74.0, 72.0, 74.0, 59.0, 63.0, 59.0, 42.0, 84.0, 63.0, 53.0, 77.0, 44.0, 41.0, 28.0, 58.0, 41.0, 68.0, 100.0, 82.0, 103.0, 108.0, 37.0, 107.0, 48.0, 30.0, 81.0, 57.0, 40.0, 54.0, 44.0, 76.0, 54.0, 81.0, 16.0, 26.0, 76.0, 111.0, 87.0, 101.0, 55.0, 113.0, 135.0, 105.0, 81.0, 67.0, 103.0, 85.0, 37.0, 60.0, 123.0, 104.0, 50.0, 41.0, 145.0, 98.0, 102.0, 120.0, 103.0, 73.0, 64.0, 71.0, 158.0, 140.0, 85.0, 100.0, 137.0, 106.0, 86.0, 88.0, 98.0, 144.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.574921828388692, "mean_inference_ms": 33.975476416796624, "mean_action_processing_ms": 0.7161123956245763, "mean_env_wait_ms": 0.5482760714071543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032886385917663574, "StateBufferConnector_ms": 0.00897979736328125, "ViewRequirementAgentConnector_ms": 0.4696305990219116}, "num_episodes": 18, "episode_return_max": 186.0, "episode_return_min": -292.0, "episode_return_mean": 7.25, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.2550734182332, "num_env_steps_trained_throughput_per_sec": 148.2550734182332, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 27189.394, "restore_workers_time_ms": 0.021, "training_step_time_ms": 27188.881, "sample_time_ms": 4539.187, "learn_time_ms": 22616.67, "learn_throughput": 176.861, "synch_weights_time_ms": 26.434}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "4f45b_00000", "date": "2024-08-13_02-52-53", "timestamp": 1723531973, "time_this_iter_s": 27.133843898773193, "time_total_s": 5705.391850709915, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24703a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5705.391850709915, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 87.21578947368423, "ram_util_percent": 83.31315789473686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6422098490453902, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.399194453002284, "policy_loss": -0.001981699145423672, "vf_loss": 9.4008758393545, "vf_explained_var": 0.00012297923602755108, "kl": 0.008436557907846491, "entropy": 0.8552926658322572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.225039932194841, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.983715112121017, "policy_loss": -0.0009246684095906044, "vf_loss": 7.984612998508272, "vf_explained_var": -0.16136918673439632, "kl": 0.007617400560400075, "entropy": 1.4005989820238143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 133.0, "episode_reward_min": -328.0, "episode_reward_mean": -47.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -355.0, "predator_policy": 1.0}, "policy_reward_max": {"prey_policy": 86.0, "predator_policy": 172.0}, "policy_reward_mean": {"prey_policy": -92.72, "predator_policy": 68.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [57.0, 99.0, 66.0, 64.0, -21.0, 121.0, 133.0, -29.0, 68.0, 11.0, 38.0, 118.0, 108.0, 124.0, 106.0, 131.0, 70.0, 123.0, 65.0, 24.0, 4.0, -67.0, 17.0, 18.0, 29.0, 13.0, 32.0, 110.0, 45.0, 6.0, 99.0, -6.0, 33.0, 96.0, 4.0, 66.0, 81.0, 25.0, 12.0, 52.0, 4.0, 85.0, -88.0, -87.0, 31.0, -91.0, -28.0, -15.0, -30.0, -17.0, -35.0, -130.0, -205.0, -164.0, 37.0, -57.0, -25.0, -78.0, -95.0, 0.0, -240.0, -115.0, -120.0, -237.0, -160.0, -149.0, -15.0, -231.0, -29.0, -142.0, -213.0, -110.0, -33.0, -292.0, -144.0, -207.0, -137.0, -213.0, -118.0, -328.0, -30.0, -134.0, -58.0, -183.0, -313.0, -51.0, -52.0, -47.0, -154.0, -66.0, 10.0, -48.0, -222.0, -295.0, -151.0, -142.0, -269.0, -227.0, -214.0, -49.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 40.0, -8.0, 84.0, -12.0, -10.0, 42.0, -79.0, -15.0, -164.0, 46.0, 32.0, 65.0, 33.0, -268.0, 15.0, 0.0, 30.0, -176.0, 20.0, 0.0, 8.0, 47.0, 59.0, 31.0, 4.0, 37.0, 45.0, -62.0, 73.0, 31.0, 86.0, -85.0, 6.0, 49.0, 22.0, 53.0, -110.0, -85.0, 5.0, -17.0, -57.0, -158.0, -75.0, -44.0, 20.0, -64.0, -8.0, -40.0, 11.0, -44.0, 20.0, 20.0, -31.0, 46.0, 18.0, 9.0, -18.0, 0.0, -16.0, 26.0, 5.0, -16.0, -34.0, 40.0, -97.0, -22.0, 25.0, -1.0, -45.0, 11.0, -1.0, -85.0, 70.0, 21.0, -53.0, -25.0, -1.0, 11.0, -5.0, -48.0, -10.0, 18.0, 4.0, -124.0, -82.0, -76.0, -157.0, -29.0, -62.0, -107.0, -85.0, -18.0, -157.0, -41.0, -104.0, -115.0, 0.0, -72.0, -31.0, -21.0, -123.0, -173.0, -139.0, -191.0, -225.0, -124.0, -184.0, -10.0, -31.0, -166.0, -29.0, -148.0, 29.0, -115.0, -83.0, -90.0, -140.0, -42.0, 0.0, -173.0, -254.0, -115.0, -188.0, -229.0, -59.0, -221.0, -256.0, -152.0, -156.0, -178.0, -159.0, -83.0, -29.0, -255.0, -203.0, 0.0, -120.0, -256.0, -129.0, -261.0, -174.0, -78.0, -208.0, -168.0, 0.0, -319.0, -271.0, -135.0, -194.0, -254.0, -196.0, -183.0, -128.0, -289.0, -166.0, -84.0, -236.0, -307.0, -328.0, -34.0, -158.0, -132.0, -164.0, -263.0, 0.0, -156.0, -282.0, -350.0, -295.0, -318.0, -6.0, -202.0, 0.0, -169.0, -34.0, -184.0, -208.0, 0.0, -318.0, -130.0, 0.0, -20.0, -199.0, -255.0, -257.0, -308.0, -287.0, -173.0, -211.0, -199.0, -173.0, -237.0, -296.0, -280.0, -232.0, -355.0, -139.0, -306.0, -4.0], "policy_predator_policy_reward": [9.0, 8.0, 16.0, 7.0, 39.0, 49.0, 20.0, 81.0, 73.0, 85.0, 26.0, 17.0, 18.0, 17.0, 87.0, 137.0, 19.0, 19.0, 113.0, 54.0, 7.0, 23.0, 3.0, 9.0, 49.0, 24.0, 29.0, 13.0, 47.0, 48.0, 1.0, 13.0, 86.0, 63.0, 13.0, 39.0, 76.0, 46.0, 72.0, 32.0, 50.0, 28.0, 61.0, 105.0, 19.0, 22.0, 39.0, 51.0, 28.0, 30.0, 21.0, 16.0, 19.0, 24.0, 13.0, 33.0, 25.0, 29.0, 4.0, 18.0, 37.0, 31.0, 23.0, 21.0, 29.0, 61.0, 45.0, 48.0, 30.0, 20.0, 27.0, 29.0, 41.0, 55.0, 29.0, 28.0, 11.0, 27.0, 5.0, 41.0, 46.0, 16.0, 24.0, 39.0, 44.0, 74.0, 72.0, 74.0, 59.0, 63.0, 59.0, 42.0, 84.0, 63.0, 53.0, 77.0, 44.0, 41.0, 28.0, 58.0, 41.0, 68.0, 100.0, 82.0, 103.0, 108.0, 37.0, 107.0, 48.0, 30.0, 81.0, 57.0, 40.0, 54.0, 44.0, 76.0, 54.0, 81.0, 16.0, 26.0, 76.0, 111.0, 87.0, 101.0, 55.0, 113.0, 135.0, 105.0, 81.0, 67.0, 103.0, 85.0, 37.0, 60.0, 123.0, 104.0, 50.0, 41.0, 145.0, 98.0, 102.0, 120.0, 103.0, 73.0, 64.0, 71.0, 158.0, 140.0, 85.0, 100.0, 137.0, 106.0, 86.0, 88.0, 98.0, 144.0, 96.0, 106.0, 155.0, 152.0, 90.0, 72.0, 86.0, 76.0, 127.0, 78.0, 132.0, 123.0, 172.0, 160.0, 155.0, 118.0, 84.0, 66.0, 81.0, 75.0, 111.0, 127.0, 162.0, 90.0, 80.0, 60.0, 110.0, 61.0, 155.0, 135.0, 159.0, 141.0, 125.0, 108.0, 132.0, 98.0, 133.0, 131.0, 140.0, 145.0, 172.0, 108.0, 140.0, 121.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.592734321075322, "mean_inference_ms": 33.544806043853285, "mean_action_processing_ms": 0.7223727008862346, "mean_env_wait_ms": 0.5544087484517877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03586840629577637, "StateBufferConnector_ms": 0.013545036315917969, "ViewRequirementAgentConnector_ms": 0.5181671380996704}, "num_episodes": 22, "episode_return_max": 133.0, "episode_return_min": -328.0, "episode_return_mean": -47.71, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 127.12470250686958, "num_env_steps_trained_throughput_per_sec": 127.12470250686958, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 27430.988, "restore_workers_time_ms": 0.022, "training_step_time_ms": 27430.474, "sample_time_ms": 4576.052, "learn_time_ms": 22814.791, "learn_throughput": 175.325, "synch_weights_time_ms": 33.659}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "4f45b_00000", "date": "2024-08-13_02-53-25", "timestamp": 1723532005, "time_this_iter_s": 31.565349102020264, "time_total_s": 5736.957199811935, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24e15e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5736.957199811935, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 88.73333333333335, "ram_util_percent": 83.64666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7232189680927645, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.469102671285155, "policy_loss": -0.0007087669384582018, "vf_loss": 9.469572999237707, "vf_explained_var": -0.00372716711942481, "kl": 0.00669869828354287, "entropy": 0.8747872577457831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9734207610998835, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.050948707641117, "policy_loss": -0.002606420088362284, "vf_loss": 9.053517396614035, "vf_explained_var": -0.06017474081150438, "kl": 0.010731478756610537, "entropy": 1.375202123197929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 110.0, "episode_reward_min": -328.0, "episode_reward_mean": -112.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -362.0, "predator_policy": 4.0}, "policy_reward_max": {"prey_policy": 70.0, "predator_policy": 183.0}, "policy_reward_mean": {"prey_policy": -147.575, "predator_policy": 91.295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, 29.0, 13.0, 32.0, 110.0, 45.0, 6.0, 99.0, -6.0, 33.0, 96.0, 4.0, 66.0, 81.0, 25.0, 12.0, 52.0, 4.0, 85.0, -88.0, -87.0, 31.0, -91.0, -28.0, -15.0, -30.0, -17.0, -35.0, -130.0, -205.0, -164.0, 37.0, -57.0, -25.0, -78.0, -95.0, 0.0, -240.0, -115.0, -120.0, -237.0, -160.0, -149.0, -15.0, -231.0, -29.0, -142.0, -213.0, -110.0, -33.0, -292.0, -144.0, -207.0, -137.0, -213.0, -118.0, -328.0, -30.0, -134.0, -58.0, -183.0, -313.0, -51.0, -52.0, -47.0, -154.0, -66.0, 10.0, -48.0, -222.0, -295.0, -151.0, -142.0, -269.0, -227.0, -214.0, -49.0, -324.0, -213.0, -295.0, -239.0, -268.0, -25.0, -296.0, -55.0, -255.0, -133.0, -258.0, -174.0, -319.0, -240.0, -195.0, -305.0, -223.0, -83.0, -33.0, -290.0, -306.0, -283.0, -243.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-64.0, -8.0, -40.0, 11.0, -44.0, 20.0, 20.0, -31.0, 46.0, 18.0, 9.0, -18.0, 0.0, -16.0, 26.0, 5.0, -16.0, -34.0, 40.0, -97.0, -22.0, 25.0, -1.0, -45.0, 11.0, -1.0, -85.0, 70.0, 21.0, -53.0, -25.0, -1.0, 11.0, -5.0, -48.0, -10.0, 18.0, 4.0, -124.0, -82.0, -76.0, -157.0, -29.0, -62.0, -107.0, -85.0, -18.0, -157.0, -41.0, -104.0, -115.0, 0.0, -72.0, -31.0, -21.0, -123.0, -173.0, -139.0, -191.0, -225.0, -124.0, -184.0, -10.0, -31.0, -166.0, -29.0, -148.0, 29.0, -115.0, -83.0, -90.0, -140.0, -42.0, 0.0, -173.0, -254.0, -115.0, -188.0, -229.0, -59.0, -221.0, -256.0, -152.0, -156.0, -178.0, -159.0, -83.0, -29.0, -255.0, -203.0, 0.0, -120.0, -256.0, -129.0, -261.0, -174.0, -78.0, -208.0, -168.0, 0.0, -319.0, -271.0, -135.0, -194.0, -254.0, -196.0, -183.0, -128.0, -289.0, -166.0, -84.0, -236.0, -307.0, -328.0, -34.0, -158.0, -132.0, -164.0, -263.0, 0.0, -156.0, -282.0, -350.0, -295.0, -318.0, -6.0, -202.0, 0.0, -169.0, -34.0, -184.0, -208.0, 0.0, -318.0, -130.0, 0.0, -20.0, -199.0, -255.0, -257.0, -308.0, -287.0, -173.0, -211.0, -199.0, -173.0, -237.0, -296.0, -280.0, -232.0, -355.0, -139.0, -306.0, -4.0, -300.0, -358.0, -202.0, -272.0, -332.0, -303.0, -274.0, -236.0, -292.0, -250.0, -261.0, 0.0, -317.0, -284.0, -339.0, 0.0, -292.0, -200.0, -200.0, -176.0, -194.0, -339.0, -146.0, -234.0, -362.0, -296.0, -248.0, -253.0, -203.0, -251.0, -317.0, -275.0, -234.0, -298.0, -298.0, -2.0, -230.0, 0.0, -270.0, -331.0, -317.0, -318.0, -288.0, -304.0, -283.0, -234.0], "policy_predator_policy_reward": [39.0, 51.0, 28.0, 30.0, 21.0, 16.0, 19.0, 24.0, 13.0, 33.0, 25.0, 29.0, 4.0, 18.0, 37.0, 31.0, 23.0, 21.0, 29.0, 61.0, 45.0, 48.0, 30.0, 20.0, 27.0, 29.0, 41.0, 55.0, 29.0, 28.0, 11.0, 27.0, 5.0, 41.0, 46.0, 16.0, 24.0, 39.0, 44.0, 74.0, 72.0, 74.0, 59.0, 63.0, 59.0, 42.0, 84.0, 63.0, 53.0, 77.0, 44.0, 41.0, 28.0, 58.0, 41.0, 68.0, 100.0, 82.0, 103.0, 108.0, 37.0, 107.0, 48.0, 30.0, 81.0, 57.0, 40.0, 54.0, 44.0, 76.0, 54.0, 81.0, 16.0, 26.0, 76.0, 111.0, 87.0, 101.0, 55.0, 113.0, 135.0, 105.0, 81.0, 67.0, 103.0, 85.0, 37.0, 60.0, 123.0, 104.0, 50.0, 41.0, 145.0, 98.0, 102.0, 120.0, 103.0, 73.0, 64.0, 71.0, 158.0, 140.0, 85.0, 100.0, 137.0, 106.0, 86.0, 88.0, 98.0, 144.0, 96.0, 106.0, 155.0, 152.0, 90.0, 72.0, 86.0, 76.0, 127.0, 78.0, 132.0, 123.0, 172.0, 160.0, 155.0, 118.0, 84.0, 66.0, 81.0, 75.0, 111.0, 127.0, 162.0, 90.0, 80.0, 60.0, 110.0, 61.0, 155.0, 135.0, 159.0, 141.0, 125.0, 108.0, 132.0, 98.0, 133.0, 131.0, 140.0, 145.0, 172.0, 108.0, 140.0, 121.0, 183.0, 151.0, 116.0, 145.0, 174.0, 166.0, 137.0, 134.0, 152.0, 122.0, 102.0, 134.0, 139.0, 166.0, 166.0, 118.0, 115.0, 122.0, 119.0, 124.0, 144.0, 131.0, 67.0, 139.0, 167.0, 172.0, 117.0, 144.0, 131.0, 128.0, 156.0, 131.0, 161.0, 148.0, 104.0, 113.0, 72.0, 125.0, 165.0, 146.0, 159.0, 170.0, 143.0, 166.0, 146.0, 128.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6111482867250222, "mean_inference_ms": 33.12786746102187, "mean_action_processing_ms": 0.7292182138692302, "mean_env_wait_ms": 0.5606031328186735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03618001937866211, "StateBufferConnector_ms": 0.01742100715637207, "ViewRequirementAgentConnector_ms": 0.5228475332260132}, "num_episodes": 23, "episode_return_max": 110.0, "episode_return_min": -328.0, "episode_return_mean": -112.56, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 136.1553902139141, "num_env_steps_trained_throughput_per_sec": 136.1553902139141, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 26741.786, "restore_workers_time_ms": 0.024, "training_step_time_ms": 26741.269, "sample_time_ms": 4786.828, "learn_time_ms": 21908.349, "learn_throughput": 182.579, "synch_weights_time_ms": 41.097}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "4f45b_00000", "date": "2024-08-13_02-53-54", "timestamp": 1723532034, "time_this_iter_s": 29.442366361618042, "time_total_s": 5766.3995661735535, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24e11f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5766.3995661735535, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 87.40731707317073, "ram_util_percent": 83.51951219512196}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6266058536749037, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.557889403489531, "policy_loss": -0.00015195298548196517, "vf_loss": 9.557771076727166, "vf_explained_var": -0.008697575330734253, "kl": 0.007591553177348541, "entropy": 0.9426897603052634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0438243868805115, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.764481398668238, "policy_loss": 0.0024036683509293844, "vf_loss": 8.76204836355946, "vf_explained_var": -0.04482985094741539, "kl": 0.008347991331674173, "entropy": 1.3698251798039391, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 85.0, "episode_reward_min": -356.0, "episode_reward_mean": -157.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -386.0, "predator_policy": 16.0}, "policy_reward_max": {"prey_policy": 29.0, "predator_policy": 186.0}, "policy_reward_mean": {"prey_policy": -191.13, "predator_policy": 112.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.0, -88.0, -87.0, 31.0, -91.0, -28.0, -15.0, -30.0, -17.0, -35.0, -130.0, -205.0, -164.0, 37.0, -57.0, -25.0, -78.0, -95.0, 0.0, -240.0, -115.0, -120.0, -237.0, -160.0, -149.0, -15.0, -231.0, -29.0, -142.0, -213.0, -110.0, -33.0, -292.0, -144.0, -207.0, -137.0, -213.0, -118.0, -328.0, -30.0, -134.0, -58.0, -183.0, -313.0, -51.0, -52.0, -47.0, -154.0, -66.0, 10.0, -48.0, -222.0, -295.0, -151.0, -142.0, -269.0, -227.0, -214.0, -49.0, -324.0, -213.0, -295.0, -239.0, -268.0, -25.0, -296.0, -55.0, -255.0, -133.0, -258.0, -174.0, -319.0, -240.0, -195.0, -305.0, -223.0, -83.0, -33.0, -290.0, -306.0, -283.0, -243.0, -356.0, -19.0, -141.0, -236.0, -293.0, -314.0, -244.0, -78.0, -305.0, -217.0, -224.0, -22.0, -235.0, -293.0, -231.0, -273.0, -78.0, -207.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [18.0, 4.0, -124.0, -82.0, -76.0, -157.0, -29.0, -62.0, -107.0, -85.0, -18.0, -157.0, -41.0, -104.0, -115.0, 0.0, -72.0, -31.0, -21.0, -123.0, -173.0, -139.0, -191.0, -225.0, -124.0, -184.0, -10.0, -31.0, -166.0, -29.0, -148.0, 29.0, -115.0, -83.0, -90.0, -140.0, -42.0, 0.0, -173.0, -254.0, -115.0, -188.0, -229.0, -59.0, -221.0, -256.0, -152.0, -156.0, -178.0, -159.0, -83.0, -29.0, -255.0, -203.0, 0.0, -120.0, -256.0, -129.0, -261.0, -174.0, -78.0, -208.0, -168.0, 0.0, -319.0, -271.0, -135.0, -194.0, -254.0, -196.0, -183.0, -128.0, -289.0, -166.0, -84.0, -236.0, -307.0, -328.0, -34.0, -158.0, -132.0, -164.0, -263.0, 0.0, -156.0, -282.0, -350.0, -295.0, -318.0, -6.0, -202.0, 0.0, -169.0, -34.0, -184.0, -208.0, 0.0, -318.0, -130.0, 0.0, -20.0, -199.0, -255.0, -257.0, -308.0, -287.0, -173.0, -211.0, -199.0, -173.0, -237.0, -296.0, -280.0, -232.0, -355.0, -139.0, -306.0, -4.0, -300.0, -358.0, -202.0, -272.0, -332.0, -303.0, -274.0, -236.0, -292.0, -250.0, -261.0, 0.0, -317.0, -284.0, -339.0, 0.0, -292.0, -200.0, -200.0, -176.0, -194.0, -339.0, -146.0, -234.0, -362.0, -296.0, -248.0, -253.0, -203.0, -251.0, -317.0, -275.0, -234.0, -298.0, -298.0, -2.0, -230.0, 0.0, -270.0, -331.0, -317.0, -318.0, -288.0, -304.0, -283.0, -234.0, -335.0, -386.0, -354.0, 0.0, -152.0, -203.0, -317.0, -231.0, -318.0, -289.0, -324.0, -315.0, -302.0, -225.0, -373.0, 0.0, -319.0, -292.0, -268.0, -229.0, -309.0, -217.0, -300.0, -2.0, -188.0, -287.0, -290.0, -324.0, -218.0, -281.0, -307.0, -282.0, 0.0, -313.0, -292.0, -200.0], "policy_predator_policy_reward": [24.0, 39.0, 44.0, 74.0, 72.0, 74.0, 59.0, 63.0, 59.0, 42.0, 84.0, 63.0, 53.0, 77.0, 44.0, 41.0, 28.0, 58.0, 41.0, 68.0, 100.0, 82.0, 103.0, 108.0, 37.0, 107.0, 48.0, 30.0, 81.0, 57.0, 40.0, 54.0, 44.0, 76.0, 54.0, 81.0, 16.0, 26.0, 76.0, 111.0, 87.0, 101.0, 55.0, 113.0, 135.0, 105.0, 81.0, 67.0, 103.0, 85.0, 37.0, 60.0, 123.0, 104.0, 50.0, 41.0, 145.0, 98.0, 102.0, 120.0, 103.0, 73.0, 64.0, 71.0, 158.0, 140.0, 85.0, 100.0, 137.0, 106.0, 86.0, 88.0, 98.0, 144.0, 96.0, 106.0, 155.0, 152.0, 90.0, 72.0, 86.0, 76.0, 127.0, 78.0, 132.0, 123.0, 172.0, 160.0, 155.0, 118.0, 84.0, 66.0, 81.0, 75.0, 111.0, 127.0, 162.0, 90.0, 80.0, 60.0, 110.0, 61.0, 155.0, 135.0, 159.0, 141.0, 125.0, 108.0, 132.0, 98.0, 133.0, 131.0, 140.0, 145.0, 172.0, 108.0, 140.0, 121.0, 183.0, 151.0, 116.0, 145.0, 174.0, 166.0, 137.0, 134.0, 152.0, 122.0, 102.0, 134.0, 139.0, 166.0, 166.0, 118.0, 115.0, 122.0, 119.0, 124.0, 144.0, 131.0, 67.0, 139.0, 167.0, 172.0, 117.0, 144.0, 131.0, 128.0, 156.0, 131.0, 161.0, 148.0, 104.0, 113.0, 72.0, 125.0, 165.0, 146.0, 159.0, 170.0, 143.0, 166.0, 146.0, 128.0, 179.0, 186.0, 166.0, 169.0, 117.0, 97.0, 161.0, 151.0, 158.0, 156.0, 155.0, 170.0, 148.0, 135.0, 126.0, 169.0, 150.0, 156.0, 139.0, 141.0, 157.0, 145.0, 140.0, 140.0, 104.0, 136.0, 160.0, 161.0, 130.0, 138.0, 165.0, 151.0, 73.0, 162.0, 144.0, 141.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.625299572606978, "mean_inference_ms": 32.8054721842791, "mean_action_processing_ms": 0.7337986231088334, "mean_env_wait_ms": 0.5658720816552506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03233969211578369, "StateBufferConnector_ms": 0.015701889991760254, "ViewRequirementAgentConnector_ms": 0.4401719570159912}, "num_episodes": 18, "episode_return_max": 85.0, "episode_return_min": -356.0, "episode_return_mean": -157.41, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 140.82548389869723, "num_env_steps_trained_throughput_per_sec": 140.82548389869723, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 26875.415, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26874.891, "sample_time_ms": 4808.234, "learn_time_ms": 22019.96, "learn_throughput": 181.653, "synch_weights_time_ms": 41.537}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "4f45b_00000", "date": "2024-08-13_02-54-23", "timestamp": 1723532063, "time_this_iter_s": 28.475874185562134, "time_total_s": 5794.875440359116, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2488af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5794.875440359116, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 88.1075, "ram_util_percent": 83.42249999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.831700382093904, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.353878742298752, "policy_loss": 0.002748362318780175, "vf_loss": 9.350780506234951, "vf_explained_var": 0.0012849207593019678, "kl": 0.009829670867051266, "entropy": 1.0059113374147466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.395895220481214, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.665372689817318, "policy_loss": -0.0008941276419646644, "vf_loss": 8.6662414126926, "vf_explained_var": -0.01782695004548976, "kl": 0.00722641441401579, "entropy": 1.3864642758218069, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 10.0, "episode_reward_min": -383.0, "episode_reward_mean": -190.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 16.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -223.17, "predator_policy": 128.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -240.0, -115.0, -120.0, -237.0, -160.0, -149.0, -15.0, -231.0, -29.0, -142.0, -213.0, -110.0, -33.0, -292.0, -144.0, -207.0, -137.0, -213.0, -118.0, -328.0, -30.0, -134.0, -58.0, -183.0, -313.0, -51.0, -52.0, -47.0, -154.0, -66.0, 10.0, -48.0, -222.0, -295.0, -151.0, -142.0, -269.0, -227.0, -214.0, -49.0, -324.0, -213.0, -295.0, -239.0, -268.0, -25.0, -296.0, -55.0, -255.0, -133.0, -258.0, -174.0, -319.0, -240.0, -195.0, -305.0, -223.0, -83.0, -33.0, -290.0, -306.0, -283.0, -243.0, -356.0, -19.0, -141.0, -236.0, -293.0, -314.0, -244.0, -78.0, -305.0, -217.0, -224.0, -22.0, -235.0, -293.0, -231.0, -273.0, -78.0, -207.0, -248.0, -210.0, -383.0, -282.0, -228.0, -278.0, -370.0, -187.0, -283.0, -291.0, -43.0, -280.0, -228.0, -297.0, -96.0, -297.0, -228.0, -46.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-42.0, 0.0, -173.0, -254.0, -115.0, -188.0, -229.0, -59.0, -221.0, -256.0, -152.0, -156.0, -178.0, -159.0, -83.0, -29.0, -255.0, -203.0, 0.0, -120.0, -256.0, -129.0, -261.0, -174.0, -78.0, -208.0, -168.0, 0.0, -319.0, -271.0, -135.0, -194.0, -254.0, -196.0, -183.0, -128.0, -289.0, -166.0, -84.0, -236.0, -307.0, -328.0, -34.0, -158.0, -132.0, -164.0, -263.0, 0.0, -156.0, -282.0, -350.0, -295.0, -318.0, -6.0, -202.0, 0.0, -169.0, -34.0, -184.0, -208.0, 0.0, -318.0, -130.0, 0.0, -20.0, -199.0, -255.0, -257.0, -308.0, -287.0, -173.0, -211.0, -199.0, -173.0, -237.0, -296.0, -280.0, -232.0, -355.0, -139.0, -306.0, -4.0, -300.0, -358.0, -202.0, -272.0, -332.0, -303.0, -274.0, -236.0, -292.0, -250.0, -261.0, 0.0, -317.0, -284.0, -339.0, 0.0, -292.0, -200.0, -200.0, -176.0, -194.0, -339.0, -146.0, -234.0, -362.0, -296.0, -248.0, -253.0, -203.0, -251.0, -317.0, -275.0, -234.0, -298.0, -298.0, -2.0, -230.0, 0.0, -270.0, -331.0, -317.0, -318.0, -288.0, -304.0, -283.0, -234.0, -335.0, -386.0, -354.0, 0.0, -152.0, -203.0, -317.0, -231.0, -318.0, -289.0, -324.0, -315.0, -302.0, -225.0, -373.0, 0.0, -319.0, -292.0, -268.0, -229.0, -309.0, -217.0, -300.0, -2.0, -188.0, -287.0, -290.0, -324.0, -218.0, -281.0, -307.0, -282.0, 0.0, -313.0, -292.0, -200.0, -331.0, -249.0, -217.0, -291.0, -378.0, -338.0, -280.0, -286.0, -260.0, -249.0, -279.0, -313.0, -390.0, -352.0, -200.0, -272.0, -270.0, -360.0, -276.0, -314.0, -338.0, -2.0, -293.0, -285.0, -324.0, -186.0, -315.0, -283.0, -25.0, -319.0, -293.0, -313.0, -285.0, -234.0, -209.0, 0.0], "policy_predator_policy_reward": [16.0, 26.0, 76.0, 111.0, 87.0, 101.0, 55.0, 113.0, 135.0, 105.0, 81.0, 67.0, 103.0, 85.0, 37.0, 60.0, 123.0, 104.0, 50.0, 41.0, 145.0, 98.0, 102.0, 120.0, 103.0, 73.0, 64.0, 71.0, 158.0, 140.0, 85.0, 100.0, 137.0, 106.0, 86.0, 88.0, 98.0, 144.0, 96.0, 106.0, 155.0, 152.0, 90.0, 72.0, 86.0, 76.0, 127.0, 78.0, 132.0, 123.0, 172.0, 160.0, 155.0, 118.0, 84.0, 66.0, 81.0, 75.0, 111.0, 127.0, 162.0, 90.0, 80.0, 60.0, 110.0, 61.0, 155.0, 135.0, 159.0, 141.0, 125.0, 108.0, 132.0, 98.0, 133.0, 131.0, 140.0, 145.0, 172.0, 108.0, 140.0, 121.0, 183.0, 151.0, 116.0, 145.0, 174.0, 166.0, 137.0, 134.0, 152.0, 122.0, 102.0, 134.0, 139.0, 166.0, 166.0, 118.0, 115.0, 122.0, 119.0, 124.0, 144.0, 131.0, 67.0, 139.0, 167.0, 172.0, 117.0, 144.0, 131.0, 128.0, 156.0, 131.0, 161.0, 148.0, 104.0, 113.0, 72.0, 125.0, 165.0, 146.0, 159.0, 170.0, 143.0, 166.0, 146.0, 128.0, 179.0, 186.0, 166.0, 169.0, 117.0, 97.0, 161.0, 151.0, 158.0, 156.0, 155.0, 170.0, 148.0, 135.0, 126.0, 169.0, 150.0, 156.0, 139.0, 141.0, 157.0, 145.0, 140.0, 140.0, 104.0, 136.0, 160.0, 161.0, 130.0, 138.0, 165.0, 151.0, 73.0, 162.0, 144.0, 141.0, 171.0, 161.0, 145.0, 153.0, 154.0, 179.0, 180.0, 104.0, 150.0, 131.0, 161.0, 153.0, 184.0, 188.0, 146.0, 139.0, 158.0, 189.0, 131.0, 168.0, 141.0, 156.0, 113.0, 185.0, 148.0, 134.0, 165.0, 136.0, 83.0, 165.0, 157.0, 152.0, 141.0, 150.0, 63.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6357017033500654, "mean_inference_ms": 32.477737793905504, "mean_action_processing_ms": 0.7369020430478074, "mean_env_wait_ms": 0.5692746566928742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017715811729431152, "StateBufferConnector_ms": 0.015277385711669922, "ViewRequirementAgentConnector_ms": 0.42315876483917236}, "num_episodes": 18, "episode_return_max": 10.0, "episode_return_min": -383.0, "episode_return_mean": -190.24, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.88327815787338, "num_env_steps_trained_throughput_per_sec": 151.88327815787338, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 27054.744, "restore_workers_time_ms": 0.029, "training_step_time_ms": 27054.218, "sample_time_ms": 4896.016, "learn_time_ms": 22111.449, "learn_throughput": 180.902, "synch_weights_time_ms": 41.378}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "4f45b_00000", "date": "2024-08-13_02-54-49", "timestamp": 1723532089, "time_this_iter_s": 26.41857886314392, "time_total_s": 5821.2940192222595, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb7160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5821.2940192222595, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 86.68421052631578, "ram_util_percent": 83.34210526315788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.91175698060838, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.331425809607934, "policy_loss": 0.0016646138229776944, "vf_loss": 9.329485150493642, "vf_explained_var": -0.0038084167336660717, "kl": 0.007754917019179201, "entropy": 1.0140240343474838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.134174072001346, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.302802035165211, "policy_loss": -0.0026681145419066073, "vf_loss": 9.305416599152581, "vf_explained_var": 0.003111041191393736, "kl": 0.015226526154812296, "entropy": 1.3547667177896652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 10.0, "episode_reward_min": -384.0, "episode_reward_mean": -206.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 54.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -243.82, "predator_policy": 140.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-134.0, -58.0, -183.0, -313.0, -51.0, -52.0, -47.0, -154.0, -66.0, 10.0, -48.0, -222.0, -295.0, -151.0, -142.0, -269.0, -227.0, -214.0, -49.0, -324.0, -213.0, -295.0, -239.0, -268.0, -25.0, -296.0, -55.0, -255.0, -133.0, -258.0, -174.0, -319.0, -240.0, -195.0, -305.0, -223.0, -83.0, -33.0, -290.0, -306.0, -283.0, -243.0, -356.0, -19.0, -141.0, -236.0, -293.0, -314.0, -244.0, -78.0, -305.0, -217.0, -224.0, -22.0, -235.0, -293.0, -231.0, -273.0, -78.0, -207.0, -248.0, -210.0, -383.0, -282.0, -228.0, -278.0, -370.0, -187.0, -283.0, -291.0, -43.0, -280.0, -228.0, -297.0, -96.0, -297.0, -228.0, -46.0, -320.0, -339.0, -341.0, -244.0, -291.0, -347.0, -63.0, -149.0, -277.0, -39.0, -384.0, -241.0, -356.0, -211.0, -14.0, -286.0, -76.0, -344.0, 2.0, -280.0, -241.0, -85.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-132.0, -164.0, -263.0, 0.0, -156.0, -282.0, -350.0, -295.0, -318.0, -6.0, -202.0, 0.0, -169.0, -34.0, -184.0, -208.0, 0.0, -318.0, -130.0, 0.0, -20.0, -199.0, -255.0, -257.0, -308.0, -287.0, -173.0, -211.0, -199.0, -173.0, -237.0, -296.0, -280.0, -232.0, -355.0, -139.0, -306.0, -4.0, -300.0, -358.0, -202.0, -272.0, -332.0, -303.0, -274.0, -236.0, -292.0, -250.0, -261.0, 0.0, -317.0, -284.0, -339.0, 0.0, -292.0, -200.0, -200.0, -176.0, -194.0, -339.0, -146.0, -234.0, -362.0, -296.0, -248.0, -253.0, -203.0, -251.0, -317.0, -275.0, -234.0, -298.0, -298.0, -2.0, -230.0, 0.0, -270.0, -331.0, -317.0, -318.0, -288.0, -304.0, -283.0, -234.0, -335.0, -386.0, -354.0, 0.0, -152.0, -203.0, -317.0, -231.0, -318.0, -289.0, -324.0, -315.0, -302.0, -225.0, -373.0, 0.0, -319.0, -292.0, -268.0, -229.0, -309.0, -217.0, -300.0, -2.0, -188.0, -287.0, -290.0, -324.0, -218.0, -281.0, -307.0, -282.0, 0.0, -313.0, -292.0, -200.0, -331.0, -249.0, -217.0, -291.0, -378.0, -338.0, -280.0, -286.0, -260.0, -249.0, -279.0, -313.0, -390.0, -352.0, -200.0, -272.0, -270.0, -360.0, -276.0, -314.0, -338.0, -2.0, -293.0, -285.0, -324.0, -186.0, -315.0, -283.0, -25.0, -319.0, -293.0, -313.0, -285.0, -234.0, -209.0, 0.0, -302.0, -349.0, -335.0, -313.0, -334.0, -356.0, -282.0, -276.0, -282.0, -329.0, -338.0, -373.0, -6.0, -290.0, -343.0, -116.0, -306.0, -309.0, -256.0, 0.0, -394.0, -362.0, -239.0, -276.0, -326.0, -324.0, -251.0, -254.0, -357.0, 0.0, -288.0, -298.0, -244.0, -48.0, -384.0, -311.0, -125.0, 0.0, -287.0, -317.0, -311.0, -233.0, -372.0, -62.0], "policy_predator_policy_reward": [86.0, 76.0, 127.0, 78.0, 132.0, 123.0, 172.0, 160.0, 155.0, 118.0, 84.0, 66.0, 81.0, 75.0, 111.0, 127.0, 162.0, 90.0, 80.0, 60.0, 110.0, 61.0, 155.0, 135.0, 159.0, 141.0, 125.0, 108.0, 132.0, 98.0, 133.0, 131.0, 140.0, 145.0, 172.0, 108.0, 140.0, 121.0, 183.0, 151.0, 116.0, 145.0, 174.0, 166.0, 137.0, 134.0, 152.0, 122.0, 102.0, 134.0, 139.0, 166.0, 166.0, 118.0, 115.0, 122.0, 119.0, 124.0, 144.0, 131.0, 67.0, 139.0, 167.0, 172.0, 117.0, 144.0, 131.0, 128.0, 156.0, 131.0, 161.0, 148.0, 104.0, 113.0, 72.0, 125.0, 165.0, 146.0, 159.0, 170.0, 143.0, 166.0, 146.0, 128.0, 179.0, 186.0, 166.0, 169.0, 117.0, 97.0, 161.0, 151.0, 158.0, 156.0, 155.0, 170.0, 148.0, 135.0, 126.0, 169.0, 150.0, 156.0, 139.0, 141.0, 157.0, 145.0, 140.0, 140.0, 104.0, 136.0, 160.0, 161.0, 130.0, 138.0, 165.0, 151.0, 73.0, 162.0, 144.0, 141.0, 171.0, 161.0, 145.0, 153.0, 154.0, 179.0, 180.0, 104.0, 150.0, 131.0, 161.0, 153.0, 184.0, 188.0, 146.0, 139.0, 158.0, 189.0, 131.0, 168.0, 141.0, 156.0, 113.0, 185.0, 148.0, 134.0, 165.0, 136.0, 83.0, 165.0, 157.0, 152.0, 141.0, 150.0, 63.0, 100.0, 173.0, 158.0, 141.0, 168.0, 163.0, 186.0, 168.0, 146.0, 159.0, 161.0, 198.0, 166.0, 136.0, 97.0, 148.0, 162.0, 170.0, 168.0, 118.0, 99.0, 197.0, 175.0, 118.0, 156.0, 174.0, 120.0, 130.0, 164.0, 178.0, 165.0, 131.0, 169.0, 128.0, 88.0, 159.0, 192.0, 73.0, 54.0, 166.0, 158.0, 159.0, 144.0, 175.0, 174.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6396764674578466, "mean_inference_ms": 32.07974355200313, "mean_action_processing_ms": 0.7362491547318537, "mean_env_wait_ms": 0.5703914944979546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01878535747528076, "StateBufferConnector_ms": 0.01521289348602295, "ViewRequirementAgentConnector_ms": 0.3738621473312378}, "num_episodes": 22, "episode_return_max": 10.0, "episode_return_min": -384.0, "episode_return_mean": -206.87, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 138.17164787560841, "num_env_steps_trained_throughput_per_sec": 138.17164787560841, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 27468.019, "restore_workers_time_ms": 0.028, "training_step_time_ms": 27467.493, "sample_time_ms": 4953.635, "learn_time_ms": 22465.881, "learn_throughput": 178.048, "synch_weights_time_ms": 41.802}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "4f45b_00000", "date": "2024-08-13_02-55-18", "timestamp": 1723532118, "time_this_iter_s": 28.98085308074951, "time_total_s": 5850.274872303009, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24d8820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5850.274872303009, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 89.66585365853659, "ram_util_percent": 83.46097560975609}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.910991870308364, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.30629522585995, "policy_loss": 0.012360613237420916, "vf_loss": 9.293270221589104, "vf_explained_var": -0.008764535977096154, "kl": 0.018664930795048783, "entropy": 1.0928393423241913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5623308672791434, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.299562768078355, "policy_loss": -0.005662657563431711, "vf_loss": 8.305180117188307, "vf_explained_var": 0.04696789336582971, "kl": 0.012880435655914367, "entropy": 1.300484000375031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 2.0, "episode_reward_min": -384.0, "episode_reward_mean": -220.72, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 54.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -257.7, "predator_policy": 147.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.0, -324.0, -213.0, -295.0, -239.0, -268.0, -25.0, -296.0, -55.0, -255.0, -133.0, -258.0, -174.0, -319.0, -240.0, -195.0, -305.0, -223.0, -83.0, -33.0, -290.0, -306.0, -283.0, -243.0, -356.0, -19.0, -141.0, -236.0, -293.0, -314.0, -244.0, -78.0, -305.0, -217.0, -224.0, -22.0, -235.0, -293.0, -231.0, -273.0, -78.0, -207.0, -248.0, -210.0, -383.0, -282.0, -228.0, -278.0, -370.0, -187.0, -283.0, -291.0, -43.0, -280.0, -228.0, -297.0, -96.0, -297.0, -228.0, -46.0, -320.0, -339.0, -341.0, -244.0, -291.0, -347.0, -63.0, -149.0, -277.0, -39.0, -384.0, -241.0, -356.0, -211.0, -14.0, -286.0, -76.0, -344.0, 2.0, -280.0, -241.0, -85.0, -40.0, -274.0, -301.0, -246.0, -282.0, -340.0, -316.0, -53.0, -255.0, -74.0, -278.0, -130.0, -20.0, -312.0, -179.0, -327.0, -254.0, -320.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-306.0, -4.0, -300.0, -358.0, -202.0, -272.0, -332.0, -303.0, -274.0, -236.0, -292.0, -250.0, -261.0, 0.0, -317.0, -284.0, -339.0, 0.0, -292.0, -200.0, -200.0, -176.0, -194.0, -339.0, -146.0, -234.0, -362.0, -296.0, -248.0, -253.0, -203.0, -251.0, -317.0, -275.0, -234.0, -298.0, -298.0, -2.0, -230.0, 0.0, -270.0, -331.0, -317.0, -318.0, -288.0, -304.0, -283.0, -234.0, -335.0, -386.0, -354.0, 0.0, -152.0, -203.0, -317.0, -231.0, -318.0, -289.0, -324.0, -315.0, -302.0, -225.0, -373.0, 0.0, -319.0, -292.0, -268.0, -229.0, -309.0, -217.0, -300.0, -2.0, -188.0, -287.0, -290.0, -324.0, -218.0, -281.0, -307.0, -282.0, 0.0, -313.0, -292.0, -200.0, -331.0, -249.0, -217.0, -291.0, -378.0, -338.0, -280.0, -286.0, -260.0, -249.0, -279.0, -313.0, -390.0, -352.0, -200.0, -272.0, -270.0, -360.0, -276.0, -314.0, -338.0, -2.0, -293.0, -285.0, -324.0, -186.0, -315.0, -283.0, -25.0, -319.0, -293.0, -313.0, -285.0, -234.0, -209.0, 0.0, -302.0, -349.0, -335.0, -313.0, -334.0, -356.0, -282.0, -276.0, -282.0, -329.0, -338.0, -373.0, -6.0, -290.0, -343.0, -116.0, -306.0, -309.0, -256.0, 0.0, -394.0, -362.0, -239.0, -276.0, -326.0, -324.0, -251.0, -254.0, -357.0, 0.0, -288.0, -298.0, -244.0, -48.0, -384.0, -311.0, -125.0, 0.0, -287.0, -317.0, -311.0, -233.0, -372.0, -62.0, 0.0, -282.0, -328.0, -289.0, -381.0, -293.0, -314.0, -264.0, -303.0, -318.0, -328.0, -325.0, -304.0, -388.0, -288.0, -20.0, -247.0, -299.0, -255.0, 0.0, -350.0, -298.0, -66.0, -365.0, -374.0, 0.0, -254.0, -368.0, -185.0, -208.0, -353.0, -340.0, -283.0, -257.0, -351.0, -330.0], "policy_predator_policy_reward": [140.0, 121.0, 183.0, 151.0, 116.0, 145.0, 174.0, 166.0, 137.0, 134.0, 152.0, 122.0, 102.0, 134.0, 139.0, 166.0, 166.0, 118.0, 115.0, 122.0, 119.0, 124.0, 144.0, 131.0, 67.0, 139.0, 167.0, 172.0, 117.0, 144.0, 131.0, 128.0, 156.0, 131.0, 161.0, 148.0, 104.0, 113.0, 72.0, 125.0, 165.0, 146.0, 159.0, 170.0, 143.0, 166.0, 146.0, 128.0, 179.0, 186.0, 166.0, 169.0, 117.0, 97.0, 161.0, 151.0, 158.0, 156.0, 155.0, 170.0, 148.0, 135.0, 126.0, 169.0, 150.0, 156.0, 139.0, 141.0, 157.0, 145.0, 140.0, 140.0, 104.0, 136.0, 160.0, 161.0, 130.0, 138.0, 165.0, 151.0, 73.0, 162.0, 144.0, 141.0, 171.0, 161.0, 145.0, 153.0, 154.0, 179.0, 180.0, 104.0, 150.0, 131.0, 161.0, 153.0, 184.0, 188.0, 146.0, 139.0, 158.0, 189.0, 131.0, 168.0, 141.0, 156.0, 113.0, 185.0, 148.0, 134.0, 165.0, 136.0, 83.0, 165.0, 157.0, 152.0, 141.0, 150.0, 63.0, 100.0, 173.0, 158.0, 141.0, 168.0, 163.0, 186.0, 168.0, 146.0, 159.0, 161.0, 198.0, 166.0, 136.0, 97.0, 148.0, 162.0, 170.0, 168.0, 118.0, 99.0, 197.0, 175.0, 118.0, 156.0, 174.0, 120.0, 130.0, 164.0, 178.0, 165.0, 131.0, 169.0, 128.0, 88.0, 159.0, 192.0, 73.0, 54.0, 166.0, 158.0, 159.0, 144.0, 175.0, 174.0, 118.0, 124.0, 187.0, 156.0, 179.0, 194.0, 167.0, 165.0, 162.0, 177.0, 129.0, 184.0, 191.0, 185.0, 146.0, 109.0, 160.0, 131.0, 95.0, 86.0, 186.0, 184.0, 142.0, 159.0, 170.0, 184.0, 143.0, 167.0, 99.0, 115.0, 184.0, 182.0, 149.0, 137.0, 190.0, 171.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6463461943927065, "mean_inference_ms": 31.766788816363178, "mean_action_processing_ms": 0.7382681437667499, "mean_env_wait_ms": 0.5723277287485111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01687026023864746, "StateBufferConnector_ms": 0.010818123817443848, "ViewRequirementAgentConnector_ms": 0.3376508951187134}, "num_episodes": 18, "episode_return_max": 2.0, "episode_return_min": -384.0, "episode_return_mean": -220.72, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.86090584132106, "num_env_steps_trained_throughput_per_sec": 146.86090584132106, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 27614.621, "restore_workers_time_ms": 0.028, "training_step_time_ms": 27614.096, "sample_time_ms": 4954.486, "learn_time_ms": 22610.7, "learn_throughput": 176.907, "synch_weights_time_ms": 42.734}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "4f45b_00000", "date": "2024-08-13_02-55-46", "timestamp": 1723532146, "time_this_iter_s": 27.330718994140625, "time_total_s": 5877.60559129715, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2428550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5877.60559129715, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 87.75263157894737, "ram_util_percent": 83.11578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9989516913496628, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.912849567050026, "policy_loss": -0.0012320462212695804, "vf_loss": 8.91385421349258, "vf_explained_var": 0.00015660868119941188, "kl": 0.0063885686037337625, "entropy": 1.0785975546433182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1361005894879184, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.5806874093555265, "policy_loss": -0.00843772672698217, "vf_loss": 6.5890742304463865, "vf_explained_var": 0.086923433958538, "kl": 0.01447348469207771, "entropy": 1.2740776595615206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -384.0, "episode_reward_mean": -205.15, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -244.68, "predator_policy": 142.105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-243.0, -356.0, -19.0, -141.0, -236.0, -293.0, -314.0, -244.0, -78.0, -305.0, -217.0, -224.0, -22.0, -235.0, -293.0, -231.0, -273.0, -78.0, -207.0, -248.0, -210.0, -383.0, -282.0, -228.0, -278.0, -370.0, -187.0, -283.0, -291.0, -43.0, -280.0, -228.0, -297.0, -96.0, -297.0, -228.0, -46.0, -320.0, -339.0, -341.0, -244.0, -291.0, -347.0, -63.0, -149.0, -277.0, -39.0, -384.0, -241.0, -356.0, -211.0, -14.0, -286.0, -76.0, -344.0, 2.0, -280.0, -241.0, -85.0, -40.0, -274.0, -301.0, -246.0, -282.0, -340.0, -316.0, -53.0, -255.0, -74.0, -278.0, -130.0, -20.0, -312.0, -179.0, -327.0, -254.0, -320.0, -69.0, -10.0, -61.0, -186.0, -302.0, 0.0, -220.0, -224.0, -359.0, -49.0, -43.0, 6.0, -8.0, -274.0, -298.0, -168.0, -189.0, -28.0, -53.0, 22.0, -345.0, -157.0, -289.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-283.0, -234.0, -335.0, -386.0, -354.0, 0.0, -152.0, -203.0, -317.0, -231.0, -318.0, -289.0, -324.0, -315.0, -302.0, -225.0, -373.0, 0.0, -319.0, -292.0, -268.0, -229.0, -309.0, -217.0, -300.0, -2.0, -188.0, -287.0, -290.0, -324.0, -218.0, -281.0, -307.0, -282.0, 0.0, -313.0, -292.0, -200.0, -331.0, -249.0, -217.0, -291.0, -378.0, -338.0, -280.0, -286.0, -260.0, -249.0, -279.0, -313.0, -390.0, -352.0, -200.0, -272.0, -270.0, -360.0, -276.0, -314.0, -338.0, -2.0, -293.0, -285.0, -324.0, -186.0, -315.0, -283.0, -25.0, -319.0, -293.0, -313.0, -285.0, -234.0, -209.0, 0.0, -302.0, -349.0, -335.0, -313.0, -334.0, -356.0, -282.0, -276.0, -282.0, -329.0, -338.0, -373.0, -6.0, -290.0, -343.0, -116.0, -306.0, -309.0, -256.0, 0.0, -394.0, -362.0, -239.0, -276.0, -326.0, -324.0, -251.0, -254.0, -357.0, 0.0, -288.0, -298.0, -244.0, -48.0, -384.0, -311.0, -125.0, 0.0, -287.0, -317.0, -311.0, -233.0, -372.0, -62.0, 0.0, -282.0, -328.0, -289.0, -381.0, -293.0, -314.0, -264.0, -303.0, -318.0, -328.0, -325.0, -304.0, -388.0, -288.0, -20.0, -247.0, -299.0, -255.0, 0.0, -350.0, -298.0, -66.0, -365.0, -374.0, 0.0, -254.0, -368.0, -185.0, -208.0, -353.0, -340.0, -283.0, -257.0, -351.0, -330.0, 0.0, -355.0, 0.0, -54.0, -261.0, 0.0, -273.0, -176.0, -308.0, -303.0, 0.0, 0.0, -260.0, -239.0, -285.0, -210.0, -343.0, -366.0, -153.0, -32.0, 0.0, -341.0, -2.0, -256.0, 0.0, -16.0, -222.0, -345.0, -298.0, -318.0, -345.0, -153.0, -193.0, -306.0, 0.0, -239.0, -231.0, 0.0, -12.0, -1.0, -370.0, -335.0, -146.0, -274.0, -318.0, -263.0], "policy_predator_policy_reward": [146.0, 128.0, 179.0, 186.0, 166.0, 169.0, 117.0, 97.0, 161.0, 151.0, 158.0, 156.0, 155.0, 170.0, 148.0, 135.0, 126.0, 169.0, 150.0, 156.0, 139.0, 141.0, 157.0, 145.0, 140.0, 140.0, 104.0, 136.0, 160.0, 161.0, 130.0, 138.0, 165.0, 151.0, 73.0, 162.0, 144.0, 141.0, 171.0, 161.0, 145.0, 153.0, 154.0, 179.0, 180.0, 104.0, 150.0, 131.0, 161.0, 153.0, 184.0, 188.0, 146.0, 139.0, 158.0, 189.0, 131.0, 168.0, 141.0, 156.0, 113.0, 185.0, 148.0, 134.0, 165.0, 136.0, 83.0, 165.0, 157.0, 152.0, 141.0, 150.0, 63.0, 100.0, 173.0, 158.0, 141.0, 168.0, 163.0, 186.0, 168.0, 146.0, 159.0, 161.0, 198.0, 166.0, 136.0, 97.0, 148.0, 162.0, 170.0, 168.0, 118.0, 99.0, 197.0, 175.0, 118.0, 156.0, 174.0, 120.0, 130.0, 164.0, 178.0, 165.0, 131.0, 169.0, 128.0, 88.0, 159.0, 192.0, 73.0, 54.0, 166.0, 158.0, 159.0, 144.0, 175.0, 174.0, 118.0, 124.0, 187.0, 156.0, 179.0, 194.0, 167.0, 165.0, 162.0, 177.0, 129.0, 184.0, 191.0, 185.0, 146.0, 109.0, 160.0, 131.0, 95.0, 86.0, 186.0, 184.0, 142.0, 159.0, 170.0, 184.0, 143.0, 167.0, 99.0, 115.0, 184.0, 182.0, 149.0, 137.0, 190.0, 171.0, 152.0, 134.0, 27.0, 17.0, 121.0, 79.0, 146.0, 117.0, 145.0, 164.0, 0.0, 0.0, 139.0, 140.0, 131.0, 140.0, 169.0, 181.0, 80.0, 56.0, 143.0, 155.0, 126.0, 138.0, 0.0, 8.0, 149.0, 144.0, 156.0, 162.0, 164.0, 166.0, 153.0, 157.0, 95.0, 116.0, 79.0, 99.0, 17.0, 18.0, 182.0, 178.0, 155.0, 108.0, 151.0, 141.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6502744083292658, "mean_inference_ms": 31.360600598973125, "mean_action_processing_ms": 0.7384960933105138, "mean_env_wait_ms": 0.5733981130199918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019976377487182617, "StateBufferConnector_ms": 0.006957292556762695, "ViewRequirementAgentConnector_ms": 0.3022273778915405}, "num_episodes": 23, "episode_return_max": 22.0, "episode_return_min": -384.0, "episode_return_mean": -205.15, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.23872371530922, "num_env_steps_trained_throughput_per_sec": 144.23872371530922, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 27752.41, "restore_workers_time_ms": 0.028, "training_step_time_ms": 27751.881, "sample_time_ms": 5012.138, "learn_time_ms": 22690.418, "learn_throughput": 176.286, "synch_weights_time_ms": 42.97}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "4f45b_00000", "date": "2024-08-13_02-56-13", "timestamp": 1723532173, "time_this_iter_s": 27.78495502471924, "time_total_s": 5905.390546321869, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cd5700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5905.390546321869, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 86.80769230769232, "ram_util_percent": 83.1794871794872}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2759934568058244, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.750382503630624, "policy_loss": -0.0017264950552354098, "vf_loss": 8.751647277105421, "vf_explained_var": -0.0057589336362465346, "kl": 0.012971981751528156, "entropy": 1.0146078551572466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1410541524253195, "cur_kl_coeff": 0.003515625000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.46934750256715, "policy_loss": -0.014021487896227175, "vf_loss": 4.483256311012954, "vf_explained_var": 0.07047466276183961, "kl": 0.03205179715198314, "entropy": 1.148728716941107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -384.0, "episode_reward_mean": -183.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -223.42, "predator_policy": 131.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-207.0, -248.0, -210.0, -383.0, -282.0, -228.0, -278.0, -370.0, -187.0, -283.0, -291.0, -43.0, -280.0, -228.0, -297.0, -96.0, -297.0, -228.0, -46.0, -320.0, -339.0, -341.0, -244.0, -291.0, -347.0, -63.0, -149.0, -277.0, -39.0, -384.0, -241.0, -356.0, -211.0, -14.0, -286.0, -76.0, -344.0, 2.0, -280.0, -241.0, -85.0, -40.0, -274.0, -301.0, -246.0, -282.0, -340.0, -316.0, -53.0, -255.0, -74.0, -278.0, -130.0, -20.0, -312.0, -179.0, -327.0, -254.0, -320.0, -69.0, -10.0, -61.0, -186.0, -302.0, 0.0, -220.0, -224.0, -359.0, -49.0, -43.0, 6.0, -8.0, -274.0, -298.0, -168.0, -189.0, -28.0, -53.0, 22.0, -345.0, -157.0, -289.0, -61.0, -148.0, -240.0, -36.0, -170.0, -47.0, -48.0, -55.0, -6.0, -35.0, -115.0, -216.0, -68.0, -19.0, -127.0, -32.0, -144.0, -48.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-292.0, -200.0, -331.0, -249.0, -217.0, -291.0, -378.0, -338.0, -280.0, -286.0, -260.0, -249.0, -279.0, -313.0, -390.0, -352.0, -200.0, -272.0, -270.0, -360.0, -276.0, -314.0, -338.0, -2.0, -293.0, -285.0, -324.0, -186.0, -315.0, -283.0, -25.0, -319.0, -293.0, -313.0, -285.0, -234.0, -209.0, 0.0, -302.0, -349.0, -335.0, -313.0, -334.0, -356.0, -282.0, -276.0, -282.0, -329.0, -338.0, -373.0, -6.0, -290.0, -343.0, -116.0, -306.0, -309.0, -256.0, 0.0, -394.0, -362.0, -239.0, -276.0, -326.0, -324.0, -251.0, -254.0, -357.0, 0.0, -288.0, -298.0, -244.0, -48.0, -384.0, -311.0, -125.0, 0.0, -287.0, -317.0, -311.0, -233.0, -372.0, -62.0, 0.0, -282.0, -328.0, -289.0, -381.0, -293.0, -314.0, -264.0, -303.0, -318.0, -328.0, -325.0, -304.0, -388.0, -288.0, -20.0, -247.0, -299.0, -255.0, 0.0, -350.0, -298.0, -66.0, -365.0, -374.0, 0.0, -254.0, -368.0, -185.0, -208.0, -353.0, -340.0, -283.0, -257.0, -351.0, -330.0, 0.0, -355.0, 0.0, -54.0, -261.0, 0.0, -273.0, -176.0, -308.0, -303.0, 0.0, 0.0, -260.0, -239.0, -285.0, -210.0, -343.0, -366.0, -153.0, -32.0, 0.0, -341.0, -2.0, -256.0, 0.0, -16.0, -222.0, -345.0, -298.0, -318.0, -345.0, -153.0, -193.0, -306.0, 0.0, -239.0, -231.0, 0.0, -12.0, -1.0, -370.0, -335.0, -146.0, -274.0, -318.0, -263.0, 0.0, -207.0, -161.0, -273.0, -276.0, -213.0, -28.0, -44.0, -304.0, -149.0, 0.0, -220.0, 0.0, -219.0, 0.0, -246.0, 0.0, -54.0, 0.0, -170.0, -149.0, -132.0, -184.0, -306.0, -136.0, -40.0, -138.0, 0.0, -114.0, -122.0, 0.0, -180.0, -319.0, -119.0, -99.0, -213.0], "policy_predator_policy_reward": [144.0, 141.0, 171.0, 161.0, 145.0, 153.0, 154.0, 179.0, 180.0, 104.0, 150.0, 131.0, 161.0, 153.0, 184.0, 188.0, 146.0, 139.0, 158.0, 189.0, 131.0, 168.0, 141.0, 156.0, 113.0, 185.0, 148.0, 134.0, 165.0, 136.0, 83.0, 165.0, 157.0, 152.0, 141.0, 150.0, 63.0, 100.0, 173.0, 158.0, 141.0, 168.0, 163.0, 186.0, 168.0, 146.0, 159.0, 161.0, 198.0, 166.0, 136.0, 97.0, 148.0, 162.0, 170.0, 168.0, 118.0, 99.0, 197.0, 175.0, 118.0, 156.0, 174.0, 120.0, 130.0, 164.0, 178.0, 165.0, 131.0, 169.0, 128.0, 88.0, 159.0, 192.0, 73.0, 54.0, 166.0, 158.0, 159.0, 144.0, 175.0, 174.0, 118.0, 124.0, 187.0, 156.0, 179.0, 194.0, 167.0, 165.0, 162.0, 177.0, 129.0, 184.0, 191.0, 185.0, 146.0, 109.0, 160.0, 131.0, 95.0, 86.0, 186.0, 184.0, 142.0, 159.0, 170.0, 184.0, 143.0, 167.0, 99.0, 115.0, 184.0, 182.0, 149.0, 137.0, 190.0, 171.0, 152.0, 134.0, 27.0, 17.0, 121.0, 79.0, 146.0, 117.0, 145.0, 164.0, 0.0, 0.0, 139.0, 140.0, 131.0, 140.0, 169.0, 181.0, 80.0, 56.0, 143.0, 155.0, 126.0, 138.0, 0.0, 8.0, 149.0, 144.0, 156.0, 162.0, 164.0, 166.0, 153.0, 157.0, 95.0, 116.0, 79.0, 99.0, 17.0, 18.0, 182.0, 178.0, 155.0, 108.0, 151.0, 141.0, 75.0, 71.0, 167.0, 119.0, 109.0, 140.0, 14.0, 22.0, 156.0, 127.0, 86.0, 87.0, 97.0, 74.0, 85.0, 106.0, 20.0, 28.0, 86.0, 49.0, 88.0, 78.0, 150.0, 124.0, 64.0, 44.0, 56.0, 63.0, 54.0, 55.0, 72.0, 76.0, 147.0, 147.0, 132.0, 132.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6549248725589043, "mean_inference_ms": 31.054244106170792, "mean_action_processing_ms": 0.7391973336721287, "mean_env_wait_ms": 0.5749879393818693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02055668830871582, "StateBufferConnector_ms": 0.006476998329162598, "ViewRequirementAgentConnector_ms": 0.3276689052581787}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -384.0, "episode_return_mean": -183.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.90806208747503, "num_env_steps_trained_throughput_per_sec": 152.90806208747503, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 27840.237, "restore_workers_time_ms": 0.028, "training_step_time_ms": 27839.706, "sample_time_ms": 5100.157, "learn_time_ms": 22691.717, "learn_throughput": 176.276, "synch_weights_time_ms": 41.653}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "4f45b_00000", "date": "2024-08-13_02-56-40", "timestamp": 1723532200, "time_this_iter_s": 26.22982382774353, "time_total_s": 5931.620370149612, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b243e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5931.620370149612, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 84.33684210526314, "ram_util_percent": 83.25000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6643985380255986, "cur_kl_coeff": 0.03559570312499998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.867822618080826, "policy_loss": 0.012080344656191608, "vf_loss": 8.85378674804849, "vf_explained_var": -0.05990390001781403, "kl": 0.054936958183923947, "entropy": 0.8512453249522618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.986006735044497, "cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.508952779744668, "policy_loss": -0.003185994181998823, "vf_loss": 1.5121134829268885, "vf_explained_var": 0.05787341140565418, "kl": 0.004796039146405299, "entropy": 1.007423954918271, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -384.0, "episode_reward_mean": -135.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 0.0, "predator_policy": 198.0}, "policy_reward_mean": {"prey_policy": -172.16, "predator_policy": 104.565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-244.0, -291.0, -347.0, -63.0, -149.0, -277.0, -39.0, -384.0, -241.0, -356.0, -211.0, -14.0, -286.0, -76.0, -344.0, 2.0, -280.0, -241.0, -85.0, -40.0, -274.0, -301.0, -246.0, -282.0, -340.0, -316.0, -53.0, -255.0, -74.0, -278.0, -130.0, -20.0, -312.0, -179.0, -327.0, -254.0, -320.0, -69.0, -10.0, -61.0, -186.0, -302.0, 0.0, -220.0, -224.0, -359.0, -49.0, -43.0, 6.0, -8.0, -274.0, -298.0, -168.0, -189.0, -28.0, -53.0, 22.0, -345.0, -157.0, -289.0, -61.0, -148.0, -240.0, -36.0, -170.0, -47.0, -48.0, -55.0, -6.0, -35.0, -115.0, -216.0, -68.0, -19.0, -127.0, -32.0, -144.0, -48.0, -9.0, -8.0, -6.0, -10.0, -12.0, -18.0, -41.0, -98.0, 0.0, -97.0, -33.0, -36.0, -32.0, -12.0, -70.0, -1.0, -36.0, -3.0, -44.0, -1.0, -42.0, -64.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-282.0, -276.0, -282.0, -329.0, -338.0, -373.0, -6.0, -290.0, -343.0, -116.0, -306.0, -309.0, -256.0, 0.0, -394.0, -362.0, -239.0, -276.0, -326.0, -324.0, -251.0, -254.0, -357.0, 0.0, -288.0, -298.0, -244.0, -48.0, -384.0, -311.0, -125.0, 0.0, -287.0, -317.0, -311.0, -233.0, -372.0, -62.0, 0.0, -282.0, -328.0, -289.0, -381.0, -293.0, -314.0, -264.0, -303.0, -318.0, -328.0, -325.0, -304.0, -388.0, -288.0, -20.0, -247.0, -299.0, -255.0, 0.0, -350.0, -298.0, -66.0, -365.0, -374.0, 0.0, -254.0, -368.0, -185.0, -208.0, -353.0, -340.0, -283.0, -257.0, -351.0, -330.0, 0.0, -355.0, 0.0, -54.0, -261.0, 0.0, -273.0, -176.0, -308.0, -303.0, 0.0, 0.0, -260.0, -239.0, -285.0, -210.0, -343.0, -366.0, -153.0, -32.0, 0.0, -341.0, -2.0, -256.0, 0.0, -16.0, -222.0, -345.0, -298.0, -318.0, -345.0, -153.0, -193.0, -306.0, 0.0, -239.0, -231.0, 0.0, -12.0, -1.0, -370.0, -335.0, -146.0, -274.0, -318.0, -263.0, 0.0, -207.0, -161.0, -273.0, -276.0, -213.0, -28.0, -44.0, -304.0, -149.0, 0.0, -220.0, 0.0, -219.0, 0.0, -246.0, 0.0, -54.0, 0.0, -170.0, -149.0, -132.0, -184.0, -306.0, -136.0, -40.0, -138.0, 0.0, -114.0, -122.0, 0.0, -180.0, -319.0, -119.0, -99.0, -213.0, 0.0, -88.0, -57.0, 0.0, -2.0, -27.0, 0.0, -41.0, -8.0, -97.0, -13.0, -23.0, -46.0, -18.0, -54.0, -106.0, 0.0, 0.0, -56.0, -139.0, -42.0, -79.0, -46.0, -26.0, -32.0, -32.0, 0.0, -24.0, -72.0, -79.0, -22.0, 0.0, -45.0, -74.0, 0.0, -37.0, -8.0, -155.0, -53.0, 0.0, -16.0, -94.0, -98.0, -29.0], "policy_predator_policy_reward": [168.0, 146.0, 159.0, 161.0, 198.0, 166.0, 136.0, 97.0, 148.0, 162.0, 170.0, 168.0, 118.0, 99.0, 197.0, 175.0, 118.0, 156.0, 174.0, 120.0, 130.0, 164.0, 178.0, 165.0, 131.0, 169.0, 128.0, 88.0, 159.0, 192.0, 73.0, 54.0, 166.0, 158.0, 159.0, 144.0, 175.0, 174.0, 118.0, 124.0, 187.0, 156.0, 179.0, 194.0, 167.0, 165.0, 162.0, 177.0, 129.0, 184.0, 191.0, 185.0, 146.0, 109.0, 160.0, 131.0, 95.0, 86.0, 186.0, 184.0, 142.0, 159.0, 170.0, 184.0, 143.0, 167.0, 99.0, 115.0, 184.0, 182.0, 149.0, 137.0, 190.0, 171.0, 152.0, 134.0, 27.0, 17.0, 121.0, 79.0, 146.0, 117.0, 145.0, 164.0, 0.0, 0.0, 139.0, 140.0, 131.0, 140.0, 169.0, 181.0, 80.0, 56.0, 143.0, 155.0, 126.0, 138.0, 0.0, 8.0, 149.0, 144.0, 156.0, 162.0, 164.0, 166.0, 153.0, 157.0, 95.0, 116.0, 79.0, 99.0, 17.0, 18.0, 182.0, 178.0, 155.0, 108.0, 151.0, 141.0, 75.0, 71.0, 167.0, 119.0, 109.0, 140.0, 14.0, 22.0, 156.0, 127.0, 86.0, 87.0, 97.0, 74.0, 85.0, 106.0, 20.0, 28.0, 86.0, 49.0, 88.0, 78.0, 150.0, 124.0, 64.0, 44.0, 56.0, 63.0, 54.0, 55.0, 72.0, 76.0, 147.0, 147.0, 132.0, 132.0, 47.0, 32.0, 26.0, 23.0, 12.0, 11.0, 24.0, 7.0, 52.0, 41.0, 13.0, 5.0, 23.0, 0.0, 26.0, 36.0, 0.0, 0.0, 56.0, 42.0, 39.0, 49.0, 13.0, 23.0, 19.0, 13.0, 5.0, 7.0, 46.0, 35.0, 4.0, 17.0, 32.0, 51.0, 18.0, 16.0, 44.0, 75.0, 23.0, 29.0, 26.0, 42.0, 19.0, 44.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6600943907188854, "mean_inference_ms": 30.701033958200046, "mean_action_processing_ms": 0.7395678261735312, "mean_env_wait_ms": 0.5770435212914926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02880680561065674, "StateBufferConnector_ms": 0.006567478179931641, "ViewRequirementAgentConnector_ms": 0.3542013168334961}, "num_episodes": 22, "episode_return_max": 22.0, "episode_return_min": -384.0, "episode_return_mean": -135.19, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.0702423663072, "num_env_steps_trained_throughput_per_sec": 147.0702423663072, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 27983.939, "restore_workers_time_ms": 0.026, "training_step_time_ms": 27983.397, "sample_time_ms": 5184.864, "learn_time_ms": 22751.641, "learn_throughput": 175.811, "synch_weights_time_ms": 41.04}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "4f45b_00000", "date": "2024-08-13_02-57-07", "timestamp": 1723532227, "time_this_iter_s": 27.25666117668152, "time_total_s": 5958.877031326294, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b245b310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5958.877031326294, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 84.58157894736843, "ram_util_percent": 82.93684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.096054691785858, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.709647123145048, "policy_loss": 0.0028466004747700283, "vf_loss": 7.7052660091844185, "vf_explained_var": -0.08059258025790018, "kl": 0.028739902977994065, "entropy": 0.7488818937508518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5150939778124213, "cur_kl_coeff": 0.00263671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.260843343236459, "policy_loss": -0.006434662091156478, "vf_loss": 1.2672557091271435, "vf_explained_var": 0.052181034050290544, "kl": 0.008458450609014612, "entropy": 0.896509446479656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -359.0, "episode_reward_mean": -101.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -388.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 3.0, "predator_policy": 194.0}, "policy_reward_mean": {"prey_policy": -131.81, "predator_policy": 81.16}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.0, -40.0, -274.0, -301.0, -246.0, -282.0, -340.0, -316.0, -53.0, -255.0, -74.0, -278.0, -130.0, -20.0, -312.0, -179.0, -327.0, -254.0, -320.0, -69.0, -10.0, -61.0, -186.0, -302.0, 0.0, -220.0, -224.0, -359.0, -49.0, -43.0, 6.0, -8.0, -274.0, -298.0, -168.0, -189.0, -28.0, -53.0, 22.0, -345.0, -157.0, -289.0, -61.0, -148.0, -240.0, -36.0, -170.0, -47.0, -48.0, -55.0, -6.0, -35.0, -115.0, -216.0, -68.0, -19.0, -127.0, -32.0, -144.0, -48.0, -9.0, -8.0, -6.0, -10.0, -12.0, -18.0, -41.0, -98.0, 0.0, -97.0, -33.0, -36.0, -32.0, -12.0, -70.0, -1.0, -36.0, -3.0, -44.0, -1.0, -42.0, -64.0, -30.0, -18.0, -78.0, -22.0, -8.0, -23.0, -43.0, -6.0, -54.0, -16.0, -10.0, -34.0, -3.0, -66.0, -40.0, -5.0, 4.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-372.0, -62.0, 0.0, -282.0, -328.0, -289.0, -381.0, -293.0, -314.0, -264.0, -303.0, -318.0, -328.0, -325.0, -304.0, -388.0, -288.0, -20.0, -247.0, -299.0, -255.0, 0.0, -350.0, -298.0, -66.0, -365.0, -374.0, 0.0, -254.0, -368.0, -185.0, -208.0, -353.0, -340.0, -283.0, -257.0, -351.0, -330.0, 0.0, -355.0, 0.0, -54.0, -261.0, 0.0, -273.0, -176.0, -308.0, -303.0, 0.0, 0.0, -260.0, -239.0, -285.0, -210.0, -343.0, -366.0, -153.0, -32.0, 0.0, -341.0, -2.0, -256.0, 0.0, -16.0, -222.0, -345.0, -298.0, -318.0, -345.0, -153.0, -193.0, -306.0, 0.0, -239.0, -231.0, 0.0, -12.0, -1.0, -370.0, -335.0, -146.0, -274.0, -318.0, -263.0, 0.0, -207.0, -161.0, -273.0, -276.0, -213.0, -28.0, -44.0, -304.0, -149.0, 0.0, -220.0, 0.0, -219.0, 0.0, -246.0, 0.0, -54.0, 0.0, -170.0, -149.0, -132.0, -184.0, -306.0, -136.0, -40.0, -138.0, 0.0, -114.0, -122.0, 0.0, -180.0, -319.0, -119.0, -99.0, -213.0, 0.0, -88.0, -57.0, 0.0, -2.0, -27.0, 0.0, -41.0, -8.0, -97.0, -13.0, -23.0, -46.0, -18.0, -54.0, -106.0, 0.0, 0.0, -56.0, -139.0, -42.0, -79.0, -46.0, -26.0, -32.0, -32.0, 0.0, -24.0, -72.0, -79.0, -22.0, 0.0, -45.0, -74.0, 0.0, -37.0, -8.0, -155.0, -53.0, 0.0, -16.0, -94.0, -98.0, -29.0, -92.0, 3.0, -25.0, -28.0, -52.0, -54.0, -22.0, -70.0, -8.0, -15.0, -14.0, -35.0, -22.0, -51.0, -12.0, 0.0, -34.0, -78.0, -32.0, 0.0, -11.0, -36.0, -46.0, -35.0, 0.0, -6.0, -74.0, -70.0, -52.0, -34.0, -23.0, 0.0, -32.0, -5.0, 0.0, 0.0], "policy_predator_policy_reward": [175.0, 174.0, 118.0, 124.0, 187.0, 156.0, 179.0, 194.0, 167.0, 165.0, 162.0, 177.0, 129.0, 184.0, 191.0, 185.0, 146.0, 109.0, 160.0, 131.0, 95.0, 86.0, 186.0, 184.0, 142.0, 159.0, 170.0, 184.0, 143.0, 167.0, 99.0, 115.0, 184.0, 182.0, 149.0, 137.0, 190.0, 171.0, 152.0, 134.0, 27.0, 17.0, 121.0, 79.0, 146.0, 117.0, 145.0, 164.0, 0.0, 0.0, 139.0, 140.0, 131.0, 140.0, 169.0, 181.0, 80.0, 56.0, 143.0, 155.0, 126.0, 138.0, 0.0, 8.0, 149.0, 144.0, 156.0, 162.0, 164.0, 166.0, 153.0, 157.0, 95.0, 116.0, 79.0, 99.0, 17.0, 18.0, 182.0, 178.0, 155.0, 108.0, 151.0, 141.0, 75.0, 71.0, 167.0, 119.0, 109.0, 140.0, 14.0, 22.0, 156.0, 127.0, 86.0, 87.0, 97.0, 74.0, 85.0, 106.0, 20.0, 28.0, 86.0, 49.0, 88.0, 78.0, 150.0, 124.0, 64.0, 44.0, 56.0, 63.0, 54.0, 55.0, 72.0, 76.0, 147.0, 147.0, 132.0, 132.0, 47.0, 32.0, 26.0, 23.0, 12.0, 11.0, 24.0, 7.0, 52.0, 41.0, 13.0, 5.0, 23.0, 0.0, 26.0, 36.0, 0.0, 0.0, 56.0, 42.0, 39.0, 49.0, 13.0, 23.0, 19.0, 13.0, 5.0, 7.0, 46.0, 35.0, 4.0, 17.0, 32.0, 51.0, 18.0, 16.0, 44.0, 75.0, 23.0, 29.0, 26.0, 42.0, 19.0, 44.0, 12.0, 47.0, 15.0, 20.0, 0.0, 28.0, 32.0, 38.0, 8.0, 7.0, 19.0, 7.0, 5.0, 25.0, 0.0, 6.0, 39.0, 19.0, 16.0, 0.0, 30.0, 7.0, 29.0, 18.0, 1.0, 2.0, 47.0, 31.0, 13.0, 33.0, 10.0, 8.0, 19.0, 22.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.677324710112597, "mean_inference_ms": 30.446316397701143, "mean_action_processing_ms": 0.7460684100611371, "mean_env_wait_ms": 0.5828280694196004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020899534225463867, "StateBufferConnector_ms": 0.01211392879486084, "ViewRequirementAgentConnector_ms": 0.4242151975631714}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -359.0, "episode_return_mean": -101.3, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.8772465888354, "num_env_steps_trained_throughput_per_sec": 131.8772465888354, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 28319.009, "restore_workers_time_ms": 0.026, "training_step_time_ms": 28318.913, "sample_time_ms": 5377.786, "learn_time_ms": 22891.628, "learn_throughput": 174.736, "synch_weights_time_ms": 43.669}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "4f45b_00000", "date": "2024-08-13_02-57-38", "timestamp": 1723532258, "time_this_iter_s": 30.42762327194214, "time_total_s": 5989.304654598236, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2462280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5989.304654598236, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 85.20714285714287, "ram_util_percent": 83.3952380952381}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.943160631164672, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.144214651445863, "policy_loss": 0.0009708831500675943, "vf_loss": 4.14230839007746, "vf_explained_var": -0.0912203345349226, "kl": 0.011679056694850289, "entropy": 0.7942243696520568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.303241775452933, "cur_kl_coeff": 0.00263671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.808647583275245, "policy_loss": -0.004056243098552817, "vf_loss": 0.8126660575627019, "vf_explained_var": 0.040074139076565936, "kl": 0.014322191171530156, "entropy": 0.7224482034880018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -359.0, "episode_reward_mean": -59.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -370.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 6.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": -80.255, "predator_policy": 50.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-302.0, 0.0, -220.0, -224.0, -359.0, -49.0, -43.0, 6.0, -8.0, -274.0, -298.0, -168.0, -189.0, -28.0, -53.0, 22.0, -345.0, -157.0, -289.0, -61.0, -148.0, -240.0, -36.0, -170.0, -47.0, -48.0, -55.0, -6.0, -35.0, -115.0, -216.0, -68.0, -19.0, -127.0, -32.0, -144.0, -48.0, -9.0, -8.0, -6.0, -10.0, -12.0, -18.0, -41.0, -98.0, 0.0, -97.0, -33.0, -36.0, -32.0, -12.0, -70.0, -1.0, -36.0, -3.0, -44.0, -1.0, -42.0, -64.0, -30.0, -18.0, -78.0, -22.0, -8.0, -23.0, -43.0, -6.0, -54.0, -16.0, -10.0, -34.0, -3.0, -66.0, -40.0, -5.0, 4.0, 0.0, -8.0, -19.0, 0.0, -16.0, -18.0, -26.0, 0.0, 3.0, -13.0, 2.0, 7.0, -43.0, 0.0, -27.0, -54.0, 4.0, -1.0, 0.0, 0.0, -7.0, -7.0, -5.0, 1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-308.0, -303.0, 0.0, 0.0, -260.0, -239.0, -285.0, -210.0, -343.0, -366.0, -153.0, -32.0, 0.0, -341.0, -2.0, -256.0, 0.0, -16.0, -222.0, -345.0, -298.0, -318.0, -345.0, -153.0, -193.0, -306.0, 0.0, -239.0, -231.0, 0.0, -12.0, -1.0, -370.0, -335.0, -146.0, -274.0, -318.0, -263.0, 0.0, -207.0, -161.0, -273.0, -276.0, -213.0, -28.0, -44.0, -304.0, -149.0, 0.0, -220.0, 0.0, -219.0, 0.0, -246.0, 0.0, -54.0, 0.0, -170.0, -149.0, -132.0, -184.0, -306.0, -136.0, -40.0, -138.0, 0.0, -114.0, -122.0, 0.0, -180.0, -319.0, -119.0, -99.0, -213.0, 0.0, -88.0, -57.0, 0.0, -2.0, -27.0, 0.0, -41.0, -8.0, -97.0, -13.0, -23.0, -46.0, -18.0, -54.0, -106.0, 0.0, 0.0, -56.0, -139.0, -42.0, -79.0, -46.0, -26.0, -32.0, -32.0, 0.0, -24.0, -72.0, -79.0, -22.0, 0.0, -45.0, -74.0, 0.0, -37.0, -8.0, -155.0, -53.0, 0.0, -16.0, -94.0, -98.0, -29.0, -92.0, 3.0, -25.0, -28.0, -52.0, -54.0, -22.0, -70.0, -8.0, -15.0, -14.0, -35.0, -22.0, -51.0, -12.0, 0.0, -34.0, -78.0, -32.0, 0.0, -11.0, -36.0, -46.0, -35.0, 0.0, -6.0, -74.0, -70.0, -52.0, -34.0, -23.0, 0.0, -32.0, -5.0, 0.0, 0.0, -36.0, -38.0, -52.0, 0.0, -35.0, 0.0, -44.0, -30.0, -18.0, -18.0, -14.0, -26.0, -46.0, 4.0, -18.0, 0.0, 0.0, -63.0, -16.0, -16.0, 0.0, 6.0, -91.0, -12.0, 0.0, -37.0, -12.0, -30.0, -62.0, -41.0, -4.0, 0.0, -4.0, -13.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, -14.0, 0.0, 0.0, -10.0, -28.0, -18.0], "policy_predator_policy_reward": [145.0, 164.0, 0.0, 0.0, 139.0, 140.0, 131.0, 140.0, 169.0, 181.0, 80.0, 56.0, 143.0, 155.0, 126.0, 138.0, 0.0, 8.0, 149.0, 144.0, 156.0, 162.0, 164.0, 166.0, 153.0, 157.0, 95.0, 116.0, 79.0, 99.0, 17.0, 18.0, 182.0, 178.0, 155.0, 108.0, 151.0, 141.0, 75.0, 71.0, 167.0, 119.0, 109.0, 140.0, 14.0, 22.0, 156.0, 127.0, 86.0, 87.0, 97.0, 74.0, 85.0, 106.0, 20.0, 28.0, 86.0, 49.0, 88.0, 78.0, 150.0, 124.0, 64.0, 44.0, 56.0, 63.0, 54.0, 55.0, 72.0, 76.0, 147.0, 147.0, 132.0, 132.0, 47.0, 32.0, 26.0, 23.0, 12.0, 11.0, 24.0, 7.0, 52.0, 41.0, 13.0, 5.0, 23.0, 0.0, 26.0, 36.0, 0.0, 0.0, 56.0, 42.0, 39.0, 49.0, 13.0, 23.0, 19.0, 13.0, 5.0, 7.0, 46.0, 35.0, 4.0, 17.0, 32.0, 51.0, 18.0, 16.0, 44.0, 75.0, 23.0, 29.0, 26.0, 42.0, 19.0, 44.0, 12.0, 47.0, 15.0, 20.0, 0.0, 28.0, 32.0, 38.0, 8.0, 7.0, 19.0, 7.0, 5.0, 25.0, 0.0, 6.0, 39.0, 19.0, 16.0, 0.0, 30.0, 7.0, 29.0, 18.0, 1.0, 2.0, 47.0, 31.0, 13.0, 33.0, 10.0, 8.0, 19.0, 22.0, 0.0, 0.0, 36.0, 30.0, 16.0, 17.0, 18.0, 17.0, 32.0, 26.0, 9.0, 9.0, 6.0, 8.0, 20.0, 22.0, 11.0, 10.0, 28.0, 22.0, 9.0, 25.0, 0.0, 1.0, 39.0, 21.0, 19.0, 18.0, 13.0, 2.0, 29.0, 20.0, 8.0, 0.0, 11.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 5.0, 20.0, 27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6988796924143728, "mean_inference_ms": 30.139233041727376, "mean_action_processing_ms": 0.7541560096352824, "mean_env_wait_ms": 0.5894569552404662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03274714946746826, "StateBufferConnector_ms": 0.012128233909606934, "ViewRequirementAgentConnector_ms": 0.5009037256240845}, "num_episodes": 23, "episode_return_max": 22.0, "episode_return_min": -359.0, "episode_return_mean": -59.45, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.3912914035314, "num_env_steps_trained_throughput_per_sec": 143.3912914035314, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 27962.062, "restore_workers_time_ms": 0.026, "training_step_time_ms": 27961.966, "sample_time_ms": 5506.993, "learn_time_ms": 22407.727, "learn_throughput": 178.51, "synch_weights_time_ms": 41.09}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "4f45b_00000", "date": "2024-08-13_02-58-06", "timestamp": 1723532286, "time_this_iter_s": 28.010547161102295, "time_total_s": 6017.315201759338, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24e1a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6017.315201759338, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 85.74615384615387, "ram_util_percent": 83.13076923076925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.147992013560401, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9787006194629366, "policy_loss": -0.00618050916603318, "vf_loss": 1.9841696271189937, "vf_explained_var": -0.03611047179610641, "kl": 0.008883713178501113, "entropy": 0.7843400994305888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3517351221707132, "cur_kl_coeff": 0.00263671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2038534082905956, "policy_loss": -0.004824430616597137, "vf_loss": 1.2086405314307995, "vf_explained_var": -0.007368998836587977, "kl": 0.014149449531404987, "entropy": 0.6106982692839608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -289.0, "episode_reward_mean": -34.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -319.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 167.0}, "policy_reward_mean": {"prey_policy": -48.925, "predator_policy": 31.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-289.0, -61.0, -148.0, -240.0, -36.0, -170.0, -47.0, -48.0, -55.0, -6.0, -35.0, -115.0, -216.0, -68.0, -19.0, -127.0, -32.0, -144.0, -48.0, -9.0, -8.0, -6.0, -10.0, -12.0, -18.0, -41.0, -98.0, 0.0, -97.0, -33.0, -36.0, -32.0, -12.0, -70.0, -1.0, -36.0, -3.0, -44.0, -1.0, -42.0, -64.0, -30.0, -18.0, -78.0, -22.0, -8.0, -23.0, -43.0, -6.0, -54.0, -16.0, -10.0, -34.0, -3.0, -66.0, -40.0, -5.0, 4.0, 0.0, -8.0, -19.0, 0.0, -16.0, -18.0, -26.0, 0.0, 3.0, -13.0, 2.0, 7.0, -43.0, 0.0, -27.0, -54.0, 4.0, -1.0, 0.0, 0.0, -7.0, -7.0, -5.0, 1.0, -14.0, -4.0, -19.0, 1.0, -1.0, 2.0, -1.0, 2.0, 18.0, 22.0, -11.0, -30.0, -32.0, 6.0, -33.0, 6.0, 5.0, -68.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-318.0, -263.0, 0.0, -207.0, -161.0, -273.0, -276.0, -213.0, -28.0, -44.0, -304.0, -149.0, 0.0, -220.0, 0.0, -219.0, 0.0, -246.0, 0.0, -54.0, 0.0, -170.0, -149.0, -132.0, -184.0, -306.0, -136.0, -40.0, -138.0, 0.0, -114.0, -122.0, 0.0, -180.0, -319.0, -119.0, -99.0, -213.0, 0.0, -88.0, -57.0, 0.0, -2.0, -27.0, 0.0, -41.0, -8.0, -97.0, -13.0, -23.0, -46.0, -18.0, -54.0, -106.0, 0.0, 0.0, -56.0, -139.0, -42.0, -79.0, -46.0, -26.0, -32.0, -32.0, 0.0, -24.0, -72.0, -79.0, -22.0, 0.0, -45.0, -74.0, 0.0, -37.0, -8.0, -155.0, -53.0, 0.0, -16.0, -94.0, -98.0, -29.0, -92.0, 3.0, -25.0, -28.0, -52.0, -54.0, -22.0, -70.0, -8.0, -15.0, -14.0, -35.0, -22.0, -51.0, -12.0, 0.0, -34.0, -78.0, -32.0, 0.0, -11.0, -36.0, -46.0, -35.0, 0.0, -6.0, -74.0, -70.0, -52.0, -34.0, -23.0, 0.0, -32.0, -5.0, 0.0, 0.0, -36.0, -38.0, -52.0, 0.0, -35.0, 0.0, -44.0, -30.0, -18.0, -18.0, -14.0, -26.0, -46.0, 4.0, -18.0, 0.0, 0.0, -63.0, -16.0, -16.0, 0.0, 6.0, -91.0, -12.0, 0.0, -37.0, -12.0, -30.0, -62.0, -41.0, -4.0, 0.0, -4.0, -13.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, -14.0, 0.0, 0.0, -10.0, -28.0, -18.0, 0.0, -28.0, 0.0, -39.0, -38.0, -9.0, 1.0, 0.0, -38.0, 0.0, -15.0, 0.0, -58.0, 12.0, -37.0, 14.0, 0.0, 18.0, 11.0, 9.0, -47.0, 10.0, -30.0, -37.0, -17.0, -39.0, 11.0, -10.0, 0.0, -77.0, -29.0, 0.0, -21.0, -14.0, -3.0, -136.0], "policy_predator_policy_reward": [151.0, 141.0, 75.0, 71.0, 167.0, 119.0, 109.0, 140.0, 14.0, 22.0, 156.0, 127.0, 86.0, 87.0, 97.0, 74.0, 85.0, 106.0, 20.0, 28.0, 86.0, 49.0, 88.0, 78.0, 150.0, 124.0, 64.0, 44.0, 56.0, 63.0, 54.0, 55.0, 72.0, 76.0, 147.0, 147.0, 132.0, 132.0, 47.0, 32.0, 26.0, 23.0, 12.0, 11.0, 24.0, 7.0, 52.0, 41.0, 13.0, 5.0, 23.0, 0.0, 26.0, 36.0, 0.0, 0.0, 56.0, 42.0, 39.0, 49.0, 13.0, 23.0, 19.0, 13.0, 5.0, 7.0, 46.0, 35.0, 4.0, 17.0, 32.0, 51.0, 18.0, 16.0, 44.0, 75.0, 23.0, 29.0, 26.0, 42.0, 19.0, 44.0, 12.0, 47.0, 15.0, 20.0, 0.0, 28.0, 32.0, 38.0, 8.0, 7.0, 19.0, 7.0, 5.0, 25.0, 0.0, 6.0, 39.0, 19.0, 16.0, 0.0, 30.0, 7.0, 29.0, 18.0, 1.0, 2.0, 47.0, 31.0, 13.0, 33.0, 10.0, 8.0, 19.0, 22.0, 0.0, 0.0, 36.0, 30.0, 16.0, 17.0, 18.0, 17.0, 32.0, 26.0, 9.0, 9.0, 6.0, 8.0, 20.0, 22.0, 11.0, 10.0, 28.0, 22.0, 9.0, 25.0, 0.0, 1.0, 39.0, 21.0, 19.0, 18.0, 13.0, 2.0, 29.0, 20.0, 8.0, 0.0, 11.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 5.0, 20.0, 27.0, 0.0, 14.0, 24.0, 11.0, 17.0, 11.0, 0.0, 0.0, 24.0, 13.0, 8.0, 9.0, 29.0, 16.0, 22.0, 3.0, 0.0, 0.0, 2.0, 0.0, 20.0, 6.0, 22.0, 15.0, 3.0, 21.0, 0.0, 5.0, 27.0, 17.0, 19.0, 16.0, 23.0, 17.0, 50.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7196039920188944, "mean_inference_ms": 29.909866065776292, "mean_action_processing_ms": 0.7614019403290471, "mean_env_wait_ms": 0.5965893670163191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03555262088775635, "StateBufferConnector_ms": 0.018610239028930664, "ViewRequirementAgentConnector_ms": 0.5851379632949829}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -289.0, "episode_return_mean": -34.07, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.50174806266979, "num_env_steps_trained_throughput_per_sec": 125.50174806266979, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 28211.449, "restore_workers_time_ms": 0.026, "training_step_time_ms": 28211.353, "sample_time_ms": 5719.51, "learn_time_ms": 22449.114, "learn_throughput": 178.181, "synch_weights_time_ms": 36.013}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "4f45b_00000", "date": "2024-08-13_02-58-38", "timestamp": 1723532318, "time_this_iter_s": 32.0062301158905, "time_total_s": 6049.321431875229, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb7160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6049.321431875229, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 87.99111111111112, "ram_util_percent": 83.23555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.410428100130545, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5169810845422997, "policy_loss": -0.007155994884177018, "vf_loss": 1.5235280396130981, "vf_explained_var": -0.002016482151374615, "kl": 0.007604446643768189, "entropy": 0.7527449315817899, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3681180325607774, "cur_kl_coeff": 0.00263671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9084470971393837, "policy_loss": -0.002543248660202143, "vf_loss": 1.9109761415335236, "vf_explained_var": 0.000909246149517241, "kl": 0.005384669637208192, "entropy": 0.7233092010021209, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -98.0, "episode_reward_mean": -17.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -213.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 132.0}, "policy_reward_mean": {"prey_policy": -27.125, "predator_policy": 18.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-48.0, -9.0, -8.0, -6.0, -10.0, -12.0, -18.0, -41.0, -98.0, 0.0, -97.0, -33.0, -36.0, -32.0, -12.0, -70.0, -1.0, -36.0, -3.0, -44.0, -1.0, -42.0, -64.0, -30.0, -18.0, -78.0, -22.0, -8.0, -23.0, -43.0, -6.0, -54.0, -16.0, -10.0, -34.0, -3.0, -66.0, -40.0, -5.0, 4.0, 0.0, -8.0, -19.0, 0.0, -16.0, -18.0, -26.0, 0.0, 3.0, -13.0, 2.0, 7.0, -43.0, 0.0, -27.0, -54.0, 4.0, -1.0, 0.0, 0.0, -7.0, -7.0, -5.0, 1.0, -14.0, -4.0, -19.0, 1.0, -1.0, 2.0, -1.0, 2.0, 18.0, 22.0, -11.0, -30.0, -32.0, 6.0, -33.0, 6.0, 5.0, -68.0, -11.0, -4.0, -5.0, 6.0, -3.0, 4.0, 13.0, -50.0, -46.0, -4.0, -28.0, 6.0, -29.0, -3.0, -15.0, -12.0, -9.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-99.0, -213.0, 0.0, -88.0, -57.0, 0.0, -2.0, -27.0, 0.0, -41.0, -8.0, -97.0, -13.0, -23.0, -46.0, -18.0, -54.0, -106.0, 0.0, 0.0, -56.0, -139.0, -42.0, -79.0, -46.0, -26.0, -32.0, -32.0, 0.0, -24.0, -72.0, -79.0, -22.0, 0.0, -45.0, -74.0, 0.0, -37.0, -8.0, -155.0, -53.0, 0.0, -16.0, -94.0, -98.0, -29.0, -92.0, 3.0, -25.0, -28.0, -52.0, -54.0, -22.0, -70.0, -8.0, -15.0, -14.0, -35.0, -22.0, -51.0, -12.0, 0.0, -34.0, -78.0, -32.0, 0.0, -11.0, -36.0, -46.0, -35.0, 0.0, -6.0, -74.0, -70.0, -52.0, -34.0, -23.0, 0.0, -32.0, -5.0, 0.0, 0.0, -36.0, -38.0, -52.0, 0.0, -35.0, 0.0, -44.0, -30.0, -18.0, -18.0, -14.0, -26.0, -46.0, 4.0, -18.0, 0.0, 0.0, -63.0, -16.0, -16.0, 0.0, 6.0, -91.0, -12.0, 0.0, -37.0, -12.0, -30.0, -62.0, -41.0, -4.0, 0.0, -4.0, -13.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, -14.0, 0.0, 0.0, -10.0, -28.0, -18.0, 0.0, -28.0, 0.0, -39.0, -38.0, -9.0, 1.0, 0.0, -38.0, 0.0, -15.0, 0.0, -58.0, 12.0, -37.0, 14.0, 0.0, 18.0, 11.0, 9.0, -47.0, 10.0, -30.0, -37.0, -17.0, -39.0, 11.0, -10.0, 0.0, -77.0, -29.0, 0.0, -21.0, -14.0, -3.0, -136.0, 0.0, -32.0, -8.0, 0.0, 0.0, -46.0, -27.0, -18.0, -20.0, -22.0, -23.0, 13.0, -2.0, 14.0, -100.0, 0.0, -58.0, -38.0, -38.0, -24.0, -56.0, -32.0, 0.0, 0.0, 7.0, -72.0, 0.0, -6.0, 0.0, -66.0, 0.0, -24.0, -46.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [132.0, 132.0, 47.0, 32.0, 26.0, 23.0, 12.0, 11.0, 24.0, 7.0, 52.0, 41.0, 13.0, 5.0, 23.0, 0.0, 26.0, 36.0, 0.0, 0.0, 56.0, 42.0, 39.0, 49.0, 13.0, 23.0, 19.0, 13.0, 5.0, 7.0, 46.0, 35.0, 4.0, 17.0, 32.0, 51.0, 18.0, 16.0, 44.0, 75.0, 23.0, 29.0, 26.0, 42.0, 19.0, 44.0, 12.0, 47.0, 15.0, 20.0, 0.0, 28.0, 32.0, 38.0, 8.0, 7.0, 19.0, 7.0, 5.0, 25.0, 0.0, 6.0, 39.0, 19.0, 16.0, 0.0, 30.0, 7.0, 29.0, 18.0, 1.0, 2.0, 47.0, 31.0, 13.0, 33.0, 10.0, 8.0, 19.0, 22.0, 0.0, 0.0, 36.0, 30.0, 16.0, 17.0, 18.0, 17.0, 32.0, 26.0, 9.0, 9.0, 6.0, 8.0, 20.0, 22.0, 11.0, 10.0, 28.0, 22.0, 9.0, 25.0, 0.0, 1.0, 39.0, 21.0, 19.0, 18.0, 13.0, 2.0, 29.0, 20.0, 8.0, 0.0, 11.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 5.0, 20.0, 27.0, 0.0, 14.0, 24.0, 11.0, 17.0, 11.0, 0.0, 0.0, 24.0, 13.0, 8.0, 9.0, 29.0, 16.0, 22.0, 3.0, 0.0, 0.0, 2.0, 0.0, 20.0, 6.0, 22.0, 15.0, 3.0, 21.0, 0.0, 5.0, 27.0, 17.0, 19.0, 16.0, 23.0, 17.0, 50.0, 21.0, 14.0, 7.0, 4.0, 0.0, 18.0, 23.0, 26.0, 25.0, 26.0, 13.0, 7.0, 7.0, 0.0, 1.0, 50.0, 0.0, 22.0, 28.0, 32.0, 26.0, 32.0, 28.0, 0.0, 6.0, 35.0, 1.0, 0.0, 3.0, 17.0, 34.0, 0.0, 12.0, 23.0, 14.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7385699013823268, "mean_inference_ms": 29.67897384530042, "mean_action_processing_ms": 0.768311962706517, "mean_env_wait_ms": 0.6026962354618504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03899943828582764, "StateBufferConnector_ms": 0.020046472549438477, "ViewRequirementAgentConnector_ms": 0.6078091859817505}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -98.0, "episode_return_mean": -17.41, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.37840068415395, "num_env_steps_trained_throughput_per_sec": 144.37840068415395, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 28141.549, "restore_workers_time_ms": 0.022, "training_step_time_ms": 28141.449, "sample_time_ms": 5777.397, "learn_time_ms": 22318.29, "learn_throughput": 179.225, "synch_weights_time_ms": 39.313}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "4f45b_00000", "date": "2024-08-13_02-59-06", "timestamp": 1723532346, "time_this_iter_s": 27.776127815246582, "time_total_s": 6077.0975596904755, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24d8820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6077.0975596904755, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 86.66666666666667, "ram_util_percent": 83.12820512820514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1662269446269544, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.04167757822723, "policy_loss": -0.004911195317273418, "vf_loss": 3.0458547968713066, "vf_explained_var": 0.024490761031549443, "kl": 0.009164411040803807, "entropy": 0.7959351702341958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2364902991190474, "cur_kl_coeff": 0.00263671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.699630539884012, "policy_loss": -0.0008945229606180595, "vf_loss": 4.700510726403937, "vf_explained_var": 0.0008951415775944947, "kl": 0.005429855669415846, "entropy": 0.6820577110878374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -623.0, "episode_reward_mean": -60.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -546.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 406.0}, "policy_reward_mean": {"prey_policy": -57.045, "predator_policy": 26.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.0, -30.0, -18.0, -78.0, -22.0, -8.0, -23.0, -43.0, -6.0, -54.0, -16.0, -10.0, -34.0, -3.0, -66.0, -40.0, -5.0, 4.0, 0.0, -8.0, -19.0, 0.0, -16.0, -18.0, -26.0, 0.0, 3.0, -13.0, 2.0, 7.0, -43.0, 0.0, -27.0, -54.0, 4.0, -1.0, 0.0, 0.0, -7.0, -7.0, -5.0, 1.0, -14.0, -4.0, -19.0, 1.0, -1.0, 2.0, -1.0, 2.0, 18.0, 22.0, -11.0, -30.0, -32.0, 6.0, -33.0, 6.0, 5.0, -68.0, -11.0, -4.0, -5.0, 6.0, -3.0, 4.0, 13.0, -50.0, -46.0, -4.0, -28.0, 6.0, -29.0, -3.0, -15.0, -12.0, -9.0, 0.0, -2.0, 0.0, -387.0, -501.0, -317.0, -543.0, -431.0, -418.0, 6.0, -38.0, -2.0, 0.0, -551.0, -620.0, 0.0, 0.0, -7.0, 4.0, -39.0, 0.0, -623.0, -536.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-98.0, -29.0, -92.0, 3.0, -25.0, -28.0, -52.0, -54.0, -22.0, -70.0, -8.0, -15.0, -14.0, -35.0, -22.0, -51.0, -12.0, 0.0, -34.0, -78.0, -32.0, 0.0, -11.0, -36.0, -46.0, -35.0, 0.0, -6.0, -74.0, -70.0, -52.0, -34.0, -23.0, 0.0, -32.0, -5.0, 0.0, 0.0, -36.0, -38.0, -52.0, 0.0, -35.0, 0.0, -44.0, -30.0, -18.0, -18.0, -14.0, -26.0, -46.0, 4.0, -18.0, 0.0, 0.0, -63.0, -16.0, -16.0, 0.0, 6.0, -91.0, -12.0, 0.0, -37.0, -12.0, -30.0, -62.0, -41.0, -4.0, 0.0, -4.0, -13.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, -14.0, 0.0, 0.0, -10.0, -28.0, -18.0, 0.0, -28.0, 0.0, -39.0, -38.0, -9.0, 1.0, 0.0, -38.0, 0.0, -15.0, 0.0, -58.0, 12.0, -37.0, 14.0, 0.0, 18.0, 11.0, 9.0, -47.0, 10.0, -30.0, -37.0, -17.0, -39.0, 11.0, -10.0, 0.0, -77.0, -29.0, 0.0, -21.0, -14.0, -3.0, -136.0, 0.0, -32.0, -8.0, 0.0, 0.0, -46.0, -27.0, -18.0, -20.0, -22.0, -23.0, 13.0, -2.0, 14.0, -100.0, 0.0, -58.0, -38.0, -38.0, -24.0, -56.0, -32.0, 0.0, 0.0, 7.0, -72.0, 0.0, -6.0, 0.0, -66.0, 0.0, -24.0, -46.0, 0.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, -305.0, -285.0, -414.0, -350.0, -340.0, -198.0, -496.0, -408.0, -378.0, -267.0, -283.0, -306.0, 0.0, -27.0, -18.0, -58.0, -4.0, 0.0, 0.0, 0.0, -414.0, -416.0, -484.0, -546.0, 0.0, 0.0, -35.0, -8.0, -11.0, -37.0, 0.0, -28.0, -56.0, -15.0, 0.0, 0.0, -470.0, -494.0, -403.0, -440.0], "policy_predator_policy_reward": [19.0, 44.0, 12.0, 47.0, 15.0, 20.0, 0.0, 28.0, 32.0, 38.0, 8.0, 7.0, 19.0, 7.0, 5.0, 25.0, 0.0, 6.0, 39.0, 19.0, 16.0, 0.0, 30.0, 7.0, 29.0, 18.0, 1.0, 2.0, 47.0, 31.0, 13.0, 33.0, 10.0, 8.0, 19.0, 22.0, 0.0, 0.0, 36.0, 30.0, 16.0, 17.0, 18.0, 17.0, 32.0, 26.0, 9.0, 9.0, 6.0, 8.0, 20.0, 22.0, 11.0, 10.0, 28.0, 22.0, 9.0, 25.0, 0.0, 1.0, 39.0, 21.0, 19.0, 18.0, 13.0, 2.0, 29.0, 20.0, 8.0, 0.0, 11.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 5.0, 20.0, 27.0, 0.0, 14.0, 24.0, 11.0, 17.0, 11.0, 0.0, 0.0, 24.0, 13.0, 8.0, 9.0, 29.0, 16.0, 22.0, 3.0, 0.0, 0.0, 2.0, 0.0, 20.0, 6.0, 22.0, 15.0, 3.0, 21.0, 0.0, 5.0, 27.0, 17.0, 19.0, 16.0, 23.0, 17.0, 50.0, 21.0, 14.0, 7.0, 4.0, 0.0, 18.0, 23.0, 26.0, 25.0, 26.0, 13.0, 7.0, 7.0, 0.0, 1.0, 50.0, 0.0, 22.0, 28.0, 32.0, 26.0, 32.0, 28.0, 0.0, 6.0, 35.0, 1.0, 0.0, 3.0, 17.0, 34.0, 0.0, 12.0, 23.0, 14.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 41.0, 162.0, 255.0, 8.0, 1.0, 220.0, 361.0, 0.0, 193.0, 21.0, 15.0, 156.0, 15.0, 18.0, 29.0, 9.0, 0.0, 2.0, 0.0, 0.0, 271.0, 8.0, 406.0, 4.0, 0.0, 0.0, 25.0, 18.0, 18.0, 23.0, 16.0, 16.0, 11.0, 21.0, 0.0, 0.0, 341.0, 0.0, 16.0, 291.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7597645456131352, "mean_inference_ms": 29.398826924133463, "mean_action_processing_ms": 0.7757644750721979, "mean_env_wait_ms": 0.6093804351353462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03267812728881836, "StateBufferConnector_ms": 0.020141959190368652, "ViewRequirementAgentConnector_ms": 0.5882725715637207}, "num_episodes": 22, "episode_return_max": 22.0, "episode_return_min": -623.0, "episode_return_mean": -60.89, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.45791010032335, "num_env_steps_trained_throughput_per_sec": 131.45791010032335, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 28550.746, "restore_workers_time_ms": 0.022, "training_step_time_ms": 28550.646, "sample_time_ms": 5875.442, "learn_time_ms": 22629.55, "learn_throughput": 176.76, "synch_weights_time_ms": 39.188}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "4f45b_00000", "date": "2024-08-13_02-59-36", "timestamp": 1723532376, "time_this_iter_s": 30.467368841171265, "time_total_s": 6107.564928531647, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24523a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6107.564928531647, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 87.56046511627906, "ram_util_percent": 83.21627906976745}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.849975762922297, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8598173736895203, "policy_loss": -0.006528653733176056, "vf_loss": 2.8650586527491373, "vf_explained_var": 0.007774553696314494, "kl": 0.016073981142422738, "entropy": 0.7360642737812466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1628663834164699, "cur_kl_coeff": 0.00263671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.91511245101848, "policy_loss": -0.002430104053820725, "vf_loss": 4.917529869331885, "vf_explained_var": 0.0002572391083631566, "kl": 0.004811123531060555, "entropy": 0.5694791729015017, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -987.0, "episode_reward_mean": -123.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1144.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 1190.0}, "policy_reward_mean": {"prey_policy": -124.76, "predator_policy": 62.785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -8.0, -19.0, 0.0, -16.0, -18.0, -26.0, 0.0, 3.0, -13.0, 2.0, 7.0, -43.0, 0.0, -27.0, -54.0, 4.0, -1.0, 0.0, 0.0, -7.0, -7.0, -5.0, 1.0, -14.0, -4.0, -19.0, 1.0, -1.0, 2.0, -1.0, 2.0, 18.0, 22.0, -11.0, -30.0, -32.0, 6.0, -33.0, 6.0, 5.0, -68.0, -11.0, -4.0, -5.0, 6.0, -3.0, 4.0, 13.0, -50.0, -46.0, -4.0, -28.0, 6.0, -29.0, -3.0, -15.0, -12.0, -9.0, 0.0, -2.0, 0.0, -387.0, -501.0, -317.0, -543.0, -431.0, -418.0, 6.0, -38.0, -2.0, 0.0, -551.0, -620.0, 0.0, 0.0, -7.0, 4.0, -39.0, 0.0, -623.0, -536.0, 0.0, -917.0, -835.0, -745.0, -785.0, -10.0, -709.0, -576.0, -347.0, -987.0, -1.0, 0.0, -255.0, 7.0, -8.0, -7.0, 3.0, -650.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -36.0, -38.0, -52.0, 0.0, -35.0, 0.0, -44.0, -30.0, -18.0, -18.0, -14.0, -26.0, -46.0, 4.0, -18.0, 0.0, 0.0, -63.0, -16.0, -16.0, 0.0, 6.0, -91.0, -12.0, 0.0, -37.0, -12.0, -30.0, -62.0, -41.0, -4.0, 0.0, -4.0, -13.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, -14.0, 0.0, 0.0, -10.0, -28.0, -18.0, 0.0, -28.0, 0.0, -39.0, -38.0, -9.0, 1.0, 0.0, -38.0, 0.0, -15.0, 0.0, -58.0, 12.0, -37.0, 14.0, 0.0, 18.0, 11.0, 9.0, -47.0, 10.0, -30.0, -37.0, -17.0, -39.0, 11.0, -10.0, 0.0, -77.0, -29.0, 0.0, -21.0, -14.0, -3.0, -136.0, 0.0, -32.0, -8.0, 0.0, 0.0, -46.0, -27.0, -18.0, -20.0, -22.0, -23.0, 13.0, -2.0, 14.0, -100.0, 0.0, -58.0, -38.0, -38.0, -24.0, -56.0, -32.0, 0.0, 0.0, 7.0, -72.0, 0.0, -6.0, 0.0, -66.0, 0.0, -24.0, -46.0, 0.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, -305.0, -285.0, -414.0, -350.0, -340.0, -198.0, -496.0, -408.0, -378.0, -267.0, -283.0, -306.0, 0.0, -27.0, -18.0, -58.0, -4.0, 0.0, 0.0, 0.0, -414.0, -416.0, -484.0, -546.0, 0.0, 0.0, -35.0, -8.0, -11.0, -37.0, 0.0, -28.0, -56.0, -15.0, 0.0, 0.0, -470.0, -494.0, -403.0, -440.0, 0.0, 0.0, -963.0, -1144.0, -802.0, -948.0, -828.0, -798.0, -702.0, -728.0, -21.0, -8.0, -760.0, -722.0, -512.0, -531.0, -501.0, -408.0, -957.0, -1049.0, -9.0, -24.0, 0.0, 0.0, -344.0, -461.0, 0.0, 7.0, 0.0, -22.0, -48.0, 13.0, 0.0, -28.0, -714.0, -723.0], "policy_predator_policy_reward": [0.0, 0.0, 36.0, 30.0, 16.0, 17.0, 18.0, 17.0, 32.0, 26.0, 9.0, 9.0, 6.0, 8.0, 20.0, 22.0, 11.0, 10.0, 28.0, 22.0, 9.0, 25.0, 0.0, 1.0, 39.0, 21.0, 19.0, 18.0, 13.0, 2.0, 29.0, 20.0, 8.0, 0.0, 11.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 7.0, 0.0, 0.0, 5.0, 20.0, 27.0, 0.0, 14.0, 24.0, 11.0, 17.0, 11.0, 0.0, 0.0, 24.0, 13.0, 8.0, 9.0, 29.0, 16.0, 22.0, 3.0, 0.0, 0.0, 2.0, 0.0, 20.0, 6.0, 22.0, 15.0, 3.0, 21.0, 0.0, 5.0, 27.0, 17.0, 19.0, 16.0, 23.0, 17.0, 50.0, 21.0, 14.0, 7.0, 4.0, 0.0, 18.0, 23.0, 26.0, 25.0, 26.0, 13.0, 7.0, 7.0, 0.0, 1.0, 50.0, 0.0, 22.0, 28.0, 32.0, 26.0, 32.0, 28.0, 0.0, 6.0, 35.0, 1.0, 0.0, 3.0, 17.0, 34.0, 0.0, 12.0, 23.0, 14.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 41.0, 162.0, 255.0, 8.0, 1.0, 220.0, 361.0, 0.0, 193.0, 21.0, 15.0, 156.0, 15.0, 18.0, 29.0, 9.0, 0.0, 2.0, 0.0, 0.0, 271.0, 8.0, 406.0, 4.0, 0.0, 0.0, 25.0, 18.0, 18.0, 23.0, 16.0, 16.0, 11.0, 21.0, 0.0, 0.0, 341.0, 0.0, 16.0, 291.0, 0.0, 0.0, 1190.0, 0.0, 0.0, 915.0, 872.0, 9.0, 641.0, 4.0, 13.0, 6.0, 0.0, 773.0, 10.0, 457.0, 4.0, 558.0, 24.0, 995.0, 10.0, 22.0, 0.0, 0.0, 314.0, 236.0, 0.0, 0.0, 8.0, 6.0, 4.0, 24.0, 17.0, 14.0, 0.0, 787.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7704614154213056, "mean_inference_ms": 29.16187616773962, "mean_action_processing_ms": 0.7794908588612518, "mean_env_wait_ms": 0.6128748837126055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032707810401916504, "StateBufferConnector_ms": 0.015105247497558594, "ViewRequirementAgentConnector_ms": 0.5364406108856201}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -987.0, "episode_return_mean": -123.95, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 132.92110600503554, "num_env_steps_trained_throughput_per_sec": 132.92110600503554, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 28665.1, "restore_workers_time_ms": 0.022, "training_step_time_ms": 28664.981, "sample_time_ms": 5907.447, "learn_time_ms": 22713.057, "learn_throughput": 176.11, "synch_weights_time_ms": 38.71}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "4f45b_00000", "date": "2024-08-13_03-00-06", "timestamp": 1723532406, "time_this_iter_s": 30.137614011764526, "time_total_s": 6137.702542543411, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24d8310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6137.702542543411, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 88.04761904761907, "ram_util_percent": 83.01428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8196774977540213, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1677060255297906, "policy_loss": -0.002254065179891845, "vf_loss": 2.1695730731916174, "vf_explained_var": 0.00750620339913343, "kl": 0.004832282265245192, "entropy": 0.7066078105300823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2655652874440113, "cur_kl_coeff": 0.001318359375, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.913080301234331, "policy_loss": -0.002093349358007785, "vf_loss": 2.915169655772113, "vf_explained_var": 0.00014040138986375596, "kl": 0.003029708366367499, "entropy": 0.6374312707040676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 119.0, "episode_reward_min": -987.0, "episode_reward_mean": -146.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1358.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 18.0, "predator_policy": 1362.0}, "policy_reward_mean": {"prey_policy": -171.07, "predator_policy": 97.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0, -14.0, -4.0, -19.0, 1.0, -1.0, 2.0, -1.0, 2.0, 18.0, 22.0, -11.0, -30.0, -32.0, 6.0, -33.0, 6.0, 5.0, -68.0, -11.0, -4.0, -5.0, 6.0, -3.0, 4.0, 13.0, -50.0, -46.0, -4.0, -28.0, 6.0, -29.0, -3.0, -15.0, -12.0, -9.0, 0.0, -2.0, 0.0, -387.0, -501.0, -317.0, -543.0, -431.0, -418.0, 6.0, -38.0, -2.0, 0.0, -551.0, -620.0, 0.0, 0.0, -7.0, 4.0, -39.0, 0.0, -623.0, -536.0, 0.0, -917.0, -835.0, -745.0, -785.0, -10.0, -709.0, -576.0, -347.0, -987.0, -1.0, 0.0, -255.0, 7.0, -8.0, -7.0, 3.0, -650.0, 0.0, -12.0, 1.0, 105.0, 17.0, -707.0, 16.0, 8.0, -516.0, 119.0, -6.0, -6.0, 10.0, 0.0, 5.0, -17.0, -842.0, 2.0, -24.0, -644.0, -15.0, -7.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.0, -18.0, 0.0, -28.0, 0.0, -39.0, -38.0, -9.0, 1.0, 0.0, -38.0, 0.0, -15.0, 0.0, -58.0, 12.0, -37.0, 14.0, 0.0, 18.0, 11.0, 9.0, -47.0, 10.0, -30.0, -37.0, -17.0, -39.0, 11.0, -10.0, 0.0, -77.0, -29.0, 0.0, -21.0, -14.0, -3.0, -136.0, 0.0, -32.0, -8.0, 0.0, 0.0, -46.0, -27.0, -18.0, -20.0, -22.0, -23.0, 13.0, -2.0, 14.0, -100.0, 0.0, -58.0, -38.0, -38.0, -24.0, -56.0, -32.0, 0.0, 0.0, 7.0, -72.0, 0.0, -6.0, 0.0, -66.0, 0.0, -24.0, -46.0, 0.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, -305.0, -285.0, -414.0, -350.0, -340.0, -198.0, -496.0, -408.0, -378.0, -267.0, -283.0, -306.0, 0.0, -27.0, -18.0, -58.0, -4.0, 0.0, 0.0, 0.0, -414.0, -416.0, -484.0, -546.0, 0.0, 0.0, -35.0, -8.0, -11.0, -37.0, 0.0, -28.0, -56.0, -15.0, 0.0, 0.0, -470.0, -494.0, -403.0, -440.0, 0.0, 0.0, -963.0, -1144.0, -802.0, -948.0, -828.0, -798.0, -702.0, -728.0, -21.0, -8.0, -760.0, -722.0, -512.0, -531.0, -501.0, -408.0, -957.0, -1049.0, -9.0, -24.0, 0.0, 0.0, -344.0, -461.0, 0.0, 7.0, 0.0, -22.0, -48.0, 13.0, 0.0, -28.0, -714.0, -723.0, 0.0, 0.0, -24.0, 0.0, 0.0, -5.0, -1249.0, -529.0, -2.0, 5.0, -1126.0, -618.0, 17.0, -4.0, 9.0, -7.0, -884.0, -662.0, -912.0, -184.0, 0.0, -12.0, 0.0, -58.0, 5.0, 5.0, 0.0, 0.0, -16.0, 0.0, -16.0, -34.0, -859.0, -1358.0, -22.0, 13.0, -28.0, -11.0, -757.0, -670.0, -47.0, 0.0, 0.0, -18.0, 0.0, -8.0], "policy_predator_policy_reward": [20.0, 27.0, 0.0, 14.0, 24.0, 11.0, 17.0, 11.0, 0.0, 0.0, 24.0, 13.0, 8.0, 9.0, 29.0, 16.0, 22.0, 3.0, 0.0, 0.0, 2.0, 0.0, 20.0, 6.0, 22.0, 15.0, 3.0, 21.0, 0.0, 5.0, 27.0, 17.0, 19.0, 16.0, 23.0, 17.0, 50.0, 21.0, 14.0, 7.0, 4.0, 0.0, 18.0, 23.0, 26.0, 25.0, 26.0, 13.0, 7.0, 7.0, 0.0, 1.0, 50.0, 0.0, 22.0, 28.0, 32.0, 26.0, 32.0, 28.0, 0.0, 6.0, 35.0, 1.0, 0.0, 3.0, 17.0, 34.0, 0.0, 12.0, 23.0, 14.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 41.0, 162.0, 255.0, 8.0, 1.0, 220.0, 361.0, 0.0, 193.0, 21.0, 15.0, 156.0, 15.0, 18.0, 29.0, 9.0, 0.0, 2.0, 0.0, 0.0, 271.0, 8.0, 406.0, 4.0, 0.0, 0.0, 25.0, 18.0, 18.0, 23.0, 16.0, 16.0, 11.0, 21.0, 0.0, 0.0, 341.0, 0.0, 16.0, 291.0, 0.0, 0.0, 1190.0, 0.0, 0.0, 915.0, 872.0, 9.0, 641.0, 4.0, 13.0, 6.0, 0.0, 773.0, 10.0, 457.0, 4.0, 558.0, 24.0, 995.0, 10.0, 22.0, 0.0, 0.0, 314.0, 236.0, 0.0, 0.0, 8.0, 6.0, 4.0, 24.0, 17.0, 14.0, 0.0, 787.0, 0.0, 0.0, 12.0, 0.0, 5.0, 1.0, 844.0, 1039.0, 11.0, 3.0, 1023.0, 14.0, 3.0, 0.0, 2.0, 4.0, 1007.0, 23.0, 582.0, 633.0, 6.0, 0.0, 26.0, 26.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 10.0, 23.0, 13.0, 1362.0, 11.0, 0.0, 0.0, 15.0, 783.0, 0.0, 16.0, 16.0, 8.0, 3.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7797604944530778, "mean_inference_ms": 28.857988816845545, "mean_action_processing_ms": 0.7824272872750074, "mean_env_wait_ms": 0.6165698460376048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02024686336517334, "StateBufferConnector_ms": 0.01583552360534668, "ViewRequirementAgentConnector_ms": 0.48168349266052246}, "num_episodes": 23, "episode_return_max": 119.0, "episode_return_min": -987.0, "episode_return_mean": -146.84, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.64068096567067, "num_env_steps_trained_throughput_per_sec": 125.64068096567067, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 29125.117, "restore_workers_time_ms": 0.023, "training_step_time_ms": 29124.995, "sample_time_ms": 6038.766, "learn_time_ms": 23041.477, "learn_throughput": 173.6, "synch_weights_time_ms": 38.922}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "4f45b_00000", "date": "2024-08-13_03-00-39", "timestamp": 1723532439, "time_this_iter_s": 31.97303295135498, "time_total_s": 6169.675575494766, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b245b1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6169.675575494766, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 87.97555555555556, "ram_util_percent": 83.16000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8321145748887113, "cur_kl_coeff": 0.04004516601562501, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.719878209204901, "policy_loss": -0.0019235720330721172, "vf_loss": 2.7216271652746453, "vf_explained_var": 0.0094310203557292, "kl": 0.004360318817669476, "entropy": 0.693443265478447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.055111576015593, "cur_kl_coeff": 0.0006591796875, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.649505419453616, "policy_loss": -0.002763373811640555, "vf_loss": 3.6522666326906315, "vf_explained_var": 0.0004329421532847894, "kl": 0.0032775009298284014, "entropy": 0.581672235929146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 119.0, "episode_reward_min": -987.0, "episode_reward_mean": -167.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1358.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 1362.0}, "policy_reward_mean": {"prey_policy": -208.505, "predator_policy": 124.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.0, -11.0, -4.0, -5.0, 6.0, -3.0, 4.0, 13.0, -50.0, -46.0, -4.0, -28.0, 6.0, -29.0, -3.0, -15.0, -12.0, -9.0, 0.0, -2.0, 0.0, -387.0, -501.0, -317.0, -543.0, -431.0, -418.0, 6.0, -38.0, -2.0, 0.0, -551.0, -620.0, 0.0, 0.0, -7.0, 4.0, -39.0, 0.0, -623.0, -536.0, 0.0, -917.0, -835.0, -745.0, -785.0, -10.0, -709.0, -576.0, -347.0, -987.0, -1.0, 0.0, -255.0, 7.0, -8.0, -7.0, 3.0, -650.0, 0.0, -12.0, 1.0, 105.0, 17.0, -707.0, 16.0, 8.0, -516.0, 119.0, -6.0, -6.0, 10.0, 0.0, 5.0, -17.0, -842.0, 2.0, -24.0, -644.0, -15.0, -7.0, -4.0, 11.0, -501.0, 1.0, 4.0, 2.0, -11.0, 0.0, 61.0, 2.0, -5.0, -585.0, -523.0, 15.0, -3.0, -22.0, -65.0, 0.0, -560.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.0, -136.0, 0.0, -32.0, -8.0, 0.0, 0.0, -46.0, -27.0, -18.0, -20.0, -22.0, -23.0, 13.0, -2.0, 14.0, -100.0, 0.0, -58.0, -38.0, -38.0, -24.0, -56.0, -32.0, 0.0, 0.0, 7.0, -72.0, 0.0, -6.0, 0.0, -66.0, 0.0, -24.0, -46.0, 0.0, 0.0, 0.0, 0.0, -13.0, 0.0, 0.0, -305.0, -285.0, -414.0, -350.0, -340.0, -198.0, -496.0, -408.0, -378.0, -267.0, -283.0, -306.0, 0.0, -27.0, -18.0, -58.0, -4.0, 0.0, 0.0, 0.0, -414.0, -416.0, -484.0, -546.0, 0.0, 0.0, -35.0, -8.0, -11.0, -37.0, 0.0, -28.0, -56.0, -15.0, 0.0, 0.0, -470.0, -494.0, -403.0, -440.0, 0.0, 0.0, -963.0, -1144.0, -802.0, -948.0, -828.0, -798.0, -702.0, -728.0, -21.0, -8.0, -760.0, -722.0, -512.0, -531.0, -501.0, -408.0, -957.0, -1049.0, -9.0, -24.0, 0.0, 0.0, -344.0, -461.0, 0.0, 7.0, 0.0, -22.0, -48.0, 13.0, 0.0, -28.0, -714.0, -723.0, 0.0, 0.0, -24.0, 0.0, 0.0, -5.0, -1249.0, -529.0, -2.0, 5.0, -1126.0, -618.0, 17.0, -4.0, 9.0, -7.0, -884.0, -662.0, -912.0, -184.0, 0.0, -12.0, 0.0, -58.0, 5.0, 5.0, 0.0, 0.0, -16.0, 0.0, -16.0, -34.0, -859.0, -1358.0, -22.0, 13.0, -28.0, -11.0, -757.0, -670.0, -47.0, 0.0, 0.0, -18.0, 0.0, -8.0, 9.0, 2.0, -481.0, -808.0, -38.0, 0.0, 0.0, -20.0, -2.0, 0.0, -14.0, -8.0, 0.0, 0.0, -1056.0, -469.0, 0.0, 1.0, 0.0, -42.0, -799.0, -602.0, -492.0, -606.0, 9.0, -15.0, -6.0, 0.0, -20.0, -12.0, -945.0, 0.0, 0.0, 0.0, -721.0, -895.0], "policy_predator_policy_reward": [50.0, 21.0, 14.0, 7.0, 4.0, 0.0, 18.0, 23.0, 26.0, 25.0, 26.0, 13.0, 7.0, 7.0, 0.0, 1.0, 50.0, 0.0, 22.0, 28.0, 32.0, 26.0, 32.0, 28.0, 0.0, 6.0, 35.0, 1.0, 0.0, 3.0, 17.0, 34.0, 0.0, 12.0, 23.0, 14.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 41.0, 162.0, 255.0, 8.0, 1.0, 220.0, 361.0, 0.0, 193.0, 21.0, 15.0, 156.0, 15.0, 18.0, 29.0, 9.0, 0.0, 2.0, 0.0, 0.0, 271.0, 8.0, 406.0, 4.0, 0.0, 0.0, 25.0, 18.0, 18.0, 23.0, 16.0, 16.0, 11.0, 21.0, 0.0, 0.0, 341.0, 0.0, 16.0, 291.0, 0.0, 0.0, 1190.0, 0.0, 0.0, 915.0, 872.0, 9.0, 641.0, 4.0, 13.0, 6.0, 0.0, 773.0, 10.0, 457.0, 4.0, 558.0, 24.0, 995.0, 10.0, 22.0, 0.0, 0.0, 314.0, 236.0, 0.0, 0.0, 8.0, 6.0, 4.0, 24.0, 17.0, 14.0, 0.0, 787.0, 0.0, 0.0, 12.0, 0.0, 5.0, 1.0, 844.0, 1039.0, 11.0, 3.0, 1023.0, 14.0, 3.0, 0.0, 2.0, 4.0, 1007.0, 23.0, 582.0, 633.0, 6.0, 0.0, 26.0, 26.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 10.0, 23.0, 13.0, 1362.0, 11.0, 0.0, 0.0, 15.0, 783.0, 0.0, 16.0, 16.0, 8.0, 3.0, 4.0, 0.0, 0.0, 0.0, 12.0, 776.0, 20.0, 19.0, 11.0, 13.0, 1.0, 3.0, 0.0, 11.0, 0.0, 0.0, 810.0, 776.0, 1.0, 0.0, 21.0, 16.0, 808.0, 8.0, 575.0, 0.0, 13.0, 8.0, 3.0, 0.0, 10.0, 0.0, 0.0, 880.0, 0.0, 0.0, 1034.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7838761029928298, "mean_inference_ms": 28.61651197004526, "mean_action_processing_ms": 0.7833646750014884, "mean_env_wait_ms": 0.6180501588810633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027083635330200195, "StateBufferConnector_ms": 0.009729146957397461, "ViewRequirementAgentConnector_ms": 0.446270227432251}, "num_episodes": 18, "episode_return_max": 119.0, "episode_return_min": -987.0, "episode_return_mean": -167.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 127.41900658200277, "num_env_steps_trained_throughput_per_sec": 127.41900658200277, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 29491.184, "restore_workers_time_ms": 0.023, "training_step_time_ms": 29491.066, "sample_time_ms": 5960.731, "learn_time_ms": 23485.172, "learn_throughput": 170.32, "synch_weights_time_ms": 39.284}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "4f45b_00000", "date": "2024-08-13_03-01-10", "timestamp": 1723532470, "time_this_iter_s": 31.430254220962524, "time_total_s": 6201.105829715729, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24a89d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6201.105829715729, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 87.72888888888889, "ram_util_percent": 83.16222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6603491898330431, "cur_kl_coeff": 0.020022583007812504, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7799232908657618, "policy_loss": -0.002411685367090204, "vf_loss": 1.7820941033817472, "vf_explained_var": 0.006364255418222417, "kl": 0.012030155698063464, "entropy": 0.6883172139288887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.195345512800234, "cur_kl_coeff": 0.00032958984375, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2717964172047913, "policy_loss": -0.0015904523215438955, "vf_loss": 2.2733860039837146, "vf_explained_var": 0.00020239848308462315, "kl": 0.0026151680999458014, "entropy": 0.6758964345253334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 534.0, "episode_reward_min": -987.0, "episode_reward_mean": -173.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1358.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 1362.0}, "policy_reward_mean": {"prey_policy": -232.58, "predator_policy": 145.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-501.0, -317.0, -543.0, -431.0, -418.0, 6.0, -38.0, -2.0, 0.0, -551.0, -620.0, 0.0, 0.0, -7.0, 4.0, -39.0, 0.0, -623.0, -536.0, 0.0, -917.0, -835.0, -745.0, -785.0, -10.0, -709.0, -576.0, -347.0, -987.0, -1.0, 0.0, -255.0, 7.0, -8.0, -7.0, 3.0, -650.0, 0.0, -12.0, 1.0, 105.0, 17.0, -707.0, 16.0, 8.0, -516.0, 119.0, -6.0, -6.0, 10.0, 0.0, 5.0, -17.0, -842.0, 2.0, -24.0, -644.0, -15.0, -7.0, -4.0, 11.0, -501.0, 1.0, 4.0, 2.0, -11.0, 0.0, 61.0, 2.0, -5.0, -585.0, -523.0, 15.0, -3.0, -22.0, -65.0, 0.0, -560.0, -13.0, 0.0, -454.0, 0.0, 0.0, -544.0, -16.0, 0.0, 10.0, -391.0, 4.0, 1.0, -25.0, -7.0, -1.0, -3.0, 534.0, 4.0, -5.0, -141.0, -177.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-414.0, -350.0, -340.0, -198.0, -496.0, -408.0, -378.0, -267.0, -283.0, -306.0, 0.0, -27.0, -18.0, -58.0, -4.0, 0.0, 0.0, 0.0, -414.0, -416.0, -484.0, -546.0, 0.0, 0.0, -35.0, -8.0, -11.0, -37.0, 0.0, -28.0, -56.0, -15.0, 0.0, 0.0, -470.0, -494.0, -403.0, -440.0, 0.0, 0.0, -963.0, -1144.0, -802.0, -948.0, -828.0, -798.0, -702.0, -728.0, -21.0, -8.0, -760.0, -722.0, -512.0, -531.0, -501.0, -408.0, -957.0, -1049.0, -9.0, -24.0, 0.0, 0.0, -344.0, -461.0, 0.0, 7.0, 0.0, -22.0, -48.0, 13.0, 0.0, -28.0, -714.0, -723.0, 0.0, 0.0, -24.0, 0.0, 0.0, -5.0, -1249.0, -529.0, -2.0, 5.0, -1126.0, -618.0, 17.0, -4.0, 9.0, -7.0, -884.0, -662.0, -912.0, -184.0, 0.0, -12.0, 0.0, -58.0, 5.0, 5.0, 0.0, 0.0, -16.0, 0.0, -16.0, -34.0, -859.0, -1358.0, -22.0, 13.0, -28.0, -11.0, -757.0, -670.0, -47.0, 0.0, 0.0, -18.0, 0.0, -8.0, 9.0, 2.0, -481.0, -808.0, -38.0, 0.0, 0.0, -20.0, -2.0, 0.0, -14.0, -8.0, 0.0, 0.0, -1056.0, -469.0, 0.0, 1.0, 0.0, -42.0, -799.0, -602.0, -492.0, -606.0, 9.0, -15.0, -6.0, 0.0, -20.0, -12.0, -945.0, 0.0, 0.0, 0.0, -721.0, -895.0, 0.0, -50.0, 0.0, 0.0, -315.0, -305.0, 0.0, 0.0, 0.0, 0.0, -464.0, -912.0, 0.0, -45.0, 0.0, 0.0, 0.0, 6.0, -302.0, -1042.0, 1.0, 0.0, 0.0, -5.0, -14.0, -50.0, -20.0, 0.0, 0.0, -22.0, 0.0, -6.0, -380.0, -1306.0, 0.0, -28.0, -24.0, 0.0, -642.0, 0.0, 0.0, -356.0, 0.0, 0.0], "policy_predator_policy_reward": [255.0, 8.0, 1.0, 220.0, 361.0, 0.0, 193.0, 21.0, 15.0, 156.0, 15.0, 18.0, 29.0, 9.0, 0.0, 2.0, 0.0, 0.0, 271.0, 8.0, 406.0, 4.0, 0.0, 0.0, 25.0, 18.0, 18.0, 23.0, 16.0, 16.0, 11.0, 21.0, 0.0, 0.0, 341.0, 0.0, 16.0, 291.0, 0.0, 0.0, 1190.0, 0.0, 0.0, 915.0, 872.0, 9.0, 641.0, 4.0, 13.0, 6.0, 0.0, 773.0, 10.0, 457.0, 4.0, 558.0, 24.0, 995.0, 10.0, 22.0, 0.0, 0.0, 314.0, 236.0, 0.0, 0.0, 8.0, 6.0, 4.0, 24.0, 17.0, 14.0, 0.0, 787.0, 0.0, 0.0, 12.0, 0.0, 5.0, 1.0, 844.0, 1039.0, 11.0, 3.0, 1023.0, 14.0, 3.0, 0.0, 2.0, 4.0, 1007.0, 23.0, 582.0, 633.0, 6.0, 0.0, 26.0, 26.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 10.0, 23.0, 13.0, 1362.0, 11.0, 0.0, 0.0, 15.0, 783.0, 0.0, 16.0, 16.0, 8.0, 3.0, 4.0, 0.0, 0.0, 0.0, 12.0, 776.0, 20.0, 19.0, 11.0, 13.0, 1.0, 3.0, 0.0, 11.0, 0.0, 0.0, 810.0, 776.0, 1.0, 0.0, 21.0, 16.0, 808.0, 8.0, 575.0, 0.0, 13.0, 8.0, 3.0, 0.0, 10.0, 0.0, 0.0, 880.0, 0.0, 0.0, 1034.0, 22.0, 17.0, 20.0, 0.0, 0.0, 142.0, 24.0, 0.0, 0.0, 0.0, 0.0, 824.0, 8.0, 7.0, 22.0, 0.0, 0.0, 1.0, 3.0, 17.0, 936.0, 1.0, 2.0, 0.0, 6.0, 18.0, 21.0, 10.0, 3.0, 10.0, 11.0, 0.0, 3.0, 1074.0, 1146.0, 17.0, 15.0, 6.0, 13.0, 0.0, 501.0, 11.0, 168.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7856665708210062, "mean_inference_ms": 28.32552657614482, "mean_action_processing_ms": 0.7820895642199973, "mean_env_wait_ms": 0.6185419490112994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023289799690246582, "StateBufferConnector_ms": 0.008417606353759766, "ViewRequirementAgentConnector_ms": 0.370630145072937}, "num_episodes": 22, "episode_return_max": 534.0, "episode_return_min": -987.0, "episode_return_mean": -173.58, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 127.42463604261012, "num_env_steps_trained_throughput_per_sec": 127.42463604261012, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 30014.343, "restore_workers_time_ms": 0.023, "training_step_time_ms": 30014.227, "sample_time_ms": 5802.29, "learn_time_ms": 24167.031, "learn_throughput": 165.515, "synch_weights_time_ms": 39.254}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "4f45b_00000", "date": "2024-08-13_03-01-42", "timestamp": 1723532502, "time_this_iter_s": 31.446642875671387, "time_total_s": 6232.5524725914, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2725940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6232.5524725914, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 87.07954545454545, "ram_util_percent": 83.11363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.704237669233292, "cur_kl_coeff": 0.020022583007812504, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4010054274210852, "policy_loss": -7.562803636704172e-05, "vf_loss": 3.40100163694412, "vf_explained_var": 0.008714421148653383, "kl": 0.003966562409977205, "entropy": 0.6623897730358064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0970881464107642, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.825787136794398, "policy_loss": -0.006678047348503713, "vf_loss": 4.832463904032632, "vf_explained_var": 0.0002148611520333265, "kl": 0.007815151697731624, "entropy": 0.7345111926396688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 534.0, "episode_reward_min": -987.0, "episode_reward_mean": -163.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1358.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 1362.0}, "policy_reward_mean": {"prey_policy": -241.53, "predator_policy": 159.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-536.0, 0.0, -917.0, -835.0, -745.0, -785.0, -10.0, -709.0, -576.0, -347.0, -987.0, -1.0, 0.0, -255.0, 7.0, -8.0, -7.0, 3.0, -650.0, 0.0, -12.0, 1.0, 105.0, 17.0, -707.0, 16.0, 8.0, -516.0, 119.0, -6.0, -6.0, 10.0, 0.0, 5.0, -17.0, -842.0, 2.0, -24.0, -644.0, -15.0, -7.0, -4.0, 11.0, -501.0, 1.0, 4.0, 2.0, -11.0, 0.0, 61.0, 2.0, -5.0, -585.0, -523.0, 15.0, -3.0, -22.0, -65.0, 0.0, -560.0, -13.0, 0.0, -454.0, 0.0, 0.0, -544.0, -16.0, 0.0, 10.0, -391.0, 4.0, 1.0, -25.0, -7.0, -1.0, -3.0, 534.0, 4.0, -5.0, -141.0, -177.0, 0.0, -345.0, -222.0, -492.0, -180.0, -548.0, -6.0, 5.0, -160.0, -28.0, -305.0, -3.0, -408.0, -23.0, 6.0, 10.0, -217.0, -92.0, -92.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-403.0, -440.0, 0.0, 0.0, -963.0, -1144.0, -802.0, -948.0, -828.0, -798.0, -702.0, -728.0, -21.0, -8.0, -760.0, -722.0, -512.0, -531.0, -501.0, -408.0, -957.0, -1049.0, -9.0, -24.0, 0.0, 0.0, -344.0, -461.0, 0.0, 7.0, 0.0, -22.0, -48.0, 13.0, 0.0, -28.0, -714.0, -723.0, 0.0, 0.0, -24.0, 0.0, 0.0, -5.0, -1249.0, -529.0, -2.0, 5.0, -1126.0, -618.0, 17.0, -4.0, 9.0, -7.0, -884.0, -662.0, -912.0, -184.0, 0.0, -12.0, 0.0, -58.0, 5.0, 5.0, 0.0, 0.0, -16.0, 0.0, -16.0, -34.0, -859.0, -1358.0, -22.0, 13.0, -28.0, -11.0, -757.0, -670.0, -47.0, 0.0, 0.0, -18.0, 0.0, -8.0, 9.0, 2.0, -481.0, -808.0, -38.0, 0.0, 0.0, -20.0, -2.0, 0.0, -14.0, -8.0, 0.0, 0.0, -1056.0, -469.0, 0.0, 1.0, 0.0, -42.0, -799.0, -602.0, -492.0, -606.0, 9.0, -15.0, -6.0, 0.0, -20.0, -12.0, -945.0, 0.0, 0.0, 0.0, -721.0, -895.0, 0.0, -50.0, 0.0, 0.0, -315.0, -305.0, 0.0, 0.0, 0.0, 0.0, -464.0, -912.0, 0.0, -45.0, 0.0, 0.0, 0.0, 6.0, -302.0, -1042.0, 1.0, 0.0, 0.0, -5.0, -14.0, -50.0, -20.0, 0.0, 0.0, -22.0, 0.0, -6.0, -380.0, -1306.0, 0.0, -28.0, -24.0, 0.0, -642.0, 0.0, 0.0, -356.0, 0.0, 0.0, -853.0, -299.0, -184.0, -528.0, -315.0, -360.0, -537.0, -77.0, -358.0, -390.0, -22.0, 0.0, -35.0, 0.0, 0.0, -410.0, -4.0, -48.0, -208.0, -508.0, -28.0, -10.0, -313.0, -920.0, 0.0, -48.0, -40.0, 3.0, 6.0, 4.0, -296.0, -95.0, -1086.0, -18.0, -374.0, 0.0], "policy_predator_policy_reward": [16.0, 291.0, 0.0, 0.0, 1190.0, 0.0, 0.0, 915.0, 872.0, 9.0, 641.0, 4.0, 13.0, 6.0, 0.0, 773.0, 10.0, 457.0, 4.0, 558.0, 24.0, 995.0, 10.0, 22.0, 0.0, 0.0, 314.0, 236.0, 0.0, 0.0, 8.0, 6.0, 4.0, 24.0, 17.0, 14.0, 0.0, 787.0, 0.0, 0.0, 12.0, 0.0, 5.0, 1.0, 844.0, 1039.0, 11.0, 3.0, 1023.0, 14.0, 3.0, 0.0, 2.0, 4.0, 1007.0, 23.0, 582.0, 633.0, 6.0, 0.0, 26.0, 26.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 10.0, 23.0, 13.0, 1362.0, 11.0, 0.0, 0.0, 15.0, 783.0, 0.0, 16.0, 16.0, 8.0, 3.0, 4.0, 0.0, 0.0, 0.0, 12.0, 776.0, 20.0, 19.0, 11.0, 13.0, 1.0, 3.0, 0.0, 11.0, 0.0, 0.0, 810.0, 776.0, 1.0, 0.0, 21.0, 16.0, 808.0, 8.0, 575.0, 0.0, 13.0, 8.0, 3.0, 0.0, 10.0, 0.0, 0.0, 880.0, 0.0, 0.0, 1034.0, 22.0, 17.0, 20.0, 0.0, 0.0, 142.0, 24.0, 0.0, 0.0, 0.0, 0.0, 824.0, 8.0, 7.0, 22.0, 0.0, 0.0, 1.0, 3.0, 17.0, 936.0, 1.0, 2.0, 0.0, 6.0, 18.0, 21.0, 10.0, 3.0, 10.0, 11.0, 0.0, 3.0, 1074.0, 1146.0, 17.0, 15.0, 6.0, 13.0, 0.0, 501.0, 11.0, 168.0, 0.0, 0.0, 765.0, 42.0, 489.0, 1.0, 3.0, 180.0, 31.0, 403.0, 200.0, 0.0, 0.0, 16.0, 21.0, 19.0, 12.0, 238.0, 24.0, 0.0, 408.0, 3.0, 20.0, 15.0, 0.0, 825.0, 1.0, 24.0, 22.0, 21.0, 0.0, 0.0, 171.0, 3.0, 9.0, 1003.0, 282.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7914234042758639, "mean_inference_ms": 28.104999728806725, "mean_action_processing_ms": 0.7846550832275616, "mean_env_wait_ms": 0.6205523102397236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02168893814086914, "StateBufferConnector_ms": 0.008547782897949219, "ViewRequirementAgentConnector_ms": 0.40785694122314453}, "num_episodes": 18, "episode_return_max": 534.0, "episode_return_min": -987.0, "episode_return_mean": -163.78, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.6272345932768, "num_env_steps_trained_throughput_per_sec": 129.6272345932768, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 30380.325, "restore_workers_time_ms": 0.021, "training_step_time_ms": 30380.226, "sample_time_ms": 5483.734, "learn_time_ms": 24851.245, "learn_throughput": 160.958, "synch_weights_time_ms": 40.109}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "4f45b_00000", "date": "2024-08-13_03-02-13", "timestamp": 1723532533, "time_this_iter_s": 30.920953035354614, "time_total_s": 6263.473425626755, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b245be50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6263.473425626755, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 87.73181818181818, "ram_util_percent": 83.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4057921162358036, "cur_kl_coeff": 0.010011291503906252, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.973830348915524, "policy_loss": -0.0029543695452736406, "vf_loss": 2.976667187579725, "vf_explained_var": 0.032626948407087374, "kl": 0.01173917050729733, "entropy": 0.6338546841548234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7134631020800462, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.173790981088366, "policy_loss": -0.004542407326932465, "vf_loss": 3.178332497329308, "vf_explained_var": 0.00220563153110484, "kl": 0.005428136083433115, "entropy": 0.7532209258861643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 534.0, "episode_reward_min": -842.0, "episode_reward_mean": -102.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1358.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 1362.0}, "policy_reward_mean": {"prey_policy": -173.85, "predator_policy": 122.445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, -707.0, 16.0, 8.0, -516.0, 119.0, -6.0, -6.0, 10.0, 0.0, 5.0, -17.0, -842.0, 2.0, -24.0, -644.0, -15.0, -7.0, -4.0, 11.0, -501.0, 1.0, 4.0, 2.0, -11.0, 0.0, 61.0, 2.0, -5.0, -585.0, -523.0, 15.0, -3.0, -22.0, -65.0, 0.0, -560.0, -13.0, 0.0, -454.0, 0.0, 0.0, -544.0, -16.0, 0.0, 10.0, -391.0, 4.0, 1.0, -25.0, -7.0, -1.0, -3.0, 534.0, 4.0, -5.0, -141.0, -177.0, 0.0, -345.0, -222.0, -492.0, -180.0, -548.0, -6.0, 5.0, -160.0, -28.0, -305.0, -3.0, -408.0, -23.0, 6.0, 10.0, -217.0, -92.0, -92.0, -9.0, 0.0, 0.0, -14.0, -168.0, 4.0, 91.0, -199.0, -3.0, -19.0, -137.0, -11.0, 0.0, -15.0, -18.0, -40.0, -1.0, -3.0, -202.0, -44.0, 0.0, -263.0, -116.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 5.0, -1126.0, -618.0, 17.0, -4.0, 9.0, -7.0, -884.0, -662.0, -912.0, -184.0, 0.0, -12.0, 0.0, -58.0, 5.0, 5.0, 0.0, 0.0, -16.0, 0.0, -16.0, -34.0, -859.0, -1358.0, -22.0, 13.0, -28.0, -11.0, -757.0, -670.0, -47.0, 0.0, 0.0, -18.0, 0.0, -8.0, 9.0, 2.0, -481.0, -808.0, -38.0, 0.0, 0.0, -20.0, -2.0, 0.0, -14.0, -8.0, 0.0, 0.0, -1056.0, -469.0, 0.0, 1.0, 0.0, -42.0, -799.0, -602.0, -492.0, -606.0, 9.0, -15.0, -6.0, 0.0, -20.0, -12.0, -945.0, 0.0, 0.0, 0.0, -721.0, -895.0, 0.0, -50.0, 0.0, 0.0, -315.0, -305.0, 0.0, 0.0, 0.0, 0.0, -464.0, -912.0, 0.0, -45.0, 0.0, 0.0, 0.0, 6.0, -302.0, -1042.0, 1.0, 0.0, 0.0, -5.0, -14.0, -50.0, -20.0, 0.0, 0.0, -22.0, 0.0, -6.0, -380.0, -1306.0, 0.0, -28.0, -24.0, 0.0, -642.0, 0.0, 0.0, -356.0, 0.0, 0.0, -853.0, -299.0, -184.0, -528.0, -315.0, -360.0, -537.0, -77.0, -358.0, -390.0, -22.0, 0.0, -35.0, 0.0, 0.0, -410.0, -4.0, -48.0, -208.0, -508.0, -28.0, -10.0, -313.0, -920.0, 0.0, -48.0, -40.0, 3.0, 6.0, 4.0, -296.0, -95.0, -1086.0, -18.0, -374.0, 0.0, -13.0, -28.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, -64.0, -266.0, -2.0, -7.0, -228.0, -502.0, -107.0, -234.0, 0.0, -15.0, 0.0, -71.0, -135.0, -92.0, -23.0, -32.0, 0.0, 0.0, -58.0, -4.0, -17.0, -50.0, -23.0, -62.0, -2.0, 0.0, -77.0, 0.0, -318.0, -322.0, -76.0, -290.0, 0.0, 0.0, -108.0, -343.0, 0.0, -232.0], "policy_predator_policy_reward": [11.0, 3.0, 1023.0, 14.0, 3.0, 0.0, 2.0, 4.0, 1007.0, 23.0, 582.0, 633.0, 6.0, 0.0, 26.0, 26.0, 0.0, 0.0, 0.0, 0.0, 11.0, 10.0, 10.0, 23.0, 13.0, 1362.0, 11.0, 0.0, 0.0, 15.0, 783.0, 0.0, 16.0, 16.0, 8.0, 3.0, 4.0, 0.0, 0.0, 0.0, 12.0, 776.0, 20.0, 19.0, 11.0, 13.0, 1.0, 3.0, 0.0, 11.0, 0.0, 0.0, 810.0, 776.0, 1.0, 0.0, 21.0, 16.0, 808.0, 8.0, 575.0, 0.0, 13.0, 8.0, 3.0, 0.0, 10.0, 0.0, 0.0, 880.0, 0.0, 0.0, 1034.0, 22.0, 17.0, 20.0, 0.0, 0.0, 142.0, 24.0, 0.0, 0.0, 0.0, 0.0, 824.0, 8.0, 7.0, 22.0, 0.0, 0.0, 1.0, 3.0, 17.0, 936.0, 1.0, 2.0, 0.0, 6.0, 18.0, 21.0, 10.0, 3.0, 10.0, 11.0, 0.0, 3.0, 1074.0, 1146.0, 17.0, 15.0, 6.0, 13.0, 0.0, 501.0, 11.0, 168.0, 0.0, 0.0, 765.0, 42.0, 489.0, 1.0, 3.0, 180.0, 31.0, 403.0, 200.0, 0.0, 0.0, 16.0, 21.0, 19.0, 12.0, 238.0, 24.0, 0.0, 408.0, 3.0, 20.0, 15.0, 0.0, 825.0, 1.0, 24.0, 22.0, 21.0, 0.0, 0.0, 171.0, 3.0, 9.0, 1003.0, 282.0, 0.0, 10.0, 22.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 139.0, 23.0, 6.0, 7.0, 410.0, 411.0, 7.0, 135.0, 11.0, 1.0, 23.0, 29.0, 0.0, 90.0, 18.0, 26.0, 0.0, 0.0, 23.0, 24.0, 24.0, 25.0, 22.0, 23.0, 0.0, 1.0, 36.0, 38.0, 220.0, 218.0, 161.0, 161.0, 0.0, 0.0, 170.0, 18.0, 116.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7940551590461695, "mean_inference_ms": 27.82287370717513, "mean_action_processing_ms": 0.7853579040587867, "mean_env_wait_ms": 0.6211192619902149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028530120849609375, "StateBufferConnector_ms": 0.00897371768951416, "ViewRequirementAgentConnector_ms": 0.39510786533355713}, "num_episodes": 23, "episode_return_max": 534.0, "episode_return_min": -842.0, "episode_return_mean": -102.81, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.55429071498892, "num_env_steps_trained_throughput_per_sec": 129.55429071498892, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 30434.709, "restore_workers_time_ms": 0.02, "training_step_time_ms": 30434.612, "sample_time_ms": 5007.609, "learn_time_ms": 25387.604, "learn_throughput": 157.557, "synch_weights_time_ms": 34.014}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "4f45b_00000", "date": "2024-08-13_03-02-44", "timestamp": 1723532564, "time_this_iter_s": 30.94987416267395, "time_total_s": 6294.423299789429, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24d8310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6294.423299789429, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 87.30000000000001, "ram_util_percent": 83.24772727272726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8004242376281472, "cur_kl_coeff": 0.010011291503906252, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6314454720764564, "policy_loss": -0.0012784498800380677, "vf_loss": 2.632674533854086, "vf_explained_var": 0.029674170729975222, "kl": 0.0049337575184928975, "entropy": 0.5694323114932529, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4457569247831112, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3543728136827076, "policy_loss": -0.008094783483452543, "vf_loss": 2.3624661998143273, "vf_explained_var": 0.01390933596267902, "kl": 0.008501610935169839, "entropy": 0.8240247541319126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 534.0, "episode_reward_min": -585.0, "episode_reward_mean": -84.29, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1306.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 9.0, "predator_policy": 1146.0}, "policy_reward_mean": {"prey_policy": -142.09, "predator_policy": 99.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, 11.0, -501.0, 1.0, 4.0, 2.0, -11.0, 0.0, 61.0, 2.0, -5.0, -585.0, -523.0, 15.0, -3.0, -22.0, -65.0, 0.0, -560.0, -13.0, 0.0, -454.0, 0.0, 0.0, -544.0, -16.0, 0.0, 10.0, -391.0, 4.0, 1.0, -25.0, -7.0, -1.0, -3.0, 534.0, 4.0, -5.0, -141.0, -177.0, 0.0, -345.0, -222.0, -492.0, -180.0, -548.0, -6.0, 5.0, -160.0, -28.0, -305.0, -3.0, -408.0, -23.0, 6.0, 10.0, -217.0, -92.0, -92.0, -9.0, 0.0, 0.0, -14.0, -168.0, 4.0, 91.0, -199.0, -3.0, -19.0, -137.0, -11.0, 0.0, -15.0, -18.0, -40.0, -1.0, -3.0, -202.0, -44.0, 0.0, -263.0, -116.0, 7.0, 0.0, 0.0, -100.0, -14.0, -22.0, -176.0, 0.0, -61.0, -2.0, -47.0, -109.0, 0.0, -166.0, -26.0, -23.0, -5.0, -11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -8.0, 9.0, 2.0, -481.0, -808.0, -38.0, 0.0, 0.0, -20.0, -2.0, 0.0, -14.0, -8.0, 0.0, 0.0, -1056.0, -469.0, 0.0, 1.0, 0.0, -42.0, -799.0, -602.0, -492.0, -606.0, 9.0, -15.0, -6.0, 0.0, -20.0, -12.0, -945.0, 0.0, 0.0, 0.0, -721.0, -895.0, 0.0, -50.0, 0.0, 0.0, -315.0, -305.0, 0.0, 0.0, 0.0, 0.0, -464.0, -912.0, 0.0, -45.0, 0.0, 0.0, 0.0, 6.0, -302.0, -1042.0, 1.0, 0.0, 0.0, -5.0, -14.0, -50.0, -20.0, 0.0, 0.0, -22.0, 0.0, -6.0, -380.0, -1306.0, 0.0, -28.0, -24.0, 0.0, -642.0, 0.0, 0.0, -356.0, 0.0, 0.0, -853.0, -299.0, -184.0, -528.0, -315.0, -360.0, -537.0, -77.0, -358.0, -390.0, -22.0, 0.0, -35.0, 0.0, 0.0, -410.0, -4.0, -48.0, -208.0, -508.0, -28.0, -10.0, -313.0, -920.0, 0.0, -48.0, -40.0, 3.0, 6.0, 4.0, -296.0, -95.0, -1086.0, -18.0, -374.0, 0.0, -13.0, -28.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, -64.0, -266.0, -2.0, -7.0, -228.0, -502.0, -107.0, -234.0, 0.0, -15.0, 0.0, -71.0, -135.0, -92.0, -23.0, -32.0, 0.0, 0.0, -58.0, -4.0, -17.0, -50.0, -23.0, -62.0, -2.0, 0.0, -77.0, 0.0, -318.0, -322.0, -76.0, -290.0, 0.0, 0.0, -108.0, -343.0, 0.0, -232.0, -20.0, -4.0, 0.0, 0.0, 0.0, 0.0, -152.0, -158.0, -12.0, -10.0, -98.0, 0.0, -10.0, -342.0, 0.0, 0.0, -42.0, -75.0, -17.0, -8.0, -99.0, 0.0, -228.0, 0.0, 0.0, 0.0, -96.0, -190.0, -54.0, 0.0, -175.0, -50.0, 0.0, -20.0, -29.0, -10.0], "policy_predator_policy_reward": [4.0, 0.0, 0.0, 0.0, 12.0, 776.0, 20.0, 19.0, 11.0, 13.0, 1.0, 3.0, 0.0, 11.0, 0.0, 0.0, 810.0, 776.0, 1.0, 0.0, 21.0, 16.0, 808.0, 8.0, 575.0, 0.0, 13.0, 8.0, 3.0, 0.0, 10.0, 0.0, 0.0, 880.0, 0.0, 0.0, 1034.0, 22.0, 17.0, 20.0, 0.0, 0.0, 142.0, 24.0, 0.0, 0.0, 0.0, 0.0, 824.0, 8.0, 7.0, 22.0, 0.0, 0.0, 1.0, 3.0, 17.0, 936.0, 1.0, 2.0, 0.0, 6.0, 18.0, 21.0, 10.0, 3.0, 10.0, 11.0, 0.0, 3.0, 1074.0, 1146.0, 17.0, 15.0, 6.0, 13.0, 0.0, 501.0, 11.0, 168.0, 0.0, 0.0, 765.0, 42.0, 489.0, 1.0, 3.0, 180.0, 31.0, 403.0, 200.0, 0.0, 0.0, 16.0, 21.0, 19.0, 12.0, 238.0, 24.0, 0.0, 408.0, 3.0, 20.0, 15.0, 0.0, 825.0, 1.0, 24.0, 22.0, 21.0, 0.0, 0.0, 171.0, 3.0, 9.0, 1003.0, 282.0, 0.0, 10.0, 22.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 139.0, 23.0, 6.0, 7.0, 410.0, 411.0, 7.0, 135.0, 11.0, 1.0, 23.0, 29.0, 0.0, 90.0, 18.0, 26.0, 0.0, 0.0, 23.0, 24.0, 24.0, 25.0, 22.0, 23.0, 0.0, 1.0, 36.0, 38.0, 220.0, 218.0, 161.0, 161.0, 0.0, 0.0, 170.0, 18.0, 116.0, 0.0, 18.0, 13.0, 0.0, 0.0, 0.0, 0.0, 101.0, 109.0, 8.0, 0.0, 36.0, 40.0, 174.0, 2.0, 0.0, 0.0, 21.0, 35.0, 20.0, 3.0, 11.0, 41.0, 97.0, 22.0, 0.0, 0.0, 18.0, 102.0, 4.0, 24.0, 101.0, 101.0, 8.0, 7.0, 14.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7970605308523029, "mean_inference_ms": 27.601677651681793, "mean_action_processing_ms": 0.7855660731338806, "mean_env_wait_ms": 0.6220861206217461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02990090847015381, "StateBufferConnector_ms": 0.011021614074707031, "ViewRequirementAgentConnector_ms": 0.37871694564819336}, "num_episodes": 18, "episode_return_max": 534.0, "episode_return_min": -585.0, "episode_return_mean": -84.29, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.84795125818651, "num_env_steps_trained_throughput_per_sec": 125.84795125818651, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 30823.578, "restore_workers_time_ms": 0.02, "training_step_time_ms": 30823.482, "sample_time_ms": 4707.645, "learn_time_ms": 26080.489, "learn_throughput": 153.371, "synch_weights_time_ms": 29.699}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "4f45b_00000", "date": "2024-08-13_03-03-15", "timestamp": 1723532595, "time_this_iter_s": 31.836923837661743, "time_total_s": 6326.26022362709, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2725670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6326.26022362709, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 87.52000000000001, "ram_util_percent": 83.24000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.184845726609861, "cur_kl_coeff": 0.005005645751953126, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.327046476596247, "policy_loss": -0.0022443983257900944, "vf_loss": 3.329265134927457, "vf_explained_var": 0.012082782403501883, "kl": 0.005143162515115415, "entropy": 0.626815677509106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8255603581272737, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1264898332338484, "policy_loss": -0.00452614161900427, "vf_loss": 3.13101480934355, "vf_explained_var": 0.03688950393565748, "kl": 0.007112807109671521, "entropy": 0.9357717561027991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 534.0, "episode_reward_min": -560.0, "episode_reward_mean": -73.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1306.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 10.0, "predator_policy": 1146.0}, "policy_reward_mean": {"prey_policy": -117.98, "predator_policy": 81.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-560.0, -13.0, 0.0, -454.0, 0.0, 0.0, -544.0, -16.0, 0.0, 10.0, -391.0, 4.0, 1.0, -25.0, -7.0, -1.0, -3.0, 534.0, 4.0, -5.0, -141.0, -177.0, 0.0, -345.0, -222.0, -492.0, -180.0, -548.0, -6.0, 5.0, -160.0, -28.0, -305.0, -3.0, -408.0, -23.0, 6.0, 10.0, -217.0, -92.0, -92.0, -9.0, 0.0, 0.0, -14.0, -168.0, 4.0, 91.0, -199.0, -3.0, -19.0, -137.0, -11.0, 0.0, -15.0, -18.0, -40.0, -1.0, -3.0, -202.0, -44.0, 0.0, -263.0, -116.0, 7.0, 0.0, 0.0, -100.0, -14.0, -22.0, -176.0, 0.0, -61.0, -2.0, -47.0, -109.0, 0.0, -166.0, -26.0, -23.0, -5.0, -11.0, 0.0, -55.0, -16.0, -74.0, -3.0, 46.0, -22.0, -77.0, 0.0, -2.0, -23.0, -222.0, -6.0, -33.0, -17.0, -2.0, -12.0, -66.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-721.0, -895.0, 0.0, -50.0, 0.0, 0.0, -315.0, -305.0, 0.0, 0.0, 0.0, 0.0, -464.0, -912.0, 0.0, -45.0, 0.0, 0.0, 0.0, 6.0, -302.0, -1042.0, 1.0, 0.0, 0.0, -5.0, -14.0, -50.0, -20.0, 0.0, 0.0, -22.0, 0.0, -6.0, -380.0, -1306.0, 0.0, -28.0, -24.0, 0.0, -642.0, 0.0, 0.0, -356.0, 0.0, 0.0, -853.0, -299.0, -184.0, -528.0, -315.0, -360.0, -537.0, -77.0, -358.0, -390.0, -22.0, 0.0, -35.0, 0.0, 0.0, -410.0, -4.0, -48.0, -208.0, -508.0, -28.0, -10.0, -313.0, -920.0, 0.0, -48.0, -40.0, 3.0, 6.0, 4.0, -296.0, -95.0, -1086.0, -18.0, -374.0, 0.0, -13.0, -28.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, -64.0, -266.0, -2.0, -7.0, -228.0, -502.0, -107.0, -234.0, 0.0, -15.0, 0.0, -71.0, -135.0, -92.0, -23.0, -32.0, 0.0, 0.0, -58.0, -4.0, -17.0, -50.0, -23.0, -62.0, -2.0, 0.0, -77.0, 0.0, -318.0, -322.0, -76.0, -290.0, 0.0, 0.0, -108.0, -343.0, 0.0, -232.0, -20.0, -4.0, 0.0, 0.0, 0.0, 0.0, -152.0, -158.0, -12.0, -10.0, -98.0, 0.0, -10.0, -342.0, 0.0, 0.0, -42.0, -75.0, -17.0, -8.0, -99.0, 0.0, -228.0, 0.0, 0.0, 0.0, -96.0, -190.0, -54.0, 0.0, -175.0, -50.0, 0.0, -20.0, -29.0, -10.0, 0.0, 0.0, -96.0, -16.0, -16.0, -22.0, -60.0, -104.0, 0.0, -58.0, 2.0, 10.0, -48.0, -36.0, -143.0, -16.0, 0.0, 0.0, 0.0, -25.0, 0.0, -47.0, -251.0, -105.0, -15.0, 0.0, -46.0, -42.0, 0.0, -34.0, -140.0, -66.0, 0.0, -62.0, -108.0, -56.0], "policy_predator_policy_reward": [1034.0, 22.0, 17.0, 20.0, 0.0, 0.0, 142.0, 24.0, 0.0, 0.0, 0.0, 0.0, 824.0, 8.0, 7.0, 22.0, 0.0, 0.0, 1.0, 3.0, 17.0, 936.0, 1.0, 2.0, 0.0, 6.0, 18.0, 21.0, 10.0, 3.0, 10.0, 11.0, 0.0, 3.0, 1074.0, 1146.0, 17.0, 15.0, 6.0, 13.0, 0.0, 501.0, 11.0, 168.0, 0.0, 0.0, 765.0, 42.0, 489.0, 1.0, 3.0, 180.0, 31.0, 403.0, 200.0, 0.0, 0.0, 16.0, 21.0, 19.0, 12.0, 238.0, 24.0, 0.0, 408.0, 3.0, 20.0, 15.0, 0.0, 825.0, 1.0, 24.0, 22.0, 21.0, 0.0, 0.0, 171.0, 3.0, 9.0, 1003.0, 282.0, 0.0, 10.0, 22.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 139.0, 23.0, 6.0, 7.0, 410.0, 411.0, 7.0, 135.0, 11.0, 1.0, 23.0, 29.0, 0.0, 90.0, 18.0, 26.0, 0.0, 0.0, 23.0, 24.0, 24.0, 25.0, 22.0, 23.0, 0.0, 1.0, 36.0, 38.0, 220.0, 218.0, 161.0, 161.0, 0.0, 0.0, 170.0, 18.0, 116.0, 0.0, 18.0, 13.0, 0.0, 0.0, 0.0, 0.0, 101.0, 109.0, 8.0, 0.0, 36.0, 40.0, 174.0, 2.0, 0.0, 0.0, 21.0, 35.0, 20.0, 3.0, 11.0, 41.0, 97.0, 22.0, 0.0, 0.0, 18.0, 102.0, 4.0, 24.0, 101.0, 101.0, 8.0, 7.0, 14.0, 14.0, 0.0, 0.0, 26.0, 31.0, 22.0, 0.0, 36.0, 54.0, 28.0, 27.0, 17.0, 17.0, 32.0, 30.0, 74.0, 8.0, 0.0, 0.0, 7.0, 16.0, 0.0, 24.0, 9.0, 125.0, 1.0, 8.0, 33.0, 22.0, 17.0, 0.0, 102.0, 102.0, 22.0, 28.0, 52.0, 46.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7990031023428008, "mean_inference_ms": 27.380434515267048, "mean_action_processing_ms": 0.7857798818049838, "mean_env_wait_ms": 0.6226192815223606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017954468727111816, "StateBufferConnector_ms": 0.010817646980285645, "ViewRequirementAgentConnector_ms": 0.35736703872680664}, "num_episodes": 18, "episode_return_max": 534.0, "episode_return_min": -560.0, "episode_return_mean": -73.9, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.543144605843, "num_env_steps_trained_throughput_per_sec": 128.543144605843, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 30748.167, "restore_workers_time_ms": 0.019, "training_step_time_ms": 30748.075, "sample_time_ms": 4360.781, "learn_time_ms": 26353.608, "learn_throughput": 151.782, "synch_weights_time_ms": 28.558}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "4f45b_00000", "date": "2024-08-13_03-03-47", "timestamp": 1723532627, "time_this_iter_s": 31.174612998962402, "time_total_s": 6357.434836626053, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b276a4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6357.434836626053, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 86.65681818181817, "ram_util_percent": 83.30227272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6189972320404002, "cur_kl_coeff": 0.005005645751953126, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6776249670477772, "policy_loss": -0.0006617144303317503, "vf_loss": 1.6782609048974577, "vf_explained_var": 0.02202790171381027, "kl": 0.005150665845651552, "entropy": 0.5901678099203362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5629316838408904, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7980077664057414, "policy_loss": -0.006522145382468663, "vf_loss": 1.8045284614361152, "vf_explained_var": 0.018956935563415447, "kl": 0.008813577177231352, "entropy": 0.8428171427476974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 91.0, "episode_reward_min": -548.0, "episode_reward_mean": -61.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1086.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 10.0, "predator_policy": 1003.0}, "policy_reward_mean": {"prey_policy": -86.575, "predator_policy": 55.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -345.0, -222.0, -492.0, -180.0, -548.0, -6.0, 5.0, -160.0, -28.0, -305.0, -3.0, -408.0, -23.0, 6.0, 10.0, -217.0, -92.0, -92.0, -9.0, 0.0, 0.0, -14.0, -168.0, 4.0, 91.0, -199.0, -3.0, -19.0, -137.0, -11.0, 0.0, -15.0, -18.0, -40.0, -1.0, -3.0, -202.0, -44.0, 0.0, -263.0, -116.0, 7.0, 0.0, 0.0, -100.0, -14.0, -22.0, -176.0, 0.0, -61.0, -2.0, -47.0, -109.0, 0.0, -166.0, -26.0, -23.0, -5.0, -11.0, 0.0, -55.0, -16.0, -74.0, -3.0, 46.0, -22.0, -77.0, 0.0, -2.0, -23.0, -222.0, -6.0, -33.0, -17.0, -2.0, -12.0, -66.0, -23.0, 3.0, -8.0, 5.0, -14.0, -5.0, -18.0, -2.0, -10.0, 23.0, 0.0, -2.0, -129.0, -21.0, -91.0, 12.0, -200.0, -21.0, -51.0, 0.0, 0.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -853.0, -299.0, -184.0, -528.0, -315.0, -360.0, -537.0, -77.0, -358.0, -390.0, -22.0, 0.0, -35.0, 0.0, 0.0, -410.0, -4.0, -48.0, -208.0, -508.0, -28.0, -10.0, -313.0, -920.0, 0.0, -48.0, -40.0, 3.0, 6.0, 4.0, -296.0, -95.0, -1086.0, -18.0, -374.0, 0.0, -13.0, -28.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, -64.0, -266.0, -2.0, -7.0, -228.0, -502.0, -107.0, -234.0, 0.0, -15.0, 0.0, -71.0, -135.0, -92.0, -23.0, -32.0, 0.0, 0.0, -58.0, -4.0, -17.0, -50.0, -23.0, -62.0, -2.0, 0.0, -77.0, 0.0, -318.0, -322.0, -76.0, -290.0, 0.0, 0.0, -108.0, -343.0, 0.0, -232.0, -20.0, -4.0, 0.0, 0.0, 0.0, 0.0, -152.0, -158.0, -12.0, -10.0, -98.0, 0.0, -10.0, -342.0, 0.0, 0.0, -42.0, -75.0, -17.0, -8.0, -99.0, 0.0, -228.0, 0.0, 0.0, 0.0, -96.0, -190.0, -54.0, 0.0, -175.0, -50.0, 0.0, -20.0, -29.0, -10.0, 0.0, 0.0, -96.0, -16.0, -16.0, -22.0, -60.0, -104.0, 0.0, -58.0, 2.0, 10.0, -48.0, -36.0, -143.0, -16.0, 0.0, 0.0, 0.0, -25.0, 0.0, -47.0, -251.0, -105.0, -15.0, 0.0, -46.0, -42.0, 0.0, -34.0, -140.0, -66.0, 0.0, -62.0, -108.0, -56.0, -76.0, -22.0, 1.0, 0.0, -11.0, -53.0, 0.0, -8.0, 0.0, -30.0, 0.0, -10.0, 0.0, -69.0, 0.0, -16.0, -20.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, -68.0, -101.0, -188.0, -4.0, -40.0, -10.0, -176.0, 0.0, 6.0, -298.0, -127.0, -32.0, -46.0, -156.0, -8.0, 0.0, 0.0, 0.0, 0.0, -29.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 765.0, 42.0, 489.0, 1.0, 3.0, 180.0, 31.0, 403.0, 200.0, 0.0, 0.0, 16.0, 21.0, 19.0, 12.0, 238.0, 24.0, 0.0, 408.0, 3.0, 20.0, 15.0, 0.0, 825.0, 1.0, 24.0, 22.0, 21.0, 0.0, 0.0, 171.0, 3.0, 9.0, 1003.0, 282.0, 0.0, 10.0, 22.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 139.0, 23.0, 6.0, 7.0, 410.0, 411.0, 7.0, 135.0, 11.0, 1.0, 23.0, 29.0, 0.0, 90.0, 18.0, 26.0, 0.0, 0.0, 23.0, 24.0, 24.0, 25.0, 22.0, 23.0, 0.0, 1.0, 36.0, 38.0, 220.0, 218.0, 161.0, 161.0, 0.0, 0.0, 170.0, 18.0, 116.0, 0.0, 18.0, 13.0, 0.0, 0.0, 0.0, 0.0, 101.0, 109.0, 8.0, 0.0, 36.0, 40.0, 174.0, 2.0, 0.0, 0.0, 21.0, 35.0, 20.0, 3.0, 11.0, 41.0, 97.0, 22.0, 0.0, 0.0, 18.0, 102.0, 4.0, 24.0, 101.0, 101.0, 8.0, 7.0, 14.0, 14.0, 0.0, 0.0, 26.0, 31.0, 22.0, 0.0, 36.0, 54.0, 28.0, 27.0, 17.0, 17.0, 32.0, 30.0, 74.0, 8.0, 0.0, 0.0, 7.0, 16.0, 0.0, 24.0, 9.0, 125.0, 1.0, 8.0, 33.0, 22.0, 17.0, 0.0, 102.0, 102.0, 22.0, 28.0, 52.0, 46.0, 26.0, 49.0, 0.0, 2.0, 37.0, 19.0, 0.0, 13.0, 13.0, 3.0, 0.0, 5.0, 36.0, 15.0, 7.0, 7.0, 0.0, 10.0, 24.0, 24.0, 0.0, 0.0, 34.0, 32.0, 89.0, 71.0, 20.0, 3.0, 77.0, 18.0, 3.0, 3.0, 157.0, 68.0, 34.0, 23.0, 79.0, 34.0, 0.0, 0.0, 0.0, 0.0, 18.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8014845083826958, "mean_inference_ms": 27.115854896970877, "mean_action_processing_ms": 0.7859437319432528, "mean_env_wait_ms": 0.6233007859931836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019020557403564453, "StateBufferConnector_ms": 0.010960221290588379, "ViewRequirementAgentConnector_ms": 0.3425290584564209}, "num_episodes": 22, "episode_return_max": 91.0, "episode_return_min": -548.0, "episode_return_mean": -61.65, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.51784384037204, "num_env_steps_trained_throughput_per_sec": 85.51784384037204, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 32655.055, "restore_workers_time_ms": 0.019, "training_step_time_ms": 32654.975, "sample_time_ms": 4328.04, "learn_time_ms": 28295.703, "learn_throughput": 141.364, "synch_weights_time_ms": 25.986}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "4f45b_00000", "date": "2024-08-13_03-04-34", "timestamp": 1723532674, "time_this_iter_s": 46.88080596923828, "time_total_s": 6404.315642595291, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cd5700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6404.315642595291, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 93.82615384615384, "ram_util_percent": 83.06461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2030248450460257, "cur_kl_coeff": 0.005005645751953126, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8729723456044676, "policy_loss": -0.001254017835497738, "vf_loss": 3.874195692148158, "vf_explained_var": 0.0030787765664398357, "kl": 0.006126540499062171, "entropy": 0.5527442916991219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.997737872947461, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6004713197233817, "policy_loss": -0.003321723677168684, "vf_loss": 3.6037919151719917, "vf_explained_var": 0.054284285206012625, "kl": 0.0068817131580308786, "entropy": 1.0322902441655517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 91.0, "episode_reward_min": -263.0, "episode_reward_mean": -39.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -502.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 10.0, "predator_policy": 411.0}, "policy_reward_mean": {"prey_policy": -54.75, "predator_policy": 35.22}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-92.0, -9.0, 0.0, 0.0, -14.0, -168.0, 4.0, 91.0, -199.0, -3.0, -19.0, -137.0, -11.0, 0.0, -15.0, -18.0, -40.0, -1.0, -3.0, -202.0, -44.0, 0.0, -263.0, -116.0, 7.0, 0.0, 0.0, -100.0, -14.0, -22.0, -176.0, 0.0, -61.0, -2.0, -47.0, -109.0, 0.0, -166.0, -26.0, -23.0, -5.0, -11.0, 0.0, -55.0, -16.0, -74.0, -3.0, 46.0, -22.0, -77.0, 0.0, -2.0, -23.0, -222.0, -6.0, -33.0, -17.0, -2.0, -12.0, -66.0, -23.0, 3.0, -8.0, 5.0, -14.0, -5.0, -18.0, -2.0, -10.0, 23.0, 0.0, -2.0, -129.0, -21.0, -91.0, 12.0, -200.0, -21.0, -51.0, 0.0, 0.0, -7.0, -2.0, -1.0, -38.0, -17.0, -74.0, -32.0, -26.0, -22.0, -69.0, -20.0, -20.0, -158.0, -16.0, -35.0, -83.0, -82.0, -37.0, -17.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-374.0, 0.0, -13.0, -28.0, 0.0, 0.0, 0.0, 0.0, 0.0, -48.0, -64.0, -266.0, -2.0, -7.0, -228.0, -502.0, -107.0, -234.0, 0.0, -15.0, 0.0, -71.0, -135.0, -92.0, -23.0, -32.0, 0.0, 0.0, -58.0, -4.0, -17.0, -50.0, -23.0, -62.0, -2.0, 0.0, -77.0, 0.0, -318.0, -322.0, -76.0, -290.0, 0.0, 0.0, -108.0, -343.0, 0.0, -232.0, -20.0, -4.0, 0.0, 0.0, 0.0, 0.0, -152.0, -158.0, -12.0, -10.0, -98.0, 0.0, -10.0, -342.0, 0.0, 0.0, -42.0, -75.0, -17.0, -8.0, -99.0, 0.0, -228.0, 0.0, 0.0, 0.0, -96.0, -190.0, -54.0, 0.0, -175.0, -50.0, 0.0, -20.0, -29.0, -10.0, 0.0, 0.0, -96.0, -16.0, -16.0, -22.0, -60.0, -104.0, 0.0, -58.0, 2.0, 10.0, -48.0, -36.0, -143.0, -16.0, 0.0, 0.0, 0.0, -25.0, 0.0, -47.0, -251.0, -105.0, -15.0, 0.0, -46.0, -42.0, 0.0, -34.0, -140.0, -66.0, 0.0, -62.0, -108.0, -56.0, -76.0, -22.0, 1.0, 0.0, -11.0, -53.0, 0.0, -8.0, 0.0, -30.0, 0.0, -10.0, 0.0, -69.0, 0.0, -16.0, -20.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, -68.0, -101.0, -188.0, -4.0, -40.0, -10.0, -176.0, 0.0, 6.0, -298.0, -127.0, -32.0, -46.0, -156.0, -8.0, 0.0, 0.0, 0.0, 0.0, -29.0, 0.0, 0.0, -44.0, 0.0, -16.0, -22.0, -38.0, -34.0, 0.0, -38.0, -123.0, -17.0, -58.0, -20.0, -47.0, 0.0, -44.0, -68.0, -68.0, -47.0, -2.0, -76.0, 5.0, -160.0, -97.0, -43.0, -8.0, -58.0, -14.0, -66.0, -90.0, -92.0, -94.0, 0.0, -79.0, 0.0, -54.0], "policy_predator_policy_reward": [282.0, 0.0, 10.0, 22.0, 0.0, 0.0, 0.0, 0.0, 24.0, 10.0, 139.0, 23.0, 6.0, 7.0, 410.0, 411.0, 7.0, 135.0, 11.0, 1.0, 23.0, 29.0, 0.0, 90.0, 18.0, 26.0, 0.0, 0.0, 23.0, 24.0, 24.0, 25.0, 22.0, 23.0, 0.0, 1.0, 36.0, 38.0, 220.0, 218.0, 161.0, 161.0, 0.0, 0.0, 170.0, 18.0, 116.0, 0.0, 18.0, 13.0, 0.0, 0.0, 0.0, 0.0, 101.0, 109.0, 8.0, 0.0, 36.0, 40.0, 174.0, 2.0, 0.0, 0.0, 21.0, 35.0, 20.0, 3.0, 11.0, 41.0, 97.0, 22.0, 0.0, 0.0, 18.0, 102.0, 4.0, 24.0, 101.0, 101.0, 8.0, 7.0, 14.0, 14.0, 0.0, 0.0, 26.0, 31.0, 22.0, 0.0, 36.0, 54.0, 28.0, 27.0, 17.0, 17.0, 32.0, 30.0, 74.0, 8.0, 0.0, 0.0, 7.0, 16.0, 0.0, 24.0, 9.0, 125.0, 1.0, 8.0, 33.0, 22.0, 17.0, 0.0, 102.0, 102.0, 22.0, 28.0, 52.0, 46.0, 26.0, 49.0, 0.0, 2.0, 37.0, 19.0, 0.0, 13.0, 13.0, 3.0, 0.0, 5.0, 36.0, 15.0, 7.0, 7.0, 0.0, 10.0, 24.0, 24.0, 0.0, 0.0, 34.0, 32.0, 89.0, 71.0, 20.0, 3.0, 77.0, 18.0, 3.0, 3.0, 157.0, 68.0, 34.0, 23.0, 79.0, 34.0, 0.0, 0.0, 0.0, 0.0, 18.0, 4.0, 18.0, 24.0, 15.0, 0.0, 0.0, 22.0, 17.0, 0.0, 62.0, 25.0, 15.0, 28.0, 13.0, 28.0, 15.0, 7.0, 27.0, 40.0, 17.0, 12.0, 41.0, 10.0, 23.0, 76.0, 12.0, 23.0, 14.0, 23.0, 71.0, 2.0, 60.0, 44.0, 39.0, 3.0, 27.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8040545338469576, "mean_inference_ms": 26.905723506338337, "mean_action_processing_ms": 0.7864511360765283, "mean_env_wait_ms": 0.6239297800378439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019858837127685547, "StateBufferConnector_ms": 0.013362646102905273, "ViewRequirementAgentConnector_ms": 0.31454503536224365}, "num_episodes": 18, "episode_return_max": 91.0, "episode_return_min": -263.0, "episode_return_mean": -39.06, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 109.86617219121746, "num_env_steps_trained_throughput_per_sec": 109.86617219121746, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 33253.049, "restore_workers_time_ms": 0.019, "training_step_time_ms": 33252.968, "sample_time_ms": 4335.786, "learn_time_ms": 28883.932, "learn_throughput": 138.485, "synch_weights_time_ms": 27.198}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "4f45b_00000", "date": "2024-08-13_03-05-10", "timestamp": 1723532710, "time_this_iter_s": 36.5217399597168, "time_total_s": 6440.837382555008, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24a8b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6440.837382555008, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 89.87884615384613, "ram_util_percent": 83.4076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2530500662705255, "cur_kl_coeff": 0.005005645751953126, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.84495963419556, "policy_loss": -0.0025035782034691207, "vf_loss": 2.8474418012553424, "vf_explained_var": 0.01655056779346769, "kl": 0.004277246459792048, "entropy": 0.6056481338682629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.468212169834546, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7623647817858945, "policy_loss": -0.0057299219633615206, "vf_loss": 2.7680936356700916, "vf_explained_var": 0.06943773914266516, "kl": 0.006477708116313209, "entropy": 1.0160549443865579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 46.0, "episode_reward_min": -222.0, "episode_reward_mean": -33.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -342.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 10.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -42.63, "predator_policy": 26.105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-116.0, 7.0, 0.0, 0.0, -100.0, -14.0, -22.0, -176.0, 0.0, -61.0, -2.0, -47.0, -109.0, 0.0, -166.0, -26.0, -23.0, -5.0, -11.0, 0.0, -55.0, -16.0, -74.0, -3.0, 46.0, -22.0, -77.0, 0.0, -2.0, -23.0, -222.0, -6.0, -33.0, -17.0, -2.0, -12.0, -66.0, -23.0, 3.0, -8.0, 5.0, -14.0, -5.0, -18.0, -2.0, -10.0, 23.0, 0.0, -2.0, -129.0, -21.0, -91.0, 12.0, -200.0, -21.0, -51.0, 0.0, 0.0, -7.0, -2.0, -1.0, -38.0, -17.0, -74.0, -32.0, -26.0, -22.0, -69.0, -20.0, -20.0, -158.0, -16.0, -35.0, -83.0, -82.0, -37.0, -17.0, 0.0, -35.0, -46.0, 4.0, 1.0, -2.0, -54.0, -24.0, -58.0, 3.0, -38.0, -38.0, -20.0, -31.0, -27.0, -115.0, -5.0, -3.0, -3.0, -24.0, -8.0, -7.0, -12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -232.0, -20.0, -4.0, 0.0, 0.0, 0.0, 0.0, -152.0, -158.0, -12.0, -10.0, -98.0, 0.0, -10.0, -342.0, 0.0, 0.0, -42.0, -75.0, -17.0, -8.0, -99.0, 0.0, -228.0, 0.0, 0.0, 0.0, -96.0, -190.0, -54.0, 0.0, -175.0, -50.0, 0.0, -20.0, -29.0, -10.0, 0.0, 0.0, -96.0, -16.0, -16.0, -22.0, -60.0, -104.0, 0.0, -58.0, 2.0, 10.0, -48.0, -36.0, -143.0, -16.0, 0.0, 0.0, 0.0, -25.0, 0.0, -47.0, -251.0, -105.0, -15.0, 0.0, -46.0, -42.0, 0.0, -34.0, -140.0, -66.0, 0.0, -62.0, -108.0, -56.0, -76.0, -22.0, 1.0, 0.0, -11.0, -53.0, 0.0, -8.0, 0.0, -30.0, 0.0, -10.0, 0.0, -69.0, 0.0, -16.0, -20.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, -68.0, -101.0, -188.0, -4.0, -40.0, -10.0, -176.0, 0.0, 6.0, -298.0, -127.0, -32.0, -46.0, -156.0, -8.0, 0.0, 0.0, 0.0, 0.0, -29.0, 0.0, 0.0, -44.0, 0.0, -16.0, -22.0, -38.0, -34.0, 0.0, -38.0, -123.0, -17.0, -58.0, -20.0, -47.0, 0.0, -44.0, -68.0, -68.0, -47.0, -2.0, -76.0, 5.0, -160.0, -97.0, -43.0, -8.0, -58.0, -14.0, -66.0, -90.0, -92.0, -94.0, 0.0, -79.0, 0.0, -54.0, 0.0, 0.0, -4.0, -62.0, -16.0, -76.0, 0.0, 1.0, 0.0, -43.0, -5.0, 0.0, -82.0, -56.0, -89.0, -2.0, -24.0, -234.0, -24.0, 0.0, -25.0, -55.0, -73.0, -22.0, -2.0, -101.0, -36.0, -35.0, -61.0, 0.0, -88.0, -86.0, -4.0, -49.0, 0.0, -7.0, -43.0, 0.0, -44.0, -31.0, -26.0, -18.0, 0.0, -14.0, -31.0, 0.0], "policy_predator_policy_reward": [116.0, 0.0, 18.0, 13.0, 0.0, 0.0, 0.0, 0.0, 101.0, 109.0, 8.0, 0.0, 36.0, 40.0, 174.0, 2.0, 0.0, 0.0, 21.0, 35.0, 20.0, 3.0, 11.0, 41.0, 97.0, 22.0, 0.0, 0.0, 18.0, 102.0, 4.0, 24.0, 101.0, 101.0, 8.0, 7.0, 14.0, 14.0, 0.0, 0.0, 26.0, 31.0, 22.0, 0.0, 36.0, 54.0, 28.0, 27.0, 17.0, 17.0, 32.0, 30.0, 74.0, 8.0, 0.0, 0.0, 7.0, 16.0, 0.0, 24.0, 9.0, 125.0, 1.0, 8.0, 33.0, 22.0, 17.0, 0.0, 102.0, 102.0, 22.0, 28.0, 52.0, 46.0, 26.0, 49.0, 0.0, 2.0, 37.0, 19.0, 0.0, 13.0, 13.0, 3.0, 0.0, 5.0, 36.0, 15.0, 7.0, 7.0, 0.0, 10.0, 24.0, 24.0, 0.0, 0.0, 34.0, 32.0, 89.0, 71.0, 20.0, 3.0, 77.0, 18.0, 3.0, 3.0, 157.0, 68.0, 34.0, 23.0, 79.0, 34.0, 0.0, 0.0, 0.0, 0.0, 18.0, 4.0, 18.0, 24.0, 15.0, 0.0, 0.0, 22.0, 17.0, 0.0, 62.0, 25.0, 15.0, 28.0, 13.0, 28.0, 15.0, 7.0, 27.0, 40.0, 17.0, 12.0, 41.0, 10.0, 23.0, 76.0, 12.0, 23.0, 14.0, 23.0, 71.0, 2.0, 60.0, 44.0, 39.0, 3.0, 27.0, 10.0, 0.0, 0.0, 1.0, 30.0, 34.0, 12.0, 0.0, 3.0, 28.0, 16.0, 3.0, 0.0, 27.0, 57.0, 33.0, 34.0, 189.0, 11.0, 11.0, 16.0, 14.0, 28.0, 21.0, 36.0, 46.0, 37.0, 35.0, 5.0, 10.0, 24.0, 17.0, 42.0, 26.0, 22.0, 2.0, 2.0, 13.0, 27.0, 5.0, 46.0, 18.0, 18.0, 2.0, 5.0, 2.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8076191356119886, "mean_inference_ms": 26.64504797444183, "mean_action_processing_ms": 0.7873825013889072, "mean_env_wait_ms": 0.6248629411994758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016360998153686523, "StateBufferConnector_ms": 0.012562751770019531, "ViewRequirementAgentConnector_ms": 0.30617964267730713}, "num_episodes": 23, "episode_return_max": 46.0, "episode_return_min": -222.0, "episode_return_mean": -33.05, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 116.69521675963514, "num_env_steps_trained_throughput_per_sec": 116.69521675963514, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 33671.478, "restore_workers_time_ms": 0.02, "training_step_time_ms": 33671.415, "sample_time_ms": 4388.935, "learn_time_ms": 29248.543, "learn_throughput": 136.759, "synch_weights_time_ms": 27.932}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "4f45b_00000", "date": "2024-08-13_03-05-45", "timestamp": 1723532745, "time_this_iter_s": 34.335752964019775, "time_total_s": 6475.173135519028, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b276aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6475.173135519028, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 88.45208333333333, "ram_util_percent": 83.26458333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9441080215352553, "cur_kl_coeff": 0.002502822875976563, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.451216149992413, "policy_loss": -0.0013313976424455486, "vf_loss": 1.4525341698416958, "vf_explained_var": 0.056238703879099045, "kl": 0.005345749018208081, "entropy": 0.5881571116270843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7198591651188002, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.324399439675152, "policy_loss": -0.006608688263173299, "vf_loss": 1.3310067366986047, "vf_explained_var": 0.031414487122227906, "kl": 0.008431173377427851, "entropy": 0.8639342372694975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 46.0, "episode_reward_min": -222.0, "episode_reward_mean": -26.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -298.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 10.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -34.83, "predator_policy": 21.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, 0.0, -55.0, -16.0, -74.0, -3.0, 46.0, -22.0, -77.0, 0.0, -2.0, -23.0, -222.0, -6.0, -33.0, -17.0, -2.0, -12.0, -66.0, -23.0, 3.0, -8.0, 5.0, -14.0, -5.0, -18.0, -2.0, -10.0, 23.0, 0.0, -2.0, -129.0, -21.0, -91.0, 12.0, -200.0, -21.0, -51.0, 0.0, 0.0, -7.0, -2.0, -1.0, -38.0, -17.0, -74.0, -32.0, -26.0, -22.0, -69.0, -20.0, -20.0, -158.0, -16.0, -35.0, -83.0, -82.0, -37.0, -17.0, 0.0, -35.0, -46.0, 4.0, 1.0, -2.0, -54.0, -24.0, -58.0, 3.0, -38.0, -38.0, -20.0, -31.0, -27.0, -115.0, -5.0, -3.0, -3.0, -24.0, -8.0, -7.0, -12.0, -23.0, -2.0, -14.0, 18.0, -40.0, -10.0, -38.0, -8.0, -31.0, 12.0, 13.0, -10.0, 0.0, 0.0, -1.0, -21.0, -32.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.0, -10.0, 0.0, 0.0, -96.0, -16.0, -16.0, -22.0, -60.0, -104.0, 0.0, -58.0, 2.0, 10.0, -48.0, -36.0, -143.0, -16.0, 0.0, 0.0, 0.0, -25.0, 0.0, -47.0, -251.0, -105.0, -15.0, 0.0, -46.0, -42.0, 0.0, -34.0, -140.0, -66.0, 0.0, -62.0, -108.0, -56.0, -76.0, -22.0, 1.0, 0.0, -11.0, -53.0, 0.0, -8.0, 0.0, -30.0, 0.0, -10.0, 0.0, -69.0, 0.0, -16.0, -20.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, -68.0, -101.0, -188.0, -4.0, -40.0, -10.0, -176.0, 0.0, 6.0, -298.0, -127.0, -32.0, -46.0, -156.0, -8.0, 0.0, 0.0, 0.0, 0.0, -29.0, 0.0, 0.0, -44.0, 0.0, -16.0, -22.0, -38.0, -34.0, 0.0, -38.0, -123.0, -17.0, -58.0, -20.0, -47.0, 0.0, -44.0, -68.0, -68.0, -47.0, -2.0, -76.0, 5.0, -160.0, -97.0, -43.0, -8.0, -58.0, -14.0, -66.0, -90.0, -92.0, -94.0, 0.0, -79.0, 0.0, -54.0, 0.0, 0.0, -4.0, -62.0, -16.0, -76.0, 0.0, 1.0, 0.0, -43.0, -5.0, 0.0, -82.0, -56.0, -89.0, -2.0, -24.0, -234.0, -24.0, 0.0, -25.0, -55.0, -73.0, -22.0, -2.0, -101.0, -36.0, -35.0, -61.0, 0.0, -88.0, -86.0, -4.0, -49.0, 0.0, -7.0, -43.0, 0.0, -44.0, -31.0, -26.0, -18.0, 0.0, -14.0, -31.0, 0.0, -66.0, 0.0, -4.0, 0.0, -12.0, -16.0, -15.0, 6.0, -80.0, 0.0, 0.0, -21.0, -10.0, -70.0, -36.0, 0.0, 0.0, -62.0, 0.0, 0.0, 0.0, 8.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, -48.0, -4.0, -68.0, -6.0, 0.0, 0.0], "policy_predator_policy_reward": [14.0, 14.0, 0.0, 0.0, 26.0, 31.0, 22.0, 0.0, 36.0, 54.0, 28.0, 27.0, 17.0, 17.0, 32.0, 30.0, 74.0, 8.0, 0.0, 0.0, 7.0, 16.0, 0.0, 24.0, 9.0, 125.0, 1.0, 8.0, 33.0, 22.0, 17.0, 0.0, 102.0, 102.0, 22.0, 28.0, 52.0, 46.0, 26.0, 49.0, 0.0, 2.0, 37.0, 19.0, 0.0, 13.0, 13.0, 3.0, 0.0, 5.0, 36.0, 15.0, 7.0, 7.0, 0.0, 10.0, 24.0, 24.0, 0.0, 0.0, 34.0, 32.0, 89.0, 71.0, 20.0, 3.0, 77.0, 18.0, 3.0, 3.0, 157.0, 68.0, 34.0, 23.0, 79.0, 34.0, 0.0, 0.0, 0.0, 0.0, 18.0, 4.0, 18.0, 24.0, 15.0, 0.0, 0.0, 22.0, 17.0, 0.0, 62.0, 25.0, 15.0, 28.0, 13.0, 28.0, 15.0, 7.0, 27.0, 40.0, 17.0, 12.0, 41.0, 10.0, 23.0, 76.0, 12.0, 23.0, 14.0, 23.0, 71.0, 2.0, 60.0, 44.0, 39.0, 3.0, 27.0, 10.0, 0.0, 0.0, 1.0, 30.0, 34.0, 12.0, 0.0, 3.0, 28.0, 16.0, 3.0, 0.0, 27.0, 57.0, 33.0, 34.0, 189.0, 11.0, 11.0, 16.0, 14.0, 28.0, 21.0, 36.0, 46.0, 37.0, 35.0, 5.0, 10.0, 24.0, 17.0, 42.0, 26.0, 22.0, 2.0, 2.0, 13.0, 27.0, 5.0, 46.0, 18.0, 18.0, 2.0, 5.0, 2.0, 17.0, 9.0, 34.0, 2.0, 0.0, 0.0, 14.0, 14.0, 13.0, 40.0, 0.0, 11.0, 0.0, 16.0, 26.0, 12.0, 16.0, 12.0, 19.0, 6.0, 6.0, 5.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 28.0, 11.0, 31.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8105846178730343, "mean_inference_ms": 26.445471112300446, "mean_action_processing_ms": 0.7881600871310921, "mean_env_wait_ms": 0.6256354048951317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015165328979492188, "StateBufferConnector_ms": 0.010154366493225098, "ViewRequirementAgentConnector_ms": 0.3376995325088501}, "num_episodes": 18, "episode_return_max": 46.0, "episode_return_min": -222.0, "episode_return_mean": -26.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 114.63183297657991, "num_env_steps_trained_throughput_per_sec": 114.63183297657991, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 33977.228, "restore_workers_time_ms": 0.02, "training_step_time_ms": 33977.167, "sample_time_ms": 4329.424, "learn_time_ms": 29615.201, "learn_throughput": 135.066, "synch_weights_time_ms": 27.001}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "4f45b_00000", "date": "2024-08-13_03-06-20", "timestamp": 1723532780, "time_this_iter_s": 34.96436595916748, "time_total_s": 6510.137501478195, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24a8670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6510.137501478195, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 88.36399999999999, "ram_util_percent": 83.23200000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2769654114489204, "cur_kl_coeff": 0.002502822875976563, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7509462526550998, "policy_loss": -0.002972745429724455, "vf_loss": 1.7539045906571484, "vf_explained_var": 0.00302346840737358, "kl": 0.005756981882141893, "entropy": 0.5677066793202092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8064633821605374, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2278847137456217, "policy_loss": -0.004313524654652509, "vf_loss": 2.232196518668422, "vf_explained_var": 0.040720265914523414, "kl": 0.010463826001646657, "entropy": 1.05954198099318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 23.0, "episode_reward_min": -200.0, "episode_reward_mean": -22.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -298.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 12.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -29.65, "predator_policy": 18.21}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, -14.0, -5.0, -18.0, -2.0, -10.0, 23.0, 0.0, -2.0, -129.0, -21.0, -91.0, 12.0, -200.0, -21.0, -51.0, 0.0, 0.0, -7.0, -2.0, -1.0, -38.0, -17.0, -74.0, -32.0, -26.0, -22.0, -69.0, -20.0, -20.0, -158.0, -16.0, -35.0, -83.0, -82.0, -37.0, -17.0, 0.0, -35.0, -46.0, 4.0, 1.0, -2.0, -54.0, -24.0, -58.0, 3.0, -38.0, -38.0, -20.0, -31.0, -27.0, -115.0, -5.0, -3.0, -3.0, -24.0, -8.0, -7.0, -12.0, -23.0, -2.0, -14.0, 18.0, -40.0, -10.0, -38.0, -8.0, -31.0, 12.0, 13.0, -10.0, 0.0, 0.0, -1.0, -21.0, -32.0, 0.0, 21.0, -15.0, 5.0, 11.0, -19.0, 2.0, 0.0, 5.0, -48.0, -37.0, -15.0, 3.0, -19.0, -60.0, -31.0, -15.0, 0.0, -35.0, -9.0, -29.0, 0.0, 6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -8.0, 0.0, -30.0, 0.0, -10.0, 0.0, -69.0, 0.0, -16.0, -20.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, -68.0, -101.0, -188.0, -4.0, -40.0, -10.0, -176.0, 0.0, 6.0, -298.0, -127.0, -32.0, -46.0, -156.0, -8.0, 0.0, 0.0, 0.0, 0.0, -29.0, 0.0, 0.0, -44.0, 0.0, -16.0, -22.0, -38.0, -34.0, 0.0, -38.0, -123.0, -17.0, -58.0, -20.0, -47.0, 0.0, -44.0, -68.0, -68.0, -47.0, -2.0, -76.0, 5.0, -160.0, -97.0, -43.0, -8.0, -58.0, -14.0, -66.0, -90.0, -92.0, -94.0, 0.0, -79.0, 0.0, -54.0, 0.0, 0.0, -4.0, -62.0, -16.0, -76.0, 0.0, 1.0, 0.0, -43.0, -5.0, 0.0, -82.0, -56.0, -89.0, -2.0, -24.0, -234.0, -24.0, 0.0, -25.0, -55.0, -73.0, -22.0, -2.0, -101.0, -36.0, -35.0, -61.0, 0.0, -88.0, -86.0, -4.0, -49.0, 0.0, -7.0, -43.0, 0.0, -44.0, -31.0, -26.0, -18.0, 0.0, -14.0, -31.0, 0.0, -66.0, 0.0, -4.0, 0.0, -12.0, -16.0, -15.0, 6.0, -80.0, 0.0, 0.0, -21.0, -10.0, -70.0, -36.0, 0.0, 0.0, -62.0, 0.0, 0.0, 0.0, 8.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, -48.0, -4.0, -68.0, -6.0, 0.0, 0.0, -22.0, 1.0, 0.0, -30.0, -12.0, 4.0, 12.0, -4.0, -45.0, 0.0, 3.0, -2.0, -2.0, 0.0, 1.0, -1.0, -20.0, -64.0, -48.0, -28.0, -35.0, 0.0, 3.0, 0.0, 0.0, -38.0, -40.0, -72.0, -14.0, -48.0, -7.0, -32.0, 0.0, 0.0, -19.0, -76.0, -71.0, 0.0, -26.0, -32.0, 0.0, 0.0, 4.0, -4.0], "policy_predator_policy_reward": [0.0, 13.0, 13.0, 3.0, 0.0, 5.0, 36.0, 15.0, 7.0, 7.0, 0.0, 10.0, 24.0, 24.0, 0.0, 0.0, 34.0, 32.0, 89.0, 71.0, 20.0, 3.0, 77.0, 18.0, 3.0, 3.0, 157.0, 68.0, 34.0, 23.0, 79.0, 34.0, 0.0, 0.0, 0.0, 0.0, 18.0, 4.0, 18.0, 24.0, 15.0, 0.0, 0.0, 22.0, 17.0, 0.0, 62.0, 25.0, 15.0, 28.0, 13.0, 28.0, 15.0, 7.0, 27.0, 40.0, 17.0, 12.0, 41.0, 10.0, 23.0, 76.0, 12.0, 23.0, 14.0, 23.0, 71.0, 2.0, 60.0, 44.0, 39.0, 3.0, 27.0, 10.0, 0.0, 0.0, 1.0, 30.0, 34.0, 12.0, 0.0, 3.0, 28.0, 16.0, 3.0, 0.0, 27.0, 57.0, 33.0, 34.0, 189.0, 11.0, 11.0, 16.0, 14.0, 28.0, 21.0, 36.0, 46.0, 37.0, 35.0, 5.0, 10.0, 24.0, 17.0, 42.0, 26.0, 22.0, 2.0, 2.0, 13.0, 27.0, 5.0, 46.0, 18.0, 18.0, 2.0, 5.0, 2.0, 17.0, 9.0, 34.0, 2.0, 0.0, 0.0, 14.0, 14.0, 13.0, 40.0, 0.0, 11.0, 0.0, 16.0, 26.0, 12.0, 16.0, 12.0, 19.0, 6.0, 6.0, 5.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 28.0, 11.0, 31.0, 0.0, 0.0, 21.0, 21.0, 4.0, 11.0, 13.0, 0.0, 3.0, 0.0, 2.0, 24.0, 1.0, 0.0, 0.0, 2.0, 3.0, 2.0, 9.0, 27.0, 24.0, 15.0, 0.0, 20.0, 0.0, 0.0, 13.0, 6.0, 41.0, 11.0, 30.0, 1.0, 1.0, 23.0, 0.0, 0.0, 21.0, 39.0, 34.0, 28.0, 15.0, 14.0, 0.0, 0.0, 1.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.812046278323939, "mean_inference_ms": 26.206699743768286, "mean_action_processing_ms": 0.7874742863920574, "mean_env_wait_ms": 0.6255713443018186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01345372200012207, "StateBufferConnector_ms": 0.010193467140197754, "ViewRequirementAgentConnector_ms": 0.3604769706726074}, "num_episodes": 22, "episode_return_max": 23.0, "episode_return_min": -200.0, "episode_return_mean": -22.88, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 123.83812005510131, "num_env_steps_trained_throughput_per_sec": 123.83812005510131, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 34068.002, "restore_workers_time_ms": 0.02, "training_step_time_ms": 34067.94, "sample_time_ms": 4343.311, "learn_time_ms": 29691.842, "learn_throughput": 134.717, "synch_weights_time_ms": 27.067}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "4f45b_00000", "date": "2024-08-13_03-06-52", "timestamp": 1723532812, "time_this_iter_s": 32.363028049468994, "time_total_s": 6542.500529527664, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24d8b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6542.500529527664, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 88.01333333333334, "ram_util_percent": 83.19333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2271294680379685, "cur_kl_coeff": 0.002502822875976563, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5945848229070188, "policy_loss": -0.0024164901600372064, "vf_loss": 2.5969880502059977, "vf_explained_var": 0.03041451891894063, "kl": 0.005300936270846908, "entropy": 0.4983582178593943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0540554052149806, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.976362312975384, "policy_loss": -0.005546855724357542, "vf_loss": 2.9819075733896288, "vf_explained_var": 0.03437983819416591, "kl": 0.009669947077395599, "entropy": 1.0322838618957177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 62.0, "episode_reward_min": -158.0, "episode_reward_mean": -18.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -234.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -25.415, "predator_policy": 15.985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, -2.0, -1.0, -38.0, -17.0, -74.0, -32.0, -26.0, -22.0, -69.0, -20.0, -20.0, -158.0, -16.0, -35.0, -83.0, -82.0, -37.0, -17.0, 0.0, -35.0, -46.0, 4.0, 1.0, -2.0, -54.0, -24.0, -58.0, 3.0, -38.0, -38.0, -20.0, -31.0, -27.0, -115.0, -5.0, -3.0, -3.0, -24.0, -8.0, -7.0, -12.0, -23.0, -2.0, -14.0, 18.0, -40.0, -10.0, -38.0, -8.0, -31.0, 12.0, 13.0, -10.0, 0.0, 0.0, -1.0, -21.0, -32.0, 0.0, 21.0, -15.0, 5.0, 11.0, -19.0, 2.0, 0.0, 5.0, -48.0, -37.0, -15.0, 3.0, -19.0, -60.0, -31.0, -15.0, 0.0, -35.0, -9.0, -29.0, 0.0, 6.0, 3.0, -75.0, -3.0, 8.0, 0.0, -21.0, 12.0, 62.0, 22.0, 13.0, -9.0, -30.0, -15.0, -9.0, 5.0, 0.0, -15.0, -70.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-29.0, 0.0, 0.0, -44.0, 0.0, -16.0, -22.0, -38.0, -34.0, 0.0, -38.0, -123.0, -17.0, -58.0, -20.0, -47.0, 0.0, -44.0, -68.0, -68.0, -47.0, -2.0, -76.0, 5.0, -160.0, -97.0, -43.0, -8.0, -58.0, -14.0, -66.0, -90.0, -92.0, -94.0, 0.0, -79.0, 0.0, -54.0, 0.0, 0.0, -4.0, -62.0, -16.0, -76.0, 0.0, 1.0, 0.0, -43.0, -5.0, 0.0, -82.0, -56.0, -89.0, -2.0, -24.0, -234.0, -24.0, 0.0, -25.0, -55.0, -73.0, -22.0, -2.0, -101.0, -36.0, -35.0, -61.0, 0.0, -88.0, -86.0, -4.0, -49.0, 0.0, -7.0, -43.0, 0.0, -44.0, -31.0, -26.0, -18.0, 0.0, -14.0, -31.0, 0.0, -66.0, 0.0, -4.0, 0.0, -12.0, -16.0, -15.0, 6.0, -80.0, 0.0, 0.0, -21.0, -10.0, -70.0, -36.0, 0.0, 0.0, -62.0, 0.0, 0.0, 0.0, 8.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, -48.0, -4.0, -68.0, -6.0, 0.0, 0.0, -22.0, 1.0, 0.0, -30.0, -12.0, 4.0, 12.0, -4.0, -45.0, 0.0, 3.0, -2.0, -2.0, 0.0, 1.0, -1.0, -20.0, -64.0, -48.0, -28.0, -35.0, 0.0, 3.0, 0.0, 0.0, -38.0, -40.0, -72.0, -14.0, -48.0, -7.0, -32.0, 0.0, 0.0, -19.0, -76.0, -71.0, 0.0, -26.0, -32.0, 0.0, 0.0, 4.0, -4.0, 0.0, -9.0, -60.0, -75.0, -6.0, 0.0, -11.0, 8.0, 0.0, 0.0, -10.0, -53.0, 12.0, 0.0, 11.0, 15.0, -14.0, 27.0, -3.0, 11.0, -18.0, 0.0, -50.0, -31.0, 0.0, -97.0, -15.0, -11.0, -7.0, -8.0, 0.0, 0.0, -16.0, -14.0, -94.0, -61.0], "policy_predator_policy_reward": [18.0, 4.0, 18.0, 24.0, 15.0, 0.0, 0.0, 22.0, 17.0, 0.0, 62.0, 25.0, 15.0, 28.0, 13.0, 28.0, 15.0, 7.0, 27.0, 40.0, 17.0, 12.0, 41.0, 10.0, 23.0, 76.0, 12.0, 23.0, 14.0, 23.0, 71.0, 2.0, 60.0, 44.0, 39.0, 3.0, 27.0, 10.0, 0.0, 0.0, 1.0, 30.0, 34.0, 12.0, 0.0, 3.0, 28.0, 16.0, 3.0, 0.0, 27.0, 57.0, 33.0, 34.0, 189.0, 11.0, 11.0, 16.0, 14.0, 28.0, 21.0, 36.0, 46.0, 37.0, 35.0, 5.0, 10.0, 24.0, 17.0, 42.0, 26.0, 22.0, 2.0, 2.0, 13.0, 27.0, 5.0, 46.0, 18.0, 18.0, 2.0, 5.0, 2.0, 17.0, 9.0, 34.0, 2.0, 0.0, 0.0, 14.0, 14.0, 13.0, 40.0, 0.0, 11.0, 0.0, 16.0, 26.0, 12.0, 16.0, 12.0, 19.0, 6.0, 6.0, 5.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 28.0, 11.0, 31.0, 0.0, 0.0, 21.0, 21.0, 4.0, 11.0, 13.0, 0.0, 3.0, 0.0, 2.0, 24.0, 1.0, 0.0, 0.0, 2.0, 3.0, 2.0, 9.0, 27.0, 24.0, 15.0, 0.0, 20.0, 0.0, 0.0, 13.0, 6.0, 41.0, 11.0, 30.0, 1.0, 1.0, 23.0, 0.0, 0.0, 21.0, 39.0, 34.0, 28.0, 15.0, 14.0, 0.0, 0.0, 1.0, 5.0, 3.0, 9.0, 18.0, 42.0, 3.0, 0.0, 4.0, 7.0, 0.0, 0.0, 11.0, 31.0, 0.0, 0.0, 19.0, 17.0, 9.0, 0.0, 5.0, 0.0, 1.0, 8.0, 7.0, 44.0, 40.0, 42.0, 16.0, 1.0, 17.0, 3.0, 0.0, 0.0, 15.0, 0.0, 67.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8177212440094654, "mean_inference_ms": 26.02840797042534, "mean_action_processing_ms": 0.790326309025748, "mean_env_wait_ms": 0.6272192685895742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012469053268432617, "StateBufferConnector_ms": 0.010127902030944824, "ViewRequirementAgentConnector_ms": 0.36713099479675293}, "num_episodes": 18, "episode_return_max": 62.0, "episode_return_min": -158.0, "episode_return_mean": -18.86, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 128.14329891888227, "num_env_steps_trained_throughput_per_sec": 128.14329891888227, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 34050.397, "restore_workers_time_ms": 0.02, "training_step_time_ms": 34050.335, "sample_time_ms": 4322.985, "learn_time_ms": 29691.661, "learn_throughput": 134.718, "synch_weights_time_ms": 30.238}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "4f45b_00000", "date": "2024-08-13_03-07-23", "timestamp": 1723532843, "time_this_iter_s": 31.28648591041565, "time_total_s": 6573.78701543808, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24af280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6573.78701543808, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 87.95777777777778, "ram_util_percent": 82.98222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7403279720396592, "cur_kl_coeff": 0.002502822875976563, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.756905756267921, "policy_loss": -0.0025014405126471528, "vf_loss": 0.7593915278003329, "vf_explained_var": 0.012072364489237467, "kl": 0.006260602526953767, "entropy": 0.5898908734006226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8687109037090546, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8393452060374397, "policy_loss": -0.0043465825773420785, "vf_loss": 0.8436905718196637, "vf_explained_var": 0.03773151456363617, "kl": 0.007377027646512914, "entropy": 0.9730985214470556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 62.0, "episode_reward_min": -115.0, "episode_reward_mean": -13.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -234.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.0, "predator_policy": 189.0}, "policy_reward_mean": {"prey_policy": -20.1, "predator_policy": 13.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.0, -2.0, -54.0, -24.0, -58.0, 3.0, -38.0, -38.0, -20.0, -31.0, -27.0, -115.0, -5.0, -3.0, -3.0, -24.0, -8.0, -7.0, -12.0, -23.0, -2.0, -14.0, 18.0, -40.0, -10.0, -38.0, -8.0, -31.0, 12.0, 13.0, -10.0, 0.0, 0.0, -1.0, -21.0, -32.0, 0.0, 21.0, -15.0, 5.0, 11.0, -19.0, 2.0, 0.0, 5.0, -48.0, -37.0, -15.0, 3.0, -19.0, -60.0, -31.0, -15.0, 0.0, -35.0, -9.0, -29.0, 0.0, 6.0, 3.0, -75.0, -3.0, 8.0, 0.0, -21.0, 12.0, 62.0, 22.0, 13.0, -9.0, -30.0, -15.0, -9.0, 5.0, 0.0, -15.0, -70.0, -96.0, -23.0, 1.0, 1.0, -11.0, 0.0, -21.0, -5.0, -40.0, -9.0, 0.0, -40.0, -7.0, -21.0, 11.0, 0.0, 0.0, 0.0, -7.0, -10.0, -29.0, -3.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -43.0, -5.0, 0.0, -82.0, -56.0, -89.0, -2.0, -24.0, -234.0, -24.0, 0.0, -25.0, -55.0, -73.0, -22.0, -2.0, -101.0, -36.0, -35.0, -61.0, 0.0, -88.0, -86.0, -4.0, -49.0, 0.0, -7.0, -43.0, 0.0, -44.0, -31.0, -26.0, -18.0, 0.0, -14.0, -31.0, 0.0, -66.0, 0.0, -4.0, 0.0, -12.0, -16.0, -15.0, 6.0, -80.0, 0.0, 0.0, -21.0, -10.0, -70.0, -36.0, 0.0, 0.0, -62.0, 0.0, 0.0, 0.0, 8.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, -48.0, -4.0, -68.0, -6.0, 0.0, 0.0, -22.0, 1.0, 0.0, -30.0, -12.0, 4.0, 12.0, -4.0, -45.0, 0.0, 3.0, -2.0, -2.0, 0.0, 1.0, -1.0, -20.0, -64.0, -48.0, -28.0, -35.0, 0.0, 3.0, 0.0, 0.0, -38.0, -40.0, -72.0, -14.0, -48.0, -7.0, -32.0, 0.0, 0.0, -19.0, -76.0, -71.0, 0.0, -26.0, -32.0, 0.0, 0.0, 4.0, -4.0, 0.0, -9.0, -60.0, -75.0, -6.0, 0.0, -11.0, 8.0, 0.0, 0.0, -10.0, -53.0, 12.0, 0.0, 11.0, 15.0, -14.0, 27.0, -3.0, 11.0, -18.0, 0.0, -50.0, -31.0, 0.0, -97.0, -15.0, -11.0, -7.0, -8.0, 0.0, 0.0, -16.0, -14.0, -94.0, -61.0, -88.0, -52.0, -6.0, -40.0, -7.0, 4.0, 1.0, 0.0, -45.0, 0.0, 0.0, 0.0, -52.0, 0.0, 0.0, -10.0, -40.0, -42.0, -34.0, -6.0, 0.0, 0.0, -52.0, -20.0, -18.0, 0.0, -83.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -42.0, 0.0, -16.0, -4.0, -8.0, -53.0, -8.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [28.0, 16.0, 3.0, 0.0, 27.0, 57.0, 33.0, 34.0, 189.0, 11.0, 11.0, 16.0, 14.0, 28.0, 21.0, 36.0, 46.0, 37.0, 35.0, 5.0, 10.0, 24.0, 17.0, 42.0, 26.0, 22.0, 2.0, 2.0, 13.0, 27.0, 5.0, 46.0, 18.0, 18.0, 2.0, 5.0, 2.0, 17.0, 9.0, 34.0, 2.0, 0.0, 0.0, 14.0, 14.0, 13.0, 40.0, 0.0, 11.0, 0.0, 16.0, 26.0, 12.0, 16.0, 12.0, 19.0, 6.0, 6.0, 5.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 28.0, 11.0, 31.0, 0.0, 0.0, 21.0, 21.0, 4.0, 11.0, 13.0, 0.0, 3.0, 0.0, 2.0, 24.0, 1.0, 0.0, 0.0, 2.0, 3.0, 2.0, 9.0, 27.0, 24.0, 15.0, 0.0, 20.0, 0.0, 0.0, 13.0, 6.0, 41.0, 11.0, 30.0, 1.0, 1.0, 23.0, 0.0, 0.0, 21.0, 39.0, 34.0, 28.0, 15.0, 14.0, 0.0, 0.0, 1.0, 5.0, 3.0, 9.0, 18.0, 42.0, 3.0, 0.0, 4.0, 7.0, 0.0, 0.0, 11.0, 31.0, 0.0, 0.0, 19.0, 17.0, 9.0, 0.0, 5.0, 0.0, 1.0, 8.0, 7.0, 44.0, 40.0, 42.0, 16.0, 1.0, 17.0, 3.0, 0.0, 0.0, 15.0, 0.0, 67.0, 18.0, 44.0, 0.0, 3.0, 20.0, 0.0, 4.0, 0.0, 0.0, 12.0, 22.0, 0.0, 0.0, 22.0, 9.0, 0.0, 5.0, 1.0, 41.0, 18.0, 13.0, 0.0, 0.0, 2.0, 30.0, 4.0, 7.0, 41.0, 21.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 19.0, 16.0, 2.0, 8.0, 22.0, 10.0, 0.0, 5.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8196526754713045, "mean_inference_ms": 25.79702371553205, "mean_action_processing_ms": 0.791317313610199, "mean_env_wait_ms": 0.6272509515530241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010842204093933105, "StateBufferConnector_ms": 0.008474349975585938, "ViewRequirementAgentConnector_ms": 0.3526850938796997}, "num_episodes": 23, "episode_return_max": 62.0, "episode_return_min": -115.0, "episode_return_mean": -13.62, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 131.1065978020356, "num_env_steps_trained_throughput_per_sec": 131.1065978020356, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 34015.579, "restore_workers_time_ms": 0.022, "training_step_time_ms": 34015.515, "sample_time_ms": 4322.794, "learn_time_ms": 29658.189, "learn_throughput": 134.87, "synch_weights_time_ms": 28.921}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 100, "trial_id": "4f45b_00000", "date": "2024-08-13_03-07-54", "timestamp": 1723532874, "time_this_iter_s": 30.57069683074951, "time_total_s": 6604.357712268829, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2452160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6604.357712268829, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 88.20697674418605, "ram_util_percent": 83.41162790697675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.006141576912037, "cur_kl_coeff": 0.002502822875976563, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.254931859679954, "policy_loss": -0.001501412575118362, "vf_loss": 2.25642270392211, "vf_explained_var": 0.0120587911555376, "kl": 0.004222732057090327, "entropy": 0.5162386628843489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.306864709702749, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.256780977255453, "policy_loss": -0.005027916289437266, "vf_loss": 2.2618073334769595, "vf_explained_var": 0.04971785053374275, "kl": 0.009433339789728157, "entropy": 1.0074472623842734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "env_runners": {"episode_reward_max": 62.0, "episode_reward_min": -96.0, "episode_reward_mean": -11.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -110.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.0, "predator_policy": 67.0}, "policy_reward_mean": {"prey_policy": -16.72, "predator_policy": 10.835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-12.0, -23.0, -2.0, -14.0, 18.0, -40.0, -10.0, -38.0, -8.0, -31.0, 12.0, 13.0, -10.0, 0.0, 0.0, -1.0, -21.0, -32.0, 0.0, 21.0, -15.0, 5.0, 11.0, -19.0, 2.0, 0.0, 5.0, -48.0, -37.0, -15.0, 3.0, -19.0, -60.0, -31.0, -15.0, 0.0, -35.0, -9.0, -29.0, 0.0, 6.0, 3.0, -75.0, -3.0, 8.0, 0.0, -21.0, 12.0, 62.0, 22.0, 13.0, -9.0, -30.0, -15.0, -9.0, 5.0, 0.0, -15.0, -70.0, -96.0, -23.0, 1.0, 1.0, -11.0, 0.0, -21.0, -5.0, -40.0, -9.0, 0.0, -40.0, -7.0, -21.0, 11.0, 0.0, 0.0, 0.0, -7.0, -10.0, -29.0, -3.0, 0.0, -2.0, -4.0, -3.0, -10.0, -34.0, 2.0, -27.0, 4.0, -36.0, -52.0, 2.0, -57.0, -14.0, -5.0, 0.0, 0.0, -28.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.0, 0.0, -66.0, 0.0, -4.0, 0.0, -12.0, -16.0, -15.0, 6.0, -80.0, 0.0, 0.0, -21.0, -10.0, -70.0, -36.0, 0.0, 0.0, -62.0, 0.0, 0.0, 0.0, 8.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, -4.0, -48.0, -4.0, -68.0, -6.0, 0.0, 0.0, -22.0, 1.0, 0.0, -30.0, -12.0, 4.0, 12.0, -4.0, -45.0, 0.0, 3.0, -2.0, -2.0, 0.0, 1.0, -1.0, -20.0, -64.0, -48.0, -28.0, -35.0, 0.0, 3.0, 0.0, 0.0, -38.0, -40.0, -72.0, -14.0, -48.0, -7.0, -32.0, 0.0, 0.0, -19.0, -76.0, -71.0, 0.0, -26.0, -32.0, 0.0, 0.0, 4.0, -4.0, 0.0, -9.0, -60.0, -75.0, -6.0, 0.0, -11.0, 8.0, 0.0, 0.0, -10.0, -53.0, 12.0, 0.0, 11.0, 15.0, -14.0, 27.0, -3.0, 11.0, -18.0, 0.0, -50.0, -31.0, 0.0, -97.0, -15.0, -11.0, -7.0, -8.0, 0.0, 0.0, -16.0, -14.0, -94.0, -61.0, -88.0, -52.0, -6.0, -40.0, -7.0, 4.0, 1.0, 0.0, -45.0, 0.0, 0.0, 0.0, -52.0, 0.0, 0.0, -10.0, -40.0, -42.0, -34.0, -6.0, 0.0, 0.0, -52.0, -20.0, -18.0, 0.0, -83.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -42.0, 0.0, -16.0, -4.0, -8.0, -53.0, -8.0, 0.0, 0.0, 0.0, -12.0, 0.0, -2.0, -4.0, 0.0, -16.0, 2.0, -24.0, -52.0, -17.0, -3.0, -13.0, -43.0, -7.0, -25.0, 0.0, -20.0, -110.0, -92.0, -12.0, 2.0, -2.0, -86.0, -44.0, -14.0, -14.0, -4.0, -6.0, 0.0, 0.0, 0.0, 0.0, -63.0, 0.0, -22.0, 0.0], "policy_predator_policy_reward": [2.0, 17.0, 9.0, 34.0, 2.0, 0.0, 0.0, 14.0, 14.0, 13.0, 40.0, 0.0, 11.0, 0.0, 16.0, 26.0, 12.0, 16.0, 12.0, 19.0, 6.0, 6.0, 5.0, 0.0, 2.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 3.0, 28.0, 11.0, 31.0, 0.0, 0.0, 21.0, 21.0, 4.0, 11.0, 13.0, 0.0, 3.0, 0.0, 2.0, 24.0, 1.0, 0.0, 0.0, 2.0, 3.0, 2.0, 9.0, 27.0, 24.0, 15.0, 0.0, 20.0, 0.0, 0.0, 13.0, 6.0, 41.0, 11.0, 30.0, 1.0, 1.0, 23.0, 0.0, 0.0, 21.0, 39.0, 34.0, 28.0, 15.0, 14.0, 0.0, 0.0, 1.0, 5.0, 3.0, 9.0, 18.0, 42.0, 3.0, 0.0, 4.0, 7.0, 0.0, 0.0, 11.0, 31.0, 0.0, 0.0, 19.0, 17.0, 9.0, 0.0, 5.0, 0.0, 1.0, 8.0, 7.0, 44.0, 40.0, 42.0, 16.0, 1.0, 17.0, 3.0, 0.0, 0.0, 15.0, 0.0, 67.0, 18.0, 44.0, 0.0, 3.0, 20.0, 0.0, 4.0, 0.0, 0.0, 12.0, 22.0, 0.0, 0.0, 22.0, 9.0, 0.0, 5.0, 1.0, 41.0, 18.0, 13.0, 0.0, 0.0, 2.0, 30.0, 4.0, 7.0, 41.0, 21.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 19.0, 16.0, 2.0, 8.0, 22.0, 10.0, 0.0, 5.0, 0.0, 0.0, 6.0, 4.0, 2.0, 0.0, 0.0, 13.0, 1.0, 11.0, 7.0, 28.0, 5.0, 13.0, 4.0, 19.0, 11.0, 18.0, 49.0, 45.0, 16.0, 36.0, 0.0, 2.0, 51.0, 22.0, 7.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 31.0, 16.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8235385253304077, "mean_inference_ms": 25.616082666870337, "mean_action_processing_ms": 0.7918615781295029, "mean_env_wait_ms": 0.6281348822243618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008596062660217285, "StateBufferConnector_ms": 0.009134531021118164, "ViewRequirementAgentConnector_ms": 0.36230313777923584}, "num_episodes": 18, "episode_return_max": 62.0, "episode_return_min": -96.0, "episode_return_mean": -11.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 123.48520230298814, "num_env_steps_trained_throughput_per_sec": 123.48520230298814, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 1616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1616000, "timers": {"training_iteration_time_ms": 34167.325, "restore_workers_time_ms": 0.022, "training_step_time_ms": 34167.259, "sample_time_ms": 4426.741, "learn_time_ms": 29705.875, "learn_throughput": 134.653, "synch_weights_time_ms": 29.189}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "done": false, "training_iteration": 101, "trial_id": "4f45b_00000", "date": "2024-08-13_03-08-27", "timestamp": 1723532907, "time_this_iter_s": 32.45493006706238, "time_total_s": 6636.812642335892, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cdac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6636.812642335892, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 88.20888888888888, "ram_util_percent": 83.18000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.121264770627022, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8191485175222316, "policy_loss": -0.003494962283888112, "vf_loss": 0.8226338474523454, "vf_explained_var": 0.00862766043849723, "kl": 0.007699740311155277, "entropy": 0.5744326824391329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.838981796154585, "cur_kl_coeff": 0.000164794921875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2714496408505414, "policy_loss": -0.003220481251331943, "vf_loss": 1.274669419646894, "vf_explained_var": 0.10890290866453181, "kl": 0.004243914538490304, "entropy": 1.0126438795258759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 62.0, "episode_reward_min": -96.0, "episode_reward_mean": -11.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -110.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.0, "predator_policy": 67.0}, "policy_reward_mean": {"prey_policy": -16.075, "predator_policy": 10.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 21.0, -15.0, 5.0, 11.0, -19.0, 2.0, 0.0, 5.0, -48.0, -37.0, -15.0, 3.0, -19.0, -60.0, -31.0, -15.0, 0.0, -35.0, -9.0, -29.0, 0.0, 6.0, 3.0, -75.0, -3.0, 8.0, 0.0, -21.0, 12.0, 62.0, 22.0, 13.0, -9.0, -30.0, -15.0, -9.0, 5.0, 0.0, -15.0, -70.0, -96.0, -23.0, 1.0, 1.0, -11.0, 0.0, -21.0, -5.0, -40.0, -9.0, 0.0, -40.0, -7.0, -21.0, 11.0, 0.0, 0.0, 0.0, -7.0, -10.0, -29.0, -3.0, 0.0, -2.0, -4.0, -3.0, -10.0, -34.0, 2.0, -27.0, 4.0, -36.0, -52.0, 2.0, -57.0, -14.0, -5.0, 0.0, 0.0, -28.0, -4.0, -2.0, -6.0, 2.0, -21.0, 12.0, -7.0, -2.0, 0.0, -5.0, -67.0, 9.0, 0.0, -16.0, 0.0, -38.0, -10.0, -21.0, 1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -22.0, 1.0, 0.0, -30.0, -12.0, 4.0, 12.0, -4.0, -45.0, 0.0, 3.0, -2.0, -2.0, 0.0, 1.0, -1.0, -20.0, -64.0, -48.0, -28.0, -35.0, 0.0, 3.0, 0.0, 0.0, -38.0, -40.0, -72.0, -14.0, -48.0, -7.0, -32.0, 0.0, 0.0, -19.0, -76.0, -71.0, 0.0, -26.0, -32.0, 0.0, 0.0, 4.0, -4.0, 0.0, -9.0, -60.0, -75.0, -6.0, 0.0, -11.0, 8.0, 0.0, 0.0, -10.0, -53.0, 12.0, 0.0, 11.0, 15.0, -14.0, 27.0, -3.0, 11.0, -18.0, 0.0, -50.0, -31.0, 0.0, -97.0, -15.0, -11.0, -7.0, -8.0, 0.0, 0.0, -16.0, -14.0, -94.0, -61.0, -88.0, -52.0, -6.0, -40.0, -7.0, 4.0, 1.0, 0.0, -45.0, 0.0, 0.0, 0.0, -52.0, 0.0, 0.0, -10.0, -40.0, -42.0, -34.0, -6.0, 0.0, 0.0, -52.0, -20.0, -18.0, 0.0, -83.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -42.0, 0.0, -16.0, -4.0, -8.0, -53.0, -8.0, 0.0, 0.0, 0.0, -12.0, 0.0, -2.0, -4.0, 0.0, -16.0, 2.0, -24.0, -52.0, -17.0, -3.0, -13.0, -43.0, -7.0, -25.0, 0.0, -20.0, -110.0, -92.0, -12.0, 2.0, -2.0, -86.0, -44.0, -14.0, -14.0, -4.0, -6.0, 0.0, 0.0, 0.0, 0.0, -63.0, 0.0, -22.0, 0.0, 0.0, -6.0, 0.0, -24.0, 0.0, -8.0, -26.0, -18.0, 0.0, 12.0, -4.0, -9.0, 0.0, -4.0, 0.0, 0.0, 12.0, -48.0, -64.0, -45.0, 0.0, 5.0, 0.0, 0.0, -37.0, 0.0, 0.0, 0.0, -12.0, -69.0, 13.0, -51.0, -16.0, -30.0, -5.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 21.0, 21.0, 4.0, 11.0, 13.0, 0.0, 3.0, 0.0, 2.0, 24.0, 1.0, 0.0, 0.0, 2.0, 3.0, 2.0, 9.0, 27.0, 24.0, 15.0, 0.0, 20.0, 0.0, 0.0, 13.0, 6.0, 41.0, 11.0, 30.0, 1.0, 1.0, 23.0, 0.0, 0.0, 21.0, 39.0, 34.0, 28.0, 15.0, 14.0, 0.0, 0.0, 1.0, 5.0, 3.0, 9.0, 18.0, 42.0, 3.0, 0.0, 4.0, 7.0, 0.0, 0.0, 11.0, 31.0, 0.0, 0.0, 19.0, 17.0, 9.0, 0.0, 5.0, 0.0, 1.0, 8.0, 7.0, 44.0, 40.0, 42.0, 16.0, 1.0, 17.0, 3.0, 0.0, 0.0, 15.0, 0.0, 67.0, 18.0, 44.0, 0.0, 3.0, 20.0, 0.0, 4.0, 0.0, 0.0, 12.0, 22.0, 0.0, 0.0, 22.0, 9.0, 0.0, 5.0, 1.0, 41.0, 18.0, 13.0, 0.0, 0.0, 2.0, 30.0, 4.0, 7.0, 41.0, 21.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 19.0, 16.0, 2.0, 8.0, 22.0, 10.0, 0.0, 5.0, 0.0, 0.0, 6.0, 4.0, 2.0, 0.0, 0.0, 13.0, 1.0, 11.0, 7.0, 28.0, 5.0, 13.0, 4.0, 19.0, 11.0, 18.0, 49.0, 45.0, 16.0, 36.0, 0.0, 2.0, 51.0, 22.0, 7.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 31.0, 16.0, 2.0, 3.0, 1.0, 18.0, 0.0, 6.0, 4.0, 13.0, 10.0, 0.0, 0.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, 7.0, 24.0, 0.0, 42.0, 0.0, 4.0, 0.0, 0.0, 17.0, 4.0, 0.0, 0.0, 6.0, 37.0, 2.0, 26.0, 17.0, 8.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.828377216391471, "mean_inference_ms": 25.440807075473682, "mean_action_processing_ms": 0.7929279129844842, "mean_env_wait_ms": 0.6290931530019311, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010831952095031738, "StateBufferConnector_ms": 0.008933186531066895, "ViewRequirementAgentConnector_ms": 0.3591238260269165}, "num_episodes": 18, "episode_return_max": 62.0, "episode_return_min": -96.0, "episode_return_mean": -11.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 120.28909908575295, "num_env_steps_trained_throughput_per_sec": 120.28909908575295, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 34314.208, "restore_workers_time_ms": 0.022, "training_step_time_ms": 34314.143, "sample_time_ms": 4632.01, "learn_time_ms": 29640.004, "learn_throughput": 134.953, "synch_weights_time_ms": 37.093}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 102, "trial_id": "4f45b_00000", "date": "2024-08-13_03-09-00", "timestamp": 1723532940, "time_this_iter_s": 33.36100792884827, "time_total_s": 6670.17365026474, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24885e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6670.17365026474, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 87.16249999999998, "ram_util_percent": 82.87083333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0127549752829568, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6741844171569461, "policy_loss": -0.0032455058214032936, "vf_loss": 0.6774212559300755, "vf_explained_var": 0.052847632276948796, "kl": 0.006927157257658596, "entropy": 0.5959193886114806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9149995468596301, "cur_kl_coeff": 8.23974609375e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8627751986737604, "policy_loss": -0.005228203547891801, "vf_loss": 0.8680026078665698, "vf_explained_var": 0.08154929078445233, "kl": 0.009624272142000118, "entropy": 0.9515181736340599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "env_runners": {"episode_reward_max": 62.0, "episode_reward_min": -96.0, "episode_reward_mean": -9.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -110.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.0, "predator_policy": 67.0}, "policy_reward_mean": {"prey_policy": -13.88, "predator_policy": 9.08}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.0, 3.0, -75.0, -3.0, 8.0, 0.0, -21.0, 12.0, 62.0, 22.0, 13.0, -9.0, -30.0, -15.0, -9.0, 5.0, 0.0, -15.0, -70.0, -96.0, -23.0, 1.0, 1.0, -11.0, 0.0, -21.0, -5.0, -40.0, -9.0, 0.0, -40.0, -7.0, -21.0, 11.0, 0.0, 0.0, 0.0, -7.0, -10.0, -29.0, -3.0, 0.0, -2.0, -4.0, -3.0, -10.0, -34.0, 2.0, -27.0, 4.0, -36.0, -52.0, 2.0, -57.0, -14.0, -5.0, 0.0, 0.0, -28.0, -4.0, -2.0, -6.0, 2.0, -21.0, 12.0, -7.0, -2.0, 0.0, -5.0, -67.0, 9.0, 0.0, -16.0, 0.0, -38.0, -10.0, -21.0, 1.0, -8.0, -1.0, 10.0, -27.0, 0.0, 2.0, -14.0, 0.0, -1.0, -11.0, -8.0, -2.0, 3.0, -1.0, 7.0, -5.0, -10.0, -17.0, -2.0, 1.0, -14.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.0, -4.0, 0.0, -9.0, -60.0, -75.0, -6.0, 0.0, -11.0, 8.0, 0.0, 0.0, -10.0, -53.0, 12.0, 0.0, 11.0, 15.0, -14.0, 27.0, -3.0, 11.0, -18.0, 0.0, -50.0, -31.0, 0.0, -97.0, -15.0, -11.0, -7.0, -8.0, 0.0, 0.0, -16.0, -14.0, -94.0, -61.0, -88.0, -52.0, -6.0, -40.0, -7.0, 4.0, 1.0, 0.0, -45.0, 0.0, 0.0, 0.0, -52.0, 0.0, 0.0, -10.0, -40.0, -42.0, -34.0, -6.0, 0.0, 0.0, -52.0, -20.0, -18.0, 0.0, -83.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -42.0, 0.0, -16.0, -4.0, -8.0, -53.0, -8.0, 0.0, 0.0, 0.0, -12.0, 0.0, -2.0, -4.0, 0.0, -16.0, 2.0, -24.0, -52.0, -17.0, -3.0, -13.0, -43.0, -7.0, -25.0, 0.0, -20.0, -110.0, -92.0, -12.0, 2.0, -2.0, -86.0, -44.0, -14.0, -14.0, -4.0, -6.0, 0.0, 0.0, 0.0, 0.0, -63.0, 0.0, -22.0, 0.0, 0.0, -6.0, 0.0, -24.0, 0.0, -8.0, -26.0, -18.0, 0.0, 12.0, -4.0, -9.0, 0.0, -4.0, 0.0, 0.0, 12.0, -48.0, -64.0, -45.0, 0.0, 5.0, 0.0, 0.0, -37.0, 0.0, 0.0, 0.0, -12.0, -69.0, 13.0, -51.0, -16.0, -30.0, -5.0, 0.0, 0.0, -16.0, -6.0, -3.0, 10.0, 0.0, -34.0, -24.0, 0.0, -1.0, 0.0, 2.0, -16.0, -8.0, 0.0, 0.0, 0.0, -2.0, -4.0, -18.0, -16.0, 0.0, -8.0, 0.0, -22.0, 11.0, 0.0, -8.0, 1.0, -6.0, -11.0, 0.0, -22.0, 0.0, 0.0, -44.0, -4.0, 0.0, 0.0, -9.0, 0.0, -69.0, 1.0, 1.0], "policy_predator_policy_reward": [1.0, 5.0, 3.0, 9.0, 18.0, 42.0, 3.0, 0.0, 4.0, 7.0, 0.0, 0.0, 11.0, 31.0, 0.0, 0.0, 19.0, 17.0, 9.0, 0.0, 5.0, 0.0, 1.0, 8.0, 7.0, 44.0, 40.0, 42.0, 16.0, 1.0, 17.0, 3.0, 0.0, 0.0, 15.0, 0.0, 67.0, 18.0, 44.0, 0.0, 3.0, 20.0, 0.0, 4.0, 0.0, 0.0, 12.0, 22.0, 0.0, 0.0, 22.0, 9.0, 0.0, 5.0, 1.0, 41.0, 18.0, 13.0, 0.0, 0.0, 2.0, 30.0, 4.0, 7.0, 41.0, 21.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 19.0, 16.0, 2.0, 8.0, 22.0, 10.0, 0.0, 5.0, 0.0, 0.0, 6.0, 4.0, 2.0, 0.0, 0.0, 13.0, 1.0, 11.0, 7.0, 28.0, 5.0, 13.0, 4.0, 19.0, 11.0, 18.0, 49.0, 45.0, 16.0, 36.0, 0.0, 2.0, 51.0, 22.0, 7.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 31.0, 16.0, 2.0, 3.0, 1.0, 18.0, 0.0, 6.0, 4.0, 13.0, 10.0, 0.0, 0.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, 7.0, 24.0, 0.0, 42.0, 0.0, 4.0, 0.0, 0.0, 17.0, 4.0, 0.0, 0.0, 6.0, 37.0, 2.0, 26.0, 17.0, 8.0, 6.0, 0.0, 5.0, 3.0, 0.0, 8.0, 0.0, 0.0, 17.0, 14.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 6.0, 8.0, 0.0, 0.0, 6.0, 10.0, 4.0, 4.0, 3.0, 0.0, 12.0, 0.0, 6.0, 11.0, 1.0, 8.0, 19.0, 2.0, 0.0, 3.0, 7.0, 28.0, 27.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8360222672766502, "mean_inference_ms": 25.238139945036746, "mean_action_processing_ms": 0.7952858304704997, "mean_env_wait_ms": 0.6312125425705074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011151790618896484, "StateBufferConnector_ms": 0.012817740440368652, "ViewRequirementAgentConnector_ms": 0.3648034334182739}, "num_episodes": 22, "episode_return_max": 62.0, "episode_return_min": -96.0, "episode_return_mean": -9.6, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 111.21383194034449, "num_env_steps_trained_throughput_per_sec": 111.21383194034449, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 1648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1648000, "timers": {"training_iteration_time_ms": 34799.088, "restore_workers_time_ms": 0.022, "training_step_time_ms": 34799.02, "sample_time_ms": 4898.719, "learn_time_ms": 29851.403, "learn_throughput": 133.997, "synch_weights_time_ms": 43.624}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "done": false, "training_iteration": 103, "trial_id": "4f45b_00000", "date": "2024-08-13_03-09-36", "timestamp": 1723532976, "time_this_iter_s": 36.025394916534424, "time_total_s": 6706.199045181274, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24bf280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6706.199045181274, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 89.01764705882353, "ram_util_percent": 83.12549019607843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1088177458319084, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8195279235089267, "policy_loss": -0.0021163169587173907, "vf_loss": 0.8216349806498598, "vf_explained_var": 0.016740513005584635, "kl": 0.00739927676991239, "entropy": 0.6377823044067968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8032149475954828, "cur_kl_coeff": 8.23974609375e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0959213140780333, "policy_loss": -0.0046533688722996324, "vf_loss": 1.1005739160000332, "vf_explained_var": 0.034604582111671486, "kl": 0.009306942916581303, "entropy": 0.9363985730226708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -96.0, "episode_reward_mean": -9.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -110.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 17.0, "predator_policy": 67.0}, "policy_reward_mean": {"prey_policy": -12.745, "predator_policy": 7.93}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.0, -96.0, -23.0, 1.0, 1.0, -11.0, 0.0, -21.0, -5.0, -40.0, -9.0, 0.0, -40.0, -7.0, -21.0, 11.0, 0.0, 0.0, 0.0, -7.0, -10.0, -29.0, -3.0, 0.0, -2.0, -4.0, -3.0, -10.0, -34.0, 2.0, -27.0, 4.0, -36.0, -52.0, 2.0, -57.0, -14.0, -5.0, 0.0, 0.0, -28.0, -4.0, -2.0, -6.0, 2.0, -21.0, 12.0, -7.0, -2.0, 0.0, -5.0, -67.0, 9.0, 0.0, -16.0, 0.0, -38.0, -10.0, -21.0, 1.0, -8.0, -1.0, 10.0, -27.0, 0.0, 2.0, -14.0, 0.0, -1.0, -11.0, -8.0, -2.0, 3.0, -1.0, 7.0, -5.0, -10.0, -17.0, -2.0, 1.0, -14.0, 2.0, -5.0, 27.0, -2.0, -3.0, -5.0, -27.0, 0.0, 0.0, -7.0, 4.0, -5.0, -30.0, -9.0, 0.0, 1.0, -4.0, 16.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-94.0, -61.0, -88.0, -52.0, -6.0, -40.0, -7.0, 4.0, 1.0, 0.0, -45.0, 0.0, 0.0, 0.0, -52.0, 0.0, 0.0, -10.0, -40.0, -42.0, -34.0, -6.0, 0.0, 0.0, -52.0, -20.0, -18.0, 0.0, -83.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 0.0, -42.0, 0.0, -16.0, -4.0, -8.0, -53.0, -8.0, 0.0, 0.0, 0.0, -12.0, 0.0, -2.0, -4.0, 0.0, -16.0, 2.0, -24.0, -52.0, -17.0, -3.0, -13.0, -43.0, -7.0, -25.0, 0.0, -20.0, -110.0, -92.0, -12.0, 2.0, -2.0, -86.0, -44.0, -14.0, -14.0, -4.0, -6.0, 0.0, 0.0, 0.0, 0.0, -63.0, 0.0, -22.0, 0.0, 0.0, -6.0, 0.0, -24.0, 0.0, -8.0, -26.0, -18.0, 0.0, 12.0, -4.0, -9.0, 0.0, -4.0, 0.0, 0.0, 12.0, -48.0, -64.0, -45.0, 0.0, 5.0, 0.0, 0.0, -37.0, 0.0, 0.0, 0.0, -12.0, -69.0, 13.0, -51.0, -16.0, -30.0, -5.0, 0.0, 0.0, -16.0, -6.0, -3.0, 10.0, 0.0, -34.0, -24.0, 0.0, -1.0, 0.0, 2.0, -16.0, -8.0, 0.0, 0.0, 0.0, -2.0, -4.0, -18.0, -16.0, 0.0, -8.0, 0.0, -22.0, 11.0, 0.0, -8.0, 1.0, -6.0, -11.0, 0.0, -22.0, 0.0, 0.0, -44.0, -4.0, 0.0, 0.0, -9.0, 0.0, -69.0, 1.0, 1.0, -10.0, 0.0, -15.0, 17.0, 0.0, -10.0, -6.0, 0.0, -10.0, 0.0, -26.0, -28.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 2.0, -8.0, -10.0, 0.0, -20.0, -37.0, 0.0, -18.0, 0.0, 0.0, 0.0, 1.0, -14.0, 1.0, 8.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [67.0, 18.0, 44.0, 0.0, 3.0, 20.0, 0.0, 4.0, 0.0, 0.0, 12.0, 22.0, 0.0, 0.0, 22.0, 9.0, 0.0, 5.0, 1.0, 41.0, 18.0, 13.0, 0.0, 0.0, 2.0, 30.0, 4.0, 7.0, 41.0, 21.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 19.0, 16.0, 2.0, 8.0, 22.0, 10.0, 0.0, 5.0, 0.0, 0.0, 6.0, 4.0, 2.0, 0.0, 0.0, 13.0, 1.0, 11.0, 7.0, 28.0, 5.0, 13.0, 4.0, 19.0, 11.0, 18.0, 49.0, 45.0, 16.0, 36.0, 0.0, 2.0, 51.0, 22.0, 7.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 31.0, 16.0, 2.0, 3.0, 1.0, 18.0, 0.0, 6.0, 4.0, 13.0, 10.0, 0.0, 0.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, 7.0, 24.0, 0.0, 42.0, 0.0, 4.0, 0.0, 0.0, 17.0, 4.0, 0.0, 0.0, 6.0, 37.0, 2.0, 26.0, 17.0, 8.0, 6.0, 0.0, 5.0, 3.0, 0.0, 8.0, 0.0, 0.0, 17.0, 14.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 6.0, 8.0, 0.0, 0.0, 6.0, 10.0, 4.0, 4.0, 3.0, 0.0, 12.0, 0.0, 6.0, 11.0, 1.0, 8.0, 19.0, 2.0, 0.0, 3.0, 7.0, 28.0, 27.0, 0.0, 0.0, 3.0, 2.0, 14.0, 11.0, 8.0, 0.0, 0.0, 3.0, 5.0, 0.0, 21.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 27.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 4.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8434411976462044, "mean_inference_ms": 25.078912859429273, "mean_action_processing_ms": 0.7978561534709877, "mean_env_wait_ms": 0.6333049879572975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011132121086120605, "StateBufferConnector_ms": 0.012762308120727539, "ViewRequirementAgentConnector_ms": 0.39951372146606445}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -96.0, "episode_return_mean": -9.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 112.08364446772121, "num_env_steps_trained_throughput_per_sec": 112.08364446772121, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1664000, "timers": {"training_iteration_time_ms": 33690.465, "restore_workers_time_ms": 0.024, "training_step_time_ms": 33690.394, "sample_time_ms": 5064.707, "learn_time_ms": 28575.516, "learn_throughput": 139.98, "synch_weights_time_ms": 44.533}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "done": false, "training_iteration": 104, "trial_id": "4f45b_00000", "date": "2024-08-13_03-10-12", "timestamp": 1723533012, "time_this_iter_s": 35.81586003303528, "time_total_s": 6742.01490521431, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24bf4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6742.01490521431, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 89.68799999999997, "ram_util_percent": 83.138}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8460796431968451, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6852870784739338, "policy_loss": -0.003209927598403757, "vf_loss": 0.6884893253130256, "vf_explained_var": 0.028644765117181042, "kl": 0.006138512570008572, "entropy": 0.6466290141539599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1871970910086205, "cur_kl_coeff": 8.23974609375e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.050393348593245, "policy_loss": -0.002526276895441312, "vf_loss": 1.0529191784442418, "vf_explained_var": 0.043306601110589565, "kl": 0.005424030453261963, "entropy": 1.0213805028685816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -67.0, "episode_reward_mean": -6.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -110.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 51.0}, "policy_reward_mean": {"prey_policy": -9.65, "predator_policy": 6.37}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -2.0, -4.0, -3.0, -10.0, -34.0, 2.0, -27.0, 4.0, -36.0, -52.0, 2.0, -57.0, -14.0, -5.0, 0.0, 0.0, -28.0, -4.0, -2.0, -6.0, 2.0, -21.0, 12.0, -7.0, -2.0, 0.0, -5.0, -67.0, 9.0, 0.0, -16.0, 0.0, -38.0, -10.0, -21.0, 1.0, -8.0, -1.0, 10.0, -27.0, 0.0, 2.0, -14.0, 0.0, -1.0, -11.0, -8.0, -2.0, 3.0, -1.0, 7.0, -5.0, -10.0, -17.0, -2.0, 1.0, -14.0, 2.0, -5.0, 27.0, -2.0, -3.0, -5.0, -27.0, 0.0, 0.0, -7.0, 4.0, -5.0, -30.0, -9.0, 0.0, 1.0, -4.0, 16.0, 0.0, 0.0, -12.0, -7.0, -9.0, 0.0, -9.0, 20.0, 2.0, -5.0, 2.0, 7.0, 6.0, -39.0, 3.0, 8.0, 0.0, -5.0, -19.0, 0.0, -3.0, 0.0, -6.0, -6.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -12.0, 0.0, -2.0, -4.0, 0.0, -16.0, 2.0, -24.0, -52.0, -17.0, -3.0, -13.0, -43.0, -7.0, -25.0, 0.0, -20.0, -110.0, -92.0, -12.0, 2.0, -2.0, -86.0, -44.0, -14.0, -14.0, -4.0, -6.0, 0.0, 0.0, 0.0, 0.0, -63.0, 0.0, -22.0, 0.0, 0.0, -6.0, 0.0, -24.0, 0.0, -8.0, -26.0, -18.0, 0.0, 12.0, -4.0, -9.0, 0.0, -4.0, 0.0, 0.0, 12.0, -48.0, -64.0, -45.0, 0.0, 5.0, 0.0, 0.0, -37.0, 0.0, 0.0, 0.0, -12.0, -69.0, 13.0, -51.0, -16.0, -30.0, -5.0, 0.0, 0.0, -16.0, -6.0, -3.0, 10.0, 0.0, -34.0, -24.0, 0.0, -1.0, 0.0, 2.0, -16.0, -8.0, 0.0, 0.0, 0.0, -2.0, -4.0, -18.0, -16.0, 0.0, -8.0, 0.0, -22.0, 11.0, 0.0, -8.0, 1.0, -6.0, -11.0, 0.0, -22.0, 0.0, 0.0, -44.0, -4.0, 0.0, 0.0, -9.0, 0.0, -69.0, 1.0, 1.0, -10.0, 0.0, -15.0, 17.0, 0.0, -10.0, -6.0, 0.0, -10.0, 0.0, -26.0, -28.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 2.0, -8.0, -10.0, 0.0, -20.0, -37.0, 0.0, -18.0, 0.0, 0.0, 0.0, 1.0, -14.0, 1.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -36.0, -2.0, -8.0, -10.0, -37.0, 0.0, 0.0, 0.0, 6.0, -30.0, 20.0, 0.0, 2.0, 0.0, 0.0, -10.0, 3.0, -2.0, -1.0, 0.0, 12.0, -18.0, -24.0, -36.0, -8.0, 0.0, -2.0, 9.0, -1.0, 0.0, 0.0, -13.0, 0.0, -44.0, 0.0, 0.0, -7.0, -6.0, 0.0, 0.0, 0.0, -12.0, 4.0, -20.0], "policy_predator_policy_reward": [0.0, 0.0, 6.0, 4.0, 2.0, 0.0, 0.0, 13.0, 1.0, 11.0, 7.0, 28.0, 5.0, 13.0, 4.0, 19.0, 11.0, 18.0, 49.0, 45.0, 16.0, 36.0, 0.0, 2.0, 51.0, 22.0, 7.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 31.0, 16.0, 2.0, 3.0, 1.0, 18.0, 0.0, 6.0, 4.0, 13.0, 10.0, 0.0, 0.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, 7.0, 24.0, 0.0, 42.0, 0.0, 4.0, 0.0, 0.0, 17.0, 4.0, 0.0, 0.0, 6.0, 37.0, 2.0, 26.0, 17.0, 8.0, 6.0, 0.0, 5.0, 3.0, 0.0, 8.0, 0.0, 0.0, 17.0, 14.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 6.0, 8.0, 0.0, 0.0, 6.0, 10.0, 4.0, 4.0, 3.0, 0.0, 12.0, 0.0, 6.0, 11.0, 1.0, 8.0, 19.0, 2.0, 0.0, 3.0, 7.0, 28.0, 27.0, 0.0, 0.0, 3.0, 2.0, 14.0, 11.0, 8.0, 0.0, 0.0, 3.0, 5.0, 0.0, 21.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 27.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 18.0, 8.0, 7.0, 4.0, 8.0, 20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 1.0, 0.0, 0.0, 8.0, 10.0, 2.0, 0.0, 21.0, 5.0, 6.0, 1.0, 0.0, 1.0, 0.0, 2.0, 6.0, 1.0, 24.0, 0.0, 0.0, 1.0, 9.0, 0.0, 0.0, 2.0, 4.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3488478536801547, "mean_inference_ms": 27.223687440281743, "mean_action_processing_ms": 0.8028443566911188, "mean_env_wait_ms": 0.6384776476811471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013325333595275879, "StateBufferConnector_ms": 0.01192629337310791, "ViewRequirementAgentConnector_ms": 0.4869842529296875}, "num_episodes": 23, "episode_return_max": 27.0, "episode_return_min": -67.0, "episode_return_mean": -6.56, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.667012330598776, "num_env_steps_trained_throughput_per_sec": 6.667012330598776, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 90046.561, "restore_workers_time_ms": 0.024, "training_step_time_ms": 90046.489, "sample_time_ms": 62709.935, "learn_time_ms": 27287.2, "learn_throughput": 146.589, "synch_weights_time_ms": 43.833}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 105, "trial_id": "4f45b_00000", "date": "2024-08-13_03-20-12", "timestamp": 1723533612, "time_this_iter_s": 600.010336637497, "time_total_s": 7342.025241851807, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24bfd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7342.025241851807, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 93.5125, "ram_util_percent": 83.39}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1549077963072154, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9613172609496999, "policy_loss": -0.0012444543602960136, "vf_loss": 0.9625553060145605, "vf_explained_var": 0.04340067666674417, "kl": 0.005121610751117535, "entropy": 0.6081532969045891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.355042661072085, "cur_kl_coeff": 8.23974609375e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4479798041244663, "policy_loss": -0.004911625415219792, "vf_loss": 1.4528900775959883, "vf_explained_var": 0.06008213935074983, "kl": 0.016387767192791353, "entropy": 0.9934335672981525, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -67.0, "episode_reward_mean": -4.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -69.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 42.0}, "policy_reward_mean": {"prey_policy": -7.12, "predator_policy": 4.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -2.0, -6.0, 2.0, -21.0, 12.0, -7.0, -2.0, 0.0, -5.0, -67.0, 9.0, 0.0, -16.0, 0.0, -38.0, -10.0, -21.0, 1.0, -8.0, -1.0, 10.0, -27.0, 0.0, 2.0, -14.0, 0.0, -1.0, -11.0, -8.0, -2.0, 3.0, -1.0, 7.0, -5.0, -10.0, -17.0, -2.0, 1.0, -14.0, 2.0, -5.0, 27.0, -2.0, -3.0, -5.0, -27.0, 0.0, 0.0, -7.0, 4.0, -5.0, -30.0, -9.0, 0.0, 1.0, -4.0, 16.0, 0.0, 0.0, -12.0, -7.0, -9.0, 0.0, -9.0, 20.0, 2.0, -5.0, 2.0, 7.0, 6.0, -39.0, 3.0, 8.0, 0.0, -5.0, -19.0, 0.0, -3.0, 0.0, -6.0, -6.0, 0.0, 13.0, -4.0, -12.0, 0.0, -16.0, 1.0, -14.0, 4.0, -3.0, 6.0, 0.0, 5.0, -13.0, -9.0, -5.0, -3.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-22.0, 0.0, 0.0, -6.0, 0.0, -24.0, 0.0, -8.0, -26.0, -18.0, 0.0, 12.0, -4.0, -9.0, 0.0, -4.0, 0.0, 0.0, 12.0, -48.0, -64.0, -45.0, 0.0, 5.0, 0.0, 0.0, -37.0, 0.0, 0.0, 0.0, -12.0, -69.0, 13.0, -51.0, -16.0, -30.0, -5.0, 0.0, 0.0, -16.0, -6.0, -3.0, 10.0, 0.0, -34.0, -24.0, 0.0, -1.0, 0.0, 2.0, -16.0, -8.0, 0.0, 0.0, 0.0, -2.0, -4.0, -18.0, -16.0, 0.0, -8.0, 0.0, -22.0, 11.0, 0.0, -8.0, 1.0, -6.0, -11.0, 0.0, -22.0, 0.0, 0.0, -44.0, -4.0, 0.0, 0.0, -9.0, 0.0, -69.0, 1.0, 1.0, -10.0, 0.0, -15.0, 17.0, 0.0, -10.0, -6.0, 0.0, -10.0, 0.0, -26.0, -28.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 2.0, -8.0, -10.0, 0.0, -20.0, -37.0, 0.0, -18.0, 0.0, 0.0, 0.0, 1.0, -14.0, 1.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -36.0, -2.0, -8.0, -10.0, -37.0, 0.0, 0.0, 0.0, 6.0, -30.0, 20.0, 0.0, 2.0, 0.0, 0.0, -10.0, 3.0, -2.0, -1.0, 0.0, 12.0, -18.0, -24.0, -36.0, -8.0, 0.0, -2.0, 9.0, -1.0, 0.0, 0.0, -13.0, 0.0, -44.0, 0.0, 0.0, -7.0, -6.0, 0.0, 0.0, 0.0, -12.0, 4.0, -20.0, 0.0, 0.0, 0.0, 13.0, 0.0, -8.0, -26.0, 0.0, 0.0, 0.0, -12.0, -25.0, 0.0, 0.0, -42.0, 2.0, -4.0, 2.0, -3.0, -4.0, -2.0, 7.0, -2.0, -6.0, 2.0, 0.0, 0.0, -28.0, -20.0, 0.0, 3.0, -16.0, -6.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [16.0, 2.0, 3.0, 1.0, 18.0, 0.0, 6.0, 4.0, 13.0, 10.0, 0.0, 0.0, 6.0, 0.0, 2.0, 0.0, 0.0, 0.0, 7.0, 24.0, 0.0, 42.0, 0.0, 4.0, 0.0, 0.0, 17.0, 4.0, 0.0, 0.0, 6.0, 37.0, 2.0, 26.0, 17.0, 8.0, 6.0, 0.0, 5.0, 3.0, 0.0, 8.0, 0.0, 0.0, 17.0, 14.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 6.0, 8.0, 0.0, 0.0, 6.0, 10.0, 4.0, 4.0, 3.0, 0.0, 12.0, 0.0, 6.0, 11.0, 1.0, 8.0, 19.0, 2.0, 0.0, 3.0, 7.0, 28.0, 27.0, 0.0, 0.0, 3.0, 2.0, 14.0, 11.0, 8.0, 0.0, 0.0, 3.0, 5.0, 0.0, 21.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 27.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 18.0, 8.0, 7.0, 4.0, 8.0, 20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 1.0, 0.0, 0.0, 8.0, 10.0, 2.0, 0.0, 21.0, 5.0, 6.0, 1.0, 0.0, 1.0, 0.0, 2.0, 6.0, 1.0, 24.0, 0.0, 0.0, 1.0, 9.0, 0.0, 0.0, 2.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, 8.0, 0.0, 0.0, 2.0, 19.0, 0.0, 1.0, 15.0, 11.0, 6.0, 0.0, 1.0, 3.0, 1.0, 0.0, 7.0, 1.0, 3.0, 0.0, 6.0, 9.0, 10.0, 1.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.8432145154608763, "mean_inference_ms": 28.77539678239793, "mean_action_processing_ms": 0.8056265219392711, "mean_env_wait_ms": 0.6417549198199882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012449979782104492, "StateBufferConnector_ms": 0.01145470142364502, "ViewRequirementAgentConnector_ms": 0.4501727819442749}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -67.0, "episode_return_mean": -4.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 232.4573575720641, "num_env_steps_trained_throughput_per_sec": 232.4573575720641, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1696000, "timers": {"training_iteration_time_ms": 88339.574, "restore_workers_time_ms": 0.023, "training_step_time_ms": 88339.504, "sample_time_ms": 62451.425, "learn_time_ms": 25838.398, "learn_throughput": 154.808, "synch_weights_time_ms": 44.299}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "done": false, "training_iteration": 106, "trial_id": "4f45b_00000", "date": "2024-08-13_03-20-30", "timestamp": 1723533630, "time_this_iter_s": 17.41154384613037, "time_total_s": 7359.436785697937, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24a89d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7359.436785697937, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 85.332, "ram_util_percent": 83.51199999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.665500464649112, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6388689599812977, "policy_loss": -0.0027885383960825428, "vf_loss": 0.6416423680999922, "vf_explained_var": 0.034236302735313535, "kl": 0.012090794870688249, "entropy": 0.5967820024364209, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1308336383687756, "cur_kl_coeff": 8.23974609375e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8801311247681499, "policy_loss": -0.009643462976494991, "vf_loss": 0.889772616957546, "vf_explained_var": 0.011812143697940484, "kl": 0.02394010417031029, "entropy": 0.9248034526116002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -39.0, "episode_reward_mean": -4.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -69.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 29.0}, "policy_reward_mean": {"prey_policy": -6.39, "predator_policy": 4.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-27.0, 0.0, 2.0, -14.0, 0.0, -1.0, -11.0, -8.0, -2.0, 3.0, -1.0, 7.0, -5.0, -10.0, -17.0, -2.0, 1.0, -14.0, 2.0, -5.0, 27.0, -2.0, -3.0, -5.0, -27.0, 0.0, 0.0, -7.0, 4.0, -5.0, -30.0, -9.0, 0.0, 1.0, -4.0, 16.0, 0.0, 0.0, -12.0, -7.0, -9.0, 0.0, -9.0, 20.0, 2.0, -5.0, 2.0, 7.0, 6.0, -39.0, 3.0, 8.0, 0.0, -5.0, -19.0, 0.0, -3.0, 0.0, -6.0, -6.0, 0.0, 13.0, -4.0, -12.0, 0.0, -16.0, 1.0, -14.0, 4.0, -3.0, 6.0, 0.0, 5.0, -13.0, -9.0, -5.0, -3.0, 0.0, -6.0, 0.0, -11.0, -3.0, -16.0, 0.0, 9.0, 13.0, -39.0, -8.0, -18.0, -4.0, 10.0, -2.0, -7.0, -20.0, 0.0, -4.0, -2.0, 10.0, -15.0, -20.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-34.0, -24.0, 0.0, -1.0, 0.0, 2.0, -16.0, -8.0, 0.0, 0.0, 0.0, -2.0, -4.0, -18.0, -16.0, 0.0, -8.0, 0.0, -22.0, 11.0, 0.0, -8.0, 1.0, -6.0, -11.0, 0.0, -22.0, 0.0, 0.0, -44.0, -4.0, 0.0, 0.0, -9.0, 0.0, -69.0, 1.0, 1.0, -10.0, 0.0, -15.0, 17.0, 0.0, -10.0, -6.0, 0.0, -10.0, 0.0, -26.0, -28.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 2.0, -8.0, -10.0, 0.0, -20.0, -37.0, 0.0, -18.0, 0.0, 0.0, 0.0, 1.0, -14.0, 1.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -36.0, -2.0, -8.0, -10.0, -37.0, 0.0, 0.0, 0.0, 6.0, -30.0, 20.0, 0.0, 2.0, 0.0, 0.0, -10.0, 3.0, -2.0, -1.0, 0.0, 12.0, -18.0, -24.0, -36.0, -8.0, 0.0, -2.0, 9.0, -1.0, 0.0, 0.0, -13.0, 0.0, -44.0, 0.0, 0.0, -7.0, -6.0, 0.0, 0.0, 0.0, -12.0, 4.0, -20.0, 0.0, 0.0, 0.0, 13.0, 0.0, -8.0, -26.0, 0.0, 0.0, 0.0, -12.0, -25.0, 0.0, 0.0, -42.0, 2.0, -4.0, 2.0, -3.0, -4.0, -2.0, 7.0, -2.0, -6.0, 2.0, 0.0, 0.0, -28.0, -20.0, 0.0, 3.0, -16.0, -6.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -23.0, -6.0, 0.0, 0.0, -34.0, 0.0, 0.0, 3.0, 1.0, 0.0, 9.0, -33.0, -35.0, 0.0, -16.0, -14.0, -14.0, 0.0, -8.0, 6.0, 0.0, -4.0, 0.0, -10.0, -2.0, -41.0, -2.0, 0.0, 0.0, -19.0, 2.0, 0.0, -4.0, 6.0, 0.0, -30.0, -5.0, -40.0, 0.0], "policy_predator_policy_reward": [17.0, 14.0, 1.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 6.0, 8.0, 0.0, 0.0, 6.0, 10.0, 4.0, 4.0, 3.0, 0.0, 12.0, 0.0, 6.0, 11.0, 1.0, 8.0, 19.0, 2.0, 0.0, 3.0, 7.0, 28.0, 27.0, 0.0, 0.0, 3.0, 2.0, 14.0, 11.0, 8.0, 0.0, 0.0, 3.0, 5.0, 0.0, 21.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 27.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 18.0, 8.0, 7.0, 4.0, 8.0, 20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 1.0, 0.0, 0.0, 8.0, 10.0, 2.0, 0.0, 21.0, 5.0, 6.0, 1.0, 0.0, 1.0, 0.0, 2.0, 6.0, 1.0, 24.0, 0.0, 0.0, 1.0, 9.0, 0.0, 0.0, 2.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, 8.0, 0.0, 0.0, 2.0, 19.0, 0.0, 1.0, 15.0, 11.0, 6.0, 0.0, 1.0, 3.0, 1.0, 0.0, 7.0, 1.0, 3.0, 0.0, 6.0, 9.0, 10.0, 1.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 2.0, 3.0, 0.0, 8.0, 10.0, 0.0, 0.0, 5.0, 0.0, 2.0, 2.0, 29.0, 0.0, 8.0, 0.0, 10.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 4.0, 1.0, 11.0, 12.0, 0.0, 0.0, 8.0, 5.0, 2.0, 0.0, 0.0, 4.0, 4.0, 16.0, 5.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 5.9792041654841, "mean_inference_ms": 32.13122078031068, "mean_action_processing_ms": 0.8080552500195373, "mean_env_wait_ms": 1.0477541064618365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009213089942932129, "StateBufferConnector_ms": 0.010568022727966309, "ViewRequirementAgentConnector_ms": 0.40075206756591797}, "num_episodes": 22, "episode_return_max": 27.0, "episode_return_min": -39.0, "episode_return_mean": -4.01, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.058817567640824, "num_env_steps_trained_throughput_per_sec": 4.058817567640824, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 1712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1712000, "timers": {"training_iteration_time_ms": 183401.012, "restore_workers_time_ms": 0.026, "training_step_time_ms": 183400.936, "sample_time_ms": 158270.892, "learn_time_ms": 25079.427, "learn_throughput": 159.493, "synch_weights_time_ms": 44.802}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "done": false, "training_iteration": 107, "trial_id": "4f45b_00000", "date": "2024-08-13_03-36-55", "timestamp": 1723534615, "time_this_iter_s": 985.595538854599, "time_total_s": 8345.032324552536, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b276af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8345.032324552536, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 96.47555555555553, "ram_util_percent": 83.13111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7431684248898396, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9465992567242769, "policy_loss": -0.0016866254368944774, "vf_loss": 0.9482789923195486, "vf_explained_var": 0.006253291217107621, "kl": 0.00550477243714145, "entropy": 0.6163162056100432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8296342159310977, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2696855390119175, "policy_loss": -0.006597564924784281, "vf_loss": 1.27628241337481, "vf_explained_var": 0.021247377250560376, "kl": 0.005590390093200565, "entropy": 0.9710951116349962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 27.0, "episode_reward_min": -63.0, "episode_reward_mean": -4.67, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -82.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": -7.0, "predator_policy": 4.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, -5.0, 27.0, -2.0, -3.0, -5.0, -27.0, 0.0, 0.0, -7.0, 4.0, -5.0, -30.0, -9.0, 0.0, 1.0, -4.0, 16.0, 0.0, 0.0, -12.0, -7.0, -9.0, 0.0, -9.0, 20.0, 2.0, -5.0, 2.0, 7.0, 6.0, -39.0, 3.0, 8.0, 0.0, -5.0, -19.0, 0.0, -3.0, 0.0, -6.0, -6.0, 0.0, 13.0, -4.0, -12.0, 0.0, -16.0, 1.0, -14.0, 4.0, -3.0, 6.0, 0.0, 5.0, -13.0, -9.0, -5.0, -3.0, 0.0, -6.0, 0.0, -11.0, -3.0, -16.0, 0.0, 9.0, 13.0, -39.0, -8.0, -18.0, -4.0, 10.0, -2.0, -7.0, -20.0, 0.0, -4.0, -2.0, 10.0, -15.0, -20.0, 0.0, -4.0, -4.0, -18.0, 0.0, -36.0, 0.0, -22.0, 9.0, 15.0, -12.0, 0.0, -63.0, -1.0, -5.0, -23.0, 0.0, -1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0, 1.0, -10.0, 0.0, -15.0, 17.0, 0.0, -10.0, -6.0, 0.0, -10.0, 0.0, -26.0, -28.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 2.0, -8.0, -10.0, 0.0, -20.0, -37.0, 0.0, -18.0, 0.0, 0.0, 0.0, 1.0, -14.0, 1.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, -36.0, -2.0, -8.0, -10.0, -37.0, 0.0, 0.0, 0.0, 6.0, -30.0, 20.0, 0.0, 2.0, 0.0, 0.0, -10.0, 3.0, -2.0, -1.0, 0.0, 12.0, -18.0, -24.0, -36.0, -8.0, 0.0, -2.0, 9.0, -1.0, 0.0, 0.0, -13.0, 0.0, -44.0, 0.0, 0.0, -7.0, -6.0, 0.0, 0.0, 0.0, -12.0, 4.0, -20.0, 0.0, 0.0, 0.0, 13.0, 0.0, -8.0, -26.0, 0.0, 0.0, 0.0, -12.0, -25.0, 0.0, 0.0, -42.0, 2.0, -4.0, 2.0, -3.0, -4.0, -2.0, 7.0, -2.0, -6.0, 2.0, 0.0, 0.0, -28.0, -20.0, 0.0, 3.0, -16.0, -6.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -23.0, -6.0, 0.0, 0.0, -34.0, 0.0, 0.0, 3.0, 1.0, 0.0, 9.0, -33.0, -35.0, 0.0, -16.0, -14.0, -14.0, 0.0, -8.0, 6.0, 0.0, -4.0, 0.0, -10.0, -2.0, -41.0, -2.0, 0.0, 0.0, -19.0, 2.0, 0.0, -4.0, 6.0, 0.0, -30.0, -5.0, -40.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -40.0, 0.0, -38.0, 0.0, 0.0, -10.0, -65.0, -20.0, 0.0, 0.0, -44.0, 9.0, 0.0, -6.0, 17.0, -35.0, 5.0, -10.0, -1.0, -33.0, -82.0, 0.0, -4.0, 0.0, -12.0, -54.0, 0.0, 0.0, 0.0, -3.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 3.0, 2.0, 14.0, 11.0, 8.0, 0.0, 0.0, 3.0, 5.0, 0.0, 21.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 27.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 18.0, 8.0, 7.0, 4.0, 8.0, 20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 1.0, 0.0, 0.0, 8.0, 10.0, 2.0, 0.0, 21.0, 5.0, 6.0, 1.0, 0.0, 1.0, 0.0, 2.0, 6.0, 1.0, 24.0, 0.0, 0.0, 1.0, 9.0, 0.0, 0.0, 2.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, 8.0, 0.0, 0.0, 2.0, 19.0, 0.0, 1.0, 15.0, 11.0, 6.0, 0.0, 1.0, 3.0, 1.0, 0.0, 7.0, 1.0, 3.0, 0.0, 6.0, 9.0, 10.0, 1.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 2.0, 3.0, 0.0, 8.0, 10.0, 0.0, 0.0, 5.0, 0.0, 2.0, 2.0, 29.0, 0.0, 8.0, 0.0, 10.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 4.0, 1.0, 11.0, 12.0, 0.0, 0.0, 8.0, 5.0, 2.0, 0.0, 0.0, 4.0, 4.0, 16.0, 5.0, 15.0, 0.0, 0.0, 0.0, 4.0, 17.0, 19.0, 20.0, 0.0, 0.0, 0.0, 5.0, 34.0, 9.0, 11.0, 22.0, 0.0, 0.0, 0.0, 0.0, 4.0, 9.0, 9.0, 5.0, 6.0, 30.0, 22.0, 1.0, 2.0, 0.0, 7.0, 0.0, 31.0, 0.0, 0.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.4507496572152, "mean_inference_ms": 34.854767018725234, "mean_action_processing_ms": 0.8118222226547807, "mean_env_wait_ms": 1.4492818301669783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0082932710647583, "StateBufferConnector_ms": 0.005985140800476074, "ViewRequirementAgentConnector_ms": 0.34603190422058105}, "num_episodes": 18, "episode_return_max": 27.0, "episode_return_min": -63.0, "episode_return_mean": -4.67, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.32066400784336, "num_env_steps_trained_throughput_per_sec": 243.32066400784336, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 181814.909, "restore_workers_time_ms": 0.028, "training_step_time_ms": 181814.825, "sample_time_ms": 158019.292, "learn_time_ms": 23745.378, "learn_throughput": 168.454, "synch_weights_time_ms": 44.49}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 108, "trial_id": "4f45b_00000", "date": "2024-08-13_03-37-12", "timestamp": 1723534632, "time_this_iter_s": 16.515210151672363, "time_total_s": 8361.547534704208, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24bfd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8361.547534704208, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 82.06521739130436, "ram_util_percent": 83.41739130434782}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6411099559652111, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.47127644704290167, "policy_loss": -0.001989143373932512, "vf_loss": 0.4732556420649407, "vf_explained_var": 0.02398753800089397, "kl": 0.007949484965780818, "entropy": 0.5894960637761172, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9294279076356107, "cur_kl_coeff": 0.00012359619140624997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9204329416786552, "policy_loss": -0.010153812522847186, "vf_loss": 0.9305841631990261, "vf_explained_var": 0.02644485219445809, "kl": 0.020935891094778773, "entropy": 0.9001048925692442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "env_runners": {"episode_reward_max": 20.0, "episode_reward_min": -63.0, "episode_reward_mean": -5.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -114.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 45.0}, "policy_reward_mean": {"prey_policy": -8.215, "predator_policy": 5.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, -12.0, -7.0, -9.0, 0.0, -9.0, 20.0, 2.0, -5.0, 2.0, 7.0, 6.0, -39.0, 3.0, 8.0, 0.0, -5.0, -19.0, 0.0, -3.0, 0.0, -6.0, -6.0, 0.0, 13.0, -4.0, -12.0, 0.0, -16.0, 1.0, -14.0, 4.0, -3.0, 6.0, 0.0, 5.0, -13.0, -9.0, -5.0, -3.0, 0.0, -6.0, 0.0, -11.0, -3.0, -16.0, 0.0, 9.0, 13.0, -39.0, -8.0, -18.0, -4.0, 10.0, -2.0, -7.0, -20.0, 0.0, -4.0, -2.0, 10.0, -15.0, -20.0, 0.0, -4.0, -4.0, -18.0, 0.0, -36.0, 0.0, -22.0, 9.0, 15.0, -12.0, 0.0, -63.0, -1.0, -5.0, -23.0, 0.0, -1.0, -33.0, 13.0, -1.0, -8.0, -15.0, -12.0, 0.0, -4.0, 0.0, 1.0, -24.0, -8.0, 11.0, 0.0, -43.0, -5.0, -15.0, -12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 0.0, -36.0, -2.0, -8.0, -10.0, -37.0, 0.0, 0.0, 0.0, 6.0, -30.0, 20.0, 0.0, 2.0, 0.0, 0.0, -10.0, 3.0, -2.0, -1.0, 0.0, 12.0, -18.0, -24.0, -36.0, -8.0, 0.0, -2.0, 9.0, -1.0, 0.0, 0.0, -13.0, 0.0, -44.0, 0.0, 0.0, -7.0, -6.0, 0.0, 0.0, 0.0, -12.0, 4.0, -20.0, 0.0, 0.0, 0.0, 13.0, 0.0, -8.0, -26.0, 0.0, 0.0, 0.0, -12.0, -25.0, 0.0, 0.0, -42.0, 2.0, -4.0, 2.0, -3.0, -4.0, -2.0, 7.0, -2.0, -6.0, 2.0, 0.0, 0.0, -28.0, -20.0, 0.0, 3.0, -16.0, -6.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -23.0, -6.0, 0.0, 0.0, -34.0, 0.0, 0.0, 3.0, 1.0, 0.0, 9.0, -33.0, -35.0, 0.0, -16.0, -14.0, -14.0, 0.0, -8.0, 6.0, 0.0, -4.0, 0.0, -10.0, -2.0, -41.0, -2.0, 0.0, 0.0, -19.0, 2.0, 0.0, -4.0, 6.0, 0.0, -30.0, -5.0, -40.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -40.0, 0.0, -38.0, 0.0, 0.0, -10.0, -65.0, -20.0, 0.0, 0.0, -44.0, 9.0, 0.0, -6.0, 17.0, -35.0, 5.0, -10.0, -1.0, -33.0, -82.0, 0.0, -4.0, 0.0, -12.0, -54.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, -114.0, 0.0, 13.0, -5.0, 0.0, 0.0, -18.0, -25.0, -4.0, 0.0, -25.0, 0.0, 0.0, -10.0, 0.0, 5.0, -16.0, 0.0, 0.0, -12.0, -52.0, -18.0, 0.0, 0.0, 8.0, 0.0, 0.0, -64.0, -26.0, 2.0, -14.0, 0.0, -39.0, -8.0, -16.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 18.0, 8.0, 7.0, 4.0, 8.0, 20.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 1.0, 0.0, 0.0, 8.0, 10.0, 2.0, 0.0, 21.0, 5.0, 6.0, 1.0, 0.0, 1.0, 0.0, 2.0, 6.0, 1.0, 24.0, 0.0, 0.0, 1.0, 9.0, 0.0, 0.0, 2.0, 4.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, 8.0, 0.0, 0.0, 2.0, 19.0, 0.0, 1.0, 15.0, 11.0, 6.0, 0.0, 1.0, 3.0, 1.0, 0.0, 7.0, 1.0, 3.0, 0.0, 6.0, 9.0, 10.0, 1.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 2.0, 3.0, 0.0, 8.0, 10.0, 0.0, 0.0, 5.0, 0.0, 2.0, 2.0, 29.0, 0.0, 8.0, 0.0, 10.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 4.0, 1.0, 11.0, 12.0, 0.0, 0.0, 8.0, 5.0, 2.0, 0.0, 0.0, 4.0, 4.0, 16.0, 5.0, 15.0, 0.0, 0.0, 0.0, 4.0, 17.0, 19.0, 20.0, 0.0, 0.0, 0.0, 5.0, 34.0, 9.0, 11.0, 22.0, 0.0, 0.0, 0.0, 0.0, 4.0, 9.0, 9.0, 5.0, 6.0, 30.0, 22.0, 1.0, 2.0, 0.0, 7.0, 0.0, 31.0, 0.0, 0.0, 2.0, 0.0, 43.0, 38.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 14.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 1.0, 0.0, 10.0, 30.0, 4.0, 6.0, 0.0, 3.0, 0.0, 0.0, 2.0, 45.0, 7.0, 0.0, 23.0, 1.0, 4.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.89430238459358, "mean_inference_ms": 37.53659527564914, "mean_action_processing_ms": 0.8123074457293297, "mean_env_wait_ms": 1.8452568922607435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007493734359741211, "StateBufferConnector_ms": 0.005231261253356934, "ViewRequirementAgentConnector_ms": 0.2885400056838989}, "num_episodes": 18, "episode_return_max": 20.0, "episode_return_min": -63.0, "episode_return_mean": -5.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.908765224482106, "num_env_steps_trained_throughput_per_sec": 3.908765224482106, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 1744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1744000, "timers": {"training_iteration_time_ms": 281027.511, "restore_workers_time_ms": 0.027, "training_step_time_ms": 281027.425, "sample_time_ms": 157807.548, "learn_time_ms": 123173.568, "learn_throughput": 32.474, "synch_weights_time_ms": 40.461}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "done": false, "training_iteration": 109, "trial_id": "4f45b_00000", "date": "2024-08-13_03-54-15", "timestamp": 1723535655, "time_this_iter_s": 1023.4190201759338, "time_total_s": 9384.966554880142, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c4e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9384.966554880142, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 90.35945945945947, "ram_util_percent": 82.33513513513512}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5350719721465516, "cur_kl_coeff": 0.0012514114379882815, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.612358975024135, "policy_loss": -0.0027771988405634173, "vf_loss": 0.6151312394530842, "vf_explained_var": 0.011040108386801663, "kl": 0.003944142975660973, "entropy": 0.5468598609563535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5038507293535288, "cur_kl_coeff": 0.00018539428710937506, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7692939429441664, "policy_loss": -0.006976953894146299, "vf_loss": 0.7762699988232088, "vf_explained_var": -0.005337123296878956, "kl": 0.004845955201022292, "entropy": 0.8803067421156262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -63.0, "episode_reward_mean": -5.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -114.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.0, "predator_policy": 51.0}, "policy_reward_mean": {"prey_policy": -8.755, "predator_policy": 5.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-6.0, 0.0, 13.0, -4.0, -12.0, 0.0, -16.0, 1.0, -14.0, 4.0, -3.0, 6.0, 0.0, 5.0, -13.0, -9.0, -5.0, -3.0, 0.0, -6.0, 0.0, -11.0, -3.0, -16.0, 0.0, 9.0, 13.0, -39.0, -8.0, -18.0, -4.0, 10.0, -2.0, -7.0, -20.0, 0.0, -4.0, -2.0, 10.0, -15.0, -20.0, 0.0, -4.0, -4.0, -18.0, 0.0, -36.0, 0.0, -22.0, 9.0, 15.0, -12.0, 0.0, -63.0, -1.0, -5.0, -23.0, 0.0, -1.0, -33.0, 13.0, -1.0, -8.0, -15.0, -12.0, 0.0, -4.0, 0.0, 1.0, -24.0, -8.0, 11.0, 0.0, -43.0, -5.0, -15.0, -12.0, -48.0, -37.0, -20.0, -6.0, 16.0, -11.0, 0.0, 0.0, 2.0, 1.0, -13.0, 9.0, 0.0, 12.0, 25.0, -23.0, -5.0, 0.0, 0.0, 0.0, 11.0, -1.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4.0, -20.0, 0.0, 0.0, 0.0, 13.0, 0.0, -8.0, -26.0, 0.0, 0.0, 0.0, -12.0, -25.0, 0.0, 0.0, -42.0, 2.0, -4.0, 2.0, -3.0, -4.0, -2.0, 7.0, -2.0, -6.0, 2.0, 0.0, 0.0, -28.0, -20.0, 0.0, 3.0, -16.0, -6.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -23.0, -6.0, 0.0, 0.0, -34.0, 0.0, 0.0, 3.0, 1.0, 0.0, 9.0, -33.0, -35.0, 0.0, -16.0, -14.0, -14.0, 0.0, -8.0, 6.0, 0.0, -4.0, 0.0, -10.0, -2.0, -41.0, -2.0, 0.0, 0.0, -19.0, 2.0, 0.0, -4.0, 6.0, 0.0, -30.0, -5.0, -40.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -40.0, 0.0, -38.0, 0.0, 0.0, -10.0, -65.0, -20.0, 0.0, 0.0, -44.0, 9.0, 0.0, -6.0, 17.0, -35.0, 5.0, -10.0, -1.0, -33.0, -82.0, 0.0, -4.0, 0.0, -12.0, -54.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, -114.0, 0.0, 13.0, -5.0, 0.0, 0.0, -18.0, -25.0, -4.0, 0.0, -25.0, 0.0, 0.0, -10.0, 0.0, 5.0, -16.0, 0.0, 0.0, -12.0, -52.0, -18.0, 0.0, 0.0, 8.0, 0.0, 0.0, -64.0, -26.0, 2.0, -14.0, 0.0, -39.0, -8.0, -16.0, -16.0, -64.0, -107.0, -8.0, -22.0, -20.0, -12.0, 0.0, 16.0, 0.0, -23.0, -8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, -34.0, 0.0, -6.0, 12.0, 0.0, 0.0, 27.0, -52.0, 0.0, 11.0, -8.0, -38.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, -13.0, 0.0, -4.0, 2.0], "policy_predator_policy_reward": [10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 6.0, 8.0, 0.0, 0.0, 2.0, 19.0, 0.0, 1.0, 15.0, 11.0, 6.0, 0.0, 1.0, 3.0, 1.0, 0.0, 7.0, 1.0, 3.0, 0.0, 6.0, 9.0, 10.0, 1.0, 8.0, 0.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 2.0, 3.0, 0.0, 8.0, 10.0, 0.0, 0.0, 5.0, 0.0, 2.0, 2.0, 29.0, 0.0, 8.0, 0.0, 10.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 4.0, 1.0, 11.0, 12.0, 0.0, 0.0, 8.0, 5.0, 2.0, 0.0, 0.0, 4.0, 4.0, 16.0, 5.0, 15.0, 0.0, 0.0, 0.0, 4.0, 17.0, 19.0, 20.0, 0.0, 0.0, 0.0, 5.0, 34.0, 9.0, 11.0, 22.0, 0.0, 0.0, 0.0, 0.0, 4.0, 9.0, 9.0, 5.0, 6.0, 30.0, 22.0, 1.0, 2.0, 0.0, 7.0, 0.0, 31.0, 0.0, 0.0, 2.0, 0.0, 43.0, 38.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 14.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 1.0, 0.0, 10.0, 30.0, 4.0, 6.0, 0.0, 3.0, 0.0, 0.0, 2.0, 45.0, 7.0, 0.0, 23.0, 1.0, 4.0, 8.0, 0.0, 32.0, 27.0, 51.0, 14.0, 8.0, 0.0, 6.0, 0.0, 0.0, 6.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 1.0, 0.0, 3.0, 0.0, 0.0, 37.0, 0.0, 0.0, 14.0, 4.0, 19.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.406370258407126, "mean_inference_ms": 38.712378931555996, "mean_action_processing_ms": 0.8105864998253519, "mean_env_wait_ms": 2.4303365596861877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005463719367980957, "StateBufferConnector_ms": 0.004441976547241211, "ViewRequirementAgentConnector_ms": 0.1718606948852539}, "num_episodes": 23, "episode_return_max": 25.0, "episode_return_min": -63.0, "episode_return_mean": -5.93, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.97075439592533, "num_env_steps_trained_throughput_per_sec": 195.97075439592533, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 280017.679, "restore_workers_time_ms": 0.026, "training_step_time_ms": 280017.596, "sample_time_ms": 157752.718, "learn_time_ms": 122218.667, "learn_throughput": 32.728, "synch_weights_time_ms": 40.271}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 110, "trial_id": "4f45b_00000", "date": "2024-08-13_03-54-36", "timestamp": 1723535676, "time_this_iter_s": 20.459691047668457, "time_total_s": 9405.42624592781, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2488790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9405.42624592781, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 89.20357142857142, "ram_util_percent": 82.41071428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9642807306199477, "cur_kl_coeff": 0.0006257057189941408, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8812856665837071, "policy_loss": -0.0012067699228369055, "vf_loss": 0.8824898708118963, "vf_explained_var": 0.007907630116851241, "kl": 0.0041036332938140865, "entropy": 0.5888033396825588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8481390432981903, "cur_kl_coeff": 9.269714355468753e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1563797766490589, "policy_loss": -0.0044763681762137264, "vf_loss": 1.160855192813293, "vf_explained_var": 0.015447272762419686, "kl": 0.01028129010795774, "entropy": 0.9686169188173991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -63.0, "episode_reward_mean": -7.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -114.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.0, "predator_policy": 51.0}, "policy_reward_mean": {"prey_policy": -9.75, "predator_policy": 6.08}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -6.0, 0.0, -11.0, -3.0, -16.0, 0.0, 9.0, 13.0, -39.0, -8.0, -18.0, -4.0, 10.0, -2.0, -7.0, -20.0, 0.0, -4.0, -2.0, 10.0, -15.0, -20.0, 0.0, -4.0, -4.0, -18.0, 0.0, -36.0, 0.0, -22.0, 9.0, 15.0, -12.0, 0.0, -63.0, -1.0, -5.0, -23.0, 0.0, -1.0, -33.0, 13.0, -1.0, -8.0, -15.0, -12.0, 0.0, -4.0, 0.0, 1.0, -24.0, -8.0, 11.0, 0.0, -43.0, -5.0, -15.0, -12.0, -48.0, -37.0, -20.0, -6.0, 16.0, -11.0, 0.0, 0.0, 2.0, 1.0, -13.0, 9.0, 0.0, 12.0, 25.0, -23.0, -5.0, 0.0, 0.0, 0.0, 11.0, -1.0, 4.0, -10.0, -4.0, -8.0, 0.0, -6.0, -21.0, -39.0, -4.0, -1.0, -19.0, 0.0, -1.0, 0.0, -60.0, -16.0, 2.0, -10.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, -23.0, -6.0, 0.0, 0.0, -34.0, 0.0, 0.0, 3.0, 1.0, 0.0, 9.0, -33.0, -35.0, 0.0, -16.0, -14.0, -14.0, 0.0, -8.0, 6.0, 0.0, -4.0, 0.0, -10.0, -2.0, -41.0, -2.0, 0.0, 0.0, -19.0, 2.0, 0.0, -4.0, 6.0, 0.0, -30.0, -5.0, -40.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -40.0, 0.0, -38.0, 0.0, 0.0, -10.0, -65.0, -20.0, 0.0, 0.0, -44.0, 9.0, 0.0, -6.0, 17.0, -35.0, 5.0, -10.0, -1.0, -33.0, -82.0, 0.0, -4.0, 0.0, -12.0, -54.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, -114.0, 0.0, 13.0, -5.0, 0.0, 0.0, -18.0, -25.0, -4.0, 0.0, -25.0, 0.0, 0.0, -10.0, 0.0, 5.0, -16.0, 0.0, 0.0, -12.0, -52.0, -18.0, 0.0, 0.0, 8.0, 0.0, 0.0, -64.0, -26.0, 2.0, -14.0, 0.0, -39.0, -8.0, -16.0, -16.0, -64.0, -107.0, -8.0, -22.0, -20.0, -12.0, 0.0, 16.0, 0.0, -23.0, -8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, -34.0, 0.0, -6.0, 12.0, 0.0, 0.0, 27.0, -52.0, 0.0, 11.0, -8.0, -38.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, -13.0, 0.0, -4.0, 2.0, -2.0, -19.0, 0.0, -12.0, 0.0, -17.0, 0.0, 0.0, 0.0, -14.0, -30.0, -24.0, -27.0, -30.0, -8.0, 0.0, 0.0, -2.0, -4.0, -38.0, 0.0, 0.0, -2.0, -1.0, 0.0, 0.0, -41.0, -46.0, -25.0, -14.0, -12.0, 8.0, -30.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 10.0, 2.0, 3.0, 0.0, 8.0, 10.0, 0.0, 0.0, 5.0, 0.0, 2.0, 2.0, 29.0, 0.0, 8.0, 0.0, 10.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 4.0, 1.0, 11.0, 12.0, 0.0, 0.0, 8.0, 5.0, 2.0, 0.0, 0.0, 4.0, 4.0, 16.0, 5.0, 15.0, 0.0, 0.0, 0.0, 4.0, 17.0, 19.0, 20.0, 0.0, 0.0, 0.0, 5.0, 34.0, 9.0, 11.0, 22.0, 0.0, 0.0, 0.0, 0.0, 4.0, 9.0, 9.0, 5.0, 6.0, 30.0, 22.0, 1.0, 2.0, 0.0, 7.0, 0.0, 31.0, 0.0, 0.0, 2.0, 0.0, 43.0, 38.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 14.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 1.0, 0.0, 10.0, 30.0, 4.0, 6.0, 0.0, 3.0, 0.0, 0.0, 2.0, 45.0, 7.0, 0.0, 23.0, 1.0, 4.0, 8.0, 0.0, 32.0, 27.0, 51.0, 14.0, 8.0, 0.0, 6.0, 0.0, 0.0, 6.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 1.0, 0.0, 3.0, 0.0, 0.0, 37.0, 0.0, 0.0, 14.0, 4.0, 19.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 3.0, 4.0, 7.0, 5.0, 3.0, 0.0, 9.0, 0.0, 0.0, 7.0, 1.0, 22.0, 11.0, 0.0, 18.0, 0.0, 4.0, 0.0, 1.0, 2.0, 21.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 27.0, 7.0, 16.0, 0.0, 6.0, 0.0, 20.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.315573824385172, "mean_inference_ms": 39.63516910107154, "mean_action_processing_ms": 0.8093215188063121, "mean_env_wait_ms": 2.8170572945891776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006418585777282715, "StateBufferConnector_ms": 0.0036858320236206055, "ViewRequirementAgentConnector_ms": 0.163529634475708}, "num_episodes": 18, "episode_return_max": 25.0, "episode_return_min": -63.0, "episode_return_mean": -7.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.84623922997847, "num_env_steps_trained_throughput_per_sec": 243.84623922997847, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 278418.802, "restore_workers_time_ms": 0.025, "training_step_time_ms": 278418.719, "sample_time_ms": 157463.3, "learn_time_ms": 120908.629, "learn_throughput": 33.083, "synch_weights_time_ms": 40.357}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 111, "trial_id": "4f45b_00000", "date": "2024-08-13_03-54-52", "timestamp": 1723535692, "time_this_iter_s": 16.456189393997192, "time_total_s": 9421.882435321808, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24a8dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9421.882435321808, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 80.49166666666666, "ram_util_percent": 79.84583333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8911638427032995, "cur_kl_coeff": 0.0003128528594970704, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9550798090677413, "policy_loss": -0.0016236287687052652, "vf_loss": 0.9567013968866338, "vf_explained_var": 0.008392036907256597, "kl": 0.006517688631102134, "entropy": 0.6449800544630283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0020882744953115, "cur_kl_coeff": 9.269714355468753e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.245982756453847, "policy_loss": -0.0051871237450983945, "vf_loss": 1.2511686139951939, "vf_explained_var": 0.010909260643853082, "kl": 0.013668775189226642, "entropy": 0.9194655817652505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -63.0, "episode_reward_mean": -8.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -121.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": -11.7, "predator_policy": 7.57}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, 0.0, -4.0, -4.0, -18.0, 0.0, -36.0, 0.0, -22.0, 9.0, 15.0, -12.0, 0.0, -63.0, -1.0, -5.0, -23.0, 0.0, -1.0, -33.0, 13.0, -1.0, -8.0, -15.0, -12.0, 0.0, -4.0, 0.0, 1.0, -24.0, -8.0, 11.0, 0.0, -43.0, -5.0, -15.0, -12.0, -48.0, -37.0, -20.0, -6.0, 16.0, -11.0, 0.0, 0.0, 2.0, 1.0, -13.0, 9.0, 0.0, 12.0, 25.0, -23.0, -5.0, 0.0, 0.0, 0.0, 11.0, -1.0, 4.0, -10.0, -4.0, -8.0, 0.0, -6.0, -21.0, -39.0, -4.0, -1.0, -19.0, 0.0, -1.0, 0.0, -60.0, -16.0, 2.0, -10.0, 0.0, -1.0, -3.0, 25.0, -20.0, -20.0, -20.0, -7.0, -25.0, 4.0, 5.0, -10.0, -5.0, 0.0, -8.0, -20.0, -4.0, -14.0, -4.0, 3.0, -49.0, -9.0, -23.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-40.0, 0.0, 0.0, 0.0, -8.0, 0.0, 0.0, -40.0, 0.0, -38.0, 0.0, 0.0, -10.0, -65.0, -20.0, 0.0, 0.0, -44.0, 9.0, 0.0, -6.0, 17.0, -35.0, 5.0, -10.0, -1.0, -33.0, -82.0, 0.0, -4.0, 0.0, -12.0, -54.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, -114.0, 0.0, 13.0, -5.0, 0.0, 0.0, -18.0, -25.0, -4.0, 0.0, -25.0, 0.0, 0.0, -10.0, 0.0, 5.0, -16.0, 0.0, 0.0, -12.0, -52.0, -18.0, 0.0, 0.0, 8.0, 0.0, 0.0, -64.0, -26.0, 2.0, -14.0, 0.0, -39.0, -8.0, -16.0, -16.0, -64.0, -107.0, -8.0, -22.0, -20.0, -12.0, 0.0, 16.0, 0.0, -23.0, -8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, -34.0, 0.0, -6.0, 12.0, 0.0, 0.0, 27.0, -52.0, 0.0, 11.0, -8.0, -38.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, -13.0, 0.0, -4.0, 2.0, -2.0, -19.0, 0.0, -12.0, 0.0, -17.0, 0.0, 0.0, 0.0, -14.0, -30.0, -24.0, -27.0, -30.0, -8.0, 0.0, 0.0, -2.0, -4.0, -38.0, 0.0, 0.0, -2.0, -1.0, 0.0, 0.0, -41.0, -46.0, -25.0, -14.0, -12.0, 8.0, -30.0, 0.0, 0.0, 0.0, 0.0, -16.0, -8.0, 0.0, 7.0, 17.0, -11.0, -61.0, -22.0, -20.0, 0.0, -44.0, 0.0, -31.0, -32.0, -18.0, 0.0, 4.0, -3.0, 0.0, -45.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -16.0, -55.0, -16.0, -10.0, 1.0, -10.0, -18.0, -8.0, 0.0, 3.0, -2.0, -121.0, -64.0, 0.0, -18.0, 0.0, -48.0], "policy_predator_policy_reward": [5.0, 15.0, 0.0, 0.0, 0.0, 4.0, 17.0, 19.0, 20.0, 0.0, 0.0, 0.0, 5.0, 34.0, 9.0, 11.0, 22.0, 0.0, 0.0, 0.0, 0.0, 4.0, 9.0, 9.0, 5.0, 6.0, 30.0, 22.0, 1.0, 2.0, 0.0, 7.0, 0.0, 31.0, 0.0, 0.0, 2.0, 0.0, 43.0, 38.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 14.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 1.0, 0.0, 10.0, 30.0, 4.0, 6.0, 0.0, 3.0, 0.0, 0.0, 2.0, 45.0, 7.0, 0.0, 23.0, 1.0, 4.0, 8.0, 0.0, 32.0, 27.0, 51.0, 14.0, 8.0, 0.0, 6.0, 0.0, 0.0, 6.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 1.0, 0.0, 3.0, 0.0, 0.0, 37.0, 0.0, 0.0, 14.0, 4.0, 19.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 3.0, 4.0, 7.0, 5.0, 3.0, 0.0, 9.0, 0.0, 0.0, 7.0, 1.0, 22.0, 11.0, 0.0, 18.0, 0.0, 4.0, 0.0, 1.0, 2.0, 21.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 27.0, 7.0, 16.0, 0.0, 6.0, 0.0, 20.0, 0.0, 0.0, 2.0, 13.0, 1.0, 4.0, 1.0, 0.0, 16.0, 36.0, 10.0, 12.0, 0.0, 24.0, 5.0, 19.0, 9.0, 16.0, 0.0, 0.0, 0.0, 8.0, 16.0, 19.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 51.0, 5.0, 0.0, 9.0, 5.0, 3.0, 1.0, 2.0, 0.0, 58.0, 78.0, 0.0, 9.0, 3.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.369571644358459, "mean_inference_ms": 39.26908386046268, "mean_action_processing_ms": 0.8054038710097635, "mean_env_wait_ms": 2.7962620483651386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007653713226318359, "StateBufferConnector_ms": 0.007672786712646484, "ViewRequirementAgentConnector_ms": 0.16373467445373535}, "num_episodes": 22, "episode_return_max": 25.0, "episode_return_min": -63.0, "episode_return_mean": -8.26, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.82469002651203, "num_env_steps_trained_throughput_per_sec": 234.82469002651203, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1792000, "timers": {"training_iteration_time_ms": 276796.879, "restore_workers_time_ms": 0.025, "training_step_time_ms": 276796.797, "sample_time_ms": 157092.603, "learn_time_ms": 119666.037, "learn_throughput": 33.426, "synch_weights_time_ms": 31.859}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "done": false, "training_iteration": 112, "trial_id": "4f45b_00000", "date": "2024-08-13_03-55-10", "timestamp": 1723535710, "time_this_iter_s": 17.19359302520752, "time_total_s": 9439.076028347015, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c4e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9439.076028347015, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 80.27083333333333, "ram_util_percent": 79.97500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4931156500779763, "cur_kl_coeff": 0.0003128528594970704, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.44187691902357434, "policy_loss": -0.002027670708706691, "vf_loss": 0.4439020529271118, "vf_explained_var": 0.008860660482335974, "kl": 0.008109676701724819, "entropy": 0.5746161424609089, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9595401251284534, "cur_kl_coeff": 9.269714355468753e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6329086557333727, "policy_loss": -0.0022294089591091194, "vf_loss": 0.635137013008414, "vf_explained_var": 0.01505291916075207, "kl": 0.011346392733127118, "entropy": 0.8516138771539012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -60.0, "episode_reward_mean": -6.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -121.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": -10.3, "predator_policy": 6.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, -33.0, 13.0, -1.0, -8.0, -15.0, -12.0, 0.0, -4.0, 0.0, 1.0, -24.0, -8.0, 11.0, 0.0, -43.0, -5.0, -15.0, -12.0, -48.0, -37.0, -20.0, -6.0, 16.0, -11.0, 0.0, 0.0, 2.0, 1.0, -13.0, 9.0, 0.0, 12.0, 25.0, -23.0, -5.0, 0.0, 0.0, 0.0, 11.0, -1.0, 4.0, -10.0, -4.0, -8.0, 0.0, -6.0, -21.0, -39.0, -4.0, -1.0, -19.0, 0.0, -1.0, 0.0, -60.0, -16.0, 2.0, -10.0, 0.0, -1.0, -3.0, 25.0, -20.0, -20.0, -20.0, -7.0, -25.0, 4.0, 5.0, -10.0, -5.0, 0.0, -8.0, -20.0, -4.0, -14.0, -4.0, 3.0, -49.0, -9.0, -23.0, 0.0, 3.0, -6.0, -3.0, 15.0, -2.0, -1.0, 9.0, 0.0, 0.0, -50.0, 0.0, -12.0, -7.0, -4.0, 4.0, -5.0, 11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3.0, 0.0, 0.0, -114.0, 0.0, 13.0, -5.0, 0.0, 0.0, -18.0, -25.0, -4.0, 0.0, -25.0, 0.0, 0.0, -10.0, 0.0, 5.0, -16.0, 0.0, 0.0, -12.0, -52.0, -18.0, 0.0, 0.0, 8.0, 0.0, 0.0, -64.0, -26.0, 2.0, -14.0, 0.0, -39.0, -8.0, -16.0, -16.0, -64.0, -107.0, -8.0, -22.0, -20.0, -12.0, 0.0, 16.0, 0.0, -23.0, -8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, -34.0, 0.0, -6.0, 12.0, 0.0, 0.0, 27.0, -52.0, 0.0, 11.0, -8.0, -38.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, -13.0, 0.0, -4.0, 2.0, -2.0, -19.0, 0.0, -12.0, 0.0, -17.0, 0.0, 0.0, 0.0, -14.0, -30.0, -24.0, -27.0, -30.0, -8.0, 0.0, 0.0, -2.0, -4.0, -38.0, 0.0, 0.0, -2.0, -1.0, 0.0, 0.0, -41.0, -46.0, -25.0, -14.0, -12.0, 8.0, -30.0, 0.0, 0.0, 0.0, 0.0, -16.0, -8.0, 0.0, 7.0, 17.0, -11.0, -61.0, -22.0, -20.0, 0.0, -44.0, 0.0, -31.0, -32.0, -18.0, 0.0, 4.0, -3.0, 0.0, -45.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -16.0, -55.0, -16.0, -10.0, 1.0, -10.0, -18.0, -8.0, 0.0, 3.0, -2.0, -121.0, -64.0, 0.0, -18.0, 0.0, -48.0, 0.0, 0.0, 0.0, 3.0, -12.0, 0.0, -4.0, -12.0, 0.0, 15.0, -4.0, 0.0, 0.0, -2.0, 0.0, 3.0, 0.0, -5.0, 0.0, 0.0, -90.0, -10.0, 0.0, 0.0, -8.0, -17.0, 0.0, -14.0, 0.0, -8.0, 4.0, -6.0, 0.0, -33.0, 0.0, 9.0], "policy_predator_policy_reward": [2.0, 0.0, 43.0, 38.0, 0.0, 0.0, 0.0, 4.0, 0.0, 10.0, 14.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 6.0, 11.0, 0.0, 1.0, 0.0, 10.0, 30.0, 4.0, 6.0, 0.0, 3.0, 0.0, 0.0, 2.0, 45.0, 7.0, 0.0, 23.0, 1.0, 4.0, 8.0, 0.0, 32.0, 27.0, 51.0, 14.0, 8.0, 0.0, 6.0, 0.0, 0.0, 6.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 1.0, 0.0, 3.0, 0.0, 0.0, 37.0, 0.0, 0.0, 14.0, 4.0, 19.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 3.0, 4.0, 7.0, 5.0, 3.0, 0.0, 9.0, 0.0, 0.0, 7.0, 1.0, 22.0, 11.0, 0.0, 18.0, 0.0, 4.0, 0.0, 1.0, 2.0, 21.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 27.0, 7.0, 16.0, 0.0, 6.0, 0.0, 20.0, 0.0, 0.0, 2.0, 13.0, 1.0, 4.0, 1.0, 0.0, 16.0, 36.0, 10.0, 12.0, 0.0, 24.0, 5.0, 19.0, 9.0, 16.0, 0.0, 0.0, 0.0, 8.0, 16.0, 19.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 51.0, 5.0, 0.0, 9.0, 5.0, 3.0, 1.0, 2.0, 0.0, 58.0, 78.0, 0.0, 9.0, 3.0, 22.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 6.0, 1.0, 4.0, 0.0, 0.0, 45.0, 5.0, 0.0, 0.0, 9.0, 4.0, 7.0, 0.0, 0.0, 4.0, 3.0, 3.0, 15.0, 13.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.253153409436596, "mean_inference_ms": 38.97600729294172, "mean_action_processing_ms": 0.8025563907230783, "mean_env_wait_ms": 2.7767295156845826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007843375205993652, "StateBufferConnector_ms": 0.009113311767578125, "ViewRequirementAgentConnector_ms": 0.20151352882385254}, "num_episodes": 18, "episode_return_max": 25.0, "episode_return_min": -60.0, "episode_return_mean": -6.9, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.09583928079311, "num_env_steps_trained_throughput_per_sec": 242.09583928079311, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 1808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1808000, "timers": {"training_iteration_time_ms": 274852.442, "restore_workers_time_ms": 0.024, "training_step_time_ms": 274852.362, "sample_time_ms": 156729.75, "learn_time_ms": 118092.283, "learn_throughput": 33.872, "synch_weights_time_ms": 24.371}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "done": false, "training_iteration": 113, "trial_id": "4f45b_00000", "date": "2024-08-13_03-55-26", "timestamp": 1723535726, "time_this_iter_s": 16.61263608932495, "time_total_s": 9455.68866443634, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27a6ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9455.68866443634, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 80.18695652173913, "ram_util_percent": 80.07826086956524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2746432311714642, "cur_kl_coeff": 0.0003128528594970704, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4861687234706349, "policy_loss": -0.0013015308392741692, "vf_loss": 0.48746836178753744, "vf_explained_var": 0.018037189093847123, "kl": 0.006048916700195903, "entropy": 0.6162009812536694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6838969673902269, "cur_kl_coeff": 9.269714355468753e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.610123240486497, "policy_loss": -0.006419531153588896, "vf_loss": 0.6165401060252436, "vf_explained_var": 0.04929530554347568, "kl": 0.028767831772804574, "entropy": 0.743727285111392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -60.0, "episode_reward_mean": -6.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -121.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 27.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": -9.06, "predator_policy": 5.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.0, -11.0, 0.0, 0.0, 2.0, 1.0, -13.0, 9.0, 0.0, 12.0, 25.0, -23.0, -5.0, 0.0, 0.0, 0.0, 11.0, -1.0, 4.0, -10.0, -4.0, -8.0, 0.0, -6.0, -21.0, -39.0, -4.0, -1.0, -19.0, 0.0, -1.0, 0.0, -60.0, -16.0, 2.0, -10.0, 0.0, -1.0, -3.0, 25.0, -20.0, -20.0, -20.0, -7.0, -25.0, 4.0, 5.0, -10.0, -5.0, 0.0, -8.0, -20.0, -4.0, -14.0, -4.0, 3.0, -49.0, -9.0, -23.0, 0.0, 3.0, -6.0, -3.0, 15.0, -2.0, -1.0, 9.0, 0.0, 0.0, -50.0, 0.0, -12.0, -7.0, -4.0, 4.0, -5.0, 11.0, -5.0, 0.0, -24.0, 0.0, 0.0, -2.0, -14.0, -3.0, 0.0, 8.0, -8.0, -9.0, -6.0, -12.0, -39.0, 0.0, -3.0, 0.0, -11.0, -22.0, -13.0, -17.0, -13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [16.0, 0.0, -23.0, -8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, -34.0, 0.0, -6.0, 12.0, 0.0, 0.0, 27.0, -52.0, 0.0, 11.0, -8.0, -38.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, -13.0, 0.0, -4.0, 2.0, -2.0, -19.0, 0.0, -12.0, 0.0, -17.0, 0.0, 0.0, 0.0, -14.0, -30.0, -24.0, -27.0, -30.0, -8.0, 0.0, 0.0, -2.0, -4.0, -38.0, 0.0, 0.0, -2.0, -1.0, 0.0, 0.0, -41.0, -46.0, -25.0, -14.0, -12.0, 8.0, -30.0, 0.0, 0.0, 0.0, 0.0, -16.0, -8.0, 0.0, 7.0, 17.0, -11.0, -61.0, -22.0, -20.0, 0.0, -44.0, 0.0, -31.0, -32.0, -18.0, 0.0, 4.0, -3.0, 0.0, -45.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -16.0, -55.0, -16.0, -10.0, 1.0, -10.0, -18.0, -8.0, 0.0, 3.0, -2.0, -121.0, -64.0, 0.0, -18.0, 0.0, -48.0, 0.0, 0.0, 0.0, 3.0, -12.0, 0.0, -4.0, -12.0, 0.0, 15.0, -4.0, 0.0, 0.0, -2.0, 0.0, 3.0, 0.0, -5.0, 0.0, 0.0, -90.0, -10.0, 0.0, 0.0, -8.0, -17.0, 0.0, -14.0, 0.0, -8.0, 4.0, -6.0, 0.0, -33.0, 0.0, 9.0, 0.0, -10.0, 0.0, 0.0, -4.0, -44.0, 0.0, 0.0, 0.0, 0.0, -42.0, 10.0, -33.0, 0.0, -6.0, 0.0, -2.0, 0.0, -4.0, 10.0, -16.0, 0.0, -2.0, -14.0, 5.0, -22.0, -2.0, -22.0, -68.0, -10.0, 0.0, 0.0, -4.0, -2.0, 0.0, 0.0, -24.0, 0.0, -44.0, 0.0, -21.0, -11.0, -34.0, 0.0, -20.0, -6.0], "policy_predator_policy_reward": [0.0, 0.0, 6.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 1.0, 0.0, 3.0, 0.0, 0.0, 37.0, 0.0, 0.0, 14.0, 4.0, 19.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 3.0, 4.0, 7.0, 5.0, 3.0, 0.0, 9.0, 0.0, 0.0, 7.0, 1.0, 22.0, 11.0, 0.0, 18.0, 0.0, 4.0, 0.0, 1.0, 2.0, 21.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 27.0, 7.0, 16.0, 0.0, 6.0, 0.0, 20.0, 0.0, 0.0, 2.0, 13.0, 1.0, 4.0, 1.0, 0.0, 16.0, 36.0, 10.0, 12.0, 0.0, 24.0, 5.0, 19.0, 9.0, 16.0, 0.0, 0.0, 0.0, 8.0, 16.0, 19.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 51.0, 5.0, 0.0, 9.0, 5.0, 3.0, 1.0, 2.0, 0.0, 58.0, 78.0, 0.0, 9.0, 3.0, 22.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 6.0, 1.0, 4.0, 0.0, 0.0, 45.0, 5.0, 0.0, 0.0, 9.0, 4.0, 7.0, 0.0, 0.0, 4.0, 3.0, 3.0, 15.0, 13.0, 2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 0.0, 6.0, 24.0, 11.0, 8.0, 3.0, 0.0, 1.0, 1.0, 0.0, 2.0, 7.0, 1.0, 0.0, 7.0, 11.0, 0.0, 10.0, 2.0, 8.0, 31.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 7.0, 6.0, 0.0, 22.0, 19.0, 0.0, 17.0, 0.0, 13.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.8984300387593, "mean_inference_ms": 38.697968454268725, "mean_action_processing_ms": 0.8035807418824926, "mean_env_wait_ms": 2.949661894249076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10308825969696045, "StateBufferConnector_ms": 0.011884212493896484, "ViewRequirementAgentConnector_ms": 0.7131983041763306}, "num_episodes": 23, "episode_return_max": 25.0, "episode_return_min": -60.0, "episode_return_mean": -6.16, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 85.83018870550035, "num_env_steps_trained_throughput_per_sec": 85.83018870550035, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 275944.105, "restore_workers_time_ms": 2.018, "training_step_time_ms": 275941.737, "sample_time_ms": 158039.135, "learn_time_ms": 117871.997, "learn_throughput": 33.935, "synch_weights_time_ms": 23.125}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 114, "trial_id": "4f45b_00000", "date": "2024-08-13_04-11-14", "timestamp": 1723536674, "time_this_iter_s": 47.05801510810852, "time_total_s": 9502.746679544449, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2482f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9502.746679544449, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 87.07794117647059, "ram_util_percent": 84.47794117647061}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2349550606002884, "cur_kl_coeff": 0.0003128528594970704, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2636437737023231, "policy_loss": -0.0027676255647930757, "vf_loss": 0.26640927793788255, "vf_explained_var": 0.0302031434402264, "kl": 0.006780704806180377, "entropy": 0.6150647035351506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8163030934909348, "cur_kl_coeff": 0.00013904571533203118, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5344875275669866, "policy_loss": -0.005437613932893823, "vf_loss": 0.5399245701518363, "vf_explained_var": 0.03851465749992895, "kl": 0.004109790671371099, "entropy": 0.7078234146827113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 32.0, "episode_reward_min": -60.0, "episode_reward_mean": -6.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -121.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 28.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": -9.31, "predator_policy": 5.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, -10.0, -4.0, -8.0, 0.0, -6.0, -21.0, -39.0, -4.0, -1.0, -19.0, 0.0, -1.0, 0.0, -60.0, -16.0, 2.0, -10.0, 0.0, -1.0, -3.0, 25.0, -20.0, -20.0, -20.0, -7.0, -25.0, 4.0, 5.0, -10.0, -5.0, 0.0, -8.0, -20.0, -4.0, -14.0, -4.0, 3.0, -49.0, -9.0, -23.0, 0.0, 3.0, -6.0, -3.0, 15.0, -2.0, -1.0, 9.0, 0.0, 0.0, -50.0, 0.0, -12.0, -7.0, -4.0, 4.0, -5.0, 11.0, -5.0, 0.0, -24.0, 0.0, 0.0, -2.0, -14.0, -3.0, 0.0, 8.0, -8.0, -9.0, -6.0, -12.0, -39.0, 0.0, -3.0, 0.0, -11.0, -22.0, -13.0, -17.0, -13.0, 0.0, 4.0, 0.0, -4.0, -45.0, 7.0, 0.0, -2.0, 0.0, 32.0, 0.0, 6.0, 0.0, -16.0, -9.0, -1.0, -1.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, 2.0, -2.0, -19.0, 0.0, -12.0, 0.0, -17.0, 0.0, 0.0, 0.0, -14.0, -30.0, -24.0, -27.0, -30.0, -8.0, 0.0, 0.0, -2.0, -4.0, -38.0, 0.0, 0.0, -2.0, -1.0, 0.0, 0.0, -41.0, -46.0, -25.0, -14.0, -12.0, 8.0, -30.0, 0.0, 0.0, 0.0, 0.0, -16.0, -8.0, 0.0, 7.0, 17.0, -11.0, -61.0, -22.0, -20.0, 0.0, -44.0, 0.0, -31.0, -32.0, -18.0, 0.0, 4.0, -3.0, 0.0, -45.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -16.0, -55.0, -16.0, -10.0, 1.0, -10.0, -18.0, -8.0, 0.0, 3.0, -2.0, -121.0, -64.0, 0.0, -18.0, 0.0, -48.0, 0.0, 0.0, 0.0, 3.0, -12.0, 0.0, -4.0, -12.0, 0.0, 15.0, -4.0, 0.0, 0.0, -2.0, 0.0, 3.0, 0.0, -5.0, 0.0, 0.0, -90.0, -10.0, 0.0, 0.0, -8.0, -17.0, 0.0, -14.0, 0.0, -8.0, 4.0, -6.0, 0.0, -33.0, 0.0, 9.0, 0.0, -10.0, 0.0, 0.0, -4.0, -44.0, 0.0, 0.0, 0.0, 0.0, -42.0, 10.0, -33.0, 0.0, -6.0, 0.0, -2.0, 0.0, -4.0, 10.0, -16.0, 0.0, -2.0, -14.0, 5.0, -22.0, -2.0, -22.0, -68.0, -10.0, 0.0, 0.0, -4.0, -2.0, 0.0, 0.0, -24.0, 0.0, -44.0, 0.0, -21.0, -11.0, -34.0, 0.0, -20.0, -6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, -4.0, -4.0, 0.0, -94.0, 0.0, 7.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, 28.0, -13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, -34.0, -16.0, -2.0, 0.0, -2.0, -16.0, 3.0, -10.0, -4.0], "policy_predator_policy_reward": [3.0, 3.0, 4.0, 7.0, 5.0, 3.0, 0.0, 9.0, 0.0, 0.0, 7.0, 1.0, 22.0, 11.0, 0.0, 18.0, 0.0, 4.0, 0.0, 1.0, 2.0, 21.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 27.0, 7.0, 16.0, 0.0, 6.0, 0.0, 20.0, 0.0, 0.0, 2.0, 13.0, 1.0, 4.0, 1.0, 0.0, 16.0, 36.0, 10.0, 12.0, 0.0, 24.0, 5.0, 19.0, 9.0, 16.0, 0.0, 0.0, 0.0, 8.0, 16.0, 19.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 51.0, 5.0, 0.0, 9.0, 5.0, 3.0, 1.0, 2.0, 0.0, 58.0, 78.0, 0.0, 9.0, 3.0, 22.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 6.0, 1.0, 4.0, 0.0, 0.0, 45.0, 5.0, 0.0, 0.0, 9.0, 4.0, 7.0, 0.0, 0.0, 4.0, 3.0, 3.0, 15.0, 13.0, 2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 0.0, 6.0, 24.0, 11.0, 8.0, 3.0, 0.0, 1.0, 1.0, 0.0, 2.0, 7.0, 1.0, 0.0, 7.0, 11.0, 0.0, 10.0, 2.0, 8.0, 31.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 7.0, 6.0, 0.0, 22.0, 19.0, 0.0, 17.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 28.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 17.0, 0.0, 9.0, 0.0, 1.0, 8.0, 4.0, 0.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.033192507716867, "mean_inference_ms": 38.40812013703053, "mean_action_processing_ms": 0.8041217830229033, "mean_env_wait_ms": 2.740856670795623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.10263621807098389, "StateBufferConnector_ms": 0.011835098266601562, "ViewRequirementAgentConnector_ms": 0.7320771217346191}, "num_episodes": 18, "episode_return_max": 32.0, "episode_return_min": -60.0, "episode_return_mean": -6.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.350622387728747, "num_env_steps_trained_throughput_per_sec": 4.350622387728747, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 307888.085, "restore_workers_time_ms": 2.017, "training_step_time_ms": 307885.661, "sample_time_ms": 100329.515, "learn_time_ms": 207522.176, "learn_throughput": 19.275, "synch_weights_time_ms": 27.044}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 115, "trial_id": "4f45b_00000", "date": "2024-08-13_04-26-50", "timestamp": 1723537610, "time_this_iter_s": 936.6274418830872, "time_total_s": 10439.374121427536, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27a63a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10439.374121427536, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 88.04423076923078, "ram_util_percent": 85.15192307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9432627336255142, "cur_kl_coeff": 0.0003128528594970704, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20436192628848687, "policy_loss": -0.0017947533888564933, "vf_loss": 0.2061538562056653, "vf_explained_var": 0.0081709225657125, "kl": 0.009023561463015093, "entropy": 0.575696471491188, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.350090469147951, "cur_kl_coeff": 6.952285766601559e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3341996314913481, "policy_loss": -0.004748002218301827, "vf_loss": 0.33894648994676396, "vf_explained_var": 0.03914735616830291, "kl": 0.01643167409393218, "entropy": 0.7423170216184445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "env_runners": {"episode_reward_max": 34.0, "episode_reward_min": -64.0, "episode_reward_mean": -5.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -121.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 39.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": -8.455, "predator_policy": 5.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, -20.0, -20.0, -7.0, -25.0, 4.0, 5.0, -10.0, -5.0, 0.0, -8.0, -20.0, -4.0, -14.0, -4.0, 3.0, -49.0, -9.0, -23.0, 0.0, 3.0, -6.0, -3.0, 15.0, -2.0, -1.0, 9.0, 0.0, 0.0, -50.0, 0.0, -12.0, -7.0, -4.0, 4.0, -5.0, 11.0, -5.0, 0.0, -24.0, 0.0, 0.0, -2.0, -14.0, -3.0, 0.0, 8.0, -8.0, -9.0, -6.0, -12.0, -39.0, 0.0, -3.0, 0.0, -11.0, -22.0, -13.0, -17.0, -13.0, 0.0, 4.0, 0.0, -4.0, -45.0, 7.0, 0.0, -2.0, 0.0, 32.0, 0.0, 6.0, 0.0, -16.0, -9.0, -1.0, -1.0, -9.0, -18.0, 0.0, 7.0, -1.0, 0.0, 3.0, 0.0, -5.0, 0.0, -2.0, -5.0, 0.0, -25.0, -7.0, -64.0, -3.0, -6.0, 34.0, -2.0, 0.0, 24.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-11.0, -61.0, -22.0, -20.0, 0.0, -44.0, 0.0, -31.0, -32.0, -18.0, 0.0, 4.0, -3.0, 0.0, -45.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, -16.0, -55.0, -16.0, -10.0, 1.0, -10.0, -18.0, -8.0, 0.0, 3.0, -2.0, -121.0, -64.0, 0.0, -18.0, 0.0, -48.0, 0.0, 0.0, 0.0, 3.0, -12.0, 0.0, -4.0, -12.0, 0.0, 15.0, -4.0, 0.0, 0.0, -2.0, 0.0, 3.0, 0.0, -5.0, 0.0, 0.0, -90.0, -10.0, 0.0, 0.0, -8.0, -17.0, 0.0, -14.0, 0.0, -8.0, 4.0, -6.0, 0.0, -33.0, 0.0, 9.0, 0.0, -10.0, 0.0, 0.0, -4.0, -44.0, 0.0, 0.0, 0.0, 0.0, -42.0, 10.0, -33.0, 0.0, -6.0, 0.0, -2.0, 0.0, -4.0, 10.0, -16.0, 0.0, -2.0, -14.0, 5.0, -22.0, -2.0, -22.0, -68.0, -10.0, 0.0, 0.0, -4.0, -2.0, 0.0, 0.0, -24.0, 0.0, -44.0, 0.0, -21.0, -11.0, -34.0, 0.0, -20.0, -6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, -4.0, -4.0, 0.0, -94.0, 0.0, 7.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, 28.0, -13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, -34.0, -16.0, -2.0, 0.0, -2.0, -16.0, 3.0, -10.0, -4.0, -32.0, -4.0, 0.0, 0.0, 18.0, -24.0, 0.0, -2.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, -12.0, 4.0, 0.0, -10.0, 0.0, 0.0, -32.0, -18.0, -34.0, -6.0, -50.0, -42.0, 0.0, -6.0, -12.0, 0.0, -10.0, 39.0, 0.0, -5.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0], "policy_predator_policy_reward": [16.0, 36.0, 10.0, 12.0, 0.0, 24.0, 5.0, 19.0, 9.0, 16.0, 0.0, 0.0, 0.0, 8.0, 16.0, 19.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 0.0, 51.0, 5.0, 0.0, 9.0, 5.0, 3.0, 1.0, 2.0, 0.0, 58.0, 78.0, 0.0, 9.0, 3.0, 22.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 6.0, 1.0, 4.0, 0.0, 0.0, 45.0, 5.0, 0.0, 0.0, 9.0, 4.0, 7.0, 0.0, 0.0, 4.0, 3.0, 3.0, 15.0, 13.0, 2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 0.0, 6.0, 24.0, 11.0, 8.0, 3.0, 0.0, 1.0, 1.0, 0.0, 2.0, 7.0, 1.0, 0.0, 7.0, 11.0, 0.0, 10.0, 2.0, 8.0, 31.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 7.0, 6.0, 0.0, 22.0, 19.0, 0.0, 17.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 28.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 17.0, 0.0, 9.0, 0.0, 1.0, 8.0, 4.0, 0.0, 5.0, 15.0, 3.0, 0.0, 0.0, 12.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 0.0, 9.0, 16.0, 19.0, 14.0, 25.0, 3.0, 0.0, 3.0, 6.0, 0.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.338828883014125, "mean_inference_ms": 37.7077505296011, "mean_action_processing_ms": 0.806389212822757, "mean_env_wait_ms": 2.728483124823463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.11098372936248779, "StateBufferConnector_ms": 0.016329646110534668, "ViewRequirementAgentConnector_ms": 0.9422659873962402}, "num_episodes": 22, "episode_return_max": 34.0, "episode_return_min": -64.0, "episode_return_mean": -5.75, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 139.86262843987444, "num_env_steps_trained_throughput_per_sec": 139.86262843987444, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1856000, "timers": {"training_iteration_time_ms": 309027.295, "restore_workers_time_ms": 2.295, "training_step_time_ms": 309024.586, "sample_time_ms": 101182.492, "learn_time_ms": 207803.711, "learn_throughput": 19.249, "synch_weights_time_ms": 30.784}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "done": false, "training_iteration": 116, "trial_id": "4f45b_00000", "date": "2024-08-13_04-27-20", "timestamp": 1723537640, "time_this_iter_s": 28.846040964126587, "time_total_s": 10468.220162391663, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27a6670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 10468.220162391663, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 88.095, "ram_util_percent": 83.7875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.196135588250463, "cur_kl_coeff": 0.0003128528594970704, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.38926320266786707, "policy_loss": -0.0014114617275212099, "vf_loss": 0.3906726175369744, "vf_explained_var": 0.01238847914196196, "kl": 0.006539936326759612, "entropy": 0.5980310456778006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4588385275116673, "cur_kl_coeff": 6.952285766601559e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5450605410711702, "policy_loss": -0.005968387001662185, "vf_loss": 0.5510275036293678, "vf_explained_var": 0.004927347734491661, "kl": 0.020465071434649047, "entropy": 0.6716214622454668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": 66.0, "episode_reward_min": -64.0, "episode_reward_mean": -3.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -94.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 63.0, "predator_policy": 45.0}, "policy_reward_mean": {"prey_policy": -5.535, "predator_policy": 4.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-23.0, 0.0, 3.0, -6.0, -3.0, 15.0, -2.0, -1.0, 9.0, 0.0, 0.0, -50.0, 0.0, -12.0, -7.0, -4.0, 4.0, -5.0, 11.0, -5.0, 0.0, -24.0, 0.0, 0.0, -2.0, -14.0, -3.0, 0.0, 8.0, -8.0, -9.0, -6.0, -12.0, -39.0, 0.0, -3.0, 0.0, -11.0, -22.0, -13.0, -17.0, -13.0, 0.0, 4.0, 0.0, -4.0, -45.0, 7.0, 0.0, -2.0, 0.0, 32.0, 0.0, 6.0, 0.0, -16.0, -9.0, -1.0, -1.0, -9.0, -18.0, 0.0, 7.0, -1.0, 0.0, 3.0, 0.0, -5.0, 0.0, -2.0, -5.0, 0.0, -25.0, -7.0, -64.0, -3.0, -6.0, 34.0, -2.0, 0.0, 24.0, 0.0, -6.0, -1.0, 66.0, -3.0, 22.0, 25.0, 0.0, -6.0, -6.0, 0.0, 0.0, -6.0, 4.0, 2.0, -6.0, 0.0, -10.0, -10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -48.0, 0.0, 0.0, 0.0, 3.0, -12.0, 0.0, -4.0, -12.0, 0.0, 15.0, -4.0, 0.0, 0.0, -2.0, 0.0, 3.0, 0.0, -5.0, 0.0, 0.0, -90.0, -10.0, 0.0, 0.0, -8.0, -17.0, 0.0, -14.0, 0.0, -8.0, 4.0, -6.0, 0.0, -33.0, 0.0, 9.0, 0.0, -10.0, 0.0, 0.0, -4.0, -44.0, 0.0, 0.0, 0.0, 0.0, -42.0, 10.0, -33.0, 0.0, -6.0, 0.0, -2.0, 0.0, -4.0, 10.0, -16.0, 0.0, -2.0, -14.0, 5.0, -22.0, -2.0, -22.0, -68.0, -10.0, 0.0, 0.0, -4.0, -2.0, 0.0, 0.0, -24.0, 0.0, -44.0, 0.0, -21.0, -11.0, -34.0, 0.0, -20.0, -6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, -4.0, -4.0, 0.0, -94.0, 0.0, 7.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, 28.0, -13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, -34.0, -16.0, -2.0, 0.0, -2.0, -16.0, 3.0, -10.0, -4.0, -32.0, -4.0, 0.0, 0.0, 18.0, -24.0, 0.0, -2.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, -12.0, 4.0, 0.0, -10.0, 0.0, 0.0, -32.0, -18.0, -34.0, -6.0, -50.0, -42.0, 0.0, -6.0, -12.0, 0.0, -10.0, 39.0, 0.0, -5.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, -4.0, -12.0, -2.0, 0.0, 0.0, 63.0, 0.0, -6.0, 0.0, 22.0, 25.0, 0.0, 0.0, 0.0, -10.0, -12.0, -8.0, -10.0, 0.0, 0.0, 0.0, 0.0, -25.0, 0.0, -8.0, 5.0, -12.0, 5.0, 0.0, -12.0, 0.0, 0.0, 0.0, -20.0, 0.0, -22.0], "policy_predator_policy_reward": [3.0, 22.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 6.0, 1.0, 4.0, 0.0, 0.0, 45.0, 5.0, 0.0, 0.0, 9.0, 4.0, 7.0, 0.0, 0.0, 4.0, 3.0, 3.0, 15.0, 13.0, 2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 0.0, 6.0, 24.0, 11.0, 8.0, 3.0, 0.0, 1.0, 1.0, 0.0, 2.0, 7.0, 1.0, 0.0, 7.0, 11.0, 0.0, 10.0, 2.0, 8.0, 31.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 7.0, 6.0, 0.0, 22.0, 19.0, 0.0, 17.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 28.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 17.0, 0.0, 9.0, 0.0, 1.0, 8.0, 4.0, 0.0, 5.0, 15.0, 3.0, 0.0, 0.0, 12.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 0.0, 9.0, 16.0, 19.0, 14.0, 25.0, 3.0, 0.0, 3.0, 6.0, 0.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 4.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 4.0, 3.0, 3.0, 6.0, 6.0, 0.0, 0.0, 0.0, 2.0, 8.0, 7.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.834892824312682, "mean_inference_ms": 37.916591728318245, "mean_action_processing_ms": 0.8116490014846933, "mean_env_wait_ms": 2.7176828896278598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12443387508392334, "StateBufferConnector_ms": 0.02097165584564209, "ViewRequirementAgentConnector_ms": 1.004443883895874}, "num_episodes": 18, "episode_return_max": 66.0, "episode_return_min": -64.0, "episode_return_mean": -3.07, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.140298005603705, "num_env_steps_trained_throughput_per_sec": 4.140298005603705, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 307087.83, "restore_workers_time_ms": 2.293, "training_step_time_ms": 307085.12, "sample_time_ms": 5450.277, "learn_time_ms": 301595.286, "learn_throughput": 13.263, "synch_weights_time_ms": 31.944}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 117, "trial_id": "4f45b_00000", "date": "2024-08-13_04-43-26", "timestamp": 1723538606, "time_this_iter_s": 966.2955181598663, "time_total_s": 11434.515680551529, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24885e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11434.515680551529, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 90.1125, "ram_util_percent": 83.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4072368605939485, "cur_kl_coeff": 0.0003128528594970704, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4118485817123973, "policy_loss": -0.00025185068512443827, "vf_loss": 0.41209914127054315, "vf_explained_var": 0.020158799741633985, "kl": 0.0041200068055235696, "entropy": 0.6200754312611131, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6614474544370617, "cur_kl_coeff": 0.0001042842864990234, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6891093406560166, "policy_loss": -0.0035690771756452266, "vf_loss": 0.692677516139004, "vf_explained_var": 0.054737491897805024, "kl": 0.008649138024614174, "entropy": 0.7309045811494191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "env_runners": {"episode_reward_max": 67.0, "episode_reward_min": -64.0, "episode_reward_mean": -2.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -94.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 67.0, "predator_policy": 38.0}, "policy_reward_mean": {"prey_policy": -5.23, "predator_policy": 4.215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, -5.0, 0.0, -24.0, 0.0, 0.0, -2.0, -14.0, -3.0, 0.0, 8.0, -8.0, -9.0, -6.0, -12.0, -39.0, 0.0, -3.0, 0.0, -11.0, -22.0, -13.0, -17.0, -13.0, 0.0, 4.0, 0.0, -4.0, -45.0, 7.0, 0.0, -2.0, 0.0, 32.0, 0.0, 6.0, 0.0, -16.0, -9.0, -1.0, -1.0, -9.0, -18.0, 0.0, 7.0, -1.0, 0.0, 3.0, 0.0, -5.0, 0.0, -2.0, -5.0, 0.0, -25.0, -7.0, -64.0, -3.0, -6.0, 34.0, -2.0, 0.0, 24.0, 0.0, -6.0, -1.0, 66.0, -3.0, 22.0, 25.0, 0.0, -6.0, -6.0, 0.0, 0.0, -6.0, 4.0, 2.0, -6.0, 0.0, -10.0, -10.0, 0.0, 0.0, -4.0, -1.0, -7.0, 67.0, -28.0, 6.0, -18.0, 5.0, 0.0, -18.0, -5.0, 1.0, -4.0, 37.0, 0.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 9.0, 0.0, -10.0, 0.0, 0.0, -4.0, -44.0, 0.0, 0.0, 0.0, 0.0, -42.0, 10.0, -33.0, 0.0, -6.0, 0.0, -2.0, 0.0, -4.0, 10.0, -16.0, 0.0, -2.0, -14.0, 5.0, -22.0, -2.0, -22.0, -68.0, -10.0, 0.0, 0.0, -4.0, -2.0, 0.0, 0.0, -24.0, 0.0, -44.0, 0.0, -21.0, -11.0, -34.0, 0.0, -20.0, -6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, -4.0, -4.0, 0.0, -94.0, 0.0, 7.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, 28.0, -13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, -34.0, -16.0, -2.0, 0.0, -2.0, -16.0, 3.0, -10.0, -4.0, -32.0, -4.0, 0.0, 0.0, 18.0, -24.0, 0.0, -2.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, -12.0, 4.0, 0.0, -10.0, 0.0, 0.0, -32.0, -18.0, -34.0, -6.0, -50.0, -42.0, 0.0, -6.0, -12.0, 0.0, -10.0, 39.0, 0.0, -5.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, -4.0, -12.0, -2.0, 0.0, 0.0, 63.0, 0.0, -6.0, 0.0, 22.0, 25.0, 0.0, 0.0, 0.0, -10.0, -12.0, -8.0, -10.0, 0.0, 0.0, 0.0, 0.0, -25.0, 0.0, -8.0, 5.0, -12.0, 5.0, 0.0, -12.0, 0.0, 0.0, 0.0, -20.0, 0.0, -22.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -2.0, 0.0, -14.0, 0.0, 67.0, -64.0, 0.0, 0.0, 6.0, -24.0, -12.0, -22.0, 16.0, 0.0, 0.0, -48.0, 0.0, 0.0, -18.0, -14.0, -14.0, 0.0, -9.0, -16.0, 13.0, 0.0, 0.0, 0.0, -21.0], "policy_predator_policy_reward": [2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 2.0, 22.0, 0.0, 0.0, 0.0, 0.0, 6.0, 24.0, 11.0, 8.0, 3.0, 0.0, 1.0, 1.0, 0.0, 2.0, 7.0, 1.0, 0.0, 7.0, 11.0, 0.0, 10.0, 2.0, 8.0, 31.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 7.0, 6.0, 0.0, 22.0, 19.0, 0.0, 17.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 28.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 17.0, 0.0, 9.0, 0.0, 1.0, 8.0, 4.0, 0.0, 5.0, 15.0, 3.0, 0.0, 0.0, 12.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 0.0, 9.0, 16.0, 19.0, 14.0, 25.0, 3.0, 0.0, 3.0, 6.0, 0.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 4.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 4.0, 3.0, 3.0, 6.0, 6.0, 0.0, 0.0, 0.0, 2.0, 8.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 2.0, 34.0, 0.0, 0.0, 12.0, 6.0, 0.0, 11.0, 0.0, 0.0, 0.0, 30.0, 5.0, 8.0, 11.0, 18.0, 0.0, 5.0, 2.0, 38.0, 0.0, 0.0, 12.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.750281978186717, "mean_inference_ms": 37.70486871496302, "mean_action_processing_ms": 0.8161265667157099, "mean_env_wait_ms": 2.706867236603823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12910854816436768, "StateBufferConnector_ms": 0.034140706062316895, "ViewRequirementAgentConnector_ms": 1.0979856252670288}, "num_episodes": 18, "episode_return_max": 67.0, "episode_return_min": -64.0, "episode_return_mean": -2.03, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 171.7964576614274, "num_env_steps_trained_throughput_per_sec": 171.7964576614274, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1888000, "timers": {"training_iteration_time_ms": 307772.246, "restore_workers_time_ms": 2.292, "training_step_time_ms": 307769.547, "sample_time_ms": 5831.077, "learn_time_ms": 301897.311, "learn_throughput": 13.25, "synch_weights_time_ms": 33.628}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "done": false, "training_iteration": 118, "trial_id": "4f45b_00000", "date": "2024-08-13_04-43-50", "timestamp": 1723538630, "time_this_iter_s": 23.40447998046875, "time_total_s": 11457.920160531998, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24bfee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11457.920160531998, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 91.33333333333333, "ram_util_percent": 83.78484848484848}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5034919551282964, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6881129254897436, "policy_loss": -0.001933091914616328, "vf_loss": 0.6900451048548338, "vf_explained_var": 0.0035518927233559746, "kl": 0.005822193124472166, "entropy": 0.6286945110906369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3267393366842675, "cur_kl_coeff": 0.0001042842864990234, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6193438779090275, "policy_loss": -0.004943400598007929, "vf_loss": 0.6242860437020975, "vf_explained_var": -0.056340135216082214, "kl": 0.01183683207897793, "entropy": 0.84174140253395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "env_runners": {"episode_reward_max": 67.0, "episode_reward_min": -64.0, "episode_reward_mean": -1.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -94.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 67.0, "predator_policy": 50.0}, "policy_reward_mean": {"prey_policy": -5.42, "predator_policy": 4.645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-13.0, 0.0, 4.0, 0.0, -4.0, -45.0, 7.0, 0.0, -2.0, 0.0, 32.0, 0.0, 6.0, 0.0, -16.0, -9.0, -1.0, -1.0, -9.0, -18.0, 0.0, 7.0, -1.0, 0.0, 3.0, 0.0, -5.0, 0.0, -2.0, -5.0, 0.0, -25.0, -7.0, -64.0, -3.0, -6.0, 34.0, -2.0, 0.0, 24.0, 0.0, -6.0, -1.0, 66.0, -3.0, 22.0, 25.0, 0.0, -6.0, -6.0, 0.0, 0.0, -6.0, 4.0, 2.0, -6.0, 0.0, -10.0, -10.0, 0.0, 0.0, -4.0, -1.0, -7.0, 67.0, -28.0, 6.0, -18.0, 5.0, 0.0, -18.0, -5.0, 1.0, -4.0, 37.0, 0.0, -9.0, -33.0, -18.0, -8.0, 3.0, 2.0, 0.0, 11.0, -15.0, 5.0, -12.0, -1.0, 0.0, 0.0, 0.0, -8.0, -8.0, -12.0, 3.0, -18.0, -12.0, 0.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-20.0, -6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, -4.0, -4.0, 0.0, -94.0, 0.0, 7.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, 28.0, -13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, -34.0, -16.0, -2.0, 0.0, -2.0, -16.0, 3.0, -10.0, -4.0, -32.0, -4.0, 0.0, 0.0, 18.0, -24.0, 0.0, -2.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, -12.0, 4.0, 0.0, -10.0, 0.0, 0.0, -32.0, -18.0, -34.0, -6.0, -50.0, -42.0, 0.0, -6.0, -12.0, 0.0, -10.0, 39.0, 0.0, -5.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, -4.0, -12.0, -2.0, 0.0, 0.0, 63.0, 0.0, -6.0, 0.0, 22.0, 25.0, 0.0, 0.0, 0.0, -10.0, -12.0, -8.0, -10.0, 0.0, 0.0, 0.0, 0.0, -25.0, 0.0, -8.0, 5.0, -12.0, 5.0, 0.0, -12.0, 0.0, 0.0, 0.0, -20.0, 0.0, -22.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -2.0, 0.0, -14.0, 0.0, 67.0, -64.0, 0.0, 0.0, 6.0, -24.0, -12.0, -22.0, 16.0, 0.0, 0.0, -48.0, 0.0, 0.0, -18.0, -14.0, -14.0, 0.0, -9.0, -16.0, 13.0, 0.0, 0.0, 0.0, -21.0, -22.0, -33.0, -91.0, -21.0, 0.0, -16.0, -13.0, -21.0, -23.0, 0.0, 0.0, 0.0, 11.0, 0.0, -4.0, -26.0, 5.0, 0.0, 1.0, -26.0, 1.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -4.0, 2.0, -32.0, -52.0, 0.0, 0.0, 3.0, -44.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 28.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 17.0, 0.0, 9.0, 0.0, 1.0, 8.0, 4.0, 0.0, 5.0, 15.0, 3.0, 0.0, 0.0, 12.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 0.0, 9.0, 16.0, 19.0, 14.0, 25.0, 3.0, 0.0, 3.0, 6.0, 0.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 4.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 4.0, 3.0, 3.0, 6.0, 6.0, 0.0, 0.0, 0.0, 2.0, 8.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 2.0, 34.0, 0.0, 0.0, 12.0, 6.0, 0.0, 11.0, 0.0, 0.0, 0.0, 30.0, 5.0, 8.0, 11.0, 18.0, 0.0, 5.0, 2.0, 38.0, 0.0, 0.0, 12.0, 0.0, 18.0, 4.0, 50.0, 44.0, 0.0, 8.0, 17.0, 20.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 2.0, 13.0, 0.0, 0.0, 12.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 15.0, 7.0, 16.0, 24.0, 0.0, 0.0, 22.0, 4.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.633986667875208, "mean_inference_ms": 37.408865220230986, "mean_action_processing_ms": 0.8182894767629963, "mean_env_wait_ms": 2.685189397570431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03615462779998779, "StateBufferConnector_ms": 0.03196609020233154, "ViewRequirementAgentConnector_ms": 0.6305098533630371}, "num_episodes": 23, "episode_return_max": 67.0, "episode_return_min": -64.0, "episode_return_mean": -1.55, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 230.53354630765986, "num_env_steps_trained_throughput_per_sec": 230.53354630765986, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 1904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1904000, "timers": {"training_iteration_time_ms": 207173.244, "restore_workers_time_ms": 2.292, "training_step_time_ms": 207170.547, "sample_time_ms": 5946.143, "learn_time_ms": 201181.631, "learn_throughput": 19.883, "synch_weights_time_ms": 34.422}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "done": false, "training_iteration": 119, "trial_id": "4f45b_00000", "date": "2024-08-13_04-44-08", "timestamp": 1723538648, "time_this_iter_s": 17.47679591178894, "time_total_s": 11475.396956443787, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c4e940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11475.396956443787, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 79.696, "ram_util_percent": 83.524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3264464595054508, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6844270053442824, "policy_loss": -0.003721395242594616, "vf_loss": 0.6881468540855816, "vf_explained_var": 0.015260094561904827, "kl": 0.009892934683794574, "entropy": 0.6654041831455534, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6067756928542933, "cur_kl_coeff": 0.0001042842864990234, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7861734823496254, "policy_loss": -0.0034037263365462424, "vf_loss": 0.7895762173626474, "vf_explained_var": 0.02268253482838787, "kl": 0.009514137224751905, "entropy": 0.8263641913416524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 67.0, "episode_reward_min": -64.0, "episode_reward_mean": -0.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -91.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 67.0, "predator_policy": 50.0}, "policy_reward_mean": {"prey_policy": -5.45, "predator_policy": 5.17}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.0, 3.0, 0.0, -5.0, 0.0, -2.0, -5.0, 0.0, -25.0, -7.0, -64.0, -3.0, -6.0, 34.0, -2.0, 0.0, 24.0, 0.0, -6.0, -1.0, 66.0, -3.0, 22.0, 25.0, 0.0, -6.0, -6.0, 0.0, 0.0, -6.0, 4.0, 2.0, -6.0, 0.0, -10.0, -10.0, 0.0, 0.0, -4.0, -1.0, -7.0, 67.0, -28.0, 6.0, -18.0, 5.0, 0.0, -18.0, -5.0, 1.0, -4.0, 37.0, 0.0, -9.0, -33.0, -18.0, -8.0, 3.0, 2.0, 0.0, 11.0, -15.0, 5.0, -12.0, -1.0, 0.0, 0.0, 0.0, -8.0, -8.0, -12.0, 3.0, -18.0, -12.0, 0.0, 0.0, 0.0, 1.0, 0.0, -4.0, 1.0, -18.0, 36.0, 0.0, 39.0, 0.0, -5.0, -6.0, 0.0, 10.0, -1.0, 0.0, 0.0, -5.0, 4.0, 0.0, -9.0, -11.0, 5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -2.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, -12.0, 4.0, 0.0, -10.0, 0.0, 0.0, -32.0, -18.0, -34.0, -6.0, -50.0, -42.0, 0.0, -6.0, -12.0, 0.0, -10.0, 39.0, 0.0, -5.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, -4.0, -12.0, -2.0, 0.0, 0.0, 63.0, 0.0, -6.0, 0.0, 22.0, 25.0, 0.0, 0.0, 0.0, -10.0, -12.0, -8.0, -10.0, 0.0, 0.0, 0.0, 0.0, -25.0, 0.0, -8.0, 5.0, -12.0, 5.0, 0.0, -12.0, 0.0, 0.0, 0.0, -20.0, 0.0, -22.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -2.0, 0.0, -14.0, 0.0, 67.0, -64.0, 0.0, 0.0, 6.0, -24.0, -12.0, -22.0, 16.0, 0.0, 0.0, -48.0, 0.0, 0.0, -18.0, -14.0, -14.0, 0.0, -9.0, -16.0, 13.0, 0.0, 0.0, 0.0, -21.0, -22.0, -33.0, -91.0, -21.0, 0.0, -16.0, -13.0, -21.0, -23.0, 0.0, 0.0, 0.0, 11.0, 0.0, -4.0, -26.0, 5.0, 0.0, 1.0, -26.0, 1.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -4.0, 2.0, -32.0, -52.0, 0.0, 0.0, 3.0, -44.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -41.0, -8.0, 1.0, 0.0, 0.0, -50.0, 24.0, 0.0, 4.0, -16.0, 32.0, 0.0, 0.0, 0.0, -28.0, 6.0, -39.0, -5.0, 0.0, 0.0, -30.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 3.0, -2.0, -12.0, 0.0, 0.0, -10.0, -22.0, -10.0, -14.0, -2.0, 0.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 6.0, 0.0, 5.0, 0.0, 0.0, 0.0, 9.0, 16.0, 19.0, 14.0, 25.0, 3.0, 0.0, 3.0, 6.0, 0.0, 5.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 4.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 4.0, 3.0, 3.0, 6.0, 6.0, 0.0, 0.0, 0.0, 2.0, 8.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 2.0, 34.0, 0.0, 0.0, 12.0, 6.0, 0.0, 11.0, 0.0, 0.0, 0.0, 30.0, 5.0, 8.0, 11.0, 18.0, 0.0, 5.0, 2.0, 38.0, 0.0, 0.0, 12.0, 0.0, 18.0, 4.0, 50.0, 44.0, 0.0, 8.0, 17.0, 20.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 2.0, 13.0, 0.0, 0.0, 12.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 15.0, 7.0, 16.0, 24.0, 0.0, 0.0, 22.0, 4.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 42.0, 0.0, 0.0, 21.0, 11.0, 2.0, 10.0, 6.0, 6.0, 7.0, 0.0, 0.0, 0.0, 2.0, 15.0, 19.0, 19.0, 0.0, 0.0, 24.0, 16.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 12.0, 6.0, 0.0, 0.0, 6.0, 17.0, 8.0, 5.0, 7.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.923079661403868, "mean_inference_ms": 36.71938070269124, "mean_action_processing_ms": 0.8180532608735837, "mean_env_wait_ms": 2.670111557015183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03347015380859375, "StateBufferConnector_ms": 0.03189206123352051, "ViewRequirementAgentConnector_ms": 0.6286770105361938}, "num_episodes": 22, "episode_return_max": 67.0, "episode_return_min": -64.0, "episode_return_mean": -0.56, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 243.1012873972435, "num_env_steps_trained_throughput_per_sec": 243.1012873972435, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 206777.529, "restore_workers_time_ms": 2.294, "training_step_time_ms": 206774.824, "sample_time_ms": 5892.844, "learn_time_ms": 200837.414, "learn_throughput": 19.917, "synch_weights_time_ms": 34.03}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 120, "trial_id": "4f45b_00000", "date": "2024-08-13_04-44-24", "timestamp": 1723538664, "time_this_iter_s": 16.594343900680542, "time_total_s": 11491.991300344467, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24885e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11491.991300344467, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 76.06956521739131, "ram_util_percent": 83.2695652173913}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8874854987970104, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5117652278807429, "policy_loss": -0.002134377312250238, "vf_loss": 0.5138979766892378, "vf_explained_var": 0.02452052418517057, "kl": 0.01041806021962371, "entropy": 0.671219274038991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.447029987970988, "cur_kl_coeff": 0.0001042842864990234, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6338782555650349, "policy_loss": -0.006009470998979711, "vf_loss": 0.6398831455638169, "vf_explained_var": 0.05230876194736945, "kl": 0.04392044122877038, "entropy": 0.7093374816828935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "env_runners": {"episode_reward_max": 67.0, "episode_reward_min": -33.0, "episode_reward_mean": -0.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -91.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 67.0, "predator_policy": 50.0}, "policy_reward_mean": {"prey_policy": -6.01, "predator_policy": 5.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -6.0, -1.0, 66.0, -3.0, 22.0, 25.0, 0.0, -6.0, -6.0, 0.0, 0.0, -6.0, 4.0, 2.0, -6.0, 0.0, -10.0, -10.0, 0.0, 0.0, -4.0, -1.0, -7.0, 67.0, -28.0, 6.0, -18.0, 5.0, 0.0, -18.0, -5.0, 1.0, -4.0, 37.0, 0.0, -9.0, -33.0, -18.0, -8.0, 3.0, 2.0, 0.0, 11.0, -15.0, 5.0, -12.0, -1.0, 0.0, 0.0, 0.0, -8.0, -8.0, -12.0, 3.0, -18.0, -12.0, 0.0, 0.0, 0.0, 1.0, 0.0, -4.0, 1.0, -18.0, 36.0, 0.0, 39.0, 0.0, -5.0, -6.0, 0.0, 10.0, -1.0, 0.0, 0.0, -5.0, 4.0, 0.0, -9.0, -11.0, 5.0, 0.0, -2.0, 0.0, -9.0, 17.0, 2.0, 0.0, -32.0, -10.0, -22.0, -18.0, 3.0, -2.0, -4.0, -7.0, -9.0, -5.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -4.0, -12.0, -2.0, 0.0, 0.0, 63.0, 0.0, -6.0, 0.0, 22.0, 25.0, 0.0, 0.0, 0.0, -10.0, -12.0, -8.0, -10.0, 0.0, 0.0, 0.0, 0.0, -25.0, 0.0, -8.0, 5.0, -12.0, 5.0, 0.0, -12.0, 0.0, 0.0, 0.0, -20.0, 0.0, -22.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -2.0, 0.0, -14.0, 0.0, 67.0, -64.0, 0.0, 0.0, 6.0, -24.0, -12.0, -22.0, 16.0, 0.0, 0.0, -48.0, 0.0, 0.0, -18.0, -14.0, -14.0, 0.0, -9.0, -16.0, 13.0, 0.0, 0.0, 0.0, -21.0, -22.0, -33.0, -91.0, -21.0, 0.0, -16.0, -13.0, -21.0, -23.0, 0.0, 0.0, 0.0, 11.0, 0.0, -4.0, -26.0, 5.0, 0.0, 1.0, -26.0, 1.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -4.0, 2.0, -32.0, -52.0, 0.0, 0.0, 3.0, -44.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -41.0, -8.0, 1.0, 0.0, 0.0, -50.0, 24.0, 0.0, 4.0, -16.0, 32.0, 0.0, 0.0, 0.0, -28.0, 6.0, -39.0, -5.0, 0.0, 0.0, -30.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 3.0, -2.0, -12.0, 0.0, 0.0, -10.0, -22.0, -10.0, -14.0, -2.0, 0.0, 0.0, 0.0, 2.0, -30.0, 0.0, 0.0, -7.0, -18.0, -30.0, 32.0, 2.0, 0.0, -8.0, 0.0, -67.0, 0.0, -20.0, 0.0, -19.0, -24.0, 0.0, -36.0, 3.0, 0.0, -14.0, 5.0, -16.0, 4.0, -4.0, -10.0, -18.0, 0.0, 0.0, -10.0, 0.0, -8.0], "policy_predator_policy_reward": [0.0, 0.0, 6.0, 4.0, 0.0, 1.0, 3.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 4.0, 3.0, 3.0, 6.0, 6.0, 0.0, 0.0, 0.0, 2.0, 8.0, 7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 2.0, 34.0, 0.0, 0.0, 12.0, 6.0, 0.0, 11.0, 0.0, 0.0, 0.0, 30.0, 5.0, 8.0, 11.0, 18.0, 0.0, 5.0, 2.0, 38.0, 0.0, 0.0, 12.0, 0.0, 18.0, 4.0, 50.0, 44.0, 0.0, 8.0, 17.0, 20.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 2.0, 13.0, 0.0, 0.0, 12.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 15.0, 7.0, 16.0, 24.0, 0.0, 0.0, 22.0, 4.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 42.0, 0.0, 0.0, 21.0, 11.0, 2.0, 10.0, 6.0, 6.0, 7.0, 0.0, 0.0, 0.0, 2.0, 15.0, 19.0, 19.0, 0.0, 0.0, 24.0, 16.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 12.0, 6.0, 0.0, 0.0, 6.0, 17.0, 8.0, 5.0, 7.0, 0.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 0.0, 16.0, 9.0, 6.0, 0.0, 0.0, 4.0, 4.0, 0.0, 35.0, 9.0, 1.0, 13.0, 8.0, 18.0, 0.0, 0.0, 0.0, 7.0, 0.0, 5.0, 3.0, 0.0, 7.0, 0.0, 9.0, 0.0, 5.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.425715473648314, "mean_inference_ms": 36.894915283671416, "mean_action_processing_ms": 0.8188578291842163, "mean_env_wait_ms": 2.6558504407694317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026791691780090332, "StateBufferConnector_ms": 0.027405977249145508, "ViewRequirementAgentConnector_ms": 0.5203408002853394}, "num_episodes": 18, "episode_return_max": 67.0, "episode_return_min": -33.0, "episode_return_mean": -0.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.46333856504094, "num_env_steps_trained_throughput_per_sec": 208.46333856504094, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 1936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1936000, "timers": {"training_iteration_time_ms": 207055.955, "restore_workers_time_ms": 2.295, "training_step_time_ms": 207053.248, "sample_time_ms": 6101.313, "learn_time_ms": 200907.576, "learn_throughput": 19.91, "synch_weights_time_ms": 33.903}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "done": false, "training_iteration": 121, "trial_id": "4f45b_00000", "date": "2024-08-13_04-44-44", "timestamp": 1723538684, "time_this_iter_s": 19.245534420013428, "time_total_s": 11511.23683476448, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24d59d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11511.23683476448, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 79.11428571428573, "ram_util_percent": 83.56071428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2668698906504288, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4030776451110209, "policy_loss": -0.0032663300584154153, "vf_loss": 0.40634217844566417, "vf_explained_var": 0.016853876277883217, "kl": 0.011477752156679148, "entropy": 0.7021120076772397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4483955123870778, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4855795550928821, "policy_loss": -0.004826037503813428, "vf_loss": 0.4904037806048383, "vf_explained_var": 0.06073581295669394, "kl": 0.01159741205765566, "entropy": 0.707406136724684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "env_runners": {"episode_reward_max": 67.0, "episode_reward_min": -33.0, "episode_reward_mean": -1.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -91.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 67.0, "predator_policy": 50.0}, "policy_reward_mean": {"prey_policy": -6.475, "predator_policy": 5.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10.0, 0.0, 0.0, -4.0, -1.0, -7.0, 67.0, -28.0, 6.0, -18.0, 5.0, 0.0, -18.0, -5.0, 1.0, -4.0, 37.0, 0.0, -9.0, -33.0, -18.0, -8.0, 3.0, 2.0, 0.0, 11.0, -15.0, 5.0, -12.0, -1.0, 0.0, 0.0, 0.0, -8.0, -8.0, -12.0, 3.0, -18.0, -12.0, 0.0, 0.0, 0.0, 1.0, 0.0, -4.0, 1.0, -18.0, 36.0, 0.0, 39.0, 0.0, -5.0, -6.0, 0.0, 10.0, -1.0, 0.0, 0.0, -5.0, 4.0, 0.0, -9.0, -11.0, 5.0, 0.0, -2.0, 0.0, -9.0, 17.0, 2.0, 0.0, -32.0, -10.0, -22.0, -18.0, 3.0, -2.0, -4.0, -7.0, -9.0, -5.0, -4.0, -26.0, 1.0, 0.0, 2.0, -15.0, 15.0, -6.0, 6.0, 0.0, -17.0, 24.0, 29.0, -5.0, -8.0, 0.0, 3.0, 4.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -22.0, 0.0, 0.0, 0.0, 0.0, -11.0, 0.0, 0.0, -2.0, 0.0, -14.0, 0.0, 67.0, -64.0, 0.0, 0.0, 6.0, -24.0, -12.0, -22.0, 16.0, 0.0, 0.0, -48.0, 0.0, 0.0, -18.0, -14.0, -14.0, 0.0, -9.0, -16.0, 13.0, 0.0, 0.0, 0.0, -21.0, -22.0, -33.0, -91.0, -21.0, 0.0, -16.0, -13.0, -21.0, -23.0, 0.0, 0.0, 0.0, 11.0, 0.0, -4.0, -26.0, 5.0, 0.0, 1.0, -26.0, 1.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -4.0, 2.0, -32.0, -52.0, 0.0, 0.0, 3.0, -44.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -41.0, -8.0, 1.0, 0.0, 0.0, -50.0, 24.0, 0.0, 4.0, -16.0, 32.0, 0.0, 0.0, 0.0, -28.0, 6.0, -39.0, -5.0, 0.0, 0.0, -30.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 3.0, -2.0, -12.0, 0.0, 0.0, -10.0, -22.0, -10.0, -14.0, -2.0, 0.0, 0.0, 0.0, 2.0, -30.0, 0.0, 0.0, -7.0, -18.0, -30.0, 32.0, 2.0, 0.0, -8.0, 0.0, -67.0, 0.0, -20.0, 0.0, -19.0, -24.0, 0.0, -36.0, 3.0, 0.0, -14.0, 5.0, -16.0, 4.0, -4.0, -10.0, -18.0, 0.0, 0.0, -10.0, 0.0, -8.0, -18.0, -20.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, -30.0, 0.0, 2.0, 13.0, -9.0, -4.0, 0.0, 6.0, 0.0, -1.0, -64.0, 0.0, -2.0, 20.0, 21.0, 0.0, 0.0, -10.0, -14.0, -2.0, 0.0, 0.0, 1.0, 0.0, -8.0, 8.0, 0.0, -6.0], "policy_predator_policy_reward": [7.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 2.0, 34.0, 0.0, 0.0, 12.0, 6.0, 0.0, 11.0, 0.0, 0.0, 0.0, 30.0, 5.0, 8.0, 11.0, 18.0, 0.0, 5.0, 2.0, 38.0, 0.0, 0.0, 12.0, 0.0, 18.0, 4.0, 50.0, 44.0, 0.0, 8.0, 17.0, 20.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 2.0, 13.0, 0.0, 0.0, 12.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 15.0, 7.0, 16.0, 24.0, 0.0, 0.0, 22.0, 4.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 42.0, 0.0, 0.0, 21.0, 11.0, 2.0, 10.0, 6.0, 6.0, 7.0, 0.0, 0.0, 0.0, 2.0, 15.0, 19.0, 19.0, 0.0, 0.0, 24.0, 16.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 12.0, 6.0, 0.0, 0.0, 6.0, 17.0, 8.0, 5.0, 7.0, 0.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 0.0, 16.0, 9.0, 6.0, 0.0, 0.0, 4.0, 4.0, 0.0, 35.0, 9.0, 1.0, 13.0, 8.0, 18.0, 0.0, 0.0, 0.0, 7.0, 0.0, 5.0, 3.0, 0.0, 7.0, 0.0, 9.0, 0.0, 5.0, 4.0, 0.0, 11.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 1.0, 21.0, 26.0, 1.0, 5.0, 8.0, 0.0, 5.0, 0.0, 1.0, 7.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.330477033487542, "mean_inference_ms": 36.6544800729201, "mean_action_processing_ms": 0.8177757730675909, "mean_env_wait_ms": 2.640495428229768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01428687572479248, "StateBufferConnector_ms": 0.025822997093200684, "ViewRequirementAgentConnector_ms": 0.5109202861785889}, "num_episodes": 18, "episode_return_max": 67.0, "episode_return_min": -33.0, "episode_return_mean": -1.7, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.16475855801485, "num_env_steps_trained_throughput_per_sec": 221.16475855801485, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1952000, "timers": {"training_iteration_time_ms": 207161.163, "restore_workers_time_ms": 2.296, "training_step_time_ms": 207158.456, "sample_time_ms": 6164.926, "learn_time_ms": 200949.764, "learn_throughput": 19.905, "synch_weights_time_ms": 33.199}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "done": false, "training_iteration": 122, "trial_id": "4f45b_00000", "date": "2024-08-13_04-45-02", "timestamp": 1723538702, "time_this_iter_s": 18.13653016090393, "time_total_s": 11529.373364925385, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27d78b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11529.373364925385, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 79.024, "ram_util_percent": 83.52}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9193896755654976, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.19939464466872986, "policy_loss": -0.0020945673517725138, "vf_loss": 0.2014874726061761, "vf_explained_var": 0.0014081128690608595, "kl": 0.011119825100841188, "entropy": 0.6532275225750352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1661514386022218, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2604803006695129, "policy_loss": -0.006674439463611672, "vf_loss": 0.2671526416869176, "vf_explained_var": -0.015359807235223276, "kl": 0.013411790291739879, "entropy": 0.7212867765830308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": 39.0, "episode_reward_min": -32.0, "episode_reward_mean": -0.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -67.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 32.0, "predator_policy": 42.0}, "policy_reward_mean": {"prey_policy": -5.175, "predator_policy": 4.715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 0.0, 11.0, -15.0, 5.0, -12.0, -1.0, 0.0, 0.0, 0.0, -8.0, -8.0, -12.0, 3.0, -18.0, -12.0, 0.0, 0.0, 0.0, 1.0, 0.0, -4.0, 1.0, -18.0, 36.0, 0.0, 39.0, 0.0, -5.0, -6.0, 0.0, 10.0, -1.0, 0.0, 0.0, -5.0, 4.0, 0.0, -9.0, -11.0, 5.0, 0.0, -2.0, 0.0, -9.0, 17.0, 2.0, 0.0, -32.0, -10.0, -22.0, -18.0, 3.0, -2.0, -4.0, -7.0, -9.0, -5.0, -4.0, -26.0, 1.0, 0.0, 2.0, -15.0, 15.0, -6.0, 6.0, 0.0, -17.0, 24.0, 29.0, -5.0, -8.0, 0.0, 3.0, 4.0, -3.0, 0.0, -12.0, -4.0, -3.0, 4.0, -13.0, 28.0, -9.0, 23.0, 0.0, -3.0, -3.0, -6.0, 0.0, -5.0, 0.0, -5.0, 17.0, 3.0, 29.0, 0.0, -4.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-23.0, 0.0, 0.0, 0.0, 11.0, 0.0, -4.0, -26.0, 5.0, 0.0, 1.0, -26.0, 1.0, -4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, -4.0, 2.0, -32.0, -52.0, 0.0, 0.0, 3.0, -44.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -41.0, -8.0, 1.0, 0.0, 0.0, -50.0, 24.0, 0.0, 4.0, -16.0, 32.0, 0.0, 0.0, 0.0, -28.0, 6.0, -39.0, -5.0, 0.0, 0.0, -30.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 3.0, -2.0, -12.0, 0.0, 0.0, -10.0, -22.0, -10.0, -14.0, -2.0, 0.0, 0.0, 0.0, 2.0, -30.0, 0.0, 0.0, -7.0, -18.0, -30.0, 32.0, 2.0, 0.0, -8.0, 0.0, -67.0, 0.0, -20.0, 0.0, -19.0, -24.0, 0.0, -36.0, 3.0, 0.0, -14.0, 5.0, -16.0, 4.0, -4.0, -10.0, -18.0, 0.0, 0.0, -10.0, 0.0, -8.0, -18.0, -20.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, -30.0, 0.0, 2.0, 13.0, -9.0, -4.0, 0.0, 6.0, 0.0, -1.0, -64.0, 0.0, -2.0, 20.0, 21.0, 0.0, 0.0, -10.0, -14.0, -2.0, 0.0, 0.0, 1.0, 0.0, -8.0, 8.0, 0.0, -6.0, 0.0, 0.0, -12.0, -18.0, -6.0, -2.0, -52.0, 1.0, 4.0, 0.0, -9.0, -18.0, 17.0, -4.0, -12.0, -12.0, 0.0, 16.0, 0.0, 0.0, -10.0, 2.0, 1.0, -8.0, -12.0, 0.0, 0.0, 0.0, -23.0, -34.0, 0.0, 0.0, -8.0, -2.0, 17.0, 0.0, 0.0, 3.0, 29.0, 0.0, 0.0, 0.0, -2.0, -6.0, -6.0, 0.0], "policy_predator_policy_reward": [10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 2.0, 13.0, 0.0, 0.0, 12.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 15.0, 7.0, 16.0, 24.0, 0.0, 0.0, 22.0, 4.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 42.0, 0.0, 0.0, 21.0, 11.0, 2.0, 10.0, 6.0, 6.0, 7.0, 0.0, 0.0, 0.0, 2.0, 15.0, 19.0, 19.0, 0.0, 0.0, 24.0, 16.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 12.0, 6.0, 0.0, 0.0, 6.0, 17.0, 8.0, 5.0, 7.0, 0.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 0.0, 16.0, 9.0, 6.0, 0.0, 0.0, 4.0, 4.0, 0.0, 35.0, 9.0, 1.0, 13.0, 8.0, 18.0, 0.0, 0.0, 0.0, 7.0, 0.0, 5.0, 3.0, 0.0, 7.0, 0.0, 9.0, 0.0, 5.0, 4.0, 0.0, 11.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 1.0, 21.0, 26.0, 1.0, 5.0, 8.0, 0.0, 5.0, 0.0, 1.0, 7.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 3.0, 0.0, 0.0, 8.0, 10.0, 4.0, 0.0, 24.0, 24.0, 0.0, 0.0, 9.0, 5.0, 9.0, 6.0, 6.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 18.0, 34.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.999512964268922, "mean_inference_ms": 36.39281094827469, "mean_action_processing_ms": 0.8162539199878074, "mean_env_wait_ms": 2.7978251191255334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01026773452758789, "StateBufferConnector_ms": 0.011565566062927246, "ViewRequirementAgentConnector_ms": 0.3807162046432495}, "num_episodes": 23, "episode_return_max": 39.0, "episode_return_min": -32.0, "episode_return_mean": -0.92, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.85455385144738, "num_env_steps_trained_throughput_per_sec": 217.85455385144738, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 207345.012, "restore_workers_time_ms": 2.295, "training_step_time_ms": 207342.306, "sample_time_ms": 6139.344, "learn_time_ms": 201155.585, "learn_throughput": 19.885, "synch_weights_time_ms": 36.693}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 123, "trial_id": "4f45b_00000", "date": "2024-08-13_04-45-20", "timestamp": 1723538720, "time_this_iter_s": 18.42629909515381, "time_total_s": 11547.799664020538, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24d5820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11547.799664020538, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 79.13846153846154, "ram_util_percent": 83.33461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.311348210377668, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3529495633389584, "policy_loss": -0.0035880028654540343, "vf_loss": 0.3565346570315933, "vf_explained_var": 0.06187655099485286, "kl": 0.018601815195775716, "entropy": 0.7559329794512855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.577913067438615, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4509219798341359, "policy_loss": -0.008992754980532463, "vf_loss": 0.45991155269935174, "vf_explained_var": 0.03862575343046239, "kl": 0.020349944424774356, "entropy": 0.7594268091141232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "env_runners": {"episode_reward_max": 39.0, "episode_reward_min": -39.0, "episode_reward_mean": -1.1, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -67.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 32.0, "predator_policy": 42.0}, "policy_reward_mean": {"prey_policy": -5.17, "predator_policy": 4.62}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 1.0, 0.0, -4.0, 1.0, -18.0, 36.0, 0.0, 39.0, 0.0, -5.0, -6.0, 0.0, 10.0, -1.0, 0.0, 0.0, -5.0, 4.0, 0.0, -9.0, -11.0, 5.0, 0.0, -2.0, 0.0, -9.0, 17.0, 2.0, 0.0, -32.0, -10.0, -22.0, -18.0, 3.0, -2.0, -4.0, -7.0, -9.0, -5.0, -4.0, -26.0, 1.0, 0.0, 2.0, -15.0, 15.0, -6.0, 6.0, 0.0, -17.0, 24.0, 29.0, -5.0, -8.0, 0.0, 3.0, 4.0, -3.0, 0.0, -12.0, -4.0, -3.0, 4.0, -13.0, 28.0, -9.0, 23.0, 0.0, -3.0, -3.0, -6.0, 0.0, -5.0, 0.0, -5.0, 17.0, 3.0, 29.0, 0.0, -4.0, -3.0, -10.0, 3.0, 0.0, -6.0, 0.0, 0.0, 17.0, -4.0, -31.0, -22.0, 0.0, 0.0, -11.0, -39.0, -2.0, -1.0, 0.0, 23.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, 1.0, 0.0, 0.0, -41.0, -8.0, 1.0, 0.0, 0.0, -50.0, 24.0, 0.0, 4.0, -16.0, 32.0, 0.0, 0.0, 0.0, -28.0, 6.0, -39.0, -5.0, 0.0, 0.0, -30.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -16.0, 3.0, -2.0, -12.0, 0.0, 0.0, -10.0, -22.0, -10.0, -14.0, -2.0, 0.0, 0.0, 0.0, 2.0, -30.0, 0.0, 0.0, -7.0, -18.0, -30.0, 32.0, 2.0, 0.0, -8.0, 0.0, -67.0, 0.0, -20.0, 0.0, -19.0, -24.0, 0.0, -36.0, 3.0, 0.0, -14.0, 5.0, -16.0, 4.0, -4.0, -10.0, -18.0, 0.0, 0.0, -10.0, 0.0, -8.0, -18.0, -20.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, -30.0, 0.0, 2.0, 13.0, -9.0, -4.0, 0.0, 6.0, 0.0, -1.0, -64.0, 0.0, -2.0, 20.0, 21.0, 0.0, 0.0, -10.0, -14.0, -2.0, 0.0, 0.0, 1.0, 0.0, -8.0, 8.0, 0.0, -6.0, 0.0, 0.0, -12.0, -18.0, -6.0, -2.0, -52.0, 1.0, 4.0, 0.0, -9.0, -18.0, 17.0, -4.0, -12.0, -12.0, 0.0, 16.0, 0.0, 0.0, -10.0, 2.0, 1.0, -8.0, -12.0, 0.0, 0.0, 0.0, -23.0, -34.0, 0.0, 0.0, -8.0, -2.0, 17.0, 0.0, 0.0, 3.0, 29.0, 0.0, 0.0, 0.0, -2.0, -6.0, -6.0, 0.0, -14.0, -7.0, 5.0, -14.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 4.0, 11.0, 0.0, -14.0, -16.0, -36.0, -26.0, -28.0, 0.0, 0.0, 0.0, 0.0, -8.0, -14.0, -28.0, -33.0, 0.0, -4.0, -6.0, -4.0, 0.0, 0.0, 17.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 42.0, 0.0, 0.0, 21.0, 11.0, 2.0, 10.0, 6.0, 6.0, 7.0, 0.0, 0.0, 0.0, 2.0, 15.0, 19.0, 19.0, 0.0, 0.0, 24.0, 16.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 12.0, 6.0, 0.0, 0.0, 6.0, 17.0, 8.0, 5.0, 7.0, 0.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 0.0, 16.0, 9.0, 6.0, 0.0, 0.0, 4.0, 4.0, 0.0, 35.0, 9.0, 1.0, 13.0, 8.0, 18.0, 0.0, 0.0, 0.0, 7.0, 0.0, 5.0, 3.0, 0.0, 7.0, 0.0, 9.0, 0.0, 5.0, 4.0, 0.0, 11.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 1.0, 21.0, 26.0, 1.0, 5.0, 8.0, 0.0, 5.0, 0.0, 1.0, 7.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 3.0, 0.0, 0.0, 8.0, 10.0, 4.0, 0.0, 24.0, 24.0, 0.0, 0.0, 9.0, 5.0, 9.0, 6.0, 6.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 18.0, 34.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 3.0, 0.0, 7.0, 4.0, 4.0, 8.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 5.0, 5.0, 17.0, 4.0, 27.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 7.0, 22.0, 0.0, 0.0, 2.0, 7.0, 2.0, 0.0, 0.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.121445391643356, "mean_inference_ms": 36.11766048744792, "mean_action_processing_ms": 0.8137083743433575, "mean_env_wait_ms": 2.6028954610365185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008259892463684082, "StateBufferConnector_ms": 0.011284828186035156, "ViewRequirementAgentConnector_ms": 0.3448423147201538}, "num_episodes": 18, "episode_return_max": 39.0, "episode_return_min": -39.0, "episode_return_mean": -1.1, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.86934561212274, "num_env_steps_trained_throughput_per_sec": 216.86934561212274, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1984000, "timers": {"training_iteration_time_ms": 204529.014, "restore_workers_time_ms": 0.302, "training_step_time_ms": 204528.596, "sample_time_ms": 4502.255, "learn_time_ms": 199979.239, "learn_throughput": 20.002, "synch_weights_time_ms": 38.394}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "done": false, "training_iteration": 124, "trial_id": "4f45b_00000", "date": "2024-08-13_04-45-39", "timestamp": 1723538739, "time_this_iter_s": 18.534892797470093, "time_total_s": 11566.334556818008, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2482d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 11566.334556818008, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 80.0851851851852, "ram_util_percent": 83.39629629629628}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4133304861329852, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.45115626634901795, "policy_loss": -0.0034113558874066387, "vf_loss": 0.4545655613449752, "vf_explained_var": 0.04885876308042536, "kl": 0.01317975590366649, "entropy": 0.7352599502240539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5237288604022334, "cur_kl_coeff": 0.00023463964462280267, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7923792334224181, "policy_loss": -0.006516139294272141, "vf_loss": 0.7988919836897699, "vf_explained_var": 0.10729009792918251, "kl": 0.014442314579460745, "entropy": 0.7406019825468618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 50.0, "episode_reward_min": -39.0, "episode_reward_mean": -0.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -67.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 67.0, "predator_policy": 35.0}, "policy_reward_mean": {"prey_policy": -4.73, "predator_policy": 4.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 0.0, -2.0, 0.0, -9.0, 17.0, 2.0, 0.0, -32.0, -10.0, -22.0, -18.0, 3.0, -2.0, -4.0, -7.0, -9.0, -5.0, -4.0, -26.0, 1.0, 0.0, 2.0, -15.0, 15.0, -6.0, 6.0, 0.0, -17.0, 24.0, 29.0, -5.0, -8.0, 0.0, 3.0, 4.0, -3.0, 0.0, -12.0, -4.0, -3.0, 4.0, -13.0, 28.0, -9.0, 23.0, 0.0, -3.0, -3.0, -6.0, 0.0, -5.0, 0.0, -5.0, 17.0, 3.0, 29.0, 0.0, -4.0, -3.0, -10.0, 3.0, 0.0, -6.0, 0.0, 0.0, 17.0, -4.0, -31.0, -22.0, 0.0, 0.0, -11.0, -39.0, -2.0, -1.0, 0.0, 23.0, -16.0, -13.0, -6.0, 11.0, -14.0, 6.0, -1.0, -6.0, 5.0, 0.0, -3.0, -13.0, -1.0, 49.0, -16.0, 18.0, -15.0, -1.0, 0.0, 50.0, 0.0, 26.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, 0.0, 0.0, 0.0, 2.0, -30.0, 0.0, 0.0, -7.0, -18.0, -30.0, 32.0, 2.0, 0.0, -8.0, 0.0, -67.0, 0.0, -20.0, 0.0, -19.0, -24.0, 0.0, -36.0, 3.0, 0.0, -14.0, 5.0, -16.0, 4.0, -4.0, -10.0, -18.0, 0.0, 0.0, -10.0, 0.0, -8.0, -18.0, -20.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, -30.0, 0.0, 2.0, 13.0, -9.0, -4.0, 0.0, 6.0, 0.0, -1.0, -64.0, 0.0, -2.0, 20.0, 21.0, 0.0, 0.0, -10.0, -14.0, -2.0, 0.0, 0.0, 1.0, 0.0, -8.0, 8.0, 0.0, -6.0, 0.0, 0.0, -12.0, -18.0, -6.0, -2.0, -52.0, 1.0, 4.0, 0.0, -9.0, -18.0, 17.0, -4.0, -12.0, -12.0, 0.0, 16.0, 0.0, 0.0, -10.0, 2.0, 1.0, -8.0, -12.0, 0.0, 0.0, 0.0, -23.0, -34.0, 0.0, 0.0, -8.0, -2.0, 17.0, 0.0, 0.0, 3.0, 29.0, 0.0, 0.0, 0.0, -2.0, -6.0, -6.0, 0.0, -14.0, -7.0, 5.0, -14.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 4.0, 11.0, 0.0, -14.0, -16.0, -36.0, -26.0, -28.0, 0.0, 0.0, 0.0, 0.0, -8.0, -14.0, -28.0, -33.0, 0.0, -4.0, -6.0, -4.0, 0.0, 0.0, 17.0, 0.0, 0.0, -36.0, -22.0, -8.0, 1.0, -14.0, 6.0, 5.0, -28.0, 0.0, -28.0, 10.0, -6.0, 0.0, -4.0, -10.0, 4.0, 1.0, 0.0, 0.0, 3.0, -12.0, -30.0, -6.0, -4.0, -4.0, 25.0, 19.0, 0.0, -32.0, 0.0, 17.0, 0.0, -30.0, 5.0, -12.0, 0.0, 0.0, -34.0, 67.0, 0.0, 0.0, 33.0, -22.0], "policy_predator_policy_reward": [7.0, 0.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 0.0, 16.0, 9.0, 6.0, 0.0, 0.0, 4.0, 4.0, 0.0, 35.0, 9.0, 1.0, 13.0, 8.0, 18.0, 0.0, 0.0, 0.0, 7.0, 0.0, 5.0, 3.0, 0.0, 7.0, 0.0, 9.0, 0.0, 5.0, 4.0, 0.0, 11.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 1.0, 21.0, 26.0, 1.0, 5.0, 8.0, 0.0, 5.0, 0.0, 1.0, 7.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 3.0, 0.0, 0.0, 8.0, 10.0, 4.0, 0.0, 24.0, 24.0, 0.0, 0.0, 9.0, 5.0, 9.0, 6.0, 6.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 18.0, 34.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 3.0, 0.0, 7.0, 4.0, 4.0, 8.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 5.0, 5.0, 17.0, 4.0, 27.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 7.0, 22.0, 0.0, 0.0, 2.0, 7.0, 2.0, 0.0, 0.0, 6.0, 0.0, 12.0, 8.0, 14.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 24.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 12.0, 2.0, 5.0, 0.0, 5.0, 3.0, 13.0, 0.0, 1.0, 13.0, 2.0, 0.0, 6.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 7.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.004791264922723, "mean_inference_ms": 35.829057896911024, "mean_action_processing_ms": 0.8114705215135671, "mean_env_wait_ms": 2.5871890887111757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008543610572814941, "StateBufferConnector_ms": 0.01145470142364502, "ViewRequirementAgentConnector_ms": 0.38031816482543945}, "num_episodes": 22, "episode_return_max": 50.0, "episode_return_min": -39.0, "episode_return_mean": -0.82, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.9761081856398777, "num_env_steps_trained_throughput_per_sec": 3.9761081856398777, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 213189.03, "restore_workers_time_ms": 0.302, "training_step_time_ms": 213188.669, "sample_time_ms": 4378.514, "learn_time_ms": 208763.206, "learn_throughput": 19.16, "synch_weights_time_ms": 37.557}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 125, "trial_id": "4f45b_00000", "date": "2024-08-13_05-02-25", "timestamp": 1723539745, "time_this_iter_s": 1006.3038809299469, "time_total_s": 12572.638437747955, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24bfe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12572.638437747955, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 83.5090909090909, "ram_util_percent": 83.5121212121212}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5361496134173303, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8554776591914041, "policy_loss": -0.0011492509835907233, "vf_loss": 0.8566256628708087, "vf_explained_var": 0.0030896343566753246, "kl": 0.007977151628155129, "entropy": 0.7373758075098512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4256292845048602, "cur_kl_coeff": 0.00023463964462280267, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8861587960635209, "policy_loss": -0.014201028787693571, "vf_loss": 0.9003558406990672, "vf_explained_var": -0.04158228720937456, "kl": 0.01697927761357908, "entropy": 0.7216623999454357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 50.0, "episode_reward_min": -39.0, "episode_reward_mean": 0.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -79.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 67.0, "predator_policy": 68.0}, "policy_reward_mean": {"prey_policy": -4.09, "predator_policy": 4.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, -26.0, 1.0, 0.0, 2.0, -15.0, 15.0, -6.0, 6.0, 0.0, -17.0, 24.0, 29.0, -5.0, -8.0, 0.0, 3.0, 4.0, -3.0, 0.0, -12.0, -4.0, -3.0, 4.0, -13.0, 28.0, -9.0, 23.0, 0.0, -3.0, -3.0, -6.0, 0.0, -5.0, 0.0, -5.0, 17.0, 3.0, 29.0, 0.0, -4.0, -3.0, -10.0, 3.0, 0.0, -6.0, 0.0, 0.0, 17.0, -4.0, -31.0, -22.0, 0.0, 0.0, -11.0, -39.0, -2.0, -1.0, 0.0, 23.0, -16.0, -13.0, -6.0, 11.0, -14.0, 6.0, -1.0, -6.0, 5.0, 0.0, -3.0, -13.0, -1.0, 49.0, -16.0, 18.0, -15.0, -1.0, 0.0, 50.0, 0.0, 26.0, 22.0, 0.0, 0.0, -7.0, 0.0, 5.0, -7.0, -9.0, 0.0, -25.0, -6.0, -36.0, -4.0, 42.0, 22.0, 14.0, 3.0, 50.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -8.0, -18.0, -20.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, -30.0, 0.0, 2.0, 13.0, -9.0, -4.0, 0.0, 6.0, 0.0, -1.0, -64.0, 0.0, -2.0, 20.0, 21.0, 0.0, 0.0, -10.0, -14.0, -2.0, 0.0, 0.0, 1.0, 0.0, -8.0, 8.0, 0.0, -6.0, 0.0, 0.0, -12.0, -18.0, -6.0, -2.0, -52.0, 1.0, 4.0, 0.0, -9.0, -18.0, 17.0, -4.0, -12.0, -12.0, 0.0, 16.0, 0.0, 0.0, -10.0, 2.0, 1.0, -8.0, -12.0, 0.0, 0.0, 0.0, -23.0, -34.0, 0.0, 0.0, -8.0, -2.0, 17.0, 0.0, 0.0, 3.0, 29.0, 0.0, 0.0, 0.0, -2.0, -6.0, -6.0, 0.0, -14.0, -7.0, 5.0, -14.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 4.0, 11.0, 0.0, -14.0, -16.0, -36.0, -26.0, -28.0, 0.0, 0.0, 0.0, 0.0, -8.0, -14.0, -28.0, -33.0, 0.0, -4.0, -6.0, -4.0, 0.0, 0.0, 17.0, 0.0, 0.0, -36.0, -22.0, -8.0, 1.0, -14.0, 6.0, 5.0, -28.0, 0.0, -28.0, 10.0, -6.0, 0.0, -4.0, -10.0, 4.0, 1.0, 0.0, 0.0, 3.0, -12.0, -30.0, -6.0, -4.0, -4.0, 25.0, 19.0, 0.0, -32.0, 0.0, 17.0, 0.0, -30.0, 5.0, -12.0, 0.0, 0.0, -34.0, 67.0, 0.0, 0.0, 33.0, -22.0, 0.0, -79.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 5.0, 0.0, -14.0, 0.0, -20.0, 0.0, 0.0, -50.0, 0.0, 0.0, -12.0, -22.0, -28.0, -8.0, 0.0, 0.0, 38.0, 22.0, 0.0, 20.0, -20.0, 3.0, 0.0, 20.0, 2.0], "policy_predator_policy_reward": [4.0, 0.0, 11.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 0.0, 1.0, 21.0, 26.0, 1.0, 5.0, 8.0, 0.0, 5.0, 0.0, 1.0, 7.0, 0.0, 0.0, 2.0, 0.0, 0.0, 4.0, 0.0, 3.0, 0.0, 0.0, 8.0, 10.0, 4.0, 0.0, 24.0, 24.0, 0.0, 0.0, 9.0, 5.0, 9.0, 6.0, 6.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 18.0, 34.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 3.0, 0.0, 7.0, 4.0, 4.0, 8.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 5.0, 5.0, 17.0, 4.0, 27.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 7.0, 22.0, 0.0, 0.0, 2.0, 7.0, 2.0, 0.0, 0.0, 6.0, 0.0, 12.0, 8.0, 14.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 24.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 12.0, 2.0, 5.0, 0.0, 5.0, 3.0, 13.0, 0.0, 1.0, 13.0, 2.0, 0.0, 6.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 7.0, 8.0, 68.0, 33.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 11.0, 0.0, 0.0, 0.0, 7.0, 18.0, 6.0, 0.0, 0.0, 14.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 20.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.913785158029325, "mean_inference_ms": 35.59903043542083, "mean_action_processing_ms": 0.8100391373891866, "mean_env_wait_ms": 2.5720899825485786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08142387866973877, "StateBufferConnector_ms": 0.011563301086425781, "ViewRequirementAgentConnector_ms": 0.288638710975647}, "num_episodes": 18, "episode_return_max": 50.0, "episode_return_min": -39.0, "episode_return_mean": 0.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 169.14633868474257, "num_env_steps_trained_throughput_per_sec": 169.14633868474257, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 212693.894, "restore_workers_time_ms": 0.025, "training_step_time_ms": 212693.811, "sample_time_ms": 3904.215, "learn_time_ms": 208748.371, "learn_throughput": 19.162, "synch_weights_time_ms": 32.17}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 126, "trial_id": "4f45b_00000", "date": "2024-08-13_05-02-50", "timestamp": 1723539770, "time_this_iter_s": 23.722641229629517, "time_total_s": 12596.361078977585, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27ef820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12596.361078977585, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 90.8970588235294, "ram_util_percent": 83.09117647058825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7352541227248452, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3243704621399206, "policy_loss": -0.0031711884579626185, "vf_loss": 0.3275395773490398, "vf_explained_var": 0.0070283079588854755, "kl": 0.013251885849693858, "entropy": 0.8017573941636968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5974455232973452, "cur_kl_coeff": 0.00023463964462280267, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.47589227749249113, "policy_loss": -0.004815228727015435, "vf_loss": 0.48070490442650027, "vf_explained_var": 0.06397649790874865, "kl": 0.011085782087093833, "entropy": 0.6954901518014373, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "env_runners": {"episode_reward_max": 50.0, "episode_reward_min": -44.0, "episode_reward_mean": -0.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -96.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 67.0, "predator_policy": 68.0}, "policy_reward_mean": {"prey_policy": -5.155, "predator_policy": 4.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, 0.0, -12.0, -4.0, -3.0, 4.0, -13.0, 28.0, -9.0, 23.0, 0.0, -3.0, -3.0, -6.0, 0.0, -5.0, 0.0, -5.0, 17.0, 3.0, 29.0, 0.0, -4.0, -3.0, -10.0, 3.0, 0.0, -6.0, 0.0, 0.0, 17.0, -4.0, -31.0, -22.0, 0.0, 0.0, -11.0, -39.0, -2.0, -1.0, 0.0, 23.0, -16.0, -13.0, -6.0, 11.0, -14.0, 6.0, -1.0, -6.0, 5.0, 0.0, -3.0, -13.0, -1.0, 49.0, -16.0, 18.0, -15.0, -1.0, 0.0, 50.0, 0.0, 26.0, 22.0, 0.0, 0.0, -7.0, 0.0, 5.0, -7.0, -9.0, 0.0, -25.0, -6.0, -36.0, -4.0, 42.0, 22.0, 14.0, 3.0, 50.0, -44.0, 0.0, 0.0, -24.0, 0.0, -6.0, -8.0, 10.0, -1.0, 11.0, -43.0, 0.0, 6.0, -10.0, -10.0, 4.0, 11.0, -10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -6.0, 0.0, 0.0, -12.0, -18.0, -6.0, -2.0, -52.0, 1.0, 4.0, 0.0, -9.0, -18.0, 17.0, -4.0, -12.0, -12.0, 0.0, 16.0, 0.0, 0.0, -10.0, 2.0, 1.0, -8.0, -12.0, 0.0, 0.0, 0.0, -23.0, -34.0, 0.0, 0.0, -8.0, -2.0, 17.0, 0.0, 0.0, 3.0, 29.0, 0.0, 0.0, 0.0, -2.0, -6.0, -6.0, 0.0, -14.0, -7.0, 5.0, -14.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 4.0, 11.0, 0.0, -14.0, -16.0, -36.0, -26.0, -28.0, 0.0, 0.0, 0.0, 0.0, -8.0, -14.0, -28.0, -33.0, 0.0, -4.0, -6.0, -4.0, 0.0, 0.0, 17.0, 0.0, 0.0, -36.0, -22.0, -8.0, 1.0, -14.0, 6.0, 5.0, -28.0, 0.0, -28.0, 10.0, -6.0, 0.0, -4.0, -10.0, 4.0, 1.0, 0.0, 0.0, 3.0, -12.0, -30.0, -6.0, -4.0, -4.0, 25.0, 19.0, 0.0, -32.0, 0.0, 17.0, 0.0, -30.0, 5.0, -12.0, 0.0, 0.0, -34.0, 67.0, 0.0, 0.0, 33.0, -22.0, 0.0, -79.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 5.0, 0.0, -14.0, 0.0, -20.0, 0.0, 0.0, -50.0, 0.0, 0.0, -12.0, -22.0, -28.0, -8.0, 0.0, 0.0, 38.0, 22.0, 0.0, 20.0, -20.0, 3.0, 0.0, 20.0, 2.0, -96.0, 0.0, 0.0, 0.0, -6.0, 0.0, -36.0, -12.0, 0.0, 0.0, 0.0, -33.0, 0.0, -16.0, 14.0, -8.0, 0.0, -8.0, 5.0, 0.0, -36.0, -48.0, 0.0, 0.0, 18.0, -24.0, 0.0, -20.0, -10.0, -10.0, 4.0, 0.0, 11.0, 0.0, -2.0, -16.0], "policy_predator_policy_reward": [0.0, 3.0, 0.0, 0.0, 8.0, 10.0, 4.0, 0.0, 24.0, 24.0, 0.0, 0.0, 9.0, 5.0, 9.0, 6.0, 6.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 4.0, 0.0, 6.0, 0.0, 0.0, 0.0, 18.0, 34.0, 0.0, 0.0, 1.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 3.0, 0.0, 7.0, 4.0, 4.0, 8.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 5.0, 5.0, 17.0, 4.0, 27.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 7.0, 22.0, 0.0, 0.0, 2.0, 7.0, 2.0, 0.0, 0.0, 6.0, 0.0, 12.0, 8.0, 14.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 24.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 12.0, 2.0, 5.0, 0.0, 5.0, 3.0, 13.0, 0.0, 1.0, 13.0, 2.0, 0.0, 6.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 7.0, 8.0, 68.0, 33.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 11.0, 0.0, 0.0, 0.0, 7.0, 18.0, 6.0, 0.0, 0.0, 14.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 20.0, 8.0, 4.0, 48.0, 0.0, 0.0, 6.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 27.0, 8.0, 0.0, 4.0, 0.0, 7.0, 0.0, 6.0, 0.0, 26.0, 15.0, 0.0, 0.0, 12.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.8239902376293, "mean_inference_ms": 35.372226390349745, "mean_action_processing_ms": 0.8087130340677947, "mean_env_wait_ms": 2.5572015743144276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08173131942749023, "StateBufferConnector_ms": 0.0047866106033325195, "ViewRequirementAgentConnector_ms": 0.2388707399368286}, "num_episodes": 18, "episode_return_max": 50.0, "episode_return_min": -44.0, "episode_return_mean": -0.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.3231316587683, "num_env_steps_trained_throughput_per_sec": 206.3231316587683, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 2032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2032000, "timers": {"training_iteration_time_ms": 118021.195, "restore_workers_time_ms": 0.023, "training_step_time_ms": 118021.12, "sample_time_ms": 3672.321, "learn_time_ms": 114305.81, "learn_throughput": 34.994, "synch_weights_time_ms": 34.36}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "done": false, "training_iteration": 127, "trial_id": "4f45b_00000", "date": "2024-08-13_05-03-09", "timestamp": 1723539789, "time_this_iter_s": 19.51938033103943, "time_total_s": 12615.880459308624, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2729dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12615.880459308624, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 86.0642857142857, "ram_util_percent": 82.88928571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.650728399097604, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.45199596460849517, "policy_loss": -0.003434506685487808, "vf_loss": 0.45542920987681046, "vf_explained_var": 0.014281427103375632, "kl": 0.008048111934168788, "entropy": 0.7744035670996974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5865690523827518, "cur_kl_coeff": 0.00023463964462280267, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5147179902177649, "policy_loss": -0.0056121397487543245, "vf_loss": 0.5203279290836127, "vf_explained_var": -0.05251902625674293, "kl": 0.009374164715414477, "entropy": 0.6447776853092133, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "env_runners": {"episode_reward_max": 50.0, "episode_reward_min": -44.0, "episode_reward_mean": -2.1, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -96.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 67.0, "predator_policy": 68.0}, "policy_reward_mean": {"prey_policy": -6.13, "predator_policy": 5.08}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.0, -10.0, 3.0, 0.0, -6.0, 0.0, 0.0, 17.0, -4.0, -31.0, -22.0, 0.0, 0.0, -11.0, -39.0, -2.0, -1.0, 0.0, 23.0, -16.0, -13.0, -6.0, 11.0, -14.0, 6.0, -1.0, -6.0, 5.0, 0.0, -3.0, -13.0, -1.0, 49.0, -16.0, 18.0, -15.0, -1.0, 0.0, 50.0, 0.0, 26.0, 22.0, 0.0, 0.0, -7.0, 0.0, 5.0, -7.0, -9.0, 0.0, -25.0, -6.0, -36.0, -4.0, 42.0, 22.0, 14.0, 3.0, 50.0, -44.0, 0.0, 0.0, -24.0, 0.0, -6.0, -8.0, 10.0, -1.0, 11.0, -43.0, 0.0, 6.0, -10.0, -10.0, 4.0, 11.0, -10.0, 0.0, 11.0, -5.0, -8.0, 0.0, 10.0, -8.0, 3.0, -4.0, -36.0, -11.0, -4.0, -4.0, -2.0, -7.0, -11.0, -38.0, -11.0, 1.0, -14.0, 18.0, -7.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 0.0, -14.0, -7.0, 5.0, -14.0, 0.0, 0.0, 0.0, -12.0, 0.0, 0.0, 0.0, 0.0, 4.0, 11.0, 0.0, -14.0, -16.0, -36.0, -26.0, -28.0, 0.0, 0.0, 0.0, 0.0, -8.0, -14.0, -28.0, -33.0, 0.0, -4.0, -6.0, -4.0, 0.0, 0.0, 17.0, 0.0, 0.0, -36.0, -22.0, -8.0, 1.0, -14.0, 6.0, 5.0, -28.0, 0.0, -28.0, 10.0, -6.0, 0.0, -4.0, -10.0, 4.0, 1.0, 0.0, 0.0, 3.0, -12.0, -30.0, -6.0, -4.0, -4.0, 25.0, 19.0, 0.0, -32.0, 0.0, 17.0, 0.0, -30.0, 5.0, -12.0, 0.0, 0.0, -34.0, 67.0, 0.0, 0.0, 33.0, -22.0, 0.0, -79.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 5.0, 0.0, -14.0, 0.0, -20.0, 0.0, 0.0, -50.0, 0.0, 0.0, -12.0, -22.0, -28.0, -8.0, 0.0, 0.0, 38.0, 22.0, 0.0, 20.0, -20.0, 3.0, 0.0, 20.0, 2.0, -96.0, 0.0, 0.0, 0.0, -6.0, 0.0, -36.0, -12.0, 0.0, 0.0, 0.0, -33.0, 0.0, -16.0, 14.0, -8.0, 0.0, -8.0, 5.0, 0.0, -36.0, -48.0, 0.0, 0.0, 18.0, -24.0, 0.0, -20.0, -10.0, -10.0, 4.0, 0.0, 11.0, 0.0, -2.0, -16.0, 0.0, 0.0, 2.0, 0.0, 0.0, -10.0, -28.0, 0.0, 0.0, 0.0, 5.0, 5.0, -4.0, -12.0, 0.0, 3.0, -10.0, -4.0, -42.0, -20.0, 0.0, -22.0, -9.0, 0.0, 0.0, -11.0, -3.0, -2.0, 0.0, -14.0, -26.0, 0.0, -22.0, -59.0, 0.0, -22.0, -10.0, 0.0, -28.0, 0.0, -6.0, 16.0, -8.0, -6.0, -14.0, 0.0], "policy_predator_policy_reward": [3.0, 0.0, 7.0, 4.0, 4.0, 8.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 5.0, 5.0, 17.0, 4.0, 27.0, 5.0, 0.0, 0.0, 0.0, 0.0, 4.0, 7.0, 22.0, 0.0, 0.0, 2.0, 7.0, 2.0, 0.0, 0.0, 6.0, 0.0, 12.0, 8.0, 14.0, 3.0, 7.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 24.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 12.0, 2.0, 5.0, 0.0, 5.0, 3.0, 13.0, 0.0, 1.0, 13.0, 2.0, 0.0, 6.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 7.0, 8.0, 68.0, 33.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 11.0, 0.0, 0.0, 0.0, 7.0, 18.0, 6.0, 0.0, 0.0, 14.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 20.0, 8.0, 4.0, 48.0, 0.0, 0.0, 6.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 27.0, 8.0, 0.0, 4.0, 0.0, 7.0, 0.0, 6.0, 0.0, 26.0, 15.0, 0.0, 0.0, 12.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 9.0, 5.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 5.0, 13.0, 13.0, 0.0, 11.0, 0.0, 5.0, 7.0, 0.0, 0.0, 3.0, 0.0, 7.0, 15.0, 0.0, 33.0, 10.0, 11.0, 0.0, 11.0, 0.0, 14.0, 0.0, 4.0, 4.0, 3.0, 4.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.713961601787858, "mean_inference_ms": 35.087357940506315, "mean_action_processing_ms": 0.8067196390037223, "mean_env_wait_ms": 2.535360350353422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07982242107391357, "StateBufferConnector_ms": 0.005636334419250488, "ViewRequirementAgentConnector_ms": 0.2727782726287842}, "num_episodes": 23, "episode_return_max": 50.0, "episode_return_min": -44.0, "episode_return_mean": -2.1, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.85027010202785, "num_env_steps_trained_throughput_per_sec": 208.85027010202785, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 2048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2048000, "timers": {"training_iteration_time_ms": 117608.106, "restore_workers_time_ms": 0.023, "training_step_time_ms": 117608.029, "sample_time_ms": 3345.7, "learn_time_ms": 114219.269, "learn_throughput": 35.02, "synch_weights_time_ms": 34.251}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "done": false, "training_iteration": 128, "trial_id": "4f45b_00000", "date": "2024-08-13_05-03-28", "timestamp": 1723539808, "time_this_iter_s": 19.18797492980957, "time_total_s": 12635.068434238434, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27efe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12635.068434238434, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 83.35185185185186, "ram_util_percent": 83.57037037037037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5001868455143517, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5739459512725709, "policy_loss": -0.004531122504600457, "vf_loss": 0.5784743578758377, "vf_explained_var": 0.004593428890541117, "kl": 0.017344789628766084, "entropy": 0.7636575869151524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5497250114010754, "cur_kl_coeff": 0.00023463964462280267, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5509904134629304, "policy_loss": -0.00494667441810841, "vf_loss": 0.5559336108833098, "vf_explained_var": -0.05646191844864497, "kl": 0.014812606927328623, "entropy": 0.7230290108256869, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": 50.0, "episode_reward_min": -44.0, "episode_reward_mean": -1.08, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 67.0, "predator_policy": 68.0}, "policy_reward_mean": {"prey_policy": -6.31, "predator_policy": 5.77}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, -14.0, 6.0, -1.0, -6.0, 5.0, 0.0, -3.0, -13.0, -1.0, 49.0, -16.0, 18.0, -15.0, -1.0, 0.0, 50.0, 0.0, 26.0, 22.0, 0.0, 0.0, -7.0, 0.0, 5.0, -7.0, -9.0, 0.0, -25.0, -6.0, -36.0, -4.0, 42.0, 22.0, 14.0, 3.0, 50.0, -44.0, 0.0, 0.0, -24.0, 0.0, -6.0, -8.0, 10.0, -1.0, 11.0, -43.0, 0.0, 6.0, -10.0, -10.0, 4.0, 11.0, -10.0, 0.0, 11.0, -5.0, -8.0, 0.0, 10.0, -8.0, 3.0, -4.0, -36.0, -11.0, -4.0, -4.0, -2.0, -7.0, -11.0, -38.0, -11.0, 1.0, -14.0, 18.0, -7.0, -7.0, 21.0, 0.0, -2.0, 0.0, 5.0, 3.0, -4.0, -16.0, -12.0, 15.0, -16.0, 11.0, 16.0, 19.0, 11.0, -2.0, 3.0, -12.0, -8.0, -11.0, -23.0, -17.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, 5.0, -28.0, 0.0, -28.0, 10.0, -6.0, 0.0, -4.0, -10.0, 4.0, 1.0, 0.0, 0.0, 3.0, -12.0, -30.0, -6.0, -4.0, -4.0, 25.0, 19.0, 0.0, -32.0, 0.0, 17.0, 0.0, -30.0, 5.0, -12.0, 0.0, 0.0, -34.0, 67.0, 0.0, 0.0, 33.0, -22.0, 0.0, -79.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 5.0, 0.0, -14.0, 0.0, -20.0, 0.0, 0.0, -50.0, 0.0, 0.0, -12.0, -22.0, -28.0, -8.0, 0.0, 0.0, 38.0, 22.0, 0.0, 20.0, -20.0, 3.0, 0.0, 20.0, 2.0, -96.0, 0.0, 0.0, 0.0, -6.0, 0.0, -36.0, -12.0, 0.0, 0.0, 0.0, -33.0, 0.0, -16.0, 14.0, -8.0, 0.0, -8.0, 5.0, 0.0, -36.0, -48.0, 0.0, 0.0, 18.0, -24.0, 0.0, -20.0, -10.0, -10.0, 4.0, 0.0, 11.0, 0.0, -2.0, -16.0, 0.0, 0.0, 2.0, 0.0, 0.0, -10.0, -28.0, 0.0, 0.0, 0.0, 5.0, 5.0, -4.0, -12.0, 0.0, 3.0, -10.0, -4.0, -42.0, -20.0, 0.0, -22.0, -9.0, 0.0, 0.0, -11.0, -3.0, -2.0, 0.0, -14.0, -26.0, 0.0, -22.0, -59.0, 0.0, -22.0, -10.0, 0.0, -28.0, 0.0, -6.0, 16.0, -8.0, -6.0, -14.0, 0.0, 0.0, 3.0, 0.0, 0.0, -24.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, -13.0, -26.0, -142.0, 0.0, -18.0, -10.0, 15.0, 0.0, -8.0, -18.0, -4.0, 0.0, 5.0, 11.0, 19.0, -20.0, 11.0, 0.0, 1.0, -12.0, 0.0, 3.0, -24.0, 0.0, -16.0, 0.0, 0.0, -22.0, -44.0, -2.0, -12.0, -16.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 14.0, 0.0, 24.0, 5.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 11.0, 12.0, 2.0, 5.0, 0.0, 5.0, 3.0, 13.0, 0.0, 1.0, 13.0, 2.0, 0.0, 6.0, 0.0, 0.0, 6.0, 11.0, 0.0, 0.0, 7.0, 8.0, 68.0, 33.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 11.0, 0.0, 0.0, 0.0, 7.0, 18.0, 6.0, 0.0, 0.0, 14.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 20.0, 8.0, 4.0, 48.0, 0.0, 0.0, 6.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 27.0, 8.0, 0.0, 4.0, 0.0, 7.0, 0.0, 6.0, 0.0, 26.0, 15.0, 0.0, 0.0, 12.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 9.0, 5.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 5.0, 13.0, 13.0, 0.0, 11.0, 0.0, 5.0, 7.0, 0.0, 0.0, 3.0, 0.0, 7.0, 15.0, 0.0, 33.0, 10.0, 11.0, 0.0, 11.0, 0.0, 14.0, 0.0, 4.0, 4.0, 3.0, 4.0, 0.0, 7.0, 3.0, 15.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 17.0, 18.0, 58.0, 68.0, 2.0, 14.0, 0.0, 0.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 5.0, 6.0, 23.0, 0.0, 0.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.982217916382059, "mean_inference_ms": 34.44170664977064, "mean_action_processing_ms": 0.8034991136733208, "mean_env_wait_ms": 2.519723615376252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07963728904724121, "StateBufferConnector_ms": 0.005951404571533203, "ViewRequirementAgentConnector_ms": 0.2685748338699341}, "num_episodes": 22, "episode_return_max": 50.0, "episode_return_min": -44.0, "episode_return_mean": -1.08, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 234.13358577438447, "num_env_steps_trained_throughput_per_sec": 234.13358577438447, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 117581.427, "restore_workers_time_ms": 0.023, "training_step_time_ms": 117581.35, "sample_time_ms": 3228.395, "learn_time_ms": 114311.263, "learn_throughput": 34.992, "synch_weights_time_ms": 33.519}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 129, "trial_id": "4f45b_00000", "date": "2024-08-13_05-03-46", "timestamp": 1723539826, "time_this_iter_s": 17.15379309654236, "time_total_s": 12652.222227334976, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27ef550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12652.222227334976, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 82.38333333333333, "ram_util_percent": 83.55416666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1357687191574504, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.17015091199674226, "policy_loss": -0.003303671823617406, "vf_loss": 0.17345189794780386, "vf_explained_var": 0.012197112974035676, "kl": 0.017167569501287377, "entropy": 0.7240580507371791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.362722482777659, "cur_kl_coeff": 0.00023463964462280267, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1936039375671003, "policy_loss": -0.003620032819293479, "vf_loss": 0.1972208929676242, "vf_explained_var": -0.042051199157402, "kl": 0.01311845542654761, "entropy": 0.6800969391272812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 50.0, "episode_reward_min": -44.0, "episode_reward_mean": -2.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 38.0, "predator_policy": 68.0}, "policy_reward_mean": {"prey_policy": -7.0, "predator_policy": 5.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.0, 22.0, 0.0, 0.0, -7.0, 0.0, 5.0, -7.0, -9.0, 0.0, -25.0, -6.0, -36.0, -4.0, 42.0, 22.0, 14.0, 3.0, 50.0, -44.0, 0.0, 0.0, -24.0, 0.0, -6.0, -8.0, 10.0, -1.0, 11.0, -43.0, 0.0, 6.0, -10.0, -10.0, 4.0, 11.0, -10.0, 0.0, 11.0, -5.0, -8.0, 0.0, 10.0, -8.0, 3.0, -4.0, -36.0, -11.0, -4.0, -4.0, -2.0, -7.0, -11.0, -38.0, -11.0, 1.0, -14.0, 18.0, -7.0, -7.0, 21.0, 0.0, -2.0, 0.0, 5.0, 3.0, -4.0, -16.0, -12.0, 15.0, -16.0, 11.0, 16.0, 19.0, 11.0, -2.0, 3.0, -12.0, -8.0, -11.0, -23.0, -17.0, 6.0, -6.0, 20.0, 0.0, -17.0, -7.0, -1.0, 0.0, 7.0, 9.0, -24.0, 1.0, -5.0, -7.0, -26.0, -7.0, 9.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [33.0, -22.0, 0.0, -79.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, 5.0, 0.0, -14.0, 0.0, -20.0, 0.0, 0.0, -50.0, 0.0, 0.0, -12.0, -22.0, -28.0, -8.0, 0.0, 0.0, 38.0, 22.0, 0.0, 20.0, -20.0, 3.0, 0.0, 20.0, 2.0, -96.0, 0.0, 0.0, 0.0, -6.0, 0.0, -36.0, -12.0, 0.0, 0.0, 0.0, -33.0, 0.0, -16.0, 14.0, -8.0, 0.0, -8.0, 5.0, 0.0, -36.0, -48.0, 0.0, 0.0, 18.0, -24.0, 0.0, -20.0, -10.0, -10.0, 4.0, 0.0, 11.0, 0.0, -2.0, -16.0, 0.0, 0.0, 2.0, 0.0, 0.0, -10.0, -28.0, 0.0, 0.0, 0.0, 5.0, 5.0, -4.0, -12.0, 0.0, 3.0, -10.0, -4.0, -42.0, -20.0, 0.0, -22.0, -9.0, 0.0, 0.0, -11.0, -3.0, -2.0, 0.0, -14.0, -26.0, 0.0, -22.0, -59.0, 0.0, -22.0, -10.0, 0.0, -28.0, 0.0, -6.0, 16.0, -8.0, -6.0, -14.0, 0.0, 0.0, 3.0, 0.0, 0.0, -24.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, -13.0, -26.0, -142.0, 0.0, -18.0, -10.0, 15.0, 0.0, -8.0, -18.0, -4.0, 0.0, 5.0, 11.0, 19.0, -20.0, 11.0, 0.0, 1.0, -12.0, 0.0, 3.0, -24.0, 0.0, -16.0, 0.0, 0.0, -22.0, -44.0, -2.0, -12.0, -16.0, 0.0, 6.0, -16.0, 2.0, 20.0, 0.0, 0.0, 0.0, -14.0, -18.0, -16.0, 0.0, -14.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 9.0, -22.0, -14.0, 0.0, -11.0, 0.0, -64.0, -14.0, 0.0, -54.0, -4.0, 0.0, -14.0, 8.0, 1.0, 0.0, 0.0], "policy_predator_policy_reward": [7.0, 8.0, 68.0, 33.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 11.0, 0.0, 0.0, 0.0, 7.0, 18.0, 6.0, 0.0, 0.0, 14.0, 4.0, 0.0, 4.0, 0.0, 0.0, 0.0, 4.0, 10.0, 0.0, 0.0, 20.0, 8.0, 4.0, 48.0, 0.0, 0.0, 6.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 27.0, 8.0, 0.0, 4.0, 0.0, 7.0, 0.0, 6.0, 0.0, 26.0, 15.0, 0.0, 0.0, 12.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 9.0, 5.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 5.0, 13.0, 13.0, 0.0, 11.0, 0.0, 5.0, 7.0, 0.0, 0.0, 3.0, 0.0, 7.0, 15.0, 0.0, 33.0, 10.0, 11.0, 0.0, 11.0, 0.0, 14.0, 0.0, 4.0, 4.0, 3.0, 4.0, 0.0, 7.0, 3.0, 15.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 17.0, 18.0, 58.0, 68.0, 2.0, 14.0, 0.0, 0.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 5.0, 6.0, 23.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 5.0, 32.0, 27.0, 0.0, 7.0, 9.0, 23.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.521938587494452, "mean_inference_ms": 34.60883349133101, "mean_action_processing_ms": 0.8028804795298622, "mean_env_wait_ms": 2.5058651143588673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0793752670288086, "StateBufferConnector_ms": 0.005728602409362793, "ViewRequirementAgentConnector_ms": 0.2347794771194458}, "num_episodes": 18, "episode_return_max": 50.0, "episode_return_min": -44.0, "episode_return_mean": -2.25, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.83745669019967, "num_env_steps_trained_throughput_per_sec": 214.83745669019967, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 117797.895, "restore_workers_time_ms": 0.021, "training_step_time_ms": 117797.821, "sample_time_ms": 3138.275, "learn_time_ms": 114619.16, "learn_throughput": 34.898, "synch_weights_time_ms": 33.088}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 130, "trial_id": "4f45b_00000", "date": "2024-08-13_05-04-04", "timestamp": 1723539844, "time_this_iter_s": 18.73369312286377, "time_total_s": 12670.95592045784, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1c4e5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12670.95592045784, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 77.82592592592593, "ram_util_percent": 83.07777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6621934793692417, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.36073144363663184, "policy_loss": -0.0024878833312344142, "vf_loss": 0.3632177273325238, "vf_explained_var": 0.01993470901534671, "kl": 0.01022786006274996, "entropy": 0.7818838890582797, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6302308550272038, "cur_kl_coeff": 0.00023463964462280267, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4511316791394844, "policy_loss": -0.005942860123868933, "vf_loss": 0.45707036947330126, "vf_explained_var": -0.001294328737511206, "kl": 0.01776799447006142, "entropy": 0.7458108635491164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "env_runners": {"episode_reward_max": 50.0, "episode_reward_min": -56.0, "episode_reward_mean": -4.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 20.0, "predator_policy": 68.0}, "policy_reward_mean": {"prey_policy": -7.755, "predator_policy": 5.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, -44.0, 0.0, 0.0, -24.0, 0.0, -6.0, -8.0, 10.0, -1.0, 11.0, -43.0, 0.0, 6.0, -10.0, -10.0, 4.0, 11.0, -10.0, 0.0, 11.0, -5.0, -8.0, 0.0, 10.0, -8.0, 3.0, -4.0, -36.0, -11.0, -4.0, -4.0, -2.0, -7.0, -11.0, -38.0, -11.0, 1.0, -14.0, 18.0, -7.0, -7.0, 21.0, 0.0, -2.0, 0.0, 5.0, 3.0, -4.0, -16.0, -12.0, 15.0, -16.0, 11.0, 16.0, 19.0, 11.0, -2.0, 3.0, -12.0, -8.0, -11.0, -23.0, -17.0, 6.0, -6.0, 20.0, 0.0, -17.0, -7.0, -1.0, 0.0, 7.0, 9.0, -24.0, 1.0, -5.0, -7.0, -26.0, -7.0, 9.0, 0.0, -13.0, -20.0, 0.0, -10.0, -8.0, 11.0, 0.0, -1.0, -5.0, -56.0, 1.0, -18.0, -1.0, -6.0, -5.0, -7.0, 0.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.0, 2.0, -96.0, 0.0, 0.0, 0.0, -6.0, 0.0, -36.0, -12.0, 0.0, 0.0, 0.0, -33.0, 0.0, -16.0, 14.0, -8.0, 0.0, -8.0, 5.0, 0.0, -36.0, -48.0, 0.0, 0.0, 18.0, -24.0, 0.0, -20.0, -10.0, -10.0, 4.0, 0.0, 11.0, 0.0, -2.0, -16.0, 0.0, 0.0, 2.0, 0.0, 0.0, -10.0, -28.0, 0.0, 0.0, 0.0, 5.0, 5.0, -4.0, -12.0, 0.0, 3.0, -10.0, -4.0, -42.0, -20.0, 0.0, -22.0, -9.0, 0.0, 0.0, -11.0, -3.0, -2.0, 0.0, -14.0, -26.0, 0.0, -22.0, -59.0, 0.0, -22.0, -10.0, 0.0, -28.0, 0.0, -6.0, 16.0, -8.0, -6.0, -14.0, 0.0, 0.0, 3.0, 0.0, 0.0, -24.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, -13.0, -26.0, -142.0, 0.0, -18.0, -10.0, 15.0, 0.0, -8.0, -18.0, -4.0, 0.0, 5.0, 11.0, 19.0, -20.0, 11.0, 0.0, 1.0, -12.0, 0.0, 3.0, -24.0, 0.0, -16.0, 0.0, 0.0, -22.0, -44.0, -2.0, -12.0, -16.0, 0.0, 6.0, -16.0, 2.0, 20.0, 0.0, 0.0, 0.0, -14.0, -18.0, -16.0, 0.0, -14.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 9.0, -22.0, -14.0, 0.0, -11.0, 0.0, -64.0, -14.0, 0.0, -54.0, -4.0, 0.0, -14.0, 8.0, 1.0, 0.0, 0.0, 0.0, -26.0, -46.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, -30.0, -18.0, 20.0, 0.0, 0.0, 0.0, -2.0, 0.0, -20.0, -39.0, -42.0, 0.0, 1.0, -24.0, -33.0, 0.0, -2.0, 0.0, -12.0, 0.0, -10.0, -18.0, 0.0, 0.0, 0.0, 2.0, 0.0], "policy_predator_policy_reward": [20.0, 8.0, 4.0, 48.0, 0.0, 0.0, 6.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 27.0, 8.0, 0.0, 4.0, 0.0, 7.0, 0.0, 6.0, 0.0, 26.0, 15.0, 0.0, 0.0, 12.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 9.0, 5.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 5.0, 13.0, 13.0, 0.0, 11.0, 0.0, 5.0, 7.0, 0.0, 0.0, 3.0, 0.0, 7.0, 15.0, 0.0, 33.0, 10.0, 11.0, 0.0, 11.0, 0.0, 14.0, 0.0, 4.0, 4.0, 3.0, 4.0, 0.0, 7.0, 3.0, 15.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 17.0, 18.0, 58.0, 68.0, 2.0, 14.0, 0.0, 0.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 5.0, 6.0, 23.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 5.0, 32.0, 27.0, 0.0, 7.0, 9.0, 23.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 1.0, 9.0, 17.0, 0.0, 0.0, 10.0, 0.0, 7.0, 15.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 8.0, 0.0, 25.0, 0.0, 0.0, 19.0, 20.0, 0.0, 1.0, 0.0, 6.0, 0.0, 5.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.434549417662367, "mean_inference_ms": 34.38784689136663, "mean_action_processing_ms": 0.8004597994855086, "mean_env_wait_ms": 2.4910576284771095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005797386169433594, "StateBufferConnector_ms": 0.005533933639526367, "ViewRequirementAgentConnector_ms": 0.20123541355133057}, "num_episodes": 18, "episode_return_max": 50.0, "episode_return_min": -56.0, "episode_return_mean": -4.01, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 208.48353918948604, "num_env_steps_trained_throughput_per_sec": 208.48353918948604, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 2096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2096000, "timers": {"training_iteration_time_ms": 117797.708, "restore_workers_time_ms": 0.02, "training_step_time_ms": 117797.636, "sample_time_ms": 2980.925, "learn_time_ms": 114776.039, "learn_throughput": 34.85, "synch_weights_time_ms": 32.842}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "done": false, "training_iteration": 131, "trial_id": "4f45b_00000", "date": "2024-08-13_05-04-24", "timestamp": 1723539864, "time_this_iter_s": 19.22911810874939, "time_total_s": 12690.18503856659, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27d7940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12690.18503856659, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 81.25185185185185, "ram_util_percent": 83.51851851851852}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3528560480980016, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.18321112389956531, "policy_loss": -0.0022462101133353023, "vf_loss": 0.1854556551576092, "vf_explained_var": 0.0464595944793136, "kl": 0.01073502823179085, "entropy": 0.7521473627872568, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7391882902927815, "cur_kl_coeff": 0.00023463964462280267, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3501806031943363, "policy_loss": -0.0054482352041526055, "vf_loss": 0.35562331688580495, "vf_explained_var": 0.13874093407676333, "kl": 0.023526899314391374, "entropy": 0.6900455337352853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -56.0, "episode_reward_mean": -3.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 68.0}, "policy_reward_mean": {"prey_policy": -6.465, "predator_policy": 4.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 10.0, -8.0, 3.0, -4.0, -36.0, -11.0, -4.0, -4.0, -2.0, -7.0, -11.0, -38.0, -11.0, 1.0, -14.0, 18.0, -7.0, -7.0, 21.0, 0.0, -2.0, 0.0, 5.0, 3.0, -4.0, -16.0, -12.0, 15.0, -16.0, 11.0, 16.0, 19.0, 11.0, -2.0, 3.0, -12.0, -8.0, -11.0, -23.0, -17.0, 6.0, -6.0, 20.0, 0.0, -17.0, -7.0, -1.0, 0.0, 7.0, 9.0, -24.0, 1.0, -5.0, -7.0, -26.0, -7.0, 9.0, 0.0, -13.0, -20.0, 0.0, -10.0, -8.0, 11.0, 0.0, -1.0, -5.0, -56.0, 1.0, -18.0, -1.0, -6.0, -5.0, -7.0, 0.0, 2.0, -15.0, 0.0, 11.0, -5.0, -20.0, -2.0, 0.0, 0.0, 10.0, 0.0, 22.0, 17.0, 9.0, 18.0, -14.0, 22.0, -20.0, 5.0, 0.0, 10.0, 0.0, -10.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 5.0, 5.0, -4.0, -12.0, 0.0, 3.0, -10.0, -4.0, -42.0, -20.0, 0.0, -22.0, -9.0, 0.0, 0.0, -11.0, -3.0, -2.0, 0.0, -14.0, -26.0, 0.0, -22.0, -59.0, 0.0, -22.0, -10.0, 0.0, -28.0, 0.0, -6.0, 16.0, -8.0, -6.0, -14.0, 0.0, 0.0, 3.0, 0.0, 0.0, -24.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, -13.0, -26.0, -142.0, 0.0, -18.0, -10.0, 15.0, 0.0, -8.0, -18.0, -4.0, 0.0, 5.0, 11.0, 19.0, -20.0, 11.0, 0.0, 1.0, -12.0, 0.0, 3.0, -24.0, 0.0, -16.0, 0.0, 0.0, -22.0, -44.0, -2.0, -12.0, -16.0, 0.0, 6.0, -16.0, 2.0, 20.0, 0.0, 0.0, 0.0, -14.0, -18.0, -16.0, 0.0, -14.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 9.0, -22.0, -14.0, 0.0, -11.0, 0.0, -64.0, -14.0, 0.0, -54.0, -4.0, 0.0, -14.0, 8.0, 1.0, 0.0, 0.0, 0.0, -26.0, -46.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, -30.0, -18.0, 20.0, 0.0, 0.0, 0.0, -2.0, 0.0, -20.0, -39.0, -42.0, 0.0, 1.0, -24.0, -33.0, 0.0, -2.0, 0.0, -12.0, 0.0, -10.0, -18.0, 0.0, 0.0, 0.0, 2.0, 0.0, -32.0, 0.0, 0.0, 0.0, 10.0, 0.0, -8.0, -2.0, -20.0, -10.0, -2.0, -9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 22.0, 0.0, 15.0, -8.0, 9.0, 0.0, 9.0, 8.0, -16.0, -14.0, 22.0, 0.0, 0.0, -45.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, -20.0, 0.0, -14.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 5.0, 13.0, 13.0, 0.0, 11.0, 0.0, 5.0, 7.0, 0.0, 0.0, 3.0, 0.0, 7.0, 15.0, 0.0, 33.0, 10.0, 11.0, 0.0, 11.0, 0.0, 14.0, 0.0, 4.0, 4.0, 3.0, 4.0, 0.0, 7.0, 3.0, 15.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 17.0, 18.0, 58.0, 68.0, 2.0, 14.0, 0.0, 0.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 5.0, 6.0, 23.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 5.0, 32.0, 27.0, 0.0, 7.0, 9.0, 23.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 1.0, 9.0, 17.0, 0.0, 0.0, 10.0, 0.0, 7.0, 15.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 8.0, 0.0, 25.0, 0.0, 0.0, 19.0, 20.0, 0.0, 1.0, 0.0, 6.0, 0.0, 5.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 1.0, 0.0, 4.0, 1.0, 1.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 0.0, 1.0, 8.0, 8.0, 0.0, 0.0, 23.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.13040556285587, "mean_inference_ms": 34.15492179783772, "mean_action_processing_ms": 0.7980778685230784, "mean_env_wait_ms": 2.6376693233878132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005447864532470703, "StateBufferConnector_ms": 0.005459427833557129, "ViewRequirementAgentConnector_ms": 0.1980135440826416}, "num_episodes": 23, "episode_return_max": 22.0, "episode_return_min": -56.0, "episode_return_mean": -3.04, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 200.1145159867457, "num_env_steps_trained_throughput_per_sec": 200.1145159867457, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 117987.957, "restore_workers_time_ms": 0.019, "training_step_time_ms": 117987.886, "sample_time_ms": 2971.843, "learn_time_ms": 114970.069, "learn_throughput": 34.792, "synch_weights_time_ms": 38.403}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 132, "trial_id": "4f45b_00000", "date": "2024-08-13_05-04-44", "timestamp": 1723539884, "time_this_iter_s": 20.075406074523926, "time_total_s": 12710.260444641113, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24cdc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12710.260444641113, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 80.65357142857144, "ram_util_percent": 83.23928571428573}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3336051229604338, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.36488683685739204, "policy_loss": -0.0006667560200507521, "vf_loss": 0.3655525293405705, "vf_explained_var": 0.04204256849944907, "kl": 0.006798554725565212, "entropy": 0.726784119246498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5150535560198246, "cur_kl_coeff": 0.0003519594669342041, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.45367710506555836, "policy_loss": -0.004453733169335734, "vf_loss": 0.45812857643301996, "vf_explained_var": 0.0347691900831051, "kl": 0.006426005744815027, "entropy": 0.6359022376398561, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -56.0, "episode_reward_mean": -1.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 68.0}, "policy_reward_mean": {"prey_policy": -5.15, "predator_policy": 4.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, 21.0, 0.0, -2.0, 0.0, 5.0, 3.0, -4.0, -16.0, -12.0, 15.0, -16.0, 11.0, 16.0, 19.0, 11.0, -2.0, 3.0, -12.0, -8.0, -11.0, -23.0, -17.0, 6.0, -6.0, 20.0, 0.0, -17.0, -7.0, -1.0, 0.0, 7.0, 9.0, -24.0, 1.0, -5.0, -7.0, -26.0, -7.0, 9.0, 0.0, -13.0, -20.0, 0.0, -10.0, -8.0, 11.0, 0.0, -1.0, -5.0, -56.0, 1.0, -18.0, -1.0, -6.0, -5.0, -7.0, 0.0, 2.0, -15.0, 0.0, 11.0, -5.0, -20.0, -2.0, 0.0, 0.0, 10.0, 0.0, 22.0, 17.0, 9.0, 18.0, -14.0, 22.0, -20.0, 5.0, 0.0, 10.0, 0.0, -10.0, -7.0, 8.0, 18.0, -7.0, -16.0, 9.0, 6.0, 0.0, -6.0, 20.0, 10.0, -4.0, 4.0, 3.0, -5.0, -8.0, -2.0, 0.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, 0.0, 0.0, 3.0, 0.0, 0.0, -24.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, -13.0, -26.0, -142.0, 0.0, -18.0, -10.0, 15.0, 0.0, -8.0, -18.0, -4.0, 0.0, 5.0, 11.0, 19.0, -20.0, 11.0, 0.0, 1.0, -12.0, 0.0, 3.0, -24.0, 0.0, -16.0, 0.0, 0.0, -22.0, -44.0, -2.0, -12.0, -16.0, 0.0, 6.0, -16.0, 2.0, 20.0, 0.0, 0.0, 0.0, -14.0, -18.0, -16.0, 0.0, -14.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 9.0, -22.0, -14.0, 0.0, -11.0, 0.0, -64.0, -14.0, 0.0, -54.0, -4.0, 0.0, -14.0, 8.0, 1.0, 0.0, 0.0, 0.0, -26.0, -46.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, -30.0, -18.0, 20.0, 0.0, 0.0, 0.0, -2.0, 0.0, -20.0, -39.0, -42.0, 0.0, 1.0, -24.0, -33.0, 0.0, -2.0, 0.0, -12.0, 0.0, -10.0, -18.0, 0.0, 0.0, 0.0, 2.0, 0.0, -32.0, 0.0, 0.0, 0.0, 10.0, 0.0, -8.0, -2.0, -20.0, -10.0, -2.0, -9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 22.0, 0.0, 15.0, -8.0, 9.0, 0.0, 9.0, 8.0, -16.0, -14.0, 22.0, 0.0, 0.0, -45.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, -20.0, 0.0, -14.0, 0.0, 0.0, 5.0, 18.0, 0.0, 10.0, -34.0, -12.0, -10.0, -6.0, 12.0, 9.0, -6.0, 0.0, 0.0, -12.0, 0.0, 0.0, 20.0, 0.0, 4.0, -2.0, -10.0, 5.0, -2.0, 0.0, 3.0, 0.0, -10.0, 0.0, -16.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0], "policy_predator_policy_reward": [0.0, 7.0, 3.0, 15.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 17.0, 18.0, 58.0, 68.0, 2.0, 14.0, 0.0, 0.0, 10.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 3.0, 6.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 5.0, 6.0, 23.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 5.0, 32.0, 27.0, 0.0, 7.0, 9.0, 23.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 1.0, 9.0, 17.0, 0.0, 0.0, 10.0, 0.0, 7.0, 15.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 8.0, 0.0, 25.0, 0.0, 0.0, 19.0, 20.0, 0.0, 1.0, 0.0, 6.0, 0.0, 5.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 1.0, 0.0, 4.0, 1.0, 1.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 0.0, 1.0, 8.0, 8.0, 0.0, 0.0, 23.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 7.0, 2.0, 1.0, 0.0, 0.0, 17.0, 0.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 3.0, 5.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 8.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.248017346116821, "mean_inference_ms": 33.90984472180242, "mean_action_processing_ms": 0.7955151665784789, "mean_env_wait_ms": 2.4569307378018648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007765293121337891, "StateBufferConnector_ms": 0.021141767501831055, "ViewRequirementAgentConnector_ms": 0.17962050437927246}, "num_episodes": 18, "episode_return_max": 22.0, "episode_return_min": -56.0, "episode_return_mean": -1.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 189.96269387703896, "num_env_steps_trained_throughput_per_sec": 189.96269387703896, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 2128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2128000, "timers": {"training_iteration_time_ms": 118257.546, "restore_workers_time_ms": 0.02, "training_step_time_ms": 118257.474, "sample_time_ms": 3070.171, "learn_time_ms": 115142.409, "learn_throughput": 34.74, "synch_weights_time_ms": 36.769}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "done": false, "training_iteration": 133, "trial_id": "4f45b_00000", "date": "2024-08-13_05-05-05", "timestamp": 1723539905, "time_this_iter_s": 21.1111798286438, "time_total_s": 12731.371624469757, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27d7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12731.371624469757, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 81.2, "ram_util_percent": 83.42333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8485883654819595, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.46819496135074623, "policy_loss": -0.00042610834968626185, "vf_loss": 0.46862005055118255, "vf_explained_var": 0.05690053963156604, "kl": 0.006521339345828839, "entropy": 0.7173467930662569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7276258099213164, "cur_kl_coeff": 0.0003519594669342041, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5706604430848664, "policy_loss": -0.008306593506069725, "vf_loss": 0.5789624156661962, "vf_explained_var": 0.06120683979735803, "kl": 0.013121172765689587, "entropy": 0.684762948467618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "env_runners": {"episode_reward_max": 22.0, "episode_reward_min": -56.0, "episode_reward_mean": -2.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -68.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 22.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": -6.0, "predator_policy": 4.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.0, 6.0, -6.0, 20.0, 0.0, -17.0, -7.0, -1.0, 0.0, 7.0, 9.0, -24.0, 1.0, -5.0, -7.0, -26.0, -7.0, 9.0, 0.0, -13.0, -20.0, 0.0, -10.0, -8.0, 11.0, 0.0, -1.0, -5.0, -56.0, 1.0, -18.0, -1.0, -6.0, -5.0, -7.0, 0.0, 2.0, -15.0, 0.0, 11.0, -5.0, -20.0, -2.0, 0.0, 0.0, 10.0, 0.0, 22.0, 17.0, 9.0, 18.0, -14.0, 22.0, -20.0, 5.0, 0.0, 10.0, 0.0, -10.0, -7.0, 8.0, 18.0, -7.0, -16.0, 9.0, 6.0, 0.0, -6.0, 20.0, 10.0, -4.0, 4.0, 3.0, -5.0, -8.0, -2.0, 0.0, -5.0, -5.0, -7.0, -19.0, -4.0, 0.0, -24.0, 0.0, -20.0, 6.0, 14.0, -10.0, 4.0, 0.0, -12.0, -9.0, 0.0, -4.0, 6.0, -17.0, -38.0, -1.0, -14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-12.0, -16.0, 0.0, 6.0, -16.0, 2.0, 20.0, 0.0, 0.0, 0.0, -14.0, -18.0, -16.0, 0.0, -14.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 9.0, -22.0, -14.0, 0.0, -11.0, 0.0, -64.0, -14.0, 0.0, -54.0, -4.0, 0.0, -14.0, 8.0, 1.0, 0.0, 0.0, 0.0, -26.0, -46.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, -30.0, -18.0, 20.0, 0.0, 0.0, 0.0, -2.0, 0.0, -20.0, -39.0, -42.0, 0.0, 1.0, -24.0, -33.0, 0.0, -2.0, 0.0, -12.0, 0.0, -10.0, -18.0, 0.0, 0.0, 0.0, 2.0, 0.0, -32.0, 0.0, 0.0, 0.0, 10.0, 0.0, -8.0, -2.0, -20.0, -10.0, -2.0, -9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 22.0, 0.0, 15.0, -8.0, 9.0, 0.0, 9.0, 8.0, -16.0, -14.0, 22.0, 0.0, 0.0, -45.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, -20.0, 0.0, -14.0, 0.0, 0.0, 5.0, 18.0, 0.0, 10.0, -34.0, -12.0, -10.0, -6.0, 12.0, 9.0, -6.0, 0.0, 0.0, -12.0, 0.0, 0.0, 20.0, 0.0, 4.0, -2.0, -10.0, 5.0, -2.0, 0.0, 3.0, 0.0, -10.0, 0.0, -16.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, -7.0, -8.0, -32.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, -50.0, -10.0, 5.0, -16.0, -32.0, 6.0, 0.0, -9.0, 1.0, -14.0, -7.0, -5.0, 1.0, 0.0, 0.0, -40.0, 1.0, -18.0, 0.0, 0.0, 0.0, -63.0, -13.0, 0.0, -6.0, -16.0, -12.0, -68.0, -18.0, -22.0, 0.0, -28.0, 0.0], "policy_predator_policy_reward": [0.0, 11.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 9.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 7.0, 5.0, 32.0, 27.0, 0.0, 7.0, 9.0, 23.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 1.0, 9.0, 17.0, 0.0, 0.0, 10.0, 0.0, 7.0, 15.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 8.0, 0.0, 25.0, 0.0, 0.0, 19.0, 20.0, 0.0, 1.0, 0.0, 6.0, 0.0, 5.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 1.0, 0.0, 4.0, 1.0, 1.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 0.0, 1.0, 8.0, 8.0, 0.0, 0.0, 23.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 7.0, 2.0, 1.0, 0.0, 0.0, 17.0, 0.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 3.0, 5.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 8.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 8.0, 16.0, 3.0, 4.0, 0.0, 0.0, 0.0, 25.0, 1.0, 5.0, 0.0, 24.0, 4.0, 0.0, 0.0, 7.0, 15.0, 0.0, 11.0, 2.0, 6.0, 0.0, 0.0, 16.0, 11.0, 0.0, 9.0, 0.0, 0.0, 32.0, 40.0, 0.0, 12.0, 3.0, 8.0, 14.0, 34.0, 0.0, 21.0, 0.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.145586136613497, "mean_inference_ms": 33.65706429127134, "mean_action_processing_ms": 0.7935725310243096, "mean_env_wait_ms": 2.4429632968587742, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007899641990661621, "StateBufferConnector_ms": 0.021098852157592773, "ViewRequirementAgentConnector_ms": 0.20307040214538574}, "num_episodes": 22, "episode_return_max": 22.0, "episode_return_min": -56.0, "episode_return_mean": -2.99, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 193.0926524697305, "num_env_steps_trained_throughput_per_sec": 193.0926524697305, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 2144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2144000, "timers": {"training_iteration_time_ms": 118484.66, "restore_workers_time_ms": 0.017, "training_step_time_ms": 118484.595, "sample_time_ms": 3123.34, "learn_time_ms": 115318.537, "learn_throughput": 34.687, "synch_weights_time_ms": 34.951}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "done": false, "training_iteration": 134, "trial_id": "4f45b_00000", "date": "2024-08-13_05-05-26", "timestamp": 1723539926, "time_this_iter_s": 20.767918825149536, "time_total_s": 12752.139543294907, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2488790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12752.139543294907, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 79.31724137931036, "ram_util_percent": 83.25862068965517}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5349180443301087, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4437529442959992, "policy_loss": -0.0018613084931439034, "vf_loss": 0.44561294046804684, "vf_explained_var": 0.07926994508536404, "kl": 0.008388946940754573, "entropy": 0.7432175533481375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.689725410311468, "cur_kl_coeff": 0.0003519594669342041, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4738096224244001, "policy_loss": -0.006459358310642302, "vf_loss": 0.48026125008467013, "vf_explained_var": 0.023110713025249502, "kl": 0.021967602943601245, "entropy": 0.6184711084794746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 23.0, "episode_reward_min": -56.0, "episode_reward_mean": -2.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -68.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 28.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": -5.575, "predator_policy": 4.415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -13.0, -20.0, 0.0, -10.0, -8.0, 11.0, 0.0, -1.0, -5.0, -56.0, 1.0, -18.0, -1.0, -6.0, -5.0, -7.0, 0.0, 2.0, -15.0, 0.0, 11.0, -5.0, -20.0, -2.0, 0.0, 0.0, 10.0, 0.0, 22.0, 17.0, 9.0, 18.0, -14.0, 22.0, -20.0, 5.0, 0.0, 10.0, 0.0, -10.0, -7.0, 8.0, 18.0, -7.0, -16.0, 9.0, 6.0, 0.0, -6.0, 20.0, 10.0, -4.0, 4.0, 3.0, -5.0, -8.0, -2.0, 0.0, -5.0, -5.0, -7.0, -19.0, -4.0, 0.0, -24.0, 0.0, -20.0, 6.0, 14.0, -10.0, 4.0, 0.0, -12.0, -9.0, 0.0, -4.0, 6.0, -17.0, -38.0, -1.0, -14.0, 0.0, -28.0, 0.0, 10.0, 8.0, -11.0, -2.0, 5.0, -14.0, -15.0, 5.0, -9.0, 4.0, 7.0, 15.0, 7.0, -3.0, 23.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, 0.0, -26.0, -46.0, 0.0, 0.0, 0.0, 0.0, -20.0, 0.0, -30.0, -18.0, 20.0, 0.0, 0.0, 0.0, -2.0, 0.0, -20.0, -39.0, -42.0, 0.0, 1.0, -24.0, -33.0, 0.0, -2.0, 0.0, -12.0, 0.0, -10.0, -18.0, 0.0, 0.0, 0.0, 2.0, 0.0, -32.0, 0.0, 0.0, 0.0, 10.0, 0.0, -8.0, -2.0, -20.0, -10.0, -2.0, -9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 22.0, 0.0, 15.0, -8.0, 9.0, 0.0, 9.0, 8.0, -16.0, -14.0, 22.0, 0.0, 0.0, -45.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, -20.0, 0.0, -14.0, 0.0, 0.0, 5.0, 18.0, 0.0, 10.0, -34.0, -12.0, -10.0, -6.0, 12.0, 9.0, -6.0, 0.0, 0.0, -12.0, 0.0, 0.0, 20.0, 0.0, 4.0, -2.0, -10.0, 5.0, -2.0, 0.0, 3.0, 0.0, -10.0, 0.0, -16.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, -7.0, -8.0, -32.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, -50.0, -10.0, 5.0, -16.0, -32.0, 6.0, 0.0, -9.0, 1.0, -14.0, -7.0, -5.0, 1.0, 0.0, 0.0, -40.0, 1.0, -18.0, 0.0, 0.0, 0.0, -63.0, -13.0, 0.0, -6.0, -16.0, -12.0, -68.0, -18.0, -22.0, 0.0, -28.0, 0.0, -8.0, 4.0, -32.0, -14.0, 0.0, -12.0, 0.0, -3.0, 15.0, -14.0, 19.0, -60.0, 0.0, -4.0, 0.0, 5.0, -10.0, -16.0, 0.0, -30.0, 12.0, -18.0, 7.0, -32.0, 4.0, 0.0, -2.0, 8.0, 15.0, 0.0, 0.0, 7.0, 0.0, -6.0, 28.0, -22.0], "policy_predator_policy_reward": [0.0, 0.0, 12.0, 1.0, 9.0, 17.0, 0.0, 0.0, 10.0, 0.0, 7.0, 15.0, 9.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 8.0, 0.0, 25.0, 0.0, 0.0, 19.0, 20.0, 0.0, 1.0, 0.0, 6.0, 0.0, 5.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 1.0, 0.0, 4.0, 1.0, 1.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 0.0, 1.0, 8.0, 8.0, 0.0, 0.0, 23.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 7.0, 2.0, 1.0, 0.0, 0.0, 17.0, 0.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 3.0, 5.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 8.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 8.0, 16.0, 3.0, 4.0, 0.0, 0.0, 0.0, 25.0, 1.0, 5.0, 0.0, 24.0, 4.0, 0.0, 0.0, 7.0, 15.0, 0.0, 11.0, 2.0, 6.0, 0.0, 0.0, 16.0, 11.0, 0.0, 9.0, 0.0, 0.0, 32.0, 40.0, 0.0, 12.0, 3.0, 8.0, 14.0, 34.0, 0.0, 21.0, 0.0, 14.0, 4.0, 0.0, 0.0, 18.0, 6.0, 6.0, 7.0, 6.0, 7.0, 0.0, 30.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 3.0, 9.0, 6.0, 9.0, 2.0, 8.0, 8.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.065203379617474, "mean_inference_ms": 33.45359373863564, "mean_action_processing_ms": 0.792129653075363, "mean_env_wait_ms": 2.4296073050721403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008187294006347656, "StateBufferConnector_ms": 0.021377921104431152, "ViewRequirementAgentConnector_ms": 0.21304643154144287}, "num_episodes": 18, "episode_return_max": 23.0, "episode_return_min": -56.0, "episode_return_mean": -2.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 196.2197455082432, "num_env_steps_trained_throughput_per_sec": 196.2197455082432, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 19922.307, "restore_workers_time_ms": 0.016, "training_step_time_ms": 19922.243, "sample_time_ms": 3060.933, "learn_time_ms": 16823.179, "learn_throughput": 237.767, "synch_weights_time_ms": 31.18}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 135, "trial_id": "4f45b_00000", "date": "2024-08-13_05-05-46", "timestamp": 1723539946, "time_this_iter_s": 20.430143117904663, "time_total_s": 12772.569686412811, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27efdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12772.569686412811, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 81.09655172413794, "ram_util_percent": 83.20344827586207}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5868582560035287, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3362813447991376, "policy_loss": -0.0012424837991289754, "vf_loss": 0.33752260018145, "vf_explained_var": 0.026546614289914488, "kl": 0.007850357488527379, "entropy": 0.7086608435111071, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4339888595714771, "cur_kl_coeff": 0.0005279392004013063, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3752430534664118, "policy_loss": -0.010216511305786236, "vf_loss": 0.38545752065822914, "vf_explained_var": 0.00791804935566332, "kl": 0.0038727161745770768, "entropy": 0.5983888269732238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "env_runners": {"episode_reward_max": 23.0, "episode_reward_min": -38.0, "episode_reward_mean": -1.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -68.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 28.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": -5.155, "predator_policy": 4.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, -15.0, 0.0, 11.0, -5.0, -20.0, -2.0, 0.0, 0.0, 10.0, 0.0, 22.0, 17.0, 9.0, 18.0, -14.0, 22.0, -20.0, 5.0, 0.0, 10.0, 0.0, -10.0, -7.0, 8.0, 18.0, -7.0, -16.0, 9.0, 6.0, 0.0, -6.0, 20.0, 10.0, -4.0, 4.0, 3.0, -5.0, -8.0, -2.0, 0.0, -5.0, -5.0, -7.0, -19.0, -4.0, 0.0, -24.0, 0.0, -20.0, 6.0, 14.0, -10.0, 4.0, 0.0, -12.0, -9.0, 0.0, -4.0, 6.0, -17.0, -38.0, -1.0, -14.0, 0.0, -28.0, 0.0, 10.0, 8.0, -11.0, -2.0, 5.0, -14.0, -15.0, 5.0, -9.0, 4.0, 7.0, 15.0, 7.0, -3.0, 23.0, 0.0, -2.0, 0.0, -5.0, -2.0, 0.0, -7.0, -1.0, -9.0, 1.0, -4.0, 0.0, -1.0, 5.0, -15.0, -3.0, 6.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0, 0.0, -32.0, 0.0, 0.0, 0.0, 10.0, 0.0, -8.0, -2.0, -20.0, -10.0, -2.0, -9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 22.0, 0.0, 15.0, -8.0, 9.0, 0.0, 9.0, 8.0, -16.0, -14.0, 22.0, 0.0, 0.0, -45.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, -20.0, 0.0, -14.0, 0.0, 0.0, 5.0, 18.0, 0.0, 10.0, -34.0, -12.0, -10.0, -6.0, 12.0, 9.0, -6.0, 0.0, 0.0, -12.0, 0.0, 0.0, 20.0, 0.0, 4.0, -2.0, -10.0, 5.0, -2.0, 0.0, 3.0, 0.0, -10.0, 0.0, -16.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, -7.0, -8.0, -32.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, -50.0, -10.0, 5.0, -16.0, -32.0, 6.0, 0.0, -9.0, 1.0, -14.0, -7.0, -5.0, 1.0, 0.0, 0.0, -40.0, 1.0, -18.0, 0.0, 0.0, 0.0, -63.0, -13.0, 0.0, -6.0, -16.0, -12.0, -68.0, -18.0, -22.0, 0.0, -28.0, 0.0, -8.0, 4.0, -32.0, -14.0, 0.0, -12.0, 0.0, -3.0, 15.0, -14.0, 19.0, -60.0, 0.0, -4.0, 0.0, 5.0, -10.0, -16.0, 0.0, -30.0, 12.0, -18.0, 7.0, -32.0, 4.0, 0.0, -2.0, 8.0, 15.0, 0.0, 0.0, 7.0, 0.0, -6.0, 28.0, -22.0, 0.0, -11.0, 0.0, -4.0, 0.0, 0.0, 0.0, -34.0, 5.0, -18.0, 0.0, 0.0, -14.0, 0.0, 0.0, -60.0, -27.0, 0.0, 1.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, -2.0, -17.0, 13.0, 0.0, -48.0, -6.0, 0.0, 0.0, 3.0, 0.0, -4.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 7.0, 0.0, 0.0, 1.0, 0.0, 4.0, 1.0, 1.0, 9.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 4.0, 0.0, 0.0, 0.0, 1.0, 8.0, 8.0, 0.0, 0.0, 23.0, 2.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 7.0, 2.0, 1.0, 0.0, 0.0, 17.0, 0.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 3.0, 5.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 8.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 8.0, 16.0, 3.0, 4.0, 0.0, 0.0, 0.0, 25.0, 1.0, 5.0, 0.0, 24.0, 4.0, 0.0, 0.0, 7.0, 15.0, 0.0, 11.0, 2.0, 6.0, 0.0, 0.0, 16.0, 11.0, 0.0, 9.0, 0.0, 0.0, 32.0, 40.0, 0.0, 12.0, 3.0, 8.0, 14.0, 34.0, 0.0, 21.0, 0.0, 14.0, 4.0, 0.0, 0.0, 18.0, 6.0, 6.0, 7.0, 6.0, 7.0, 0.0, 30.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 3.0, 9.0, 6.0, 9.0, 2.0, 8.0, 8.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 11.0, 6.0, 5.0, 0.0, 2.0, 0.0, 0.0, 12.0, 17.0, 8.0, 3.0, 0.0, 0.0, 7.0, 0.0, 29.0, 30.0, 8.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 9.0, 24.0, 9.0, 3.0, 0.0, 0.0, 3.0, 0.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.985985373666004, "mean_inference_ms": 33.25313469473491, "mean_action_processing_ms": 0.7906690531860022, "mean_env_wait_ms": 2.416365307421324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008589386940002441, "StateBufferConnector_ms": 0.024000048637390137, "ViewRequirementAgentConnector_ms": 0.20870757102966309}, "num_episodes": 18, "episode_return_max": 23.0, "episode_return_min": -38.0, "episode_return_mean": -1.33, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 187.2288657774022, "num_env_steps_trained_throughput_per_sec": 187.2288657774022, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 2176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2176000, "timers": {"training_iteration_time_ms": 19693.909, "restore_workers_time_ms": 0.015, "training_step_time_ms": 19693.85, "sample_time_ms": 2748.132, "learn_time_ms": 16907.441, "learn_throughput": 236.582, "synch_weights_time_ms": 31.231}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "done": false, "training_iteration": 136, "trial_id": "4f45b_00000", "date": "2024-08-13_05-06-08", "timestamp": 1723539968, "time_this_iter_s": 21.40996289253235, "time_total_s": 12793.979649305344, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27f0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12793.979649305344, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 81.90333333333334, "ram_util_percent": 83.44666666666669}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5447543359189122, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2644015742199762, "policy_loss": -0.0006675396492783591, "vf_loss": 0.2650676450477765, "vf_explained_var": 0.0797944551107114, "kl": 0.0093925216483962, "entropy": 0.6833306449115591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7209212195147914, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.41806932070993796, "policy_loss": -0.0038020178115133335, "vf_loss": 0.42186795461605053, "vf_explained_var": 0.06791605731797597, "kl": 0.01281843992562029, "entropy": 0.5346927813278934, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "env_runners": {"episode_reward_max": 34.0, "episode_reward_min": -38.0, "episode_reward_mean": -1.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -68.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 34.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": -5.615, "predator_policy": 4.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, 8.0, 18.0, -7.0, -16.0, 9.0, 6.0, 0.0, -6.0, 20.0, 10.0, -4.0, 4.0, 3.0, -5.0, -8.0, -2.0, 0.0, -5.0, -5.0, -7.0, -19.0, -4.0, 0.0, -24.0, 0.0, -20.0, 6.0, 14.0, -10.0, 4.0, 0.0, -12.0, -9.0, 0.0, -4.0, 6.0, -17.0, -38.0, -1.0, -14.0, 0.0, -28.0, 0.0, 10.0, 8.0, -11.0, -2.0, 5.0, -14.0, -15.0, 5.0, -9.0, 4.0, 7.0, 15.0, 7.0, -3.0, 23.0, 0.0, -2.0, 0.0, -5.0, -2.0, 0.0, -7.0, -1.0, -9.0, 1.0, -4.0, 0.0, -1.0, 5.0, -15.0, -3.0, 6.0, -2.0, -6.0, -11.0, 1.0, 26.0, 3.0, -13.0, 34.0, -15.0, -7.0, -4.0, 2.0, -16.0, -9.0, -15.0, -3.0, 1.0, -1.0, 0.0, 0.0, 0.0, 20.0, -5.0, 23.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, 0.0, 0.0, 5.0, 18.0, 0.0, 10.0, -34.0, -12.0, -10.0, -6.0, 12.0, 9.0, -6.0, 0.0, 0.0, -12.0, 0.0, 0.0, 20.0, 0.0, 4.0, -2.0, -10.0, 5.0, -2.0, 0.0, 3.0, 0.0, -10.0, 0.0, -16.0, 0.0, -4.0, 0.0, 0.0, 0.0, -10.0, -10.0, 0.0, -7.0, -8.0, -32.0, -6.0, 0.0, -8.0, 0.0, 0.0, 0.0, -50.0, -10.0, 5.0, -16.0, -32.0, 6.0, 0.0, -9.0, 1.0, -14.0, -7.0, -5.0, 1.0, 0.0, 0.0, -40.0, 1.0, -18.0, 0.0, 0.0, 0.0, -63.0, -13.0, 0.0, -6.0, -16.0, -12.0, -68.0, -18.0, -22.0, 0.0, -28.0, 0.0, -8.0, 4.0, -32.0, -14.0, 0.0, -12.0, 0.0, -3.0, 15.0, -14.0, 19.0, -60.0, 0.0, -4.0, 0.0, 5.0, -10.0, -16.0, 0.0, -30.0, 12.0, -18.0, 7.0, -32.0, 4.0, 0.0, -2.0, 8.0, 15.0, 0.0, 0.0, 7.0, 0.0, -6.0, 28.0, -22.0, 0.0, -11.0, 0.0, -4.0, 0.0, 0.0, 0.0, -34.0, 5.0, -18.0, 0.0, 0.0, -14.0, 0.0, 0.0, -60.0, -27.0, 0.0, 1.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, -2.0, -17.0, 13.0, 0.0, -48.0, -6.0, 0.0, 0.0, 3.0, 0.0, -4.0, 1.0, -14.0, -22.0, 0.0, 4.0, -7.0, 14.0, 12.0, 3.0, 0.0, 4.0, -34.0, 0.0, 34.0, -26.0, -8.0, 0.0, -14.0, 0.0, -8.0, 4.0, -8.0, -2.0, -32.0, -18.0, 0.0, -26.0, -4.0, 0.0, -20.0, -16.0, 9.0, -16.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -18.0, 0.0, 19.0, 4.0], "policy_predator_policy_reward": [0.0, 7.0, 2.0, 1.0, 0.0, 0.0, 17.0, 0.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 6.0, 3.0, 5.0, 1.0, 0.0, 0.0, 0.0, 1.0, 4.0, 0.0, 8.0, 2.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 8.0, 16.0, 3.0, 4.0, 0.0, 0.0, 0.0, 25.0, 1.0, 5.0, 0.0, 24.0, 4.0, 0.0, 0.0, 7.0, 15.0, 0.0, 11.0, 2.0, 6.0, 0.0, 0.0, 16.0, 11.0, 0.0, 9.0, 0.0, 0.0, 32.0, 40.0, 0.0, 12.0, 3.0, 8.0, 14.0, 34.0, 0.0, 21.0, 0.0, 14.0, 4.0, 0.0, 0.0, 18.0, 6.0, 6.0, 7.0, 6.0, 7.0, 0.0, 30.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 3.0, 9.0, 6.0, 9.0, 2.0, 8.0, 8.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 11.0, 6.0, 5.0, 0.0, 2.0, 0.0, 0.0, 12.0, 17.0, 8.0, 3.0, 0.0, 0.0, 7.0, 0.0, 29.0, 30.0, 8.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 9.0, 24.0, 9.0, 3.0, 0.0, 0.0, 3.0, 0.0, 2.0, 0.0, 7.0, 11.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 17.0, 2.0, 6.0, 1.0, 0.0, 4.0, 3.0, 3.0, 13.0, 5.0, 6.0, 3.0, 14.0, 1.0, 9.0, 8.0, 0.0, 8.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.88890830029152, "mean_inference_ms": 33.00081697204311, "mean_action_processing_ms": 0.7886871529777456, "mean_env_wait_ms": 2.3969314909573063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010908007621765137, "StateBufferConnector_ms": 0.024678587913513184, "ViewRequirementAgentConnector_ms": 0.20481276512145996}, "num_episodes": 23, "episode_return_max": 34.0, "episode_return_min": -38.0, "episode_return_mean": -1.68, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 187.22340837182622, "num_env_steps_trained_throughput_per_sec": 187.22340837182622, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 2192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2192000, "timers": {"training_iteration_time_ms": 19891.687, "restore_workers_time_ms": 0.015, "training_step_time_ms": 19891.628, "sample_time_ms": 2719.622, "learn_time_ms": 17130.312, "learn_throughput": 233.504, "synch_weights_time_ms": 34.075}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "done": false, "training_iteration": 137, "trial_id": "4f45b_00000", "date": "2024-08-13_05-06-29", "timestamp": 1723539989, "time_this_iter_s": 21.428364038467407, "time_total_s": 12815.408013343811, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28305e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12815.408013343811, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 81.45161290322581, "ram_util_percent": 83.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7738606876284673, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.33668482394287824, "policy_loss": -0.002618067136536988, "vf_loss": 0.33930097815947774, "vf_explained_var": 0.025132277749833606, "kl": 0.012237244080216373, "entropy": 0.6686021871036953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6191051107235055, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3139945258334385, "policy_loss": -0.0025590464880532295, "vf_loss": 0.3165519376341426, "vf_explained_var": 0.005945921858782491, "kl": 0.00618974508021027, "entropy": 0.566397867300523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 34.0, "episode_reward_min": -38.0, "episode_reward_mean": -2.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -68.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 34.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": -5.9, "predator_policy": 4.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, 0.0, -24.0, 0.0, -20.0, 6.0, 14.0, -10.0, 4.0, 0.0, -12.0, -9.0, 0.0, -4.0, 6.0, -17.0, -38.0, -1.0, -14.0, 0.0, -28.0, 0.0, 10.0, 8.0, -11.0, -2.0, 5.0, -14.0, -15.0, 5.0, -9.0, 4.0, 7.0, 15.0, 7.0, -3.0, 23.0, 0.0, -2.0, 0.0, -5.0, -2.0, 0.0, -7.0, -1.0, -9.0, 1.0, -4.0, 0.0, -1.0, 5.0, -15.0, -3.0, 6.0, -2.0, -6.0, -11.0, 1.0, 26.0, 3.0, -13.0, 34.0, -15.0, -7.0, -4.0, 2.0, -16.0, -9.0, -15.0, -3.0, 1.0, -1.0, 0.0, 0.0, 0.0, 20.0, -5.0, 23.0, 4.0, -6.0, 2.0, -12.0, 0.0, 6.0, 2.0, -26.0, -14.0, 0.0, 5.0, 8.0, -20.0, 9.0, 0.0, -16.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -8.0, 0.0, 0.0, 0.0, -50.0, -10.0, 5.0, -16.0, -32.0, 6.0, 0.0, -9.0, 1.0, -14.0, -7.0, -5.0, 1.0, 0.0, 0.0, -40.0, 1.0, -18.0, 0.0, 0.0, 0.0, -63.0, -13.0, 0.0, -6.0, -16.0, -12.0, -68.0, -18.0, -22.0, 0.0, -28.0, 0.0, -8.0, 4.0, -32.0, -14.0, 0.0, -12.0, 0.0, -3.0, 15.0, -14.0, 19.0, -60.0, 0.0, -4.0, 0.0, 5.0, -10.0, -16.0, 0.0, -30.0, 12.0, -18.0, 7.0, -32.0, 4.0, 0.0, -2.0, 8.0, 15.0, 0.0, 0.0, 7.0, 0.0, -6.0, 28.0, -22.0, 0.0, -11.0, 0.0, -4.0, 0.0, 0.0, 0.0, -34.0, 5.0, -18.0, 0.0, 0.0, -14.0, 0.0, 0.0, -60.0, -27.0, 0.0, 1.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, -2.0, -17.0, 13.0, 0.0, -48.0, -6.0, 0.0, 0.0, 3.0, 0.0, -4.0, 1.0, -14.0, -22.0, 0.0, 4.0, -7.0, 14.0, 12.0, 3.0, 0.0, 4.0, -34.0, 0.0, 34.0, -26.0, -8.0, 0.0, -14.0, 0.0, -8.0, 4.0, -8.0, -2.0, -32.0, -18.0, 0.0, -26.0, -4.0, 0.0, -20.0, -16.0, 9.0, -16.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -18.0, 0.0, 19.0, 4.0, 4.0, 0.0, -12.0, 0.0, 0.0, -7.0, -6.0, -18.0, 0.0, 0.0, 8.0, -4.0, 0.0, 2.0, -52.0, 0.0, 0.0, -28.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, -14.0, -16.0, 4.0, 5.0, 5.0, -10.0, -42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -12.0, 0.0, 0.0, 1.0, -6.0, 0.0, 0.0], "policy_predator_policy_reward": [4.0, 0.0, 0.0, 0.0, 25.0, 1.0, 5.0, 0.0, 24.0, 4.0, 0.0, 0.0, 7.0, 15.0, 0.0, 11.0, 2.0, 6.0, 0.0, 0.0, 16.0, 11.0, 0.0, 9.0, 0.0, 0.0, 32.0, 40.0, 0.0, 12.0, 3.0, 8.0, 14.0, 34.0, 0.0, 21.0, 0.0, 14.0, 4.0, 0.0, 0.0, 18.0, 6.0, 6.0, 7.0, 6.0, 7.0, 0.0, 30.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 3.0, 9.0, 6.0, 9.0, 2.0, 8.0, 8.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 11.0, 6.0, 5.0, 0.0, 2.0, 0.0, 0.0, 12.0, 17.0, 8.0, 3.0, 0.0, 0.0, 7.0, 0.0, 29.0, 30.0, 8.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 9.0, 24.0, 9.0, 3.0, 0.0, 0.0, 3.0, 0.0, 2.0, 0.0, 7.0, 11.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 17.0, 2.0, 6.0, 1.0, 0.0, 4.0, 3.0, 3.0, 13.0, 5.0, 6.0, 3.0, 14.0, 1.0, 9.0, 8.0, 0.0, 8.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 9.0, 3.0, 9.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 26.0, 0.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 5.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.144009297211813, "mean_inference_ms": 32.410242744453356, "mean_action_processing_ms": 0.7853783086865207, "mean_env_wait_ms": 2.382821000575004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015883803367614746, "StateBufferConnector_ms": 0.008036971092224121, "ViewRequirementAgentConnector_ms": 0.2035987377166748}, "num_episodes": 22, "episode_return_max": 34.0, "episode_return_min": -38.0, "episode_return_mean": -2.05, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 196.50651359697, "num_env_steps_trained_throughput_per_sec": 196.50651359697, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 20011.995, "restore_workers_time_ms": 0.016, "training_step_time_ms": 20011.936, "sample_time_ms": 2759.209, "learn_time_ms": 17208.115, "learn_throughput": 232.448, "synch_weights_time_ms": 37.083}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 138, "trial_id": "4f45b_00000", "date": "2024-08-13_05-06-50", "timestamp": 1723540010, "time_this_iter_s": 20.438941955566406, "time_total_s": 12835.846955299377, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27f0a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12835.846955299377, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 79.25862068965516, "ram_util_percent": 83.29310344827586}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6481648164017806, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.32532518279674666, "policy_loss": -0.003426706372321677, "vf_loss": 0.3287502155789832, "vf_explained_var": 0.02255458122208005, "kl": 0.010688600936546043, "entropy": 0.6868940806893444, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6488799529495062, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4804584618783482, "policy_loss": -0.011560270962645374, "vf_loss": 0.49201571908064934, "vf_explained_var": 0.10137127319340983, "kl": 0.01141094334126888, "entropy": 0.6221418680022003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "env_runners": {"episode_reward_max": 34.0, "episode_reward_min": -28.0, "episode_reward_mean": -1.02, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -74.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 34.0, "predator_policy": 52.0}, "policy_reward_mean": {"prey_policy": -4.67, "predator_policy": 4.16}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.0, 0.0, -28.0, 0.0, 10.0, 8.0, -11.0, -2.0, 5.0, -14.0, -15.0, 5.0, -9.0, 4.0, 7.0, 15.0, 7.0, -3.0, 23.0, 0.0, -2.0, 0.0, -5.0, -2.0, 0.0, -7.0, -1.0, -9.0, 1.0, -4.0, 0.0, -1.0, 5.0, -15.0, -3.0, 6.0, -2.0, -6.0, -11.0, 1.0, 26.0, 3.0, -13.0, 34.0, -15.0, -7.0, -4.0, 2.0, -16.0, -9.0, -15.0, -3.0, 1.0, -1.0, 0.0, 0.0, 0.0, 20.0, -5.0, 23.0, 4.0, -6.0, 2.0, -12.0, 0.0, 6.0, 2.0, -26.0, -14.0, 0.0, 5.0, 8.0, -20.0, 9.0, 0.0, -16.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, -17.0, 12.0, -10.0, -8.0, 0.0, -7.0, -7.0, 0.0, 0.0, 15.0, 1.0, 0.0, -20.0, 16.0, -7.0, 17.0, 0.0, 9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.0, 0.0, -8.0, 4.0, -32.0, -14.0, 0.0, -12.0, 0.0, -3.0, 15.0, -14.0, 19.0, -60.0, 0.0, -4.0, 0.0, 5.0, -10.0, -16.0, 0.0, -30.0, 12.0, -18.0, 7.0, -32.0, 4.0, 0.0, -2.0, 8.0, 15.0, 0.0, 0.0, 7.0, 0.0, -6.0, 28.0, -22.0, 0.0, -11.0, 0.0, -4.0, 0.0, 0.0, 0.0, -34.0, 5.0, -18.0, 0.0, 0.0, -14.0, 0.0, 0.0, -60.0, -27.0, 0.0, 1.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, -2.0, -17.0, 13.0, 0.0, -48.0, -6.0, 0.0, 0.0, 3.0, 0.0, -4.0, 1.0, -14.0, -22.0, 0.0, 4.0, -7.0, 14.0, 12.0, 3.0, 0.0, 4.0, -34.0, 0.0, 34.0, -26.0, -8.0, 0.0, -14.0, 0.0, -8.0, 4.0, -8.0, -2.0, -32.0, -18.0, 0.0, -26.0, -4.0, 0.0, -20.0, -16.0, 9.0, -16.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -18.0, 0.0, 19.0, 4.0, 4.0, 0.0, -12.0, 0.0, 0.0, -7.0, -6.0, -18.0, 0.0, 0.0, 8.0, -4.0, 0.0, 2.0, -52.0, 0.0, 0.0, -28.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, -14.0, -16.0, 4.0, 5.0, 5.0, -10.0, -42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -12.0, 0.0, 0.0, 1.0, -6.0, 0.0, 0.0, -74.0, 5.0, 0.0, 12.0, -8.0, -12.0, -8.0, -14.0, 0.0, 0.0, -44.0, 15.0, -2.0, -17.0, 0.0, 0.0, -2.0, 1.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, -40.0, 10.0, 0.0, -12.0, -8.0, 0.0, 17.0, 0.0, 0.0, 6.0, 0.0], "policy_predator_policy_reward": [0.0, 14.0, 4.0, 0.0, 0.0, 18.0, 6.0, 6.0, 7.0, 6.0, 7.0, 0.0, 30.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 3.0, 9.0, 6.0, 9.0, 2.0, 8.0, 8.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 11.0, 6.0, 5.0, 0.0, 2.0, 0.0, 0.0, 12.0, 17.0, 8.0, 3.0, 0.0, 0.0, 7.0, 0.0, 29.0, 30.0, 8.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 9.0, 24.0, 9.0, 3.0, 0.0, 0.0, 3.0, 0.0, 2.0, 0.0, 7.0, 11.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 17.0, 2.0, 6.0, 1.0, 0.0, 4.0, 3.0, 3.0, 13.0, 5.0, 6.0, 3.0, 14.0, 1.0, 9.0, 8.0, 0.0, 8.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 9.0, 3.0, 9.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 26.0, 0.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 5.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0, 52.0, 0.0, 0.0, 0.0, 6.0, 4.0, 7.0, 7.0, 0.0, 0.0, 17.0, 5.0, 11.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 12.0, 6.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.31158544948613, "mean_inference_ms": 34.351961973180856, "mean_action_processing_ms": 1.08079525975951, "mean_env_wait_ms": 2.371452349368162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1790553331375122, "StateBufferConnector_ms": 0.03939163684844971, "ViewRequirementAgentConnector_ms": 0.432389497756958}, "num_episodes": 18, "episode_return_max": 34.0, "episode_return_min": -28.0, "episode_return_mean": -1.02, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.241261659683206, "num_env_steps_trained_throughput_per_sec": 4.241261659683206, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 2224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2224000, "timers": {"training_iteration_time_ms": 112615.128, "restore_workers_time_ms": 0.016, "training_step_time_ms": 112615.067, "sample_time_ms": 94318.56, "learn_time_ms": 18247.097, "learn_throughput": 219.213, "synch_weights_time_ms": 40.906}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "done": false, "training_iteration": 139, "trial_id": "4f45b_00000", "date": "2024-08-13_05-22-33", "timestamp": 1723540953, "time_this_iter_s": 943.1954131126404, "time_total_s": 13779.042368412018, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27d78b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13779.042368412018, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 98.12727272727274, "ram_util_percent": 83.59545454545454}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3094426810465478, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1801007565417667, "policy_loss": -0.0028748559127389282, "vf_loss": 0.18297296195197357, "vf_explained_var": -0.009608286272281061, "kl": 0.01694133807531381, "entropy": 0.7261833559899104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0250624717227996, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4893475835186937, "policy_loss": -0.006733001669974771, "vf_loss": 0.4960761381993218, "vf_explained_var": 0.24401185790066995, "kl": 0.01684740758770136, "entropy": 0.4772274414855967, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 41.0, "episode_reward_min": -26.0, "episode_reward_mean": 0.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -74.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 41.0, "predator_policy": 52.0}, "policy_reward_mean": {"prey_policy": -3.65, "predator_policy": 3.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 0.0, -2.0, 0.0, -5.0, -2.0, 0.0, -7.0, -1.0, -9.0, 1.0, -4.0, 0.0, -1.0, 5.0, -15.0, -3.0, 6.0, -2.0, -6.0, -11.0, 1.0, 26.0, 3.0, -13.0, 34.0, -15.0, -7.0, -4.0, 2.0, -16.0, -9.0, -15.0, -3.0, 1.0, -1.0, 0.0, 0.0, 0.0, 20.0, -5.0, 23.0, 4.0, -6.0, 2.0, -12.0, 0.0, 6.0, 2.0, -26.0, -14.0, 0.0, 5.0, 8.0, -20.0, 9.0, 0.0, -16.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, -17.0, 12.0, -10.0, -8.0, 0.0, -7.0, -7.0, 0.0, 0.0, 15.0, 1.0, 0.0, -20.0, 16.0, -7.0, 17.0, 0.0, 9.0, 0.0, 5.0, 40.0, 9.0, 11.0, 41.0, -12.0, 13.0, -8.0, -2.0, 0.0, 24.0, 10.0, -3.0, 0.0, 11.0, 5.0, -8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [28.0, -22.0, 0.0, -11.0, 0.0, -4.0, 0.0, 0.0, 0.0, -34.0, 5.0, -18.0, 0.0, 0.0, -14.0, 0.0, 0.0, -60.0, -27.0, 0.0, 1.0, 0.0, 0.0, -14.0, 0.0, 0.0, 0.0, -2.0, -17.0, 13.0, 0.0, -48.0, -6.0, 0.0, 0.0, 3.0, 0.0, -4.0, 1.0, -14.0, -22.0, 0.0, 4.0, -7.0, 14.0, 12.0, 3.0, 0.0, 4.0, -34.0, 0.0, 34.0, -26.0, -8.0, 0.0, -14.0, 0.0, -8.0, 4.0, -8.0, -2.0, -32.0, -18.0, 0.0, -26.0, -4.0, 0.0, -20.0, -16.0, 9.0, -16.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -18.0, 0.0, 19.0, 4.0, 4.0, 0.0, -12.0, 0.0, 0.0, -7.0, -6.0, -18.0, 0.0, 0.0, 8.0, -4.0, 0.0, 2.0, -52.0, 0.0, 0.0, -28.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, -14.0, -16.0, 4.0, 5.0, 5.0, -10.0, -42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -12.0, 0.0, 0.0, 1.0, -6.0, 0.0, 0.0, -74.0, 5.0, 0.0, 12.0, -8.0, -12.0, -8.0, -14.0, 0.0, 0.0, -44.0, 15.0, -2.0, -17.0, 0.0, 0.0, -2.0, 1.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, -40.0, 10.0, 0.0, -12.0, -8.0, 0.0, 17.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 25.0, 15.0, 4.0, 0.0, 27.0, -32.0, 41.0, -2.0, -14.0, -22.0, -7.0, 3.0, 4.0, -32.0, -4.0, 0.0, 0.0, 0.0, 12.0, 0.0, 18.0, -16.0, 0.0, -11.0, 0.0, 0.0, 0.0, 11.0, 5.0, 0.0, -16.0, 0.0], "policy_predator_policy_reward": [6.0, 11.0, 6.0, 5.0, 0.0, 2.0, 0.0, 0.0, 12.0, 17.0, 8.0, 3.0, 0.0, 0.0, 7.0, 0.0, 29.0, 30.0, 8.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 9.0, 24.0, 9.0, 3.0, 0.0, 0.0, 3.0, 0.0, 2.0, 0.0, 7.0, 11.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 17.0, 2.0, 6.0, 1.0, 0.0, 4.0, 3.0, 3.0, 13.0, 5.0, 6.0, 3.0, 14.0, 1.0, 9.0, 8.0, 0.0, 8.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 9.0, 3.0, 9.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 26.0, 0.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 5.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0, 52.0, 0.0, 0.0, 0.0, 6.0, 4.0, 7.0, 7.0, 0.0, 0.0, 17.0, 5.0, 11.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 12.0, 6.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 5.0, 0.0, 5.0, 11.0, 1.0, 1.0, 13.0, 11.0, 5.0, 12.0, 4.0, 16.0, 0.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.824631213601743, "mean_inference_ms": 35.92425174559305, "mean_action_processing_ms": 1.3729301477636908, "mean_env_wait_ms": 2.3597290195045635, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.18225300312042236, "StateBufferConnector_ms": 0.05011618137359619, "ViewRequirementAgentConnector_ms": 0.454204797744751}, "num_episodes": 18, "episode_return_max": 41.0, "episode_return_min": -26.0, "episode_return_mean": 0.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.84110631168693, "num_env_steps_trained_throughput_per_sec": 236.84110631168693, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 112442.152, "restore_workers_time_ms": 0.018, "training_step_time_ms": 112442.091, "sample_time_ms": 94394.963, "learn_time_ms": 17999.034, "learn_throughput": 222.234, "synch_weights_time_ms": 41.347}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 140, "trial_id": "4f45b_00000", "date": "2024-08-13_05-22-50", "timestamp": 1723540970, "time_this_iter_s": 16.95552897453308, "time_total_s": 13795.99789738655, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28305e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13795.99789738655, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 83.0875, "ram_util_percent": 83.49583333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2807492871133108, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.31691495117844726, "policy_loss": -0.0017234401072735194, "vf_loss": 0.31863639532642624, "vf_explained_var": 0.052009183578390294, "kl": 0.01276344240946953, "entropy": 0.7512284912760295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7745845029160143, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5909496080721655, "policy_loss": -0.005581799326168876, "vf_loss": 0.5965288035177364, "vf_explained_var": 0.15140940471301004, "kl": 0.00985270941763146, "entropy": 0.5479723732465158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": 57.0, "episode_reward_min": -51.0, "episode_reward_mean": 2.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -74.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 66.0, "predator_policy": 52.0}, "policy_reward_mean": {"prey_policy": -2.865, "predator_policy": 3.93}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, -13.0, 34.0, -15.0, -7.0, -4.0, 2.0, -16.0, -9.0, -15.0, -3.0, 1.0, -1.0, 0.0, 0.0, 0.0, 20.0, -5.0, 23.0, 4.0, -6.0, 2.0, -12.0, 0.0, 6.0, 2.0, -26.0, -14.0, 0.0, 5.0, 8.0, -20.0, 9.0, 0.0, -16.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, -17.0, 12.0, -10.0, -8.0, 0.0, -7.0, -7.0, 0.0, 0.0, 15.0, 1.0, 0.0, -20.0, 16.0, -7.0, 17.0, 0.0, 9.0, 0.0, 5.0, 40.0, 9.0, 11.0, 41.0, -12.0, 13.0, -8.0, -2.0, 0.0, 24.0, 10.0, -3.0, 0.0, 11.0, 5.0, -8.0, -1.0, -11.0, 35.0, 35.0, -4.0, 23.0, -51.0, 0.0, 10.0, 0.0, -11.0, 10.0, 40.0, -6.0, 11.0, -10.0, 57.0, 2.0, 0.0, -17.0, 2.0, 21.0, 3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, 0.0, 4.0, -34.0, 0.0, 34.0, -26.0, -8.0, 0.0, -14.0, 0.0, -8.0, 4.0, -8.0, -2.0, -32.0, -18.0, 0.0, -26.0, -4.0, 0.0, -20.0, -16.0, 9.0, -16.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, -18.0, 0.0, 19.0, 4.0, 4.0, 0.0, -12.0, 0.0, 0.0, -7.0, -6.0, -18.0, 0.0, 0.0, 8.0, -4.0, 0.0, 2.0, -52.0, 0.0, 0.0, -28.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, -14.0, -16.0, 4.0, 5.0, 5.0, -10.0, -42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -12.0, 0.0, 0.0, 1.0, -6.0, 0.0, 0.0, -74.0, 5.0, 0.0, 12.0, -8.0, -12.0, -8.0, -14.0, 0.0, 0.0, -44.0, 15.0, -2.0, -17.0, 0.0, 0.0, -2.0, 1.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, -40.0, 10.0, 0.0, -12.0, -8.0, 0.0, 17.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 25.0, 15.0, 4.0, 0.0, 27.0, -32.0, 41.0, -2.0, -14.0, -22.0, -7.0, 3.0, 4.0, -32.0, -4.0, 0.0, 0.0, 0.0, 12.0, 0.0, 18.0, -16.0, 0.0, -11.0, 0.0, 0.0, 0.0, 11.0, 5.0, 0.0, -16.0, 0.0, 0.0, -2.0, -18.0, -4.0, 30.0, 5.0, -16.0, 29.0, 5.0, -18.0, 16.0, 7.0, -30.0, -66.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -22.0, 0.0, 10.0, 0.0, 22.0, 13.0, -12.0, 0.0, 0.0, 11.0, -20.0, -7.0, 66.0, -22.0, -9.0, 0.0, 0.0, 0.0, 0.0, -40.0, 0.0, 2.0, 0.0, -24.0, -4.0, 2.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 17.0, 2.0, 6.0, 1.0, 0.0, 4.0, 3.0, 3.0, 13.0, 5.0, 6.0, 3.0, 14.0, 1.0, 9.0, 8.0, 0.0, 8.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 9.0, 3.0, 9.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 26.0, 0.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 5.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0, 52.0, 0.0, 0.0, 0.0, 6.0, 4.0, 7.0, 7.0, 0.0, 0.0, 17.0, 5.0, 11.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 12.0, 6.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 5.0, 0.0, 5.0, 11.0, 1.0, 1.0, 13.0, 11.0, 5.0, 12.0, 4.0, 16.0, 0.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 9.0, 2.0, 0.0, 0.0, 22.0, 0.0, 0.0, 9.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 0.0, 8.0, 9.0, 7.0, 6.0, 0.0, 11.0, 0.0, 0.0, 9.0, 14.0, 0.0, 0.0, 22.0, 23.0, 2.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.424663138768436, "mean_inference_ms": 37.77144355403879, "mean_action_processing_ms": 1.8091206281515904, "mean_env_wait_ms": 2.4997080422906683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.19977569580078125, "StateBufferConnector_ms": 0.04763662815093994, "ViewRequirementAgentConnector_ms": 0.48148155212402344}, "num_episodes": 23, "episode_return_max": 57.0, "episode_return_min": -51.0, "episode_return_mean": 2.13, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.325548374319277, "num_env_steps_trained_throughput_per_sec": 4.325548374319277, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 202997.36, "restore_workers_time_ms": 0.018, "training_step_time_ms": 202997.301, "sample_time_ms": 94463.774, "learn_time_ms": 108483.354, "learn_throughput": 36.872, "synch_weights_time_ms": 44.307}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 141, "trial_id": "4f45b_00000", "date": "2024-08-13_05-38-15", "timestamp": 1723541895, "time_this_iter_s": 924.8420090675354, "time_total_s": 14720.839906454086, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b284af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14720.839906454086, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 95.06, "ram_util_percent": 82.48999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6469566356095056, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48637347018750254, "policy_loss": -0.002190949051103816, "vf_loss": 0.4885632015690799, "vf_explained_var": 0.0044883392159900965, "kl": 0.007779126828455516, "entropy": 0.7419305719711162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9984635420577237, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1257449655778824, "policy_loss": -0.006383166207670771, "vf_loss": 1.1321255847732856, "vf_explained_var": 0.08362223638428581, "kl": 0.009654398543037603, "entropy": 0.47881132053635106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "env_runners": {"episode_reward_max": 242.0, "episode_reward_min": -51.0, "episode_reward_mean": 7.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -74.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 121.0, "predator_policy": 52.0}, "policy_reward_mean": {"prey_policy": 0.38, "predator_policy": 3.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 4.0, -6.0, 2.0, -12.0, 0.0, 6.0, 2.0, -26.0, -14.0, 0.0, 5.0, 8.0, -20.0, 9.0, 0.0, -16.0, 0.0, 0.0, 2.0, 0.0, 6.0, 0.0, -17.0, 12.0, -10.0, -8.0, 0.0, -7.0, -7.0, 0.0, 0.0, 15.0, 1.0, 0.0, -20.0, 16.0, -7.0, 17.0, 0.0, 9.0, 0.0, 5.0, 40.0, 9.0, 11.0, 41.0, -12.0, 13.0, -8.0, -2.0, 0.0, 24.0, 10.0, -3.0, 0.0, 11.0, 5.0, -8.0, -1.0, -11.0, 35.0, 35.0, -4.0, 23.0, -51.0, 0.0, 10.0, 0.0, -11.0, 10.0, 40.0, -6.0, 11.0, -10.0, 57.0, 2.0, 0.0, -17.0, 2.0, 21.0, 3.0, -1.0, -8.0, -8.0, 30.0, 6.0, 19.0, -1.0, 22.0, 0.0, 242.0, -3.0, 29.0, 4.0, 19.0, 35.0, 14.0, 65.0, 69.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [19.0, 4.0, 4.0, 0.0, -12.0, 0.0, 0.0, -7.0, -6.0, -18.0, 0.0, 0.0, 8.0, -4.0, 0.0, 2.0, -52.0, 0.0, 0.0, -28.0, 0.0, 0.0, 0.0, 5.0, 3.0, 0.0, -14.0, -16.0, 4.0, 5.0, 5.0, -10.0, -42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, -12.0, 0.0, 0.0, 1.0, -6.0, 0.0, 0.0, -74.0, 5.0, 0.0, 12.0, -8.0, -12.0, -8.0, -14.0, 0.0, 0.0, -44.0, 15.0, -2.0, -17.0, 0.0, 0.0, -2.0, 1.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, -40.0, 10.0, 0.0, -12.0, -8.0, 0.0, 17.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 25.0, 15.0, 4.0, 0.0, 27.0, -32.0, 41.0, -2.0, -14.0, -22.0, -7.0, 3.0, 4.0, -32.0, -4.0, 0.0, 0.0, 0.0, 12.0, 0.0, 18.0, -16.0, 0.0, -11.0, 0.0, 0.0, 0.0, 11.0, 5.0, 0.0, -16.0, 0.0, 0.0, -2.0, -18.0, -4.0, 30.0, 5.0, -16.0, 29.0, 5.0, -18.0, 16.0, 7.0, -30.0, -66.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -22.0, 0.0, 10.0, 0.0, 22.0, 13.0, -12.0, 0.0, 0.0, 11.0, -20.0, -7.0, 66.0, -22.0, -9.0, 0.0, 0.0, 0.0, 0.0, -40.0, 0.0, 2.0, 0.0, -24.0, -4.0, 2.0, 0.0, -2.0, 0.0, -16.0, 0.0, -17.0, 0.0, 30.0, 3.0, 0.0, 12.0, 7.0, 0.0, -2.0, 22.0, 0.0, 0.0, 0.0, 121.0, 121.0, -6.0, 0.0, -2.0, 30.0, 0.0, 4.0, -2.0, 20.0, 9.0, 16.0, 0.0, -3.0, 0.0, 63.0, 39.0, 30.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 9.0, 3.0, 9.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 26.0, 0.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 5.0, 5.0, 21.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0, 52.0, 0.0, 0.0, 0.0, 6.0, 4.0, 7.0, 7.0, 0.0, 0.0, 17.0, 5.0, 11.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 12.0, 6.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 5.0, 0.0, 5.0, 11.0, 1.0, 1.0, 13.0, 11.0, 5.0, 12.0, 4.0, 16.0, 0.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 9.0, 2.0, 0.0, 0.0, 22.0, 0.0, 0.0, 9.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 0.0, 8.0, 9.0, 7.0, 6.0, 0.0, 11.0, 0.0, 0.0, 9.0, 14.0, 0.0, 0.0, 22.0, 23.0, 2.0, 3.0, 1.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 17.0, 2.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.120438853593354, "mean_inference_ms": 39.2955303482007, "mean_action_processing_ms": 2.0967964362194644, "mean_env_wait_ms": 2.332869906387022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.19768142700195312, "StateBufferConnector_ms": 0.04692244529724121, "ViewRequirementAgentConnector_ms": 0.510191798210144}, "num_episodes": 18, "episode_return_max": 242.0, "episode_return_min": -51.0, "episode_return_mean": 7.74, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 216.9506001425232, "num_env_steps_trained_throughput_per_sec": 216.9506001425232, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 2272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2272000, "timers": {"training_iteration_time_ms": 202842.243, "restore_workers_time_ms": 0.02, "training_step_time_ms": 202842.179, "sample_time_ms": 94470.483, "learn_time_ms": 108326.72, "learn_throughput": 36.925, "synch_weights_time_ms": 38.638}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "done": false, "training_iteration": 142, "trial_id": "4f45b_00000", "date": "2024-08-13_05-38-34", "timestamp": 1723541914, "time_this_iter_s": 18.520073890686035, "time_total_s": 14739.359980344772, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b24cdd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14739.359980344772, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 85.99230769230768, "ram_util_percent": 82.3076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.829113917281388, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.46213977396803557, "policy_loss": -0.003193172893275029, "vf_loss": 0.4653317311985625, "vf_explained_var": 0.016289621560031144, "kl": 0.007780492785384052, "entropy": 0.7053435391534573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1153797261929386, "cur_kl_coeff": 0.00026396960020065314, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7011191532212906, "policy_loss": -0.003595520919632344, "vf_loss": 0.7047136701840572, "vf_explained_var": 0.254686811424437, "kl": 0.0038016732109184886, "entropy": 0.4078796161072595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "env_runners": {"episode_reward_max": 242.0, "episode_reward_min": -51.0, "episode_reward_mean": 10.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -151.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 121.0, "predator_policy": 88.0}, "policy_reward_mean": {"prey_policy": 0.215, "predator_policy": 4.815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -17.0, 12.0, -10.0, -8.0, 0.0, -7.0, -7.0, 0.0, 0.0, 15.0, 1.0, 0.0, -20.0, 16.0, -7.0, 17.0, 0.0, 9.0, 0.0, 5.0, 40.0, 9.0, 11.0, 41.0, -12.0, 13.0, -8.0, -2.0, 0.0, 24.0, 10.0, -3.0, 0.0, 11.0, 5.0, -8.0, -1.0, -11.0, 35.0, 35.0, -4.0, 23.0, -51.0, 0.0, 10.0, 0.0, -11.0, 10.0, 40.0, -6.0, 11.0, -10.0, 57.0, 2.0, 0.0, -17.0, 2.0, 21.0, 3.0, -1.0, -8.0, -8.0, 30.0, 6.0, 19.0, -1.0, 22.0, 0.0, 242.0, -3.0, 29.0, 4.0, 19.0, 35.0, 14.0, 65.0, 69.0, 10.0, 0.0, 27.0, 5.0, 0.0, 8.0, 11.0, 5.0, 0.0, -5.0, -5.0, 24.0, -4.0, 32.0, 28.0, 12.0, 2.0, 15.0, -6.0, 36.0, 0.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -74.0, 5.0, 0.0, 12.0, -8.0, -12.0, -8.0, -14.0, 0.0, 0.0, -44.0, 15.0, -2.0, -17.0, 0.0, 0.0, -2.0, 1.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, -40.0, 10.0, 0.0, -12.0, -8.0, 0.0, 17.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 25.0, 15.0, 4.0, 0.0, 27.0, -32.0, 41.0, -2.0, -14.0, -22.0, -7.0, 3.0, 4.0, -32.0, -4.0, 0.0, 0.0, 0.0, 12.0, 0.0, 18.0, -16.0, 0.0, -11.0, 0.0, 0.0, 0.0, 11.0, 5.0, 0.0, -16.0, 0.0, 0.0, -2.0, -18.0, -4.0, 30.0, 5.0, -16.0, 29.0, 5.0, -18.0, 16.0, 7.0, -30.0, -66.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -22.0, 0.0, 10.0, 0.0, 22.0, 13.0, -12.0, 0.0, 0.0, 11.0, -20.0, -7.0, 66.0, -22.0, -9.0, 0.0, 0.0, 0.0, 0.0, -40.0, 0.0, 2.0, 0.0, -24.0, -4.0, 2.0, 0.0, -2.0, 0.0, -16.0, 0.0, -17.0, 0.0, 30.0, 3.0, 0.0, 12.0, 7.0, 0.0, -2.0, 22.0, 0.0, 0.0, 0.0, 121.0, 121.0, -6.0, 0.0, -2.0, 30.0, 0.0, 4.0, -2.0, 20.0, 9.0, 16.0, 0.0, -3.0, 0.0, 63.0, 39.0, 30.0, 2.0, 0.0, 0.0, 0.0, -21.0, 0.0, 3.0, 0.0, 0.0, 0.0, -26.0, 16.0, 19.0, -151.0, -2.0, -4.0, 0.0, 0.0, -10.0, 0.0, -8.0, -2.0, 7.0, 17.0, 0.0, -11.0, 5.0, 0.0, 6.0, 22.0, 0.0, 12.0, 1.0, -4.0, -22.0, 19.0, 17.0, -63.0, -23.0, 0.0, 0.0, 0.0, 6.0, 3.0], "policy_predator_policy_reward": [0.0, 0.0, 52.0, 0.0, 0.0, 0.0, 6.0, 4.0, 7.0, 7.0, 0.0, 0.0, 17.0, 5.0, 11.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 8.0, 12.0, 6.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 5.0, 0.0, 5.0, 11.0, 1.0, 1.0, 13.0, 11.0, 5.0, 12.0, 4.0, 16.0, 0.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 9.0, 2.0, 0.0, 0.0, 22.0, 0.0, 0.0, 9.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 0.0, 8.0, 9.0, 7.0, 6.0, 0.0, 11.0, 0.0, 0.0, 9.0, 14.0, 0.0, 0.0, 22.0, 23.0, 2.0, 3.0, 1.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 17.0, 2.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 19.0, 29.0, 2.0, 0.0, 0.0, 0.0, 5.0, 13.0, 88.0, 55.0, 9.0, 2.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 6.0, 1.0, 17.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 18.0, 0.0, 40.0, 30.0, 29.0, 0.0, 0.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.60747264126649, "mean_inference_ms": 41.375995891713565, "mean_action_processing_ms": 2.3829710749310715, "mean_env_wait_ms": 2.3221448054866984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.18960916996002197, "StateBufferConnector_ms": 0.047765374183654785, "ViewRequirementAgentConnector_ms": 0.5068408250808716}, "num_episodes": 22, "episode_return_max": 242.0, "episode_return_min": -51.0, "episode_return_mean": 10.06, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 229.2414321451706, "num_env_steps_trained_throughput_per_sec": 229.2414321451706, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 2288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2288000, "timers": {"training_iteration_time_ms": 202481.452, "restore_workers_time_ms": 0.021, "training_step_time_ms": 202481.387, "sample_time_ms": 94399.871, "learn_time_ms": 108038.974, "learn_throughput": 37.024, "synch_weights_time_ms": 36.806}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "done": false, "training_iteration": 143, "trial_id": "4f45b_00000", "date": "2024-08-13_05-38-51", "timestamp": 1723541931, "time_this_iter_s": 17.497916221618652, "time_total_s": 14756.857896566391, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2729f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14756.857896566391, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 81.32083333333333, "ram_util_percent": 80.67916666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4260681889872386, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3664676127373857, "policy_loss": -0.0019385219525752796, "vf_loss": 0.3684047534837937, "vf_explained_var": 0.006731332294524662, "kl": 0.00882723750925651, "entropy": 0.7311062926653201, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.526501745975049, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7903180778617896, "policy_loss": -0.00867933012623951, "vf_loss": 0.7989955713588094, "vf_explained_var": 0.18283572092888847, "kl": 0.013921331140704518, "entropy": 0.3161258969515089, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 242.0, "episode_reward_min": -51.0, "episode_reward_mean": 12.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -151.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 121.0, "predator_policy": 88.0}, "policy_reward_mean": {"prey_policy": 1.475, "predator_policy": 4.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 0.0, 5.0, 40.0, 9.0, 11.0, 41.0, -12.0, 13.0, -8.0, -2.0, 0.0, 24.0, 10.0, -3.0, 0.0, 11.0, 5.0, -8.0, -1.0, -11.0, 35.0, 35.0, -4.0, 23.0, -51.0, 0.0, 10.0, 0.0, -11.0, 10.0, 40.0, -6.0, 11.0, -10.0, 57.0, 2.0, 0.0, -17.0, 2.0, 21.0, 3.0, -1.0, -8.0, -8.0, 30.0, 6.0, 19.0, -1.0, 22.0, 0.0, 242.0, -3.0, 29.0, 4.0, 19.0, 35.0, 14.0, 65.0, 69.0, 10.0, 0.0, 27.0, 5.0, 0.0, 8.0, 11.0, 5.0, 0.0, -5.0, -5.0, 24.0, -4.0, 32.0, 28.0, 12.0, 2.0, 15.0, -6.0, 36.0, 0.0, 10.0, 0.0, 60.0, -4.0, 44.0, -2.0, 21.0, 14.0, -3.0, 0.0, 0.0, -6.0, 12.0, 0.0, 25.0, -2.0, 12.0, 23.0, 30.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 25.0, 15.0, 4.0, 0.0, 27.0, -32.0, 41.0, -2.0, -14.0, -22.0, -7.0, 3.0, 4.0, -32.0, -4.0, 0.0, 0.0, 0.0, 12.0, 0.0, 18.0, -16.0, 0.0, -11.0, 0.0, 0.0, 0.0, 11.0, 5.0, 0.0, -16.0, 0.0, 0.0, -2.0, -18.0, -4.0, 30.0, 5.0, -16.0, 29.0, 5.0, -18.0, 16.0, 7.0, -30.0, -66.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -22.0, 0.0, 10.0, 0.0, 22.0, 13.0, -12.0, 0.0, 0.0, 11.0, -20.0, -7.0, 66.0, -22.0, -9.0, 0.0, 0.0, 0.0, 0.0, -40.0, 0.0, 2.0, 0.0, -24.0, -4.0, 2.0, 0.0, -2.0, 0.0, -16.0, 0.0, -17.0, 0.0, 30.0, 3.0, 0.0, 12.0, 7.0, 0.0, -2.0, 22.0, 0.0, 0.0, 0.0, 121.0, 121.0, -6.0, 0.0, -2.0, 30.0, 0.0, 4.0, -2.0, 20.0, 9.0, 16.0, 0.0, -3.0, 0.0, 63.0, 39.0, 30.0, 2.0, 0.0, 0.0, 0.0, -21.0, 0.0, 3.0, 0.0, 0.0, 0.0, -26.0, 16.0, 19.0, -151.0, -2.0, -4.0, 0.0, 0.0, -10.0, 0.0, -8.0, -2.0, 7.0, 17.0, 0.0, -11.0, 5.0, 0.0, 6.0, 22.0, 0.0, 12.0, 1.0, -4.0, -22.0, 19.0, 17.0, -63.0, -23.0, 0.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 5.0, 44.0, -8.0, 0.0, 44.0, 0.0, 0.0, -4.0, 0.0, 13.0, 0.0, 0.0, -7.0, -6.0, 0.0, -6.0, 0.0, 0.0, -12.0, 0.0, -14.0, 2.0, 0.0, 0.0, 0.0, 25.0, -6.0, 0.0, 0.0, -22.0, 15.0, 3.0, 0.0, 13.0], "policy_predator_policy_reward": [3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 5.0, 0.0, 5.0, 11.0, 1.0, 1.0, 13.0, 11.0, 5.0, 12.0, 4.0, 16.0, 0.0, 2.0, 0.0, 0.0, 12.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 9.0, 2.0, 0.0, 0.0, 22.0, 0.0, 0.0, 9.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 0.0, 8.0, 9.0, 7.0, 6.0, 0.0, 11.0, 0.0, 0.0, 9.0, 14.0, 0.0, 0.0, 22.0, 23.0, 2.0, 3.0, 1.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 17.0, 2.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 19.0, 29.0, 2.0, 0.0, 0.0, 0.0, 5.0, 13.0, 88.0, 55.0, 9.0, 2.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 6.0, 1.0, 17.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 18.0, 0.0, 40.0, 30.0, 29.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 9.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 8.0, 0.0, 2.0, 12.0, 2.0, 8.0, 3.0, 3.0, 0.0, 0.0, 6.0, 0.0, 11.0, 13.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 12.0, 22.0, 5.0, 0.0, 0.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.516885555889912, "mean_inference_ms": 41.28623978326387, "mean_action_processing_ms": 2.371453799295876, "mean_env_wait_ms": 2.310843389909289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02645242214202881, "StateBufferConnector_ms": 0.016932010650634766, "ViewRequirementAgentConnector_ms": 0.33048367500305176}, "num_episodes": 18, "episode_return_max": 242.0, "episode_return_min": -51.0, "episode_return_mean": 12.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.9987784863223, "num_env_steps_trained_throughput_per_sec": 237.9987784863223, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 202090.589, "restore_workers_time_ms": 0.021, "training_step_time_ms": 202090.523, "sample_time_ms": 94459.729, "learn_time_ms": 107589.427, "learn_throughput": 37.178, "synch_weights_time_ms": 35.842}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 144, "trial_id": "4f45b_00000", "date": "2024-08-13_05-39-08", "timestamp": 1723541948, "time_this_iter_s": 16.863348960876465, "time_total_s": 14773.721245527267, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1cb7160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14773.721245527267, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 83.54583333333333, "ram_util_percent": 81.06666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2796190021214662, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.26635537803488435, "policy_loss": -0.001351532041435204, "vf_loss": 0.2677053913174575, "vf_explained_var": 0.00317502324543302, "kl": 0.009705925410512066, "entropy": 0.7487203619782887, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.896823771309758, "cur_kl_coeff": 0.00013198480010032657, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6624218025693187, "policy_loss": -0.0015133639121250738, "vf_loss": 0.6639348156178597, "vf_explained_var": 0.24893913811476773, "kl": 0.0026702347734742136, "entropy": 0.21619859461588833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 242.0, "episode_reward_min": -51.0, "episode_reward_mean": 12.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -153.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 121.0, "predator_policy": 98.0}, "policy_reward_mean": {"prey_policy": 0.795, "predator_policy": 5.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-8.0, -1.0, -11.0, 35.0, 35.0, -4.0, 23.0, -51.0, 0.0, 10.0, 0.0, -11.0, 10.0, 40.0, -6.0, 11.0, -10.0, 57.0, 2.0, 0.0, -17.0, 2.0, 21.0, 3.0, -1.0, -8.0, -8.0, 30.0, 6.0, 19.0, -1.0, 22.0, 0.0, 242.0, -3.0, 29.0, 4.0, 19.0, 35.0, 14.0, 65.0, 69.0, 10.0, 0.0, 27.0, 5.0, 0.0, 8.0, 11.0, 5.0, 0.0, -5.0, -5.0, 24.0, -4.0, 32.0, 28.0, 12.0, 2.0, 15.0, -6.0, 36.0, 0.0, 10.0, 0.0, 60.0, -4.0, 44.0, -2.0, 21.0, 14.0, -3.0, 0.0, 0.0, -6.0, 12.0, 0.0, 25.0, -2.0, 12.0, 23.0, 30.0, 21.0, 77.0, 16.0, 0.0, 71.0, -12.0, -41.0, 0.0, 11.0, -30.0, -3.0, -3.0, -4.0, 33.0, 0.0, -3.0, -4.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.0, 0.0, 0.0, -2.0, -18.0, -4.0, 30.0, 5.0, -16.0, 29.0, 5.0, -18.0, 16.0, 7.0, -30.0, -66.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -22.0, 0.0, 10.0, 0.0, 22.0, 13.0, -12.0, 0.0, 0.0, 11.0, -20.0, -7.0, 66.0, -22.0, -9.0, 0.0, 0.0, 0.0, 0.0, -40.0, 0.0, 2.0, 0.0, -24.0, -4.0, 2.0, 0.0, -2.0, 0.0, -16.0, 0.0, -17.0, 0.0, 30.0, 3.0, 0.0, 12.0, 7.0, 0.0, -2.0, 22.0, 0.0, 0.0, 0.0, 121.0, 121.0, -6.0, 0.0, -2.0, 30.0, 0.0, 4.0, -2.0, 20.0, 9.0, 16.0, 0.0, -3.0, 0.0, 63.0, 39.0, 30.0, 2.0, 0.0, 0.0, 0.0, -21.0, 0.0, 3.0, 0.0, 0.0, 0.0, -26.0, 16.0, 19.0, -151.0, -2.0, -4.0, 0.0, 0.0, -10.0, 0.0, -8.0, -2.0, 7.0, 17.0, 0.0, -11.0, 5.0, 0.0, 6.0, 22.0, 0.0, 12.0, 1.0, -4.0, -22.0, 19.0, 17.0, -63.0, -23.0, 0.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 5.0, 44.0, -8.0, 0.0, 44.0, 0.0, 0.0, -4.0, 0.0, 13.0, 0.0, 0.0, -7.0, -6.0, 0.0, -6.0, 0.0, 0.0, -12.0, 0.0, -14.0, 2.0, 0.0, 0.0, 0.0, 25.0, -6.0, 0.0, 0.0, -22.0, 15.0, 3.0, 0.0, 13.0, 21.0, 0.0, 13.0, 55.0, 7.0, 0.0, 0.0, 0.0, 8.0, 61.0, -24.0, -23.0, 14.0, -153.0, 0.0, 0.0, -7.0, 13.0, -18.0, -57.0, 0.0, -6.0, -2.0, -2.0, -16.0, 2.0, 0.0, 33.0, 0.0, 0.0, 0.0, -6.0, -8.0, 0.0, 0.0, -8.0], "policy_predator_policy_reward": [0.0, 8.0, 1.0, 0.0, 9.0, 2.0, 0.0, 0.0, 22.0, 0.0, 0.0, 9.0, 0.0, 0.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 0.0, 8.0, 9.0, 7.0, 6.0, 0.0, 11.0, 0.0, 0.0, 9.0, 14.0, 0.0, 0.0, 22.0, 23.0, 2.0, 3.0, 1.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 17.0, 2.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 19.0, 29.0, 2.0, 0.0, 0.0, 0.0, 5.0, 13.0, 88.0, 55.0, 9.0, 2.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 6.0, 1.0, 17.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 18.0, 0.0, 40.0, 30.0, 29.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 9.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 8.0, 0.0, 2.0, 12.0, 2.0, 8.0, 3.0, 3.0, 0.0, 0.0, 6.0, 0.0, 11.0, 13.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 12.0, 22.0, 5.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 2.0, 17.0, 18.0, 0.0, 98.0, 0.0, 0.0, 0.0, 5.0, 36.0, 9.0, 3.0, 0.0, 0.0, 1.0, 8.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.427827963237387, "mean_inference_ms": 41.05101484306698, "mean_action_processing_ms": 2.3601114986500233, "mean_env_wait_ms": 2.2996272949687064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023871541023254395, "StateBufferConnector_ms": 0.006052851676940918, "ViewRequirementAgentConnector_ms": 0.34652209281921387}, "num_episodes": 18, "episode_return_max": 242.0, "episode_return_min": -51.0, "episode_return_mean": 12.17, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 237.7727736743279, "num_env_steps_trained_throughput_per_sec": 237.7727736743279, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 201734.336, "restore_workers_time_ms": 0.021, "training_step_time_ms": 201734.27, "sample_time_ms": 94531.683, "learn_time_ms": 107161.685, "learn_throughput": 37.327, "synch_weights_time_ms": 35.525}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 145, "trial_id": "4f45b_00000", "date": "2024-08-13_05-39-25", "timestamp": 1723541965, "time_this_iter_s": 16.889326095581055, "time_total_s": 14790.610571622849, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2830700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14790.610571622849, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 82.85416666666667, "ram_util_percent": 81.28750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7094085890306998, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5436935235189382, "policy_loss": -0.0021622699974893182, "vf_loss": 0.545854461423698, "vf_explained_var": 0.0033010233331609655, "kl": 0.008519026293233006, "entropy": 0.7395856215209557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.314865842276307, "cur_kl_coeff": 6.599240005016329e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8590833026423026, "policy_loss": -0.0034909118579148695, "vf_loss": 0.8625740267927684, "vf_explained_var": 0.06039436188324419, "kl": 0.0028211384588733087, "entropy": 0.2891620614620113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "env_runners": {"episode_reward_max": 242.0, "episode_reward_min": -50.0, "episode_reward_mean": 13.59, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -153.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 121.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": 1.165, "predator_policy": 5.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, -1.0, -8.0, -8.0, 30.0, 6.0, 19.0, -1.0, 22.0, 0.0, 242.0, -3.0, 29.0, 4.0, 19.0, 35.0, 14.0, 65.0, 69.0, 10.0, 0.0, 27.0, 5.0, 0.0, 8.0, 11.0, 5.0, 0.0, -5.0, -5.0, 24.0, -4.0, 32.0, 28.0, 12.0, 2.0, 15.0, -6.0, 36.0, 0.0, 10.0, 0.0, 60.0, -4.0, 44.0, -2.0, 21.0, 14.0, -3.0, 0.0, 0.0, -6.0, 12.0, 0.0, 25.0, -2.0, 12.0, 23.0, 30.0, 21.0, 77.0, 16.0, 0.0, 71.0, -12.0, -41.0, 0.0, 11.0, -30.0, -3.0, -3.0, -4.0, 33.0, 0.0, -3.0, -4.0, -4.0, 56.0, 10.0, 0.0, 7.0, 2.0, 52.0, -5.0, 43.0, 8.0, -50.0, -2.0, 0.0, 4.0, 10.0, -1.0, 64.0, 26.0, 56.0, 3.0, -5.0, -9.0, -10.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, 2.0, 0.0, -2.0, 0.0, -16.0, 0.0, -17.0, 0.0, 30.0, 3.0, 0.0, 12.0, 7.0, 0.0, -2.0, 22.0, 0.0, 0.0, 0.0, 121.0, 121.0, -6.0, 0.0, -2.0, 30.0, 0.0, 4.0, -2.0, 20.0, 9.0, 16.0, 0.0, -3.0, 0.0, 63.0, 39.0, 30.0, 2.0, 0.0, 0.0, 0.0, -21.0, 0.0, 3.0, 0.0, 0.0, 0.0, -26.0, 16.0, 19.0, -151.0, -2.0, -4.0, 0.0, 0.0, -10.0, 0.0, -8.0, -2.0, 7.0, 17.0, 0.0, -11.0, 5.0, 0.0, 6.0, 22.0, 0.0, 12.0, 1.0, -4.0, -22.0, 19.0, 17.0, -63.0, -23.0, 0.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 5.0, 44.0, -8.0, 0.0, 44.0, 0.0, 0.0, -4.0, 0.0, 13.0, 0.0, 0.0, -7.0, -6.0, 0.0, -6.0, 0.0, 0.0, -12.0, 0.0, -14.0, 2.0, 0.0, 0.0, 0.0, 25.0, -6.0, 0.0, 0.0, -22.0, 15.0, 3.0, 0.0, 13.0, 21.0, 0.0, 13.0, 55.0, 7.0, 0.0, 0.0, 0.0, 8.0, 61.0, -24.0, -23.0, 14.0, -153.0, 0.0, 0.0, -7.0, 13.0, -18.0, -57.0, 0.0, -6.0, -2.0, -2.0, -16.0, 2.0, 0.0, 33.0, 0.0, 0.0, 0.0, -6.0, -8.0, 0.0, 0.0, -8.0, 35.0, -3.0, 0.0, 10.0, 0.0, 0.0, -4.0, -4.0, 0.0, 2.0, 54.0, -4.0, -8.0, -4.0, 33.0, 0.0, -2.0, 0.0, -150.0, 0.0, -4.0, 0.0, 0.0, -10.0, -1.0, 0.0, 5.0, 0.0, 0.0, -4.0, 64.0, 0.0, 12.0, 14.0, 0.0, 56.0, 20.0, -34.0, 8.0, -26.0, 0.0, -18.0, 0.0, -60.0, -13.0, 10.0], "policy_predator_policy_reward": [2.0, 3.0, 1.0, 0.0, 0.0, 8.0, 0.0, 9.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 10.0, 0.0, 0.0, 17.0, 2.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 19.0, 29.0, 2.0, 0.0, 0.0, 0.0, 5.0, 13.0, 88.0, 55.0, 9.0, 2.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 6.0, 1.0, 17.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 18.0, 0.0, 40.0, 30.0, 29.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 9.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 8.0, 0.0, 2.0, 12.0, 2.0, 8.0, 3.0, 3.0, 0.0, 0.0, 6.0, 0.0, 11.0, 13.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 12.0, 22.0, 5.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 2.0, 17.0, 18.0, 0.0, 98.0, 0.0, 0.0, 0.0, 5.0, 36.0, 9.0, 3.0, 0.0, 0.0, 1.0, 8.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 2.0, 0.0, 0.0, 7.0, 0.0, 10.0, 10.0, 0.0, 100.0, 0.0, 0.0, 2.0, 4.0, 6.0, 0.0, 5.0, 5.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 4.0, 9.0, 9.0, 0.0, 28.0, 22.0, 0.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.313128889771772, "mean_inference_ms": 40.75974829142583, "mean_action_processing_ms": 2.343361586953931, "mean_env_wait_ms": 2.282991769135936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007534384727478027, "StateBufferConnector_ms": 0.005750417709350586, "ViewRequirementAgentConnector_ms": 0.3189358711242676}, "num_episodes": 23, "episode_return_max": 242.0, "episode_return_min": -50.0, "episode_return_mean": 13.59, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 228.3536442326516, "num_env_steps_trained_throughput_per_sec": 228.3536442326516, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 2336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2336000, "timers": {"training_iteration_time_ms": 201349.583, "restore_workers_time_ms": 0.021, "training_step_time_ms": 201349.52, "sample_time_ms": 94529.094, "learn_time_ms": 106780.587, "learn_throughput": 37.46, "synch_weights_time_ms": 34.965}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "done": false, "training_iteration": 146, "trial_id": "4f45b_00000", "date": "2024-08-13_05-39-43", "timestamp": 1723541983, "time_this_iter_s": 17.56699800491333, "time_total_s": 14808.177569627762, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b283e700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14808.177569627762, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 83.676, "ram_util_percent": 81.212}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.754872306132758, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.42686157076762465, "policy_loss": -0.003396850472892679, "vf_loss": 0.4302564662928008, "vf_explained_var": 0.010207188476330389, "kl": 0.012505815706439705, "entropy": 0.6963512538917481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1932553903845253, "cur_kl_coeff": 3.299620002508164e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7764043704936744, "policy_loss": -0.0019403772050127998, "vf_loss": 0.7783446913003607, "vf_explained_var": 0.17147715542682265, "kl": 0.0017569877547735796, "entropy": 0.3101306366620871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": 80.0, "episode_reward_min": -81.0, "episode_reward_mean": 8.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -153.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 64.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": -1.665, "predator_policy": 6.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, 0.0, 8.0, 11.0, 5.0, 0.0, -5.0, -5.0, 24.0, -4.0, 32.0, 28.0, 12.0, 2.0, 15.0, -6.0, 36.0, 0.0, 10.0, 0.0, 60.0, -4.0, 44.0, -2.0, 21.0, 14.0, -3.0, 0.0, 0.0, -6.0, 12.0, 0.0, 25.0, -2.0, 12.0, 23.0, 30.0, 21.0, 77.0, 16.0, 0.0, 71.0, -12.0, -41.0, 0.0, 11.0, -30.0, -3.0, -3.0, -4.0, 33.0, 0.0, -3.0, -4.0, -4.0, 56.0, 10.0, 0.0, 7.0, 2.0, 52.0, -5.0, 43.0, 8.0, -50.0, -2.0, 0.0, 4.0, 10.0, -1.0, 64.0, 26.0, 56.0, 3.0, -5.0, -9.0, -10.0, 10.0, -23.0, 0.0, 12.0, -8.0, -22.0, 0.0, -21.0, 28.0, 37.0, -1.0, 22.0, -6.0, 13.0, 20.0, 80.0, -10.0, -3.0, 6.0, 16.0, -81.0, 29.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3.0, 0.0, 0.0, 0.0, -26.0, 16.0, 19.0, -151.0, -2.0, -4.0, 0.0, 0.0, -10.0, 0.0, -8.0, -2.0, 7.0, 17.0, 0.0, -11.0, 5.0, 0.0, 6.0, 22.0, 0.0, 12.0, 1.0, -4.0, -22.0, 19.0, 17.0, -63.0, -23.0, 0.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 5.0, 44.0, -8.0, 0.0, 44.0, 0.0, 0.0, -4.0, 0.0, 13.0, 0.0, 0.0, -7.0, -6.0, 0.0, -6.0, 0.0, 0.0, -12.0, 0.0, -14.0, 2.0, 0.0, 0.0, 0.0, 25.0, -6.0, 0.0, 0.0, -22.0, 15.0, 3.0, 0.0, 13.0, 21.0, 0.0, 13.0, 55.0, 7.0, 0.0, 0.0, 0.0, 8.0, 61.0, -24.0, -23.0, 14.0, -153.0, 0.0, 0.0, -7.0, 13.0, -18.0, -57.0, 0.0, -6.0, -2.0, -2.0, -16.0, 2.0, 0.0, 33.0, 0.0, 0.0, 0.0, -6.0, -8.0, 0.0, 0.0, -8.0, 35.0, -3.0, 0.0, 10.0, 0.0, 0.0, -4.0, -4.0, 0.0, 2.0, 54.0, -4.0, -8.0, -4.0, 33.0, 0.0, -2.0, 0.0, -150.0, 0.0, -4.0, 0.0, 0.0, -10.0, -1.0, 0.0, 5.0, 0.0, 0.0, -4.0, 64.0, 0.0, 12.0, 14.0, 0.0, 56.0, 20.0, -34.0, 8.0, -26.0, 0.0, -18.0, 0.0, -60.0, -13.0, 10.0, -10.0, -26.0, 0.0, 0.0, 2.0, -7.0, -16.0, 0.0, -15.0, -20.0, 0.0, 0.0, -42.0, 0.0, 0.0, 28.0, 38.0, -2.0, 0.0, -2.0, 0.0, 22.0, -15.0, 0.0, 0.0, 4.0, 14.0, 6.0, 14.0, 48.0, 0.0, -42.0, -6.0, 0.0, 0.0, 5.0, 8.0, 0.0, -54.0, -58.0, 12.0, 17.0, 0.0, -13.0], "policy_predator_policy_reward": [2.0, 0.0, 0.0, 0.0, 5.0, 13.0, 88.0, 55.0, 9.0, 2.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 6.0, 1.0, 17.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 18.0, 0.0, 40.0, 30.0, 29.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 2.0, 9.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 8.0, 0.0, 2.0, 12.0, 2.0, 8.0, 3.0, 3.0, 0.0, 0.0, 6.0, 0.0, 11.0, 13.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 12.0, 22.0, 5.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 2.0, 17.0, 18.0, 0.0, 98.0, 0.0, 0.0, 0.0, 5.0, 36.0, 9.0, 3.0, 0.0, 0.0, 1.0, 8.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 2.0, 0.0, 0.0, 7.0, 0.0, 10.0, 10.0, 0.0, 100.0, 0.0, 0.0, 2.0, 4.0, 6.0, 0.0, 5.0, 5.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 4.0, 9.0, 9.0, 0.0, 28.0, 22.0, 0.0, 13.0, 13.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 8.0, 0.0, 13.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 18.0, 15.0, 17.0, 3.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 31.0, 0.0, 0.0, 13.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.538720439254412, "mean_inference_ms": 40.14410575267904, "mean_action_processing_ms": 2.3303044847295276, "mean_env_wait_ms": 2.270983397224175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010253667831420898, "StateBufferConnector_ms": 0.004747509956359863, "ViewRequirementAgentConnector_ms": 0.3132357597351074}, "num_episodes": 22, "episode_return_max": 80.0, "episode_return_min": -81.0, "episode_return_mean": 8.74, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 228.05534530338656, "num_env_steps_trained_throughput_per_sec": 228.05534530338656, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 200967.058, "restore_workers_time_ms": 0.021, "training_step_time_ms": 200966.996, "sample_time_ms": 94532.33, "learn_time_ms": 106401.837, "learn_throughput": 37.593, "synch_weights_time_ms": 28.598}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 147, "trial_id": "4f45b_00000", "date": "2024-08-13_05-40-01", "timestamp": 1723542001, "time_this_iter_s": 17.592676162719727, "time_total_s": 14825.770245790482, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2830430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14825.770245790482, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 83.96, "ram_util_percent": 81.568}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.816978141492006, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.50703216540435, "policy_loss": -0.002081313475020348, "vf_loss": 0.5091116617000095, "vf_explained_var": 0.007703669834389258, "kl": 0.01161618614468581, "entropy": 0.6816844792277724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.451358103405231, "cur_kl_coeff": 1.649810001254082e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.007765347388371, "policy_loss": -0.003367607168996184, "vf_loss": 1.0111326135497876, "vf_explained_var": 0.21970758693558828, "kl": 0.020560441827723815, "entropy": 0.4065872958570561, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "env_runners": {"episode_reward_max": 80.0, "episode_reward_min": -81.0, "episode_reward_mean": 9.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -153.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 85.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": -0.715, "predator_policy": 5.605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 0.0, 60.0, -4.0, 44.0, -2.0, 21.0, 14.0, -3.0, 0.0, 0.0, -6.0, 12.0, 0.0, 25.0, -2.0, 12.0, 23.0, 30.0, 21.0, 77.0, 16.0, 0.0, 71.0, -12.0, -41.0, 0.0, 11.0, -30.0, -3.0, -3.0, -4.0, 33.0, 0.0, -3.0, -4.0, -4.0, 56.0, 10.0, 0.0, 7.0, 2.0, 52.0, -5.0, 43.0, 8.0, -50.0, -2.0, 0.0, 4.0, 10.0, -1.0, 64.0, 26.0, 56.0, 3.0, -5.0, -9.0, -10.0, 10.0, -23.0, 0.0, 12.0, -8.0, -22.0, 0.0, -21.0, 28.0, 37.0, -1.0, 22.0, -6.0, 13.0, 20.0, 80.0, -10.0, -3.0, 6.0, 16.0, -81.0, 29.0, 0.0, 16.0, 67.0, 0.0, 35.0, -7.0, 0.0, 5.0, 45.0, 32.0, -3.0, 0.0, 0.0, 16.0, 13.0, -5.0, 10.0, 38.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, 3.0, 0.0, 0.0, 5.0, 44.0, -8.0, 0.0, 44.0, 0.0, 0.0, -4.0, 0.0, 13.0, 0.0, 0.0, -7.0, -6.0, 0.0, -6.0, 0.0, 0.0, -12.0, 0.0, -14.0, 2.0, 0.0, 0.0, 0.0, 25.0, -6.0, 0.0, 0.0, -22.0, 15.0, 3.0, 0.0, 13.0, 21.0, 0.0, 13.0, 55.0, 7.0, 0.0, 0.0, 0.0, 8.0, 61.0, -24.0, -23.0, 14.0, -153.0, 0.0, 0.0, -7.0, 13.0, -18.0, -57.0, 0.0, -6.0, -2.0, -2.0, -16.0, 2.0, 0.0, 33.0, 0.0, 0.0, 0.0, -6.0, -8.0, 0.0, 0.0, -8.0, 35.0, -3.0, 0.0, 10.0, 0.0, 0.0, -4.0, -4.0, 0.0, 2.0, 54.0, -4.0, -8.0, -4.0, 33.0, 0.0, -2.0, 0.0, -150.0, 0.0, -4.0, 0.0, 0.0, -10.0, -1.0, 0.0, 5.0, 0.0, 0.0, -4.0, 64.0, 0.0, 12.0, 14.0, 0.0, 56.0, 20.0, -34.0, 8.0, -26.0, 0.0, -18.0, 0.0, -60.0, -13.0, 10.0, -10.0, -26.0, 0.0, 0.0, 2.0, -7.0, -16.0, 0.0, -15.0, -20.0, 0.0, 0.0, -42.0, 0.0, 0.0, 28.0, 38.0, -2.0, 0.0, -2.0, 0.0, 22.0, -15.0, 0.0, 0.0, 4.0, 14.0, 6.0, 14.0, 48.0, 0.0, -42.0, -6.0, 0.0, 0.0, 5.0, 8.0, 0.0, -54.0, -58.0, 12.0, 17.0, 0.0, -13.0, -12.0, 8.0, 85.0, -90.0, 0.0, 0.0, -12.0, 41.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 39.0, 8.0, -5.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 0.0, -3.0, 0.0, -10.0, 0.0, 4.0, 0.0, -37.0, 0.0, 0.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 0.0, 2.0, 9.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 8.0, 0.0, 2.0, 12.0, 2.0, 8.0, 3.0, 3.0, 0.0, 0.0, 6.0, 0.0, 11.0, 13.0, 0.0, 0.0, 0.0, 0.0, 3.0, 1.0, 12.0, 22.0, 5.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 2.0, 17.0, 18.0, 0.0, 98.0, 0.0, 0.0, 0.0, 5.0, 36.0, 9.0, 3.0, 0.0, 0.0, 1.0, 8.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 2.0, 0.0, 0.0, 7.0, 0.0, 10.0, 10.0, 0.0, 100.0, 0.0, 0.0, 2.0, 4.0, 6.0, 0.0, 5.0, 5.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 4.0, 9.0, 9.0, 0.0, 28.0, 22.0, 0.0, 13.0, 13.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 8.0, 0.0, 13.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 18.0, 15.0, 17.0, 3.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 31.0, 0.0, 0.0, 13.0, 0.0, 20.0, 0.0, 32.0, 40.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 5.0, 3.0, 5.0, 24.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 12.0, 4.0, 0.0, 5.0, 6.0, 0.0, 36.0, 39.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.125472753541096, "mean_inference_ms": 40.253039594126065, "mean_action_processing_ms": 2.3202973489350707, "mean_env_wait_ms": 2.260314878072079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010673165321350098, "StateBufferConnector_ms": 0.004847168922424316, "ViewRequirementAgentConnector_ms": 0.30657362937927246}, "num_episodes": 18, "episode_return_max": 80.0, "episode_return_min": -81.0, "episode_return_mean": 9.78, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 217.8972272652328, "num_env_steps_trained_throughput_per_sec": 217.8972272652328, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 2368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2368000, "timers": {"training_iteration_time_ms": 200767.23, "restore_workers_time_ms": 0.02, "training_step_time_ms": 200767.169, "sample_time_ms": 94468.324, "learn_time_ms": 106271.385, "learn_throughput": 37.639, "synch_weights_time_ms": 23.521}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "done": false, "training_iteration": 148, "trial_id": "4f45b_00000", "date": "2024-08-13_05-40-19", "timestamp": 1723542019, "time_this_iter_s": 18.420991897583008, "time_total_s": 14844.191237688065, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27c69d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14844.191237688065, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 84.1846153846154, "ram_util_percent": 81.61923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7151932334616071, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6665274058463713, "policy_loss": -0.0031024708580127155, "vf_loss": 0.6696282900832273, "vf_explained_var": 0.0031446344322628443, "kl": 0.01012770763032664, "entropy": 0.6416002281128415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.496808204922096, "cur_kl_coeff": 2.474715001881122e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8474407548863421, "policy_loss": -0.005900297805213581, "vf_loss": 0.8533406071246616, "vf_explained_var": -0.1107911194443072, "kl": 0.018085221288716757, "entropy": 0.2882902032089612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "env_runners": {"episode_reward_max": 126.0, "episode_reward_min": -81.0, "episode_reward_mean": 10.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -153.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 106.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": -1.585, "predator_policy": 6.74}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.0, 21.0, 77.0, 16.0, 0.0, 71.0, -12.0, -41.0, 0.0, 11.0, -30.0, -3.0, -3.0, -4.0, 33.0, 0.0, -3.0, -4.0, -4.0, 56.0, 10.0, 0.0, 7.0, 2.0, 52.0, -5.0, 43.0, 8.0, -50.0, -2.0, 0.0, 4.0, 10.0, -1.0, 64.0, 26.0, 56.0, 3.0, -5.0, -9.0, -10.0, 10.0, -23.0, 0.0, 12.0, -8.0, -22.0, 0.0, -21.0, 28.0, 37.0, -1.0, 22.0, -6.0, 13.0, 20.0, 80.0, -10.0, -3.0, 6.0, 16.0, -81.0, 29.0, 0.0, 16.0, 67.0, 0.0, 35.0, -7.0, 0.0, 5.0, 45.0, 32.0, -3.0, 0.0, 0.0, 16.0, 13.0, -5.0, 10.0, 38.0, 0.0, 15.0, -23.0, 33.0, -13.0, 7.0, 30.0, 6.0, 27.0, -2.0, 12.0, 9.0, -24.0, 27.0, 6.0, 3.0, 7.0, 126.0, 11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 13.0, 21.0, 0.0, 13.0, 55.0, 7.0, 0.0, 0.0, 0.0, 8.0, 61.0, -24.0, -23.0, 14.0, -153.0, 0.0, 0.0, -7.0, 13.0, -18.0, -57.0, 0.0, -6.0, -2.0, -2.0, -16.0, 2.0, 0.0, 33.0, 0.0, 0.0, 0.0, -6.0, -8.0, 0.0, 0.0, -8.0, 35.0, -3.0, 0.0, 10.0, 0.0, 0.0, -4.0, -4.0, 0.0, 2.0, 54.0, -4.0, -8.0, -4.0, 33.0, 0.0, -2.0, 0.0, -150.0, 0.0, -4.0, 0.0, 0.0, -10.0, -1.0, 0.0, 5.0, 0.0, 0.0, -4.0, 64.0, 0.0, 12.0, 14.0, 0.0, 56.0, 20.0, -34.0, 8.0, -26.0, 0.0, -18.0, 0.0, -60.0, -13.0, 10.0, -10.0, -26.0, 0.0, 0.0, 2.0, -7.0, -16.0, 0.0, -15.0, -20.0, 0.0, 0.0, -42.0, 0.0, 0.0, 28.0, 38.0, -2.0, 0.0, -2.0, 0.0, 22.0, -15.0, 0.0, 0.0, 4.0, 14.0, 6.0, 14.0, 48.0, 0.0, -42.0, -6.0, 0.0, 0.0, 5.0, 8.0, 0.0, -54.0, -58.0, 12.0, 17.0, 0.0, -13.0, -12.0, 8.0, 85.0, -90.0, 0.0, 0.0, -12.0, 41.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 39.0, 8.0, -5.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 0.0, -3.0, 0.0, -10.0, 0.0, 4.0, 0.0, -37.0, 0.0, 0.0, -3.0, -12.0, -15.0, -20.0, 6.0, 14.0, 0.0, -26.0, 7.0, 0.0, 31.0, -2.0, 0.0, -21.0, -30.0, 0.0, -18.0, 7.0, 12.0, 0.0, -4.0, 6.0, 10.0, -108.0, -55.0, 0.0, 12.0, -12.0, 0.0, 3.0, -7.0, 7.0, 20.0, 106.0, 0.0, -7.0], "policy_predator_policy_reward": [0.0, 17.0, 0.0, 0.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 2.0, 17.0, 18.0, 0.0, 98.0, 0.0, 0.0, 0.0, 5.0, 36.0, 9.0, 3.0, 0.0, 0.0, 1.0, 8.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 4.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 2.0, 0.0, 0.0, 7.0, 0.0, 10.0, 10.0, 0.0, 100.0, 0.0, 0.0, 2.0, 4.0, 6.0, 0.0, 5.0, 5.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 4.0, 9.0, 9.0, 0.0, 28.0, 22.0, 0.0, 13.0, 13.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 8.0, 0.0, 13.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 18.0, 15.0, 17.0, 3.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 31.0, 0.0, 0.0, 13.0, 0.0, 20.0, 0.0, 32.0, 40.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 5.0, 3.0, 5.0, 24.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 12.0, 4.0, 0.0, 5.0, 6.0, 0.0, 36.0, 39.0, 0.0, 0.0, 13.0, 17.0, 0.0, 12.0, 6.0, 7.0, 13.0, 0.0, 0.0, 0.0, 0.0, 1.0, 27.0, 0.0, 0.0, 57.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 74.0, 0.0, 27.0, 55.0, 0.0, 6.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 6.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.039478395415165, "mean_inference_ms": 40.02464788019546, "mean_action_processing_ms": 2.3088918600850445, "mean_env_wait_ms": 2.2490314326265985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010857462882995605, "StateBufferConnector_ms": 0.0042150020599365234, "ViewRequirementAgentConnector_ms": 0.2729395627975464}, "num_episodes": 18, "episode_return_max": 126.0, "episode_return_min": -81.0, "episode_return_mean": 10.31, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.82256098623816, "num_env_steps_trained_throughput_per_sec": 148.82256098623816, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 2384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2384000, "timers": {"training_iteration_time_ms": 109143.435, "restore_workers_time_ms": 0.02, "training_step_time_ms": 109143.377, "sample_time_ms": 2960.741, "learn_time_ms": 106160.268, "learn_throughput": 37.679, "synch_weights_time_ms": 19.899}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "done": false, "training_iteration": 149, "trial_id": "4f45b_00000", "date": "2024-08-13_05-40-46", "timestamp": 1723542046, "time_this_iter_s": 26.973918199539185, "time_total_s": 14871.165155887604, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b284adc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14871.165155887604, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 89.75263157894737, "ram_util_percent": 83.40526315789472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5571690652578596, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3333704281026724, "policy_loss": -0.002737964624440465, "vf_loss": 0.33610674294540854, "vf_explained_var": 0.04001205834762129, "kl": 0.010551042212470184, "entropy": 0.6419897191738956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.39904929936011, "cur_kl_coeff": 2.474715001881122e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48622810566876695, "policy_loss": -0.002970715426586115, "vf_loss": 0.48919878192985106, "vf_explained_var": 0.4853013838094378, "kl": 0.0014689395161849447, "entropy": 0.23618121725068522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 126.0, "episode_reward_min": -81.0, "episode_reward_mean": 10.47, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -150.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 106.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": -1.695, "predator_policy": 6.93}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 52.0, -5.0, 43.0, 8.0, -50.0, -2.0, 0.0, 4.0, 10.0, -1.0, 64.0, 26.0, 56.0, 3.0, -5.0, -9.0, -10.0, 10.0, -23.0, 0.0, 12.0, -8.0, -22.0, 0.0, -21.0, 28.0, 37.0, -1.0, 22.0, -6.0, 13.0, 20.0, 80.0, -10.0, -3.0, 6.0, 16.0, -81.0, 29.0, 0.0, 16.0, 67.0, 0.0, 35.0, -7.0, 0.0, 5.0, 45.0, 32.0, -3.0, 0.0, 0.0, 16.0, 13.0, -5.0, 10.0, 38.0, 0.0, 15.0, -23.0, 33.0, -13.0, 7.0, 30.0, 6.0, 27.0, -2.0, 12.0, 9.0, -24.0, 27.0, 6.0, 3.0, 7.0, 126.0, 11.0, 3.0, -17.0, 13.0, 30.0, 3.0, -1.0, 47.0, -13.0, 14.0, 1.0, 14.0, -7.0, 10.0, 0.0, 2.0, 11.0, -4.0, 35.0, 0.0, 50.0, 28.0, 27.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 2.0, 54.0, -4.0, -8.0, -4.0, 33.0, 0.0, -2.0, 0.0, -150.0, 0.0, -4.0, 0.0, 0.0, -10.0, -1.0, 0.0, 5.0, 0.0, 0.0, -4.0, 64.0, 0.0, 12.0, 14.0, 0.0, 56.0, 20.0, -34.0, 8.0, -26.0, 0.0, -18.0, 0.0, -60.0, -13.0, 10.0, -10.0, -26.0, 0.0, 0.0, 2.0, -7.0, -16.0, 0.0, -15.0, -20.0, 0.0, 0.0, -42.0, 0.0, 0.0, 28.0, 38.0, -2.0, 0.0, -2.0, 0.0, 22.0, -15.0, 0.0, 0.0, 4.0, 14.0, 6.0, 14.0, 48.0, 0.0, -42.0, -6.0, 0.0, 0.0, 5.0, 8.0, 0.0, -54.0, -58.0, 12.0, 17.0, 0.0, -13.0, -12.0, 8.0, 85.0, -90.0, 0.0, 0.0, -12.0, 41.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 39.0, 8.0, -5.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 0.0, -3.0, 0.0, -10.0, 0.0, 4.0, 0.0, -37.0, 0.0, 0.0, -3.0, -12.0, -15.0, -20.0, 6.0, 14.0, 0.0, -26.0, 7.0, 0.0, 31.0, -2.0, 0.0, -21.0, -30.0, 0.0, -18.0, 7.0, 12.0, 0.0, -4.0, 6.0, 10.0, -108.0, -55.0, 0.0, 12.0, -12.0, 0.0, 3.0, -7.0, 7.0, 20.0, 106.0, 0.0, -7.0, -1.0, 0.0, -10.0, -24.0, -6.0, 16.0, 24.0, 6.0, 3.0, 0.0, 0.0, -4.0, -109.0, 12.0, 0.0, -26.0, 0.0, 14.0, 1.0, 0.0, 0.0, 14.0, -21.0, 0.0, 6.0, 0.0, -3.0, -10.0, 2.0, 0.0, 0.0, 0.0, 0.0, -8.0, 3.0, 8.0, 0.0, 0.0, 35.0, 0.0, 0.0, -3.0, 0.0, 7.0, -4.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 2.0, 0.0, 0.0, 7.0, 0.0, 10.0, 10.0, 0.0, 100.0, 0.0, 0.0, 2.0, 4.0, 6.0, 0.0, 5.0, 5.0, 0.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 4.0, 9.0, 9.0, 0.0, 28.0, 22.0, 0.0, 13.0, 13.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 8.0, 0.0, 13.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 18.0, 15.0, 17.0, 3.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 31.0, 0.0, 0.0, 13.0, 0.0, 20.0, 0.0, 32.0, 40.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 5.0, 3.0, 5.0, 24.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 12.0, 4.0, 0.0, 5.0, 6.0, 0.0, 36.0, 39.0, 0.0, 0.0, 13.0, 17.0, 0.0, 12.0, 6.0, 7.0, 13.0, 0.0, 0.0, 0.0, 0.0, 1.0, 27.0, 0.0, 0.0, 57.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 74.0, 0.0, 27.0, 55.0, 0.0, 6.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 6.0, 12.0, 0.0, 4.0, 17.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 66.0, 78.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 4.0, 13.0, 0.0, 0.0, 0.0, 7.0, 4.0, 4.0, 0.0, 17.0, 7.0, 0.0, 0.0, 1.0, 14.0, 14.0, 17.0, 7.0, 13.0, 0.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 15.039245006406167, "mean_inference_ms": 39.36181907722555, "mean_action_processing_ms": 2.4342758125201773, "mean_env_wait_ms": 2.379644444698853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010113000869750977, "StateBufferConnector_ms": 0.004393339157104492, "ViewRequirementAgentConnector_ms": 0.2143310308456421}, "num_episodes": 23, "episode_return_max": 126.0, "episode_return_min": -81.0, "episode_return_mean": 10.47, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 199.1165212696836, "num_env_steps_trained_throughput_per_sec": 199.1165212696836, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 109463.412, "restore_workers_time_ms": 0.018, "training_step_time_ms": 109463.357, "sample_time_ms": 2936.494, "learn_time_ms": 106503.885, "learn_throughput": 37.557, "synch_weights_time_ms": 19.814}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 150, "trial_id": "4f45b_00000", "date": "2024-08-13_05-41-06", "timestamp": 1723542066, "time_this_iter_s": 20.14520812034607, "time_total_s": 14891.31036400795, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b283ef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14891.31036400795, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 85.17857142857143, "ram_util_percent": 83.46785714285713}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4566141454197428, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.41619524741298936, "policy_loss": -0.0009430092128693427, "vf_loss": 0.4171371823222938, "vf_explained_var": 0.034082205901070244, "kl": 0.006872753438726038, "entropy": 0.6659644449198687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4346525812669406, "cur_kl_coeff": 1.237357500940561e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7369424852232138, "policy_loss": -0.0016283495397252776, "vf_loss": 0.7385707917115676, "vf_explained_var": 0.3972206780834803, "kl": 0.0035068441342830403, "entropy": 0.23985373477929484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "env_runners": {"episode_reward_max": 126.0, "episode_reward_min": -81.0, "episode_reward_mean": 12.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -109.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 106.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": -0.205, "predator_policy": 6.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, -23.0, 0.0, 12.0, -8.0, -22.0, 0.0, -21.0, 28.0, 37.0, -1.0, 22.0, -6.0, 13.0, 20.0, 80.0, -10.0, -3.0, 6.0, 16.0, -81.0, 29.0, 0.0, 16.0, 67.0, 0.0, 35.0, -7.0, 0.0, 5.0, 45.0, 32.0, -3.0, 0.0, 0.0, 16.0, 13.0, -5.0, 10.0, 38.0, 0.0, 15.0, -23.0, 33.0, -13.0, 7.0, 30.0, 6.0, 27.0, -2.0, 12.0, 9.0, -24.0, 27.0, 6.0, 3.0, 7.0, 126.0, 11.0, 3.0, -17.0, 13.0, 30.0, 3.0, -1.0, 47.0, -13.0, 14.0, 1.0, 14.0, -7.0, 10.0, 0.0, 2.0, 11.0, -4.0, 35.0, 0.0, 50.0, 28.0, 27.0, -2.0, -4.0, 16.0, 37.0, 56.0, 5.0, 12.0, -7.0, 50.0, 9.0, 25.0, -2.0, 58.0, 16.0, 10.0, 4.0, 32.0, 13.0, 53.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.0, 10.0, -10.0, -26.0, 0.0, 0.0, 2.0, -7.0, -16.0, 0.0, -15.0, -20.0, 0.0, 0.0, -42.0, 0.0, 0.0, 28.0, 38.0, -2.0, 0.0, -2.0, 0.0, 22.0, -15.0, 0.0, 0.0, 4.0, 14.0, 6.0, 14.0, 48.0, 0.0, -42.0, -6.0, 0.0, 0.0, 5.0, 8.0, 0.0, -54.0, -58.0, 12.0, 17.0, 0.0, -13.0, -12.0, 8.0, 85.0, -90.0, 0.0, 0.0, -12.0, 41.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 39.0, 8.0, -5.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 0.0, -3.0, 0.0, -10.0, 0.0, 4.0, 0.0, -37.0, 0.0, 0.0, -3.0, -12.0, -15.0, -20.0, 6.0, 14.0, 0.0, -26.0, 7.0, 0.0, 31.0, -2.0, 0.0, -21.0, -30.0, 0.0, -18.0, 7.0, 12.0, 0.0, -4.0, 6.0, 10.0, -108.0, -55.0, 0.0, 12.0, -12.0, 0.0, 3.0, -7.0, 7.0, 20.0, 106.0, 0.0, -7.0, -1.0, 0.0, -10.0, -24.0, -6.0, 16.0, 24.0, 6.0, 3.0, 0.0, 0.0, -4.0, -109.0, 12.0, 0.0, -26.0, 0.0, 14.0, 1.0, 0.0, 0.0, 14.0, -21.0, 0.0, 6.0, 0.0, -3.0, -10.0, 2.0, 0.0, 0.0, 0.0, 0.0, -8.0, 3.0, 8.0, 0.0, 0.0, 35.0, 0.0, 0.0, -3.0, 0.0, 7.0, -4.0, 0.0, 0.0, -8.0, 0.0, -1.0, 21.0, 16.0, 6.0, 39.0, 0.0, 5.0, 12.0, 0.0, -4.0, -8.0, 0.0, 39.0, -4.0, -17.0, 24.0, -5.0, 0.0, -5.0, 41.0, 16.0, -18.0, 25.0, -18.0, 15.0, 0.0, 4.0, 48.0, -38.0, 0.0, 13.0, 0.0, 43.0], "policy_predator_policy_reward": [0.0, 13.0, 13.0, 0.0, 0.0, 0.0, 10.0, 7.0, 0.0, 8.0, 0.0, 13.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 2.0, 7.0, 9.0, 0.0, 0.0, 0.0, 0.0, 18.0, 15.0, 17.0, 3.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 31.0, 0.0, 0.0, 13.0, 0.0, 20.0, 0.0, 32.0, 40.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 5.0, 3.0, 5.0, 24.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 12.0, 4.0, 0.0, 5.0, 6.0, 0.0, 36.0, 39.0, 0.0, 0.0, 13.0, 17.0, 0.0, 12.0, 6.0, 7.0, 13.0, 0.0, 0.0, 0.0, 0.0, 1.0, 27.0, 0.0, 0.0, 57.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 74.0, 0.0, 27.0, 55.0, 0.0, 6.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 6.0, 12.0, 0.0, 4.0, 17.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 66.0, 78.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 4.0, 13.0, 0.0, 0.0, 0.0, 7.0, 4.0, 4.0, 0.0, 17.0, 7.0, 0.0, 0.0, 1.0, 14.0, 14.0, 17.0, 7.0, 13.0, 0.0, 2.0, 4.0, 0.0, 2.0, 15.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 11.0, 0.0, 2.0, 28.0, 6.0, 0.0, 3.0, 0.0, 0.0, 1.0, 7.0, 2.0, 7.0, 6.0, 0.0, 0.0, 3.0, 19.0, 0.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.85005598495451, "mean_inference_ms": 39.530730768990445, "mean_action_processing_ms": 2.2821118048364952, "mean_env_wait_ms": 2.222337476244249, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009238839149475098, "StateBufferConnector_ms": 0.004781961441040039, "ViewRequirementAgentConnector_ms": 0.19955170154571533}, "num_episodes": 18, "episode_return_max": 126.0, "episode_return_min": -81.0, "episode_return_mean": 12.44, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 180.30610266557704, "num_env_steps_trained_throughput_per_sec": 180.30610266557704, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 2416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2416000, "timers": {"training_iteration_time_ms": 19208.037, "restore_workers_time_ms": 0.022, "training_step_time_ms": 19207.977, "sample_time_ms": 2845.746, "learn_time_ms": 16342.25, "learn_throughput": 244.764, "synch_weights_time_ms": 16.781}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "done": false, "training_iteration": 151, "trial_id": "4f45b_00000", "date": "2024-08-13_05-41-28", "timestamp": 1723542088, "time_this_iter_s": 22.260164976119995, "time_total_s": 14913.57052898407, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2733280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14913.57052898407, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 85.41874999999999, "ram_util_percent": 83.59375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.16105063683378, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2654553750914241, "policy_loss": -0.0015690376533678285, "vf_loss": 0.2670227989821729, "vf_explained_var": 0.027987567772940983, "kl": 0.01031529152143641, "entropy": 0.6463524608069626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9873401752540043, "cur_kl_coeff": 6.186787504702805e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8831821953493452, "policy_loss": -0.005056353345887228, "vf_loss": 0.8882385276849307, "vf_explained_var": 0.6580923900087043, "kl": 0.00461276437876132, "entropy": 0.2129750624614418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "env_runners": {"episode_reward_max": 126.0, "episode_reward_min": -24.0, "episode_reward_mean": 15.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -109.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 106.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": 1.28, "predator_policy": 6.37}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 16.0, 67.0, 0.0, 35.0, -7.0, 0.0, 5.0, 45.0, 32.0, -3.0, 0.0, 0.0, 16.0, 13.0, -5.0, 10.0, 38.0, 0.0, 15.0, -23.0, 33.0, -13.0, 7.0, 30.0, 6.0, 27.0, -2.0, 12.0, 9.0, -24.0, 27.0, 6.0, 3.0, 7.0, 126.0, 11.0, 3.0, -17.0, 13.0, 30.0, 3.0, -1.0, 47.0, -13.0, 14.0, 1.0, 14.0, -7.0, 10.0, 0.0, 2.0, 11.0, -4.0, 35.0, 0.0, 50.0, 28.0, 27.0, -2.0, -4.0, 16.0, 37.0, 56.0, 5.0, 12.0, -7.0, 50.0, 9.0, 25.0, -2.0, 58.0, 16.0, 10.0, 4.0, 32.0, 13.0, 53.0, 0.0, 17.0, -10.0, -1.0, 68.0, 0.0, 0.0, 14.0, 8.0, 6.0, 50.0, 1.0, 7.0, 47.0, 10.0, 0.0, 15.0, 59.0, 24.0, 62.0, 5.0, 2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -13.0, -12.0, 8.0, 85.0, -90.0, 0.0, 0.0, -12.0, 41.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.0, 39.0, 8.0, -5.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 0.0, -3.0, 0.0, -10.0, 0.0, 4.0, 0.0, -37.0, 0.0, 0.0, -3.0, -12.0, -15.0, -20.0, 6.0, 14.0, 0.0, -26.0, 7.0, 0.0, 31.0, -2.0, 0.0, -21.0, -30.0, 0.0, -18.0, 7.0, 12.0, 0.0, -4.0, 6.0, 10.0, -108.0, -55.0, 0.0, 12.0, -12.0, 0.0, 3.0, -7.0, 7.0, 20.0, 106.0, 0.0, -7.0, -1.0, 0.0, -10.0, -24.0, -6.0, 16.0, 24.0, 6.0, 3.0, 0.0, 0.0, -4.0, -109.0, 12.0, 0.0, -26.0, 0.0, 14.0, 1.0, 0.0, 0.0, 14.0, -21.0, 0.0, 6.0, 0.0, -3.0, -10.0, 2.0, 0.0, 0.0, 0.0, 0.0, -8.0, 3.0, 8.0, 0.0, 0.0, 35.0, 0.0, 0.0, -3.0, 0.0, 7.0, -4.0, 0.0, 0.0, -8.0, 0.0, -1.0, 21.0, 16.0, 6.0, 39.0, 0.0, 5.0, 12.0, 0.0, -4.0, -8.0, 0.0, 39.0, -4.0, -17.0, 24.0, -5.0, 0.0, -5.0, 41.0, 16.0, -18.0, 25.0, -18.0, 15.0, 0.0, 4.0, 48.0, -38.0, 0.0, 13.0, 0.0, 43.0, 0.0, 0.0, -3.0, 0.0, -20.0, 0.0, -21.0, -4.0, 0.0, 68.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 0.0, 0.0, 6.0, 27.0, 3.0, -7.0, -4.0, 7.0, 0.0, 0.0, 38.0, -1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 59.0, 24.0, 0.0, 62.0, 0.0, -3.0, -59.0, 0.0, -7.0], "policy_predator_policy_reward": [13.0, 0.0, 20.0, 0.0, 32.0, 40.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 5.0, 3.0, 5.0, 24.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 12.0, 4.0, 0.0, 5.0, 6.0, 0.0, 36.0, 39.0, 0.0, 0.0, 13.0, 17.0, 0.0, 12.0, 6.0, 7.0, 13.0, 0.0, 0.0, 0.0, 0.0, 1.0, 27.0, 0.0, 0.0, 57.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 74.0, 0.0, 27.0, 55.0, 0.0, 6.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 6.0, 12.0, 0.0, 4.0, 17.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 66.0, 78.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 4.0, 13.0, 0.0, 0.0, 0.0, 7.0, 4.0, 4.0, 0.0, 17.0, 7.0, 0.0, 0.0, 1.0, 14.0, 14.0, 17.0, 7.0, 13.0, 0.0, 2.0, 4.0, 0.0, 2.0, 15.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 11.0, 0.0, 2.0, 28.0, 6.0, 0.0, 3.0, 0.0, 0.0, 1.0, 7.0, 2.0, 7.0, 6.0, 0.0, 0.0, 3.0, 19.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 19.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 7.0, 5.0, 0.0, 0.0, 9.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41.0, 26.0, 4.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.751138366505351, "mean_inference_ms": 39.257041417043276, "mean_action_processing_ms": 2.270766940008219, "mean_env_wait_ms": 2.2110635830802665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006185650825500488, "StateBufferConnector_ms": 0.005342364311218262, "ViewRequirementAgentConnector_ms": 0.22034883499145508}, "num_episodes": 22, "episode_return_max": 126.0, "episode_return_min": -24.0, "episode_return_mean": 15.3, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 180.42573623576752, "num_env_steps_trained_throughput_per_sec": 180.42573623576752, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 2432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2432000, "timers": {"training_iteration_time_ms": 19581.277, "restore_workers_time_ms": 0.021, "training_step_time_ms": 19581.222, "sample_time_ms": 2811.842, "learn_time_ms": 16749.113, "learn_throughput": 238.819, "synch_weights_time_ms": 17.408}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "done": false, "training_iteration": 152, "trial_id": "4f45b_00000", "date": "2024-08-13_05-41-51", "timestamp": 1723542111, "time_this_iter_s": 22.24306607246399, "time_total_s": 14935.813595056534, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2733ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14935.813595056534, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 85.67096774193548, "ram_util_percent": 83.55806451612901}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.743984550324382, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5732412231504602, "policy_loss": -0.0030461865600454746, "vf_loss": 0.5762855599974356, "vf_explained_var": 0.012281049117840157, "kl": 0.011821675669301833, "entropy": 0.6360016197596908, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8548815948937936, "cur_kl_coeff": 3.0933937523514023e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8216433401677816, "policy_loss": -0.0020271470745601666, "vf_loss": 0.8236704845947248, "vf_explained_var": 0.24630660950822175, "kl": 0.0036021899306278434, "entropy": 0.2221295092550535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "env_runners": {"episode_reward_max": 126.0, "episode_reward_min": -24.0, "episode_reward_mean": 16.16, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -109.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 106.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": 2.19, "predator_policy": 5.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 15.0, -23.0, 33.0, -13.0, 7.0, 30.0, 6.0, 27.0, -2.0, 12.0, 9.0, -24.0, 27.0, 6.0, 3.0, 7.0, 126.0, 11.0, 3.0, -17.0, 13.0, 30.0, 3.0, -1.0, 47.0, -13.0, 14.0, 1.0, 14.0, -7.0, 10.0, 0.0, 2.0, 11.0, -4.0, 35.0, 0.0, 50.0, 28.0, 27.0, -2.0, -4.0, 16.0, 37.0, 56.0, 5.0, 12.0, -7.0, 50.0, 9.0, 25.0, -2.0, 58.0, 16.0, 10.0, 4.0, 32.0, 13.0, 53.0, 0.0, 17.0, -10.0, -1.0, 68.0, 0.0, 0.0, 14.0, 8.0, 6.0, 50.0, 1.0, 7.0, 47.0, 10.0, 0.0, 15.0, 59.0, 24.0, 62.0, 5.0, 2.0, 0.0, 49.0, 14.0, 18.0, 83.0, -10.0, 24.0, 17.0, 69.0, 14.0, 8.0, -2.0, -21.0, 17.0, 42.0, 12.0, -4.0, 18.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -3.0, -12.0, -15.0, -20.0, 6.0, 14.0, 0.0, -26.0, 7.0, 0.0, 31.0, -2.0, 0.0, -21.0, -30.0, 0.0, -18.0, 7.0, 12.0, 0.0, -4.0, 6.0, 10.0, -108.0, -55.0, 0.0, 12.0, -12.0, 0.0, 3.0, -7.0, 7.0, 20.0, 106.0, 0.0, -7.0, -1.0, 0.0, -10.0, -24.0, -6.0, 16.0, 24.0, 6.0, 3.0, 0.0, 0.0, -4.0, -109.0, 12.0, 0.0, -26.0, 0.0, 14.0, 1.0, 0.0, 0.0, 14.0, -21.0, 0.0, 6.0, 0.0, -3.0, -10.0, 2.0, 0.0, 0.0, 0.0, 0.0, -8.0, 3.0, 8.0, 0.0, 0.0, 35.0, 0.0, 0.0, -3.0, 0.0, 7.0, -4.0, 0.0, 0.0, -8.0, 0.0, -1.0, 21.0, 16.0, 6.0, 39.0, 0.0, 5.0, 12.0, 0.0, -4.0, -8.0, 0.0, 39.0, -4.0, -17.0, 24.0, -5.0, 0.0, -5.0, 41.0, 16.0, -18.0, 25.0, -18.0, 15.0, 0.0, 4.0, 48.0, -38.0, 0.0, 13.0, 0.0, 43.0, 0.0, 0.0, -3.0, 0.0, -20.0, 0.0, -21.0, -4.0, 0.0, 68.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 0.0, 0.0, 6.0, 27.0, 3.0, -7.0, -4.0, 7.0, 0.0, 0.0, 38.0, -1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 59.0, 24.0, 0.0, 62.0, 0.0, -3.0, -59.0, 0.0, -7.0, -25.0, 11.0, 18.0, 0.0, 12.0, 0.0, 1.0, 13.0, -4.0, 23.0, -18.0, -2.0, 21.0, -2.0, 0.0, 17.0, -2.0, 70.0, 0.0, 14.0, 0.0, 3.0, 0.0, -11.0, -14.0, -14.0, 17.0, 0.0, -6.0, 45.0, 22.0, -20.0, -10.0, 0.0, 18.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 13.0, 17.0, 0.0, 12.0, 6.0, 7.0, 13.0, 0.0, 0.0, 0.0, 0.0, 1.0, 27.0, 0.0, 0.0, 57.0, 0.0, 9.0, 0.0, 0.0, 0.0, 7.0, 74.0, 0.0, 27.0, 55.0, 0.0, 6.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 6.0, 12.0, 0.0, 4.0, 17.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 66.0, 78.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 4.0, 13.0, 0.0, 0.0, 0.0, 7.0, 4.0, 4.0, 0.0, 17.0, 7.0, 0.0, 0.0, 1.0, 14.0, 14.0, 17.0, 7.0, 13.0, 0.0, 2.0, 4.0, 0.0, 2.0, 15.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 11.0, 0.0, 2.0, 28.0, 6.0, 0.0, 3.0, 0.0, 0.0, 1.0, 7.0, 2.0, 7.0, 6.0, 0.0, 0.0, 3.0, 19.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 19.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 7.0, 5.0, 0.0, 0.0, 9.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41.0, 26.0, 4.0, 5.0, 0.0, 14.0, 0.0, 31.0, 0.0, 2.0, 4.0, 0.0, 26.0, 38.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 9.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 8.0, 2.0, 5.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.669944013205201, "mean_inference_ms": 39.04172752456248, "mean_action_processing_ms": 2.2601126194324057, "mean_env_wait_ms": 2.20040762040919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007759571075439453, "StateBufferConnector_ms": 0.005501985549926758, "ViewRequirementAgentConnector_ms": 0.21586787700653076}, "num_episodes": 18, "episode_return_max": 126.0, "episode_return_min": -24.0, "episode_return_mean": 16.16, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 168.84853394571178, "num_env_steps_trained_throughput_per_sec": 168.84853394571178, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 2448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2448000, "timers": {"training_iteration_time_ms": 20205.379, "restore_workers_time_ms": 0.02, "training_step_time_ms": 20205.324, "sample_time_ms": 2816.917, "learn_time_ms": 17367.886, "learn_throughput": 230.31, "synch_weights_time_ms": 17.599}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "done": false, "training_iteration": 153, "trial_id": "4f45b_00000", "date": "2024-08-13_05-42-15", "timestamp": 1723542135, "time_this_iter_s": 23.76206088066101, "time_total_s": 14959.575655937195, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27d7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14959.575655937195, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 86.54705882352943, "ram_util_percent": 83.51764705882351}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0875271159032036, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3610073912080636, "policy_loss": -0.003716808492958388, "vf_loss": 2.3647225744509823, "vf_explained_var": 0.0014379272700617554, "kl": 0.010422304458230938, "entropy": 0.6388644580487852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8309732871238515, "cur_kl_coeff": 1.5466968761757012e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.206656070960262, "policy_loss": -0.0008392068355408296, "vf_loss": 2.2074952796022727, "vf_explained_var": -0.25832551610532895, "kl": 0.005344648411996197, "entropy": 0.3886099877969298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "env_runners": {"episode_reward_max": 83.0, "episode_reward_min": -557.0, "episode_reward_mean": 4.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 70.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -8.065, "predator_policy": 10.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, 3.0, -17.0, 13.0, 30.0, 3.0, -1.0, 47.0, -13.0, 14.0, 1.0, 14.0, -7.0, 10.0, 0.0, 2.0, 11.0, -4.0, 35.0, 0.0, 50.0, 28.0, 27.0, -2.0, -4.0, 16.0, 37.0, 56.0, 5.0, 12.0, -7.0, 50.0, 9.0, 25.0, -2.0, 58.0, 16.0, 10.0, 4.0, 32.0, 13.0, 53.0, 0.0, 17.0, -10.0, -1.0, 68.0, 0.0, 0.0, 14.0, 8.0, 6.0, 50.0, 1.0, 7.0, 47.0, 10.0, 0.0, 15.0, 59.0, 24.0, 62.0, 5.0, 2.0, 0.0, 49.0, 14.0, 18.0, 83.0, -10.0, 24.0, 17.0, 69.0, 14.0, 8.0, -2.0, -21.0, 17.0, 42.0, 12.0, -4.0, 18.0, 35.0, 52.0, 41.0, -557.0, 28.0, 0.0, 37.0, -15.0, 14.0, 1.0, 0.0, -8.0, 32.0, 11.0, 36.0, -188.0, 2.0, -399.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -7.0, -1.0, 0.0, -10.0, -24.0, -6.0, 16.0, 24.0, 6.0, 3.0, 0.0, 0.0, -4.0, -109.0, 12.0, 0.0, -26.0, 0.0, 14.0, 1.0, 0.0, 0.0, 14.0, -21.0, 0.0, 6.0, 0.0, -3.0, -10.0, 2.0, 0.0, 0.0, 0.0, 0.0, -8.0, 3.0, 8.0, 0.0, 0.0, 35.0, 0.0, 0.0, -3.0, 0.0, 7.0, -4.0, 0.0, 0.0, -8.0, 0.0, -1.0, 21.0, 16.0, 6.0, 39.0, 0.0, 5.0, 12.0, 0.0, -4.0, -8.0, 0.0, 39.0, -4.0, -17.0, 24.0, -5.0, 0.0, -5.0, 41.0, 16.0, -18.0, 25.0, -18.0, 15.0, 0.0, 4.0, 48.0, -38.0, 0.0, 13.0, 0.0, 43.0, 0.0, 0.0, -3.0, 0.0, -20.0, 0.0, -21.0, -4.0, 0.0, 68.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 0.0, 0.0, 6.0, 27.0, 3.0, -7.0, -4.0, 7.0, 0.0, 0.0, 38.0, -1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 59.0, 24.0, 0.0, 62.0, 0.0, -3.0, -59.0, 0.0, -7.0, -25.0, 11.0, 18.0, 0.0, 12.0, 0.0, 1.0, 13.0, -4.0, 23.0, -18.0, -2.0, 21.0, -2.0, 0.0, 17.0, -2.0, 70.0, 0.0, 14.0, 0.0, 3.0, 0.0, -11.0, -14.0, -14.0, 17.0, 0.0, -6.0, 45.0, 22.0, -20.0, -10.0, 0.0, 18.0, 0.0, 16.0, 1.0, 24.0, 28.0, 41.0, 0.0, -384.0, -370.0, 11.0, -56.0, 0.0, 0.0, 20.0, 0.0, -196.0, 2.0, 13.0, 0.0, 9.0, -18.0, 0.0, 0.0, 0.0, -45.0, 0.0, -68.0, 0.0, 5.0, 12.0, -16.0, -18.0, -366.0, 2.0, -4.0, -394.0, -392.0], "policy_predator_policy_reward": [6.0, 12.0, 0.0, 4.0, 17.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 66.0, 78.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 4.0, 13.0, 0.0, 0.0, 0.0, 7.0, 4.0, 4.0, 0.0, 17.0, 7.0, 0.0, 0.0, 1.0, 14.0, 14.0, 17.0, 7.0, 13.0, 0.0, 2.0, 4.0, 0.0, 2.0, 15.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 11.0, 0.0, 2.0, 28.0, 6.0, 0.0, 3.0, 0.0, 0.0, 1.0, 7.0, 2.0, 7.0, 6.0, 0.0, 0.0, 3.0, 19.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 19.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 7.0, 5.0, 0.0, 0.0, 9.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41.0, 26.0, 4.0, 5.0, 0.0, 14.0, 0.0, 31.0, 0.0, 2.0, 4.0, 0.0, 26.0, 38.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 9.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 8.0, 2.0, 5.0, 1.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, 39.0, 34.0, 0.0, 0.0, 9.0, 8.0, 80.0, 99.0, 1.0, 0.0, 9.0, 1.0, 0.0, 0.0, 27.0, 10.0, 53.0, 47.0, 6.0, 0.0, 32.0, 8.0, 0.0, 196.0, 4.0, 0.0, 199.0, 188.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.590234727567063, "mean_inference_ms": 38.83076533106923, "mean_action_processing_ms": 2.24979818269359, "mean_env_wait_ms": 2.1900228846571994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007982611656188965, "StateBufferConnector_ms": 0.006279468536376953, "ViewRequirementAgentConnector_ms": 0.2308638095855713}, "num_episodes": 18, "episode_return_max": 83.0, "episode_return_min": -557.0, "episode_return_mean": 4.92, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 165.8814187073607, "num_env_steps_trained_throughput_per_sec": 165.8814187073607, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 2464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2464000, "timers": {"training_iteration_time_ms": 20936.059, "restore_workers_time_ms": 0.02, "training_step_time_ms": 20936.002, "sample_time_ms": 2788.048, "learn_time_ms": 18126.28, "learn_throughput": 220.674, "synch_weights_time_ms": 17.877}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "done": false, "training_iteration": 154, "trial_id": "4f45b_00000", "date": "2024-08-13_05-42-39", "timestamp": 1723542159, "time_this_iter_s": 24.165455102920532, "time_total_s": 14983.741111040115, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2830ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 14983.741111040115, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 85.51764705882354, "ram_util_percent": 83.58529411764708}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0135727699708057, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8512112903374213, "policy_loss": -0.0014497169899562049, "vf_loss": 0.852659772005346, "vf_explained_var": 0.0016334341947363798, "kl": 0.007898852816105993, "entropy": 0.6149993056815768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.766129505894487, "cur_kl_coeff": 1.5466968761757012e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7663203597726933, "policy_loss": -0.002250679852145295, "vf_loss": 0.7685710379370937, "vf_explained_var": -0.2655623968946871, "kl": 0.002369060727366671, "entropy": 0.26355856409463935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 83.0, "episode_reward_min": -557.0, "episode_reward_mean": 1.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 70.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -13.705, "predator_policy": 14.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, -4.0, 16.0, 37.0, 56.0, 5.0, 12.0, -7.0, 50.0, 9.0, 25.0, -2.0, 58.0, 16.0, 10.0, 4.0, 32.0, 13.0, 53.0, 0.0, 17.0, -10.0, -1.0, 68.0, 0.0, 0.0, 14.0, 8.0, 6.0, 50.0, 1.0, 7.0, 47.0, 10.0, 0.0, 15.0, 59.0, 24.0, 62.0, 5.0, 2.0, 0.0, 49.0, 14.0, 18.0, 83.0, -10.0, 24.0, 17.0, 69.0, 14.0, 8.0, -2.0, -21.0, 17.0, 42.0, 12.0, -4.0, 18.0, 35.0, 52.0, 41.0, -557.0, 28.0, 0.0, 37.0, -15.0, 14.0, 1.0, 0.0, -8.0, 32.0, 11.0, 36.0, -188.0, 2.0, -399.0, -17.0, 14.0, 13.0, 0.0, 17.0, 9.0, 7.0, 8.0, -38.0, 8.0, 10.0, 9.0, -1.0, -1.0, -28.0, 7.0, 3.0, 1.0, 0.0, -133.0, 11.0, 2.0, 14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, 0.0, 0.0, -8.0, 0.0, -1.0, 21.0, 16.0, 6.0, 39.0, 0.0, 5.0, 12.0, 0.0, -4.0, -8.0, 0.0, 39.0, -4.0, -17.0, 24.0, -5.0, 0.0, -5.0, 41.0, 16.0, -18.0, 25.0, -18.0, 15.0, 0.0, 4.0, 48.0, -38.0, 0.0, 13.0, 0.0, 43.0, 0.0, 0.0, -3.0, 0.0, -20.0, 0.0, -21.0, -4.0, 0.0, 68.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 0.0, 0.0, 6.0, 27.0, 3.0, -7.0, -4.0, 7.0, 0.0, 0.0, 38.0, -1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 59.0, 24.0, 0.0, 62.0, 0.0, -3.0, -59.0, 0.0, -7.0, -25.0, 11.0, 18.0, 0.0, 12.0, 0.0, 1.0, 13.0, -4.0, 23.0, -18.0, -2.0, 21.0, -2.0, 0.0, 17.0, -2.0, 70.0, 0.0, 14.0, 0.0, 3.0, 0.0, -11.0, -14.0, -14.0, 17.0, 0.0, -6.0, 45.0, 22.0, -20.0, -10.0, 0.0, 18.0, 0.0, 16.0, 1.0, 24.0, 28.0, 41.0, 0.0, -384.0, -370.0, 11.0, -56.0, 0.0, 0.0, 20.0, 0.0, -196.0, 2.0, 13.0, 0.0, 9.0, -18.0, 0.0, 0.0, 0.0, -45.0, 0.0, -68.0, 0.0, 5.0, 12.0, -16.0, -18.0, -366.0, 2.0, -4.0, -394.0, -392.0, 0.0, -34.0, 0.0, 9.0, 13.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, -28.0, 0.0, 8.0, -32.0, -365.0, 8.0, 0.0, 9.0, 0.0, -6.0, 12.0, 0.0, -6.0, -2.0, 0.0, -359.0, 0.0, 0.0, 7.0, -5.0, 0.0, 8.0, -20.0, 0.0, 0.0, -281.0, -12.0, 10.0, 0.0, 0.0, -183.0, 14.0, 0.0], "policy_predator_policy_reward": [0.0, 2.0, 4.0, 0.0, 2.0, 15.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 11.0, 0.0, 2.0, 28.0, 6.0, 0.0, 3.0, 0.0, 0.0, 1.0, 7.0, 2.0, 7.0, 6.0, 0.0, 0.0, 3.0, 19.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 19.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 7.0, 5.0, 0.0, 0.0, 9.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41.0, 26.0, 4.0, 5.0, 0.0, 14.0, 0.0, 31.0, 0.0, 2.0, 4.0, 0.0, 26.0, 38.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 9.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 8.0, 2.0, 5.0, 1.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, 39.0, 34.0, 0.0, 0.0, 9.0, 8.0, 80.0, 99.0, 1.0, 0.0, 9.0, 1.0, 0.0, 0.0, 27.0, 10.0, 53.0, 47.0, 6.0, 0.0, 32.0, 8.0, 0.0, 196.0, 4.0, 0.0, 199.0, 188.0, 0.0, 17.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 16.0, 0.0, 0.0, 171.0, 188.0, 0.0, 0.0, 0.0, 1.0, 0.0, 3.0, 0.0, 5.0, 0.0, 1.0, 152.0, 179.0, 0.0, 0.0, 0.0, 8.0, 3.0, 10.0, 0.0, 0.0, 160.0, 0.0, 1.0, 0.0, 101.0, 84.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.488319018585036, "mean_inference_ms": 38.57245623775781, "mean_action_processing_ms": 2.235021011272879, "mean_env_wait_ms": 2.1750775397556708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008695721626281738, "StateBufferConnector_ms": 0.006462454795837402, "ViewRequirementAgentConnector_ms": 0.25180375576019287}, "num_episodes": 23, "episode_return_max": 83.0, "episode_return_min": -557.0, "episode_return_mean": 1.5, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 174.9368180913351, "num_env_steps_trained_throughput_per_sec": 174.9368180913351, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 21540.32, "restore_workers_time_ms": 0.02, "training_step_time_ms": 21540.263, "sample_time_ms": 2783.787, "learn_time_ms": 18733.176, "learn_throughput": 213.525, "synch_weights_time_ms": 19.312}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 155, "trial_id": "4f45b_00000", "date": "2024-08-13_05-43-02", "timestamp": 1723542182, "time_this_iter_s": 22.91559100151062, "time_total_s": 15006.656702041626, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28975e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15006.656702041626, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 84.353125, "ram_util_percent": 83.44999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9677849004114116, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4267213331959234, "policy_loss": -0.002249359190229957, "vf_loss": 2.4289695783266945, "vf_explained_var": 0.0006739964876225385, "kl": 0.0071301040810978975, "entropy": 0.6164655997954979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.095231600160952, "cur_kl_coeff": 7.733484380878506e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8928746958889027, "policy_loss": -0.004065409876411121, "vf_loss": 1.89694009782776, "vf_explained_var": -0.19520431517293213, "kl": 0.012044923551276414, "entropy": 0.3049609652350819, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "env_runners": {"episode_reward_max": 87.0, "episode_reward_min": -557.0, "episode_reward_mean": -1.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 70.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -22.47, "predator_policy": 21.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 68.0, 0.0, 0.0, 14.0, 8.0, 6.0, 50.0, 1.0, 7.0, 47.0, 10.0, 0.0, 15.0, 59.0, 24.0, 62.0, 5.0, 2.0, 0.0, 49.0, 14.0, 18.0, 83.0, -10.0, 24.0, 17.0, 69.0, 14.0, 8.0, -2.0, -21.0, 17.0, 42.0, 12.0, -4.0, 18.0, 35.0, 52.0, 41.0, -557.0, 28.0, 0.0, 37.0, -15.0, 14.0, 1.0, 0.0, -8.0, 32.0, 11.0, 36.0, -188.0, 2.0, -399.0, -17.0, 14.0, 13.0, 0.0, 17.0, 9.0, 7.0, 8.0, -38.0, 8.0, 10.0, 9.0, -1.0, -1.0, -28.0, 7.0, 3.0, 1.0, 0.0, -133.0, 11.0, 2.0, 14.0, 40.0, 19.0, -39.0, 23.0, 20.0, 25.0, -5.0, 0.0, -2.0, 6.0, -1.0, -31.0, 7.0, 18.0, -42.0, 23.0, 21.0, 87.0, -82.0, 21.0, -9.0, -5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-21.0, -4.0, 0.0, 68.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 0.0, 0.0, 6.0, 27.0, 3.0, -7.0, -4.0, 7.0, 0.0, 0.0, 38.0, -1.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 59.0, 24.0, 0.0, 62.0, 0.0, -3.0, -59.0, 0.0, -7.0, -25.0, 11.0, 18.0, 0.0, 12.0, 0.0, 1.0, 13.0, -4.0, 23.0, -18.0, -2.0, 21.0, -2.0, 0.0, 17.0, -2.0, 70.0, 0.0, 14.0, 0.0, 3.0, 0.0, -11.0, -14.0, -14.0, 17.0, 0.0, -6.0, 45.0, 22.0, -20.0, -10.0, 0.0, 18.0, 0.0, 16.0, 1.0, 24.0, 28.0, 41.0, 0.0, -384.0, -370.0, 11.0, -56.0, 0.0, 0.0, 20.0, 0.0, -196.0, 2.0, 13.0, 0.0, 9.0, -18.0, 0.0, 0.0, 0.0, -45.0, 0.0, -68.0, 0.0, 5.0, 12.0, -16.0, -18.0, -366.0, 2.0, -4.0, -394.0, -392.0, 0.0, -34.0, 0.0, 9.0, 13.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, -28.0, 0.0, 8.0, -32.0, -365.0, 8.0, 0.0, 9.0, 0.0, -6.0, 12.0, 0.0, -6.0, -2.0, 0.0, -359.0, 0.0, 0.0, 7.0, -5.0, 0.0, 8.0, -20.0, 0.0, 0.0, -281.0, -12.0, 10.0, 0.0, 0.0, -183.0, 14.0, 0.0, 23.0, 17.0, -39.0, 10.0, -124.0, 11.0, 14.0, 2.0, 10.0, 9.0, 2.0, -159.0, -7.0, -2.0, 0.0, 0.0, 0.0, -4.0, -16.0, 12.0, -14.0, 1.0, -392.0, -12.0, 0.0, -16.0, 18.0, 0.0, -376.0, 0.0, -14.0, 30.0, -8.0, 25.0, 20.0, 67.0, -386.0, -84.0, 13.0, 7.0, -6.0, -8.0, -2.0, -161.0], "policy_predator_policy_reward": [19.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 7.0, 5.0, 0.0, 0.0, 9.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 41.0, 26.0, 4.0, 5.0, 0.0, 14.0, 0.0, 31.0, 0.0, 2.0, 4.0, 0.0, 26.0, 38.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 9.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 8.0, 2.0, 5.0, 1.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, 39.0, 34.0, 0.0, 0.0, 9.0, 8.0, 80.0, 99.0, 1.0, 0.0, 9.0, 1.0, 0.0, 0.0, 27.0, 10.0, 53.0, 47.0, 6.0, 0.0, 32.0, 8.0, 0.0, 196.0, 4.0, 0.0, 199.0, 188.0, 0.0, 17.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 16.0, 0.0, 0.0, 171.0, 188.0, 0.0, 0.0, 0.0, 1.0, 0.0, 3.0, 0.0, 5.0, 0.0, 1.0, 152.0, 179.0, 0.0, 0.0, 0.0, 8.0, 3.0, 10.0, 0.0, 0.0, 160.0, 0.0, 1.0, 0.0, 101.0, 84.0, 0.0, 0.0, 0.0, 0.0, 22.0, 26.0, 0.0, 74.0, 0.0, 7.0, 1.0, 0.0, 92.0, 90.0, 4.0, 0.0, 0.0, 0.0, 2.0, 0.0, 8.0, 2.0, 7.0, 5.0, 195.0, 178.0, 15.0, 8.0, 0.0, 0.0, 146.0, 188.0, 0.0, 7.0, 0.0, 4.0, 0.0, 0.0, 191.0, 197.0, 1.0, 0.0, 0.0, 5.0, 83.0, 75.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.706498597159811, "mean_inference_ms": 38.01026133332426, "mean_action_processing_ms": 2.2238382997157498, "mean_env_wait_ms": 2.1645074539512597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009319305419921875, "StateBufferConnector_ms": 0.006181120872497559, "ViewRequirementAgentConnector_ms": 0.26261162757873535}, "num_episodes": 22, "episode_return_max": 87.0, "episode_return_min": -557.0, "episode_return_mean": -1.44, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 156.9642367901471, "num_env_steps_trained_throughput_per_sec": 156.9642367901471, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 2496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2496000, "timers": {"training_iteration_time_ms": 22337.003, "restore_workers_time_ms": 0.021, "training_step_time_ms": 22336.944, "sample_time_ms": 2822.97, "learn_time_ms": 19490.242, "learn_throughput": 205.231, "synch_weights_time_ms": 19.598}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "done": false, "training_iteration": 156, "trial_id": "4f45b_00000", "date": "2024-08-13_05-43-27", "timestamp": 1723542207, "time_this_iter_s": 25.55609703063965, "time_total_s": 15032.212799072266, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2488790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15032.212799072266, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 87.3, "ram_util_percent": 83.58611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.165014898004355, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4424033044507263, "policy_loss": -0.0014799920603061321, "vf_loss": 1.4438820850281489, "vf_explained_var": 0.0009958516668390344, "kl": 0.00778252232117685, "entropy": 0.6163921795194112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8942954966788568, "cur_kl_coeff": 7.733484380878506e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5848592345361356, "policy_loss": -0.006815439905532729, "vf_loss": 1.5916746733365235, "vf_explained_var": -0.14637383165813628, "kl": 0.006297871377554487, "entropy": 0.2700815961947517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "env_runners": {"episode_reward_max": 87.0, "episode_reward_min": -557.0, "episode_reward_mean": -7.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 70.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -28.82, "predator_policy": 25.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0, 0.0, 49.0, 14.0, 18.0, 83.0, -10.0, 24.0, 17.0, 69.0, 14.0, 8.0, -2.0, -21.0, 17.0, 42.0, 12.0, -4.0, 18.0, 35.0, 52.0, 41.0, -557.0, 28.0, 0.0, 37.0, -15.0, 14.0, 1.0, 0.0, -8.0, 32.0, 11.0, 36.0, -188.0, 2.0, -399.0, -17.0, 14.0, 13.0, 0.0, 17.0, 9.0, 7.0, 8.0, -38.0, 8.0, 10.0, 9.0, -1.0, -1.0, -28.0, 7.0, 3.0, 1.0, 0.0, -133.0, 11.0, 2.0, 14.0, 40.0, 19.0, -39.0, 23.0, 20.0, 25.0, -5.0, 0.0, -2.0, 6.0, -1.0, -31.0, 7.0, 18.0, -42.0, 23.0, 21.0, 87.0, -82.0, 21.0, -9.0, -5.0, 86.0, -7.0, -9.0, 3.0, 4.0, -7.0, -5.0, 25.0, -16.0, 17.0, -103.0, -117.0, 9.0, 0.0, 9.0, -146.0, 16.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -7.0, -25.0, 11.0, 18.0, 0.0, 12.0, 0.0, 1.0, 13.0, -4.0, 23.0, -18.0, -2.0, 21.0, -2.0, 0.0, 17.0, -2.0, 70.0, 0.0, 14.0, 0.0, 3.0, 0.0, -11.0, -14.0, -14.0, 17.0, 0.0, -6.0, 45.0, 22.0, -20.0, -10.0, 0.0, 18.0, 0.0, 16.0, 1.0, 24.0, 28.0, 41.0, 0.0, -384.0, -370.0, 11.0, -56.0, 0.0, 0.0, 20.0, 0.0, -196.0, 2.0, 13.0, 0.0, 9.0, -18.0, 0.0, 0.0, 0.0, -45.0, 0.0, -68.0, 0.0, 5.0, 12.0, -16.0, -18.0, -366.0, 2.0, -4.0, -394.0, -392.0, 0.0, -34.0, 0.0, 9.0, 13.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, -28.0, 0.0, 8.0, -32.0, -365.0, 8.0, 0.0, 9.0, 0.0, -6.0, 12.0, 0.0, -6.0, -2.0, 0.0, -359.0, 0.0, 0.0, 7.0, -5.0, 0.0, 8.0, -20.0, 0.0, 0.0, -281.0, -12.0, 10.0, 0.0, 0.0, -183.0, 14.0, 0.0, 23.0, 17.0, -39.0, 10.0, -124.0, 11.0, 14.0, 2.0, 10.0, 9.0, 2.0, -159.0, -7.0, -2.0, 0.0, 0.0, 0.0, -4.0, -16.0, 12.0, -14.0, 1.0, -392.0, -12.0, 0.0, -16.0, 18.0, 0.0, -376.0, 0.0, -14.0, 30.0, -8.0, 25.0, 20.0, 67.0, -386.0, -84.0, 13.0, 7.0, -6.0, -8.0, -2.0, -161.0, 17.0, 69.0, 0.0, -15.0, -24.0, -56.0, 8.0, -10.0, -3.0, 0.0, -2.0, -14.0, 0.0, -10.0, 25.0, 0.0, -18.0, -14.0, -5.0, 12.0, -228.0, -14.0, -297.0, -112.0, 0.0, 9.0, 0.0, 0.0, 0.0, 8.0, -294.0, 0.0, 16.0, 0.0, -91.0, 0.0], "policy_predator_policy_reward": [4.0, 5.0, 0.0, 14.0, 0.0, 31.0, 0.0, 2.0, 4.0, 0.0, 26.0, 38.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 9.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 8.0, 2.0, 5.0, 1.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, 39.0, 34.0, 0.0, 0.0, 9.0, 8.0, 80.0, 99.0, 1.0, 0.0, 9.0, 1.0, 0.0, 0.0, 27.0, 10.0, 53.0, 47.0, 6.0, 0.0, 32.0, 8.0, 0.0, 196.0, 4.0, 0.0, 199.0, 188.0, 0.0, 17.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 16.0, 0.0, 0.0, 171.0, 188.0, 0.0, 0.0, 0.0, 1.0, 0.0, 3.0, 0.0, 5.0, 0.0, 1.0, 152.0, 179.0, 0.0, 0.0, 0.0, 8.0, 3.0, 10.0, 0.0, 0.0, 160.0, 0.0, 1.0, 0.0, 101.0, 84.0, 0.0, 0.0, 0.0, 0.0, 22.0, 26.0, 0.0, 74.0, 0.0, 7.0, 1.0, 0.0, 92.0, 90.0, 4.0, 0.0, 0.0, 0.0, 2.0, 0.0, 8.0, 2.0, 7.0, 5.0, 195.0, 178.0, 15.0, 8.0, 0.0, 0.0, 146.0, 188.0, 0.0, 7.0, 0.0, 4.0, 0.0, 0.0, 191.0, 197.0, 1.0, 0.0, 0.0, 5.0, 83.0, 75.0, 0.0, 0.0, 0.0, 8.0, 33.0, 38.0, 5.0, 0.0, 7.0, 0.0, 8.0, 1.0, 0.0, 5.0, 0.0, 0.0, 0.0, 16.0, 0.0, 10.0, 7.0, 132.0, 132.0, 160.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 147.0, 0.0, 0.0, 0.0, 95.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.323280548090565, "mean_inference_ms": 38.127856272363985, "mean_action_processing_ms": 2.2155384605810657, "mean_env_wait_ms": 2.1553955609452977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009841680526733398, "StateBufferConnector_ms": 0.006951332092285156, "ViewRequirementAgentConnector_ms": 0.26798713207244873}, "num_episodes": 18, "episode_return_max": 87.0, "episode_return_min": -557.0, "episode_return_mean": -7.56, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 167.226134896597, "num_env_steps_trained_throughput_per_sec": 167.226134896597, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 2512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2512000, "timers": {"training_iteration_time_ms": 22975.013, "restore_workers_time_ms": 0.021, "training_step_time_ms": 22974.954, "sample_time_ms": 2867.621, "learn_time_ms": 20082.775, "learn_throughput": 199.176, "synch_weights_time_ms": 19.61}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "done": false, "training_iteration": 157, "trial_id": "4f45b_00000", "date": "2024-08-13_05-43-51", "timestamp": 1723542231, "time_this_iter_s": 23.98990511894226, "time_total_s": 15056.202704191208, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27d7790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15056.202704191208, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 85.43529411764706, "ram_util_percent": 83.49411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0490698676103007, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0176133019583564, "policy_loss": -0.0010555032324095174, "vf_loss": 2.0186678512071174, "vf_explained_var": 0.0020367687341397403, "kl": 0.006109496663571693, "entropy": 0.5657818201830778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0751847107259054, "cur_kl_coeff": 7.733484380878506e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4628383392379398, "policy_loss": -0.009956784292848573, "vf_loss": 1.4727951206542826, "vf_explained_var": -0.16279797137729704, "kl": 0.010449996173491653, "entropy": 0.3090900959476592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "env_runners": {"episode_reward_max": 91.0, "episode_reward_min": -557.0, "episode_reward_mean": -9.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 69.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -31.975, "predator_policy": 27.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, 35.0, 52.0, 41.0, -557.0, 28.0, 0.0, 37.0, -15.0, 14.0, 1.0, 0.0, -8.0, 32.0, 11.0, 36.0, -188.0, 2.0, -399.0, -17.0, 14.0, 13.0, 0.0, 17.0, 9.0, 7.0, 8.0, -38.0, 8.0, 10.0, 9.0, -1.0, -1.0, -28.0, 7.0, 3.0, 1.0, 0.0, -133.0, 11.0, 2.0, 14.0, 40.0, 19.0, -39.0, 23.0, 20.0, 25.0, -5.0, 0.0, -2.0, 6.0, -1.0, -31.0, 7.0, 18.0, -42.0, 23.0, 21.0, 87.0, -82.0, 21.0, -9.0, -5.0, 86.0, -7.0, -9.0, 3.0, 4.0, -7.0, -5.0, 25.0, -16.0, 17.0, -103.0, -117.0, 9.0, 0.0, 9.0, -146.0, 16.0, 4.0, 5.0, 5.0, 20.0, 5.0, 6.0, 19.0, 6.0, 20.0, 0.0, 52.0, -19.0, 6.0, 91.0, -78.0, -52.0, 9.0, 1.0, 21.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [18.0, 0.0, 16.0, 1.0, 24.0, 28.0, 41.0, 0.0, -384.0, -370.0, 11.0, -56.0, 0.0, 0.0, 20.0, 0.0, -196.0, 2.0, 13.0, 0.0, 9.0, -18.0, 0.0, 0.0, 0.0, -45.0, 0.0, -68.0, 0.0, 5.0, 12.0, -16.0, -18.0, -366.0, 2.0, -4.0, -394.0, -392.0, 0.0, -34.0, 0.0, 9.0, 13.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, -28.0, 0.0, 8.0, -32.0, -365.0, 8.0, 0.0, 9.0, 0.0, -6.0, 12.0, 0.0, -6.0, -2.0, 0.0, -359.0, 0.0, 0.0, 7.0, -5.0, 0.0, 8.0, -20.0, 0.0, 0.0, -281.0, -12.0, 10.0, 0.0, 0.0, -183.0, 14.0, 0.0, 23.0, 17.0, -39.0, 10.0, -124.0, 11.0, 14.0, 2.0, 10.0, 9.0, 2.0, -159.0, -7.0, -2.0, 0.0, 0.0, 0.0, -4.0, -16.0, 12.0, -14.0, 1.0, -392.0, -12.0, 0.0, -16.0, 18.0, 0.0, -376.0, 0.0, -14.0, 30.0, -8.0, 25.0, 20.0, 67.0, -386.0, -84.0, 13.0, 7.0, -6.0, -8.0, -2.0, -161.0, 17.0, 69.0, 0.0, -15.0, -24.0, -56.0, 8.0, -10.0, -3.0, 0.0, -2.0, -14.0, 0.0, -10.0, 25.0, 0.0, -18.0, -14.0, -5.0, 12.0, -228.0, -14.0, -297.0, -112.0, 0.0, 9.0, 0.0, 0.0, 0.0, 8.0, -294.0, 0.0, 16.0, 0.0, -91.0, 0.0, -2.0, 0.0, 0.0, -15.0, -10.0, 18.0, 0.0, 5.0, 0.0, -6.0, -44.0, 0.0, -3.0, -2.0, 9.0, 11.0, 0.0, 0.0, 32.0, -99.0, -24.0, -36.0, -7.0, -4.0, -7.0, 0.0, -234.0, 23.0, 0.0, -104.0, 0.0, 4.0, -4.0, 0.0, 22.0, -2.0], "policy_predator_policy_reward": [0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 197.0, 39.0, 34.0, 0.0, 0.0, 9.0, 8.0, 80.0, 99.0, 1.0, 0.0, 9.0, 1.0, 0.0, 0.0, 27.0, 10.0, 53.0, 47.0, 6.0, 0.0, 32.0, 8.0, 0.0, 196.0, 4.0, 0.0, 199.0, 188.0, 0.0, 17.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 16.0, 0.0, 0.0, 171.0, 188.0, 0.0, 0.0, 0.0, 1.0, 0.0, 3.0, 0.0, 5.0, 0.0, 1.0, 152.0, 179.0, 0.0, 0.0, 0.0, 8.0, 3.0, 10.0, 0.0, 0.0, 160.0, 0.0, 1.0, 0.0, 101.0, 84.0, 0.0, 0.0, 0.0, 0.0, 22.0, 26.0, 0.0, 74.0, 0.0, 7.0, 1.0, 0.0, 92.0, 90.0, 4.0, 0.0, 0.0, 0.0, 2.0, 0.0, 8.0, 2.0, 7.0, 5.0, 195.0, 178.0, 15.0, 8.0, 0.0, 0.0, 146.0, 188.0, 0.0, 7.0, 0.0, 4.0, 0.0, 0.0, 191.0, 197.0, 1.0, 0.0, 0.0, 5.0, 83.0, 75.0, 0.0, 0.0, 0.0, 8.0, 33.0, 38.0, 5.0, 0.0, 7.0, 0.0, 8.0, 1.0, 0.0, 5.0, 0.0, 0.0, 0.0, 16.0, 0.0, 10.0, 7.0, 132.0, 132.0, 160.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 147.0, 0.0, 0.0, 0.0, 95.0, 3.0, 4.0, 6.0, 14.0, 10.0, 2.0, 0.0, 0.0, 0.0, 12.0, 31.0, 32.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 68.0, 51.0, 21.0, 20.0, 7.0, 10.0, 47.0, 51.0, 16.0, 117.0, 0.0, 52.0, 0.0, 5.0, 5.0, 0.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.249396672784146, "mean_inference_ms": 37.931799849398686, "mean_action_processing_ms": 2.2065890713225076, "mean_env_wait_ms": 2.1460576224674823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009339690208435059, "StateBufferConnector_ms": 0.00706028938293457, "ViewRequirementAgentConnector_ms": 0.2858999967575073}, "num_episodes": 18, "episode_return_max": 91.0, "episode_return_min": -557.0, "episode_return_mean": -9.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.80034514636944, "num_env_steps_trained_throughput_per_sec": 148.80034514636944, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 2528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2528000, "timers": {"training_iteration_time_ms": 23827.482, "restore_workers_time_ms": 0.021, "training_step_time_ms": 23827.39, "sample_time_ms": 3110.554, "learn_time_ms": 20689.462, "learn_throughput": 193.335, "synch_weights_time_ms": 20.402}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "done": false, "training_iteration": 158, "trial_id": "4f45b_00000", "date": "2024-08-13_05-44-19", "timestamp": 1723542259, "time_this_iter_s": 26.956860065460205, "time_total_s": 15083.159564256668, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2733ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15083.159564256668, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 85.71842105263158, "ram_util_percent": 83.23684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9178235061190747, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9097907521264262, "policy_loss": -0.0019945054420974677, "vf_loss": 0.9117837071024552, "vf_explained_var": 0.0052884427012589875, "kl": 0.009923993598792591, "entropy": 0.5716470367851711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0296606043107297, "cur_kl_coeff": 7.733484380878506e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.992684325445739, "policy_loss": -0.005577356994851793, "vf_loss": 0.9982616834224216, "vf_explained_var": -0.015438789476162541, "kl": 0.0038577942940499037, "entropy": 0.2550080236855638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "env_runners": {"episode_reward_max": 91.0, "episode_reward_min": -399.0, "episode_reward_mean": -3.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -394.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 69.0, "predator_policy": 199.0}, "policy_reward_mean": {"prey_policy": -28.58, "predator_policy": 26.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-399.0, -17.0, 14.0, 13.0, 0.0, 17.0, 9.0, 7.0, 8.0, -38.0, 8.0, 10.0, 9.0, -1.0, -1.0, -28.0, 7.0, 3.0, 1.0, 0.0, -133.0, 11.0, 2.0, 14.0, 40.0, 19.0, -39.0, 23.0, 20.0, 25.0, -5.0, 0.0, -2.0, 6.0, -1.0, -31.0, 7.0, 18.0, -42.0, 23.0, 21.0, 87.0, -82.0, 21.0, -9.0, -5.0, 86.0, -7.0, -9.0, 3.0, 4.0, -7.0, -5.0, 25.0, -16.0, 17.0, -103.0, -117.0, 9.0, 0.0, 9.0, -146.0, 16.0, 4.0, 5.0, 5.0, 20.0, 5.0, 6.0, 19.0, 6.0, 20.0, 0.0, 52.0, -19.0, 6.0, 91.0, -78.0, -52.0, 9.0, 1.0, 21.0, 33.0, 0.0, -2.0, 0.0, 17.0, -1.0, -45.0, -3.0, 0.0, 0.0, 22.0, 8.0, 8.0, 51.0, -43.0, 10.0, 68.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-394.0, -392.0, 0.0, -34.0, 0.0, 9.0, 13.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 9.0, 0.0, -28.0, 0.0, 8.0, -32.0, -365.0, 8.0, 0.0, 9.0, 0.0, -6.0, 12.0, 0.0, -6.0, -2.0, 0.0, -359.0, 0.0, 0.0, 7.0, -5.0, 0.0, 8.0, -20.0, 0.0, 0.0, -281.0, -12.0, 10.0, 0.0, 0.0, -183.0, 14.0, 0.0, 23.0, 17.0, -39.0, 10.0, -124.0, 11.0, 14.0, 2.0, 10.0, 9.0, 2.0, -159.0, -7.0, -2.0, 0.0, 0.0, 0.0, -4.0, -16.0, 12.0, -14.0, 1.0, -392.0, -12.0, 0.0, -16.0, 18.0, 0.0, -376.0, 0.0, -14.0, 30.0, -8.0, 25.0, 20.0, 67.0, -386.0, -84.0, 13.0, 7.0, -6.0, -8.0, -2.0, -161.0, 17.0, 69.0, 0.0, -15.0, -24.0, -56.0, 8.0, -10.0, -3.0, 0.0, -2.0, -14.0, 0.0, -10.0, 25.0, 0.0, -18.0, -14.0, -5.0, 12.0, -228.0, -14.0, -297.0, -112.0, 0.0, 9.0, 0.0, 0.0, 0.0, 8.0, -294.0, 0.0, 16.0, 0.0, -91.0, 0.0, -2.0, 0.0, 0.0, -15.0, -10.0, 18.0, 0.0, 5.0, 0.0, -6.0, -44.0, 0.0, -3.0, -2.0, 9.0, 11.0, 0.0, 0.0, 32.0, -99.0, -24.0, -36.0, -7.0, -4.0, -7.0, 0.0, -234.0, 23.0, 0.0, -104.0, 0.0, 4.0, -4.0, 0.0, 22.0, -2.0, -56.0, -2.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 17.0, 0.0, -4.0, 0.0, -92.0, 1.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, -15.0, 0.0, -16.0, -127.0, 50.0, 0.0, 0.0, -363.0, 0.0, -20.0, 0.0, 29.0, 0.0, -51.0], "policy_predator_policy_reward": [199.0, 188.0, 0.0, 17.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 16.0, 0.0, 0.0, 171.0, 188.0, 0.0, 0.0, 0.0, 1.0, 0.0, 3.0, 0.0, 5.0, 0.0, 1.0, 152.0, 179.0, 0.0, 0.0, 0.0, 8.0, 3.0, 10.0, 0.0, 0.0, 160.0, 0.0, 1.0, 0.0, 101.0, 84.0, 0.0, 0.0, 0.0, 0.0, 22.0, 26.0, 0.0, 74.0, 0.0, 7.0, 1.0, 0.0, 92.0, 90.0, 4.0, 0.0, 0.0, 0.0, 2.0, 0.0, 8.0, 2.0, 7.0, 5.0, 195.0, 178.0, 15.0, 8.0, 0.0, 0.0, 146.0, 188.0, 0.0, 7.0, 0.0, 4.0, 0.0, 0.0, 191.0, 197.0, 1.0, 0.0, 0.0, 5.0, 83.0, 75.0, 0.0, 0.0, 0.0, 8.0, 33.0, 38.0, 5.0, 0.0, 7.0, 0.0, 8.0, 1.0, 0.0, 5.0, 0.0, 0.0, 0.0, 16.0, 0.0, 10.0, 7.0, 132.0, 132.0, 160.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 147.0, 0.0, 0.0, 0.0, 95.0, 3.0, 4.0, 6.0, 14.0, 10.0, 2.0, 0.0, 0.0, 0.0, 12.0, 31.0, 32.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 68.0, 51.0, 21.0, 20.0, 7.0, 10.0, 47.0, 51.0, 16.0, 117.0, 0.0, 52.0, 0.0, 5.0, 5.0, 0.0, 0.0, 1.0, 46.0, 45.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 46.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 12.0, 79.0, 72.0, 1.0, 0.0, 166.0, 154.0, 18.0, 12.0, 25.0, 14.0, 30.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.176500923351128, "mean_inference_ms": 37.7381510731133, "mean_action_processing_ms": 2.197755954997307, "mean_env_wait_ms": 2.1367970917646573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010754227638244629, "StateBufferConnector_ms": 0.006446719169616699, "ViewRequirementAgentConnector_ms": 0.30467116832733154}, "num_episodes": 18, "episode_return_max": 91.0, "episode_return_min": -399.0, "episode_return_mean": -3.83, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 173.72145985860993, "num_env_steps_trained_throughput_per_sec": 173.72145985860993, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 2544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2544000, "timers": {"training_iteration_time_ms": 23442.254, "restore_workers_time_ms": 0.023, "training_step_time_ms": 23442.158, "sample_time_ms": 3195.276, "learn_time_ms": 20217.871, "learn_throughput": 197.845, "synch_weights_time_ms": 21.62}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "done": false, "training_iteration": 159, "trial_id": "4f45b_00000", "date": "2024-08-13_05-44-42", "timestamp": 1723542282, "time_this_iter_s": 23.097119092941284, "time_total_s": 15106.25668334961, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28973a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15106.25668334961, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 83.55, "ram_util_percent": 83.46875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6036086015915745, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48261900542589725, "policy_loss": -0.002966205133420844, "vf_loss": 0.48558372120574983, "vf_explained_var": 0.009702251544074407, "kl": 0.009517276641565877, "entropy": 0.5724980547945335, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7526785499677455, "cur_kl_coeff": 3.866742190439253e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7589104194410894, "policy_loss": -0.003378667903413612, "vf_loss": 0.762289086055188, "vf_explained_var": -0.24175514244528676, "kl": 0.0020691973775005413, "entropy": 0.22910442970417164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 91.0, "episode_reward_min": -157.0, "episode_reward_mean": 0.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -392.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 69.0, "predator_policy": 197.0}, "policy_reward_mean": {"prey_policy": -20.935, "predator_policy": 21.365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.0, 20.0, 25.0, -5.0, 0.0, -2.0, 6.0, -1.0, -31.0, 7.0, 18.0, -42.0, 23.0, 21.0, 87.0, -82.0, 21.0, -9.0, -5.0, 86.0, -7.0, -9.0, 3.0, 4.0, -7.0, -5.0, 25.0, -16.0, 17.0, -103.0, -117.0, 9.0, 0.0, 9.0, -146.0, 16.0, 4.0, 5.0, 5.0, 20.0, 5.0, 6.0, 19.0, 6.0, 20.0, 0.0, 52.0, -19.0, 6.0, 91.0, -78.0, -52.0, 9.0, 1.0, 21.0, 33.0, 0.0, -2.0, 0.0, 17.0, -1.0, -45.0, -3.0, 0.0, 0.0, 22.0, 8.0, 8.0, 51.0, -43.0, 10.0, 68.0, 4.0, 25.0, 15.0, 12.0, -7.0, -17.0, 15.0, -1.0, -16.0, -2.0, -157.0, -1.0, -5.0, 36.0, 0.0, 22.0, -40.0, 2.0, 13.0, 8.0, 4.0, 11.0, 12.0, 20.0, 1.0, 38.0, 13.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [14.0, 2.0, 10.0, 9.0, 2.0, -159.0, -7.0, -2.0, 0.0, 0.0, 0.0, -4.0, -16.0, 12.0, -14.0, 1.0, -392.0, -12.0, 0.0, -16.0, 18.0, 0.0, -376.0, 0.0, -14.0, 30.0, -8.0, 25.0, 20.0, 67.0, -386.0, -84.0, 13.0, 7.0, -6.0, -8.0, -2.0, -161.0, 17.0, 69.0, 0.0, -15.0, -24.0, -56.0, 8.0, -10.0, -3.0, 0.0, -2.0, -14.0, 0.0, -10.0, 25.0, 0.0, -18.0, -14.0, -5.0, 12.0, -228.0, -14.0, -297.0, -112.0, 0.0, 9.0, 0.0, 0.0, 0.0, 8.0, -294.0, 0.0, 16.0, 0.0, -91.0, 0.0, -2.0, 0.0, 0.0, -15.0, -10.0, 18.0, 0.0, 5.0, 0.0, -6.0, -44.0, 0.0, -3.0, -2.0, 9.0, 11.0, 0.0, 0.0, 32.0, -99.0, -24.0, -36.0, -7.0, -4.0, -7.0, 0.0, -234.0, 23.0, 0.0, -104.0, 0.0, 4.0, -4.0, 0.0, 22.0, -2.0, -56.0, -2.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 17.0, 0.0, -4.0, 0.0, -92.0, 1.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, -15.0, 0.0, -16.0, -127.0, 50.0, 0.0, 0.0, -363.0, 0.0, -20.0, 0.0, 29.0, 0.0, -51.0, -19.0, 2.0, 0.0, 15.0, 12.0, 0.0, -14.0, 0.0, -86.0, 19.0, 0.0, 15.0, -3.0, -2.0, -14.0, -18.0, 0.0, -9.0, -86.0, -148.0, 0.0, -2.0, 0.0, -26.0, 26.0, 0.0, 0.0, 0.0, -6.0, 18.0, -28.0, -132.0, 10.0, -29.0, 5.0, 0.0, 0.0, -10.0, 5.0, -9.0, -92.0, 19.0, -16.0, 0.0, 1.0, 10.0, 0.0, -7.0, 18.0, 20.0, 0.0, -11.0, 0.0, 4.0], "policy_predator_policy_reward": [0.0, 7.0, 1.0, 0.0, 92.0, 90.0, 4.0, 0.0, 0.0, 0.0, 2.0, 0.0, 8.0, 2.0, 7.0, 5.0, 195.0, 178.0, 15.0, 8.0, 0.0, 0.0, 146.0, 188.0, 0.0, 7.0, 0.0, 4.0, 0.0, 0.0, 191.0, 197.0, 1.0, 0.0, 0.0, 5.0, 83.0, 75.0, 0.0, 0.0, 0.0, 8.0, 33.0, 38.0, 5.0, 0.0, 7.0, 0.0, 8.0, 1.0, 0.0, 5.0, 0.0, 0.0, 0.0, 16.0, 0.0, 10.0, 7.0, 132.0, 132.0, 160.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 147.0, 0.0, 0.0, 0.0, 95.0, 3.0, 4.0, 6.0, 14.0, 10.0, 2.0, 0.0, 0.0, 0.0, 12.0, 31.0, 32.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 68.0, 51.0, 21.0, 20.0, 7.0, 10.0, 47.0, 51.0, 16.0, 117.0, 0.0, 52.0, 0.0, 5.0, 5.0, 0.0, 0.0, 1.0, 46.0, 45.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 46.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 12.0, 79.0, 72.0, 1.0, 0.0, 166.0, 154.0, 18.0, 12.0, 25.0, 14.0, 30.0, 25.0, 23.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 43.0, 7.0, 0.0, 0.0, 4.0, 0.0, 7.0, 9.0, 7.0, 0.0, 77.0, 0.0, 0.0, 1.0, 0.0, 21.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 59.0, 61.0, 21.0, 0.0, 2.0, 6.0, 6.0, 12.0, 8.0, 0.0, 42.0, 42.0, 14.0, 14.0, 6.0, 3.0, 8.0, 0.0, 0.0, 0.0, 16.0, 8.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.371835695490747, "mean_inference_ms": 37.15395187824597, "mean_action_processing_ms": 2.183654110634308, "mean_env_wait_ms": 2.1227427410359367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015441179275512695, "StateBufferConnector_ms": 0.0069435834884643555, "ViewRequirementAgentConnector_ms": 0.31561577320098877}, "num_episodes": 27, "episode_return_max": 91.0, "episode_return_min": -157.0, "episode_return_mean": 0.86, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 164.76125677486874, "num_env_steps_trained_throughput_per_sec": 164.76125677486874, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 23861.136, "restore_workers_time_ms": 0.024, "training_step_time_ms": 23861.04, "sample_time_ms": 3320.22, "learn_time_ms": 20507.084, "learn_throughput": 195.055, "synch_weights_time_ms": 26.524}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 160, "trial_id": "4f45b_00000", "date": "2024-08-13_05-45-06", "timestamp": 1723542306, "time_this_iter_s": 24.367483854293823, "time_total_s": 15130.624167203903, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2897ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15130.624167203903, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 86.00285714285714, "ram_util_percent": 83.37714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3534911333331987, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2033785091900321, "policy_loss": -0.0014366875619445214, "vf_loss": 0.2048132426624073, "vf_explained_var": -0.023591381090658683, "kl": 0.012494499846868295, "entropy": 0.5973318027125465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5651264565646965, "cur_kl_coeff": 1.9333710952196264e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5953148717809685, "policy_loss": -0.0016874332748422467, "vf_loss": 0.5970023023822005, "vf_explained_var": 0.49259374438139497, "kl": 0.0037315617792872693, "entropy": 0.21702949303798574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "env_runners": {"episode_reward_max": 91.0, "episode_reward_min": -157.0, "episode_reward_mean": 1.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -363.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 69.0, "predator_policy": 166.0}, "policy_reward_mean": {"prey_policy": -14.775, "predator_policy": 15.31}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, 86.0, -7.0, -9.0, 3.0, 4.0, -7.0, -5.0, 25.0, -16.0, 17.0, -103.0, -117.0, 9.0, 0.0, 9.0, -146.0, 16.0, 4.0, 5.0, 5.0, 20.0, 5.0, 6.0, 19.0, 6.0, 20.0, 0.0, 52.0, -19.0, 6.0, 91.0, -78.0, -52.0, 9.0, 1.0, 21.0, 33.0, 0.0, -2.0, 0.0, 17.0, -1.0, -45.0, -3.0, 0.0, 0.0, 22.0, 8.0, 8.0, 51.0, -43.0, 10.0, 68.0, 4.0, 25.0, 15.0, 12.0, -7.0, -17.0, 15.0, -1.0, -16.0, -2.0, -157.0, -1.0, -5.0, 36.0, 0.0, 22.0, -40.0, 2.0, 13.0, 8.0, 4.0, 11.0, 12.0, 20.0, 1.0, 38.0, 13.0, 4.0, 0.0, -30.0, 6.0, 2.0, 37.0, 0.0, -19.0, 9.0, 30.0, 46.0, 0.0, 0.0, 0.0, -40.0, 10.0, 21.0, 9.0, 19.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2.0, -161.0, 17.0, 69.0, 0.0, -15.0, -24.0, -56.0, 8.0, -10.0, -3.0, 0.0, -2.0, -14.0, 0.0, -10.0, 25.0, 0.0, -18.0, -14.0, -5.0, 12.0, -228.0, -14.0, -297.0, -112.0, 0.0, 9.0, 0.0, 0.0, 0.0, 8.0, -294.0, 0.0, 16.0, 0.0, -91.0, 0.0, -2.0, 0.0, 0.0, -15.0, -10.0, 18.0, 0.0, 5.0, 0.0, -6.0, -44.0, 0.0, -3.0, -2.0, 9.0, 11.0, 0.0, 0.0, 32.0, -99.0, -24.0, -36.0, -7.0, -4.0, -7.0, 0.0, -234.0, 23.0, 0.0, -104.0, 0.0, 4.0, -4.0, 0.0, 22.0, -2.0, -56.0, -2.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 17.0, 0.0, -4.0, 0.0, -92.0, 1.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, -15.0, 0.0, -16.0, -127.0, 50.0, 0.0, 0.0, -363.0, 0.0, -20.0, 0.0, 29.0, 0.0, -51.0, -19.0, 2.0, 0.0, 15.0, 12.0, 0.0, -14.0, 0.0, -86.0, 19.0, 0.0, 15.0, -3.0, -2.0, -14.0, -18.0, 0.0, -9.0, -86.0, -148.0, 0.0, -2.0, 0.0, -26.0, 26.0, 0.0, 0.0, 0.0, -6.0, 18.0, -28.0, -132.0, 10.0, -29.0, 5.0, 0.0, 0.0, -10.0, 5.0, -9.0, -92.0, 19.0, -16.0, 0.0, 1.0, 10.0, 0.0, -7.0, 18.0, 20.0, 0.0, -11.0, 0.0, 4.0, 0.0, 0.0, -48.0, -6.0, -20.0, 16.0, 2.0, 0.0, 6.0, 29.0, 0.0, 0.0, 2.0, -54.0, 4.0, 0.0, 1.0, 17.0, 0.0, 46.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, -24.0, 1.0, 0.0, 13.0, -16.0, 0.0, 2.0, 19.0, 0.0], "policy_predator_policy_reward": [83.0, 75.0, 0.0, 0.0, 0.0, 8.0, 33.0, 38.0, 5.0, 0.0, 7.0, 0.0, 8.0, 1.0, 0.0, 5.0, 0.0, 0.0, 0.0, 16.0, 0.0, 10.0, 7.0, 132.0, 132.0, 160.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 147.0, 0.0, 0.0, 0.0, 95.0, 3.0, 4.0, 6.0, 14.0, 10.0, 2.0, 0.0, 0.0, 0.0, 12.0, 31.0, 32.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 68.0, 51.0, 21.0, 20.0, 7.0, 10.0, 47.0, 51.0, 16.0, 117.0, 0.0, 52.0, 0.0, 5.0, 5.0, 0.0, 0.0, 1.0, 46.0, 45.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 46.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 12.0, 79.0, 72.0, 1.0, 0.0, 166.0, 154.0, 18.0, 12.0, 25.0, 14.0, 30.0, 25.0, 23.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 43.0, 7.0, 0.0, 0.0, 4.0, 0.0, 7.0, 9.0, 7.0, 0.0, 77.0, 0.0, 0.0, 1.0, 0.0, 21.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 59.0, 61.0, 21.0, 0.0, 2.0, 6.0, 6.0, 12.0, 8.0, 0.0, 42.0, 42.0, 14.0, 14.0, 6.0, 3.0, 8.0, 0.0, 0.0, 0.0, 16.0, 8.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 27.0, 6.0, 5.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 6.0, 3.0, 3.0, 21.0, 0.0, 7.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.001819967872827, "mean_inference_ms": 37.27643582256812, "mean_action_processing_ms": 2.1764082295560776, "mean_env_wait_ms": 2.114412834548836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017962932586669922, "StateBufferConnector_ms": 0.007081747055053711, "ViewRequirementAgentConnector_ms": 0.3283216953277588}, "num_episodes": 18, "episode_return_max": 91.0, "episode_return_min": -157.0, "episode_return_mean": 1.07, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.93007829732065, "num_env_steps_trained_throughput_per_sec": 163.93007829732065, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 2576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2576000, "timers": {"training_iteration_time_ms": 24082.751, "restore_workers_time_ms": 0.02, "training_step_time_ms": 24082.659, "sample_time_ms": 3370.704, "learn_time_ms": 20671.241, "learn_throughput": 193.506, "synch_weights_time_ms": 32.823}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "done": false, "training_iteration": 161, "trial_id": "4f45b_00000", "date": "2024-08-13_05-45-31", "timestamp": 1723542331, "time_this_iter_s": 24.441310167312622, "time_total_s": 15155.065477371216, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28974c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15155.065477371216, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 84.53529411764707, "ram_util_percent": 83.37647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4498598078334772, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2865618813369009, "policy_loss": -0.002870127198991006, "vf_loss": 0.28943061113416674, "vf_explained_var": 0.01473815258217867, "kl": 0.008935417625085524, "entropy": 0.6336767828022992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.791116947613696, "cur_kl_coeff": 9.666855476098132e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5346308099174941, "policy_loss": -0.0032374549585655727, "vf_loss": 0.5378682644594284, "vf_explained_var": 0.7104701487790971, "kl": 0.003621322874396733, "entropy": 0.17610415289641687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "env_runners": {"episode_reward_max": 91.0, "episode_reward_min": -157.0, "episode_reward_mean": 6.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -363.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 50.0, "predator_policy": 166.0}, "policy_reward_mean": {"prey_policy": -8.22, "predator_policy": 11.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 5.0, 5.0, 20.0, 5.0, 6.0, 19.0, 6.0, 20.0, 0.0, 52.0, -19.0, 6.0, 91.0, -78.0, -52.0, 9.0, 1.0, 21.0, 33.0, 0.0, -2.0, 0.0, 17.0, -1.0, -45.0, -3.0, 0.0, 0.0, 22.0, 8.0, 8.0, 51.0, -43.0, 10.0, 68.0, 4.0, 25.0, 15.0, 12.0, -7.0, -17.0, 15.0, -1.0, -16.0, -2.0, -157.0, -1.0, -5.0, 36.0, 0.0, 22.0, -40.0, 2.0, 13.0, 8.0, 4.0, 11.0, 12.0, 20.0, 1.0, 38.0, 13.0, 4.0, 0.0, -30.0, 6.0, 2.0, 37.0, 0.0, -19.0, 9.0, 30.0, 46.0, 0.0, 0.0, 0.0, -40.0, 10.0, 21.0, 9.0, 19.0, 26.0, 6.0, 0.0, -1.0, 0.0, -9.0, 0.0, 9.0, 14.0, 27.0, 11.0, 76.0, 0.0, -12.0, 0.0, 29.0, 85.0, 18.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-91.0, 0.0, -2.0, 0.0, 0.0, -15.0, -10.0, 18.0, 0.0, 5.0, 0.0, -6.0, -44.0, 0.0, -3.0, -2.0, 9.0, 11.0, 0.0, 0.0, 32.0, -99.0, -24.0, -36.0, -7.0, -4.0, -7.0, 0.0, -234.0, 23.0, 0.0, -104.0, 0.0, 4.0, -4.0, 0.0, 22.0, -2.0, -56.0, -2.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 17.0, 0.0, -4.0, 0.0, -92.0, 1.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, -15.0, 0.0, -16.0, -127.0, 50.0, 0.0, 0.0, -363.0, 0.0, -20.0, 0.0, 29.0, 0.0, -51.0, -19.0, 2.0, 0.0, 15.0, 12.0, 0.0, -14.0, 0.0, -86.0, 19.0, 0.0, 15.0, -3.0, -2.0, -14.0, -18.0, 0.0, -9.0, -86.0, -148.0, 0.0, -2.0, 0.0, -26.0, 26.0, 0.0, 0.0, 0.0, -6.0, 18.0, -28.0, -132.0, 10.0, -29.0, 5.0, 0.0, 0.0, -10.0, 5.0, -9.0, -92.0, 19.0, -16.0, 0.0, 1.0, 10.0, 0.0, -7.0, 18.0, 20.0, 0.0, -11.0, 0.0, 4.0, 0.0, 0.0, -48.0, -6.0, -20.0, 16.0, 2.0, 0.0, 6.0, 29.0, 0.0, 0.0, 2.0, -54.0, 4.0, 0.0, 1.0, 17.0, 0.0, 46.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, -24.0, 1.0, 0.0, 13.0, -16.0, 0.0, 2.0, 19.0, 0.0, 22.0, -1.0, 3.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, -5.0, -15.0, 0.0, 0.0, 9.0, 0.0, 20.0, -12.0, 27.0, 0.0, 3.0, 0.0, 44.0, 18.0, 0.0, 0.0, -8.0, -16.0, 0.0, 0.0, -9.0, 15.0, 48.0, 37.0, 0.0, 18.0], "policy_predator_policy_reward": [0.0, 95.0, 3.0, 4.0, 6.0, 14.0, 10.0, 2.0, 0.0, 0.0, 0.0, 12.0, 31.0, 32.0, 10.0, 1.0, 0.0, 0.0, 0.0, 0.0, 68.0, 51.0, 21.0, 20.0, 7.0, 10.0, 47.0, 51.0, 16.0, 117.0, 0.0, 52.0, 0.0, 5.0, 5.0, 0.0, 0.0, 1.0, 46.0, 45.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 46.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 12.0, 79.0, 72.0, 1.0, 0.0, 166.0, 154.0, 18.0, 12.0, 25.0, 14.0, 30.0, 25.0, 23.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 43.0, 7.0, 0.0, 0.0, 4.0, 0.0, 7.0, 9.0, 7.0, 0.0, 77.0, 0.0, 0.0, 1.0, 0.0, 21.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 59.0, 61.0, 21.0, 0.0, 2.0, 6.0, 6.0, 12.0, 8.0, 0.0, 42.0, 42.0, 14.0, 14.0, 6.0, 3.0, 8.0, 0.0, 0.0, 0.0, 16.0, 8.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 27.0, 6.0, 5.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 6.0, 3.0, 3.0, 21.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.932370758430842, "mean_inference_ms": 37.09251822882061, "mean_action_processing_ms": 2.168208681946987, "mean_env_wait_ms": 2.105763251905497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019928812980651855, "StateBufferConnector_ms": 0.006366610527038574, "ViewRequirementAgentConnector_ms": 0.3423483371734619}, "num_episodes": 18, "episode_return_max": 91.0, "episode_return_min": -157.0, "episode_return_mean": 6.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 163.0790768495857, "num_env_steps_trained_throughput_per_sec": 163.0790768495857, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 2592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2592000, "timers": {"training_iteration_time_ms": 24318.571, "restore_workers_time_ms": 0.021, "training_step_time_ms": 24318.475, "sample_time_ms": 3476.779, "learn_time_ms": 20798.294, "learn_throughput": 192.323, "synch_weights_time_ms": 35.401}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "done": false, "training_iteration": 162, "trial_id": "4f45b_00000", "date": "2024-08-13_05-45-55", "timestamp": 1723542355, "time_this_iter_s": 24.596148014068604, "time_total_s": 15179.661625385284, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27d75e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15179.661625385284, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 84.82857142857142, "ram_util_percent": 83.22857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1982134498695216, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.47990062760297586, "policy_loss": -0.0007930466799292142, "vf_loss": 0.4806922213250781, "vf_explained_var": 0.004241670565630393, "kl": 0.009286045619609943, "entropy": 0.6289304145114132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.599957700601961, "cur_kl_coeff": 4.833427738049066e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6802579849539571, "policy_loss": -0.0005871389588469236, "vf_loss": 0.6808451245386133, "vf_explained_var": 0.11439105899876388, "kl": 0.0017460795499956445, "entropy": 0.18335029824227883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "env_runners": {"episode_reward_max": 85.0, "episode_reward_min": -157.0, "episode_reward_mean": 7.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -363.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 50.0, "predator_policy": 166.0}, "policy_reward_mean": {"prey_policy": -4.815, "predator_policy": 8.74}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.0, 33.0, 0.0, -2.0, 0.0, 17.0, -1.0, -45.0, -3.0, 0.0, 0.0, 22.0, 8.0, 8.0, 51.0, -43.0, 10.0, 68.0, 4.0, 25.0, 15.0, 12.0, -7.0, -17.0, 15.0, -1.0, -16.0, -2.0, -157.0, -1.0, -5.0, 36.0, 0.0, 22.0, -40.0, 2.0, 13.0, 8.0, 4.0, 11.0, 12.0, 20.0, 1.0, 38.0, 13.0, 4.0, 0.0, -30.0, 6.0, 2.0, 37.0, 0.0, -19.0, 9.0, 30.0, 46.0, 0.0, 0.0, 0.0, -40.0, 10.0, 21.0, 9.0, 19.0, 26.0, 6.0, 0.0, -1.0, 0.0, -9.0, 0.0, 9.0, 14.0, 27.0, 11.0, 76.0, 0.0, -12.0, 0.0, 29.0, 85.0, 18.0, 8.0, 7.0, 16.0, 33.0, 7.0, 25.0, -6.0, 51.0, 12.0, 34.0, 8.0, 12.0, 32.0, 10.0, 35.0, -29.0, -2.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [22.0, -2.0, -56.0, -2.0, 0.0, 0.0, -23.0, 0.0, 0.0, 0.0, 17.0, 0.0, -4.0, 0.0, -92.0, 1.0, 0.0, -10.0, 0.0, 0.0, 0.0, 0.0, 9.0, 13.0, -15.0, 0.0, -16.0, -127.0, 50.0, 0.0, 0.0, -363.0, 0.0, -20.0, 0.0, 29.0, 0.0, -51.0, -19.0, 2.0, 0.0, 15.0, 12.0, 0.0, -14.0, 0.0, -86.0, 19.0, 0.0, 15.0, -3.0, -2.0, -14.0, -18.0, 0.0, -9.0, -86.0, -148.0, 0.0, -2.0, 0.0, -26.0, 26.0, 0.0, 0.0, 0.0, -6.0, 18.0, -28.0, -132.0, 10.0, -29.0, 5.0, 0.0, 0.0, -10.0, 5.0, -9.0, -92.0, 19.0, -16.0, 0.0, 1.0, 10.0, 0.0, -7.0, 18.0, 20.0, 0.0, -11.0, 0.0, 4.0, 0.0, 0.0, -48.0, -6.0, -20.0, 16.0, 2.0, 0.0, 6.0, 29.0, 0.0, 0.0, 2.0, -54.0, 4.0, 0.0, 1.0, 17.0, 0.0, 46.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, -24.0, 1.0, 0.0, 13.0, -16.0, 0.0, 2.0, 19.0, 0.0, 22.0, -1.0, 3.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, -5.0, -15.0, 0.0, 0.0, 9.0, 0.0, 20.0, -12.0, 27.0, 0.0, 3.0, 0.0, 44.0, 18.0, 0.0, 0.0, -8.0, -16.0, 0.0, 0.0, -9.0, 15.0, 48.0, 37.0, 0.0, 18.0, 0.0, 8.0, -22.0, 0.0, 4.0, 0.0, 1.0, 15.0, 11.0, -8.0, 13.0, 2.0, 0.0, -12.0, -5.0, 50.0, 8.0, 0.0, -6.0, 30.0, -1.0, 0.0, 0.0, 0.0, 27.0, 0.0, 0.0, 4.0, 0.0, 35.0, -4.0, -54.0, 0.0, -4.0, 1.0, -2.0], "policy_predator_policy_reward": [0.0, 1.0, 46.0, 45.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 46.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 12.0, 79.0, 72.0, 1.0, 0.0, 166.0, 154.0, 18.0, 12.0, 25.0, 14.0, 30.0, 25.0, 23.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 43.0, 7.0, 0.0, 0.0, 4.0, 0.0, 7.0, 9.0, 7.0, 0.0, 77.0, 0.0, 0.0, 1.0, 0.0, 21.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 59.0, 61.0, 21.0, 0.0, 2.0, 6.0, 6.0, 12.0, 8.0, 0.0, 42.0, 42.0, 14.0, 14.0, 6.0, 3.0, 8.0, 0.0, 0.0, 0.0, 16.0, 8.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 27.0, 6.0, 5.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 6.0, 3.0, 3.0, 21.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 17.0, 0.0, 12.0, 15.0, 2.0, 0.0, 4.0, 10.0, 0.0, 0.0, 6.0, 0.0, 6.0, 4.0, 0.0, 3.0, 7.0, 5.0, 4.0, 7.0, 5.0, 0.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 29.0, 2.0, 0.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.863211533774601, "mean_inference_ms": 36.91049590226153, "mean_action_processing_ms": 2.1599161024582663, "mean_env_wait_ms": 2.097134266453135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019582509994506836, "StateBufferConnector_ms": 0.006320476531982422, "ViewRequirementAgentConnector_ms": 0.34358739852905273}, "num_episodes": 18, "episode_return_max": 85.0, "episode_return_min": -157.0, "episode_return_mean": 7.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 150.75379882641246, "num_env_steps_trained_throughput_per_sec": 150.75379882641246, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 2608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2608000, "timers": {"training_iteration_time_ms": 24602.917, "restore_workers_time_ms": 0.021, "training_step_time_ms": 24602.82, "sample_time_ms": 3580.144, "learn_time_ms": 20970.766, "learn_throughput": 190.742, "synch_weights_time_ms": 39.839}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "done": false, "training_iteration": 163, "trial_id": "4f45b_00000", "date": "2024-08-13_05-46-22", "timestamp": 1723542382, "time_this_iter_s": 26.591229915618896, "time_total_s": 15206.252855300903, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27ef700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15206.252855300903, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 88.01842105263158, "ram_util_percent": 83.28157894736843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1909754021891525, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2693750120699406, "policy_loss": -0.0016334898546880121, "vf_loss": 0.27100701983654674, "vf_explained_var": 0.028600587699779127, "kl": 0.00947435195603678, "entropy": 0.603205850736174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.805723576807471, "cur_kl_coeff": 2.416713869024533e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5556438684162915, "policy_loss": -0.0020917133423844696, "vf_loss": 0.5577355811244281, "vf_explained_var": 0.5644965238356716, "kl": 0.0037196813353414164, "entropy": 0.15413463709373323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "env_runners": {"episode_reward_max": 85.0, "episode_reward_min": -157.0, "episode_reward_mean": 8.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -232.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 50.0, "predator_policy": 116.0}, "policy_reward_mean": {"prey_policy": -1.865, "predator_policy": 5.92}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-17.0, 15.0, -1.0, -16.0, -2.0, -157.0, -1.0, -5.0, 36.0, 0.0, 22.0, -40.0, 2.0, 13.0, 8.0, 4.0, 11.0, 12.0, 20.0, 1.0, 38.0, 13.0, 4.0, 0.0, -30.0, 6.0, 2.0, 37.0, 0.0, -19.0, 9.0, 30.0, 46.0, 0.0, 0.0, 0.0, -40.0, 10.0, 21.0, 9.0, 19.0, 26.0, 6.0, 0.0, -1.0, 0.0, -9.0, 0.0, 9.0, 14.0, 27.0, 11.0, 76.0, 0.0, -12.0, 0.0, 29.0, 85.0, 18.0, 8.0, 7.0, 16.0, 33.0, 7.0, 25.0, -6.0, 51.0, 12.0, 34.0, 8.0, 12.0, 32.0, 10.0, 35.0, -29.0, -2.0, 0.0, 16.0, 0.0, -116.0, 50.0, 14.0, 11.0, 7.0, -9.0, 25.0, 21.0, 8.0, 19.0, 6.0, 23.0, 22.0, 0.0, 42.0, 0.0, 9.0, 31.0, 11.0, 28.0, 1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-86.0, 19.0, 0.0, 15.0, -3.0, -2.0, -14.0, -18.0, 0.0, -9.0, -86.0, -148.0, 0.0, -2.0, 0.0, -26.0, 26.0, 0.0, 0.0, 0.0, -6.0, 18.0, -28.0, -132.0, 10.0, -29.0, 5.0, 0.0, 0.0, -10.0, 5.0, -9.0, -92.0, 19.0, -16.0, 0.0, 1.0, 10.0, 0.0, -7.0, 18.0, 20.0, 0.0, -11.0, 0.0, 4.0, 0.0, 0.0, -48.0, -6.0, -20.0, 16.0, 2.0, 0.0, 6.0, 29.0, 0.0, 0.0, 2.0, -54.0, 4.0, 0.0, 1.0, 17.0, 0.0, 46.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, -24.0, 1.0, 0.0, 13.0, -16.0, 0.0, 2.0, 19.0, 0.0, 22.0, -1.0, 3.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, -5.0, -15.0, 0.0, 0.0, 9.0, 0.0, 20.0, -12.0, 27.0, 0.0, 3.0, 0.0, 44.0, 18.0, 0.0, 0.0, -8.0, -16.0, 0.0, 0.0, -9.0, 15.0, 48.0, 37.0, 0.0, 18.0, 0.0, 8.0, -22.0, 0.0, 4.0, 0.0, 1.0, 15.0, 11.0, -8.0, 13.0, 2.0, 0.0, -12.0, -5.0, 50.0, 8.0, 0.0, -6.0, 30.0, -1.0, 0.0, 0.0, 0.0, 27.0, 0.0, 0.0, 4.0, 0.0, 35.0, -4.0, -54.0, 0.0, -4.0, 1.0, -2.0, 0.0, 14.0, 0.0, 0.0, -232.0, 0.0, 4.0, 41.0, 14.0, 0.0, 11.0, 0.0, -2.0, 3.0, -26.0, -3.0, 14.0, 0.0, 17.0, -19.0, 0.0, -4.0, -3.0, 0.0, 10.0, -15.0, 16.0, 0.0, 7.0, 15.0, 0.0, 0.0, 41.0, 0.0, 0.0, 0.0, 6.0, 3.0, -7.0, 32.0, 0.0, 11.0, 0.0, 3.0, 0.0, -5.0], "policy_predator_policy_reward": [43.0, 7.0, 0.0, 0.0, 4.0, 0.0, 7.0, 9.0, 7.0, 0.0, 77.0, 0.0, 0.0, 1.0, 0.0, 21.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 59.0, 61.0, 21.0, 0.0, 2.0, 6.0, 6.0, 12.0, 8.0, 0.0, 42.0, 42.0, 14.0, 14.0, 6.0, 3.0, 8.0, 0.0, 0.0, 0.0, 16.0, 8.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 27.0, 6.0, 5.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 6.0, 3.0, 3.0, 21.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 17.0, 0.0, 12.0, 15.0, 2.0, 0.0, 4.0, 10.0, 0.0, 0.0, 6.0, 0.0, 6.0, 4.0, 0.0, 3.0, 7.0, 5.0, 4.0, 7.0, 5.0, 0.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 29.0, 2.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 116.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 12.0, 6.0, 5.0, 0.0, 23.0, 5.0, 7.0, 7.0, 15.0, 5.0, 6.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 8.0, 17.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 14.0895471007242, "mean_inference_ms": 36.12648707046352, "mean_action_processing_ms": 2.277118063809487, "mean_env_wait_ms": 2.2189722153369207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02544581890106201, "StateBufferConnector_ms": 0.007310748100280762, "ViewRequirementAgentConnector_ms": 0.3601112365722656}, "num_episodes": 23, "episode_return_max": 85.0, "episode_return_min": -157.0, "episode_return_mean": 8.11, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.74179308075892, "num_env_steps_trained_throughput_per_sec": 147.74179308075892, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 2624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2624000, "timers": {"training_iteration_time_ms": 24898.982, "restore_workers_time_ms": 0.022, "training_step_time_ms": 24898.886, "sample_time_ms": 3694.539, "learn_time_ms": 21148.481, "learn_throughput": 189.139, "synch_weights_time_ms": 44.595}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "done": false, "training_iteration": 164, "trial_id": "4f45b_00000", "date": "2024-08-13_05-46-49", "timestamp": 1723542409, "time_this_iter_s": 27.15080714225769, "time_total_s": 15233.403662443161, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b289f5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15233.403662443161, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 88.6736842105263, "ram_util_percent": 83.19736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4286385594694704, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3730981414516767, "policy_loss": -0.0014923458455731629, "vf_loss": 0.37458876551026676, "vf_explained_var": 0.046059532108761014, "kl": 0.01100792427633003, "entropy": 0.6455588827372859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5372972938749525, "cur_kl_coeff": 1.2083569345122665e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5116932022390227, "policy_loss": -0.002049783844914701, "vf_loss": 0.5137429862504914, "vf_explained_var": 0.3221154958167404, "kl": 0.0008593989423291327, "entropy": 0.15807761384775398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 85.0, "episode_reward_min": -116.0, "episode_reward_mean": 11.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -232.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 50.0, "predator_policy": 116.0}, "policy_reward_mean": {"prey_policy": 1.825, "predator_policy": 4.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 0.0, -30.0, 6.0, 2.0, 37.0, 0.0, -19.0, 9.0, 30.0, 46.0, 0.0, 0.0, 0.0, -40.0, 10.0, 21.0, 9.0, 19.0, 26.0, 6.0, 0.0, -1.0, 0.0, -9.0, 0.0, 9.0, 14.0, 27.0, 11.0, 76.0, 0.0, -12.0, 0.0, 29.0, 85.0, 18.0, 8.0, 7.0, 16.0, 33.0, 7.0, 25.0, -6.0, 51.0, 12.0, 34.0, 8.0, 12.0, 32.0, 10.0, 35.0, -29.0, -2.0, 0.0, 16.0, 0.0, -116.0, 50.0, 14.0, 11.0, 7.0, -9.0, 25.0, 21.0, 8.0, 19.0, 6.0, 23.0, 22.0, 0.0, 42.0, 0.0, 9.0, 31.0, 11.0, 28.0, 1.0, 45.0, 0.0, 54.0, 37.0, 16.0, 25.0, 5.0, 10.0, -8.0, 15.0, -6.0, -3.0, 10.0, 40.0, 31.0, 13.0, 0.0, 0.0, 19.0, 0.0, 0.0, 13.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 4.0, 0.0, 0.0, -48.0, -6.0, -20.0, 16.0, 2.0, 0.0, 6.0, 29.0, 0.0, 0.0, 2.0, -54.0, 4.0, 0.0, 1.0, 17.0, 0.0, 46.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -32.0, -24.0, 1.0, 0.0, 13.0, -16.0, 0.0, 2.0, 19.0, 0.0, 22.0, -1.0, 3.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, -5.0, -15.0, 0.0, 0.0, 9.0, 0.0, 20.0, -12.0, 27.0, 0.0, 3.0, 0.0, 44.0, 18.0, 0.0, 0.0, -8.0, -16.0, 0.0, 0.0, -9.0, 15.0, 48.0, 37.0, 0.0, 18.0, 0.0, 8.0, -22.0, 0.0, 4.0, 0.0, 1.0, 15.0, 11.0, -8.0, 13.0, 2.0, 0.0, -12.0, -5.0, 50.0, 8.0, 0.0, -6.0, 30.0, -1.0, 0.0, 0.0, 0.0, 27.0, 0.0, 0.0, 4.0, 0.0, 35.0, -4.0, -54.0, 0.0, -4.0, 1.0, -2.0, 0.0, 14.0, 0.0, 0.0, -232.0, 0.0, 4.0, 41.0, 14.0, 0.0, 11.0, 0.0, -2.0, 3.0, -26.0, -3.0, 14.0, 0.0, 17.0, -19.0, 0.0, -4.0, -3.0, 0.0, 10.0, -15.0, 16.0, 0.0, 7.0, 15.0, 0.0, 0.0, 41.0, 0.0, 0.0, 0.0, 6.0, 3.0, -7.0, 32.0, 0.0, 11.0, 0.0, 3.0, 0.0, -5.0, 0.0, 43.0, 0.0, 0.0, 15.0, 31.0, 35.0, 0.0, -3.0, -15.0, 2.0, 14.0, -14.0, 12.0, -7.0, 3.0, 0.0, -18.0, 0.0, 7.0, -12.0, 0.0, -4.0, -8.0, 6.0, -21.0, 17.0, 23.0, 16.0, 15.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 14.0, 5.0, 0.0, -3.0, 0.0, 0.0, 6.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 27.0, 6.0, 5.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 6.0, 3.0, 3.0, 21.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 17.0, 0.0, 12.0, 15.0, 2.0, 0.0, 4.0, 10.0, 0.0, 0.0, 6.0, 0.0, 6.0, 4.0, 0.0, 3.0, 7.0, 5.0, 4.0, 7.0, 5.0, 0.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 29.0, 2.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 116.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 12.0, 6.0, 5.0, 0.0, 23.0, 5.0, 7.0, 7.0, 15.0, 5.0, 6.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 8.0, 17.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 2.0, 0.0, 22.0, 12.0, 5.0, 4.0, 0.0, 7.0, 14.0, 0.0, 0.0, 10.0, 8.0, 0.0, 0.0, 6.0, 0.0, 9.0, 17.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.699328282958252, "mean_inference_ms": 36.47783257431439, "mean_action_processing_ms": 2.141131507837032, "mean_env_wait_ms": 2.077383180539115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02397620677947998, "StateBufferConnector_ms": 0.007197380065917969, "ViewRequirementAgentConnector_ms": 0.35469019412994385}, "num_episodes": 22, "episode_return_max": 85.0, "episode_return_min": -116.0, "episode_return_mean": 11.71, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.41358342677287, "num_env_steps_trained_throughput_per_sec": 148.41358342677287, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 25307.613, "restore_workers_time_ms": 0.045, "training_step_time_ms": 25307.491, "sample_time_ms": 3759.223, "learn_time_ms": 21492.982, "learn_throughput": 186.107, "synch_weights_time_ms": 44.069}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 165, "trial_id": "4f45b_00000", "date": "2024-08-13_05-47-16", "timestamp": 1723542436, "time_this_iter_s": 27.058043956756592, "time_total_s": 15260.461706399918, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27f0790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15260.461706399918, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 88.07894736842107, "ram_util_percent": 83.15263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7273240122924407, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5202921195241509, "policy_loss": -0.0035356504379441497, "vf_loss": 0.523825554922223, "vf_explained_var": 0.007571728015072132, "kl": 0.014161795403466656, "entropy": 0.6315114729303531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9187909439915702, "cur_kl_coeff": 6.041784672561333e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6919176259516645, "policy_loss": -0.0007494782124739633, "vf_loss": 0.6926671034878209, "vf_explained_var": 0.13356239801992184, "kl": 0.0023466005440060237, "entropy": 0.188841579357783, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "env_runners": {"episode_reward_max": 85.0, "episode_reward_min": -116.0, "episode_reward_mean": 12.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -232.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 50.0, "predator_policy": 116.0}, "policy_reward_mean": {"prey_policy": 1.965, "predator_policy": 4.215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.0, 26.0, 6.0, 0.0, -1.0, 0.0, -9.0, 0.0, 9.0, 14.0, 27.0, 11.0, 76.0, 0.0, -12.0, 0.0, 29.0, 85.0, 18.0, 8.0, 7.0, 16.0, 33.0, 7.0, 25.0, -6.0, 51.0, 12.0, 34.0, 8.0, 12.0, 32.0, 10.0, 35.0, -29.0, -2.0, 0.0, 16.0, 0.0, -116.0, 50.0, 14.0, 11.0, 7.0, -9.0, 25.0, 21.0, 8.0, 19.0, 6.0, 23.0, 22.0, 0.0, 42.0, 0.0, 9.0, 31.0, 11.0, 28.0, 1.0, 45.0, 0.0, 54.0, 37.0, 16.0, 25.0, 5.0, 10.0, -8.0, 15.0, -6.0, -3.0, 10.0, 40.0, 31.0, 13.0, 0.0, 0.0, 19.0, 0.0, 0.0, 13.0, 0.0, 40.0, 0.0, -23.0, 10.0, -9.0, -10.0, 14.0, 41.0, 41.0, 9.0, 18.0, 0.0, -7.0, 16.0, 0.0, 10.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [19.0, 0.0, 22.0, -1.0, 3.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, -5.0, -15.0, 0.0, 0.0, 9.0, 0.0, 20.0, -12.0, 27.0, 0.0, 3.0, 0.0, 44.0, 18.0, 0.0, 0.0, -8.0, -16.0, 0.0, 0.0, -9.0, 15.0, 48.0, 37.0, 0.0, 18.0, 0.0, 8.0, -22.0, 0.0, 4.0, 0.0, 1.0, 15.0, 11.0, -8.0, 13.0, 2.0, 0.0, -12.0, -5.0, 50.0, 8.0, 0.0, -6.0, 30.0, -1.0, 0.0, 0.0, 0.0, 27.0, 0.0, 0.0, 4.0, 0.0, 35.0, -4.0, -54.0, 0.0, -4.0, 1.0, -2.0, 0.0, 14.0, 0.0, 0.0, -232.0, 0.0, 4.0, 41.0, 14.0, 0.0, 11.0, 0.0, -2.0, 3.0, -26.0, -3.0, 14.0, 0.0, 17.0, -19.0, 0.0, -4.0, -3.0, 0.0, 10.0, -15.0, 16.0, 0.0, 7.0, 15.0, 0.0, 0.0, 41.0, 0.0, 0.0, 0.0, 6.0, 3.0, -7.0, 32.0, 0.0, 11.0, 0.0, 3.0, 0.0, -5.0, 0.0, 43.0, 0.0, 0.0, 15.0, 31.0, 35.0, 0.0, -3.0, -15.0, 2.0, 14.0, -14.0, 12.0, -7.0, 3.0, 0.0, -18.0, 0.0, 7.0, -12.0, 0.0, -4.0, -8.0, 6.0, -21.0, 17.0, 23.0, 16.0, 15.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 14.0, 5.0, 0.0, -3.0, 0.0, 0.0, 6.0, 0.0, -17.0, 4.0, 19.0, 21.0, 0.0, 0.0, -60.0, 0.0, -15.0, 0.0, -48.0, 15.0, 0.0, -22.0, 0.0, 0.0, 7.0, 20.0, -8.0, 33.0, 4.0, 5.0, 18.0, 0.0, 0.0, 0.0, -11.0, -8.0, 0.0, 16.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 5.0, 0.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 10.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 17.0, 0.0, 12.0, 15.0, 2.0, 0.0, 4.0, 10.0, 0.0, 0.0, 6.0, 0.0, 6.0, 4.0, 0.0, 3.0, 7.0, 5.0, 4.0, 7.0, 5.0, 0.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 29.0, 2.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 116.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 12.0, 6.0, 5.0, 0.0, 23.0, 5.0, 7.0, 7.0, 15.0, 5.0, 6.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 8.0, 17.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 2.0, 0.0, 22.0, 12.0, 5.0, 4.0, 0.0, 7.0, 14.0, 0.0, 0.0, 10.0, 8.0, 0.0, 0.0, 6.0, 0.0, 9.0, 17.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 7.0, 30.0, 11.0, 14.0, 15.0, 9.0, 0.0, 12.0, 2.0, 12.0, 14.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.633231714883713, "mean_inference_ms": 36.304135970587474, "mean_action_processing_ms": 2.133462770671647, "mean_env_wait_ms": 2.0693027445052383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021631598472595215, "StateBufferConnector_ms": 0.007151365280151367, "ViewRequirementAgentConnector_ms": 0.345342755317688}, "num_episodes": 18, "episode_return_max": 85.0, "episode_return_min": -116.0, "episode_return_mean": 12.36, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.06041170717342, "num_env_steps_trained_throughput_per_sec": 159.06041170717342, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 2656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2656000, "timers": {"training_iteration_time_ms": 25274.03, "restore_workers_time_ms": 0.045, "training_step_time_ms": 25273.908, "sample_time_ms": 3772.202, "learn_time_ms": 21444.897, "learn_throughput": 186.525, "synch_weights_time_ms": 45.714}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "done": false, "training_iteration": 166, "trial_id": "4f45b_00000", "date": "2024-08-13_05-47-42", "timestamp": 1723542462, "time_this_iter_s": 25.210866928100586, "time_total_s": 15285.672573328018, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b283ee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15285.672573328018, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 88.13055555555555, "ram_util_percent": 83.46111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9134882565292102, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4266719973355374, "policy_loss": -0.003123475666645737, "vf_loss": 0.42979327796400335, "vf_explained_var": 0.06682616645696933, "kl": 0.01402837122089697, "entropy": 0.6175594720260176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0908662369405784, "cur_kl_coeff": 3.0208923362806663e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5534689590061409, "policy_loss": -0.004848576882957584, "vf_loss": 0.5583175358633515, "vf_explained_var": 0.06725905370459985, "kl": 0.005399705794937799, "entropy": 0.16999889355566766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "env_runners": {"episode_reward_max": 54.0, "episode_reward_min": -126.0, "episode_reward_mean": 10.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -242.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 50.0, "predator_policy": 126.0}, "policy_reward_mean": {"prey_policy": 0.04, "predator_policy": 5.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, 8.0, 7.0, 16.0, 33.0, 7.0, 25.0, -6.0, 51.0, 12.0, 34.0, 8.0, 12.0, 32.0, 10.0, 35.0, -29.0, -2.0, 0.0, 16.0, 0.0, -116.0, 50.0, 14.0, 11.0, 7.0, -9.0, 25.0, 21.0, 8.0, 19.0, 6.0, 23.0, 22.0, 0.0, 42.0, 0.0, 9.0, 31.0, 11.0, 28.0, 1.0, 45.0, 0.0, 54.0, 37.0, 16.0, 25.0, 5.0, 10.0, -8.0, 15.0, -6.0, -3.0, 10.0, 40.0, 31.0, 13.0, 0.0, 0.0, 19.0, 0.0, 0.0, 13.0, 0.0, 40.0, 0.0, -23.0, 10.0, -9.0, -10.0, 14.0, 41.0, 41.0, 9.0, 18.0, 0.0, -7.0, 16.0, 0.0, 10.0, 0.0, 6.0, 0.0, 16.0, 5.0, 14.0, 0.0, 0.0, 28.0, 2.0, 23.0, 28.0, 29.0, -126.0, 19.0, 5.0, -10.0, 25.0, 8.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 18.0, 0.0, 8.0, -22.0, 0.0, 4.0, 0.0, 1.0, 15.0, 11.0, -8.0, 13.0, 2.0, 0.0, -12.0, -5.0, 50.0, 8.0, 0.0, -6.0, 30.0, -1.0, 0.0, 0.0, 0.0, 27.0, 0.0, 0.0, 4.0, 0.0, 35.0, -4.0, -54.0, 0.0, -4.0, 1.0, -2.0, 0.0, 14.0, 0.0, 0.0, -232.0, 0.0, 4.0, 41.0, 14.0, 0.0, 11.0, 0.0, -2.0, 3.0, -26.0, -3.0, 14.0, 0.0, 17.0, -19.0, 0.0, -4.0, -3.0, 0.0, 10.0, -15.0, 16.0, 0.0, 7.0, 15.0, 0.0, 0.0, 41.0, 0.0, 0.0, 0.0, 6.0, 3.0, -7.0, 32.0, 0.0, 11.0, 0.0, 3.0, 0.0, -5.0, 0.0, 43.0, 0.0, 0.0, 15.0, 31.0, 35.0, 0.0, -3.0, -15.0, 2.0, 14.0, -14.0, 12.0, -7.0, 3.0, 0.0, -18.0, 0.0, 7.0, -12.0, 0.0, -4.0, -8.0, 6.0, -21.0, 17.0, 23.0, 16.0, 15.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 14.0, 5.0, 0.0, -3.0, 0.0, 0.0, 6.0, 0.0, -17.0, 4.0, 19.0, 21.0, 0.0, 0.0, -60.0, 0.0, -15.0, 0.0, -48.0, 15.0, 0.0, -22.0, 0.0, 0.0, 7.0, 20.0, -8.0, 33.0, 4.0, 5.0, 18.0, 0.0, 0.0, 0.0, -11.0, -8.0, 0.0, 16.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -7.0, 0.0, 0.0, 0.0, 7.0, 3.0, 13.0, -16.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 11.0, -4.0, -2.0, 18.0, -6.0, 24.0, -5.0, 6.0, 15.0, -10.0, -242.0, -5.0, 1.0, 5.0, 0.0, -30.0, -5.0, 19.0, 6.0, -10.0, 8.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 12.0, 17.0, 0.0, 12.0, 15.0, 2.0, 0.0, 4.0, 10.0, 0.0, 0.0, 6.0, 0.0, 6.0, 4.0, 0.0, 3.0, 7.0, 5.0, 4.0, 7.0, 5.0, 0.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 29.0, 2.0, 0.0, 1.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 116.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 12.0, 6.0, 5.0, 0.0, 23.0, 5.0, 7.0, 7.0, 15.0, 5.0, 6.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 8.0, 17.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 2.0, 0.0, 22.0, 12.0, 5.0, 4.0, 0.0, 7.0, 14.0, 0.0, 0.0, 10.0, 8.0, 0.0, 0.0, 6.0, 0.0, 9.0, 17.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 7.0, 30.0, 11.0, 14.0, 15.0, 9.0, 0.0, 12.0, 2.0, 12.0, 14.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 7.0, 1.0, 11.0, 0.0, 1.0, 8.0, 0.0, 8.0, 126.0, 0.0, 11.0, 12.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 5.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.567782751273487, "mean_inference_ms": 36.13162730431889, "mean_action_processing_ms": 2.125768639636356, "mean_env_wait_ms": 2.061275705327825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01847696304321289, "StateBufferConnector_ms": 0.006947636604309082, "ViewRequirementAgentConnector_ms": 0.3649160861968994}, "num_episodes": 18, "episode_return_max": 54.0, "episode_return_min": -126.0, "episode_return_mean": 10.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 159.76961170065692, "num_env_steps_trained_throughput_per_sec": 159.76961170065692, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 2672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2672000, "timers": {"training_iteration_time_ms": 25385.664, "restore_workers_time_ms": 0.045, "training_step_time_ms": 25385.457, "sample_time_ms": 3794.279, "learn_time_ms": 21534.607, "learn_throughput": 185.748, "synch_weights_time_ms": 46.0}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "done": false, "training_iteration": 167, "trial_id": "4f45b_00000", "date": "2024-08-13_05-48-07", "timestamp": 1723542487, "time_this_iter_s": 25.115206718444824, "time_total_s": 15310.787780046463, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b289f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15310.787780046463, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 85.11714285714284, "ram_util_percent": 83.43428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0991973979920937, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1755992875528083, "policy_loss": -0.003057476429012481, "vf_loss": 1.1786552357610571, "vf_explained_var": 0.0014070688416718176, "kl": 0.009759374932983764, "entropy": 0.6075727446054024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0184105893764546, "cur_kl_coeff": 3.0208923362806663e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9337848308717921, "policy_loss": -0.008946128675921096, "vf_loss": 0.942730961369459, "vf_explained_var": -0.29682306934286046, "kl": 0.007556471902364699, "entropy": 0.2212943150095208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "env_runners": {"episode_reward_max": 54.0, "episode_reward_min": -156.0, "episode_reward_mean": 7.07, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 43.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -4.32, "predator_policy": 7.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 16.0, 0.0, -116.0, 50.0, 14.0, 11.0, 7.0, -9.0, 25.0, 21.0, 8.0, 19.0, 6.0, 23.0, 22.0, 0.0, 42.0, 0.0, 9.0, 31.0, 11.0, 28.0, 1.0, 45.0, 0.0, 54.0, 37.0, 16.0, 25.0, 5.0, 10.0, -8.0, 15.0, -6.0, -3.0, 10.0, 40.0, 31.0, 13.0, 0.0, 0.0, 19.0, 0.0, 0.0, 13.0, 0.0, 40.0, 0.0, -23.0, 10.0, -9.0, -10.0, 14.0, 41.0, 41.0, 9.0, 18.0, 0.0, -7.0, 16.0, 0.0, 10.0, 0.0, 6.0, 0.0, 16.0, 5.0, 14.0, 0.0, 0.0, 28.0, 2.0, 23.0, 28.0, 29.0, -126.0, 19.0, 5.0, -10.0, 25.0, 8.0, 10.0, 0.0, 27.0, 10.0, -7.0, 9.0, 29.0, -6.0, -1.0, -156.0, -12.0, 15.0, 11.0, -7.0, 3.0, 0.0, 25.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1.0, -2.0, 0.0, 14.0, 0.0, 0.0, -232.0, 0.0, 4.0, 41.0, 14.0, 0.0, 11.0, 0.0, -2.0, 3.0, -26.0, -3.0, 14.0, 0.0, 17.0, -19.0, 0.0, -4.0, -3.0, 0.0, 10.0, -15.0, 16.0, 0.0, 7.0, 15.0, 0.0, 0.0, 41.0, 0.0, 0.0, 0.0, 6.0, 3.0, -7.0, 32.0, 0.0, 11.0, 0.0, 3.0, 0.0, -5.0, 0.0, 43.0, 0.0, 0.0, 15.0, 31.0, 35.0, 0.0, -3.0, -15.0, 2.0, 14.0, -14.0, 12.0, -7.0, 3.0, 0.0, -18.0, 0.0, 7.0, -12.0, 0.0, -4.0, -8.0, 6.0, -21.0, 17.0, 23.0, 16.0, 15.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 14.0, 5.0, 0.0, -3.0, 0.0, 0.0, 6.0, 0.0, -17.0, 4.0, 19.0, 21.0, 0.0, 0.0, -60.0, 0.0, -15.0, 0.0, -48.0, 15.0, 0.0, -22.0, 0.0, 0.0, 7.0, 20.0, -8.0, 33.0, 4.0, 5.0, 18.0, 0.0, 0.0, 0.0, -11.0, -8.0, 0.0, 16.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -7.0, 0.0, 0.0, 0.0, 7.0, 3.0, 13.0, -16.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 11.0, -4.0, -2.0, 18.0, -6.0, 24.0, -5.0, 6.0, 15.0, -10.0, -242.0, -5.0, 1.0, 5.0, 0.0, -30.0, -5.0, 19.0, 6.0, -10.0, 8.0, 0.0, -4.0, -28.0, 0.0, 13.0, 6.0, 7.0, 0.0, -9.0, -8.0, 0.0, -1.0, 13.0, 14.0, -16.0, -3.0, 0.0, -13.0, -8.0, -324.0, -8.0, -14.0, 5.0, 9.0, 0.0, 9.0, 0.0, -390.0, -14.0, -10.0, 0.0, 0.0, 26.0, -14.0, 0.0, 0.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 116.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 12.0, 6.0, 5.0, 0.0, 23.0, 5.0, 7.0, 7.0, 15.0, 5.0, 6.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 8.0, 17.0, 6.0, 0.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 2.0, 0.0, 22.0, 12.0, 5.0, 4.0, 0.0, 7.0, 14.0, 0.0, 0.0, 10.0, 8.0, 0.0, 0.0, 6.0, 0.0, 9.0, 17.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 7.0, 30.0, 11.0, 14.0, 15.0, 9.0, 0.0, 12.0, 2.0, 12.0, 14.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 7.0, 1.0, 11.0, 0.0, 1.0, 8.0, 0.0, 8.0, 126.0, 0.0, 11.0, 12.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 5.0, 5.0, 0.0, 14.0, 8.0, 20.0, 0.0, 8.0, 0.0, 3.0, 10.0, 0.0, 6.0, 4.0, 2.0, 0.0, 4.0, 9.0, 7.0, 5.0, 0.0, 176.0, 7.0, 3.0, 0.0, 1.0, 2.0, 0.0, 192.0, 191.0, 12.0, 15.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.503364966361046, "mean_inference_ms": 35.96217114092794, "mean_action_processing_ms": 2.118302524239976, "mean_env_wait_ms": 2.053639821533219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02738046646118164, "StateBufferConnector_ms": 0.006966710090637207, "ViewRequirementAgentConnector_ms": 0.33642470836639404}, "num_episodes": 18, "episode_return_max": 54.0, "episode_return_min": -156.0, "episode_return_mean": 7.07, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.9567109332694, "num_env_steps_trained_throughput_per_sec": 148.9567109332694, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2688000, "timers": {"training_iteration_time_ms": 25382.812, "restore_workers_time_ms": 0.045, "training_step_time_ms": 25382.627, "sample_time_ms": 3808.604, "learn_time_ms": 21516.463, "learn_throughput": 185.904, "synch_weights_time_ms": 48.061}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "done": false, "training_iteration": 168, "trial_id": "4f45b_00000", "date": "2024-08-13_05-48-34", "timestamp": 1723542514, "time_this_iter_s": 26.93499493598938, "time_total_s": 15337.722774982452, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b289fee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15337.722774982452, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 85.52368421052631, "ram_util_percent": 83.3842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.132407398040963, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2776601878738907, "policy_loss": -0.000862486350039641, "vf_loss": 1.2785215721559273, "vf_explained_var": 3.2939261229580676e-05, "kl": 0.007042381523899916, "entropy": 0.5848019977568318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.397285870931767, "cur_kl_coeff": 3.0208923362806663e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1639714545989164, "policy_loss": -0.0038252555043313398, "vf_loss": 1.1677967091243733, "vf_explained_var": -0.37983650126785196, "kl": 0.0031684437807054126, "entropy": 0.23930075088979075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "env_runners": {"episode_reward_max": 41.0, "episode_reward_min": -156.0, "episode_reward_mean": 2.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 35.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -8.925, "predator_policy": 10.355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.0, 16.0, 25.0, 5.0, 10.0, -8.0, 15.0, -6.0, -3.0, 10.0, 40.0, 31.0, 13.0, 0.0, 0.0, 19.0, 0.0, 0.0, 13.0, 0.0, 40.0, 0.0, -23.0, 10.0, -9.0, -10.0, 14.0, 41.0, 41.0, 9.0, 18.0, 0.0, -7.0, 16.0, 0.0, 10.0, 0.0, 6.0, 0.0, 16.0, 5.0, 14.0, 0.0, 0.0, 28.0, 2.0, 23.0, 28.0, 29.0, -126.0, 19.0, 5.0, -10.0, 25.0, 8.0, 10.0, 0.0, 27.0, 10.0, -7.0, 9.0, 29.0, -6.0, -1.0, -156.0, -12.0, 15.0, 11.0, -7.0, 3.0, 0.0, 25.0, 0.0, 0.0, -11.0, 2.0, 31.0, -7.0, 31.0, -73.0, 19.0, -34.0, 0.0, 9.0, 17.0, -8.0, -74.0, 6.0, 0.0, -47.0, 6.0, 0.0, 0.0, 21.0, 9.0, -6.0, 0.0, 6.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [35.0, 0.0, -3.0, -15.0, 2.0, 14.0, -14.0, 12.0, -7.0, 3.0, 0.0, -18.0, 0.0, 7.0, -12.0, 0.0, -4.0, -8.0, 6.0, -21.0, 17.0, 23.0, 16.0, 15.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 14.0, 5.0, 0.0, -3.0, 0.0, 0.0, 6.0, 0.0, -17.0, 4.0, 19.0, 21.0, 0.0, 0.0, -60.0, 0.0, -15.0, 0.0, -48.0, 15.0, 0.0, -22.0, 0.0, 0.0, 7.0, 20.0, -8.0, 33.0, 4.0, 5.0, 18.0, 0.0, 0.0, 0.0, -11.0, -8.0, 0.0, 16.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -7.0, 0.0, 0.0, 0.0, 7.0, 3.0, 13.0, -16.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 11.0, -4.0, -2.0, 18.0, -6.0, 24.0, -5.0, 6.0, 15.0, -10.0, -242.0, -5.0, 1.0, 5.0, 0.0, -30.0, -5.0, 19.0, 6.0, -10.0, 8.0, 0.0, -4.0, -28.0, 0.0, 13.0, 6.0, 7.0, 0.0, -9.0, -8.0, 0.0, -1.0, 13.0, 14.0, -16.0, -3.0, 0.0, -13.0, -8.0, -324.0, -8.0, -14.0, 5.0, 9.0, 0.0, 9.0, 0.0, -390.0, -14.0, -10.0, 0.0, 0.0, 26.0, -14.0, 0.0, 0.0, 0.0, -7.0, -14.0, -8.0, 0.0, -1.0, -15.0, 17.0, 0.0, -14.0, 19.0, -7.0, -3.0, -197.0, 0.0, 19.0, 0.0, -186.0, 0.0, 0.0, -1.0, 0.0, 17.0, 0.0, 1.0, -24.0, -191.0, -2.0, 6.0, 0.0, 0.0, 0.0, -231.0, -33.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, -3.0, 11.0, -13.0, 6.0, -10.0, -2.0, 0.0, 0.0, -5.0, 0.0, 0.0, -4.0, -18.0, 9.0], "policy_predator_policy_reward": [2.0, 0.0, 22.0, 12.0, 5.0, 4.0, 0.0, 7.0, 14.0, 0.0, 0.0, 10.0, 8.0, 0.0, 0.0, 6.0, 0.0, 9.0, 17.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 7.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 7.0, 30.0, 11.0, 14.0, 15.0, 9.0, 0.0, 12.0, 2.0, 12.0, 14.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 7.0, 1.0, 11.0, 0.0, 1.0, 8.0, 0.0, 8.0, 126.0, 0.0, 11.0, 12.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 5.0, 5.0, 0.0, 14.0, 8.0, 20.0, 0.0, 8.0, 0.0, 3.0, 10.0, 0.0, 6.0, 4.0, 2.0, 0.0, 4.0, 9.0, 7.0, 5.0, 0.0, 176.0, 7.0, 3.0, 0.0, 1.0, 2.0, 0.0, 192.0, 191.0, 12.0, 15.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 7.0, 0.0, 7.0, 4.0, 0.0, 3.0, 17.0, 12.0, 0.0, 7.0, 9.0, 10.0, 124.0, 3.0, 0.0, 0.0, 66.0, 86.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 12.0, 3.0, 116.0, 0.0, 0.0, 0.0, 0.0, 140.0, 77.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 6.0, 10.0, 1.0, 5.0, 0.0, 0.0, 1.0, 10.0, 0.0, 4.0, 9.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.693693142284971, "mean_inference_ms": 35.426392613358125, "mean_action_processing_ms": 2.105800626817245, "mean_env_wait_ms": 2.0415123607183308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02088451385498047, "StateBufferConnector_ms": 0.007262706756591797, "ViewRequirementAgentConnector_ms": 0.3114668130874634}, "num_episodes": 27, "episode_return_max": 41.0, "episode_return_min": -156.0, "episode_return_mean": 2.86, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 154.29488023401532, "num_env_steps_trained_throughput_per_sec": 154.29488023401532, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 2704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2704000, "timers": {"training_iteration_time_ms": 25672.714, "restore_workers_time_ms": 0.045, "training_step_time_ms": 25672.528, "sample_time_ms": 3861.629, "learn_time_ms": 21747.629, "learn_throughput": 183.928, "synch_weights_time_ms": 54.027}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "done": false, "training_iteration": 169, "trial_id": "4f45b_00000", "date": "2024-08-13_05-49-00", "timestamp": 1723542540, "time_this_iter_s": 25.977938890457153, "time_total_s": 15363.70071387291, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2897310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15363.70071387291, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 83.51891891891891, "ram_util_percent": 82.92972972972974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1247085271215944, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7771372833579937, "policy_loss": -0.0009752911084366066, "vf_loss": 2.7781116460366224, "vf_explained_var": 0.002344881699829505, "kl": 0.00595215697218342, "entropy": 0.6062452817089343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2167348004049723, "cur_kl_coeff": 1.5104461681403332e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.305437157835279, "policy_loss": -0.002045988176441776, "vf_loss": 2.3074831533053564, "vf_explained_var": -0.33962029653882225, "kl": 0.004001535730878592, "entropy": 0.3584869233625276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 149.0, "episode_reward_min": -156.0, "episode_reward_mean": 1.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 151.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -14.315, "predator_policy": 15.025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.0, 0.0, 40.0, 0.0, -23.0, 10.0, -9.0, -10.0, 14.0, 41.0, 41.0, 9.0, 18.0, 0.0, -7.0, 16.0, 0.0, 10.0, 0.0, 6.0, 0.0, 16.0, 5.0, 14.0, 0.0, 0.0, 28.0, 2.0, 23.0, 28.0, 29.0, -126.0, 19.0, 5.0, -10.0, 25.0, 8.0, 10.0, 0.0, 27.0, 10.0, -7.0, 9.0, 29.0, -6.0, -1.0, -156.0, -12.0, 15.0, 11.0, -7.0, 3.0, 0.0, 25.0, 0.0, 0.0, -11.0, 2.0, 31.0, -7.0, 31.0, -73.0, 19.0, -34.0, 0.0, 9.0, 17.0, -8.0, -74.0, 6.0, 0.0, -47.0, 6.0, 0.0, 0.0, 21.0, 9.0, -6.0, 0.0, 6.0, 0.0, 0.0, 7.0, -87.0, 59.0, 18.0, -41.0, -39.0, 0.0, -3.0, 149.0, 34.0, -39.0, 19.0, 18.0, 29.0, 10.0, -70.0, 0.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, 0.0, -17.0, 4.0, 19.0, 21.0, 0.0, 0.0, -60.0, 0.0, -15.0, 0.0, -48.0, 15.0, 0.0, -22.0, 0.0, 0.0, 7.0, 20.0, -8.0, 33.0, 4.0, 5.0, 18.0, 0.0, 0.0, 0.0, -11.0, -8.0, 0.0, 16.0, 0.0, 0.0, 0.0, -2.0, 0.0, 0.0, -7.0, 0.0, 0.0, 0.0, 7.0, 3.0, 13.0, -16.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 11.0, -4.0, -2.0, 18.0, -6.0, 24.0, -5.0, 6.0, 15.0, -10.0, -242.0, -5.0, 1.0, 5.0, 0.0, -30.0, -5.0, 19.0, 6.0, -10.0, 8.0, 0.0, -4.0, -28.0, 0.0, 13.0, 6.0, 7.0, 0.0, -9.0, -8.0, 0.0, -1.0, 13.0, 14.0, -16.0, -3.0, 0.0, -13.0, -8.0, -324.0, -8.0, -14.0, 5.0, 9.0, 0.0, 9.0, 0.0, -390.0, -14.0, -10.0, 0.0, 0.0, 26.0, -14.0, 0.0, 0.0, 0.0, -7.0, -14.0, -8.0, 0.0, -1.0, -15.0, 17.0, 0.0, -14.0, 19.0, -7.0, -3.0, -197.0, 0.0, 19.0, 0.0, -186.0, 0.0, 0.0, -1.0, 0.0, 17.0, 0.0, 1.0, -24.0, -191.0, -2.0, 6.0, 0.0, 0.0, 0.0, -231.0, -33.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, -3.0, 11.0, -13.0, 6.0, -10.0, -2.0, 0.0, 0.0, -5.0, 0.0, 0.0, -4.0, -18.0, 9.0, -4.0, 9.0, -11.0, -207.0, 47.0, -57.0, 3.0, -11.0, 0.0, -207.0, -232.0, 0.0, 0.0, 0.0, -6.0, 0.0, 151.0, -9.0, 10.0, -10.0, 23.0, -179.0, -58.0, 0.0, 18.0, 0.0, 17.0, 12.0, -20.0, 20.0, 0.0, -277.0, 0.0, 0.0, -25.0, 0.0], "policy_predator_policy_reward": [0.0, 7.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 7.0, 30.0, 11.0, 14.0, 15.0, 9.0, 0.0, 12.0, 2.0, 12.0, 14.0, 0.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 8.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 7.0, 1.0, 11.0, 0.0, 1.0, 8.0, 0.0, 8.0, 126.0, 0.0, 11.0, 12.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 5.0, 5.0, 0.0, 14.0, 8.0, 20.0, 0.0, 8.0, 0.0, 3.0, 10.0, 0.0, 6.0, 4.0, 2.0, 0.0, 4.0, 9.0, 7.0, 5.0, 0.0, 176.0, 7.0, 3.0, 0.0, 1.0, 2.0, 0.0, 192.0, 191.0, 12.0, 15.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 7.0, 0.0, 7.0, 4.0, 0.0, 3.0, 17.0, 12.0, 0.0, 7.0, 9.0, 10.0, 124.0, 3.0, 0.0, 0.0, 66.0, 86.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 12.0, 3.0, 116.0, 0.0, 0.0, 0.0, 0.0, 140.0, 77.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 6.0, 10.0, 1.0, 5.0, 0.0, 0.0, 1.0, 10.0, 0.0, 4.0, 9.0, 0.0, 0.0, 2.0, 0.0, 131.0, 0.0, 69.0, 12.0, 14.0, 88.0, 78.0, 96.0, 97.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 5.0, 29.0, 0.0, 117.0, 45.0, 32.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 129.0, 78.0, 0.0, 0.0, 0.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.347602154676615, "mean_inference_ms": 35.5534267245189, "mean_action_processing_ms": 2.09958812745267, "mean_env_wait_ms": 2.0344835002621875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017952322959899902, "StateBufferConnector_ms": 0.007750749588012695, "ViewRequirementAgentConnector_ms": 0.3091585636138916}, "num_episodes": 18, "episode_return_max": 149.0, "episode_return_min": -156.0, "episode_return_mean": 1.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.85212069440837, "num_env_steps_trained_throughput_per_sec": 155.85212069440837, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 25811.494, "restore_workers_time_ms": 0.046, "training_step_time_ms": 25811.307, "sample_time_ms": 3889.298, "learn_time_ms": 21859.859, "learn_throughput": 182.984, "synch_weights_time_ms": 53.295}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 170, "trial_id": "4f45b_00000", "date": "2024-08-13_05-49-26", "timestamp": 1723542566, "time_this_iter_s": 25.7550151348114, "time_total_s": 15389.455729007721, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2830f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15389.455729007721, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 83.05555555555556, "ram_util_percent": 83.27499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7507738333294, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8734762708976787, "policy_loss": -0.0019830578580873194, "vf_loss": 0.8754579235991788, "vf_explained_var": 0.0025815657206944057, "kl": 0.008969307257039245, "entropy": 0.615949433631998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.314699831021526, "cur_kl_coeff": 7.552230840701666e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8731830637428969, "policy_loss": -0.003911440086023754, "vf_loss": 0.877094504647154, "vf_explained_var": -0.47770322577032465, "kl": 0.0029119262242554298, "entropy": 0.24121071529924554, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "env_runners": {"episode_reward_max": 149.0, "episode_reward_min": -156.0, "episode_reward_mean": -0.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 151.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -15.38, "predator_policy": 15.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 6.0, 0.0, 16.0, 5.0, 14.0, 0.0, 0.0, 28.0, 2.0, 23.0, 28.0, 29.0, -126.0, 19.0, 5.0, -10.0, 25.0, 8.0, 10.0, 0.0, 27.0, 10.0, -7.0, 9.0, 29.0, -6.0, -1.0, -156.0, -12.0, 15.0, 11.0, -7.0, 3.0, 0.0, 25.0, 0.0, 0.0, -11.0, 2.0, 31.0, -7.0, 31.0, -73.0, 19.0, -34.0, 0.0, 9.0, 17.0, -8.0, -74.0, 6.0, 0.0, -47.0, 6.0, 0.0, 0.0, 21.0, 9.0, -6.0, 0.0, 6.0, 0.0, 0.0, 7.0, -87.0, 59.0, 18.0, -41.0, -39.0, 0.0, -3.0, 149.0, 34.0, -39.0, 19.0, 18.0, 29.0, 10.0, -70.0, 0.0, -4.0, 0.0, 5.0, -4.0, 8.0, 11.0, -5.0, -28.0, 4.0, 11.0, 7.0, 0.0, 2.0, -3.0, 9.0, -11.0, 1.0, -24.0, 17.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -7.0, 0.0, 0.0, 0.0, 7.0, 3.0, 13.0, -16.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 8.0, 11.0, -4.0, -2.0, 18.0, -6.0, 24.0, -5.0, 6.0, 15.0, -10.0, -242.0, -5.0, 1.0, 5.0, 0.0, -30.0, -5.0, 19.0, 6.0, -10.0, 8.0, 0.0, -4.0, -28.0, 0.0, 13.0, 6.0, 7.0, 0.0, -9.0, -8.0, 0.0, -1.0, 13.0, 14.0, -16.0, -3.0, 0.0, -13.0, -8.0, -324.0, -8.0, -14.0, 5.0, 9.0, 0.0, 9.0, 0.0, -390.0, -14.0, -10.0, 0.0, 0.0, 26.0, -14.0, 0.0, 0.0, 0.0, -7.0, -14.0, -8.0, 0.0, -1.0, -15.0, 17.0, 0.0, -14.0, 19.0, -7.0, -3.0, -197.0, 0.0, 19.0, 0.0, -186.0, 0.0, 0.0, -1.0, 0.0, 17.0, 0.0, 1.0, -24.0, -191.0, -2.0, 6.0, 0.0, 0.0, 0.0, -231.0, -33.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, -3.0, 11.0, -13.0, 6.0, -10.0, -2.0, 0.0, 0.0, -5.0, 0.0, 0.0, -4.0, -18.0, 9.0, -4.0, 9.0, -11.0, -207.0, 47.0, -57.0, 3.0, -11.0, 0.0, -207.0, -232.0, 0.0, 0.0, 0.0, -6.0, 0.0, 151.0, -9.0, 10.0, -10.0, 23.0, -179.0, -58.0, 0.0, 18.0, 0.0, 17.0, 12.0, -20.0, 20.0, 0.0, -277.0, 0.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, -10.0, -8.0, 0.0, -2.0, -1.0, 0.0, 5.0, -10.0, 0.0, -14.0, -66.0, 4.0, 0.0, 0.0, 11.0, 0.0, -2.0, 0.0, 0.0, -61.0, 0.0, 0.0, -6.0, 0.0, 2.0, -4.0, -18.0, -35.0, -4.0, -18.0, -16.0, 0.0, 17.0], "policy_predator_policy_reward": [0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 2.0, 7.0, 1.0, 11.0, 0.0, 1.0, 8.0, 0.0, 8.0, 126.0, 0.0, 11.0, 12.0, 0.0, 0.0, 15.0, 10.0, 0.0, 0.0, 5.0, 5.0, 0.0, 14.0, 8.0, 20.0, 0.0, 8.0, 0.0, 3.0, 10.0, 0.0, 6.0, 4.0, 2.0, 0.0, 4.0, 9.0, 7.0, 5.0, 0.0, 176.0, 7.0, 3.0, 0.0, 1.0, 2.0, 0.0, 192.0, 191.0, 12.0, 15.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 7.0, 0.0, 7.0, 4.0, 0.0, 3.0, 17.0, 12.0, 0.0, 7.0, 9.0, 10.0, 124.0, 3.0, 0.0, 0.0, 66.0, 86.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 12.0, 3.0, 116.0, 0.0, 0.0, 0.0, 0.0, 140.0, 77.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 6.0, 10.0, 1.0, 5.0, 0.0, 0.0, 1.0, 10.0, 0.0, 4.0, 9.0, 0.0, 0.0, 2.0, 0.0, 131.0, 0.0, 69.0, 12.0, 14.0, 88.0, 78.0, 96.0, 97.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 5.0, 29.0, 0.0, 117.0, 45.0, 32.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 129.0, 78.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 8.0, 7.0, 0.0, 4.0, 5.0, 6.0, 6.0, 0.0, 0.0, 5.0, 7.0, 45.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 16.0, 47.0, 0.0, 3.0, 7.0, 0.0, 0.0, 11.0, 31.0, 9.0, 10.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.285773541909608, "mean_inference_ms": 35.391111249728226, "mean_action_processing_ms": 2.092578638108589, "mean_env_wait_ms": 2.0271570719379324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01769864559173584, "StateBufferConnector_ms": 0.007517457008361816, "ViewRequirementAgentConnector_ms": 0.30697619915008545}, "num_episodes": 18, "episode_return_max": 149.0, "episode_return_min": -156.0, "episode_return_mean": -0.21, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.74071135766366, "num_env_steps_trained_throughput_per_sec": 151.74071135766366, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 2736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2736000, "timers": {"training_iteration_time_ms": 26007.506, "restore_workers_time_ms": 0.047, "training_step_time_ms": 26007.316, "sample_time_ms": 4002.311, "learn_time_ms": 21946.743, "learn_throughput": 182.259, "synch_weights_time_ms": 50.301}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "done": false, "training_iteration": 171, "trial_id": "4f45b_00000", "date": "2024-08-13_05-49-52", "timestamp": 1723542592, "time_this_iter_s": 26.442927837371826, "time_total_s": 15415.898656845093, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27c0dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15415.898656845093, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 83.86756756756758, "ram_util_percent": 83.07297297297298}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.202289698355728, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7038938586043302, "policy_loss": -0.0014116538858543785, "vf_loss": 0.7053042516506538, "vf_explained_var": 0.001989395782430336, "kl": 0.008060405436742867, "entropy": 0.6194436278923479, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.583602296186503, "cur_kl_coeff": 3.776115420350833e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0117894084680648, "policy_loss": -0.0026726328378553115, "vf_loss": 1.0144620419652373, "vf_explained_var": 0.10366365092772024, "kl": 0.003757844652115465, "entropy": 0.2062709361630142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "env_runners": {"episode_reward_max": 149.0, "episode_reward_min": -156.0, "episode_reward_mean": 0.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -390.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 151.0, "predator_policy": 192.0}, "policy_reward_mean": {"prey_policy": -15.735, "predator_policy": 15.94}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.0, 10.0, 0.0, 27.0, 10.0, -7.0, 9.0, 29.0, -6.0, -1.0, -156.0, -12.0, 15.0, 11.0, -7.0, 3.0, 0.0, 25.0, 0.0, 0.0, -11.0, 2.0, 31.0, -7.0, 31.0, -73.0, 19.0, -34.0, 0.0, 9.0, 17.0, -8.0, -74.0, 6.0, 0.0, -47.0, 6.0, 0.0, 0.0, 21.0, 9.0, -6.0, 0.0, 6.0, 0.0, 0.0, 7.0, -87.0, 59.0, 18.0, -41.0, -39.0, 0.0, -3.0, 149.0, 34.0, -39.0, 19.0, 18.0, 29.0, 10.0, -70.0, 0.0, -4.0, 0.0, 5.0, -4.0, 8.0, 11.0, -5.0, -28.0, 4.0, 11.0, 7.0, 0.0, 2.0, -3.0, 9.0, -11.0, 1.0, -24.0, 17.0, 0.0, -3.0, 0.0, 0.0, -12.0, 94.0, 0.0, 0.0, 10.0, 35.0, -23.0, 7.0, 3.0, 13.0, -8.0, 4.0, 13.0, -7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-10.0, 8.0, 0.0, -4.0, -28.0, 0.0, 13.0, 6.0, 7.0, 0.0, -9.0, -8.0, 0.0, -1.0, 13.0, 14.0, -16.0, -3.0, 0.0, -13.0, -8.0, -324.0, -8.0, -14.0, 5.0, 9.0, 0.0, 9.0, 0.0, -390.0, -14.0, -10.0, 0.0, 0.0, 26.0, -14.0, 0.0, 0.0, 0.0, -7.0, -14.0, -8.0, 0.0, -1.0, -15.0, 17.0, 0.0, -14.0, 19.0, -7.0, -3.0, -197.0, 0.0, 19.0, 0.0, -186.0, 0.0, 0.0, -1.0, 0.0, 17.0, 0.0, 1.0, -24.0, -191.0, -2.0, 6.0, 0.0, 0.0, 0.0, -231.0, -33.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, -3.0, 11.0, -13.0, 6.0, -10.0, -2.0, 0.0, 0.0, -5.0, 0.0, 0.0, -4.0, -18.0, 9.0, -4.0, 9.0, -11.0, -207.0, 47.0, -57.0, 3.0, -11.0, 0.0, -207.0, -232.0, 0.0, 0.0, 0.0, -6.0, 0.0, 151.0, -9.0, 10.0, -10.0, 23.0, -179.0, -58.0, 0.0, 18.0, 0.0, 17.0, 12.0, -20.0, 20.0, 0.0, -277.0, 0.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, -10.0, -8.0, 0.0, -2.0, -1.0, 0.0, 5.0, -10.0, 0.0, -14.0, -66.0, 4.0, 0.0, 0.0, 11.0, 0.0, -2.0, 0.0, 0.0, -61.0, 0.0, 0.0, -6.0, 0.0, 2.0, -4.0, -18.0, -35.0, -4.0, -18.0, -16.0, 0.0, 17.0, -2.0, -16.0, -34.0, 0.0, 0.0, 0.0, 0.0, 0.0, -24.0, 0.0, 0.0, 94.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 9.0, 23.0, -10.0, -203.0, 3.0, 0.0, 1.0, 0.0, -27.0, -12.0, -8.0, -8.0, 0.0, 3.0, 0.0, -42.0, -4.0, -10.0], "policy_predator_policy_reward": [5.0, 5.0, 0.0, 14.0, 8.0, 20.0, 0.0, 8.0, 0.0, 3.0, 10.0, 0.0, 6.0, 4.0, 2.0, 0.0, 4.0, 9.0, 7.0, 5.0, 0.0, 176.0, 7.0, 3.0, 0.0, 1.0, 2.0, 0.0, 192.0, 191.0, 12.0, 15.0, 0.0, 0.0, 6.0, 7.0, 0.0, 0.0, 7.0, 0.0, 7.0, 4.0, 0.0, 3.0, 17.0, 12.0, 0.0, 7.0, 9.0, 10.0, 124.0, 3.0, 0.0, 0.0, 66.0, 86.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 12.0, 3.0, 116.0, 0.0, 0.0, 0.0, 0.0, 140.0, 77.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 6.0, 10.0, 1.0, 5.0, 0.0, 0.0, 1.0, 10.0, 0.0, 4.0, 9.0, 0.0, 0.0, 2.0, 0.0, 131.0, 0.0, 69.0, 12.0, 14.0, 88.0, 78.0, 96.0, 97.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 5.0, 29.0, 0.0, 117.0, 45.0, 32.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 129.0, 78.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 8.0, 7.0, 0.0, 4.0, 5.0, 6.0, 6.0, 0.0, 0.0, 5.0, 7.0, 45.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 16.0, 47.0, 0.0, 3.0, 7.0, 0.0, 0.0, 11.0, 31.0, 9.0, 10.0, 0.0, 0.0, 0.0, 3.0, 15.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 76.0, 114.0, 4.0, 0.0, 2.0, 0.0, 24.0, 28.0, 4.0, 4.0, 1.0, 0.0, 55.0, 0.0, 5.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.225136492527698, "mean_inference_ms": 35.23203509816399, "mean_action_processing_ms": 2.0858319653387443, "mean_env_wait_ms": 2.0201021516064976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017733216285705566, "StateBufferConnector_ms": 0.007582426071166992, "ViewRequirementAgentConnector_ms": 0.30555975437164307}, "num_episodes": 18, "episode_return_max": 149.0, "episode_return_min": -156.0, "episode_return_mean": 0.41, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 147.08078256033093, "num_env_steps_trained_throughput_per_sec": 147.08078256033093, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2752000, "timers": {"training_iteration_time_ms": 26274.302, "restore_workers_time_ms": 0.048, "training_step_time_ms": 26274.111, "sample_time_ms": 4031.099, "learn_time_ms": 22181.188, "learn_throughput": 180.333, "synch_weights_time_ms": 53.945}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "done": false, "training_iteration": 172, "trial_id": "4f45b_00000", "date": "2024-08-13_05-50-20", "timestamp": 1723542620, "time_this_iter_s": 27.21843695640564, "time_total_s": 15443.117093801498, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28bf5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15443.117093801498, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 85.3157894736842, "ram_util_percent": 83.02105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.946276607250095, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7785557560977482, "policy_loss": -0.0010404017261135831, "vf_loss": 0.7795944832541325, "vf_explained_var": 0.0005214074932078205, "kl": 0.010704891210637123, "entropy": 0.6073656384434019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.402557223948537, "cur_kl_coeff": 1.8880577101754164e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1707086253891545, "policy_loss": -0.0011123584891378723, "vf_loss": 1.1718209784813027, "vf_explained_var": 0.09545225639822622, "kl": 0.001811288836159935, "entropy": 0.20869490762866993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "env_runners": {"episode_reward_max": 149.0, "episode_reward_min": -87.0, "episode_reward_mean": 2.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -277.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 151.0, "predator_policy": 140.0}, "policy_reward_mean": {"prey_policy": -12.78, "predator_policy": 13.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, 31.0, -73.0, 19.0, -34.0, 0.0, 9.0, 17.0, -8.0, -74.0, 6.0, 0.0, -47.0, 6.0, 0.0, 0.0, 21.0, 9.0, -6.0, 0.0, 6.0, 0.0, 0.0, 7.0, -87.0, 59.0, 18.0, -41.0, -39.0, 0.0, -3.0, 149.0, 34.0, -39.0, 19.0, 18.0, 29.0, 10.0, -70.0, 0.0, -4.0, 0.0, 5.0, -4.0, 8.0, 11.0, -5.0, -28.0, 4.0, 11.0, 7.0, 0.0, 2.0, -3.0, 9.0, -11.0, 1.0, -24.0, 17.0, 0.0, -3.0, 0.0, 0.0, -12.0, 94.0, 0.0, 0.0, 10.0, 35.0, -23.0, 7.0, 3.0, 13.0, -8.0, 4.0, 13.0, -7.0, 17.0, 3.0, 87.0, 24.0, -3.0, 16.0, 0.0, 45.0, 11.0, 3.0, 0.0, 15.0, -5.0, 12.0, -73.0, -3.0, 70.0, 3.0, -60.0, 0.0, 3.0, 14.0, -4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -14.0, 19.0, -7.0, -3.0, -197.0, 0.0, 19.0, 0.0, -186.0, 0.0, 0.0, -1.0, 0.0, 17.0, 0.0, 1.0, -24.0, -191.0, -2.0, 6.0, 0.0, 0.0, 0.0, -231.0, -33.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, -3.0, 11.0, -13.0, 6.0, -10.0, -2.0, 0.0, 0.0, -5.0, 0.0, 0.0, -4.0, -18.0, 9.0, -4.0, 9.0, -11.0, -207.0, 47.0, -57.0, 3.0, -11.0, 0.0, -207.0, -232.0, 0.0, 0.0, 0.0, -6.0, 0.0, 151.0, -9.0, 10.0, -10.0, 23.0, -179.0, -58.0, 0.0, 18.0, 0.0, 17.0, 12.0, -20.0, 20.0, 0.0, -277.0, 0.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, -10.0, -8.0, 0.0, -2.0, -1.0, 0.0, 5.0, -10.0, 0.0, -14.0, -66.0, 4.0, 0.0, 0.0, 11.0, 0.0, -2.0, 0.0, 0.0, -61.0, 0.0, 0.0, -6.0, 0.0, 2.0, -4.0, -18.0, -35.0, -4.0, -18.0, -16.0, 0.0, 17.0, -2.0, -16.0, -34.0, 0.0, 0.0, 0.0, 0.0, 0.0, -24.0, 0.0, 0.0, 94.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 9.0, 23.0, -10.0, -203.0, 3.0, 0.0, 1.0, 0.0, -27.0, -12.0, -8.0, -8.0, 0.0, 3.0, 0.0, -42.0, -4.0, -10.0, 17.0, 0.0, -11.0, 0.0, 87.0, 0.0, 15.0, 8.0, 2.0, -72.0, 0.0, 16.0, 0.0, 0.0, 5.0, 24.0, -9.0, -20.0, 0.0, 3.0, 0.0, 0.0, 1.0, 3.0, -15.0, 1.0, -11.0, 5.0, 9.0, -164.0, 0.0, -6.0, -3.0, 39.0, 1.0, -12.0, 0.0, -120.0, -4.0, 1.0, 0.0, 3.0, 14.0, 0.0, 0.0, -8.0], "policy_predator_policy_reward": [0.0, 7.0, 9.0, 10.0, 124.0, 3.0, 0.0, 0.0, 66.0, 86.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 3.0, 12.0, 3.0, 116.0, 0.0, 0.0, 0.0, 0.0, 140.0, 77.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 10.0, 6.0, 10.0, 1.0, 5.0, 0.0, 0.0, 1.0, 10.0, 0.0, 4.0, 9.0, 0.0, 0.0, 2.0, 0.0, 131.0, 0.0, 69.0, 12.0, 14.0, 88.0, 78.0, 96.0, 97.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 5.0, 29.0, 0.0, 117.0, 45.0, 32.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 129.0, 78.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 8.0, 7.0, 0.0, 4.0, 5.0, 6.0, 6.0, 0.0, 0.0, 5.0, 7.0, 45.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 16.0, 47.0, 0.0, 3.0, 7.0, 0.0, 0.0, 11.0, 31.0, 9.0, 10.0, 0.0, 0.0, 0.0, 3.0, 15.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 76.0, 114.0, 4.0, 0.0, 2.0, 0.0, 24.0, 28.0, 4.0, 4.0, 1.0, 0.0, 55.0, 0.0, 5.0, 2.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 1.0, 25.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 1.0, 8.0, 7.0, 11.0, 0.0, 82.0, 3.0, 0.0, 29.0, 5.0, 6.0, 8.0, 0.0, 60.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.445664492022285, "mean_inference_ms": 34.505400993410845, "mean_action_processing_ms": 2.1981626761681192, "mean_env_wait_ms": 2.1366424342585955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009895086288452148, "StateBufferConnector_ms": 0.013054370880126953, "ViewRequirementAgentConnector_ms": 0.35248303413391113}, "num_episodes": 23, "episode_return_max": 149.0, "episode_return_min": -87.0, "episode_return_mean": 2.36, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 152.89779327407285, "num_env_steps_trained_throughput_per_sec": 152.89779327407285, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 2768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2768000, "timers": {"training_iteration_time_ms": 26237.096, "restore_workers_time_ms": 0.048, "training_step_time_ms": 26236.904, "sample_time_ms": 4198.537, "learn_time_ms": 21981.93, "learn_throughput": 181.968, "synch_weights_time_ms": 52.217}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "done": false, "training_iteration": 173, "trial_id": "4f45b_00000", "date": "2024-08-13_05-50-46", "timestamp": 1723542646, "time_this_iter_s": 26.268136262893677, "time_total_s": 15469.385230064392, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28303a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15469.385230064392, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 83.94736842105263, "ram_util_percent": 83.20526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.13491466162066, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.420545212427775, "policy_loss": -0.002737542231217342, "vf_loss": 1.423281386321184, "vf_explained_var": 0.0038822209078168113, "kl": 0.008734839073800354, "entropy": 0.5791741882840161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.861955918048425, "cur_kl_coeff": 9.440288550877082e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.230497686817217, "policy_loss": -0.00315855495119221, "vf_loss": 1.2336562394938142, "vf_explained_var": -0.6015702390796924, "kl": 0.003892180785066372, "entropy": 0.265221739572192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "env_runners": {"episode_reward_max": 149.0, "episode_reward_min": -170.0, "episode_reward_mean": 4.18, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -288.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 151.0, "predator_policy": 144.0}, "policy_reward_mean": {"prey_policy": -11.335, "predator_policy": 13.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 7.0, -87.0, 59.0, 18.0, -41.0, -39.0, 0.0, -3.0, 149.0, 34.0, -39.0, 19.0, 18.0, 29.0, 10.0, -70.0, 0.0, -4.0, 0.0, 5.0, -4.0, 8.0, 11.0, -5.0, -28.0, 4.0, 11.0, 7.0, 0.0, 2.0, -3.0, 9.0, -11.0, 1.0, -24.0, 17.0, 0.0, -3.0, 0.0, 0.0, -12.0, 94.0, 0.0, 0.0, 10.0, 35.0, -23.0, 7.0, 3.0, 13.0, -8.0, 4.0, 13.0, -7.0, 17.0, 3.0, 87.0, 24.0, -3.0, 16.0, 0.0, 45.0, 11.0, 3.0, 0.0, 15.0, -5.0, 12.0, -73.0, -3.0, 70.0, 3.0, -60.0, 0.0, 3.0, 14.0, -4.0, -144.0, 20.0, 25.0, -170.0, 29.0, 7.0, 13.0, 5.0, 10.0, 128.0, 23.0, 22.0, 5.0, -5.0, 16.0, -7.0, 47.0, -6.0, 31.0, -1.0, 0.0, 9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.0, 9.0, -4.0, 9.0, -11.0, -207.0, 47.0, -57.0, 3.0, -11.0, 0.0, -207.0, -232.0, 0.0, 0.0, 0.0, -6.0, 0.0, 151.0, -9.0, 10.0, -10.0, 23.0, -179.0, -58.0, 0.0, 18.0, 0.0, 17.0, 12.0, -20.0, 20.0, 0.0, -277.0, 0.0, 0.0, -25.0, 0.0, 0.0, 0.0, 0.0, -10.0, -8.0, 0.0, -2.0, -1.0, 0.0, 5.0, -10.0, 0.0, -14.0, -66.0, 4.0, 0.0, 0.0, 11.0, 0.0, -2.0, 0.0, 0.0, -61.0, 0.0, 0.0, -6.0, 0.0, 2.0, -4.0, -18.0, -35.0, -4.0, -18.0, -16.0, 0.0, 17.0, -2.0, -16.0, -34.0, 0.0, 0.0, 0.0, 0.0, 0.0, -24.0, 0.0, 0.0, 94.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 9.0, 23.0, -10.0, -203.0, 3.0, 0.0, 1.0, 0.0, -27.0, -12.0, -8.0, -8.0, 0.0, 3.0, 0.0, -42.0, -4.0, -10.0, 17.0, 0.0, -11.0, 0.0, 87.0, 0.0, 15.0, 8.0, 2.0, -72.0, 0.0, 16.0, 0.0, 0.0, 5.0, 24.0, -9.0, -20.0, 0.0, 3.0, 0.0, 0.0, 1.0, 3.0, -15.0, 1.0, -11.0, 5.0, 9.0, -164.0, 0.0, -6.0, -3.0, 39.0, 1.0, -12.0, 0.0, -120.0, -4.0, 1.0, 0.0, 3.0, 14.0, 0.0, 0.0, -8.0, -288.0, 0.0, 7.0, -41.0, -10.0, 0.0, -132.0, -106.0, 27.0, 0.0, -2.0, -14.0, 0.0, 13.0, 0.0, 5.0, -14.0, 0.0, 107.0, 21.0, 0.0, 23.0, -12.0, 19.0, 0.0, -1.0, -83.0, -22.0, 0.0, -18.0, 0.0, -14.0, -10.0, 0.0, 0.0, -21.0, 0.0, 5.0, 0.0, -9.0, 0.0, 0.0, 0.0, 9.0], "policy_predator_policy_reward": [9.0, 0.0, 0.0, 2.0, 0.0, 131.0, 0.0, 69.0, 12.0, 14.0, 88.0, 78.0, 96.0, 97.0, 0.0, 0.0, 0.0, 3.0, 7.0, 0.0, 5.0, 29.0, 0.0, 117.0, 45.0, 32.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 129.0, 78.0, 0.0, 0.0, 0.0, 21.0, 0.0, 0.0, 8.0, 7.0, 0.0, 4.0, 5.0, 6.0, 6.0, 0.0, 0.0, 5.0, 7.0, 45.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 16.0, 47.0, 0.0, 3.0, 7.0, 0.0, 0.0, 11.0, 31.0, 9.0, 10.0, 0.0, 0.0, 0.0, 3.0, 15.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 76.0, 114.0, 4.0, 0.0, 2.0, 0.0, 24.0, 28.0, 4.0, 4.0, 1.0, 0.0, 55.0, 0.0, 5.0, 2.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 1.0, 25.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 1.0, 8.0, 7.0, 11.0, 0.0, 82.0, 3.0, 0.0, 29.0, 5.0, 6.0, 8.0, 0.0, 60.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 144.0, 36.0, 18.0, 0.0, 35.0, 68.0, 0.0, 0.0, 2.0, 10.0, 13.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 6.0, 0.0, 46.0, 54.0, 17.0, 17.0, 0.0, 7.0, 23.0, 34.0, 0.0, 15.0, 6.0, 20.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.084233496900424, "mean_inference_ms": 34.85884521992676, "mean_action_processing_ms": 2.0714770618121148, "mean_env_wait_ms": 2.0045184385698263, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06110215187072754, "StateBufferConnector_ms": 0.011889457702636719, "ViewRequirementAgentConnector_ms": 0.35784637928009033}, "num_episodes": 22, "episode_return_max": 149.0, "episode_return_min": -170.0, "episode_return_mean": 4.18, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 137.64449676131434, "num_env_steps_trained_throughput_per_sec": 137.64449676131434, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2784000, "timers": {"training_iteration_time_ms": 26435.707, "restore_workers_time_ms": 0.048, "training_step_time_ms": 26435.516, "sample_time_ms": 4500.877, "learn_time_ms": 21870.58, "learn_throughput": 182.894, "synch_weights_time_ms": 59.734}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "done": false, "training_iteration": 174, "trial_id": "4f45b_00000", "date": "2024-08-13_05-51-15", "timestamp": 1723542675, "time_this_iter_s": 29.1569242477417, "time_total_s": 15498.542154312134, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2897670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15498.542154312134, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 84.41749999999999, "ram_util_percent": 83.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9645009524923154, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.121686512752185, "policy_loss": -0.001569114817015669, "vf_loss": 1.1232542093626405, "vf_explained_var": 0.005241297382526297, "kl": 0.009062666551505356, "entropy": 0.5648501108090083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8678095746213796, "cur_kl_coeff": 4.720144275438541e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1454044712047098, "policy_loss": -0.00324160797280018, "vf_loss": 1.148646079043232, "vf_explained_var": -0.25549985391122326, "kl": 0.002745189888670635, "entropy": 0.26441400081865374, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 128.0, "episode_reward_min": -170.0, "episode_reward_mean": 5.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -288.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 107.0, "predator_policy": 144.0}, "policy_reward_mean": {"prey_policy": -7.57, "predator_policy": 10.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4.0, 0.0, 5.0, -4.0, 8.0, 11.0, -5.0, -28.0, 4.0, 11.0, 7.0, 0.0, 2.0, -3.0, 9.0, -11.0, 1.0, -24.0, 17.0, 0.0, -3.0, 0.0, 0.0, -12.0, 94.0, 0.0, 0.0, 10.0, 35.0, -23.0, 7.0, 3.0, 13.0, -8.0, 4.0, 13.0, -7.0, 17.0, 3.0, 87.0, 24.0, -3.0, 16.0, 0.0, 45.0, 11.0, 3.0, 0.0, 15.0, -5.0, 12.0, -73.0, -3.0, 70.0, 3.0, -60.0, 0.0, 3.0, 14.0, -4.0, -144.0, 20.0, 25.0, -170.0, 29.0, 7.0, 13.0, 5.0, 10.0, 128.0, 23.0, 22.0, 5.0, -5.0, 16.0, -7.0, 47.0, -6.0, 31.0, -1.0, 0.0, 9.0, 20.0, 3.0, 8.0, 27.0, 32.0, 14.0, 5.0, 6.0, -8.0, -2.0, -2.0, 3.0, 9.0, 33.0, 19.0, 15.0, 25.0, -11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-25.0, 0.0, 0.0, 0.0, 0.0, -10.0, -8.0, 0.0, -2.0, -1.0, 0.0, 5.0, -10.0, 0.0, -14.0, -66.0, 4.0, 0.0, 0.0, 11.0, 0.0, -2.0, 0.0, 0.0, -61.0, 0.0, 0.0, -6.0, 0.0, 2.0, -4.0, -18.0, -35.0, -4.0, -18.0, -16.0, 0.0, 17.0, -2.0, -16.0, -34.0, 0.0, 0.0, 0.0, 0.0, 0.0, -24.0, 0.0, 0.0, 94.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 9.0, 23.0, -10.0, -203.0, 3.0, 0.0, 1.0, 0.0, -27.0, -12.0, -8.0, -8.0, 0.0, 3.0, 0.0, -42.0, -4.0, -10.0, 17.0, 0.0, -11.0, 0.0, 87.0, 0.0, 15.0, 8.0, 2.0, -72.0, 0.0, 16.0, 0.0, 0.0, 5.0, 24.0, -9.0, -20.0, 0.0, 3.0, 0.0, 0.0, 1.0, 3.0, -15.0, 1.0, -11.0, 5.0, 9.0, -164.0, 0.0, -6.0, -3.0, 39.0, 1.0, -12.0, 0.0, -120.0, -4.0, 1.0, 0.0, 3.0, 14.0, 0.0, 0.0, -8.0, -288.0, 0.0, 7.0, -41.0, -10.0, 0.0, -132.0, -106.0, 27.0, 0.0, -2.0, -14.0, 0.0, 13.0, 0.0, 5.0, -14.0, 0.0, 107.0, 21.0, 0.0, 23.0, -12.0, 19.0, 0.0, -1.0, -83.0, -22.0, 0.0, -18.0, 0.0, -14.0, -10.0, 0.0, 0.0, -21.0, 0.0, 5.0, 0.0, -9.0, 0.0, 0.0, 0.0, 9.0, 0.0, -50.0, 1.0, -12.0, 0.0, -6.0, 3.0, 16.0, -3.0, 0.0, -17.0, -1.0, 0.0, 4.0, -16.0, 11.0, -139.0, 3.0, 0.0, -58.0, 0.0, -8.0, 0.0, -3.0, 9.0, 0.0, 7.0, 26.0, -2.0, 10.0, -10.0, 11.0, 15.0, 10.0, -17.0, -18.0], "policy_predator_policy_reward": [0.0, 21.0, 0.0, 0.0, 8.0, 7.0, 0.0, 4.0, 5.0, 6.0, 6.0, 0.0, 0.0, 5.0, 7.0, 45.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 16.0, 47.0, 0.0, 3.0, 7.0, 0.0, 0.0, 11.0, 31.0, 9.0, 10.0, 0.0, 0.0, 0.0, 3.0, 15.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 76.0, 114.0, 4.0, 0.0, 2.0, 0.0, 24.0, 28.0, 4.0, 4.0, 1.0, 0.0, 55.0, 0.0, 5.0, 2.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 1.0, 25.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 1.0, 8.0, 7.0, 11.0, 0.0, 82.0, 3.0, 0.0, 29.0, 5.0, 6.0, 8.0, 0.0, 60.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 144.0, 36.0, 18.0, 0.0, 35.0, 68.0, 0.0, 0.0, 2.0, 10.0, 13.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 6.0, 0.0, 46.0, 54.0, 17.0, 17.0, 0.0, 7.0, 23.0, 34.0, 0.0, 15.0, 6.0, 20.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 36.0, 34.0, 6.0, 8.0, 14.0, 0.0, 0.0, 8.0, 19.0, 16.0, 9.0, 23.0, 0.0, 1.0, 3.0, 8.0, 45.0, 83.0, 35.0, 21.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 5.0, 9.0, 0.0, 0.0, 17.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.029566741384997, "mean_inference_ms": 34.714628542781846, "mean_action_processing_ms": 2.066469101516317, "mean_env_wait_ms": 1.9988713586193496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06267642974853516, "StateBufferConnector_ms": 0.01450502872467041, "ViewRequirementAgentConnector_ms": 0.3875774145126343}, "num_episodes": 18, "episode_return_max": 128.0, "episode_return_min": -170.0, "episode_return_mean": 5.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.42294990185164, "num_env_steps_trained_throughput_per_sec": 151.42294990185164, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 26382.144, "restore_workers_time_ms": 0.025, "training_step_time_ms": 26381.978, "sample_time_ms": 4790.731, "learn_time_ms": 21526.115, "learn_throughput": 185.821, "synch_weights_time_ms": 60.804}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 175, "trial_id": "4f45b_00000", "date": "2024-08-13_05-51-42", "timestamp": 1723542702, "time_this_iter_s": 26.488231897354126, "time_total_s": 15525.030386209488, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b289f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15525.030386209488, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 82.1263157894737, "ram_util_percent": 83.16052631578945}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2562023638890536, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1751251187589433, "policy_loss": -0.0017611713116623894, "vf_loss": 1.1768854060027965, "vf_explained_var": 0.00509895922014953, "kl": 0.005621539420506355, "entropy": 0.5497816011388466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3707910940287604, "cur_kl_coeff": 2.3600721377192706e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1850492253663047, "policy_loss": -0.0025275156482137623, "vf_loss": 1.187576741153601, "vf_explained_var": -0.10132339779662076, "kl": 0.004679240662934395, "entropy": 0.23185839279303475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "env_runners": {"episode_reward_max": 147.0, "episode_reward_min": -170.0, "episode_reward_mean": 8.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -288.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 150.0, "predator_policy": 144.0}, "policy_reward_mean": {"prey_policy": -7.185, "predator_policy": 11.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.0, 0.0, -3.0, 0.0, 0.0, -12.0, 94.0, 0.0, 0.0, 10.0, 35.0, -23.0, 7.0, 3.0, 13.0, -8.0, 4.0, 13.0, -7.0, 17.0, 3.0, 87.0, 24.0, -3.0, 16.0, 0.0, 45.0, 11.0, 3.0, 0.0, 15.0, -5.0, 12.0, -73.0, -3.0, 70.0, 3.0, -60.0, 0.0, 3.0, 14.0, -4.0, -144.0, 20.0, 25.0, -170.0, 29.0, 7.0, 13.0, 5.0, 10.0, 128.0, 23.0, 22.0, 5.0, -5.0, 16.0, -7.0, 47.0, -6.0, 31.0, -1.0, 0.0, 9.0, 20.0, 3.0, 8.0, 27.0, 32.0, 14.0, 5.0, 6.0, -8.0, -2.0, -2.0, 3.0, 9.0, 33.0, 19.0, 15.0, 25.0, -11.0, 17.0, -99.0, 54.0, 17.0, 12.0, 13.0, 0.0, -1.0, -1.0, 14.0, 147.0, 27.0, 18.0, 30.0, 16.0, 25.0, 12.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 17.0, -2.0, -16.0, -34.0, 0.0, 0.0, 0.0, 0.0, 0.0, -24.0, 0.0, 0.0, 94.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 9.0, 23.0, -10.0, -203.0, 3.0, 0.0, 1.0, 0.0, -27.0, -12.0, -8.0, -8.0, 0.0, 3.0, 0.0, -42.0, -4.0, -10.0, 17.0, 0.0, -11.0, 0.0, 87.0, 0.0, 15.0, 8.0, 2.0, -72.0, 0.0, 16.0, 0.0, 0.0, 5.0, 24.0, -9.0, -20.0, 0.0, 3.0, 0.0, 0.0, 1.0, 3.0, -15.0, 1.0, -11.0, 5.0, 9.0, -164.0, 0.0, -6.0, -3.0, 39.0, 1.0, -12.0, 0.0, -120.0, -4.0, 1.0, 0.0, 3.0, 14.0, 0.0, 0.0, -8.0, -288.0, 0.0, 7.0, -41.0, -10.0, 0.0, -132.0, -106.0, 27.0, 0.0, -2.0, -14.0, 0.0, 13.0, 0.0, 5.0, -14.0, 0.0, 107.0, 21.0, 0.0, 23.0, -12.0, 19.0, 0.0, -1.0, -83.0, -22.0, 0.0, -18.0, 0.0, -14.0, -10.0, 0.0, 0.0, -21.0, 0.0, 5.0, 0.0, -9.0, 0.0, 0.0, 0.0, 9.0, 0.0, -50.0, 1.0, -12.0, 0.0, -6.0, 3.0, 16.0, -3.0, 0.0, -17.0, -1.0, 0.0, 4.0, -16.0, 11.0, -139.0, 3.0, 0.0, -58.0, 0.0, -8.0, 0.0, -3.0, 9.0, 0.0, 7.0, 26.0, -2.0, 10.0, -10.0, 11.0, 15.0, 10.0, -17.0, -18.0, 17.0, 0.0, -208.0, 0.0, 38.0, -2.0, -12.0, 8.0, -12.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, -2.0, -10.0, -10.0, 0.0, -96.0, -16.0, 150.0, -20.0, 4.0, -66.0, 0.0, 2.0, 23.0, -2.0, 14.0, -11.0, 8.0, 12.0, 0.0, -18.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 3.0, 15.0, 31.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 76.0, 114.0, 4.0, 0.0, 2.0, 0.0, 24.0, 28.0, 4.0, 4.0, 1.0, 0.0, 55.0, 0.0, 5.0, 2.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 1.0, 25.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 1.0, 8.0, 7.0, 11.0, 0.0, 82.0, 3.0, 0.0, 29.0, 5.0, 6.0, 8.0, 0.0, 60.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 144.0, 36.0, 18.0, 0.0, 35.0, 68.0, 0.0, 0.0, 2.0, 10.0, 13.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 6.0, 0.0, 46.0, 54.0, 17.0, 17.0, 0.0, 7.0, 23.0, 34.0, 0.0, 15.0, 6.0, 20.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 36.0, 34.0, 6.0, 8.0, 14.0, 0.0, 0.0, 8.0, 19.0, 16.0, 9.0, 23.0, 0.0, 1.0, 3.0, 8.0, 45.0, 83.0, 35.0, 21.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 5.0, 9.0, 0.0, 0.0, 17.0, 7.0, 0.0, 0.0, 5.0, 104.0, 5.0, 13.0, 10.0, 11.0, 11.0, 13.0, 0.0, 5.0, 0.0, 0.0, 1.0, 0.0, 14.0, 5.0, 59.0, 51.0, 5.0, 8.0, 23.0, 20.0, 41.0, 43.0, 5.0, 0.0, 0.0, 4.0, 13.0, 15.0, 0.0, 0.0, 9.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.976182997626408, "mean_inference_ms": 34.572858099391304, "mean_action_processing_ms": 2.0616540642429335, "mean_env_wait_ms": 1.9934381833602999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.062835693359375, "StateBufferConnector_ms": 0.016248106956481934, "ViewRequirementAgentConnector_ms": 0.4483379125595093}, "num_episodes": 18, "episode_return_max": 147.0, "episode_return_min": -170.0, "episode_return_mean": 8.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 191.95251638477325, "num_env_steps_trained_throughput_per_sec": 191.95251638477325, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2816000, "timers": {"training_iteration_time_ms": 25951.225, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25951.059, "sample_time_ms": 4962.002, "learn_time_ms": 20921.139, "learn_throughput": 191.194, "synch_weights_time_ms": 63.723}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "done": false, "training_iteration": 176, "trial_id": "4f45b_00000", "date": "2024-08-13_05-52-03", "timestamp": 1723542723, "time_this_iter_s": 20.84981083869934, "time_total_s": 15545.880197048187, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28bfb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15545.880197048187, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 72.61379310344829, "ram_util_percent": 75.88965517241377}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1648079752764375, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8005241760028102, "policy_loss": -0.0029096343510207675, "vf_loss": 0.8034323244735047, "vf_explained_var": 0.0007285609131767636, "kl": 0.009495312561898266, "entropy": 0.5421245061058216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.473015919138515, "cur_kl_coeff": 1.1800360688596353e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.076730426373305, "policy_loss": -0.000826683024402767, "vf_loss": 1.0775571070177845, "vf_explained_var": 0.047735279041623314, "kl": 0.001322198697821766, "entropy": 0.17571563864195788, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "env_runners": {"episode_reward_max": 147.0, "episode_reward_min": -170.0, "episode_reward_mean": 7.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -334.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 150.0, "predator_policy": 167.0}, "policy_reward_mean": {"prey_policy": -8.195, "predator_policy": 11.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.0, 17.0, 3.0, 87.0, 24.0, -3.0, 16.0, 0.0, 45.0, 11.0, 3.0, 0.0, 15.0, -5.0, 12.0, -73.0, -3.0, 70.0, 3.0, -60.0, 0.0, 3.0, 14.0, -4.0, -144.0, 20.0, 25.0, -170.0, 29.0, 7.0, 13.0, 5.0, 10.0, 128.0, 23.0, 22.0, 5.0, -5.0, 16.0, -7.0, 47.0, -6.0, 31.0, -1.0, 0.0, 9.0, 20.0, 3.0, 8.0, 27.0, 32.0, 14.0, 5.0, 6.0, -8.0, -2.0, -2.0, 3.0, 9.0, 33.0, 19.0, 15.0, 25.0, -11.0, 17.0, -99.0, 54.0, 17.0, 12.0, 13.0, 0.0, -1.0, -1.0, 14.0, 147.0, 27.0, 18.0, 30.0, 16.0, 25.0, 12.0, -9.0, 0.0, -10.0, -4.0, -4.0, 69.0, -161.0, 0.0, 0.0, 14.0, 0.0, -6.0, 26.0, 7.0, 17.0, -11.0, 31.0, 22.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, -10.0, 17.0, 0.0, -11.0, 0.0, 87.0, 0.0, 15.0, 8.0, 2.0, -72.0, 0.0, 16.0, 0.0, 0.0, 5.0, 24.0, -9.0, -20.0, 0.0, 3.0, 0.0, 0.0, 1.0, 3.0, -15.0, 1.0, -11.0, 5.0, 9.0, -164.0, 0.0, -6.0, -3.0, 39.0, 1.0, -12.0, 0.0, -120.0, -4.0, 1.0, 0.0, 3.0, 14.0, 0.0, 0.0, -8.0, -288.0, 0.0, 7.0, -41.0, -10.0, 0.0, -132.0, -106.0, 27.0, 0.0, -2.0, -14.0, 0.0, 13.0, 0.0, 5.0, -14.0, 0.0, 107.0, 21.0, 0.0, 23.0, -12.0, 19.0, 0.0, -1.0, -83.0, -22.0, 0.0, -18.0, 0.0, -14.0, -10.0, 0.0, 0.0, -21.0, 0.0, 5.0, 0.0, -9.0, 0.0, 0.0, 0.0, 9.0, 0.0, -50.0, 1.0, -12.0, 0.0, -6.0, 3.0, 16.0, -3.0, 0.0, -17.0, -1.0, 0.0, 4.0, -16.0, 11.0, -139.0, 3.0, 0.0, -58.0, 0.0, -8.0, 0.0, -3.0, 9.0, 0.0, 7.0, 26.0, -2.0, 10.0, -10.0, 11.0, 15.0, 10.0, -17.0, -18.0, 17.0, 0.0, -208.0, 0.0, 38.0, -2.0, -12.0, 8.0, -12.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, -2.0, -10.0, -10.0, 0.0, -96.0, -16.0, 150.0, -20.0, 4.0, -66.0, 0.0, 2.0, 23.0, -2.0, 14.0, -11.0, 8.0, 12.0, 0.0, -18.0, 0.0, 0.0, 0.0, -4.0, -12.0, 0.0, -9.0, 0.0, -31.0, 16.0, 23.0, -334.0, 6.0, 0.0, 0.0, 0.0, 0.0, -135.0, 6.0, 0.0, 0.0, 0.0, -14.0, 26.0, 0.0, 1.0, 3.0, 0.0, 17.0, -21.0, -10.0, 12.0, 18.0, 22.0, 0.0, 0.0, -8.0], "policy_predator_policy_reward": [5.0, 2.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 1.0, 25.0, 42.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 1.0, 8.0, 7.0, 11.0, 0.0, 82.0, 3.0, 0.0, 29.0, 5.0, 6.0, 8.0, 0.0, 60.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 144.0, 36.0, 18.0, 0.0, 35.0, 68.0, 0.0, 0.0, 2.0, 10.0, 13.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 6.0, 0.0, 46.0, 54.0, 17.0, 17.0, 0.0, 7.0, 23.0, 34.0, 0.0, 15.0, 6.0, 20.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 36.0, 34.0, 6.0, 8.0, 14.0, 0.0, 0.0, 8.0, 19.0, 16.0, 9.0, 23.0, 0.0, 1.0, 3.0, 8.0, 45.0, 83.0, 35.0, 21.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 5.0, 9.0, 0.0, 0.0, 17.0, 7.0, 0.0, 0.0, 5.0, 104.0, 5.0, 13.0, 10.0, 11.0, 11.0, 13.0, 0.0, 5.0, 0.0, 0.0, 1.0, 0.0, 14.0, 5.0, 59.0, 51.0, 5.0, 8.0, 23.0, 20.0, 41.0, 43.0, 5.0, 0.0, 0.0, 4.0, 13.0, 15.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0, 27.0, 25.0, 5.0, 167.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 73.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.923457918552813, "mean_inference_ms": 34.43306784112912, "mean_action_processing_ms": 2.0569123243281098, "mean_env_wait_ms": 1.9880419243690084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06282377243041992, "StateBufferConnector_ms": 0.019249796867370605, "ViewRequirementAgentConnector_ms": 0.4415771961212158}, "num_episodes": 18, "episode_return_max": 147.0, "episode_return_min": -170.0, "episode_return_mean": 7.01, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 177.92382631519644, "num_env_steps_trained_throughput_per_sec": 177.92382631519644, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 2832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2832000, "timers": {"training_iteration_time_ms": 25695.774, "restore_workers_time_ms": 0.026, "training_step_time_ms": 25695.69, "sample_time_ms": 5060.304, "learn_time_ms": 20562.937, "learn_throughput": 194.525, "synch_weights_time_ms": 68.43}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "done": false, "training_iteration": 177, "trial_id": "4f45b_00000", "date": "2024-08-13_05-52-26", "timestamp": 1723542746, "time_this_iter_s": 22.539480209350586, "time_total_s": 15568.419677257538, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b283e5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15568.419677257538, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 75.684375, "ram_util_percent": 76.62812500000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9731981272735293, "cur_kl_coeff": 0.0001564264297485352, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8011413164239711, "policy_loss": -0.0012273552056362546, "vf_loss": 1.8023679412861981, "vf_explained_var": 0.0020582404086198756, "kl": 0.004695275261670993, "entropy": 0.5034113575857152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1984723305418377, "cur_kl_coeff": 5.900180344298176e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5438127367900163, "policy_loss": -0.003138607839940402, "vf_loss": 1.5469513466118505, "vf_explained_var": -0.17646279338175658, "kl": 0.008881785262644555, "entropy": 0.26980477550200055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "env_runners": {"episode_reward_max": 147.0, "episode_reward_min": -175.0, "episode_reward_mean": 3.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -368.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 150.0, "predator_policy": 184.0}, "policy_reward_mean": {"prey_policy": -11.96, "predator_policy": 13.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-170.0, 29.0, 7.0, 13.0, 5.0, 10.0, 128.0, 23.0, 22.0, 5.0, -5.0, 16.0, -7.0, 47.0, -6.0, 31.0, -1.0, 0.0, 9.0, 20.0, 3.0, 8.0, 27.0, 32.0, 14.0, 5.0, 6.0, -8.0, -2.0, -2.0, 3.0, 9.0, 33.0, 19.0, 15.0, 25.0, -11.0, 17.0, -99.0, 54.0, 17.0, 12.0, 13.0, 0.0, -1.0, -1.0, 14.0, 147.0, 27.0, 18.0, 30.0, 16.0, 25.0, 12.0, -9.0, 0.0, -10.0, -4.0, -4.0, 69.0, -161.0, 0.0, 0.0, 14.0, 0.0, -6.0, 26.0, 7.0, 17.0, -11.0, 31.0, 22.0, -2.0, -175.0, 13.0, -6.0, 7.0, 3.0, -12.0, -15.0, 43.0, 48.0, -77.0, 0.0, 0.0, 112.0, 9.0, 3.0, 0.0, -7.0, -1.0, 0.0, -26.0, 0.0, -25.0, -8.0, -1.0, 43.0, 2.0, -174.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-132.0, -106.0, 27.0, 0.0, -2.0, -14.0, 0.0, 13.0, 0.0, 5.0, -14.0, 0.0, 107.0, 21.0, 0.0, 23.0, -12.0, 19.0, 0.0, -1.0, -83.0, -22.0, 0.0, -18.0, 0.0, -14.0, -10.0, 0.0, 0.0, -21.0, 0.0, 5.0, 0.0, -9.0, 0.0, 0.0, 0.0, 9.0, 0.0, -50.0, 1.0, -12.0, 0.0, -6.0, 3.0, 16.0, -3.0, 0.0, -17.0, -1.0, 0.0, 4.0, -16.0, 11.0, -139.0, 3.0, 0.0, -58.0, 0.0, -8.0, 0.0, -3.0, 9.0, 0.0, 7.0, 26.0, -2.0, 10.0, -10.0, 11.0, 15.0, 10.0, -17.0, -18.0, 17.0, 0.0, -208.0, 0.0, 38.0, -2.0, -12.0, 8.0, -12.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, -2.0, -10.0, -10.0, 0.0, -96.0, -16.0, 150.0, -20.0, 4.0, -66.0, 0.0, 2.0, 23.0, -2.0, 14.0, -11.0, 8.0, 12.0, 0.0, -18.0, 0.0, 0.0, 0.0, -4.0, -12.0, 0.0, -9.0, 0.0, -31.0, 16.0, 23.0, -334.0, 6.0, 0.0, 0.0, 0.0, 0.0, -135.0, 6.0, 0.0, 0.0, 0.0, -14.0, 26.0, 0.0, 1.0, 3.0, 0.0, 17.0, -21.0, -10.0, 12.0, 18.0, 22.0, 0.0, 0.0, -8.0, -350.0, 0.0, 15.0, -10.0, -12.0, 0.0, 2.0, 0.0, -33.0, 0.0, -130.0, 0.0, -24.0, -8.0, -5.0, 38.0, 0.0, 6.0, -138.0, -16.0, 0.0, 0.0, 0.0, -29.0, 109.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -13.0, 0.0, 0.0, 0.0, -20.0, -32.0, 0.0, 0.0, -2.0, -92.0, 0.0, -153.0, -60.0, -16.0, 27.0, 16.0, 5.0, -11.0, -368.0, 6.0], "policy_predator_policy_reward": [68.0, 0.0, 0.0, 2.0, 10.0, 13.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 6.0, 0.0, 46.0, 54.0, 17.0, 17.0, 0.0, 7.0, 23.0, 34.0, 0.0, 15.0, 6.0, 20.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 36.0, 34.0, 6.0, 8.0, 14.0, 0.0, 0.0, 8.0, 19.0, 16.0, 9.0, 23.0, 0.0, 1.0, 3.0, 8.0, 45.0, 83.0, 35.0, 21.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 5.0, 9.0, 0.0, 0.0, 17.0, 7.0, 0.0, 0.0, 5.0, 104.0, 5.0, 13.0, 10.0, 11.0, 11.0, 13.0, 0.0, 5.0, 0.0, 0.0, 1.0, 0.0, 14.0, 5.0, 59.0, 51.0, 5.0, 8.0, 23.0, 20.0, 41.0, 43.0, 5.0, 0.0, 0.0, 4.0, 13.0, 15.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0, 27.0, 25.0, 5.0, 167.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 73.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 175.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 5.0, 15.0, 21.0, 51.0, 67.0, 5.0, 12.0, 10.0, 0.0, 20.0, 22.0, 0.0, 77.0, 0.0, 0.0, 10.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 7.0, 0.0, 12.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 38.0, 31.0, 80.0, 65.0, 0.0, 75.0, 0.0, 0.0, 8.0, 0.0, 184.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 13.114748318312335, "mean_inference_ms": 33.95309086850232, "mean_action_processing_ms": 2.0481662724985066, "mean_env_wait_ms": 1.979025331305872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06112551689147949, "StateBufferConnector_ms": 0.021546244621276855, "ViewRequirementAgentConnector_ms": 0.40373122692108154}, "num_episodes": 27, "episode_return_max": 147.0, "episode_return_min": -175.0, "episode_return_mean": 3.88, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.57256784614233, "num_env_steps_trained_throughput_per_sec": 204.57256784614233, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2848000, "timers": {"training_iteration_time_ms": 24965.726, "restore_workers_time_ms": 0.027, "training_step_time_ms": 24965.651, "sample_time_ms": 4981.32, "learn_time_ms": 19912.162, "learn_throughput": 200.882, "synch_weights_time_ms": 69.156}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "done": false, "training_iteration": 178, "trial_id": "4f45b_00000", "date": "2024-08-13_05-52-45", "timestamp": 1723542765, "time_this_iter_s": 19.67302894592285, "time_total_s": 15588.09270620346, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b289fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15588.09270620346, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 71.22142857142856, "ram_util_percent": 78.15714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3303318344411397, "cur_kl_coeff": 7.82132148742676e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24354568241033506, "policy_loss": -0.0007723429384419606, "vf_loss": 0.24431756277428202, "vf_explained_var": 0.0019650110807368365, "kl": 0.005919828288671258, "entropy": 0.4823278498239618, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1645352926440338, "cur_kl_coeff": 5.900180344298176e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4340705909830316, "policy_loss": -0.0021307537520659113, "vf_loss": 0.4362013453361455, "vf_explained_var": 0.19226792962462813, "kl": 0.0023859763928442417, "entropy": 0.2193848263334345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "env_runners": {"episode_reward_max": 147.0, "episode_reward_min": -175.0, "episode_reward_mean": 2.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -368.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 150.0, "predator_policy": 184.0}, "policy_reward_mean": {"prey_policy": -11.63, "predator_policy": 13.105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 20.0, 3.0, 8.0, 27.0, 32.0, 14.0, 5.0, 6.0, -8.0, -2.0, -2.0, 3.0, 9.0, 33.0, 19.0, 15.0, 25.0, -11.0, 17.0, -99.0, 54.0, 17.0, 12.0, 13.0, 0.0, -1.0, -1.0, 14.0, 147.0, 27.0, 18.0, 30.0, 16.0, 25.0, 12.0, -9.0, 0.0, -10.0, -4.0, -4.0, 69.0, -161.0, 0.0, 0.0, 14.0, 0.0, -6.0, 26.0, 7.0, 17.0, -11.0, 31.0, 22.0, -2.0, -175.0, 13.0, -6.0, 7.0, 3.0, -12.0, -15.0, 43.0, 48.0, -77.0, 0.0, 0.0, 112.0, 9.0, 3.0, 0.0, -7.0, -1.0, 0.0, -26.0, 0.0, -25.0, -8.0, -1.0, 43.0, 2.0, -174.0, -17.0, 2.0, 45.0, 15.0, -1.0, -34.0, -5.0, 1.0, 1.0, 28.0, 13.0, -7.0, -4.0, 0.0, 20.0, 10.0, 2.0, -15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 9.0, 0.0, -50.0, 1.0, -12.0, 0.0, -6.0, 3.0, 16.0, -3.0, 0.0, -17.0, -1.0, 0.0, 4.0, -16.0, 11.0, -139.0, 3.0, 0.0, -58.0, 0.0, -8.0, 0.0, -3.0, 9.0, 0.0, 7.0, 26.0, -2.0, 10.0, -10.0, 11.0, 15.0, 10.0, -17.0, -18.0, 17.0, 0.0, -208.0, 0.0, 38.0, -2.0, -12.0, 8.0, -12.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, -2.0, -10.0, -10.0, 0.0, -96.0, -16.0, 150.0, -20.0, 4.0, -66.0, 0.0, 2.0, 23.0, -2.0, 14.0, -11.0, 8.0, 12.0, 0.0, -18.0, 0.0, 0.0, 0.0, -4.0, -12.0, 0.0, -9.0, 0.0, -31.0, 16.0, 23.0, -334.0, 6.0, 0.0, 0.0, 0.0, 0.0, -135.0, 6.0, 0.0, 0.0, 0.0, -14.0, 26.0, 0.0, 1.0, 3.0, 0.0, 17.0, -21.0, -10.0, 12.0, 18.0, 22.0, 0.0, 0.0, -8.0, -350.0, 0.0, 15.0, -10.0, -12.0, 0.0, 2.0, 0.0, -33.0, 0.0, -130.0, 0.0, -24.0, -8.0, -5.0, 38.0, 0.0, 6.0, -138.0, -16.0, 0.0, 0.0, 0.0, -29.0, 109.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -13.0, 0.0, 0.0, 0.0, -20.0, -32.0, 0.0, 0.0, -2.0, -92.0, 0.0, -153.0, -60.0, -16.0, 27.0, 16.0, 5.0, -11.0, -368.0, 6.0, -30.0, -6.0, 6.0, -18.0, 8.0, 27.0, 15.0, 0.0, 0.0, -7.0, 13.0, -94.0, -26.0, -2.0, 0.0, 1.0, -30.0, 16.0, 7.0, 9.0, 0.0, 7.0, -8.0, -6.0, 0.0, -9.0, 1.0, -2.0, 5.0, 11.0, -2.0, 5.0, -33.0, 0.0, -14.0, -16.0], "policy_predator_policy_reward": [0.0, 0.0, 36.0, 34.0, 6.0, 8.0, 14.0, 0.0, 0.0, 8.0, 19.0, 16.0, 9.0, 23.0, 0.0, 1.0, 3.0, 8.0, 45.0, 83.0, 35.0, 21.0, 0.0, 6.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 7.0, 4.0, 5.0, 9.0, 0.0, 0.0, 17.0, 7.0, 0.0, 0.0, 5.0, 104.0, 5.0, 13.0, 10.0, 11.0, 11.0, 13.0, 0.0, 5.0, 0.0, 0.0, 1.0, 0.0, 14.0, 5.0, 59.0, 51.0, 5.0, 8.0, 23.0, 20.0, 41.0, 43.0, 5.0, 0.0, 0.0, 4.0, 13.0, 15.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0, 27.0, 25.0, 5.0, 167.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 73.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 175.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 5.0, 15.0, 21.0, 51.0, 67.0, 5.0, 12.0, 10.0, 0.0, 20.0, 22.0, 0.0, 77.0, 0.0, 0.0, 10.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 7.0, 0.0, 12.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 38.0, 31.0, 80.0, 65.0, 0.0, 75.0, 0.0, 0.0, 8.0, 0.0, 184.0, 4.0, 14.0, 5.0, 5.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 47.0, 1.0, 22.0, 0.0, 0.0, 10.0, 5.0, 3.0, 9.0, 0.0, 6.0, 3.0, 4.0, 5.0, 0.0, 1.0, 0.0, 2.0, 2.0, 7.0, 0.0, 18.0, 17.0, 0.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.792086464417507, "mean_inference_ms": 34.08836198251973, "mean_action_processing_ms": 2.043591907756439, "mean_env_wait_ms": 1.973402363610192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01282346248626709, "StateBufferConnector_ms": 0.021554231643676758, "ViewRequirementAgentConnector_ms": 0.4008598327636719}, "num_episodes": 18, "episode_return_max": 147.0, "episode_return_min": -175.0, "episode_return_mean": 2.95, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 119.44532971427496, "num_env_steps_trained_throughput_per_sec": 119.44532971427496, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 2864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2864000, "timers": {"training_iteration_time_ms": 25722.099, "restore_workers_time_ms": 0.025, "training_step_time_ms": 25722.028, "sample_time_ms": 5063.85, "learn_time_ms": 20587.236, "learn_throughput": 194.295, "synch_weights_time_ms": 68.046}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "done": false, "training_iteration": 179, "trial_id": "4f45b_00000", "date": "2024-08-13_05-53-19", "timestamp": 1723542799, "time_this_iter_s": 33.63047790527344, "time_total_s": 15621.723184108734, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28d7820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15621.723184108734, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 91.17659574468084, "ram_util_percent": 81.86595744680851}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.91043392165155, "cur_kl_coeff": 7.82132148742676e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2718103438773483, "policy_loss": -0.0005853408164093419, "vf_loss": 1.2723953427618773, "vf_explained_var": 0.003227759669066737, "kl": 0.004372497588193337, "entropy": 0.49022613798499737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.239324778681079, "cur_kl_coeff": 2.950090172149088e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1527299778762634, "policy_loss": -0.0007656272589450791, "vf_loss": 1.153495605439736, "vf_explained_var": -0.5039565968135047, "kl": 0.0030903733432977496, "entropy": 0.2917586092122648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 147.0, "episode_reward_min": -175.0, "episode_reward_mean": 1.75, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -368.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 150.0, "predator_policy": 184.0}, "policy_reward_mean": {"prey_policy": -12.1, "predator_policy": 12.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, 17.0, -99.0, 54.0, 17.0, 12.0, 13.0, 0.0, -1.0, -1.0, 14.0, 147.0, 27.0, 18.0, 30.0, 16.0, 25.0, 12.0, -9.0, 0.0, -10.0, -4.0, -4.0, 69.0, -161.0, 0.0, 0.0, 14.0, 0.0, -6.0, 26.0, 7.0, 17.0, -11.0, 31.0, 22.0, -2.0, -175.0, 13.0, -6.0, 7.0, 3.0, -12.0, -15.0, 43.0, 48.0, -77.0, 0.0, 0.0, 112.0, 9.0, 3.0, 0.0, -7.0, -1.0, 0.0, -26.0, 0.0, -25.0, -8.0, -1.0, 43.0, 2.0, -174.0, -17.0, 2.0, 45.0, 15.0, -1.0, -34.0, -5.0, 1.0, 1.0, 28.0, 13.0, -7.0, -4.0, 0.0, 20.0, 10.0, 2.0, -15.0, 0.0, 15.0, 7.0, -40.0, 30.0, 0.0, 2.0, 0.0, 15.0, 62.0, 24.0, -21.0, 4.0, -5.0, -9.0, -7.0, 7.0, 12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-17.0, -18.0, 17.0, 0.0, -208.0, 0.0, 38.0, -2.0, -12.0, 8.0, -12.0, 0.0, 4.0, 4.0, 0.0, 0.0, 0.0, -2.0, -10.0, -10.0, 0.0, -96.0, -16.0, 150.0, -20.0, 4.0, -66.0, 0.0, 2.0, 23.0, -2.0, 14.0, -11.0, 8.0, 12.0, 0.0, -18.0, 0.0, 0.0, 0.0, -4.0, -12.0, 0.0, -9.0, 0.0, -31.0, 16.0, 23.0, -334.0, 6.0, 0.0, 0.0, 0.0, 0.0, -135.0, 6.0, 0.0, 0.0, 0.0, -14.0, 26.0, 0.0, 1.0, 3.0, 0.0, 17.0, -21.0, -10.0, 12.0, 18.0, 22.0, 0.0, 0.0, -8.0, -350.0, 0.0, 15.0, -10.0, -12.0, 0.0, 2.0, 0.0, -33.0, 0.0, -130.0, 0.0, -24.0, -8.0, -5.0, 38.0, 0.0, 6.0, -138.0, -16.0, 0.0, 0.0, 0.0, -29.0, 109.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -13.0, 0.0, 0.0, 0.0, -20.0, -32.0, 0.0, 0.0, -2.0, -92.0, 0.0, -153.0, -60.0, -16.0, 27.0, 16.0, 5.0, -11.0, -368.0, 6.0, -30.0, -6.0, 6.0, -18.0, 8.0, 27.0, 15.0, 0.0, 0.0, -7.0, 13.0, -94.0, -26.0, -2.0, 0.0, 1.0, -30.0, 16.0, 7.0, 9.0, 0.0, 7.0, -8.0, -6.0, 0.0, -9.0, 1.0, -2.0, 5.0, 11.0, -2.0, 5.0, -33.0, 0.0, -14.0, -16.0, 0.0, -4.0, 0.0, 10.0, 0.0, 2.0, 5.0, -114.0, 16.0, 14.0, 0.0, 0.0, 0.0, -1.0, -10.0, 0.0, 15.0, 0.0, 43.0, 19.0, 14.0, 10.0, 0.0, -61.0, 4.0, 0.0, -10.0, 0.0, 0.0, -18.0, -237.0, 0.0, 0.0, 7.0, 0.0, 12.0], "policy_predator_policy_reward": [17.0, 7.0, 0.0, 0.0, 5.0, 104.0, 5.0, 13.0, 10.0, 11.0, 11.0, 13.0, 0.0, 5.0, 0.0, 0.0, 1.0, 0.0, 14.0, 5.0, 59.0, 51.0, 5.0, 8.0, 23.0, 20.0, 41.0, 43.0, 5.0, 0.0, 0.0, 4.0, 13.0, 15.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0, 27.0, 25.0, 5.0, 167.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 73.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 175.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 5.0, 15.0, 21.0, 51.0, 67.0, 5.0, 12.0, 10.0, 0.0, 20.0, 22.0, 0.0, 77.0, 0.0, 0.0, 10.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 7.0, 0.0, 12.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 38.0, 31.0, 80.0, 65.0, 0.0, 75.0, 0.0, 0.0, 8.0, 0.0, 184.0, 4.0, 14.0, 5.0, 5.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 47.0, 1.0, 22.0, 0.0, 0.0, 10.0, 5.0, 3.0, 9.0, 0.0, 6.0, 3.0, 4.0, 5.0, 0.0, 1.0, 0.0, 2.0, 2.0, 7.0, 0.0, 18.0, 17.0, 0.0, 15.0, 4.0, 0.0, 0.0, 5.0, 5.0, 0.0, 69.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 39.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, 116.0, 114.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.738271856530663, "mean_inference_ms": 33.94628101790073, "mean_action_processing_ms": 2.037860137346475, "mean_env_wait_ms": 1.9672928225383532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011464953422546387, "StateBufferConnector_ms": 0.024160265922546387, "ViewRequirementAgentConnector_ms": 0.4303964376449585}, "num_episodes": 18, "episode_return_max": 147.0, "episode_return_min": -175.0, "episode_return_mean": 1.75, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.89496342134004, "num_env_steps_trained_throughput_per_sec": 172.89496342134004, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 25469.108, "restore_workers_time_ms": 0.026, "training_step_time_ms": 25469.034, "sample_time_ms": 5214.594, "learn_time_ms": 20178.919, "learn_throughput": 198.227, "synch_weights_time_ms": 71.853}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 180, "trial_id": "4f45b_00000", "date": "2024-08-13_05-53-42", "timestamp": 1723542822, "time_this_iter_s": 23.177907943725586, "time_total_s": 15644.90109205246, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28d73a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15644.90109205246, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 76.17272727272727, "ram_util_percent": 83.54545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.810303688183348, "cur_kl_coeff": 3.91066074371338e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5372461026150083, "policy_loss": -0.0013370991467680565, "vf_loss": 0.538582976313712, "vf_explained_var": 0.005852019124560886, "kl": 0.0057629594805753736, "entropy": 0.4711828784652488, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.963889953170819, "cur_kl_coeff": 1.475045086074544e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6973653261042224, "policy_loss": -0.002821444693913378, "vf_loss": 0.7001867717299511, "vf_explained_var": 0.023105435428165254, "kl": 0.002743135221448147, "entropy": 0.23613890403162235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "env_runners": {"episode_reward_max": 112.0, "episode_reward_min": -175.0, "episode_reward_mean": 0.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -368.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 109.0, "predator_policy": 184.0}, "policy_reward_mean": {"prey_policy": -12.805, "predator_policy": 12.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, 0.0, -10.0, -4.0, -4.0, 69.0, -161.0, 0.0, 0.0, 14.0, 0.0, -6.0, 26.0, 7.0, 17.0, -11.0, 31.0, 22.0, -2.0, -175.0, 13.0, -6.0, 7.0, 3.0, -12.0, -15.0, 43.0, 48.0, -77.0, 0.0, 0.0, 112.0, 9.0, 3.0, 0.0, -7.0, -1.0, 0.0, -26.0, 0.0, -25.0, -8.0, -1.0, 43.0, 2.0, -174.0, -17.0, 2.0, 45.0, 15.0, -1.0, -34.0, -5.0, 1.0, 1.0, 28.0, 13.0, -7.0, -4.0, 0.0, 20.0, 10.0, 2.0, -15.0, 0.0, 15.0, 7.0, -40.0, 30.0, 0.0, 2.0, 0.0, 15.0, 62.0, 24.0, -21.0, 4.0, -5.0, -9.0, -7.0, 7.0, 12.0, 47.0, 0.0, -15.0, 6.0, 9.0, 18.0, -1.0, 2.0, 18.0, -11.0, 56.0, 3.0, 22.0, 13.0, 28.0, 1.0, 15.0, -74.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.0, 0.0, 0.0, 0.0, -4.0, -12.0, 0.0, -9.0, 0.0, -31.0, 16.0, 23.0, -334.0, 6.0, 0.0, 0.0, 0.0, 0.0, -135.0, 6.0, 0.0, 0.0, 0.0, -14.0, 26.0, 0.0, 1.0, 3.0, 0.0, 17.0, -21.0, -10.0, 12.0, 18.0, 22.0, 0.0, 0.0, -8.0, -350.0, 0.0, 15.0, -10.0, -12.0, 0.0, 2.0, 0.0, -33.0, 0.0, -130.0, 0.0, -24.0, -8.0, -5.0, 38.0, 0.0, 6.0, -138.0, -16.0, 0.0, 0.0, 0.0, -29.0, 109.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -13.0, 0.0, 0.0, 0.0, -20.0, -32.0, 0.0, 0.0, -2.0, -92.0, 0.0, -153.0, -60.0, -16.0, 27.0, 16.0, 5.0, -11.0, -368.0, 6.0, -30.0, -6.0, 6.0, -18.0, 8.0, 27.0, 15.0, 0.0, 0.0, -7.0, 13.0, -94.0, -26.0, -2.0, 0.0, 1.0, -30.0, 16.0, 7.0, 9.0, 0.0, 7.0, -8.0, -6.0, 0.0, -9.0, 1.0, -2.0, 5.0, 11.0, -2.0, 5.0, -33.0, 0.0, -14.0, -16.0, 0.0, -4.0, 0.0, 10.0, 0.0, 2.0, 5.0, -114.0, 16.0, 14.0, 0.0, 0.0, 0.0, -1.0, -10.0, 0.0, 15.0, 0.0, 43.0, 19.0, 14.0, 10.0, 0.0, -61.0, 4.0, 0.0, -10.0, 0.0, 0.0, -18.0, -237.0, 0.0, 0.0, 7.0, 0.0, 12.0, -4.0, -8.0, 0.0, 0.0, -20.0, -85.0, -22.0, 0.0, 13.0, -183.0, 0.0, 17.0, -16.0, 0.0, 3.0, -2.0, 2.0, 4.0, -22.0, 0.0, 42.0, 3.0, 3.0, 0.0, 10.0, 12.0, -4.0, 15.0, 0.0, 28.0, 0.0, -2.0, 15.0, 0.0, 0.0, -158.0], "policy_predator_policy_reward": [9.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0, 27.0, 25.0, 5.0, 167.0, 0.0, 0.0, 0.0, 0.0, 0.0, 70.0, 73.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 1.0, 0.0, 0.0, 6.0, 0.0, 175.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 5.0, 15.0, 21.0, 51.0, 67.0, 5.0, 12.0, 10.0, 0.0, 20.0, 22.0, 0.0, 77.0, 0.0, 0.0, 10.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 7.0, 0.0, 12.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 38.0, 31.0, 80.0, 65.0, 0.0, 75.0, 0.0, 0.0, 8.0, 0.0, 184.0, 4.0, 14.0, 5.0, 5.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 47.0, 1.0, 22.0, 0.0, 0.0, 10.0, 5.0, 3.0, 9.0, 0.0, 6.0, 3.0, 4.0, 5.0, 0.0, 1.0, 0.0, 2.0, 2.0, 7.0, 0.0, 18.0, 17.0, 0.0, 15.0, 4.0, 0.0, 0.0, 5.0, 5.0, 0.0, 69.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 39.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, 116.0, 114.0, 0.0, 0.0, 0.0, 0.0, 0.0, 59.0, 0.0, 0.0, 82.0, 8.0, 17.0, 11.0, 106.0, 73.0, 1.0, 0.0, 0.0, 15.0, 1.0, 0.0, 6.0, 6.0, 9.0, 2.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 79.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.684404683637007, "mean_inference_ms": 33.80431567486805, "mean_action_processing_ms": 2.0318914040172342, "mean_env_wait_ms": 1.9610579122250404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012894749641418457, "StateBufferConnector_ms": 0.022223353385925293, "ViewRequirementAgentConnector_ms": 0.4164755344390869}, "num_episodes": 18, "episode_return_max": 112.0, "episode_return_min": -175.0, "episode_return_mean": 0.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 177.00983790435458, "num_env_steps_trained_throughput_per_sec": 177.00983790435458, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 2896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2896000, "timers": {"training_iteration_time_ms": 25092.793, "restore_workers_time_ms": 0.024, "training_step_time_ms": 25092.722, "sample_time_ms": 5174.564, "learn_time_ms": 19844.709, "learn_throughput": 201.565, "synch_weights_time_ms": 68.982}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "done": false, "training_iteration": 181, "trial_id": "4f45b_00000", "date": "2024-08-13_05-54-05", "timestamp": 1723542845, "time_this_iter_s": 22.632405996322632, "time_total_s": 15667.533498048782, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2848040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15667.533498048782, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 76.8625, "ram_util_percent": 83.22500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4366023000980181, "cur_kl_coeff": 3.91066074371338e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22274570168641508, "policy_loss": -0.0005010800526068403, "vf_loss": 0.22324664714594036, "vf_explained_var": 0.043060302229785415, "kl": 0.0034291393551348194, "entropy": 0.45885348938129566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9111057637466327, "cur_kl_coeff": 7.37522543037272e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4859692683071391, "policy_loss": -0.00856715735927638, "vf_loss": 0.49453642573798934, "vf_explained_var": -0.3260677518037261, "kl": 0.003837043272571989, "entropy": 0.22751759877280583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "env_runners": {"episode_reward_max": 112.0, "episode_reward_min": -174.0, "episode_reward_mean": 4.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -368.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 109.0, "predator_policy": 184.0}, "policy_reward_mean": {"prey_policy": -8.565, "predator_policy": 10.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, -12.0, -15.0, 43.0, 48.0, -77.0, 0.0, 0.0, 112.0, 9.0, 3.0, 0.0, -7.0, -1.0, 0.0, -26.0, 0.0, -25.0, -8.0, -1.0, 43.0, 2.0, -174.0, -17.0, 2.0, 45.0, 15.0, -1.0, -34.0, -5.0, 1.0, 1.0, 28.0, 13.0, -7.0, -4.0, 0.0, 20.0, 10.0, 2.0, -15.0, 0.0, 15.0, 7.0, -40.0, 30.0, 0.0, 2.0, 0.0, 15.0, 62.0, 24.0, -21.0, 4.0, -5.0, -9.0, -7.0, 7.0, 12.0, 47.0, 0.0, -15.0, 6.0, 9.0, 18.0, -1.0, 2.0, 18.0, -11.0, 56.0, 3.0, 22.0, 13.0, 28.0, 1.0, 15.0, -74.0, 8.0, 18.0, 8.0, 23.0, 24.0, 11.0, 9.0, 12.0, 9.0, 0.0, 0.0, -3.0, 9.0, 2.0, 16.0, 0.0, 4.0, 30.0, 5.0, 25.0, 0.0, 10.0, 7.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-33.0, 0.0, -130.0, 0.0, -24.0, -8.0, -5.0, 38.0, 0.0, 6.0, -138.0, -16.0, 0.0, 0.0, 0.0, -29.0, 109.0, 3.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, -14.0, -13.0, 0.0, 0.0, 0.0, -20.0, -32.0, 0.0, 0.0, -2.0, -92.0, 0.0, -153.0, -60.0, -16.0, 27.0, 16.0, 5.0, -11.0, -368.0, 6.0, -30.0, -6.0, 6.0, -18.0, 8.0, 27.0, 15.0, 0.0, 0.0, -7.0, 13.0, -94.0, -26.0, -2.0, 0.0, 1.0, -30.0, 16.0, 7.0, 9.0, 0.0, 7.0, -8.0, -6.0, 0.0, -9.0, 1.0, -2.0, 5.0, 11.0, -2.0, 5.0, -33.0, 0.0, -14.0, -16.0, 0.0, -4.0, 0.0, 10.0, 0.0, 2.0, 5.0, -114.0, 16.0, 14.0, 0.0, 0.0, 0.0, -1.0, -10.0, 0.0, 15.0, 0.0, 43.0, 19.0, 14.0, 10.0, 0.0, -61.0, 4.0, 0.0, -10.0, 0.0, 0.0, -18.0, -237.0, 0.0, 0.0, 7.0, 0.0, 12.0, -4.0, -8.0, 0.0, 0.0, -20.0, -85.0, -22.0, 0.0, 13.0, -183.0, 0.0, 17.0, -16.0, 0.0, 3.0, -2.0, 2.0, 4.0, -22.0, 0.0, 42.0, 3.0, 3.0, 0.0, 10.0, 12.0, -4.0, 15.0, 0.0, 28.0, 0.0, -2.0, 15.0, 0.0, 0.0, -158.0, -4.0, 3.0, 18.0, 0.0, -10.0, 10.0, 16.0, 7.0, 12.0, 11.0, 0.0, 8.0, 9.0, 0.0, -16.0, 14.0, -2.0, 4.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 4.0, 0.0, -3.0, 0.0, -6.0, -4.0, 0.0, 0.0, 8.0, -20.0, -1.0, 1.0, -6.0, -7.0, 3.0, 15.0, -4.0, 0.0, -14.0, 10.0, -4.0, 1.0], "policy_predator_policy_reward": [15.0, 21.0, 51.0, 67.0, 5.0, 12.0, 10.0, 0.0, 20.0, 22.0, 0.0, 77.0, 0.0, 0.0, 10.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 7.0, 0.0, 12.0, 0.0, 0.0, 12.0, 14.0, 0.0, 0.0, 38.0, 31.0, 80.0, 65.0, 0.0, 75.0, 0.0, 0.0, 8.0, 0.0, 184.0, 4.0, 14.0, 5.0, 5.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 47.0, 1.0, 22.0, 0.0, 0.0, 10.0, 5.0, 3.0, 9.0, 0.0, 6.0, 3.0, 4.0, 5.0, 0.0, 1.0, 0.0, 2.0, 2.0, 7.0, 0.0, 18.0, 17.0, 0.0, 15.0, 4.0, 0.0, 0.0, 5.0, 5.0, 0.0, 69.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 39.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, 116.0, 114.0, 0.0, 0.0, 0.0, 0.0, 0.0, 59.0, 0.0, 0.0, 82.0, 8.0, 17.0, 11.0, 106.0, 73.0, 1.0, 0.0, 0.0, 15.0, 1.0, 0.0, 6.0, 6.0, 9.0, 2.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 79.0, 5.0, 0.0, 9.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 14.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, 0.0, 0.0, 5.0, 24.0, 2.0, 0.0, 0.0, 0.0, 16.0, 0.0, 30.0, 0.0, 18.0, 7.0, 0.0, 0.0, 4.0, 14.0, 0.0, 5.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.897023592303935, "mean_inference_ms": 33.121608761680825, "mean_action_processing_ms": 2.1385054086071293, "mean_env_wait_ms": 2.071972955258458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02266514301300049, "StateBufferConnector_ms": 0.01921379566192627, "ViewRequirementAgentConnector_ms": 0.3688393831253052}, "num_episodes": 23, "episode_return_max": 112.0, "episode_return_min": -174.0, "episode_return_mean": 4.31, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 185.22539516220283, "num_env_steps_trained_throughput_per_sec": 185.22539516220283, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2912000, "timers": {"training_iteration_time_ms": 24532.73, "restore_workers_time_ms": 0.022, "training_step_time_ms": 24532.66, "sample_time_ms": 5061.058, "learn_time_ms": 19403.13, "learn_throughput": 206.152, "synch_weights_time_ms": 63.936}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "done": false, "training_iteration": 182, "trial_id": "4f45b_00000", "date": "2024-08-13_05-54-27", "timestamp": 1723542867, "time_this_iter_s": 21.636070013046265, "time_total_s": 15689.169568061829, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b289fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15689.169568061829, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 75.12333333333335, "ram_util_percent": 83.33666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6608443862901479, "cur_kl_coeff": 1.95533037185669e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5071215866577058, "policy_loss": -0.0010711107775076198, "vf_loss": 0.5081926138785781, "vf_explained_var": 0.018417567298525856, "kl": 0.004364916031533264, "entropy": 0.48360691128899813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0498402343934807, "cur_kl_coeff": 3.68761271518636e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6200437043818138, "policy_loss": -0.004562681204535895, "vf_loss": 0.6246063851529644, "vf_explained_var": -0.2053804257559398, "kl": 0.0033855710108447756, "entropy": 0.29180948921139277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "env_runners": {"episode_reward_max": 62.0, "episode_reward_min": -174.0, "episode_reward_mean": 3.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -368.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 43.0, "predator_policy": 184.0}, "policy_reward_mean": {"prey_policy": -6.505, "predator_policy": 8.37}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-174.0, -17.0, 2.0, 45.0, 15.0, -1.0, -34.0, -5.0, 1.0, 1.0, 28.0, 13.0, -7.0, -4.0, 0.0, 20.0, 10.0, 2.0, -15.0, 0.0, 15.0, 7.0, -40.0, 30.0, 0.0, 2.0, 0.0, 15.0, 62.0, 24.0, -21.0, 4.0, -5.0, -9.0, -7.0, 7.0, 12.0, 47.0, 0.0, -15.0, 6.0, 9.0, 18.0, -1.0, 2.0, 18.0, -11.0, 56.0, 3.0, 22.0, 13.0, 28.0, 1.0, 15.0, -74.0, 8.0, 18.0, 8.0, 23.0, 24.0, 11.0, 9.0, 12.0, 9.0, 0.0, 0.0, -3.0, 9.0, 2.0, 16.0, 0.0, 4.0, 30.0, 5.0, 25.0, 0.0, 10.0, 7.0, 0.0, -29.0, 21.0, 0.0, 4.0, -2.0, 12.0, -4.0, 9.0, -10.0, -8.0, 13.0, 0.0, 6.0, 2.0, 0.0, 2.0, 10.0, -13.0, 0.0, 11.0, 9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-368.0, 6.0, -30.0, -6.0, 6.0, -18.0, 8.0, 27.0, 15.0, 0.0, 0.0, -7.0, 13.0, -94.0, -26.0, -2.0, 0.0, 1.0, -30.0, 16.0, 7.0, 9.0, 0.0, 7.0, -8.0, -6.0, 0.0, -9.0, 1.0, -2.0, 5.0, 11.0, -2.0, 5.0, -33.0, 0.0, -14.0, -16.0, 0.0, -4.0, 0.0, 10.0, 0.0, 2.0, 5.0, -114.0, 16.0, 14.0, 0.0, 0.0, 0.0, -1.0, -10.0, 0.0, 15.0, 0.0, 43.0, 19.0, 14.0, 10.0, 0.0, -61.0, 4.0, 0.0, -10.0, 0.0, 0.0, -18.0, -237.0, 0.0, 0.0, 7.0, 0.0, 12.0, -4.0, -8.0, 0.0, 0.0, -20.0, -85.0, -22.0, 0.0, 13.0, -183.0, 0.0, 17.0, -16.0, 0.0, 3.0, -2.0, 2.0, 4.0, -22.0, 0.0, 42.0, 3.0, 3.0, 0.0, 10.0, 12.0, -4.0, 15.0, 0.0, 28.0, 0.0, -2.0, 15.0, 0.0, 0.0, -158.0, -4.0, 3.0, 18.0, 0.0, -10.0, 10.0, 16.0, 7.0, 12.0, 11.0, 0.0, 8.0, 9.0, 0.0, -16.0, 14.0, -2.0, 4.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 4.0, 0.0, -3.0, 0.0, -6.0, -4.0, 0.0, 0.0, 8.0, -20.0, -1.0, 1.0, -6.0, -7.0, 3.0, 15.0, -4.0, 0.0, -14.0, 10.0, -4.0, 1.0, 0.0, 0.0, 0.0, -58.0, 0.0, 21.0, 0.0, 0.0, -4.0, -3.0, 0.0, -4.0, 2.0, -7.0, -18.0, 4.0, 0.0, 9.0, -20.0, 0.0, -4.0, -10.0, -74.0, 25.0, 0.0, 0.0, -2.0, 0.0, -4.0, 4.0, 0.0, 0.0, 3.0, -10.0, 0.0, -2.0, -16.0, -5.0, -6.0, 0.0, 8.0, -6.0, 6.0, 0.0], "policy_predator_policy_reward": [184.0, 4.0, 14.0, 5.0, 5.0, 9.0, 10.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 47.0, 1.0, 22.0, 0.0, 0.0, 10.0, 5.0, 3.0, 9.0, 0.0, 6.0, 3.0, 4.0, 5.0, 0.0, 1.0, 0.0, 2.0, 2.0, 7.0, 0.0, 18.0, 17.0, 0.0, 15.0, 4.0, 0.0, 0.0, 5.0, 5.0, 0.0, 69.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 39.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, 116.0, 114.0, 0.0, 0.0, 0.0, 0.0, 0.0, 59.0, 0.0, 0.0, 82.0, 8.0, 17.0, 11.0, 106.0, 73.0, 1.0, 0.0, 0.0, 15.0, 1.0, 0.0, 6.0, 6.0, 9.0, 2.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 79.0, 5.0, 0.0, 9.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 14.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, 0.0, 0.0, 5.0, 24.0, 2.0, 0.0, 0.0, 0.0, 16.0, 0.0, 30.0, 0.0, 18.0, 7.0, 0.0, 0.0, 4.0, 14.0, 0.0, 5.0, 5.0, 0.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 2.0, 0.0, 12.0, 5.0, 9.0, 1.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 37.0, 25.0, 0.0, 0.0, 5.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 10.0, 2.0, 8.0, 0.0, 0.0, 6.0, 9.0, 0.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.553657391162941, "mean_inference_ms": 33.457093219737715, "mean_action_processing_ms": 2.0170432939579195, "mean_env_wait_ms": 1.945810397396387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02391982078552246, "StateBufferConnector_ms": 0.011638760566711426, "ViewRequirementAgentConnector_ms": 0.3723865747451782}, "num_episodes": 22, "episode_return_max": 62.0, "episode_return_min": -174.0, "episode_return_mean": 3.73, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 185.56469284577628, "num_env_steps_trained_throughput_per_sec": 185.56469284577628, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 2928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2928000, "timers": {"training_iteration_time_ms": 24072.185, "restore_workers_time_ms": 0.022, "training_step_time_ms": 24072.117, "sample_time_ms": 4798.004, "learn_time_ms": 19209.259, "learn_throughput": 208.233, "synch_weights_time_ms": 60.859}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "done": false, "training_iteration": 183, "trial_id": "4f45b_00000", "date": "2024-08-13_05-54-48", "timestamp": 1723542888, "time_this_iter_s": 21.59257483482361, "time_total_s": 15710.762142896652, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b283eee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15710.762142896652, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 73.95483870967743, "ram_util_percent": 83.30000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1907759284728734, "cur_kl_coeff": 9.77665185928345e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22926646116825322, "policy_loss": -0.0021011608281966162, "vf_loss": 0.23136756611743414, "vf_explained_var": 0.0469244225946053, "kl": 0.005640201455778436, "entropy": 0.47121215967274216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8070014498063496, "cur_kl_coeff": 1.84380635759318e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3810142765967323, "policy_loss": -0.004737617761862499, "vf_loss": 0.3857518943006951, "vf_explained_var": 0.41424431517010646, "kl": 0.0043084594881479315, "entropy": 0.21209474597816114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "env_runners": {"episode_reward_max": 62.0, "episode_reward_min": -74.0, "episode_reward_mean": 6.78, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -237.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 43.0, "predator_policy": 116.0}, "policy_reward_mean": {"prey_policy": -4.02, "predator_policy": 7.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.0, 0.0, 15.0, 7.0, -40.0, 30.0, 0.0, 2.0, 0.0, 15.0, 62.0, 24.0, -21.0, 4.0, -5.0, -9.0, -7.0, 7.0, 12.0, 47.0, 0.0, -15.0, 6.0, 9.0, 18.0, -1.0, 2.0, 18.0, -11.0, 56.0, 3.0, 22.0, 13.0, 28.0, 1.0, 15.0, -74.0, 8.0, 18.0, 8.0, 23.0, 24.0, 11.0, 9.0, 12.0, 9.0, 0.0, 0.0, -3.0, 9.0, 2.0, 16.0, 0.0, 4.0, 30.0, 5.0, 25.0, 0.0, 10.0, 7.0, 0.0, -29.0, 21.0, 0.0, 4.0, -2.0, 12.0, -4.0, 9.0, -10.0, -8.0, 13.0, 0.0, 6.0, 2.0, 0.0, 2.0, 10.0, -13.0, 0.0, 11.0, 9.0, 34.0, 0.0, 11.0, 0.0, 17.0, 17.0, -1.0, -3.0, 34.0, 32.0, 8.0, 5.0, -11.0, 7.0, 0.0, 20.0, 18.0, 12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-14.0, -16.0, 0.0, -4.0, 0.0, 10.0, 0.0, 2.0, 5.0, -114.0, 16.0, 14.0, 0.0, 0.0, 0.0, -1.0, -10.0, 0.0, 15.0, 0.0, 43.0, 19.0, 14.0, 10.0, 0.0, -61.0, 4.0, 0.0, -10.0, 0.0, 0.0, -18.0, -237.0, 0.0, 0.0, 7.0, 0.0, 12.0, -4.0, -8.0, 0.0, 0.0, -20.0, -85.0, -22.0, 0.0, 13.0, -183.0, 0.0, 17.0, -16.0, 0.0, 3.0, -2.0, 2.0, 4.0, -22.0, 0.0, 42.0, 3.0, 3.0, 0.0, 10.0, 12.0, -4.0, 15.0, 0.0, 28.0, 0.0, -2.0, 15.0, 0.0, 0.0, -158.0, -4.0, 3.0, 18.0, 0.0, -10.0, 10.0, 16.0, 7.0, 12.0, 11.0, 0.0, 8.0, 9.0, 0.0, -16.0, 14.0, -2.0, 4.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 4.0, 0.0, -3.0, 0.0, -6.0, -4.0, 0.0, 0.0, 8.0, -20.0, -1.0, 1.0, -6.0, -7.0, 3.0, 15.0, -4.0, 0.0, -14.0, 10.0, -4.0, 1.0, 0.0, 0.0, 0.0, -58.0, 0.0, 21.0, 0.0, 0.0, -4.0, -3.0, 0.0, -4.0, 2.0, -7.0, -18.0, 4.0, 0.0, 9.0, -20.0, 0.0, -4.0, -10.0, -74.0, 25.0, 0.0, 0.0, -2.0, 0.0, -4.0, 4.0, 0.0, 0.0, 3.0, -10.0, 0.0, -2.0, -16.0, -5.0, -6.0, 0.0, 8.0, -6.0, 6.0, 0.0, 13.0, 21.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 10.0, 15.0, -13.0, -49.0, 15.0, -7.0, 0.0, 31.0, 3.0, 37.0, -14.0, -17.0, 0.0, -23.0, 0.0, -36.0, -14.0, -2.0, 3.0, 0.0, 0.0, -11.0, 13.0, 14.0, -14.0, 19.0, -14.0], "policy_predator_policy_reward": [0.0, 15.0, 4.0, 0.0, 0.0, 5.0, 5.0, 0.0, 69.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 39.0, 0.0, 0.0, 5.0, 0.0, 9.0, 0.0, 116.0, 114.0, 0.0, 0.0, 0.0, 0.0, 0.0, 59.0, 0.0, 0.0, 82.0, 8.0, 17.0, 11.0, 106.0, 73.0, 1.0, 0.0, 0.0, 15.0, 1.0, 0.0, 6.0, 6.0, 9.0, 2.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 79.0, 5.0, 0.0, 9.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 14.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, 0.0, 0.0, 5.0, 24.0, 2.0, 0.0, 0.0, 0.0, 16.0, 0.0, 30.0, 0.0, 18.0, 7.0, 0.0, 0.0, 4.0, 14.0, 0.0, 5.0, 5.0, 0.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 2.0, 0.0, 12.0, 5.0, 9.0, 1.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 37.0, 25.0, 0.0, 0.0, 5.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 10.0, 2.0, 8.0, 0.0, 0.0, 6.0, 9.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 9.0, 6.0, 33.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 7.0, 21.0, 4.0, 11.0, 17.0, 32.0, 7.0, 6.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 18.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.500125188951182, "mean_inference_ms": 33.31521827096093, "mean_action_processing_ms": 2.010732240317923, "mean_env_wait_ms": 1.939300577161908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023360252380371094, "StateBufferConnector_ms": 0.01174938678741455, "ViewRequirementAgentConnector_ms": 0.38926446437835693}, "num_episodes": 18, "episode_return_max": 62.0, "episode_return_min": -74.0, "episode_return_mean": 6.78, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 178.7631913672246, "num_env_steps_trained_throughput_per_sec": 178.7631913672246, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2944000, "timers": {"training_iteration_time_ms": 23403.745, "restore_workers_time_ms": 0.022, "training_step_time_ms": 23403.675, "sample_time_ms": 4408.528, "learn_time_ms": 18941.806, "learn_throughput": 211.173, "synch_weights_time_ms": 49.181}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "done": false, "training_iteration": 184, "trial_id": "4f45b_00000", "date": "2024-08-13_05-55-11", "timestamp": 1723542911, "time_this_iter_s": 22.442986011505127, "time_total_s": 15733.205128908157, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b291c5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15733.205128908157, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 75.29032258064517, "ram_util_percent": 83.33870967741937}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4851226217059232, "cur_kl_coeff": 9.77665185928345e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5111205949433266, "policy_loss": -0.0010805700444887396, "vf_loss": 0.5122008993032896, "vf_explained_var": 0.035767741493447115, "kl": 0.02712188221280116, "entropy": 0.5390266227186041, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8210917683347825, "cur_kl_coeff": 9.2190317879659e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5365873780885031, "policy_loss": -0.0019171526034673055, "vf_loss": 0.538504531937676, "vf_explained_var": 0.2528235866279198, "kl": 0.003698885317891425, "entropy": 0.2884034597526782, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 72.0, "episode_reward_min": -74.0, "episode_reward_mean": 8.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -183.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 61.0, "predator_policy": 106.0}, "policy_reward_mean": {"prey_policy": -1.905, "predator_policy": 6.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, 47.0, 0.0, -15.0, 6.0, 9.0, 18.0, -1.0, 2.0, 18.0, -11.0, 56.0, 3.0, 22.0, 13.0, 28.0, 1.0, 15.0, -74.0, 8.0, 18.0, 8.0, 23.0, 24.0, 11.0, 9.0, 12.0, 9.0, 0.0, 0.0, -3.0, 9.0, 2.0, 16.0, 0.0, 4.0, 30.0, 5.0, 25.0, 0.0, 10.0, 7.0, 0.0, -29.0, 21.0, 0.0, 4.0, -2.0, 12.0, -4.0, 9.0, -10.0, -8.0, 13.0, 0.0, 6.0, 2.0, 0.0, 2.0, 10.0, -13.0, 0.0, 11.0, 9.0, 34.0, 0.0, 11.0, 0.0, 17.0, 17.0, -1.0, -3.0, 34.0, 32.0, 8.0, 5.0, -11.0, 7.0, 0.0, 20.0, 18.0, 12.0, -3.0, 0.0, 23.0, 4.0, 6.0, -11.0, -2.0, 72.0, 23.0, 18.0, 33.0, 20.0, 30.0, 16.0, 18.0, 2.0, 8.0, -2.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 12.0, -4.0, -8.0, 0.0, 0.0, -20.0, -85.0, -22.0, 0.0, 13.0, -183.0, 0.0, 17.0, -16.0, 0.0, 3.0, -2.0, 2.0, 4.0, -22.0, 0.0, 42.0, 3.0, 3.0, 0.0, 10.0, 12.0, -4.0, 15.0, 0.0, 28.0, 0.0, -2.0, 15.0, 0.0, 0.0, -158.0, -4.0, 3.0, 18.0, 0.0, -10.0, 10.0, 16.0, 7.0, 12.0, 11.0, 0.0, 8.0, 9.0, 0.0, -16.0, 14.0, -2.0, 4.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 4.0, 0.0, -3.0, 0.0, -6.0, -4.0, 0.0, 0.0, 8.0, -20.0, -1.0, 1.0, -6.0, -7.0, 3.0, 15.0, -4.0, 0.0, -14.0, 10.0, -4.0, 1.0, 0.0, 0.0, 0.0, -58.0, 0.0, 21.0, 0.0, 0.0, -4.0, -3.0, 0.0, -4.0, 2.0, -7.0, -18.0, 4.0, 0.0, 9.0, -20.0, 0.0, -4.0, -10.0, -74.0, 25.0, 0.0, 0.0, -2.0, 0.0, -4.0, 4.0, 0.0, 0.0, 3.0, -10.0, 0.0, -2.0, -16.0, -5.0, -6.0, 0.0, 8.0, -6.0, 6.0, 0.0, 13.0, 21.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 10.0, 15.0, -13.0, -49.0, 15.0, -7.0, 0.0, 31.0, 3.0, 37.0, -14.0, -17.0, 0.0, -23.0, 0.0, -36.0, -14.0, -2.0, 3.0, 0.0, 0.0, -11.0, 13.0, 14.0, -14.0, 19.0, -14.0, 0.0, -18.0, 0.0, 0.0, 27.0, -8.0, -8.0, 8.0, 9.0, -16.0, 53.0, -128.0, -4.0, 0.0, 0.0, 61.0, 16.0, -5.0, 2.0, 9.0, 32.0, 0.0, 20.0, 0.0, 0.0, 24.0, 0.0, 16.0, 18.0, 0.0, -16.0, 2.0, 9.0, -2.0, -4.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 59.0, 0.0, 0.0, 82.0, 8.0, 17.0, 11.0, 106.0, 73.0, 1.0, 0.0, 0.0, 15.0, 1.0, 0.0, 6.0, 6.0, 9.0, 2.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 79.0, 5.0, 0.0, 9.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 14.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, 0.0, 0.0, 5.0, 24.0, 2.0, 0.0, 0.0, 0.0, 16.0, 0.0, 30.0, 0.0, 18.0, 7.0, 0.0, 0.0, 4.0, 14.0, 0.0, 5.0, 5.0, 0.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 2.0, 0.0, 12.0, 5.0, 9.0, 1.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 37.0, 25.0, 0.0, 0.0, 5.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 10.0, 2.0, 8.0, 0.0, 0.0, 6.0, 9.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 9.0, 6.0, 33.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 7.0, 21.0, 4.0, 11.0, 17.0, 32.0, 7.0, 6.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 18.0, 0.0, 7.0, 1.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 4.0, 6.0, 7.0, 64.0, 0.0, 2.0, 0.0, 5.0, 6.0, 12.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 1.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.44626632207029, "mean_inference_ms": 33.17269557628558, "mean_action_processing_ms": 2.0041785494501116, "mean_env_wait_ms": 1.932532228989146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02531588077545166, "StateBufferConnector_ms": 0.006953001022338867, "ViewRequirementAgentConnector_ms": 0.35017311573028564}, "num_episodes": 18, "episode_return_max": 72.0, "episode_return_min": -74.0, "episode_return_mean": 8.64, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.59164466544806, "num_env_steps_trained_throughput_per_sec": 179.59164466544806, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 22989.412, "restore_workers_time_ms": 0.021, "training_step_time_ms": 22989.344, "sample_time_ms": 4128.986, "learn_time_ms": 18808.756, "learn_throughput": 212.667, "synch_weights_time_ms": 47.43}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 185, "trial_id": "4f45b_00000", "date": "2024-08-13_05-55-33", "timestamp": 1723542933, "time_this_iter_s": 22.33392310142517, "time_total_s": 15755.539052009583, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b282d310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15755.539052009583, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 74.58125, "ram_util_percent": 83.396875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1501260666541322, "cur_kl_coeff": 1.4664977788925167e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22212703746248272, "policy_loss": -0.00061267415263626, "vf_loss": 0.22273951448443488, "vf_explained_var": 0.0403658510831298, "kl": 0.013424749265747242, "entropy": 0.5986717680774668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6347045746351045, "cur_kl_coeff": 4.60951589398295e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.28851241472955774, "policy_loss": -0.003845264625035857, "vf_loss": 0.2923576784805548, "vf_explained_var": -0.007008030458732888, "kl": 0.0049256558248624745, "entropy": 0.2078961215400822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "env_runners": {"episode_reward_max": 72.0, "episode_reward_min": -74.0, "episode_reward_mean": 7.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -158.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 61.0, "predator_policy": 79.0}, "policy_reward_mean": {"prey_policy": -1.12, "predator_policy": 5.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-74.0, 8.0, 18.0, 8.0, 23.0, 24.0, 11.0, 9.0, 12.0, 9.0, 0.0, 0.0, -3.0, 9.0, 2.0, 16.0, 0.0, 4.0, 30.0, 5.0, 25.0, 0.0, 10.0, 7.0, 0.0, -29.0, 21.0, 0.0, 4.0, -2.0, 12.0, -4.0, 9.0, -10.0, -8.0, 13.0, 0.0, 6.0, 2.0, 0.0, 2.0, 10.0, -13.0, 0.0, 11.0, 9.0, 34.0, 0.0, 11.0, 0.0, 17.0, 17.0, -1.0, -3.0, 34.0, 32.0, 8.0, 5.0, -11.0, 7.0, 0.0, 20.0, 18.0, 12.0, -3.0, 0.0, 23.0, 4.0, 6.0, -11.0, -2.0, 72.0, 23.0, 18.0, 33.0, 20.0, 30.0, 16.0, 18.0, 2.0, 8.0, -2.0, 34.0, -2.0, 26.0, 3.0, 5.0, 24.0, -7.0, 8.0, -1.0, 13.0, 0.0, 22.0, 0.0, 0.0, 9.0, 20.0, 0.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -158.0, -4.0, 3.0, 18.0, 0.0, -10.0, 10.0, 16.0, 7.0, 12.0, 11.0, 0.0, 8.0, 9.0, 0.0, -16.0, 14.0, -2.0, 4.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 4.0, 0.0, -3.0, 0.0, -6.0, -4.0, 0.0, 0.0, 8.0, -20.0, -1.0, 1.0, -6.0, -7.0, 3.0, 15.0, -4.0, 0.0, -14.0, 10.0, -4.0, 1.0, 0.0, 0.0, 0.0, -58.0, 0.0, 21.0, 0.0, 0.0, -4.0, -3.0, 0.0, -4.0, 2.0, -7.0, -18.0, 4.0, 0.0, 9.0, -20.0, 0.0, -4.0, -10.0, -74.0, 25.0, 0.0, 0.0, -2.0, 0.0, -4.0, 4.0, 0.0, 0.0, 3.0, -10.0, 0.0, -2.0, -16.0, -5.0, -6.0, 0.0, 8.0, -6.0, 6.0, 0.0, 13.0, 21.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 10.0, 15.0, -13.0, -49.0, 15.0, -7.0, 0.0, 31.0, 3.0, 37.0, -14.0, -17.0, 0.0, -23.0, 0.0, -36.0, -14.0, -2.0, 3.0, 0.0, 0.0, -11.0, 13.0, 14.0, -14.0, 19.0, -14.0, 0.0, -18.0, 0.0, 0.0, 27.0, -8.0, -8.0, 8.0, 9.0, -16.0, 53.0, -128.0, -4.0, 0.0, 0.0, 61.0, 16.0, -5.0, 2.0, 9.0, 32.0, 0.0, 20.0, 0.0, 0.0, 24.0, 0.0, 16.0, 18.0, 0.0, -16.0, 2.0, 9.0, -2.0, -4.0, 0.0, -1.0, 18.0, -12.0, -8.0, -13.0, 10.0, 0.0, 3.0, 0.0, 5.0, 26.0, -9.0, -2.0, -24.0, 2.0, 0.0, 0.0, -3.0, 0.0, -21.0, 0.0, 0.0, -29.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 16.0, -6.0, 0.0, 0.0, -4.0, -2.0], "policy_predator_policy_reward": [79.0, 5.0, 0.0, 9.0, 0.0, 0.0, 3.0, 5.0, 0.0, 0.0, 1.0, 0.0, 0.0, 3.0, 0.0, 0.0, 14.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, 0.0, 0.0, 5.0, 24.0, 2.0, 0.0, 0.0, 0.0, 16.0, 0.0, 30.0, 0.0, 18.0, 7.0, 0.0, 0.0, 4.0, 14.0, 0.0, 5.0, 5.0, 0.0, 0.0, 29.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 2.0, 0.0, 12.0, 5.0, 9.0, 1.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 37.0, 25.0, 0.0, 0.0, 5.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 10.0, 2.0, 8.0, 0.0, 0.0, 6.0, 9.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 9.0, 6.0, 33.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 7.0, 21.0, 4.0, 11.0, 17.0, 32.0, 7.0, 6.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 18.0, 0.0, 7.0, 1.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 4.0, 6.0, 7.0, 64.0, 0.0, 2.0, 0.0, 5.0, 6.0, 12.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 1.0, 2.0, 0.0, 4.0, 13.0, 6.0, 12.0, 15.0, 14.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 7.0, 12.0, 6.0, 0.0, 2.0, 0.0, 18.0, 16.0, 0.0, 0.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 3.0, 7.0, 0.0, 0.0, 9.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.392535943891094, "mean_inference_ms": 33.03062115512421, "mean_action_processing_ms": 1.9975108887659696, "mean_env_wait_ms": 1.9257037944600202, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023917675018310547, "StateBufferConnector_ms": 0.0073816776275634766, "ViewRequirementAgentConnector_ms": 0.29625582695007324}, "num_episodes": 18, "episode_return_max": 72.0, "episode_return_min": -74.0, "episode_return_mean": 7.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 187.92029571421008, "num_env_steps_trained_throughput_per_sec": 187.92029571421008, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2976000, "timers": {"training_iteration_time_ms": 23034.126, "restore_workers_time_ms": 0.021, "training_step_time_ms": 23034.057, "sample_time_ms": 3946.328, "learn_time_ms": 19039.48, "learn_throughput": 210.09, "synch_weights_time_ms": 43.506}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "done": false, "training_iteration": 186, "trial_id": "4f45b_00000", "date": "2024-08-13_05-55-55", "timestamp": 1723542955, "time_this_iter_s": 21.34021782875061, "time_total_s": 15776.879269838333, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b291c670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15776.879269838333, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 75.04333333333334, "ram_util_percent": 83.17333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2808358999471816, "cur_kl_coeff": 1.4664977788925167e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.34117437373629955, "policy_loss": -0.0016212412057611994, "vf_loss": 0.34279546875743167, "vf_explained_var": 0.024479153862705938, "kl": 0.009867120997609983, "entropy": 0.5994261773963454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9779494275885914, "cur_kl_coeff": 2.304757946991475e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4701263866953985, "policy_loss": -0.003406251158698329, "vf_loss": 0.473532636988435, "vf_explained_var": 0.388361694699242, "kl": 0.0011822405852327286, "entropy": 0.2042297537995394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "env_runners": {"episode_reward_max": 72.0, "episode_reward_min": -29.0, "episode_reward_mean": 7.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -128.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 61.0, "predator_policy": 64.0}, "policy_reward_mean": {"prey_policy": -0.825, "predator_policy": 4.545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 4.0, -2.0, 12.0, -4.0, 9.0, -10.0, -8.0, 13.0, 0.0, 6.0, 2.0, 0.0, 2.0, 10.0, -13.0, 0.0, 11.0, 9.0, 34.0, 0.0, 11.0, 0.0, 17.0, 17.0, -1.0, -3.0, 34.0, 32.0, 8.0, 5.0, -11.0, 7.0, 0.0, 20.0, 18.0, 12.0, -3.0, 0.0, 23.0, 4.0, 6.0, -11.0, -2.0, 72.0, 23.0, 18.0, 33.0, 20.0, 30.0, 16.0, 18.0, 2.0, 8.0, -2.0, 34.0, -2.0, 26.0, 3.0, 5.0, 24.0, -7.0, 8.0, -1.0, 13.0, 0.0, 22.0, 0.0, 0.0, 9.0, 20.0, 0.0, 4.0, -3.0, -29.0, 0.0, -7.0, 11.0, -4.0, 19.0, -7.0, 0.0, 3.0, 42.0, 0.0, 0.0, -7.0, -13.0, 0.0, 0.0, 17.0, 4.0, -6.0, 27.0, 0.0, 20.0, 19.0, 11.0, -7.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -4.0, -3.0, 0.0, -4.0, 2.0, -7.0, -18.0, 4.0, 0.0, 9.0, -20.0, 0.0, -4.0, -10.0, -74.0, 25.0, 0.0, 0.0, -2.0, 0.0, -4.0, 4.0, 0.0, 0.0, 3.0, -10.0, 0.0, -2.0, -16.0, -5.0, -6.0, 0.0, 8.0, -6.0, 6.0, 0.0, 13.0, 21.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 10.0, 15.0, -13.0, -49.0, 15.0, -7.0, 0.0, 31.0, 3.0, 37.0, -14.0, -17.0, 0.0, -23.0, 0.0, -36.0, -14.0, -2.0, 3.0, 0.0, 0.0, -11.0, 13.0, 14.0, -14.0, 19.0, -14.0, 0.0, -18.0, 0.0, 0.0, 27.0, -8.0, -8.0, 8.0, 9.0, -16.0, 53.0, -128.0, -4.0, 0.0, 0.0, 61.0, 16.0, -5.0, 2.0, 9.0, 32.0, 0.0, 20.0, 0.0, 0.0, 24.0, 0.0, 16.0, 18.0, 0.0, -16.0, 2.0, 9.0, -2.0, -4.0, 0.0, -1.0, 18.0, -12.0, -8.0, -13.0, 10.0, 0.0, 3.0, 0.0, 5.0, 26.0, -9.0, -2.0, -24.0, 2.0, 0.0, 0.0, -3.0, 0.0, -21.0, 0.0, 0.0, -29.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 16.0, -6.0, 0.0, 0.0, -4.0, -2.0, 0.0, -6.0, -58.0, 0.0, 0.0, 0.0, 0.0, -14.0, -6.0, 2.0, 0.0, -10.0, 19.0, 0.0, 1.0, -32.0, 0.0, 0.0, 1.0, -8.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 1.0, 0.0, -12.0, 27.0, 0.0, 0.0, 0.0, 13.0, -5.0, -12.0, 5.0, 4.0, 0.0, -6.0, -6.0, 0.0, 0.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 11.0, 2.0, 0.0, 12.0, 5.0, 9.0, 1.0, 0.0, 0.0, 0.0, 10.0, 6.0, 0.0, 37.0, 25.0, 0.0, 0.0, 5.0, 3.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 10.0, 2.0, 8.0, 0.0, 0.0, 6.0, 9.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 9.0, 6.0, 33.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 7.0, 21.0, 4.0, 11.0, 17.0, 32.0, 7.0, 6.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 18.0, 0.0, 7.0, 1.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 4.0, 6.0, 7.0, 64.0, 0.0, 2.0, 0.0, 5.0, 6.0, 12.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 1.0, 2.0, 0.0, 4.0, 13.0, 6.0, 12.0, 15.0, 14.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 7.0, 12.0, 6.0, 0.0, 2.0, 0.0, 18.0, 16.0, 0.0, 0.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 3.0, 7.0, 0.0, 0.0, 9.0, 1.0, 0.0, 3.0, 0.0, 29.0, 0.0, 0.0, 7.0, 0.0, 3.0, 12.0, 0.0, 6.0, 0.0, 0.0, 16.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 8.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 16.0, 10.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.57064695302194, "mean_inference_ms": 32.564256431408324, "mean_action_processing_ms": 1.9866514921163636, "mean_env_wait_ms": 1.9153188583526637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013787388801574707, "StateBufferConnector_ms": 0.0073555707931518555, "ViewRequirementAgentConnector_ms": 0.29441189765930176}, "num_episodes": 27, "episode_return_max": 72.0, "episode_return_min": -29.0, "episode_return_mean": 7.44, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 184.3213065842619, "num_env_steps_trained_throughput_per_sec": 184.3213065842619, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 2992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2992000, "timers": {"training_iteration_time_ms": 22956.095, "restore_workers_time_ms": 0.019, "training_step_time_ms": 22956.03, "sample_time_ms": 3821.952, "learn_time_ms": 19090.871, "learn_throughput": 209.524, "synch_weights_time_ms": 38.388}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "done": false, "training_iteration": 187, "trial_id": "4f45b_00000", "date": "2024-08-13_05-56-16", "timestamp": 1723542976, "time_this_iter_s": 21.766968965530396, "time_total_s": 15798.646238803864, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b291c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15798.646238803864, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 74.99354838709677, "ram_util_percent": 82.92258064516132}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3524568473023397, "cur_kl_coeff": 1.4664977788925167e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20041561933066795, "policy_loss": -0.00270489716234681, "vf_loss": 0.20312031305733996, "vf_explained_var": -0.010037157775233032, "kl": 0.01385873334852276, "entropy": 0.6146314688145168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.143092283854882, "cur_kl_coeff": 1.1523789734957376e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3430968674863122, "policy_loss": -0.001222013419237796, "vf_loss": 0.34431888028318997, "vf_explained_var": 0.6073828602278674, "kl": 0.004423603588669921, "entropy": 0.162522064456864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "env_runners": {"episode_reward_max": 72.0, "episode_reward_min": -29.0, "episode_reward_mean": 9.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -128.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 61.0, "predator_policy": 64.0}, "policy_reward_mean": {"prey_policy": 0.35, "predator_policy": 4.22}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 34.0, 0.0, 11.0, 0.0, 17.0, 17.0, -1.0, -3.0, 34.0, 32.0, 8.0, 5.0, -11.0, 7.0, 0.0, 20.0, 18.0, 12.0, -3.0, 0.0, 23.0, 4.0, 6.0, -11.0, -2.0, 72.0, 23.0, 18.0, 33.0, 20.0, 30.0, 16.0, 18.0, 2.0, 8.0, -2.0, 34.0, -2.0, 26.0, 3.0, 5.0, 24.0, -7.0, 8.0, -1.0, 13.0, 0.0, 22.0, 0.0, 0.0, 9.0, 20.0, 0.0, 4.0, -3.0, -29.0, 0.0, -7.0, 11.0, -4.0, 19.0, -7.0, 0.0, 3.0, 42.0, 0.0, 0.0, -7.0, -13.0, 0.0, 0.0, 17.0, 4.0, -6.0, 27.0, 0.0, 20.0, 19.0, 11.0, -7.0, 0.0, -4.0, 10.0, 23.0, 14.0, 0.0, 8.0, 17.0, 8.0, 69.0, 0.0, 0.0, 12.0, 11.0, 15.0, 4.0, 0.0, 1.0, 14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6.0, 0.0, 13.0, 21.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 2.0, 10.0, 15.0, -13.0, -49.0, 15.0, -7.0, 0.0, 31.0, 3.0, 37.0, -14.0, -17.0, 0.0, -23.0, 0.0, -36.0, -14.0, -2.0, 3.0, 0.0, 0.0, -11.0, 13.0, 14.0, -14.0, 19.0, -14.0, 0.0, -18.0, 0.0, 0.0, 27.0, -8.0, -8.0, 8.0, 9.0, -16.0, 53.0, -128.0, -4.0, 0.0, 0.0, 61.0, 16.0, -5.0, 2.0, 9.0, 32.0, 0.0, 20.0, 0.0, 0.0, 24.0, 0.0, 16.0, 18.0, 0.0, -16.0, 2.0, 9.0, -2.0, -4.0, 0.0, -1.0, 18.0, -12.0, -8.0, -13.0, 10.0, 0.0, 3.0, 0.0, 5.0, 26.0, -9.0, -2.0, -24.0, 2.0, 0.0, 0.0, -3.0, 0.0, -21.0, 0.0, 0.0, -29.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 16.0, -6.0, 0.0, 0.0, -4.0, -2.0, 0.0, -6.0, -58.0, 0.0, 0.0, 0.0, 0.0, -14.0, -6.0, 2.0, 0.0, -10.0, 19.0, 0.0, 1.0, -32.0, 0.0, 0.0, 1.0, -8.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 1.0, 0.0, -12.0, 27.0, 0.0, 0.0, 0.0, 13.0, -5.0, -12.0, 5.0, 4.0, 0.0, -6.0, -6.0, 0.0, 0.0, -20.0, -4.0, 3.0, 0.0, -3.0, 24.0, 0.0, 9.0, 0.0, 0.0, 4.0, -6.0, 3.0, 0.0, 7.0, 0.0, 31.0, 38.0, 0.0, 0.0, 0.0, 0.0, -4.0, 10.0, 4.0, 3.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, -29.0, 0.0, 14.0, 0.0], "policy_predator_policy_reward": [3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 9.0, 6.0, 33.0, 0.0, 4.0, 0.0, 0.0, 0.0, 2.0, 7.0, 21.0, 4.0, 11.0, 17.0, 32.0, 7.0, 6.0, 0.0, 0.0, 0.0, 9.0, 9.0, 0.0, 18.0, 0.0, 7.0, 1.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 4.0, 6.0, 7.0, 64.0, 0.0, 2.0, 0.0, 5.0, 6.0, 12.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 1.0, 2.0, 0.0, 4.0, 13.0, 6.0, 12.0, 15.0, 14.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 7.0, 12.0, 6.0, 0.0, 2.0, 0.0, 18.0, 16.0, 0.0, 0.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 3.0, 7.0, 0.0, 0.0, 9.0, 1.0, 0.0, 3.0, 0.0, 29.0, 0.0, 0.0, 7.0, 0.0, 3.0, 12.0, 0.0, 6.0, 0.0, 0.0, 16.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 8.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 16.0, 10.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 7.0, 0.0, 2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 11.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 8.0, 22.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.262842995860924, "mean_inference_ms": 32.689239105365225, "mean_action_processing_ms": 1.9813254805811527, "mean_env_wait_ms": 1.908901798141016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01265418529510498, "StateBufferConnector_ms": 0.0071479082107543945, "ViewRequirementAgentConnector_ms": 0.29255008697509766}, "num_episodes": 18, "episode_return_max": 72.0, "episode_return_min": -29.0, "episode_return_mean": 9.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.097714288176393, "num_env_steps_trained_throughput_per_sec": 4.097714288176393, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 3008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3008000, "timers": {"training_iteration_time_ms": 118616.194, "restore_workers_time_ms": 0.019, "training_step_time_ms": 118616.129, "sample_time_ms": 3756.554, "learn_time_ms": 114816.683, "learn_throughput": 34.838, "synch_weights_time_ms": 37.634}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "done": false, "training_iteration": 188, "trial_id": "4f45b_00000", "date": "2024-08-13_06-12-33", "timestamp": 1723543953, "time_this_iter_s": 976.352697134018, "time_total_s": 16774.99893593788, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b283e430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16774.99893593788, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 87.28775510204082, "ram_util_percent": 83.96326530612245}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5272061477538454, "cur_kl_coeff": 1.4664977788925167e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.31270533422865565, "policy_loss": -0.0005174046071867148, "vf_loss": 0.3132226680536328, "vf_explained_var": 0.018598301259298174, "kl": 0.004808965586573461, "entropy": 0.5817925863638126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3372156769037247, "cur_kl_coeff": 5.761894867478688e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4605322053106551, "policy_loss": -0.0004619250867377829, "vf_loss": 0.4609941298206135, "vf_explained_var": 0.2357057288840965, "kl": 0.0011430152844140527, "entropy": 0.1415294148737476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "env_runners": {"episode_reward_max": 72.0, "episode_reward_min": -64.0, "episode_reward_mean": 8.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -160.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 61.0, "predator_policy": 80.0}, "policy_reward_mean": {"prey_policy": 0.145, "predator_policy": 4.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.0, -3.0, 0.0, 23.0, 4.0, 6.0, -11.0, -2.0, 72.0, 23.0, 18.0, 33.0, 20.0, 30.0, 16.0, 18.0, 2.0, 8.0, -2.0, 34.0, -2.0, 26.0, 3.0, 5.0, 24.0, -7.0, 8.0, -1.0, 13.0, 0.0, 22.0, 0.0, 0.0, 9.0, 20.0, 0.0, 4.0, -3.0, -29.0, 0.0, -7.0, 11.0, -4.0, 19.0, -7.0, 0.0, 3.0, 42.0, 0.0, 0.0, -7.0, -13.0, 0.0, 0.0, 17.0, 4.0, -6.0, 27.0, 0.0, 20.0, 19.0, 11.0, -7.0, 0.0, -4.0, 10.0, 23.0, 14.0, 0.0, 8.0, 17.0, 8.0, 69.0, 0.0, 0.0, 12.0, 11.0, 15.0, 4.0, 0.0, 1.0, 14.0, 17.0, 0.0, 50.0, -6.0, 11.0, -64.0, -4.0, 0.0, 38.0, -6.0, -1.0, -3.0, 0.0, 40.0, 11.0, 0.0, 43.0, 9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [19.0, -14.0, 0.0, -18.0, 0.0, 0.0, 27.0, -8.0, -8.0, 8.0, 9.0, -16.0, 53.0, -128.0, -4.0, 0.0, 0.0, 61.0, 16.0, -5.0, 2.0, 9.0, 32.0, 0.0, 20.0, 0.0, 0.0, 24.0, 0.0, 16.0, 18.0, 0.0, -16.0, 2.0, 9.0, -2.0, -4.0, 0.0, -1.0, 18.0, -12.0, -8.0, -13.0, 10.0, 0.0, 3.0, 0.0, 5.0, 26.0, -9.0, -2.0, -24.0, 2.0, 0.0, 0.0, -3.0, 0.0, -21.0, 0.0, 0.0, -29.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 16.0, -6.0, 0.0, 0.0, -4.0, -2.0, 0.0, -6.0, -58.0, 0.0, 0.0, 0.0, 0.0, -14.0, -6.0, 2.0, 0.0, -10.0, 19.0, 0.0, 1.0, -32.0, 0.0, 0.0, 1.0, -8.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 1.0, 0.0, -12.0, 27.0, 0.0, 0.0, 0.0, 13.0, -5.0, -12.0, 5.0, 4.0, 0.0, -6.0, -6.0, 0.0, 0.0, -20.0, -4.0, 3.0, 0.0, -3.0, 24.0, 0.0, 9.0, 0.0, 0.0, 4.0, -6.0, 3.0, 0.0, 7.0, 0.0, 31.0, 38.0, 0.0, 0.0, 0.0, 0.0, -4.0, 10.0, 4.0, 3.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, -29.0, 0.0, 14.0, 0.0, -11.0, 15.0, 0.0, 0.0, 36.0, 10.0, -16.0, 0.0, 9.0, 0.0, 16.0, -160.0, -2.0, -4.0, 0.0, 0.0, 29.0, 9.0, -2.0, -18.0, -2.0, -9.0, -2.0, -8.0, 0.0, 0.0, -8.0, 40.0, 0.0, -15.0, 0.0, 0.0, 11.0, 30.0, 0.0, 5.0], "policy_predator_policy_reward": [0.0, 7.0, 1.0, 14.0, 0.0, 0.0, 4.0, 0.0, 0.0, 4.0, 6.0, 7.0, 64.0, 0.0, 2.0, 0.0, 5.0, 6.0, 12.0, 0.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 1.0, 2.0, 0.0, 4.0, 13.0, 6.0, 12.0, 15.0, 14.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 7.0, 12.0, 6.0, 0.0, 2.0, 0.0, 18.0, 16.0, 0.0, 0.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 3.0, 7.0, 0.0, 0.0, 9.0, 1.0, 0.0, 3.0, 0.0, 29.0, 0.0, 0.0, 7.0, 0.0, 3.0, 12.0, 0.0, 6.0, 0.0, 0.0, 16.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 8.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 16.0, 10.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 7.0, 0.0, 2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 11.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 8.0, 22.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 4.0, 9.0, 1.0, 0.0, 2.0, 0.0, 80.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 6.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 8.0, 0.0, 10.0, 16.0, 0.0, 0.0, 2.0, 0.0, 1.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.212358018356408, "mean_inference_ms": 32.55460575929098, "mean_action_processing_ms": 1.9753016865532496, "mean_env_wait_ms": 1.9025723912764603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01143348217010498, "StateBufferConnector_ms": 0.007625222206115723, "ViewRequirementAgentConnector_ms": 0.3135932683944702}, "num_episodes": 18, "episode_return_max": 72.0, "episode_return_min": -64.0, "episode_return_mean": 8.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 186.5609004411563, "num_env_steps_trained_throughput_per_sec": 186.5609004411563, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 3024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3024000, "timers": {"training_iteration_time_ms": 117411.454, "restore_workers_time_ms": 0.021, "training_step_time_ms": 117411.383, "sample_time_ms": 3903.896, "learn_time_ms": 113413.846, "learn_throughput": 35.269, "synch_weights_time_ms": 86.637}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "done": false, "training_iteration": 189, "trial_id": "4f45b_00000", "date": "2024-08-13_06-12-55", "timestamp": 1723543975, "time_this_iter_s": 21.55648398399353, "time_total_s": 16796.555419921875, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b282d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16796.555419921875, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 81.98064516129031, "ram_util_percent": 83.64516129032256}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9291627476928095, "cur_kl_coeff": 7.332488894462584e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7731967371922952, "policy_loss": -7.632886510460623e-05, "vf_loss": 0.7732730396367885, "vf_explained_var": 0.003481241855671797, "kl": 0.00436990349277389, "entropy": 0.5308608673867725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.625977215017118, "cur_kl_coeff": 2.880947433739344e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.890516550510767, "policy_loss": 0.00017431856295655645, "vf_loss": 0.8903422325139954, "vf_explained_var": 0.021424655561093933, "kl": 0.0006622715200501189, "entropy": 0.14661401025359594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 69.0, "episode_reward_min": -74.0, "episode_reward_mean": 6.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -160.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 40.0, "predator_policy": 80.0}, "policy_reward_mean": {"prey_policy": -1.425, "predator_policy": 4.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.0, 34.0, -2.0, 26.0, 3.0, 5.0, 24.0, -7.0, 8.0, -1.0, 13.0, 0.0, 22.0, 0.0, 0.0, 9.0, 20.0, 0.0, 4.0, -3.0, -29.0, 0.0, -7.0, 11.0, -4.0, 19.0, -7.0, 0.0, 3.0, 42.0, 0.0, 0.0, -7.0, -13.0, 0.0, 0.0, 17.0, 4.0, -6.0, 27.0, 0.0, 20.0, 19.0, 11.0, -7.0, 0.0, -4.0, 10.0, 23.0, 14.0, 0.0, 8.0, 17.0, 8.0, 69.0, 0.0, 0.0, 12.0, 11.0, 15.0, 4.0, 0.0, 1.0, 14.0, 17.0, 0.0, 50.0, -6.0, 11.0, -64.0, -4.0, 0.0, 38.0, -6.0, -1.0, -3.0, 0.0, 40.0, 11.0, 0.0, 43.0, 9.0, 1.0, 6.0, -9.0, -10.0, 0.0, 14.0, 27.0, -71.0, 21.0, 43.0, -17.0, 29.0, 69.0, 1.0, -2.0, -1.0, 3.0, -74.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, 0.0, -1.0, 18.0, -12.0, -8.0, -13.0, 10.0, 0.0, 3.0, 0.0, 5.0, 26.0, -9.0, -2.0, -24.0, 2.0, 0.0, 0.0, -3.0, 0.0, -21.0, 0.0, 0.0, -29.0, 19.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 16.0, -6.0, 0.0, 0.0, -4.0, -2.0, 0.0, -6.0, -58.0, 0.0, 0.0, 0.0, 0.0, -14.0, -6.0, 2.0, 0.0, -10.0, 19.0, 0.0, 1.0, -32.0, 0.0, 0.0, 1.0, -8.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 1.0, 0.0, -12.0, 27.0, 0.0, 0.0, 0.0, 13.0, -5.0, -12.0, 5.0, 4.0, 0.0, -6.0, -6.0, 0.0, 0.0, -20.0, -4.0, 3.0, 0.0, -3.0, 24.0, 0.0, 9.0, 0.0, 0.0, 4.0, -6.0, 3.0, 0.0, 7.0, 0.0, 31.0, 38.0, 0.0, 0.0, 0.0, 0.0, -4.0, 10.0, 4.0, 3.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, -29.0, 0.0, 14.0, 0.0, -11.0, 15.0, 0.0, 0.0, 36.0, 10.0, -16.0, 0.0, 9.0, 0.0, 16.0, -160.0, -2.0, -4.0, 0.0, 0.0, 29.0, 9.0, -2.0, -18.0, -2.0, -9.0, -2.0, -8.0, 0.0, 0.0, -8.0, 40.0, 0.0, -15.0, 0.0, 0.0, 11.0, 30.0, 0.0, 5.0, -4.0, 0.0, 0.0, -12.0, -22.0, -8.0, -20.0, 0.0, 0.0, 0.0, 0.0, 14.0, 33.0, -12.0, -142.0, 0.0, -6.0, 15.0, 28.0, 15.0, -12.0, -14.0, 4.0, 19.0, 33.0, 36.0, 1.0, 0.0, -4.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -148.0], "policy_predator_policy_reward": [2.0, 0.0, 4.0, 13.0, 6.0, 12.0, 15.0, 14.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 7.0, 12.0, 6.0, 0.0, 2.0, 0.0, 18.0, 16.0, 0.0, 0.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 3.0, 7.0, 0.0, 0.0, 9.0, 1.0, 0.0, 3.0, 0.0, 29.0, 0.0, 0.0, 7.0, 0.0, 3.0, 12.0, 0.0, 6.0, 0.0, 0.0, 16.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 8.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 16.0, 10.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 7.0, 0.0, 2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 11.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 8.0, 22.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 4.0, 9.0, 1.0, 0.0, 2.0, 0.0, 80.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 6.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 8.0, 0.0, 10.0, 16.0, 0.0, 0.0, 2.0, 0.0, 1.0, 3.0, 3.0, 2.0, 10.0, 8.0, 11.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 71.0, 0.0, 3.0, 9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 3.0, 74.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.162322559951953, "mean_inference_ms": 32.42190383697321, "mean_action_processing_ms": 1.9693178772251152, "mean_env_wait_ms": 1.8963408227952483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008877992630004883, "StateBufferConnector_ms": 0.006930828094482422, "ViewRequirementAgentConnector_ms": 0.33965373039245605}, "num_episodes": 18, "episode_return_max": 69.0, "episode_return_min": -74.0, "episode_return_mean": 6.13, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 251.35914523948807, "num_env_steps_trained_throughput_per_sec": 251.35914523948807, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 116689.264, "restore_workers_time_ms": 0.027, "training_step_time_ms": 116689.182, "sample_time_ms": 3749.772, "learn_time_ms": 112854.667, "learn_throughput": 35.444, "synch_weights_time_ms": 78.636}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 190, "trial_id": "4f45b_00000", "date": "2024-08-13_06-13-11", "timestamp": 1723543991, "time_this_iter_s": 15.953078031539917, "time_total_s": 16812.508497953415, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b291ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16812.508497953415, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 64.73181818181818, "ram_util_percent": 80.6590909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.021020867975143, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24488137626241913, "policy_loss": -0.000744709042985012, "vf_loss": 0.245626051736792, "vf_explained_var": 0.006931698921496275, "kl": 0.009301883884976846, "entropy": 0.6124950364783958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0407375604446445, "cur_kl_coeff": 1.440473716869672e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3192938494944462, "policy_loss": -0.002887844974076543, "vf_loss": 0.3221816949319666, "vf_explained_var": 0.03666376834193235, "kl": 0.002239112577910204, "entropy": 0.17176219211132437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "env_runners": {"episode_reward_max": 69.0, "episode_reward_min": -113.0, "episode_reward_mean": 4.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -226.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 40.0, "predator_policy": 113.0}, "policy_reward_mean": {"prey_policy": -3.05, "predator_policy": 5.11}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, -4.0, 19.0, -7.0, 0.0, 3.0, 42.0, 0.0, 0.0, -7.0, -13.0, 0.0, 0.0, 17.0, 4.0, -6.0, 27.0, 0.0, 20.0, 19.0, 11.0, -7.0, 0.0, -4.0, 10.0, 23.0, 14.0, 0.0, 8.0, 17.0, 8.0, 69.0, 0.0, 0.0, 12.0, 11.0, 15.0, 4.0, 0.0, 1.0, 14.0, 17.0, 0.0, 50.0, -6.0, 11.0, -64.0, -4.0, 0.0, 38.0, -6.0, -1.0, -3.0, 0.0, 40.0, 11.0, 0.0, 43.0, 9.0, 1.0, 6.0, -9.0, -10.0, 0.0, 14.0, 27.0, -71.0, 21.0, 43.0, -17.0, 29.0, 69.0, 1.0, -2.0, -1.0, 3.0, -74.0, 0.0, -2.0, 5.0, 18.0, 6.0, -19.0, 31.0, -7.0, 7.0, 2.0, 12.0, 18.0, 28.0, 11.0, -98.0, 0.0, 0.0, -7.0, 10.0, -2.0, -113.0, 5.0, 11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-6.0, 2.0, 0.0, -10.0, 19.0, 0.0, 1.0, -32.0, 0.0, 0.0, 1.0, -8.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -18.0, -26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 1.0, 0.0, -12.0, 27.0, 0.0, 0.0, 0.0, 13.0, -5.0, -12.0, 5.0, 4.0, 0.0, -6.0, -6.0, 0.0, 0.0, -20.0, -4.0, 3.0, 0.0, -3.0, 24.0, 0.0, 9.0, 0.0, 0.0, 4.0, -6.0, 3.0, 0.0, 7.0, 0.0, 31.0, 38.0, 0.0, 0.0, 0.0, 0.0, -4.0, 10.0, 4.0, 3.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, -29.0, 0.0, 14.0, 0.0, -11.0, 15.0, 0.0, 0.0, 36.0, 10.0, -16.0, 0.0, 9.0, 0.0, 16.0, -160.0, -2.0, -4.0, 0.0, 0.0, 29.0, 9.0, -2.0, -18.0, -2.0, -9.0, -2.0, -8.0, 0.0, 0.0, -8.0, 40.0, 0.0, -15.0, 0.0, 0.0, 11.0, 30.0, 0.0, 5.0, -4.0, 0.0, 0.0, -12.0, -22.0, -8.0, -20.0, 0.0, 0.0, 0.0, 0.0, 14.0, 33.0, -12.0, -142.0, 0.0, -6.0, 15.0, 28.0, 15.0, -12.0, -14.0, 4.0, 19.0, 33.0, 36.0, 1.0, 0.0, -4.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -148.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 18.0, -9.0, 2.0, -19.0, -20.0, 32.0, -2.0, -20.0, -13.0, 6.0, 0.0, 2.0, 0.0, 0.0, 4.0, -2.0, 14.0, 16.0, 12.0, 3.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -34.0, -8.0, 0.0, 10.0, -13.0, -1.0, 0.0, -226.0, 10.0, -10.0, 11.0, 0.0], "policy_predator_policy_reward": [3.0, 12.0, 0.0, 6.0, 0.0, 0.0, 16.0, 8.0, 0.0, 0.0, 6.0, 4.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 8.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 16.0, 10.0, 7.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 7.0, 0.0, 2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 11.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 8.0, 22.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 4.0, 9.0, 1.0, 0.0, 2.0, 0.0, 80.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 6.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 8.0, 0.0, 10.0, 16.0, 0.0, 0.0, 2.0, 0.0, 1.0, 3.0, 3.0, 2.0, 10.0, 8.0, 11.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 71.0, 0.0, 3.0, 9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 3.0, 74.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 13.0, 0.0, 7.0, 13.0, 0.0, 1.0, 11.0, 15.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 97.0, 3.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 0.0, 0.0, 6.0, 6.0, 113.0, 0.0, 5.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.366225758045458, "mean_inference_ms": 31.775168009227468, "mean_action_processing_ms": 2.070526027128412, "mean_env_wait_ms": 2.0015249014789145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008256316184997559, "StateBufferConnector_ms": 0.005750775337219238, "ViewRequirementAgentConnector_ms": 0.3219468593597412}, "num_episodes": 23, "episode_return_max": 69.0, "episode_return_min": -113.0, "episode_return_mean": 4.12, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.1951811919554, "num_env_steps_trained_throughput_per_sec": 306.1951811919554, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 3056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3056000, "timers": {"training_iteration_time_ms": 115735.859, "restore_workers_time_ms": 0.026, "training_step_time_ms": 115735.778, "sample_time_ms": 3546.822, "learn_time_ms": 112105.656, "learn_throughput": 35.681, "synch_weights_time_ms": 77.92}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "done": false, "training_iteration": 191, "trial_id": "4f45b_00000", "date": "2024-08-13_06-13-24", "timestamp": 1723544004, "time_this_iter_s": 13.102612018585205, "time_total_s": 16825.611109972, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b291cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16825.611109972, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 54.121052631578955, "ram_util_percent": 82.61578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3579677024767514, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2339378974425097, "policy_loss": -0.0017508078302458797, "vf_loss": 2.235688705734475, "vf_explained_var": 0.002596247606176548, "kl": 0.006312279297832497, "entropy": 0.5867975352775483, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6922104841817625, "cur_kl_coeff": 7.20236858434836e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7053484556851564, "policy_loss": -0.0030510444948006242, "vf_loss": 1.7083994973588872, "vf_explained_var": -0.23573261344874347, "kl": 0.006725992623442394, "entropy": 0.3149961100841956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "env_runners": {"episode_reward_max": 184.0, "episode_reward_min": -113.0, "episode_reward_mean": 6.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -226.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 172.0, "predator_policy": 113.0}, "policy_reward_mean": {"prey_policy": -4.315, "predator_policy": 7.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -4.0, 10.0, 23.0, 14.0, 0.0, 8.0, 17.0, 8.0, 69.0, 0.0, 0.0, 12.0, 11.0, 15.0, 4.0, 0.0, 1.0, 14.0, 17.0, 0.0, 50.0, -6.0, 11.0, -64.0, -4.0, 0.0, 38.0, -6.0, -1.0, -3.0, 0.0, 40.0, 11.0, 0.0, 43.0, 9.0, 1.0, 6.0, -9.0, -10.0, 0.0, 14.0, 27.0, -71.0, 21.0, 43.0, -17.0, 29.0, 69.0, 1.0, -2.0, -1.0, 3.0, -74.0, 0.0, -2.0, 5.0, 18.0, 6.0, -19.0, 31.0, -7.0, 7.0, 2.0, 12.0, 18.0, 28.0, 11.0, -98.0, 0.0, 0.0, -7.0, 10.0, -2.0, -113.0, 5.0, 11.0, 0.0, 0.0, 19.0, -64.0, 2.0, 17.0, 0.0, 0.0, 9.0, 6.0, -4.0, 20.0, 10.0, 0.0, 21.0, 36.0, 0.0, 184.0, 23.0, 0.0, 30.0, 11.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 0.0, -20.0, -4.0, 3.0, 0.0, -3.0, 24.0, 0.0, 9.0, 0.0, 0.0, 4.0, -6.0, 3.0, 0.0, 7.0, 0.0, 31.0, 38.0, 0.0, 0.0, 0.0, 0.0, -4.0, 10.0, 4.0, 3.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, -29.0, 0.0, 14.0, 0.0, -11.0, 15.0, 0.0, 0.0, 36.0, 10.0, -16.0, 0.0, 9.0, 0.0, 16.0, -160.0, -2.0, -4.0, 0.0, 0.0, 29.0, 9.0, -2.0, -18.0, -2.0, -9.0, -2.0, -8.0, 0.0, 0.0, -8.0, 40.0, 0.0, -15.0, 0.0, 0.0, 11.0, 30.0, 0.0, 5.0, -4.0, 0.0, 0.0, -12.0, -22.0, -8.0, -20.0, 0.0, 0.0, 0.0, 0.0, 14.0, 33.0, -12.0, -142.0, 0.0, -6.0, 15.0, 28.0, 15.0, -12.0, -14.0, 4.0, 19.0, 33.0, 36.0, 1.0, 0.0, -4.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -148.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 18.0, -9.0, 2.0, -19.0, -20.0, 32.0, -2.0, -20.0, -13.0, 6.0, 0.0, 2.0, 0.0, 0.0, 4.0, -2.0, 14.0, 16.0, 12.0, 3.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -34.0, -8.0, 0.0, 10.0, -13.0, -1.0, 0.0, -226.0, 10.0, -10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, -128.0, 0.0, -20.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 6.0, -20.0, 0.0, -112.0, -2.0, 0.0, 7.0, 0.0, 0.0, -97.0, 13.0, -36.0, 11.0, 0.0, 0.0, 12.0, 172.0, 12.0, 11.0, 0.0, 0.0, 3.0, -82.0, -18.0, -41.0], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 10.0, 0.0, 7.0, 0.0, 2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 10.0, 11.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 0.0, 4.0, 0.0, 4.0, 0.0, 0.0, 8.0, 22.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 4.0, 9.0, 1.0, 0.0, 2.0, 0.0, 80.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 6.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 8.0, 0.0, 10.0, 16.0, 0.0, 0.0, 2.0, 0.0, 1.0, 3.0, 3.0, 2.0, 10.0, 8.0, 11.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 71.0, 0.0, 3.0, 9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 3.0, 74.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 13.0, 0.0, 7.0, 13.0, 0.0, 1.0, 11.0, 15.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 97.0, 3.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 0.0, 0.0, 6.0, 6.0, 113.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 64.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 72.0, 62.0, 0.0, 3.0, 0.0, 0.0, 21.0, 84.0, 0.0, 61.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 62.0, 47.0, 50.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.040307432090144, "mean_inference_ms": 32.096398638481745, "mean_action_processing_ms": 1.9541593304223108, "mean_env_wait_ms": 1.8808223039660328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009251236915588379, "StateBufferConnector_ms": 0.00602877140045166, "ViewRequirementAgentConnector_ms": 0.3002549409866333}, "num_episodes": 22, "episode_return_max": 184.0, "episode_return_min": -113.0, "episode_return_mean": 6.03, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.0251038167556, "num_env_steps_trained_throughput_per_sec": 311.0251038167556, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 3072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3072000, "timers": {"training_iteration_time_ms": 114862.397, "restore_workers_time_ms": 0.026, "training_step_time_ms": 114862.32, "sample_time_ms": 3386.501, "learn_time_ms": 111394.013, "learn_throughput": 35.909, "synch_weights_time_ms": 76.671}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "done": false, "training_iteration": 192, "trial_id": "4f45b_00000", "date": "2024-08-13_06-13-37", "timestamp": 1723544017, "time_this_iter_s": 12.91616678237915, "time_total_s": 16838.52727675438, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b291c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16838.52727675438, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 56.88333333333333, "ram_util_percent": 83.23888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.306361193489776, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2682423299582546, "policy_loss": -0.00135772823449717, "vf_loss": 1.269600058500729, "vf_explained_var": 0.002676864433540869, "kl": 0.006243086909627636, "entropy": 0.5913191190787724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9850569097137956, "cur_kl_coeff": 7.20236858434836e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8685555145834332, "policy_loss": -0.0064045009900515195, "vf_loss": 0.8749600169441056, "vf_explained_var": -0.3429400051712359, "kl": 0.0039512705721727786, "entropy": 0.24203677339055552, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "env_runners": {"episode_reward_max": 184.0, "episode_reward_min": -113.0, "episode_reward_mean": 4.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -342.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 172.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": -8.215, "predator_policy": 10.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.0, 17.0, 0.0, 50.0, -6.0, 11.0, -64.0, -4.0, 0.0, 38.0, -6.0, -1.0, -3.0, 0.0, 40.0, 11.0, 0.0, 43.0, 9.0, 1.0, 6.0, -9.0, -10.0, 0.0, 14.0, 27.0, -71.0, 21.0, 43.0, -17.0, 29.0, 69.0, 1.0, -2.0, -1.0, 3.0, -74.0, 0.0, -2.0, 5.0, 18.0, 6.0, -19.0, 31.0, -7.0, 7.0, 2.0, 12.0, 18.0, 28.0, 11.0, -98.0, 0.0, 0.0, -7.0, 10.0, -2.0, -113.0, 5.0, 11.0, 0.0, 0.0, 19.0, -64.0, 2.0, 17.0, 0.0, 0.0, 9.0, 6.0, -4.0, 20.0, 10.0, 0.0, 21.0, 36.0, 0.0, 184.0, 23.0, 0.0, 30.0, 11.0, -13.0, 4.0, 43.0, 0.0, 10.0, 0.0, 6.0, 5.0, 14.0, 1.0, 12.0, 3.0, 0.0, -5.0, 1.0, 22.0, -100.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [14.0, 0.0, -11.0, 15.0, 0.0, 0.0, 36.0, 10.0, -16.0, 0.0, 9.0, 0.0, 16.0, -160.0, -2.0, -4.0, 0.0, 0.0, 29.0, 9.0, -2.0, -18.0, -2.0, -9.0, -2.0, -8.0, 0.0, 0.0, -8.0, 40.0, 0.0, -15.0, 0.0, 0.0, 11.0, 30.0, 0.0, 5.0, -4.0, 0.0, 0.0, -12.0, -22.0, -8.0, -20.0, 0.0, 0.0, 0.0, 0.0, 14.0, 33.0, -12.0, -142.0, 0.0, -6.0, 15.0, 28.0, 15.0, -12.0, -14.0, 4.0, 19.0, 33.0, 36.0, 1.0, 0.0, -4.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -148.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 18.0, -9.0, 2.0, -19.0, -20.0, 32.0, -2.0, -20.0, -13.0, 6.0, 0.0, 2.0, 0.0, 0.0, 4.0, -2.0, 14.0, 16.0, 12.0, 3.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -34.0, -8.0, 0.0, 10.0, -13.0, -1.0, 0.0, -226.0, 10.0, -10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, -128.0, 0.0, -20.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 6.0, -20.0, 0.0, -112.0, -2.0, 0.0, 7.0, 0.0, 0.0, -97.0, 13.0, -36.0, 11.0, 0.0, 0.0, 12.0, 172.0, 12.0, 11.0, 0.0, 0.0, 3.0, -82.0, -18.0, -41.0, -342.0, 12.0, 4.0, 0.0, 9.0, -78.0, 0.0, 0.0, -12.0, 4.0, 0.0, 0.0, 4.0, 0.0, 2.0, -5.0, 3.0, 0.0, 0.0, -9.0, -7.0, 0.0, -16.0, 7.0, 0.0, 0.0, -10.0, 0.0, -11.0, -11.0, 14.0, -5.0, -239.0, -8.0, -8.0, 3.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 4.0, 9.0, 1.0, 0.0, 2.0, 0.0, 80.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 6.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 8.0, 0.0, 10.0, 16.0, 0.0, 0.0, 2.0, 0.0, 1.0, 3.0, 3.0, 2.0, 10.0, 8.0, 11.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 71.0, 0.0, 3.0, 9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 3.0, 74.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 13.0, 0.0, 7.0, 13.0, 0.0, 1.0, 11.0, 15.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 97.0, 3.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 0.0, 0.0, 6.0, 6.0, 113.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 64.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 72.0, 62.0, 0.0, 3.0, 0.0, 0.0, 21.0, 84.0, 0.0, 61.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 62.0, 47.0, 50.0, 20.0, 177.0, 140.0, 0.0, 0.0, 64.0, 48.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 7.0, 5.0, 6.0, 0.0, 10.0, 7.0, 12.0, 4.0, 8.0, 0.0, 0.0, 5.0, 0.0, 13.0, 10.0, 3.0, 10.0, 143.0, 4.0, 9.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.989659178639672, "mean_inference_ms": 31.96186025110779, "mean_action_processing_ms": 1.947348068373957, "mean_env_wait_ms": 1.874017667887148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009373068809509277, "StateBufferConnector_ms": 0.005617022514343262, "ViewRequirementAgentConnector_ms": 0.2782968282699585}, "num_episodes": 18, "episode_return_max": 184.0, "episode_return_min": -113.0, "episode_return_mean": 4.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.8357765898784, "num_env_steps_trained_throughput_per_sec": 321.8357765898784, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 3088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3088000, "timers": {"training_iteration_time_ms": 113949.685, "restore_workers_time_ms": 0.026, "training_step_time_ms": 113949.608, "sample_time_ms": 3215.756, "learn_time_ms": 110651.483, "learn_throughput": 36.15, "synch_weights_time_ms": 77.111}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "done": false, "training_iteration": 193, "trial_id": "4f45b_00000", "date": "2024-08-13_06-13-49", "timestamp": 1723544029, "time_this_iter_s": 12.451036930084229, "time_total_s": 16850.978313684464, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b27c0940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16850.978313684464, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 55.74999999999999, "ram_util_percent": 82.73333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.000138929612422, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8768973436620501, "policy_loss": -0.0024693734201026107, "vf_loss": 0.8793666512562485, "vf_explained_var": 0.0022225343361102715, "kl": 0.01747443018846863, "entropy": 0.5522527279204161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.430813177978551, "cur_kl_coeff": 3.60118429217418e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.876109537256576, "policy_loss": -0.0011905984541588518, "vf_loss": 0.8773001328347221, "vf_explained_var": -0.013921717424241323, "kl": 0.0014411647961880575, "entropy": 0.21653118726437684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "env_runners": {"episode_reward_max": 184.0, "episode_reward_min": -163.0, "episode_reward_mean": 2.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -342.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 172.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": -11.335, "predator_policy": 12.445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.0, 1.0, 6.0, -9.0, -10.0, 0.0, 14.0, 27.0, -71.0, 21.0, 43.0, -17.0, 29.0, 69.0, 1.0, -2.0, -1.0, 3.0, -74.0, 0.0, -2.0, 5.0, 18.0, 6.0, -19.0, 31.0, -7.0, 7.0, 2.0, 12.0, 18.0, 28.0, 11.0, -98.0, 0.0, 0.0, -7.0, 10.0, -2.0, -113.0, 5.0, 11.0, 0.0, 0.0, 19.0, -64.0, 2.0, 17.0, 0.0, 0.0, 9.0, 6.0, -4.0, 20.0, 10.0, 0.0, 21.0, 36.0, 0.0, 184.0, 23.0, 0.0, 30.0, 11.0, -13.0, 4.0, 43.0, 0.0, 10.0, 0.0, 6.0, 5.0, 14.0, 1.0, 12.0, 3.0, 0.0, -5.0, 1.0, 22.0, -100.0, 4.0, -9.0, 0.0, 3.0, 9.0, 11.0, -6.0, 9.0, 19.0, 5.0, -163.0, 0.0, 4.0, 12.0, 33.0, 5.0, -1.0, 10.0, -1.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, 5.0, -4.0, 0.0, 0.0, -12.0, -22.0, -8.0, -20.0, 0.0, 0.0, 0.0, 0.0, 14.0, 33.0, -12.0, -142.0, 0.0, -6.0, 15.0, 28.0, 15.0, -12.0, -14.0, 4.0, 19.0, 33.0, 36.0, 1.0, 0.0, -4.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -148.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 18.0, -9.0, 2.0, -19.0, -20.0, 32.0, -2.0, -20.0, -13.0, 6.0, 0.0, 2.0, 0.0, 0.0, 4.0, -2.0, 14.0, 16.0, 12.0, 3.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -34.0, -8.0, 0.0, 10.0, -13.0, -1.0, 0.0, -226.0, 10.0, -10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, -128.0, 0.0, -20.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 6.0, -20.0, 0.0, -112.0, -2.0, 0.0, 7.0, 0.0, 0.0, -97.0, 13.0, -36.0, 11.0, 0.0, 0.0, 12.0, 172.0, 12.0, 11.0, 0.0, 0.0, 3.0, -82.0, -18.0, -41.0, -342.0, 12.0, 4.0, 0.0, 9.0, -78.0, 0.0, 0.0, -12.0, 4.0, 0.0, 0.0, 4.0, 0.0, 2.0, -5.0, 3.0, 0.0, 0.0, -9.0, -7.0, 0.0, -16.0, 7.0, 0.0, 0.0, -10.0, 0.0, -11.0, -11.0, 14.0, -5.0, -239.0, -8.0, -8.0, 3.0, -18.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, -2.0, 3.0, 0.0, -4.0, -16.0, 13.0, -173.0, 6.0, 11.0, 1.0, -205.0, -80.0, -178.0, 0.0, 0.0, 0.0, -1.0, 9.0, 0.0, -1.0, 16.0, 0.0, 5.0, 0.0, -2.0, -36.0, 0.0, -4.0, -14.0], "policy_predator_policy_reward": [1.0, 3.0, 3.0, 2.0, 10.0, 8.0, 11.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 71.0, 0.0, 3.0, 9.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 0.0, 0.0, 3.0, 74.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 13.0, 0.0, 7.0, 13.0, 0.0, 1.0, 11.0, 15.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 97.0, 3.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 0.0, 0.0, 6.0, 6.0, 113.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 64.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 72.0, 62.0, 0.0, 3.0, 0.0, 0.0, 21.0, 84.0, 0.0, 61.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 62.0, 47.0, 50.0, 20.0, 177.0, 140.0, 0.0, 0.0, 64.0, 48.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 7.0, 5.0, 6.0, 0.0, 10.0, 7.0, 12.0, 4.0, 8.0, 0.0, 0.0, 5.0, 0.0, 13.0, 10.0, 3.0, 10.0, 143.0, 4.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 2.0, 6.0, 14.0, 0.0, 75.0, 94.0, 2.0, 0.0, 95.0, 114.0, 95.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 3.0, 7.0, 11.0, 0.0, 0.0, 0.0, 1.0, 27.0, 19.0, 9.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.937372080412588, "mean_inference_ms": 31.82453380628138, "mean_action_processing_ms": 1.940004363246418, "mean_env_wait_ms": 1.8667771386858139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006619811058044434, "StateBufferConnector_ms": 0.004443645477294922, "ViewRequirementAgentConnector_ms": 0.18417072296142578}, "num_episodes": 18, "episode_return_max": 184.0, "episode_return_min": -163.0, "episode_return_mean": 2.22, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.004147492196, "num_env_steps_trained_throughput_per_sec": 298.004147492196, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 3104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3104000, "timers": {"training_iteration_time_ms": 113054.351, "restore_workers_time_ms": 0.027, "training_step_time_ms": 113054.276, "sample_time_ms": 3067.742, "learn_time_ms": 109904.597, "learn_throughput": 36.395, "synch_weights_time_ms": 76.974}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "done": false, "training_iteration": 194, "trial_id": "4f45b_00000", "date": "2024-08-13_06-14-03", "timestamp": 1723544043, "time_this_iter_s": 13.464647054672241, "time_total_s": 16864.442960739136, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b291f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16864.442960739136, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 56.784210526315796, "ram_util_percent": 83.49999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2240184618564194, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3643162732559537, "policy_loss": -0.002310868581786515, "vf_loss": 0.36662709268488153, "vf_explained_var": 0.021169378549333602, "kl": 0.0132362904790873, "entropy": 0.5757218063981445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.831810540319593, "cur_kl_coeff": 1.80059214608709e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48555747255727294, "policy_loss": -0.0006882231660364639, "vf_loss": 0.48624569518718297, "vf_explained_var": 0.3052806658088846, "kl": 0.001909859227791141, "entropy": 0.16890523165622084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 184.0, "episode_reward_min": -163.0, "episode_reward_mean": 1.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -342.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 172.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": -12.96, "predator_policy": 13.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-74.0, 0.0, -2.0, 5.0, 18.0, 6.0, -19.0, 31.0, -7.0, 7.0, 2.0, 12.0, 18.0, 28.0, 11.0, -98.0, 0.0, 0.0, -7.0, 10.0, -2.0, -113.0, 5.0, 11.0, 0.0, 0.0, 19.0, -64.0, 2.0, 17.0, 0.0, 0.0, 9.0, 6.0, -4.0, 20.0, 10.0, 0.0, 21.0, 36.0, 0.0, 184.0, 23.0, 0.0, 30.0, 11.0, -13.0, 4.0, 43.0, 0.0, 10.0, 0.0, 6.0, 5.0, 14.0, 1.0, 12.0, 3.0, 0.0, -5.0, 1.0, 22.0, -100.0, 4.0, -9.0, 0.0, 3.0, 9.0, 11.0, -6.0, 9.0, 19.0, 5.0, -163.0, 0.0, 4.0, 12.0, 33.0, 5.0, -1.0, 10.0, -1.0, 0.0, 48.0, -12.0, 35.0, -70.0, 19.0, -41.0, 0.0, -10.0, -2.0, 21.0, -11.0, 10.0, 19.0, 22.0, 0.0, 0.0, -3.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -148.0, 0.0, 0.0, 0.0, -4.0, 0.0, 0.0, 0.0, 18.0, -9.0, 2.0, -19.0, -20.0, 32.0, -2.0, -20.0, -13.0, 6.0, 0.0, 2.0, 0.0, 0.0, 4.0, -2.0, 14.0, 16.0, 12.0, 3.0, 0.0, 0.0, -198.0, 0.0, 0.0, 0.0, 0.0, -34.0, -8.0, 0.0, 10.0, -13.0, -1.0, 0.0, -226.0, 10.0, -10.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, -128.0, 0.0, -20.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 6.0, -20.0, 0.0, -112.0, -2.0, 0.0, 7.0, 0.0, 0.0, -97.0, 13.0, -36.0, 11.0, 0.0, 0.0, 12.0, 172.0, 12.0, 11.0, 0.0, 0.0, 3.0, -82.0, -18.0, -41.0, -342.0, 12.0, 4.0, 0.0, 9.0, -78.0, 0.0, 0.0, -12.0, 4.0, 0.0, 0.0, 4.0, 0.0, 2.0, -5.0, 3.0, 0.0, 0.0, -9.0, -7.0, 0.0, -16.0, 7.0, 0.0, 0.0, -10.0, 0.0, -11.0, -11.0, 14.0, -5.0, -239.0, -8.0, -8.0, 3.0, -18.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, -2.0, 3.0, 0.0, -4.0, -16.0, 13.0, -173.0, 6.0, 11.0, 1.0, -205.0, -80.0, -178.0, 0.0, 0.0, 0.0, -1.0, 9.0, 0.0, -1.0, 16.0, 0.0, 5.0, 0.0, -2.0, -36.0, 0.0, -4.0, -14.0, 0.0, 0.0, 29.0, 19.0, -8.0, -16.0, 0.0, 35.0, -132.0, -8.0, 3.0, 16.0, -242.0, 11.0, -6.0, 0.0, -16.0, -16.0, -4.0, 0.0, 6.0, 7.0, -92.0, 35.0, -18.0, 0.0, 2.0, 6.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0], "policy_predator_policy_reward": [74.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 0.0, 0.0, 0.0, 13.0, 0.0, 7.0, 13.0, 0.0, 1.0, 11.0, 15.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 8.0, 97.0, 3.0, 0.0, 0.0, 0.0, 0.0, 21.0, 14.0, 0.0, 0.0, 6.0, 6.0, 113.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 64.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 72.0, 62.0, 0.0, 3.0, 0.0, 0.0, 21.0, 84.0, 0.0, 61.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 62.0, 47.0, 50.0, 20.0, 177.0, 140.0, 0.0, 0.0, 64.0, 48.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 7.0, 5.0, 6.0, 0.0, 10.0, 7.0, 12.0, 4.0, 8.0, 0.0, 0.0, 5.0, 0.0, 13.0, 10.0, 3.0, 10.0, 143.0, 4.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 2.0, 6.0, 14.0, 0.0, 75.0, 94.0, 2.0, 0.0, 95.0, 114.0, 95.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 3.0, 7.0, 11.0, 0.0, 0.0, 0.0, 1.0, 27.0, 19.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 70.0, 0.0, 0.0, 0.0, 119.0, 71.0, 0.0, 6.0, 11.0, 11.0, 0.0, 2.0, 0.0, 8.0, 0.0, 46.0, 13.0, 15.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.884714472229184, "mean_inference_ms": 31.685627378260055, "mean_action_processing_ms": 1.9322773917873826, "mean_env_wait_ms": 1.8592498409452514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006360530853271484, "StateBufferConnector_ms": 0.004387497901916504, "ViewRequirementAgentConnector_ms": 0.13817048072814941}, "num_episodes": 18, "episode_return_max": 184.0, "episode_return_min": -163.0, "episode_return_mean": 1.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.0619603134702, "num_env_steps_trained_throughput_per_sec": 317.0619603134702, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 112088.659, "restore_workers_time_ms": 0.026, "training_step_time_ms": 112088.585, "sample_time_ms": 2869.123, "learn_time_ms": 109138.161, "learn_throughput": 36.651, "synch_weights_time_ms": 76.378}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 195, "trial_id": "4f45b_00000", "date": "2024-08-13_06-14-15", "timestamp": 1723544055, "time_this_iter_s": 12.666935920715332, "time_total_s": 16877.10989665985, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b291f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16877.10989665985, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 50.69999999999999, "ram_util_percent": 83.55555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0084471342740238, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.536380683894826, "policy_loss": -0.0010178526900413017, "vf_loss": 0.5373985131325387, "vf_explained_var": 0.02999675882556451, "kl": 0.007535934909933701, "entropy": 0.5812908425690636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0851505890606887, "cur_kl_coeff": 9.00296073043545e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6402843705343979, "policy_loss": -0.004446299735545402, "vf_loss": 0.6447306689840776, "vf_explained_var": 0.07163135806719462, "kl": 0.0037153302381863758, "entropy": 0.21722605080989302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "env_runners": {"episode_reward_max": 184.0, "episode_reward_min": -163.0, "episode_reward_mean": 4.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -342.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 172.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": -10.875, "predator_policy": 13.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.0, 2.0, 17.0, 0.0, 0.0, 9.0, 6.0, -4.0, 20.0, 10.0, 0.0, 21.0, 36.0, 0.0, 184.0, 23.0, 0.0, 30.0, 11.0, -13.0, 4.0, 43.0, 0.0, 10.0, 0.0, 6.0, 5.0, 14.0, 1.0, 12.0, 3.0, 0.0, -5.0, 1.0, 22.0, -100.0, 4.0, -9.0, 0.0, 3.0, 9.0, 11.0, -6.0, 9.0, 19.0, 5.0, -163.0, 0.0, 4.0, 12.0, 33.0, 5.0, -1.0, 10.0, -1.0, 0.0, 48.0, -12.0, 35.0, -70.0, 19.0, -41.0, 0.0, -10.0, -2.0, 21.0, -11.0, 10.0, 19.0, 22.0, 0.0, 0.0, -3.0, 0.0, 25.0, -10.0, 4.0, 0.0, -1.0, 3.0, 22.0, 3.0, 20.0, 3.0, 11.0, 5.0, 9.0, 8.0, 0.0, 0.0, 17.0, 23.0, 30.0, 26.0, 8.0, -64.0, -4.0, 13.0, 20.0, 12.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [0.0, -128.0, 0.0, -20.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 6.0, -20.0, 0.0, -112.0, -2.0, 0.0, 7.0, 0.0, 0.0, -97.0, 13.0, -36.0, 11.0, 0.0, 0.0, 12.0, 172.0, 12.0, 11.0, 0.0, 0.0, 3.0, -82.0, -18.0, -41.0, -342.0, 12.0, 4.0, 0.0, 9.0, -78.0, 0.0, 0.0, -12.0, 4.0, 0.0, 0.0, 4.0, 0.0, 2.0, -5.0, 3.0, 0.0, 0.0, -9.0, -7.0, 0.0, -16.0, 7.0, 0.0, 0.0, -10.0, 0.0, -11.0, -11.0, 14.0, -5.0, -239.0, -8.0, -8.0, 3.0, -18.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, -2.0, 3.0, 0.0, -4.0, -16.0, 13.0, -173.0, 6.0, 11.0, 1.0, -205.0, -80.0, -178.0, 0.0, 0.0, 0.0, -1.0, 9.0, 0.0, -1.0, 16.0, 0.0, 5.0, 0.0, -2.0, -36.0, 0.0, -4.0, -14.0, 0.0, 0.0, 29.0, 19.0, -8.0, -16.0, 0.0, 35.0, -132.0, -8.0, 3.0, 16.0, -242.0, 11.0, -6.0, 0.0, -16.0, -16.0, -4.0, 0.0, 6.0, 7.0, -92.0, 35.0, -18.0, 0.0, 2.0, 6.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, -3.0, -6.0, 28.0, -13.0, -20.0, 0.0, -4.0, 6.0, 0.0, 0.0, 0.0, -8.0, -27.0, 0.0, -1.0, -7.0, 16.0, -26.0, 25.0, -18.0, 0.0, 3.0, -4.0, 13.0, 0.0, -22.0, 9.0, 0.0, -6.0, 5.0, 0.0, 0.0, 0.0, 0.0, -4.0, 19.0, 23.0, -17.0, 0.0, 30.0, -1.0, 11.0, 3.0, -3.0, -12.0, -136.0, -24.0, -3.0, 0.0, 13.0, -8.0, 23.0, -5.0, 0.0], "policy_predator_policy_reward": [64.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 10.0, 72.0, 62.0, 0.0, 3.0, 0.0, 0.0, 21.0, 84.0, 0.0, 61.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 62.0, 47.0, 50.0, 20.0, 177.0, 140.0, 0.0, 0.0, 64.0, 48.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 7.0, 5.0, 6.0, 0.0, 10.0, 7.0, 12.0, 4.0, 8.0, 0.0, 0.0, 5.0, 0.0, 13.0, 10.0, 3.0, 10.0, 143.0, 4.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 2.0, 6.0, 14.0, 0.0, 75.0, 94.0, 2.0, 0.0, 95.0, 114.0, 95.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 3.0, 7.0, 11.0, 0.0, 0.0, 0.0, 1.0, 27.0, 19.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 70.0, 0.0, 0.0, 0.0, 119.0, 71.0, 0.0, 6.0, 11.0, 11.0, 0.0, 2.0, 0.0, 8.0, 0.0, 46.0, 13.0, 15.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 3.0, 5.0, 5.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 4.0, 11.0, 19.0, 17.0, 13.0, 13.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 2.0, 16.0, 11.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 7.0, 0.0, 0.0, 7.0, 9.0, 0.0, 8.0, 16.0, 68.0, 18.0, 5.0, 0.0, 0.0, 4.0, 1.0, 3.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 12.052032178291887, "mean_inference_ms": 31.235548283550642, "mean_action_processing_ms": 1.9197534404757173, "mean_env_wait_ms": 1.8479134299690938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00563657283782959, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.12820672988891602}, "num_episodes": 27, "episode_return_max": 184.0, "episode_return_min": -163.0, "episode_return_mean": 4.56, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.58685804983884, "num_env_steps_trained_throughput_per_sec": 325.58685804983884, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 3136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3136000, "timers": {"training_iteration_time_ms": 111188.648, "restore_workers_time_ms": 0.026, "training_step_time_ms": 111188.575, "sample_time_ms": 2715.741, "learn_time_ms": 108392.291, "learn_throughput": 36.903, "synch_weights_time_ms": 76.083}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "done": false, "training_iteration": 196, "trial_id": "4f45b_00000", "date": "2024-08-13_06-14-28", "timestamp": 1723544068, "time_this_iter_s": 12.329808950424194, "time_total_s": 16889.439705610275, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2783c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16889.439705610275, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 50.57647058823529, "ram_util_percent": 83.5529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1829268166667255, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6226373620134182, "policy_loss": -0.0020415540652783224, "vf_loss": 0.6246789016381458, "vf_explained_var": 0.006826262278531594, "kl": 0.006151249803817745, "entropy": 0.578876983252152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2157192025471617, "cur_kl_coeff": 4.501480365217725e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7392432618610285, "policy_loss": -0.0018031015223453914, "vf_loss": 0.7410463634050555, "vf_explained_var": 0.022833590911178994, "kl": 0.00225397475522253, "entropy": 0.2428320031711664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "env_runners": {"episode_reward_max": 48.0, "episode_reward_min": -163.0, "episode_reward_mean": 1.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -342.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 41.0, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": -11.79, "predator_policy": 12.51}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11.0, -13.0, 4.0, 43.0, 0.0, 10.0, 0.0, 6.0, 5.0, 14.0, 1.0, 12.0, 3.0, 0.0, -5.0, 1.0, 22.0, -100.0, 4.0, -9.0, 0.0, 3.0, 9.0, 11.0, -6.0, 9.0, 19.0, 5.0, -163.0, 0.0, 4.0, 12.0, 33.0, 5.0, -1.0, 10.0, -1.0, 0.0, 48.0, -12.0, 35.0, -70.0, 19.0, -41.0, 0.0, -10.0, -2.0, 21.0, -11.0, 10.0, 19.0, 22.0, 0.0, 0.0, -3.0, 0.0, 25.0, -10.0, 4.0, 0.0, -1.0, 3.0, 22.0, 3.0, 20.0, 3.0, 11.0, 5.0, 9.0, 8.0, 0.0, 0.0, 17.0, 23.0, 30.0, 26.0, 8.0, -64.0, -4.0, 13.0, 20.0, 12.0, 15.0, 18.0, 15.0, 42.0, -33.0, 26.0, 0.0, -39.0, 0.0, 12.0, -97.0, -23.0, -3.0, 40.0, 10.0, -5.0, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-18.0, -41.0, -342.0, 12.0, 4.0, 0.0, 9.0, -78.0, 0.0, 0.0, -12.0, 4.0, 0.0, 0.0, 4.0, 0.0, 2.0, -5.0, 3.0, 0.0, 0.0, -9.0, -7.0, 0.0, -16.0, 7.0, 0.0, 0.0, -10.0, 0.0, -11.0, -11.0, 14.0, -5.0, -239.0, -8.0, -8.0, 3.0, -18.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, -2.0, 3.0, 0.0, -4.0, -16.0, 13.0, -173.0, 6.0, 11.0, 1.0, -205.0, -80.0, -178.0, 0.0, 0.0, 0.0, -1.0, 9.0, 0.0, -1.0, 16.0, 0.0, 5.0, 0.0, -2.0, -36.0, 0.0, -4.0, -14.0, 0.0, 0.0, 29.0, 19.0, -8.0, -16.0, 0.0, 35.0, -132.0, -8.0, 3.0, 16.0, -242.0, 11.0, -6.0, 0.0, -16.0, -16.0, -4.0, 0.0, 6.0, 7.0, -92.0, 35.0, -18.0, 0.0, 2.0, 6.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, -3.0, -6.0, 28.0, -13.0, -20.0, 0.0, -4.0, 6.0, 0.0, 0.0, 0.0, -8.0, -27.0, 0.0, -1.0, -7.0, 16.0, -26.0, 25.0, -18.0, 0.0, 3.0, -4.0, 13.0, 0.0, -22.0, 9.0, 0.0, -6.0, 5.0, 0.0, 0.0, 0.0, 0.0, -4.0, 19.0, 23.0, -17.0, 0.0, 30.0, -1.0, 11.0, 3.0, -3.0, -12.0, -136.0, -24.0, -3.0, 0.0, 13.0, -8.0, 23.0, -5.0, 0.0, -5.0, 0.0, -1.0, -11.0, 15.0, 0.0, 41.0, -9.0, 0.0, -66.0, 8.0, 0.0, 0.0, 0.0, 0.0, -78.0, -10.0, -16.0, 12.0, 0.0, -208.0, 7.0, 1.0, -76.0, 0.0, -6.0, 24.0, 0.0, -2.0, -3.0, 14.0, -38.0, 0.0, 0.0, 0.0, 0.0], "policy_predator_policy_reward": [50.0, 20.0, 177.0, 140.0, 0.0, 0.0, 64.0, 48.0, 0.0, 0.0, 18.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 7.0, 5.0, 6.0, 0.0, 10.0, 7.0, 12.0, 4.0, 8.0, 0.0, 0.0, 5.0, 0.0, 13.0, 10.0, 3.0, 10.0, 143.0, 4.0, 9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 2.0, 6.0, 14.0, 0.0, 75.0, 94.0, 2.0, 0.0, 95.0, 114.0, 95.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 3.0, 7.0, 11.0, 0.0, 0.0, 0.0, 1.0, 27.0, 19.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 70.0, 0.0, 0.0, 0.0, 119.0, 71.0, 0.0, 6.0, 11.0, 11.0, 0.0, 2.0, 0.0, 8.0, 0.0, 46.0, 13.0, 15.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 3.0, 5.0, 5.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 4.0, 11.0, 19.0, 17.0, 13.0, 13.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 2.0, 16.0, 11.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 7.0, 0.0, 0.0, 7.0, 9.0, 0.0, 8.0, 16.0, 68.0, 18.0, 5.0, 0.0, 0.0, 4.0, 1.0, 3.0, 14.0, 9.0, 11.0, 4.0, 26.0, 0.0, 0.0, 0.0, 10.0, 33.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 39.0, 11.0, 15.0, 0.0, 0.0, 104.0, 0.0, 0.0, 52.0, 3.0, 0.0, 16.0, 0.0, 15.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.757057430369755, "mean_inference_ms": 31.350492012223054, "mean_action_processing_ms": 1.913186954774735, "mean_env_wait_ms": 1.8407828387538685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00518345832824707, "StateBufferConnector_ms": 0.01596546173095703, "ViewRequirementAgentConnector_ms": 0.14802145957946777}, "num_episodes": 18, "episode_return_max": 48.0, "episode_return_min": -163.0, "episode_return_mean": 1.44, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.4493386922359, "num_env_steps_trained_throughput_per_sec": 301.4493386922359, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 3152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3152000, "timers": {"training_iteration_time_ms": 110345.447, "restore_workers_time_ms": 0.025, "training_step_time_ms": 110345.375, "sample_time_ms": 2597.492, "learn_time_ms": 107667.663, "learn_throughput": 37.151, "synch_weights_time_ms": 75.549}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "done": false, "training_iteration": 197, "trial_id": "4f45b_00000", "date": "2024-08-13_06-14-41", "timestamp": 1723544081, "time_this_iter_s": 13.318034887313843, "time_total_s": 16902.75774049759, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b291ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16902.75774049759, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 52.02631578947369, "ram_util_percent": 83.54736842105262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7887919343042152, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13370115918867417, "policy_loss": -0.0014960501163153264, "vf_loss": 0.13519716356755002, "vf_explained_var": -0.05215792072513116, "kl": 0.012443475501018588, "entropy": 0.5734097567342576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9096592641065993, "cur_kl_coeff": 2.2507401826088625e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23494659866222978, "policy_loss": -0.0035468227311472346, "vf_loss": 0.23849342120139952, "vf_explained_var": 0.611692787225915, "kl": 0.002662006511201411, "entropy": 0.24632037643875396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "env_runners": {"episode_reward_max": 53.0, "episode_reward_min": -163.0, "episode_reward_mean": 4.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -242.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 41.0, "predator_policy": 119.0}, "policy_reward_mean": {"prey_policy": -6.985, "predator_policy": 9.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, -9.0, 0.0, 3.0, 9.0, 11.0, -6.0, 9.0, 19.0, 5.0, -163.0, 0.0, 4.0, 12.0, 33.0, 5.0, -1.0, 10.0, -1.0, 0.0, 48.0, -12.0, 35.0, -70.0, 19.0, -41.0, 0.0, -10.0, -2.0, 21.0, -11.0, 10.0, 19.0, 22.0, 0.0, 0.0, -3.0, 0.0, 25.0, -10.0, 4.0, 0.0, -1.0, 3.0, 22.0, 3.0, 20.0, 3.0, 11.0, 5.0, 9.0, 8.0, 0.0, 0.0, 17.0, 23.0, 30.0, 26.0, 8.0, -64.0, -4.0, 13.0, 20.0, 12.0, 15.0, 18.0, 15.0, 42.0, -33.0, 26.0, 0.0, -39.0, 0.0, 12.0, -97.0, -23.0, -3.0, 40.0, 10.0, -5.0, 0.0, 0.0, 13.0, 37.0, 0.0, 19.0, -15.0, -1.0, 11.0, 33.0, 0.0, 30.0, 53.0, 18.0, 16.0, 29.0, 25.0, 11.0, 13.0, 29.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-8.0, 3.0, -18.0, 0.0, 0.0, 0.0, 3.0, 0.0, 5.0, -2.0, 3.0, 0.0, -4.0, -16.0, 13.0, -173.0, 6.0, 11.0, 1.0, -205.0, -80.0, -178.0, 0.0, 0.0, 0.0, -1.0, 9.0, 0.0, -1.0, 16.0, 0.0, 5.0, 0.0, -2.0, -36.0, 0.0, -4.0, -14.0, 0.0, 0.0, 29.0, 19.0, -8.0, -16.0, 0.0, 35.0, -132.0, -8.0, 3.0, 16.0, -242.0, 11.0, -6.0, 0.0, -16.0, -16.0, -4.0, 0.0, 6.0, 7.0, -92.0, 35.0, -18.0, 0.0, 2.0, 6.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, -3.0, -6.0, 28.0, -13.0, -20.0, 0.0, -4.0, 6.0, 0.0, 0.0, 0.0, -8.0, -27.0, 0.0, -1.0, -7.0, 16.0, -26.0, 25.0, -18.0, 0.0, 3.0, -4.0, 13.0, 0.0, -22.0, 9.0, 0.0, -6.0, 5.0, 0.0, 0.0, 0.0, 0.0, -4.0, 19.0, 23.0, -17.0, 0.0, 30.0, -1.0, 11.0, 3.0, -3.0, -12.0, -136.0, -24.0, -3.0, 0.0, 13.0, -8.0, 23.0, -5.0, 0.0, -5.0, 0.0, -1.0, -11.0, 15.0, 0.0, 41.0, -9.0, 0.0, -66.0, 8.0, 0.0, 0.0, 0.0, 0.0, -78.0, -10.0, -16.0, 12.0, 0.0, -208.0, 7.0, 1.0, -76.0, 0.0, -6.0, 24.0, 0.0, -2.0, -3.0, 14.0, -38.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 18.0, -1.0, 0.0, 0.0, 0.0, -3.0, -12.0, -12.0, -2.0, 0.0, 0.0, 11.0, 19.0, 14.0, 0.0, 0.0, 18.0, -2.0, 14.0, 39.0, 0.0, 18.0, 0.0, 16.0, 12.0, 16.0, 0.0, 19.0, 4.0, 0.0, -5.0, 0.0, -12.0, 31.0], "policy_predator_policy_reward": [9.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 2.0, 6.0, 14.0, 0.0, 75.0, 94.0, 2.0, 0.0, 95.0, 114.0, 95.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 3.0, 7.0, 11.0, 0.0, 0.0, 0.0, 1.0, 27.0, 19.0, 9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 70.0, 0.0, 0.0, 0.0, 119.0, 71.0, 0.0, 6.0, 11.0, 11.0, 0.0, 2.0, 0.0, 8.0, 0.0, 46.0, 13.0, 15.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 3.0, 5.0, 5.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 4.0, 11.0, 19.0, 17.0, 13.0, 13.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 2.0, 16.0, 11.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 7.0, 0.0, 0.0, 7.0, 9.0, 0.0, 8.0, 16.0, 68.0, 18.0, 5.0, 0.0, 0.0, 4.0, 1.0, 3.0, 14.0, 9.0, 11.0, 4.0, 26.0, 0.0, 0.0, 0.0, 10.0, 33.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 39.0, 11.0, 15.0, 0.0, 0.0, 104.0, 0.0, 0.0, 52.0, 3.0, 0.0, 16.0, 0.0, 15.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 12.0, 8.0, 0.0, 0.0, 11.0, 11.0, 0.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 7.0, 0.0, 5.0, 13.0, 6.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.706183719636314, "mean_inference_ms": 31.216158008103534, "mean_action_processing_ms": 1.9056933112391568, "mean_env_wait_ms": 1.8335417404618761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004600644111633301, "StateBufferConnector_ms": 0.01594066619873047, "ViewRequirementAgentConnector_ms": 0.1465442180633545}, "num_episodes": 18, "episode_return_max": 53.0, "episode_return_min": -163.0, "episode_return_mean": 4.51, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.5870089672779, "num_env_steps_trained_throughput_per_sec": 302.5870089672779, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 3168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3168000, "timers": {"training_iteration_time_ms": 14051.986, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14051.915, "sample_time_ms": 2445.696, "learn_time_ms": 11529.424, "learn_throughput": 346.938, "synch_weights_time_ms": 72.528}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "done": false, "training_iteration": 198, "trial_id": "4f45b_00000", "date": "2024-08-13_06-14-55", "timestamp": 1723544095, "time_this_iter_s": 13.270777940750122, "time_total_s": 16916.02851843834, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b282db80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16916.02851843834, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 52.126315789473686, "ram_util_percent": 83.5842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8493014222848667, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.19161127591653476, "policy_loss": -0.0014537986813891659, "vf_loss": 0.1930650354541035, "vf_explained_var": 0.03025547742212891, "kl": 0.010677724209895488, "entropy": 0.574958408446539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0190460941305868, "cur_kl_coeff": 1.1253700913044312e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.30915446132039603, "policy_loss": -0.002452876784397713, "vf_loss": 0.3116073377482179, "vf_explained_var": 0.46994328924587797, "kl": 0.0008687083175242072, "entropy": 0.21332802149669203, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "env_runners": {"episode_reward_max": 53.0, "episode_reward_min": -97.0, "episode_reward_mean": 7.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -242.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 41.0, "predator_policy": 119.0}, "policy_reward_mean": {"prey_policy": -2.9, "predator_policy": 6.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.0, 0.0, 48.0, -12.0, 35.0, -70.0, 19.0, -41.0, 0.0, -10.0, -2.0, 21.0, -11.0, 10.0, 19.0, 22.0, 0.0, 0.0, -3.0, 0.0, 25.0, -10.0, 4.0, 0.0, -1.0, 3.0, 22.0, 3.0, 20.0, 3.0, 11.0, 5.0, 9.0, 8.0, 0.0, 0.0, 17.0, 23.0, 30.0, 26.0, 8.0, -64.0, -4.0, 13.0, 20.0, 12.0, 15.0, 18.0, 15.0, 42.0, -33.0, 26.0, 0.0, -39.0, 0.0, 12.0, -97.0, -23.0, -3.0, 40.0, 10.0, -5.0, 0.0, 0.0, 13.0, 37.0, 0.0, 19.0, -15.0, -1.0, 11.0, 33.0, 0.0, 30.0, 53.0, 18.0, 16.0, 29.0, 25.0, 11.0, 13.0, 29.0, 0.0, 0.0, 10.0, 15.0, 18.0, 36.0, 9.0, 42.0, 0.0, -8.0, 31.0, 22.0, 16.0, 13.0, 17.0, 0.0, 0.0, 16.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-4.0, -14.0, 0.0, 0.0, 29.0, 19.0, -8.0, -16.0, 0.0, 35.0, -132.0, -8.0, 3.0, 16.0, -242.0, 11.0, -6.0, 0.0, -16.0, -16.0, -4.0, 0.0, 6.0, 7.0, -92.0, 35.0, -18.0, 0.0, 2.0, 6.0, 0.0, 22.0, 0.0, 0.0, 0.0, 0.0, -14.0, 1.0, -3.0, -6.0, 28.0, -13.0, -20.0, 0.0, -4.0, 6.0, 0.0, 0.0, 0.0, -8.0, -27.0, 0.0, -1.0, -7.0, 16.0, -26.0, 25.0, -18.0, 0.0, 3.0, -4.0, 13.0, 0.0, -22.0, 9.0, 0.0, -6.0, 5.0, 0.0, 0.0, 0.0, 0.0, -4.0, 19.0, 23.0, -17.0, 0.0, 30.0, -1.0, 11.0, 3.0, -3.0, -12.0, -136.0, -24.0, -3.0, 0.0, 13.0, -8.0, 23.0, -5.0, 0.0, -5.0, 0.0, -1.0, -11.0, 15.0, 0.0, 41.0, -9.0, 0.0, -66.0, 8.0, 0.0, 0.0, 0.0, 0.0, -78.0, -10.0, -16.0, 12.0, 0.0, -208.0, 7.0, 1.0, -76.0, 0.0, -6.0, 24.0, 0.0, -2.0, -3.0, 14.0, -38.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 18.0, -1.0, 0.0, 0.0, 0.0, -3.0, -12.0, -12.0, -2.0, 0.0, 0.0, 11.0, 19.0, 14.0, 0.0, 0.0, 18.0, -2.0, 14.0, 39.0, 0.0, 18.0, 0.0, 16.0, 12.0, 16.0, 0.0, 19.0, 4.0, 0.0, -5.0, 0.0, -12.0, 31.0, -8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 5.0, -4.0, 18.0, 0.0, 28.0, 2.0, 10.0, -2.0, 23.0, 19.0, 0.0, 0.0, 0.0, -16.0, 14.0, 16.0, 5.0, 7.0, 0.0, 16.0, -12.0, 14.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0], "policy_predator_policy_reward": [9.0, 8.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 70.0, 0.0, 0.0, 0.0, 119.0, 71.0, 0.0, 6.0, 11.0, 11.0, 0.0, 2.0, 0.0, 8.0, 0.0, 46.0, 13.0, 15.0, 6.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 6.0, 3.0, 5.0, 5.0, 10.0, 0.0, 2.0, 0.0, 0.0, 0.0, 3.0, 4.0, 11.0, 19.0, 17.0, 13.0, 13.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 2.0, 16.0, 11.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 7.0, 0.0, 0.0, 7.0, 9.0, 0.0, 8.0, 16.0, 68.0, 18.0, 5.0, 0.0, 0.0, 4.0, 1.0, 3.0, 14.0, 9.0, 11.0, 4.0, 26.0, 0.0, 0.0, 0.0, 10.0, 33.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 39.0, 11.0, 15.0, 0.0, 0.0, 104.0, 0.0, 0.0, 52.0, 3.0, 0.0, 16.0, 0.0, 15.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 12.0, 8.0, 0.0, 0.0, 11.0, 11.0, 0.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 7.0, 0.0, 5.0, 13.0, 6.0, 4.0, 0.0, 8.0, 0.0, 0.0, 5.0, 0.0, 7.0, 7.0, 0.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.656258756527132, "mean_inference_ms": 31.083487298300014, "mean_action_processing_ms": 1.8983956889200402, "mean_env_wait_ms": 1.826389542487546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005828499794006348, "StateBufferConnector_ms": 0.015903711318969727, "ViewRequirementAgentConnector_ms": 0.15653586387634277}, "num_episodes": 18, "episode_return_max": 53.0, "episode_return_min": -97.0, "episode_return_mean": 7.43, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.1712402763285, "num_env_steps_trained_throughput_per_sec": 309.1712402763285, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 3184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3184000, "timers": {"training_iteration_time_ms": 13201.694, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13201.632, "sample_time_ms": 2076.885, "learn_time_ms": 11105.053, "learn_throughput": 360.196, "synch_weights_time_ms": 17.152}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "done": false, "training_iteration": 199, "trial_id": "4f45b_00000", "date": "2024-08-13_06-15-08", "timestamp": 1723544108, "time_this_iter_s": 12.965989112854004, "time_total_s": 16928.994507551193, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b289f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16928.994507551193, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 49.37222222222223, "ram_util_percent": 83.55555555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9817587615715133, "cur_kl_coeff": 3.666244447231292e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.454683284414193, "policy_loss": -0.005708531092201907, "vf_loss": 0.46039176721990643, "vf_explained_var": 0.01641358285353928, "kl": 0.012804028735688889, "entropy": 0.5929377536294321, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.363891568622261, "cur_kl_coeff": 5.626850456522156e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6037005276296031, "policy_loss": -0.004518298923639117, "vf_loss": 0.6082188274396002, "vf_explained_var": 0.28180076006859067, "kl": 0.003374209220572187, "entropy": 0.20836955953842748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 87.0, "episode_reward_min": -97.0, "episode_reward_mean": 10.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -208.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 51.0, "predator_policy": 104.0}, "policy_reward_mean": {"prey_policy": 0.22, "predator_policy": 5.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.0, 20.0, 3.0, 11.0, 5.0, 9.0, 8.0, 0.0, 0.0, 17.0, 23.0, 30.0, 26.0, 8.0, -64.0, -4.0, 13.0, 20.0, 12.0, 15.0, 18.0, 15.0, 42.0, -33.0, 26.0, 0.0, -39.0, 0.0, 12.0, -97.0, -23.0, -3.0, 40.0, 10.0, -5.0, 0.0, 0.0, 13.0, 37.0, 0.0, 19.0, -15.0, -1.0, 11.0, 33.0, 0.0, 30.0, 53.0, 18.0, 16.0, 29.0, 25.0, 11.0, 13.0, 29.0, 0.0, 0.0, 10.0, 15.0, 18.0, 36.0, 9.0, 42.0, 0.0, -8.0, 31.0, 22.0, 16.0, 13.0, 17.0, 0.0, 0.0, 16.0, 25.0, 14.0, 16.0, 4.0, 30.0, -1.0, -2.0, 41.0, 13.0, 0.0, 34.0, 11.0, 0.0, 0.0, 15.0, 37.0, 10.0, 36.0, -20.0, 12.0, 0.0, 14.0, 0.0, 6.0, 3.0, 38.0, 87.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [16.0, -26.0, 25.0, -18.0, 0.0, 3.0, -4.0, 13.0, 0.0, -22.0, 9.0, 0.0, -6.0, 5.0, 0.0, 0.0, 0.0, 0.0, -4.0, 19.0, 23.0, -17.0, 0.0, 30.0, -1.0, 11.0, 3.0, -3.0, -12.0, -136.0, -24.0, -3.0, 0.0, 13.0, -8.0, 23.0, -5.0, 0.0, -5.0, 0.0, -1.0, -11.0, 15.0, 0.0, 41.0, -9.0, 0.0, -66.0, 8.0, 0.0, 0.0, 0.0, 0.0, -78.0, -10.0, -16.0, 12.0, 0.0, -208.0, 7.0, 1.0, -76.0, 0.0, -6.0, 24.0, 0.0, -2.0, -3.0, 14.0, -38.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 18.0, -1.0, 0.0, 0.0, 0.0, -3.0, -12.0, -12.0, -2.0, 0.0, 0.0, 11.0, 19.0, 14.0, 0.0, 0.0, 18.0, -2.0, 14.0, 39.0, 0.0, 18.0, 0.0, 16.0, 12.0, 16.0, 0.0, 19.0, 4.0, 0.0, -5.0, 0.0, -12.0, 31.0, -8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 5.0, -4.0, 18.0, 0.0, 28.0, 2.0, 10.0, -2.0, 23.0, 19.0, 0.0, 0.0, 0.0, -16.0, 14.0, 16.0, 5.0, 7.0, 0.0, 16.0, -12.0, 14.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 21.0, 0.0, 14.0, 8.0, 8.0, 0.0, -12.0, -3.0, -7.0, -4.0, 0.0, -8.0, 0.0, 23.0, 11.0, 0.0, 7.0, 0.0, 0.0, -11.0, 0.0, -18.0, 0.0, 0.0, 0.0, 0.0, -12.0, 16.0, -7.0, 24.0, 11.0, 19.0, -18.0, -10.0, 36.0, -12.0, -19.0, -3.0, 4.0, 0.0, 0.0, -2.0, 1.0, 0.0, 0.0, -6.0, 0.0, 0.0, 3.0, 40.0, -4.0, 30.0, 51.0], "policy_predator_policy_reward": [13.0, 0.0, 9.0, 4.0, 0.0, 0.0, 0.0, 2.0, 16.0, 11.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 10.0, 7.0, 0.0, 0.0, 7.0, 9.0, 0.0, 8.0, 16.0, 68.0, 18.0, 5.0, 0.0, 0.0, 4.0, 1.0, 3.0, 14.0, 9.0, 11.0, 4.0, 26.0, 0.0, 0.0, 0.0, 10.0, 33.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 39.0, 11.0, 15.0, 0.0, 0.0, 104.0, 0.0, 0.0, 52.0, 3.0, 0.0, 16.0, 0.0, 15.0, 0.0, 0.0, 19.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 12.0, 8.0, 0.0, 0.0, 11.0, 11.0, 0.0, 9.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 7.0, 0.0, 5.0, 13.0, 6.0, 4.0, 0.0, 8.0, 0.0, 0.0, 5.0, 0.0, 7.0, 7.0, 0.0, 0.0, 0.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 10.0, 0.0, 0.0, 5.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 9.0, 17.0, 23.0, 0.0, 3.0, 6.0, 0.0, 7.0, 0.0, 6.0, 0.0, 0.0, 0.0, 17.0, 28.0, 12.0, 17.0, 0.0, 0.0, 7.0, 5.0, 0.0, 6.0, 2.0, 0.0, 0.0, 9.0, 2.0, 8.0, 0.0, 11.0, 0.0, 11.0, 0.0, 0.0, 10.0, 5.0, 0.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 2.0, 3.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 11.494031381584483, "mean_inference_ms": 30.78986290577997, "mean_action_processing_ms": 1.9943978345745794, "mean_env_wait_ms": 1.9264057718238745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061866044998168945, "StateBufferConnector_ms": 0.015798091888427734, "ViewRequirementAgentConnector_ms": 0.15015411376953125}, "num_episodes": 27, "episode_return_max": 87.0, "episode_return_min": -97.0, "episode_return_mean": 10.99, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.38022003977807, "num_env_steps_trained_throughput_per_sec": 307.38022003977807, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 12911.659, "restore_workers_time_ms": 0.014, "training_step_time_ms": 12911.615, "sample_time_ms": 1936.083, "learn_time_ms": 10955.535, "learn_throughput": 365.112, "synch_weights_time_ms": 17.22}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": true, "training_iteration": 200, "trial_id": "4f45b_00000", "date": "2024-08-13_06-15-21", "timestamp": 1723544121, "time_this_iter_s": 13.0591299533844, "time_total_s": 16942.053637504578, "pid": 26266, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b291ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 16942.053637504578, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 45.34210526315789, "ram_util_percent": 83.2}}
