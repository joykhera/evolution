{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5459653747789825, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.2327424756178615, "policy_loss": 7.753792220515245e-05, "vf_loss": 7.227860812430686, "vf_explained_var": -4.929519714193141e-05, "kl": 0.024020565809774484, "entropy": 1.6029452733959713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 1410.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9806812377474832, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.759725108383396, "policy_loss": -0.00048020349647057186, "vf_loss": 9.756297304951552, "vf_explained_var": 0.0005048595421703149, "kl": 0.019540053055826442, "entropy": 1.6059631228024231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 1410.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": 407.0, "episode_reward_min": -2908.0, "episode_reward_mean": -763.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -673.6851851851852, "predator_policy": 419.35185185185185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-761.0, -2146.0, -2821.0, -2908.0, -886.0, -185.0, -838.0, -226.0, -1222.0, -276.0, 97.0, 190.0, -714.0, -198.0, 407.0, -64.0, 289.0, -1472.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-273.0, -1032.0, -1021.0, -1582.0, -1494.0, -900.0, -1802.0, -2000.0, -1274.0, -1681.0, -1285.0, -1692.0, -1230.0, -361.0, -20.0, -53.0, -350.0, -757.0, -1296.0, -438.0, -229.0, -361.0, -20.0, -1560.0, -504.0, -834.0, -1219.0, -735.0, -416.0, -240.0, 200.0, -152.0, -306.0, -20.0, 167.0, -372.0, -31.0, -812.0, -1351.0, -911.0, 200.0, -317.0, 200.0, -64.0, -9.0, -31.0, -218.0, -1340.0, -163.0, -1593.0, 200.0, -1329.0, -570.0, -1098.0], "policy_predator_policy_reward": [645.0, 520.0, 400.0, 865.0, 750.0, 215.0, 1000.0, 670.0, 585.0, 925.0, 825.0, 0.0, 15.0, 690.0, 20.0, 410.0, 250.0, 315.0, 355.0, 770.0, 0.0, 280.0, 635.0, 800.0, 825.0, 295.0, 215.0, 335.0, 270.0, 510.0, 0.0, 185.0, 170.0, 80.0, 245.0, 90.0, 425.0, 430.0, 625.0, 550.0, 100.0, 180.0, 115.0, 105.0, 60.0, 485.0, 535.0, 505.0, 695.0, 530.0, 620.0, 715.0, 700.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1393201334281078, "mean_inference_ms": 1.8343510268723224, "mean_action_processing_ms": 0.4095865622842962, "mean_env_wait_ms": 0.2935328465989425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007145934634738498, "StateBufferConnector_ms": 0.005257129669189453, "ViewRequirementAgentConnector_ms": 0.13857285181681314}, "num_episodes": 18, "episode_return_max": 407.0, "episode_return_min": -2908.0, "episode_return_mean": -763.0, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 50.885967364999054, "num_env_steps_trained_throughput_per_sec": 50.885967364999054, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 78607.14, "restore_workers_time_ms": 0.017, "training_step_time_ms": 78607.042, "sample_time_ms": 1780.958, "learn_time_ms": 76803.772, "learn_throughput": 52.081, "synch_weights_time_ms": 14.334}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 1, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-17-48", "timestamp": 1723486668, "time_this_iter_s": 78.64446687698364, "time_total_s": 78.64446687698364, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32f77f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 78.64446687698364, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 35.55535714285714, "ram_util_percent": 83.33482142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5951502787623, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.437572214620333, "policy_loss": -0.00945887002889199, "vf_loss": 8.445339151646229, "vf_explained_var": 0.00014221118697037933, "kl": 0.005639791911543603, "entropy": 1.5958074060737664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 4230.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2437485281985703, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.780298701753008, "policy_loss": -0.013208310043394685, "vf_loss": 9.79123180741114, "vf_explained_var": 0.0008490539611654079, "kl": 0.011376010975448263, "entropy": 1.5935066812427332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 4230.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 627.0, "episode_reward_min": -2908.0, "episode_reward_mean": -918.0833333333334, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -742.2314814814815, "predator_policy": 436.2037037037037}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-761.0, -2146.0, -2821.0, -2908.0, -886.0, -185.0, -838.0, -226.0, -1222.0, -276.0, 97.0, 190.0, -714.0, -198.0, 407.0, -64.0, 289.0, -1472.0, -381.0, -989.0, -665.0, -445.0, -1450.0, -1836.0, -2319.0, -1499.0, -1707.0, -1381.0, 627.0, -333.0, -2016.0, -1165.0, -1684.0, -1270.0, -387.0, -417.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-273.0, -1032.0, -1021.0, -1582.0, -1494.0, -900.0, -1802.0, -2000.0, -1274.0, -1681.0, -1285.0, -1692.0, -1230.0, -361.0, -20.0, -53.0, -350.0, -757.0, -1296.0, -438.0, -229.0, -361.0, -20.0, -1560.0, -504.0, -834.0, -1219.0, -735.0, -416.0, -240.0, 200.0, -152.0, -306.0, -20.0, 167.0, -372.0, -31.0, -812.0, -1351.0, -911.0, 200.0, -317.0, 200.0, -64.0, -9.0, -31.0, -218.0, -1340.0, -163.0, -1593.0, 200.0, -1329.0, -570.0, -1098.0, -64.0, -779.0, -328.0, -702.0, -999.0, -603.0, -746.0, -1472.0, -97.0, 13.0, -449.0, -504.0, -1670.0, -504.0, -1736.0, -1131.0, -1021.0, -1219.0, -1087.0, -1296.0, -1461.0, -1813.0, 189.0, -1780.0, -273.0, -1340.0, -1274.0, -1032.0, -845.0, -1439.0, 189.0, -977.0, 200.0, -372.0, 79.0, -955.0, -1164.0, -1307.0, -1065.0, -1835.0, -262.0, -383.0, -977.0, -889.0, -713.0, -801.0, -515.0, -1439.0, -889.0, 200.0, -713.0, 79.0, -1538.0, -273.0], "policy_predator_policy_reward": [645.0, 520.0, 400.0, 865.0, 750.0, 215.0, 1000.0, 670.0, 585.0, 925.0, 825.0, 0.0, 15.0, 690.0, 20.0, 410.0, 250.0, 315.0, 355.0, 770.0, 0.0, 280.0, 635.0, 800.0, 825.0, 295.0, 215.0, 335.0, 270.0, 510.0, 0.0, 185.0, 170.0, 80.0, 245.0, 90.0, 425.0, 430.0, 625.0, 550.0, 100.0, 180.0, 115.0, 105.0, 60.0, 485.0, 535.0, 505.0, 695.0, 530.0, 620.0, 715.0, 700.0, 110.0, 540.0, 180.0, 70.0, 640.0, 290.0, 385.0, 495.0, 480.0, 675.0, 410.0, 0.0, 85.0, 905.0, 610.0, 945.0, 925.0, 405.0, 205.0, 590.0, 0.0, 935.0, 180.0, 835.0, 890.0, 265.0, 280.0, 635.0, 595.0, 650.0, 690.0, 455.0, 440.0, 320.0, 340.0, 85.0, 490.0, 655.0, 825.0, 40.0, 355.0, 930.0, 30.0, 700.0, 95.0, 100.0, 200.0, 530.0, 755.0, 350.0, 665.0, 0.0, 605.0, 545.0, 165.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.1143959461391908, "mean_inference_ms": 1.8024508769043115, "mean_action_processing_ms": 0.40038121356929124, "mean_env_wait_ms": 0.28741119406080873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007512503200107151, "StateBufferConnector_ms": 0.00462035338083903, "ViewRequirementAgentConnector_ms": 0.14789866076575386}, "num_episodes": 18, "episode_return_max": 627.0, "episode_return_min": -2908.0, "episode_return_mean": -918.0833333333334, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 48.527360366798604, "num_env_steps_trained_throughput_per_sec": 48.527360366798604, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 80517.48, "restore_workers_time_ms": 0.087, "training_step_time_ms": 80517.278, "sample_time_ms": 1734.279, "learn_time_ms": 78764.108, "learn_throughput": 50.785, "synch_weights_time_ms": 14.022}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 2, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-19-15", "timestamp": 1723486755, "time_this_iter_s": 82.45769596099854, "time_total_s": 161.10216283798218, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b101fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 161.10216283798218, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 41.767479674796746, "ram_util_percent": 81.98130081300812}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8209683938440702, "cur_kl_coeff": 0.3, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.436650462099847, "policy_loss": -0.010157382628279374, "vf_loss": 5.44537827266869, "vf_explained_var": -0.00019606611830122928, "kl": 0.0047652268325081544, "entropy": 1.5890913507617113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 7050.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.016470255771427, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.656392953750935, "policy_loss": -0.010324797429828014, "vf_loss": 9.665363666182714, "vf_explained_var": 0.001793082132407114, "kl": 0.006770423870372339, "entropy": 1.580744917849277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 7050.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": 627.0, "episode_reward_min": -2908.0, "episode_reward_mean": -761.5, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -654.9444444444445, "predator_policy": 401.1111111111111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-761.0, -2146.0, -2821.0, -2908.0, -886.0, -185.0, -838.0, -226.0, -1222.0, -276.0, 97.0, 190.0, -714.0, -198.0, 407.0, -64.0, 289.0, -1472.0, -381.0, -989.0, -665.0, -445.0, -1450.0, -1836.0, -2319.0, -1499.0, -1707.0, -1381.0, 627.0, -333.0, -2016.0, -1165.0, -1684.0, -1270.0, -387.0, -417.0, -690.0, 461.0, -1237.0, -358.0, -1411.0, -683.0, -372.0, 435.0, -636.0, 390.0, -515.0, 161.0, -1413.0, -1028.0, 481.0, 233.0, -1044.0, -844.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-273.0, -1032.0, -1021.0, -1582.0, -1494.0, -900.0, -1802.0, -2000.0, -1274.0, -1681.0, -1285.0, -1692.0, -1230.0, -361.0, -20.0, -53.0, -350.0, -757.0, -1296.0, -438.0, -229.0, -361.0, -20.0, -1560.0, -504.0, -834.0, -1219.0, -735.0, -416.0, -240.0, 200.0, -152.0, -306.0, -20.0, 167.0, -372.0, -31.0, -812.0, -1351.0, -911.0, 200.0, -317.0, 200.0, -64.0, -9.0, -31.0, -218.0, -1340.0, -163.0, -1593.0, 200.0, -1329.0, -570.0, -1098.0, -64.0, -779.0, -328.0, -702.0, -999.0, -603.0, -746.0, -1472.0, -97.0, 13.0, -449.0, -504.0, -1670.0, -504.0, -1736.0, -1131.0, -1021.0, -1219.0, -1087.0, -1296.0, -1461.0, -1813.0, 189.0, -1780.0, -273.0, -1340.0, -1274.0, -1032.0, -845.0, -1439.0, 189.0, -977.0, 200.0, -372.0, 79.0, -955.0, -1164.0, -1307.0, -1065.0, -1835.0, -262.0, -383.0, -977.0, -889.0, -713.0, -801.0, -515.0, -1439.0, -889.0, 200.0, -713.0, 79.0, -1538.0, -273.0, -163.0, -1747.0, 200.0, 200.0, 200.0, -119.0, -1120.0, -592.0, -845.0, -141.0, -130.0, -922.0, -229.0, -966.0, -1241.0, -350.0, -889.0, -9.0, -405.0, 200.0, -1582.0, -504.0, 134.0, 200.0, -845.0, 35.0, -966.0, -20.0, 200.0, 35.0, -746.0, -1087.0, -152.0, -86.0, -383.0, 35.0, -449.0, -1263.0, -801.0, -229.0, -570.0, -1659.0, -1626.0, 200.0, 112.0, -262.0, -9.0, 79.0, -185.0, -1186.0, -1208.0, -713.0, -449.0, -922.0], "policy_predator_policy_reward": [645.0, 520.0, 400.0, 865.0, 750.0, 215.0, 1000.0, 670.0, 585.0, 925.0, 825.0, 0.0, 15.0, 690.0, 20.0, 410.0, 250.0, 315.0, 355.0, 770.0, 0.0, 280.0, 635.0, 800.0, 825.0, 295.0, 215.0, 335.0, 270.0, 510.0, 0.0, 185.0, 170.0, 80.0, 245.0, 90.0, 425.0, 430.0, 625.0, 550.0, 100.0, 180.0, 115.0, 105.0, 60.0, 485.0, 535.0, 505.0, 695.0, 530.0, 620.0, 715.0, 700.0, 110.0, 540.0, 180.0, 70.0, 640.0, 290.0, 385.0, 495.0, 480.0, 675.0, 410.0, 0.0, 85.0, 905.0, 610.0, 945.0, 925.0, 405.0, 205.0, 590.0, 0.0, 935.0, 180.0, 835.0, 890.0, 265.0, 280.0, 635.0, 595.0, 650.0, 690.0, 455.0, 440.0, 320.0, 340.0, 85.0, 490.0, 655.0, 825.0, 40.0, 355.0, 930.0, 30.0, 700.0, 95.0, 100.0, 200.0, 530.0, 755.0, 350.0, 665.0, 0.0, 605.0, 545.0, 165.0, 800.0, 195.0, 25.0, 60.0, 100.0, 20.0, 355.0, 700.0, 265.0, 60.0, 535.0, 240.0, 190.0, 645.0, 190.0, 30.0, 535.0, 0.0, 255.0, 635.0, 525.0, 305.0, 0.0, 300.0, 185.0, 270.0, 685.0, 50.0, 25.0, 100.0, 570.0, 605.0, 295.0, 215.0, 130.0, 250.0, 430.0, 495.0, 175.0, 250.0, 845.0, 335.0, 730.0, 700.0, 365.0, 150.0, 65.0, 210.0, 850.0, 520.0, 165.0, 700.0, 265.0, 275.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.084120513126688, "mean_inference_ms": 1.7634297926001186, "mean_action_processing_ms": 0.39495648869539185, "mean_env_wait_ms": 0.2816825299204693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007400468543723777, "StateBufferConnector_ms": 0.004340101171422888, "ViewRequirementAgentConnector_ms": 0.1426186826494005}, "num_episodes": 18, "episode_return_max": 627.0, "episode_return_min": -2908.0, "episode_return_mean": -761.5, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 48.91371207489744, "num_env_steps_trained_throughput_per_sec": 48.91371207489744, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 80937.21, "restore_workers_time_ms": 0.063, "training_step_time_ms": 80937.059, "sample_time_ms": 1629.485, "learn_time_ms": 79288.065, "learn_throughput": 50.449, "synch_weights_time_ms": 14.786}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 3, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-20-36", "timestamp": 1723486836, "time_this_iter_s": 81.81474781036377, "time_total_s": 242.91691064834595, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32f77f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 242.91691064834595, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.550000000000004, "ram_util_percent": 82.12672413793106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9929001260205363, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.667623425798213, "policy_loss": -0.014797290367040666, "vf_loss": 4.679980740479544, "vf_explained_var": -0.0005742815369409873, "kl": 0.016266579491654387, "entropy": 1.585232410109635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 9870.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.360335727141681, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.613092833715127, "policy_loss": -0.013463296054479343, "vf_loss": 9.624545291467761, "vf_explained_var": 0.001931645007843667, "kl": 0.010054230508903573, "entropy": 1.5650095218039572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 9870.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 627.0, "episode_reward_min": -3509.0, "episode_reward_mean": -647.3888888888889, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -565.5185185185185, "predator_policy": 349.72222222222223}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-761.0, -2146.0, -2821.0, -2908.0, -886.0, -185.0, -838.0, -226.0, -1222.0, -276.0, 97.0, 190.0, -714.0, -198.0, 407.0, -64.0, 289.0, -1472.0, -381.0, -989.0, -665.0, -445.0, -1450.0, -1836.0, -2319.0, -1499.0, -1707.0, -1381.0, 627.0, -333.0, -2016.0, -1165.0, -1684.0, -1270.0, -387.0, -417.0, -690.0, 461.0, -1237.0, -358.0, -1411.0, -683.0, -372.0, 435.0, -636.0, 390.0, -515.0, 161.0, -1413.0, -1028.0, 481.0, 233.0, -1044.0, -844.0, -147.0, -254.0, -488.0, -3509.0, -780.0, -336.0, 288.0, -827.0, 347.0, 470.0, 273.0, 434.0, -107.0, -876.0, -154.0, -2.0, 136.0, 41.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-273.0, -1032.0, -1021.0, -1582.0, -1494.0, -900.0, -1802.0, -2000.0, -1274.0, -1681.0, -1285.0, -1692.0, -1230.0, -361.0, -20.0, -53.0, -350.0, -757.0, -1296.0, -438.0, -229.0, -361.0, -20.0, -1560.0, -504.0, -834.0, -1219.0, -735.0, -416.0, -240.0, 200.0, -152.0, -306.0, -20.0, 167.0, -372.0, -31.0, -812.0, -1351.0, -911.0, 200.0, -317.0, 200.0, -64.0, -9.0, -31.0, -218.0, -1340.0, -163.0, -1593.0, 200.0, -1329.0, -570.0, -1098.0, -64.0, -779.0, -328.0, -702.0, -999.0, -603.0, -746.0, -1472.0, -97.0, 13.0, -449.0, -504.0, -1670.0, -504.0, -1736.0, -1131.0, -1021.0, -1219.0, -1087.0, -1296.0, -1461.0, -1813.0, 189.0, -1780.0, -273.0, -1340.0, -1274.0, -1032.0, -845.0, -1439.0, 189.0, -977.0, 200.0, -372.0, 79.0, -955.0, -1164.0, -1307.0, -1065.0, -1835.0, -262.0, -383.0, -977.0, -889.0, -713.0, -801.0, -515.0, -1439.0, -889.0, 200.0, -713.0, 79.0, -1538.0, -273.0, -163.0, -1747.0, 200.0, 200.0, 200.0, -119.0, -1120.0, -592.0, -845.0, -141.0, -130.0, -922.0, -229.0, -966.0, -1241.0, -350.0, -889.0, -9.0, -405.0, 200.0, -1582.0, -504.0, 134.0, 200.0, -845.0, 35.0, -966.0, -20.0, 200.0, 35.0, -746.0, -1087.0, -152.0, -86.0, -383.0, 35.0, -449.0, -1263.0, -801.0, -229.0, -570.0, -1659.0, -1626.0, 200.0, 112.0, -262.0, -9.0, 79.0, -185.0, -1186.0, -1208.0, -713.0, -449.0, -922.0, 101.0, -603.0, -240.0, -141.0, -427.0, -361.0, -515.0, -284.0, -284.0, -1318.0, -1527.0, -1824.0, -119.0, -988.0, -493.0, 156.0, -922.0, -515.0, 200.0, 200.0, -757.0, -339.0, -372.0, -1406.0, 24.0, 90.0, 68.0, 200.0, 156.0, 24.0, -31.0, -31.0, 200.0, 200.0, 200.0, -196.0, 200.0, -724.0, -163.0, -163.0, -339.0, -944.0, -273.0, -240.0, 79.0, -746.0, 200.0, -141.0, -185.0, -284.0, 145.0, 24.0, -768.0, 145.0], "policy_predator_policy_reward": [645.0, 520.0, 400.0, 865.0, 750.0, 215.0, 1000.0, 670.0, 585.0, 925.0, 825.0, 0.0, 15.0, 690.0, 20.0, 410.0, 250.0, 315.0, 355.0, 770.0, 0.0, 280.0, 635.0, 800.0, 825.0, 295.0, 215.0, 335.0, 270.0, 510.0, 0.0, 185.0, 170.0, 80.0, 245.0, 90.0, 425.0, 430.0, 625.0, 550.0, 100.0, 180.0, 115.0, 105.0, 60.0, 485.0, 535.0, 505.0, 695.0, 530.0, 620.0, 715.0, 700.0, 110.0, 540.0, 180.0, 70.0, 640.0, 290.0, 385.0, 495.0, 480.0, 675.0, 410.0, 0.0, 85.0, 905.0, 610.0, 945.0, 925.0, 405.0, 205.0, 590.0, 0.0, 935.0, 180.0, 835.0, 890.0, 265.0, 280.0, 635.0, 595.0, 650.0, 690.0, 455.0, 440.0, 320.0, 340.0, 85.0, 490.0, 655.0, 825.0, 40.0, 355.0, 930.0, 30.0, 700.0, 95.0, 100.0, 200.0, 530.0, 755.0, 350.0, 665.0, 0.0, 605.0, 545.0, 165.0, 800.0, 195.0, 25.0, 60.0, 100.0, 20.0, 355.0, 700.0, 265.0, 60.0, 535.0, 240.0, 190.0, 645.0, 190.0, 30.0, 535.0, 0.0, 255.0, 635.0, 525.0, 305.0, 0.0, 300.0, 185.0, 270.0, 685.0, 50.0, 25.0, 100.0, 570.0, 605.0, 295.0, 215.0, 130.0, 250.0, 430.0, 495.0, 175.0, 250.0, 845.0, 335.0, 730.0, 700.0, 365.0, 150.0, 65.0, 210.0, 850.0, 520.0, 165.0, 700.0, 265.0, 275.0, 190.0, 35.0, 370.0, 245.0, 130.0, 300.0, 220.0, 375.0, 0.0, 0.0, 1000.0, 160.0, 0.0, 560.0, 260.0, 80.0, 470.0, 395.0, 170.0, 325.0, 150.0, 750.0, 180.0, 360.0, 40.0, 80.0, 45.0, 25.0, 65.0, 0.0, 120.0, 0.0, 15.0, 0.0, 60.0, 170.0, 15.0, 440.0, 125.0, 0.0, 570.0, 0.0, 70.0, 0.0, 210.0, 105.0, 445.0, 135.0, 210.0, 250.0, 0.0, 460.0, 50.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.065964266072798, "mean_inference_ms": 1.7336802445771495, "mean_action_processing_ms": 0.39070113512280374, "mean_env_wait_ms": 0.2778644129070381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007868144247266982, "StateBufferConnector_ms": 0.012898445129394531, "ViewRequirementAgentConnector_ms": 0.14042225148942736}, "num_episodes": 18, "episode_return_max": 627.0, "episode_return_min": -3509.0, "episode_return_mean": -647.3888888888889, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 51.02668151037252, "num_env_steps_trained_throughput_per_sec": 51.02668151037252, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 80300.5, "restore_workers_time_ms": 0.052, "training_step_time_ms": 80300.374, "sample_time_ms": 1588.447, "learn_time_ms": 78692.98, "learn_throughput": 50.83, "synch_weights_time_ms": 14.736}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 4, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-21-55", "timestamp": 1723486915, "time_this_iter_s": 78.40217208862305, "time_total_s": 321.319082736969, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b104ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 321.319082736969, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 35.751351351351346, "ram_util_percent": 82.55495495495494}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8633244071235048, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.834139563682231, "policy_loss": -0.012487636860839837, "vf_loss": 6.844654346188755, "vf_explained_var": -0.00010893270901754393, "kl": 0.013152221919268936, "entropy": 1.5710347382734853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 12690.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.618131524408963, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.681040234937736, "policy_loss": -0.010131523304235798, "vf_loss": 9.689638326861335, "vf_explained_var": 0.0016628654290598336, "kl": 0.007667143519911922, "entropy": 1.5484238229322096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 12690.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 627.0, "episode_reward_min": -3509.0, "episode_reward_mean": -722.1818181818181, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -592.074074074074, "predator_policy": 351.3468013468013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-761.0, -2146.0, -2821.0, -2908.0, -886.0, -185.0, -838.0, -226.0, -1222.0, -276.0, 97.0, 190.0, -714.0, -198.0, 407.0, -64.0, 289.0, -1472.0, -381.0, -989.0, -665.0, -445.0, -1450.0, -1836.0, -2319.0, -1499.0, -1707.0, -1381.0, 627.0, -333.0, -2016.0, -1165.0, -1684.0, -1270.0, -387.0, -417.0, -690.0, 461.0, -1237.0, -358.0, -1411.0, -683.0, -372.0, 435.0, -636.0, 390.0, -515.0, 161.0, -1413.0, -1028.0, 481.0, 233.0, -1044.0, -844.0, -147.0, -254.0, -488.0, -3509.0, -780.0, -336.0, 288.0, -827.0, 347.0, 470.0, 273.0, 434.0, -107.0, -876.0, -154.0, -2.0, 136.0, 41.0, -172.0, -440.0, -849.0, -223.0, -1467.0, -2150.0, -233.0, -387.0, -824.0, -965.0, -2175.0, -88.0, -1047.0, -315.0, -1348.0, -89.0, -667.0, -778.0, -934.0, -2342.0, -3087.0, -36.0, 120.0, -1588.0, -297.0, -285.0, -2218.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-273.0, -1032.0, -1021.0, -1582.0, -1494.0, -900.0, -1802.0, -2000.0, -1274.0, -1681.0, -1285.0, -1692.0, -1230.0, -361.0, -20.0, -53.0, -350.0, -757.0, -1296.0, -438.0, -229.0, -361.0, -20.0, -1560.0, -504.0, -834.0, -1219.0, -735.0, -416.0, -240.0, 200.0, -152.0, -306.0, -20.0, 167.0, -372.0, -31.0, -812.0, -1351.0, -911.0, 200.0, -317.0, 200.0, -64.0, -9.0, -31.0, -218.0, -1340.0, -163.0, -1593.0, 200.0, -1329.0, -570.0, -1098.0, -64.0, -779.0, -328.0, -702.0, -999.0, -603.0, -746.0, -1472.0, -97.0, 13.0, -449.0, -504.0, -1670.0, -504.0, -1736.0, -1131.0, -1021.0, -1219.0, -1087.0, -1296.0, -1461.0, -1813.0, 189.0, -1780.0, -273.0, -1340.0, -1274.0, -1032.0, -845.0, -1439.0, 189.0, -977.0, 200.0, -372.0, 79.0, -955.0, -1164.0, -1307.0, -1065.0, -1835.0, -262.0, -383.0, -977.0, -889.0, -713.0, -801.0, -515.0, -1439.0, -889.0, 200.0, -713.0, 79.0, -1538.0, -273.0, -163.0, -1747.0, 200.0, 200.0, 200.0, -119.0, -1120.0, -592.0, -845.0, -141.0, -130.0, -922.0, -229.0, -966.0, -1241.0, -350.0, -889.0, -9.0, -405.0, 200.0, -1582.0, -504.0, 134.0, 200.0, -845.0, 35.0, -966.0, -20.0, 200.0, 35.0, -746.0, -1087.0, -152.0, -86.0, -383.0, 35.0, -449.0, -1263.0, -801.0, -229.0, -570.0, -1659.0, -1626.0, 200.0, 112.0, -262.0, -9.0, 79.0, -185.0, -1186.0, -1208.0, -713.0, -449.0, -922.0, 101.0, -603.0, -240.0, -141.0, -427.0, -361.0, -515.0, -284.0, -284.0, -1318.0, -1527.0, -1824.0, -119.0, -988.0, -493.0, 156.0, -922.0, -515.0, 200.0, 200.0, -757.0, -339.0, -372.0, -1406.0, 24.0, 90.0, 68.0, 200.0, 156.0, 24.0, -31.0, -31.0, 200.0, 200.0, 200.0, -196.0, 200.0, -724.0, -163.0, -163.0, -339.0, -944.0, -273.0, -240.0, 79.0, -746.0, 200.0, -141.0, -185.0, -284.0, 145.0, 24.0, -768.0, 145.0, -504.0, 200.0, -328.0, -471.0, -284.0, -460.0, -306.0, -284.0, -1439.0, -592.0, -251.0, -75.0, -581.0, -1373.0, -1593.0, -1769.0, -1175.0, -801.0, 167.0, -504.0, -801.0, -713.0, 200.0, -394.0, -823.0, 200.0, -1901.0, -1241.0, -1274.0, 145.0, -1241.0, -1263.0, -1296.0, -262.0, -64.0, -317.0, -1164.0, -1362.0, 79.0, -185.0, -570.0, -75.0, -691.0, -911.0, -911.0, 200.0, -988.0, 79.0, -273.0, -999.0, -405.0, -1076.0, -867.0, 200.0, -867.0, -1186.0, 79.0, -1538.0, -1527.0, -1252.0, -1098.0, -1417.0, -1527.0, -196.0, 200.0, -460.0, -658.0, 200.0, 178.0, -1021.0, -1054.0, -1318.0, -306.0, 200.0, -911.0, -20.0, -75.0, -790.0, -1120.0, -1428.0, -1395.0], "policy_predator_policy_reward": [645.0, 520.0, 400.0, 865.0, 750.0, 215.0, 1000.0, 670.0, 585.0, 925.0, 825.0, 0.0, 15.0, 690.0, 20.0, 410.0, 250.0, 315.0, 355.0, 770.0, 0.0, 280.0, 635.0, 800.0, 825.0, 295.0, 215.0, 335.0, 270.0, 510.0, 0.0, 185.0, 170.0, 80.0, 245.0, 90.0, 425.0, 430.0, 625.0, 550.0, 100.0, 180.0, 115.0, 105.0, 60.0, 485.0, 535.0, 505.0, 695.0, 530.0, 620.0, 715.0, 700.0, 110.0, 540.0, 180.0, 70.0, 640.0, 290.0, 385.0, 495.0, 480.0, 675.0, 410.0, 0.0, 85.0, 905.0, 610.0, 945.0, 925.0, 405.0, 205.0, 590.0, 0.0, 935.0, 180.0, 835.0, 890.0, 265.0, 280.0, 635.0, 595.0, 650.0, 690.0, 455.0, 440.0, 320.0, 340.0, 85.0, 490.0, 655.0, 825.0, 40.0, 355.0, 930.0, 30.0, 700.0, 95.0, 100.0, 200.0, 530.0, 755.0, 350.0, 665.0, 0.0, 605.0, 545.0, 165.0, 800.0, 195.0, 25.0, 60.0, 100.0, 20.0, 355.0, 700.0, 265.0, 60.0, 535.0, 240.0, 190.0, 645.0, 190.0, 30.0, 535.0, 0.0, 255.0, 635.0, 525.0, 305.0, 0.0, 300.0, 185.0, 270.0, 685.0, 50.0, 25.0, 100.0, 570.0, 605.0, 295.0, 215.0, 130.0, 250.0, 430.0, 495.0, 175.0, 250.0, 845.0, 335.0, 730.0, 700.0, 365.0, 150.0, 65.0, 210.0, 850.0, 520.0, 165.0, 700.0, 265.0, 275.0, 190.0, 35.0, 370.0, 245.0, 130.0, 300.0, 220.0, 375.0, 0.0, 0.0, 1000.0, 160.0, 0.0, 560.0, 260.0, 80.0, 470.0, 395.0, 170.0, 325.0, 150.0, 750.0, 180.0, 360.0, 40.0, 80.0, 45.0, 25.0, 65.0, 0.0, 120.0, 0.0, 15.0, 0.0, 60.0, 170.0, 15.0, 440.0, 125.0, 0.0, 570.0, 0.0, 70.0, 0.0, 210.0, 105.0, 445.0, 135.0, 210.0, 250.0, 0.0, 460.0, 50.0, 130.0, 230.0, 145.0, 85.0, 45.0, 295.0, 435.0, 280.0, 620.0, 280.0, 170.0, 340.0, 185.0, 795.0, 565.0, 720.0, 920.0, 275.0, 400.0, 270.0, 520.0, 115.0, 0.0, 520.0, 0.0, 670.0, 485.0, 545.0, 335.0, 605.0, 465.0, 120.0, 675.0, 830.0, 425.0, 0.0, 130.0, 375.0, 395.0, 630.0, 280.0, 165.0, 70.0, 215.0, 530.0, 420.0, 535.0, 35.0, 50.0, 220.0, 520.0, 270.0, 195.0, 195.0, 575.0, 545.0, 495.0, 0.0, 875.0, 330.0, 770.0, 950.0, 0.0, 5.0, 310.0, 15.0, 95.0, 390.0, 0.0, 10.0, 635.0, 560.0, 610.0, 65.0, 0.0, 655.0, 85.0, 455.0, 60.0, 490.0, 825.0, 410.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0852886305394251, "mean_inference_ms": 1.7291790566946326, "mean_action_processing_ms": 0.38734917309565825, "mean_env_wait_ms": 0.2758687708669219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009694123508954289, "StateBufferConnector_ms": 0.011903950662323923, "ViewRequirementAgentConnector_ms": 0.17247055516098486}, "num_episodes": 27, "episode_return_max": 627.0, "episode_return_min": -3509.0, "episode_return_mean": -722.1818181818181, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 49.92437835106975, "num_env_steps_trained_throughput_per_sec": 49.92437835106975, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 80264.637, "restore_workers_time_ms": 0.044, "training_step_time_ms": 80264.528, "sample_time_ms": 1728.085, "learn_time_ms": 78517.177, "learn_throughput": 50.944, "synch_weights_time_ms": 15.053}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 5, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-23-15", "timestamp": 1723486995, "time_this_iter_s": 80.16704487800598, "time_total_s": 401.486127614975, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32f77f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 401.486127614975, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.73333333333333, "ram_util_percent": 83.08245614035087}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9506066724235285, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.544747150874308, "policy_loss": -0.013205214882110978, "vf_loss": 8.556229439356649, "vf_explained_var": -6.654372451998663e-07, "kl": 0.011486128276086824, "entropy": 1.5549519917220933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 15510.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6598487050398023, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.733540474438499, "policy_loss": -0.015254807126037908, "vf_loss": 9.746563649684825, "vf_explained_var": 0.003098212890591182, "kl": 0.011158169592464472, "entropy": 1.53868816393487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 15510.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 627.0, "episode_reward_min": -3509.0, "episode_reward_mean": -770.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1934.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -623.13, "predator_policy": 366.18333333333334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1472.0, -381.0, -989.0, -665.0, -445.0, -1450.0, -1836.0, -2319.0, -1499.0, -1707.0, -1381.0, 627.0, -333.0, -2016.0, -1165.0, -1684.0, -1270.0, -387.0, -417.0, -690.0, 461.0, -1237.0, -358.0, -1411.0, -683.0, -372.0, 435.0, -636.0, 390.0, -515.0, 161.0, -1413.0, -1028.0, 481.0, 233.0, -1044.0, -844.0, -147.0, -254.0, -488.0, -3509.0, -780.0, -336.0, 288.0, -827.0, 347.0, 470.0, 273.0, 434.0, -107.0, -876.0, -154.0, -2.0, 136.0, 41.0, -172.0, -440.0, -849.0, -223.0, -1467.0, -2150.0, -233.0, -387.0, -824.0, -965.0, -2175.0, -88.0, -1047.0, -315.0, -1348.0, -89.0, -667.0, -778.0, -934.0, -2342.0, -3087.0, -36.0, 120.0, -1588.0, -297.0, -285.0, -2218.0, -525.0, -1045.0, -2025.0, -51.0, -889.0, -744.0, -210.0, -2070.0, -528.0, -783.0, -1327.0, -1791.0, -978.0, -1183.0, -756.0, 68.0, -1493.0, -1520.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1329.0, -570.0, -1098.0, -64.0, -779.0, -328.0, -702.0, -999.0, -603.0, -746.0, -1472.0, -97.0, 13.0, -449.0, -504.0, -1670.0, -504.0, -1736.0, -1131.0, -1021.0, -1219.0, -1087.0, -1296.0, -1461.0, -1813.0, 189.0, -1780.0, -273.0, -1340.0, -1274.0, -1032.0, -845.0, -1439.0, 189.0, -977.0, 200.0, -372.0, 79.0, -955.0, -1164.0, -1307.0, -1065.0, -1835.0, -262.0, -383.0, -977.0, -889.0, -713.0, -801.0, -515.0, -1439.0, -889.0, 200.0, -713.0, 79.0, -1538.0, -273.0, -163.0, -1747.0, 200.0, 200.0, 200.0, -119.0, -1120.0, -592.0, -845.0, -141.0, -130.0, -922.0, -229.0, -966.0, -1241.0, -350.0, -889.0, -9.0, -405.0, 200.0, -1582.0, -504.0, 134.0, 200.0, -845.0, 35.0, -966.0, -20.0, 200.0, 35.0, -746.0, -1087.0, -152.0, -86.0, -383.0, 35.0, -449.0, -1263.0, -801.0, -229.0, -570.0, -1659.0, -1626.0, 200.0, 112.0, -262.0, -9.0, 79.0, -185.0, -1186.0, -1208.0, -713.0, -449.0, -922.0, 101.0, -603.0, -240.0, -141.0, -427.0, -361.0, -515.0, -284.0, -284.0, -1318.0, -1527.0, -1824.0, -119.0, -988.0, -493.0, 156.0, -922.0, -515.0, 200.0, 200.0, -757.0, -339.0, -372.0, -1406.0, 24.0, 90.0, 68.0, 200.0, 156.0, 24.0, -31.0, -31.0, 200.0, 200.0, 200.0, -196.0, 200.0, -724.0, -163.0, -163.0, -339.0, -944.0, -273.0, -240.0, 79.0, -746.0, 200.0, -141.0, -185.0, -284.0, 145.0, 24.0, -768.0, 145.0, -504.0, 200.0, -328.0, -471.0, -284.0, -460.0, -306.0, -284.0, -1439.0, -592.0, -251.0, -75.0, -581.0, -1373.0, -1593.0, -1769.0, -1175.0, -801.0, 167.0, -504.0, -801.0, -713.0, 200.0, -394.0, -823.0, 200.0, -1901.0, -1241.0, -1274.0, 145.0, -1241.0, -1263.0, -1296.0, -262.0, -64.0, -317.0, -1164.0, -1362.0, 79.0, -185.0, -570.0, -75.0, -691.0, -911.0, -911.0, 200.0, -988.0, 79.0, -273.0, -999.0, -405.0, -1076.0, -867.0, 200.0, -867.0, -1186.0, 79.0, -1538.0, -1527.0, -1252.0, -1098.0, -1417.0, -1527.0, -196.0, 200.0, -460.0, -658.0, 200.0, 178.0, -1021.0, -1054.0, -1318.0, -306.0, 200.0, -911.0, -20.0, -75.0, -790.0, -1120.0, -1428.0, -1395.0, -1868.0, -482.0, -75.0, -174.0, -823.0, -1648.0, -1263.0, -1296.0, -1186.0, -504.0, -163.0, 101.0, -284.0, -1021.0, -779.0, -416.0, -1032.0, -1131.0, -119.0, -548.0, -53.0, -1142.0, -1208.0, -1560.0, -1439.0, 2.0, -196.0, -845.0, 189.0, -1527.0, -526.0, -1285.0, -1021.0, -1318.0, -1417.0, -1296.0, -988.0, -207.0, -1208.0, -1879.0, 200.0, -1934.0, -955.0, -449.0, -702.0, 123.0, -1219.0, -416.0, -1054.0, -130.0, -1604.0, -1076.0, -1043.0, -581.0], "policy_predator_policy_reward": [715.0, 700.0, 110.0, 540.0, 180.0, 70.0, 640.0, 290.0, 385.0, 495.0, 480.0, 675.0, 410.0, 0.0, 85.0, 905.0, 610.0, 945.0, 925.0, 405.0, 205.0, 590.0, 0.0, 935.0, 180.0, 835.0, 890.0, 265.0, 280.0, 635.0, 595.0, 650.0, 690.0, 455.0, 440.0, 320.0, 340.0, 85.0, 490.0, 655.0, 825.0, 40.0, 355.0, 930.0, 30.0, 700.0, 95.0, 100.0, 200.0, 530.0, 755.0, 350.0, 665.0, 0.0, 605.0, 545.0, 165.0, 800.0, 195.0, 25.0, 60.0, 100.0, 20.0, 355.0, 700.0, 265.0, 60.0, 535.0, 240.0, 190.0, 645.0, 190.0, 30.0, 535.0, 0.0, 255.0, 635.0, 525.0, 305.0, 0.0, 300.0, 185.0, 270.0, 685.0, 50.0, 25.0, 100.0, 570.0, 605.0, 295.0, 215.0, 130.0, 250.0, 430.0, 495.0, 175.0, 250.0, 845.0, 335.0, 730.0, 700.0, 365.0, 150.0, 65.0, 210.0, 850.0, 520.0, 165.0, 700.0, 265.0, 275.0, 190.0, 35.0, 370.0, 245.0, 130.0, 300.0, 220.0, 375.0, 0.0, 0.0, 1000.0, 160.0, 0.0, 560.0, 260.0, 80.0, 470.0, 395.0, 170.0, 325.0, 150.0, 750.0, 180.0, 360.0, 40.0, 80.0, 45.0, 25.0, 65.0, 0.0, 120.0, 0.0, 15.0, 0.0, 60.0, 170.0, 15.0, 440.0, 125.0, 0.0, 570.0, 0.0, 70.0, 0.0, 210.0, 105.0, 445.0, 135.0, 210.0, 250.0, 0.0, 460.0, 50.0, 130.0, 230.0, 145.0, 85.0, 45.0, 295.0, 435.0, 280.0, 620.0, 280.0, 170.0, 340.0, 185.0, 795.0, 565.0, 720.0, 920.0, 275.0, 400.0, 270.0, 520.0, 115.0, 0.0, 520.0, 0.0, 670.0, 485.0, 545.0, 335.0, 605.0, 465.0, 120.0, 675.0, 830.0, 425.0, 0.0, 130.0, 375.0, 395.0, 630.0, 280.0, 165.0, 70.0, 215.0, 530.0, 420.0, 535.0, 35.0, 50.0, 220.0, 520.0, 270.0, 195.0, 195.0, 575.0, 545.0, 495.0, 0.0, 875.0, 330.0, 770.0, 950.0, 0.0, 5.0, 310.0, 15.0, 95.0, 390.0, 0.0, 10.0, 635.0, 560.0, 610.0, 65.0, 0.0, 655.0, 85.0, 455.0, 60.0, 490.0, 825.0, 410.0, 665.0, 770.0, 465.0, 160.0, 625.0, 815.0, 540.0, 475.0, 705.0, 35.0, 155.0, 325.0, 500.0, 535.0, 160.0, 855.0, 220.0, 760.0, 105.0, 175.0, 230.0, 735.0, 410.0, 695.0, 530.0, 265.0, 310.0, 570.0, 505.0, 325.0, 400.0, 635.0, 470.0, 750.0, 720.0, 770.0, 530.0, 525.0, 370.0, 900.0, 895.0, 635.0, 405.0, 420.0, 525.0, 285.0, 670.0, 625.0, 0.0, 440.0, 855.0, 550.0, 45.0, 585.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0791782720754635, "mean_inference_ms": 1.7039416565722632, "mean_action_processing_ms": 0.38137083847218606, "mean_env_wait_ms": 0.27146790983679303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009220361709594727, "StateBufferConnector_ms": 0.011598944664001465, "ViewRequirementAgentConnector_ms": 0.1799546480178833}, "num_episodes": 18, "episode_return_max": 627.0, "episode_return_min": -3509.0, "episode_return_mean": -770.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 51.696035673200996, "num_env_steps_trained_throughput_per_sec": 51.696035673200996, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 79783.094, "restore_workers_time_ms": 0.039, "training_step_time_ms": 79782.995, "sample_time_ms": 1681.904, "learn_time_ms": 78080.883, "learn_throughput": 51.229, "synch_weights_time_ms": 14.832}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 6, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-24-33", "timestamp": 1723487073, "time_this_iter_s": 77.45414805412292, "time_total_s": 478.9402756690979, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b104adc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 478.9402756690979, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 36.41, "ram_util_percent": 83.12272727272726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.032414706231009, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.519840797633989, "policy_loss": -0.011708038395348315, "vf_loss": 7.529593622261751, "vf_explained_var": -3.44611017416555e-05, "kl": 0.013034781752681506, "entropy": 1.5437583424098102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 18330.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5098286457518313, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.645729006774037, "policy_loss": -0.011123542977721557, "vf_loss": 9.655277716183493, "vf_explained_var": 0.0035827929669238153, "kl": 0.007874278410723162, "entropy": 1.5324524836337312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 18330.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "env_runners": {"episode_reward_max": 481.0, "episode_reward_min": -3509.0, "episode_reward_mean": -667.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1956.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -584.8133333333334, "predator_policy": 362.46666666666664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-417.0, -690.0, 461.0, -1237.0, -358.0, -1411.0, -683.0, -372.0, 435.0, -636.0, 390.0, -515.0, 161.0, -1413.0, -1028.0, 481.0, 233.0, -1044.0, -844.0, -147.0, -254.0, -488.0, -3509.0, -780.0, -336.0, 288.0, -827.0, 347.0, 470.0, 273.0, 434.0, -107.0, -876.0, -154.0, -2.0, 136.0, 41.0, -172.0, -440.0, -849.0, -223.0, -1467.0, -2150.0, -233.0, -387.0, -824.0, -965.0, -2175.0, -88.0, -1047.0, -315.0, -1348.0, -89.0, -667.0, -778.0, -934.0, -2342.0, -3087.0, -36.0, 120.0, -1588.0, -297.0, -285.0, -2218.0, -525.0, -1045.0, -2025.0, -51.0, -889.0, -744.0, -210.0, -2070.0, -528.0, -783.0, -1327.0, -1791.0, -978.0, -1183.0, -756.0, 68.0, -1493.0, -1520.0, 284.0, -2114.0, -281.0, -516.0, -477.0, -2098.0, -1175.0, 100.0, 100.0, -954.0, -630.0, 224.0, -622.0, 336.0, 326.0, -1141.0, -1516.0, 162.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.0, -1538.0, -273.0, -163.0, -1747.0, 200.0, 200.0, 200.0, -119.0, -1120.0, -592.0, -845.0, -141.0, -130.0, -922.0, -229.0, -966.0, -1241.0, -350.0, -889.0, -9.0, -405.0, 200.0, -1582.0, -504.0, 134.0, 200.0, -845.0, 35.0, -966.0, -20.0, 200.0, 35.0, -746.0, -1087.0, -152.0, -86.0, -383.0, 35.0, -449.0, -1263.0, -801.0, -229.0, -570.0, -1659.0, -1626.0, 200.0, 112.0, -262.0, -9.0, 79.0, -185.0, -1186.0, -1208.0, -713.0, -449.0, -922.0, 101.0, -603.0, -240.0, -141.0, -427.0, -361.0, -515.0, -284.0, -284.0, -1318.0, -1527.0, -1824.0, -119.0, -988.0, -493.0, 156.0, -922.0, -515.0, 200.0, 200.0, -757.0, -339.0, -372.0, -1406.0, 24.0, 90.0, 68.0, 200.0, 156.0, 24.0, -31.0, -31.0, 200.0, 200.0, 200.0, -196.0, 200.0, -724.0, -163.0, -163.0, -339.0, -944.0, -273.0, -240.0, 79.0, -746.0, 200.0, -141.0, -185.0, -284.0, 145.0, 24.0, -768.0, 145.0, -504.0, 200.0, -328.0, -471.0, -284.0, -460.0, -306.0, -284.0, -1439.0, -592.0, -251.0, -75.0, -581.0, -1373.0, -1593.0, -1769.0, -1175.0, -801.0, 167.0, -504.0, -801.0, -713.0, 200.0, -394.0, -823.0, 200.0, -1901.0, -1241.0, -1274.0, 145.0, -1241.0, -1263.0, -1296.0, -262.0, -64.0, -317.0, -1164.0, -1362.0, 79.0, -185.0, -570.0, -75.0, -691.0, -911.0, -911.0, 200.0, -988.0, 79.0, -273.0, -999.0, -405.0, -1076.0, -867.0, 200.0, -867.0, -1186.0, 79.0, -1538.0, -1527.0, -1252.0, -1098.0, -1417.0, -1527.0, -196.0, 200.0, -460.0, -658.0, 200.0, 178.0, -1021.0, -1054.0, -1318.0, -306.0, 200.0, -911.0, -20.0, -75.0, -790.0, -1120.0, -1428.0, -1395.0, -1868.0, -482.0, -75.0, -174.0, -823.0, -1648.0, -1263.0, -1296.0, -1186.0, -504.0, -163.0, 101.0, -284.0, -1021.0, -779.0, -416.0, -1032.0, -1131.0, -119.0, -548.0, -53.0, -1142.0, -1208.0, -1560.0, -1439.0, 2.0, -196.0, -845.0, 189.0, -1527.0, -526.0, -1285.0, -1021.0, -1318.0, -1417.0, -1296.0, -988.0, -207.0, -1208.0, -1879.0, 200.0, -1934.0, -955.0, -449.0, -702.0, 123.0, -1219.0, -416.0, -1054.0, -130.0, -1604.0, -1076.0, -1043.0, -581.0, 189.0, 90.0, -1615.0, -559.0, -1417.0, -1428.0, -339.0, -207.0, -515.0, -1329.0, -9.0, -768.0, -515.0, -592.0, -405.0, -955.0, -955.0, -1428.0, -1560.0, -570.0, -625.0, 200.0, -119.0, -471.0, 156.0, -196.0, -460.0, -1318.0, -779.0, -537.0, -1516.0, -218.0, -636.0, -493.0, 145.0, 57.0, -691.0, -625.0, -1846.0, 200.0, -614.0, -240.0, 24.0, 178.0, -86.0, -1956.0, -823.0, -537.0, -845.0, -1219.0, -1252.0, 200.0, -1670.0, -53.0], "policy_predator_policy_reward": [605.0, 545.0, 165.0, 800.0, 195.0, 25.0, 60.0, 100.0, 20.0, 355.0, 700.0, 265.0, 60.0, 535.0, 240.0, 190.0, 645.0, 190.0, 30.0, 535.0, 0.0, 255.0, 635.0, 525.0, 305.0, 0.0, 300.0, 185.0, 270.0, 685.0, 50.0, 25.0, 100.0, 570.0, 605.0, 295.0, 215.0, 130.0, 250.0, 430.0, 495.0, 175.0, 250.0, 845.0, 335.0, 730.0, 700.0, 365.0, 150.0, 65.0, 210.0, 850.0, 520.0, 165.0, 700.0, 265.0, 275.0, 190.0, 35.0, 370.0, 245.0, 130.0, 300.0, 220.0, 375.0, 0.0, 0.0, 1000.0, 160.0, 0.0, 560.0, 260.0, 80.0, 470.0, 395.0, 170.0, 325.0, 150.0, 750.0, 180.0, 360.0, 40.0, 80.0, 45.0, 25.0, 65.0, 0.0, 120.0, 0.0, 15.0, 0.0, 60.0, 170.0, 15.0, 440.0, 125.0, 0.0, 570.0, 0.0, 70.0, 0.0, 210.0, 105.0, 445.0, 135.0, 210.0, 250.0, 0.0, 460.0, 50.0, 130.0, 230.0, 145.0, 85.0, 45.0, 295.0, 435.0, 280.0, 620.0, 280.0, 170.0, 340.0, 185.0, 795.0, 565.0, 720.0, 920.0, 275.0, 400.0, 270.0, 520.0, 115.0, 0.0, 520.0, 0.0, 670.0, 485.0, 545.0, 335.0, 605.0, 465.0, 120.0, 675.0, 830.0, 425.0, 0.0, 130.0, 375.0, 395.0, 630.0, 280.0, 165.0, 70.0, 215.0, 530.0, 420.0, 535.0, 35.0, 50.0, 220.0, 520.0, 270.0, 195.0, 195.0, 575.0, 545.0, 495.0, 0.0, 875.0, 330.0, 770.0, 950.0, 0.0, 5.0, 310.0, 15.0, 95.0, 390.0, 0.0, 10.0, 635.0, 560.0, 610.0, 65.0, 0.0, 655.0, 85.0, 455.0, 60.0, 490.0, 825.0, 410.0, 665.0, 770.0, 465.0, 160.0, 625.0, 815.0, 540.0, 475.0, 705.0, 35.0, 155.0, 325.0, 500.0, 535.0, 160.0, 855.0, 220.0, 760.0, 105.0, 175.0, 230.0, 735.0, 410.0, 695.0, 530.0, 265.0, 310.0, 570.0, 505.0, 325.0, 400.0, 635.0, 470.0, 750.0, 720.0, 770.0, 530.0, 525.0, 370.0, 900.0, 895.0, 635.0, 405.0, 420.0, 525.0, 285.0, 670.0, 625.0, 0.0, 440.0, 855.0, 550.0, 45.0, 585.0, 345.0, 505.0, 770.0, 745.0, 450.0, 95.0, 250.0, 215.0, 315.0, 625.0, 480.0, 485.0, 535.0, 185.0, 315.0, 220.0, 625.0, 395.0, 590.0, 320.0, 670.0, 180.0, 155.0, 155.0, 160.0, 135.0, 305.0, 715.0, 430.0, 535.0, 545.0, 670.0, 525.0, 265.0, 40.0, 210.0, 790.0, 855.0, 895.0, 470.0, 315.0, 205.0, 165.0, 0.0, 45.0, 840.0, 870.0, 465.0, 490.0, 695.0, 615.0, 765.0, 520.0, 400.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0766912179562036, "mean_inference_ms": 1.689486664425405, "mean_action_processing_ms": 0.3784863470721497, "mean_env_wait_ms": 0.2688115981869124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008904695510864258, "StateBufferConnector_ms": 0.011627554893493652, "ViewRequirementAgentConnector_ms": 0.19119977951049805}, "num_episodes": 18, "episode_return_max": 481.0, "episode_return_min": -3509.0, "episode_return_mean": -667.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 51.77739426589329, "num_env_steps_trained_throughput_per_sec": 51.77739426589329, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 79421.766, "restore_workers_time_ms": 0.036, "training_step_time_ms": 79421.673, "sample_time_ms": 1671.305, "learn_time_ms": 77727.44, "learn_throughput": 51.462, "synch_weights_time_ms": 17.432}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "training_iteration": 7, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-25-50", "timestamp": 1723487150, "time_this_iter_s": 77.29272198677063, "time_total_s": 556.2329976558685, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32f77f310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 556.2329976558685, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 34.454545454545446, "ram_util_percent": 83.28454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0848356632687521, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.899436013580214, "policy_loss": -0.012227164725378794, "vf_loss": 7.910327265786786, "vf_explained_var": 0.00010640614844383078, "kl": 0.008906072118072907, "entropy": 1.5417432860702487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 21150.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1931920154720332, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.768412886950987, "policy_loss": -0.013388229635914009, "vf_loss": 9.77972543324139, "vf_explained_var": 0.0034029694313698626, "kl": 0.01037843546012227, "entropy": 1.526780311308854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 21150.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 470.0, "episode_reward_min": -3509.0, "episode_reward_mean": -736.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1956.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -633.4333333333333, "predator_policy": 388.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-844.0, -147.0, -254.0, -488.0, -3509.0, -780.0, -336.0, 288.0, -827.0, 347.0, 470.0, 273.0, 434.0, -107.0, -876.0, -154.0, -2.0, 136.0, 41.0, -172.0, -440.0, -849.0, -223.0, -1467.0, -2150.0, -233.0, -387.0, -824.0, -965.0, -2175.0, -88.0, -1047.0, -315.0, -1348.0, -89.0, -667.0, -778.0, -934.0, -2342.0, -3087.0, -36.0, 120.0, -1588.0, -297.0, -285.0, -2218.0, -525.0, -1045.0, -2025.0, -51.0, -889.0, -744.0, -210.0, -2070.0, -528.0, -783.0, -1327.0, -1791.0, -978.0, -1183.0, -756.0, 68.0, -1493.0, -1520.0, 284.0, -2114.0, -281.0, -516.0, -477.0, -2098.0, -1175.0, 100.0, 100.0, -954.0, -630.0, 224.0, -622.0, 336.0, 326.0, -1141.0, -1516.0, 162.0, 24.0, -1597.0, -1594.0, -561.0, -481.0, -803.0, -88.0, -1207.0, -743.0, -329.0, 81.0, -2105.0, 192.0, -852.0, -577.0, -1879.0, -1394.0, -626.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-713.0, -449.0, -922.0, 101.0, -603.0, -240.0, -141.0, -427.0, -361.0, -515.0, -284.0, -284.0, -1318.0, -1527.0, -1824.0, -119.0, -988.0, -493.0, 156.0, -922.0, -515.0, 200.0, 200.0, -757.0, -339.0, -372.0, -1406.0, 24.0, 90.0, 68.0, 200.0, 156.0, 24.0, -31.0, -31.0, 200.0, 200.0, 200.0, -196.0, 200.0, -724.0, -163.0, -163.0, -339.0, -944.0, -273.0, -240.0, 79.0, -746.0, 200.0, -141.0, -185.0, -284.0, 145.0, 24.0, -768.0, 145.0, -504.0, 200.0, -328.0, -471.0, -284.0, -460.0, -306.0, -284.0, -1439.0, -592.0, -251.0, -75.0, -581.0, -1373.0, -1593.0, -1769.0, -1175.0, -801.0, 167.0, -504.0, -801.0, -713.0, 200.0, -394.0, -823.0, 200.0, -1901.0, -1241.0, -1274.0, 145.0, -1241.0, -1263.0, -1296.0, -262.0, -64.0, -317.0, -1164.0, -1362.0, 79.0, -185.0, -570.0, -75.0, -691.0, -911.0, -911.0, 200.0, -988.0, 79.0, -273.0, -999.0, -405.0, -1076.0, -867.0, 200.0, -867.0, -1186.0, 79.0, -1538.0, -1527.0, -1252.0, -1098.0, -1417.0, -1527.0, -196.0, 200.0, -460.0, -658.0, 200.0, 178.0, -1021.0, -1054.0, -1318.0, -306.0, 200.0, -911.0, -20.0, -75.0, -790.0, -1120.0, -1428.0, -1395.0, -1868.0, -482.0, -75.0, -174.0, -823.0, -1648.0, -1263.0, -1296.0, -1186.0, -504.0, -163.0, 101.0, -284.0, -1021.0, -779.0, -416.0, -1032.0, -1131.0, -119.0, -548.0, -53.0, -1142.0, -1208.0, -1560.0, -1439.0, 2.0, -196.0, -845.0, 189.0, -1527.0, -526.0, -1285.0, -1021.0, -1318.0, -1417.0, -1296.0, -988.0, -207.0, -1208.0, -1879.0, 200.0, -1934.0, -955.0, -449.0, -702.0, 123.0, -1219.0, -416.0, -1054.0, -130.0, -1604.0, -1076.0, -1043.0, -581.0, 189.0, 90.0, -1615.0, -559.0, -1417.0, -1428.0, -339.0, -207.0, -515.0, -1329.0, -9.0, -768.0, -515.0, -592.0, -405.0, -955.0, -955.0, -1428.0, -1560.0, -570.0, -625.0, 200.0, -119.0, -471.0, 156.0, -196.0, -460.0, -1318.0, -779.0, -537.0, -1516.0, -218.0, -636.0, -493.0, 145.0, 57.0, -691.0, -625.0, -1846.0, 200.0, -614.0, -240.0, 24.0, 178.0, -86.0, -1956.0, -823.0, -537.0, -845.0, -1219.0, -1252.0, 200.0, -1670.0, -53.0, -416.0, -1802.0, 57.0, -1571.0, -416.0, -1340.0, -1384.0, -812.0, -823.0, -361.0, -603.0, -1582.0, -1285.0, -416.0, -130.0, -1197.0, -636.0, -295.0, 200.0, -1076.0, 13.0, -328.0, -581.0, -1153.0, -1780.0, -548.0, -130.0, -427.0, -1109.0, 2.0, -1032.0, 200.0, 178.0, -493.0, -1956.0, -1681.0, 200.0, -141.0, -317.0, -1450.0, -1197.0, 200.0, -812.0, -449.0, 24.0, -1582.0, -1340.0, -812.0, -1714.0, -845.0, -1010.0, -768.0, -196.0, -1252.0], "policy_predator_policy_reward": [700.0, 265.0, 275.0, 190.0, 35.0, 370.0, 245.0, 130.0, 300.0, 220.0, 375.0, 0.0, 0.0, 1000.0, 160.0, 0.0, 560.0, 260.0, 80.0, 470.0, 395.0, 170.0, 325.0, 150.0, 750.0, 180.0, 360.0, 40.0, 80.0, 45.0, 25.0, 65.0, 0.0, 120.0, 0.0, 15.0, 0.0, 60.0, 170.0, 15.0, 440.0, 125.0, 0.0, 570.0, 0.0, 70.0, 0.0, 210.0, 105.0, 445.0, 135.0, 210.0, 250.0, 0.0, 460.0, 50.0, 130.0, 230.0, 145.0, 85.0, 45.0, 295.0, 435.0, 280.0, 620.0, 280.0, 170.0, 340.0, 185.0, 795.0, 565.0, 720.0, 920.0, 275.0, 400.0, 270.0, 520.0, 115.0, 0.0, 520.0, 0.0, 670.0, 485.0, 545.0, 335.0, 605.0, 465.0, 120.0, 675.0, 830.0, 425.0, 0.0, 130.0, 375.0, 395.0, 630.0, 280.0, 165.0, 70.0, 215.0, 530.0, 420.0, 535.0, 35.0, 50.0, 220.0, 520.0, 270.0, 195.0, 195.0, 575.0, 545.0, 495.0, 0.0, 875.0, 330.0, 770.0, 950.0, 0.0, 5.0, 310.0, 15.0, 95.0, 390.0, 0.0, 10.0, 635.0, 560.0, 610.0, 65.0, 0.0, 655.0, 85.0, 455.0, 60.0, 490.0, 825.0, 410.0, 665.0, 770.0, 465.0, 160.0, 625.0, 815.0, 540.0, 475.0, 705.0, 35.0, 155.0, 325.0, 500.0, 535.0, 160.0, 855.0, 220.0, 760.0, 105.0, 175.0, 230.0, 735.0, 410.0, 695.0, 530.0, 265.0, 310.0, 570.0, 505.0, 325.0, 400.0, 635.0, 470.0, 750.0, 720.0, 770.0, 530.0, 525.0, 370.0, 900.0, 895.0, 635.0, 405.0, 420.0, 525.0, 285.0, 670.0, 625.0, 0.0, 440.0, 855.0, 550.0, 45.0, 585.0, 345.0, 505.0, 770.0, 745.0, 450.0, 95.0, 250.0, 215.0, 315.0, 625.0, 480.0, 485.0, 535.0, 185.0, 315.0, 220.0, 625.0, 395.0, 590.0, 320.0, 670.0, 180.0, 155.0, 155.0, 160.0, 135.0, 305.0, 715.0, 430.0, 535.0, 545.0, 670.0, 525.0, 265.0, 40.0, 210.0, 790.0, 855.0, 895.0, 470.0, 315.0, 205.0, 165.0, 0.0, 45.0, 840.0, 870.0, 465.0, 490.0, 695.0, 615.0, 765.0, 520.0, 400.0, 850.0, 540.0, 795.0, 430.0, 900.0, 400.0, 885.0, 500.0, 40.0, 955.0, 545.0, 485.0, 420.0, 490.0, 440.0, 400.0, 385.0, 540.0, 415.0, 190.0, 170.0, 0.0, 445.0, 410.0, 475.0, 765.0, 475.0, 380.0, 365.0, 460.0, 10.0, 490.0, 235.0, 950.0, 100.0, 975.0, 50.0, 180.0, 220.0, 615.0, 690.0, 290.0, 480.0, 55.0, 125.0, 465.0, 700.0, 690.0, 690.0, 765.0, 720.0, 710.0, 540.0, 340.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.082133869746012, "mean_inference_ms": 1.6851427946920936, "mean_action_processing_ms": 0.37582341941772834, "mean_env_wait_ms": 0.2673232395446734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008470773696899414, "StateBufferConnector_ms": 0.011965155601501465, "ViewRequirementAgentConnector_ms": 0.1976613998413086}, "num_episodes": 18, "episode_return_max": 470.0, "episode_return_min": -3509.0, "episode_return_mean": -736.0, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 52.07401226877358, "num_env_steps_trained_throughput_per_sec": 52.07401226877358, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 79095.765, "restore_workers_time_ms": 0.033, "training_step_time_ms": 79095.678, "sample_time_ms": 1636.228, "learn_time_ms": 77437.407, "learn_throughput": 51.655, "synch_weights_time_ms": 16.929}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 8, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-27-07", "timestamp": 1723487227, "time_this_iter_s": 76.84555792808533, "time_total_s": 633.0785555839539, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b106ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 633.0785555839539, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.49444444444445, "ram_util_percent": 83.30092592592592}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1391198002700265, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.251994339117767, "policy_loss": -0.01265570071908969, "vf_loss": 8.26307582331042, "vf_explained_var": -0.00021218165015497953, "kl": 0.010494588794299882, "entropy": 1.5231151924488393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 23970.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.198447704674504, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.696958614241147, "policy_loss": -0.012778580649954048, "vf_loss": 9.707919800535162, "vf_explained_var": 0.0036471317634514883, "kl": 0.00908701550067448, "entropy": 1.516495872642977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 23970.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "env_runners": {"episode_reward_max": 336.0, "episode_reward_min": -3087.0, "episode_reward_mean": -855.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1956.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -716.2633333333333, "predator_policy": 430.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-223.0, -1467.0, -2150.0, -233.0, -387.0, -824.0, -965.0, -2175.0, -88.0, -1047.0, -315.0, -1348.0, -89.0, -667.0, -778.0, -934.0, -2342.0, -3087.0, -36.0, 120.0, -1588.0, -297.0, -285.0, -2218.0, -525.0, -1045.0, -2025.0, -51.0, -889.0, -744.0, -210.0, -2070.0, -528.0, -783.0, -1327.0, -1791.0, -978.0, -1183.0, -756.0, 68.0, -1493.0, -1520.0, 284.0, -2114.0, -281.0, -516.0, -477.0, -2098.0, -1175.0, 100.0, 100.0, -954.0, -630.0, 224.0, -622.0, 336.0, 326.0, -1141.0, -1516.0, 162.0, 24.0, -1597.0, -1594.0, -561.0, -481.0, -803.0, -88.0, -1207.0, -743.0, -329.0, 81.0, -2105.0, 192.0, -852.0, -577.0, -1879.0, -1394.0, -626.0, -2683.0, -899.0, -1050.0, -2078.0, -429.0, 257.0, -591.0, -649.0, -683.0, -2050.0, -462.0, 236.0, -873.0, -672.0, -1038.0, -476.0, -1872.0, -45.0, 270.0, -1989.0, -1994.0, -20.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-592.0, -251.0, -75.0, -581.0, -1373.0, -1593.0, -1769.0, -1175.0, -801.0, 167.0, -504.0, -801.0, -713.0, 200.0, -394.0, -823.0, 200.0, -1901.0, -1241.0, -1274.0, 145.0, -1241.0, -1263.0, -1296.0, -262.0, -64.0, -317.0, -1164.0, -1362.0, 79.0, -185.0, -570.0, -75.0, -691.0, -911.0, -911.0, 200.0, -988.0, 79.0, -273.0, -999.0, -405.0, -1076.0, -867.0, 200.0, -867.0, -1186.0, 79.0, -1538.0, -1527.0, -1252.0, -1098.0, -1417.0, -1527.0, -196.0, 200.0, -460.0, -658.0, 200.0, 178.0, -1021.0, -1054.0, -1318.0, -306.0, 200.0, -911.0, -20.0, -75.0, -790.0, -1120.0, -1428.0, -1395.0, -1868.0, -482.0, -75.0, -174.0, -823.0, -1648.0, -1263.0, -1296.0, -1186.0, -504.0, -163.0, 101.0, -284.0, -1021.0, -779.0, -416.0, -1032.0, -1131.0, -119.0, -548.0, -53.0, -1142.0, -1208.0, -1560.0, -1439.0, 2.0, -196.0, -845.0, 189.0, -1527.0, -526.0, -1285.0, -1021.0, -1318.0, -1417.0, -1296.0, -988.0, -207.0, -1208.0, -1879.0, 200.0, -1934.0, -955.0, -449.0, -702.0, 123.0, -1219.0, -416.0, -1054.0, -130.0, -1604.0, -1076.0, -1043.0, -581.0, 189.0, 90.0, -1615.0, -559.0, -1417.0, -1428.0, -339.0, -207.0, -515.0, -1329.0, -9.0, -768.0, -515.0, -592.0, -405.0, -955.0, -955.0, -1428.0, -1560.0, -570.0, -625.0, 200.0, -119.0, -471.0, 156.0, -196.0, -460.0, -1318.0, -779.0, -537.0, -1516.0, -218.0, -636.0, -493.0, 145.0, 57.0, -691.0, -625.0, -1846.0, 200.0, -614.0, -240.0, 24.0, 178.0, -86.0, -1956.0, -823.0, -537.0, -845.0, -1219.0, -1252.0, 200.0, -1670.0, -53.0, -416.0, -1802.0, 57.0, -1571.0, -416.0, -1340.0, -1384.0, -812.0, -823.0, -361.0, -603.0, -1582.0, -1285.0, -416.0, -130.0, -1197.0, -636.0, -295.0, 200.0, -1076.0, 13.0, -328.0, -581.0, -1153.0, -1780.0, -548.0, -130.0, -427.0, -1109.0, 2.0, -1032.0, 200.0, 178.0, -493.0, -1956.0, -1681.0, 200.0, -141.0, -317.0, -1450.0, -1197.0, 200.0, -812.0, -449.0, 24.0, -1582.0, -1340.0, -812.0, -1714.0, -845.0, -1010.0, -768.0, -196.0, -1252.0, -1230.0, -900.0, -1373.0, -713.0, -1175.0, 24.0, -801.0, -1384.0, 200.0, -1395.0, -1219.0, -1384.0, 24.0, -1142.0, -856.0, -97.0, -361.0, 200.0, -427.0, -636.0, -1098.0, -768.0, -1032.0, -229.0, -75.0, -1472.0, -31.0, -1120.0, -878.0, -1692.0, -416.0, -834.0, -42.0, 46.0, -1450.0, 145.0, -438.0, -1736.0, -229.0, -889.0, -405.0, -163.0, -801.0, -240.0, -1032.0, -1648.0, -64.0, -64.0, -1340.0, -1307.0, -955.0, -1043.0, 200.0, -42.0, 46.0, 2.0, 57.0, -889.0, -1648.0, -1857.0, -977.0, -977.0, -1230.0, 79.0, -1747.0, 68.0], "policy_predator_policy_reward": [170.0, 340.0, 185.0, 795.0, 565.0, 720.0, 920.0, 275.0, 400.0, 270.0, 520.0, 115.0, 0.0, 520.0, 0.0, 670.0, 485.0, 545.0, 335.0, 605.0, 465.0, 120.0, 675.0, 830.0, 425.0, 0.0, 130.0, 375.0, 395.0, 630.0, 280.0, 165.0, 70.0, 215.0, 530.0, 420.0, 535.0, 35.0, 50.0, 220.0, 520.0, 270.0, 195.0, 195.0, 575.0, 545.0, 495.0, 0.0, 875.0, 330.0, 770.0, 950.0, 0.0, 5.0, 310.0, 15.0, 95.0, 390.0, 0.0, 10.0, 635.0, 560.0, 610.0, 65.0, 0.0, 655.0, 85.0, 455.0, 60.0, 490.0, 825.0, 410.0, 665.0, 770.0, 465.0, 160.0, 625.0, 815.0, 540.0, 475.0, 705.0, 35.0, 155.0, 325.0, 500.0, 535.0, 160.0, 855.0, 220.0, 760.0, 105.0, 175.0, 230.0, 735.0, 410.0, 695.0, 530.0, 265.0, 310.0, 570.0, 505.0, 325.0, 400.0, 635.0, 470.0, 750.0, 720.0, 770.0, 530.0, 525.0, 370.0, 900.0, 895.0, 635.0, 405.0, 420.0, 525.0, 285.0, 670.0, 625.0, 0.0, 440.0, 855.0, 550.0, 45.0, 585.0, 345.0, 505.0, 770.0, 745.0, 450.0, 95.0, 250.0, 215.0, 315.0, 625.0, 480.0, 485.0, 535.0, 185.0, 315.0, 220.0, 625.0, 395.0, 590.0, 320.0, 670.0, 180.0, 155.0, 155.0, 160.0, 135.0, 305.0, 715.0, 430.0, 535.0, 545.0, 670.0, 525.0, 265.0, 40.0, 210.0, 790.0, 855.0, 895.0, 470.0, 315.0, 205.0, 165.0, 0.0, 45.0, 840.0, 870.0, 465.0, 490.0, 695.0, 615.0, 765.0, 520.0, 400.0, 850.0, 540.0, 795.0, 430.0, 900.0, 400.0, 885.0, 500.0, 40.0, 955.0, 545.0, 485.0, 420.0, 490.0, 440.0, 400.0, 385.0, 540.0, 415.0, 190.0, 170.0, 0.0, 445.0, 410.0, 475.0, 765.0, 475.0, 380.0, 365.0, 460.0, 10.0, 490.0, 235.0, 950.0, 100.0, 975.0, 50.0, 180.0, 220.0, 615.0, 690.0, 290.0, 480.0, 55.0, 125.0, 465.0, 700.0, 690.0, 690.0, 765.0, 720.0, 710.0, 540.0, 340.0, 30.0, 785.0, 5.0, 360.0, 285.0, 320.0, 150.0, 685.0, 100.0, 595.0, 655.0, 670.0, 505.0, 635.0, 405.0, 65.0, 365.0, 85.0, 605.0, 525.0, 440.0, 200.0, 485.0, 695.0, 0.0, 135.0, 760.0, 440.0, 355.0, 845.0, 270.0, 470.0, 90.0, 575.0, 460.0, 460.0, 530.0, 450.0, 550.0, 495.0, 135.0, 155.0, 605.0, 240.0, 190.0, 320.0, 740.0, 240.0, 725.0, 530.0, 475.0, 30.0, 495.0, 315.0, 120.0, 15.0, 30.0, 810.0, 915.0, 680.0, 615.0, 0.0, 575.0, 805.0, 220.0, 555.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0876638793404976, "mean_inference_ms": 1.6843004709247122, "mean_action_processing_ms": 0.37372747138377543, "mean_env_wait_ms": 0.2655992946300594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007344484329223633, "StateBufferConnector_ms": 0.005692005157470703, "ViewRequirementAgentConnector_ms": 0.19918954372406006}, "num_episodes": 22, "episode_return_max": 336.0, "episode_return_min": -3087.0, "episode_return_mean": -855.94, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 50.95632789124713, "num_env_steps_trained_throughput_per_sec": 50.95632789124713, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 79029.413, "restore_workers_time_ms": 0.031, "training_step_time_ms": 79029.329, "sample_time_ms": 1618.327, "learn_time_ms": 77388.489, "learn_throughput": 51.687, "synch_weights_time_ms": 17.085}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "training_iteration": 9, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-28-25", "timestamp": 1723487305, "time_this_iter_s": 78.53705382347107, "time_total_s": 711.6156094074249, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32f77fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 711.6156094074249, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 39.38558558558559, "ram_util_percent": 83.18288288288286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1563282700506508, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.151391486242308, "policy_loss": -0.011841817224870523, "vf_loss": 7.16164071695179, "vf_explained_var": -8.993810372995147e-05, "kl": 0.010617285721554445, "entropy": 1.5109217305132683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 26790.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.5976349494981426, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.628000631738216, "policy_loss": -0.013909520640232806, "vf_loss": 9.639627731607316, "vf_explained_var": 0.005070908293656424, "kl": 0.011412127705272113, "entropy": 1.504864124752951, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 26790.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 531.0, "episode_reward_min": -2683.0, "episode_reward_mean": -788.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1956.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -704.1633333333333, "predator_policy": 441.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2218.0, -525.0, -1045.0, -2025.0, -51.0, -889.0, -744.0, -210.0, -2070.0, -528.0, -783.0, -1327.0, -1791.0, -978.0, -1183.0, -756.0, 68.0, -1493.0, -1520.0, 284.0, -2114.0, -281.0, -516.0, -477.0, -2098.0, -1175.0, 100.0, 100.0, -954.0, -630.0, 224.0, -622.0, 336.0, 326.0, -1141.0, -1516.0, 162.0, 24.0, -1597.0, -1594.0, -561.0, -481.0, -803.0, -88.0, -1207.0, -743.0, -329.0, 81.0, -2105.0, 192.0, -852.0, -577.0, -1879.0, -1394.0, -626.0, -2683.0, -899.0, -1050.0, -2078.0, -429.0, 257.0, -591.0, -649.0, -683.0, -2050.0, -462.0, 236.0, -873.0, -672.0, -1038.0, -476.0, -1872.0, -45.0, 270.0, -1989.0, -1994.0, -20.0, -1283.0, 531.0, -306.0, -2187.0, -235.0, -395.0, -837.0, -930.0, -562.0, -1513.0, -74.0, 15.0, -2645.0, -495.0, -411.0, 121.0, -644.0, -1747.0, -54.0, 467.0, -525.0, -378.0, -338.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1120.0, -1428.0, -1395.0, -1868.0, -482.0, -75.0, -174.0, -823.0, -1648.0, -1263.0, -1296.0, -1186.0, -504.0, -163.0, 101.0, -284.0, -1021.0, -779.0, -416.0, -1032.0, -1131.0, -119.0, -548.0, -53.0, -1142.0, -1208.0, -1560.0, -1439.0, 2.0, -196.0, -845.0, 189.0, -1527.0, -526.0, -1285.0, -1021.0, -1318.0, -1417.0, -1296.0, -988.0, -207.0, -1208.0, -1879.0, 200.0, -1934.0, -955.0, -449.0, -702.0, 123.0, -1219.0, -416.0, -1054.0, -130.0, -1604.0, -1076.0, -1043.0, -581.0, 189.0, 90.0, -1615.0, -559.0, -1417.0, -1428.0, -339.0, -207.0, -515.0, -1329.0, -9.0, -768.0, -515.0, -592.0, -405.0, -955.0, -955.0, -1428.0, -1560.0, -570.0, -625.0, 200.0, -119.0, -471.0, 156.0, -196.0, -460.0, -1318.0, -779.0, -537.0, -1516.0, -218.0, -636.0, -493.0, 145.0, 57.0, -691.0, -625.0, -1846.0, 200.0, -614.0, -240.0, 24.0, 178.0, -86.0, -1956.0, -823.0, -537.0, -845.0, -1219.0, -1252.0, 200.0, -1670.0, -53.0, -416.0, -1802.0, 57.0, -1571.0, -416.0, -1340.0, -1384.0, -812.0, -823.0, -361.0, -603.0, -1582.0, -1285.0, -416.0, -130.0, -1197.0, -636.0, -295.0, 200.0, -1076.0, 13.0, -328.0, -581.0, -1153.0, -1780.0, -548.0, -130.0, -427.0, -1109.0, 2.0, -1032.0, 200.0, 178.0, -493.0, -1956.0, -1681.0, 200.0, -141.0, -317.0, -1450.0, -1197.0, 200.0, -812.0, -449.0, 24.0, -1582.0, -1340.0, -812.0, -1714.0, -845.0, -1010.0, -768.0, -196.0, -1252.0, -1230.0, -900.0, -1373.0, -713.0, -1175.0, 24.0, -801.0, -1384.0, 200.0, -1395.0, -1219.0, -1384.0, 24.0, -1142.0, -856.0, -97.0, -361.0, 200.0, -427.0, -636.0, -1098.0, -768.0, -1032.0, -229.0, -75.0, -1472.0, -31.0, -1120.0, -878.0, -1692.0, -416.0, -834.0, -42.0, 46.0, -1450.0, 145.0, -438.0, -1736.0, -229.0, -889.0, -405.0, -163.0, -801.0, -240.0, -1032.0, -1648.0, -64.0, -64.0, -1340.0, -1307.0, -955.0, -1043.0, 200.0, -42.0, 46.0, 2.0, 57.0, -889.0, -1648.0, -1857.0, -977.0, -977.0, -1230.0, 79.0, -1747.0, 68.0, -1703.0, -757.0, -713.0, 200.0, -779.0, 200.0, 90.0, -1351.0, 200.0, -1340.0, -1153.0, -1549.0, -999.0, -416.0, 200.0, -119.0, -1527.0, -284.0, -119.0, -515.0, -1428.0, 2.0, -1813.0, -669.0, -1164.0, 79.0, -702.0, -1934.0, -1098.0, 24.0, 46.0, -328.0, -317.0, 200.0, 145.0, -1835.0, -1329.0, -735.0, -1571.0, -1604.0, 189.0, -350.0, -493.0, -1285.0, 2.0, 200.0, -1934.0, 200.0, 24.0, -713.0, -845.0, -724.0, -1538.0, -845.0, -438.0, -922.0, 101.0, -53.0, 200.0, 200.0, -1153.0, -1307.0, 200.0, -97.0, -1076.0, -20.0, -372.0, -1010.0, 79.0], "policy_predator_policy_reward": [490.0, 825.0, 410.0, 665.0, 770.0, 465.0, 160.0, 625.0, 815.0, 540.0, 475.0, 705.0, 35.0, 155.0, 325.0, 500.0, 535.0, 160.0, 855.0, 220.0, 760.0, 105.0, 175.0, 230.0, 735.0, 410.0, 695.0, 530.0, 265.0, 310.0, 570.0, 505.0, 325.0, 400.0, 635.0, 470.0, 750.0, 720.0, 770.0, 530.0, 525.0, 370.0, 900.0, 895.0, 635.0, 405.0, 420.0, 525.0, 285.0, 670.0, 625.0, 0.0, 440.0, 855.0, 550.0, 45.0, 585.0, 345.0, 505.0, 770.0, 745.0, 450.0, 95.0, 250.0, 215.0, 315.0, 625.0, 480.0, 485.0, 535.0, 185.0, 315.0, 220.0, 625.0, 395.0, 590.0, 320.0, 670.0, 180.0, 155.0, 155.0, 160.0, 135.0, 305.0, 715.0, 430.0, 535.0, 545.0, 670.0, 525.0, 265.0, 40.0, 210.0, 790.0, 855.0, 895.0, 470.0, 315.0, 205.0, 165.0, 0.0, 45.0, 840.0, 870.0, 465.0, 490.0, 695.0, 615.0, 765.0, 520.0, 400.0, 850.0, 540.0, 795.0, 430.0, 900.0, 400.0, 885.0, 500.0, 40.0, 955.0, 545.0, 485.0, 420.0, 490.0, 440.0, 400.0, 385.0, 540.0, 415.0, 190.0, 170.0, 0.0, 445.0, 410.0, 475.0, 765.0, 475.0, 380.0, 365.0, 460.0, 10.0, 490.0, 235.0, 950.0, 100.0, 975.0, 50.0, 180.0, 220.0, 615.0, 690.0, 290.0, 480.0, 55.0, 125.0, 465.0, 700.0, 690.0, 690.0, 765.0, 720.0, 710.0, 540.0, 340.0, 30.0, 785.0, 5.0, 360.0, 285.0, 320.0, 150.0, 685.0, 100.0, 595.0, 655.0, 670.0, 505.0, 635.0, 405.0, 65.0, 365.0, 85.0, 605.0, 525.0, 440.0, 200.0, 485.0, 695.0, 0.0, 135.0, 760.0, 440.0, 355.0, 845.0, 270.0, 470.0, 90.0, 575.0, 460.0, 460.0, 530.0, 450.0, 550.0, 495.0, 135.0, 155.0, 605.0, 240.0, 190.0, 320.0, 740.0, 240.0, 725.0, 530.0, 475.0, 30.0, 495.0, 315.0, 120.0, 15.0, 30.0, 810.0, 915.0, 680.0, 615.0, 0.0, 575.0, 805.0, 220.0, 555.0, 620.0, 805.0, 465.0, 395.0, 80.0, 435.0, 705.0, 50.0, 0.0, 780.0, 600.0, 475.0, 390.0, 300.0, 290.0, 580.0, 605.0, 350.0, 650.0, 185.0, 390.0, 255.0, 440.0, 855.0, 620.0, 290.0, 315.0, 100.0, 450.0, 945.0, 275.0, 235.0, 15.0, 25.0, 695.0, 785.0, 0.0, 990.0, 0.0, 240.0, 710.0, 320.0, 590.0, 275.0, 500.0, 550.0, 800.0, 305.0, 235.0, 490.0, 165.0, 90.0, 810.0, 460.0, 400.0, 415.0, 390.0, 0.0, 10.0, 110.0, 660.0, 660.0, 415.0, 100.0, 595.0, 120.0, 560.0, 245.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.061858784111101, "mean_inference_ms": 1.6665007826471483, "mean_action_processing_ms": 0.3706472621426488, "mean_env_wait_ms": 0.26375007436413456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005043148994445801, "StateBufferConnector_ms": 0.004637241363525391, "ViewRequirementAgentConnector_ms": 0.18343496322631836}, "num_episodes": 23, "episode_return_max": 531.0, "episode_return_min": -2683.0, "episode_return_mean": -788.14, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 50.894888652733414, "num_env_steps_trained_throughput_per_sec": 50.894888652733414, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 78985.808, "restore_workers_time_ms": 0.029, "training_step_time_ms": 78985.727, "sample_time_ms": 1599.656, "learn_time_ms": 77363.991, "learn_throughput": 51.704, "synch_weights_time_ms": 16.766}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 10, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-29-44", "timestamp": 1723487384, "time_this_iter_s": 78.62226581573486, "time_total_s": 790.2378752231598, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b104ca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 790.2378752231598, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 39.06250000000001, "ram_util_percent": 83.13928571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.144120765588385, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.99675633256317, "policy_loss": -0.012482792478887008, "vf_loss": 5.007741140473819, "vf_explained_var": -0.0001743953067360195, "kl": 0.009986569696807012, "entropy": 1.4979629724160999, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 29610.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.13575749748142, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.418526313321811, "policy_loss": -0.013883382661089776, "vf_loss": 9.430142225103175, "vf_explained_var": 0.007057061516646798, "kl": 0.011337358699334242, "entropy": 1.5018432948606235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 29610.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "env_runners": {"episode_reward_max": 531.0, "episode_reward_min": -2683.0, "episode_reward_mean": -616.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1956.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -596.9866666666667, "predator_policy": 391.53333333333336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1520.0, 284.0, -2114.0, -281.0, -516.0, -477.0, -2098.0, -1175.0, 100.0, 100.0, -954.0, -630.0, 224.0, -622.0, 336.0, 326.0, -1141.0, -1516.0, 162.0, 24.0, -1597.0, -1594.0, -561.0, -481.0, -803.0, -88.0, -1207.0, -743.0, -329.0, 81.0, -2105.0, 192.0, -852.0, -577.0, -1879.0, -1394.0, -626.0, -2683.0, -899.0, -1050.0, -2078.0, -429.0, 257.0, -591.0, -649.0, -683.0, -2050.0, -462.0, 236.0, -873.0, -672.0, -1038.0, -476.0, -1872.0, -45.0, 270.0, -1989.0, -1994.0, -20.0, -1283.0, 531.0, -306.0, -2187.0, -235.0, -395.0, -837.0, -930.0, -562.0, -1513.0, -74.0, 15.0, -2645.0, -495.0, -411.0, 121.0, -644.0, -1747.0, -54.0, 467.0, -525.0, -378.0, -338.0, 324.0, 401.0, -544.0, 150.0, -736.0, -118.0, -735.0, -623.0, 404.0, 77.0, -736.0, 250.0, 125.0, 174.0, 65.0, -651.0, 390.0, 413.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1076.0, -1043.0, -581.0, 189.0, 90.0, -1615.0, -559.0, -1417.0, -1428.0, -339.0, -207.0, -515.0, -1329.0, -9.0, -768.0, -515.0, -592.0, -405.0, -955.0, -955.0, -1428.0, -1560.0, -570.0, -625.0, 200.0, -119.0, -471.0, 156.0, -196.0, -460.0, -1318.0, -779.0, -537.0, -1516.0, -218.0, -636.0, -493.0, 145.0, 57.0, -691.0, -625.0, -1846.0, 200.0, -614.0, -240.0, 24.0, 178.0, -86.0, -1956.0, -823.0, -537.0, -845.0, -1219.0, -1252.0, 200.0, -1670.0, -53.0, -416.0, -1802.0, 57.0, -1571.0, -416.0, -1340.0, -1384.0, -812.0, -823.0, -361.0, -603.0, -1582.0, -1285.0, -416.0, -130.0, -1197.0, -636.0, -295.0, 200.0, -1076.0, 13.0, -328.0, -581.0, -1153.0, -1780.0, -548.0, -130.0, -427.0, -1109.0, 2.0, -1032.0, 200.0, 178.0, -493.0, -1956.0, -1681.0, 200.0, -141.0, -317.0, -1450.0, -1197.0, 200.0, -812.0, -449.0, 24.0, -1582.0, -1340.0, -812.0, -1714.0, -845.0, -1010.0, -768.0, -196.0, -1252.0, -1230.0, -900.0, -1373.0, -713.0, -1175.0, 24.0, -801.0, -1384.0, 200.0, -1395.0, -1219.0, -1384.0, 24.0, -1142.0, -856.0, -97.0, -361.0, 200.0, -427.0, -636.0, -1098.0, -768.0, -1032.0, -229.0, -75.0, -1472.0, -31.0, -1120.0, -878.0, -1692.0, -416.0, -834.0, -42.0, 46.0, -1450.0, 145.0, -438.0, -1736.0, -229.0, -889.0, -405.0, -163.0, -801.0, -240.0, -1032.0, -1648.0, -64.0, -64.0, -1340.0, -1307.0, -955.0, -1043.0, 200.0, -42.0, 46.0, 2.0, 57.0, -889.0, -1648.0, -1857.0, -977.0, -977.0, -1230.0, 79.0, -1747.0, 68.0, -1703.0, -757.0, -713.0, 200.0, -779.0, 200.0, 90.0, -1351.0, 200.0, -1340.0, -1153.0, -1549.0, -999.0, -416.0, 200.0, -119.0, -1527.0, -284.0, -119.0, -515.0, -1428.0, 2.0, -1813.0, -669.0, -1164.0, 79.0, -702.0, -1934.0, -1098.0, 24.0, 46.0, -328.0, -317.0, 200.0, 145.0, -1835.0, -1329.0, -735.0, -1571.0, -1604.0, 189.0, -350.0, -493.0, -1285.0, 2.0, 200.0, -1934.0, 200.0, 24.0, -713.0, -845.0, -724.0, -1538.0, -845.0, -438.0, -922.0, 101.0, -53.0, 200.0, 200.0, -1153.0, -1307.0, 200.0, -97.0, -1076.0, -20.0, -372.0, -1010.0, 79.0, 79.0, -570.0, 200.0, 200.0, 57.0, -361.0, 145.0, -1351.0, -493.0, -42.0, -350.0, -108.0, -735.0, -53.0, -1098.0, -42.0, 35.0, -636.0, 13.0, -724.0, -1274.0, -130.0, -394.0, -1109.0, 200.0, -9.0, 68.0, 90.0, -570.0, 57.0, -1120.0, -1175.0, 189.0, 167.0, 112.0, -1054.0, -416.0, 156.0, -75.0, -581.0, 200.0, 200.0, 13.0, -361.0, 123.0, 200.0, -856.0, -845.0, 200.0, -185.0, 200.0, -108.0, 200.0, 156.0], "policy_predator_policy_reward": [550.0, 45.0, 585.0, 345.0, 505.0, 770.0, 745.0, 450.0, 95.0, 250.0, 215.0, 315.0, 625.0, 480.0, 485.0, 535.0, 185.0, 315.0, 220.0, 625.0, 395.0, 590.0, 320.0, 670.0, 180.0, 155.0, 155.0, 160.0, 135.0, 305.0, 715.0, 430.0, 535.0, 545.0, 670.0, 525.0, 265.0, 40.0, 210.0, 790.0, 855.0, 895.0, 470.0, 315.0, 205.0, 165.0, 0.0, 45.0, 840.0, 870.0, 465.0, 490.0, 695.0, 615.0, 765.0, 520.0, 400.0, 850.0, 540.0, 795.0, 430.0, 900.0, 400.0, 885.0, 500.0, 40.0, 955.0, 545.0, 485.0, 420.0, 490.0, 440.0, 400.0, 385.0, 540.0, 415.0, 190.0, 170.0, 0.0, 445.0, 410.0, 475.0, 765.0, 475.0, 380.0, 365.0, 460.0, 10.0, 490.0, 235.0, 950.0, 100.0, 975.0, 50.0, 180.0, 220.0, 615.0, 690.0, 290.0, 480.0, 55.0, 125.0, 465.0, 700.0, 690.0, 690.0, 765.0, 720.0, 710.0, 540.0, 340.0, 30.0, 785.0, 5.0, 360.0, 285.0, 320.0, 150.0, 685.0, 100.0, 595.0, 655.0, 670.0, 505.0, 635.0, 405.0, 65.0, 365.0, 85.0, 605.0, 525.0, 440.0, 200.0, 485.0, 695.0, 0.0, 135.0, 760.0, 440.0, 355.0, 845.0, 270.0, 470.0, 90.0, 575.0, 460.0, 460.0, 530.0, 450.0, 550.0, 495.0, 135.0, 155.0, 605.0, 240.0, 190.0, 320.0, 740.0, 240.0, 725.0, 530.0, 475.0, 30.0, 495.0, 315.0, 120.0, 15.0, 30.0, 810.0, 915.0, 680.0, 615.0, 0.0, 575.0, 805.0, 220.0, 555.0, 620.0, 805.0, 465.0, 395.0, 80.0, 435.0, 705.0, 50.0, 0.0, 780.0, 600.0, 475.0, 390.0, 300.0, 290.0, 580.0, 605.0, 350.0, 650.0, 185.0, 390.0, 255.0, 440.0, 855.0, 620.0, 290.0, 315.0, 100.0, 450.0, 945.0, 275.0, 235.0, 15.0, 25.0, 695.0, 785.0, 0.0, 990.0, 0.0, 240.0, 710.0, 320.0, 590.0, 275.0, 500.0, 550.0, 800.0, 305.0, 235.0, 490.0, 165.0, 90.0, 810.0, 460.0, 400.0, 415.0, 390.0, 0.0, 10.0, 110.0, 660.0, 660.0, 415.0, 100.0, 595.0, 120.0, 560.0, 245.0, 160.0, 125.0, 245.0, 245.0, 90.0, 270.0, 145.0, 315.0, 150.0, 690.0, 310.0, 200.0, 140.0, 370.0, 300.0, 480.0, 460.0, 0.0, 65.0, 0.0, 810.0, 440.0, 325.0, 535.0, 150.0, 30.0, 55.0, 60.0, 335.0, 0.0, 165.0, 345.0, 570.0, 455.0, 260.0, 385.0, 380.0, 55.0, 385.0, 20.0, 0.0, 160.0, 195.0, 35.0, 255.0, 0.0, 170.0, 120.0, 560.0, 40.0, 135.0, 0.0, 20.0, 135.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.049912319424661, "mean_inference_ms": 1.6609835898053251, "mean_action_processing_ms": 0.3695911862563953, "mean_env_wait_ms": 0.2624624856832826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005100607872009277, "StateBufferConnector_ms": 0.004763245582580566, "ViewRequirementAgentConnector_ms": 0.1685851812362671}, "num_episodes": 18, "episode_return_max": 531.0, "episode_return_min": -2683.0, "episode_return_mean": -616.36, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 49.48305108311126, "num_env_steps_trained_throughput_per_sec": 49.48305108311126, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 79208.671, "restore_workers_time_ms": 0.029, "training_step_time_ms": 79208.595, "sample_time_ms": 1598.594, "learn_time_ms": 77588.486, "learn_throughput": 51.554, "synch_weights_time_ms": 16.714}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "training_iteration": 11, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-31-05", "timestamp": 1723487465, "time_this_iter_s": 80.8710868358612, "time_total_s": 871.108962059021, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b106ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 871.108962059021, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 39.88521739130435, "ram_util_percent": 83.32956521739129}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.217967621104937, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.319203426567375, "policy_loss": -0.011619706951075148, "vf_loss": 4.329225163172323, "vf_explained_var": -1.8410860223973052e-06, "kl": 0.010653143686007296, "entropy": 1.4802005966927143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 32430.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.09341114214126, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.721808883146192, "policy_loss": -0.014599843222502592, "vf_loss": 8.73418364068295, "vf_explained_var": 0.008005447696286735, "kl": 0.011125445737685431, "entropy": 1.489238967371325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 32430.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 594.0, "episode_reward_min": -2683.0, "episode_reward_mean": -521.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1956.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -528.7866666666666, "predator_policy": 354.96666666666664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [162.0, 24.0, -1597.0, -1594.0, -561.0, -481.0, -803.0, -88.0, -1207.0, -743.0, -329.0, 81.0, -2105.0, 192.0, -852.0, -577.0, -1879.0, -1394.0, -626.0, -2683.0, -899.0, -1050.0, -2078.0, -429.0, 257.0, -591.0, -649.0, -683.0, -2050.0, -462.0, 236.0, -873.0, -672.0, -1038.0, -476.0, -1872.0, -45.0, 270.0, -1989.0, -1994.0, -20.0, -1283.0, 531.0, -306.0, -2187.0, -235.0, -395.0, -837.0, -930.0, -562.0, -1513.0, -74.0, 15.0, -2645.0, -495.0, -411.0, 121.0, -644.0, -1747.0, -54.0, 467.0, -525.0, -378.0, -338.0, 324.0, 401.0, -544.0, 150.0, -736.0, -118.0, -735.0, -623.0, 404.0, 77.0, -736.0, 250.0, 125.0, 174.0, 65.0, -651.0, 390.0, 413.0, -1063.0, 183.0, -236.0, -278.0, -831.0, -136.0, -471.0, -504.0, 366.0, 594.0, 484.0, -220.0, 46.0, 434.0, 120.0, 399.0, -623.0, -448.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -1670.0, -53.0, -416.0, -1802.0, 57.0, -1571.0, -416.0, -1340.0, -1384.0, -812.0, -823.0, -361.0, -603.0, -1582.0, -1285.0, -416.0, -130.0, -1197.0, -636.0, -295.0, 200.0, -1076.0, 13.0, -328.0, -581.0, -1153.0, -1780.0, -548.0, -130.0, -427.0, -1109.0, 2.0, -1032.0, 200.0, 178.0, -493.0, -1956.0, -1681.0, 200.0, -141.0, -317.0, -1450.0, -1197.0, 200.0, -812.0, -449.0, 24.0, -1582.0, -1340.0, -812.0, -1714.0, -845.0, -1010.0, -768.0, -196.0, -1252.0, -1230.0, -900.0, -1373.0, -713.0, -1175.0, 24.0, -801.0, -1384.0, 200.0, -1395.0, -1219.0, -1384.0, 24.0, -1142.0, -856.0, -97.0, -361.0, 200.0, -427.0, -636.0, -1098.0, -768.0, -1032.0, -229.0, -75.0, -1472.0, -31.0, -1120.0, -878.0, -1692.0, -416.0, -834.0, -42.0, 46.0, -1450.0, 145.0, -438.0, -1736.0, -229.0, -889.0, -405.0, -163.0, -801.0, -240.0, -1032.0, -1648.0, -64.0, -64.0, -1340.0, -1307.0, -955.0, -1043.0, 200.0, -42.0, 46.0, 2.0, 57.0, -889.0, -1648.0, -1857.0, -977.0, -977.0, -1230.0, 79.0, -1747.0, 68.0, -1703.0, -757.0, -713.0, 200.0, -779.0, 200.0, 90.0, -1351.0, 200.0, -1340.0, -1153.0, -1549.0, -999.0, -416.0, 200.0, -119.0, -1527.0, -284.0, -119.0, -515.0, -1428.0, 2.0, -1813.0, -669.0, -1164.0, 79.0, -702.0, -1934.0, -1098.0, 24.0, 46.0, -328.0, -317.0, 200.0, 145.0, -1835.0, -1329.0, -735.0, -1571.0, -1604.0, 189.0, -350.0, -493.0, -1285.0, 2.0, 200.0, -1934.0, 200.0, 24.0, -713.0, -845.0, -724.0, -1538.0, -845.0, -438.0, -922.0, 101.0, -53.0, 200.0, 200.0, -1153.0, -1307.0, 200.0, -97.0, -1076.0, -20.0, -372.0, -1010.0, 79.0, 79.0, -570.0, 200.0, 200.0, 57.0, -361.0, 145.0, -1351.0, -493.0, -42.0, -350.0, -108.0, -735.0, -53.0, -1098.0, -42.0, 35.0, -636.0, 13.0, -724.0, -1274.0, -130.0, -394.0, -1109.0, 200.0, -9.0, 68.0, 90.0, -570.0, 57.0, -1120.0, -1175.0, 189.0, 167.0, 112.0, -1054.0, -416.0, 156.0, -75.0, -581.0, 200.0, 200.0, 13.0, -361.0, 123.0, 200.0, -856.0, -845.0, 200.0, -185.0, 200.0, -108.0, 200.0, 156.0, -779.0, -1109.0, 200.0, 112.0, -878.0, 134.0, -724.0, -20.0, -42.0, -427.0, 13.0, -944.0, -845.0, -438.0, -823.0, -20.0, -988.0, 57.0, -130.0, 101.0, -1527.0, -768.0, -240.0, -361.0, -64.0, 189.0, -9.0, 189.0, 200.0, 200.0, -20.0, 189.0, 145.0, -460.0, -53.0, -317.0, 189.0, 112.0, -1065.0, 178.0, -394.0, 145.0, 200.0, -141.0, -119.0, -361.0, 200.0, 200.0, -988.0, -1054.0, 24.0, 167.0, -372.0, -933.0], "policy_predator_policy_reward": [765.0, 520.0, 400.0, 850.0, 540.0, 795.0, 430.0, 900.0, 400.0, 885.0, 500.0, 40.0, 955.0, 545.0, 485.0, 420.0, 490.0, 440.0, 400.0, 385.0, 540.0, 415.0, 190.0, 170.0, 0.0, 445.0, 410.0, 475.0, 765.0, 475.0, 380.0, 365.0, 460.0, 10.0, 490.0, 235.0, 950.0, 100.0, 975.0, 50.0, 180.0, 220.0, 615.0, 690.0, 290.0, 480.0, 55.0, 125.0, 465.0, 700.0, 690.0, 690.0, 765.0, 720.0, 710.0, 540.0, 340.0, 30.0, 785.0, 5.0, 360.0, 285.0, 320.0, 150.0, 685.0, 100.0, 595.0, 655.0, 670.0, 505.0, 635.0, 405.0, 65.0, 365.0, 85.0, 605.0, 525.0, 440.0, 200.0, 485.0, 695.0, 0.0, 135.0, 760.0, 440.0, 355.0, 845.0, 270.0, 470.0, 90.0, 575.0, 460.0, 460.0, 530.0, 450.0, 550.0, 495.0, 135.0, 155.0, 605.0, 240.0, 190.0, 320.0, 740.0, 240.0, 725.0, 530.0, 475.0, 30.0, 495.0, 315.0, 120.0, 15.0, 30.0, 810.0, 915.0, 680.0, 615.0, 0.0, 575.0, 805.0, 220.0, 555.0, 620.0, 805.0, 465.0, 395.0, 80.0, 435.0, 705.0, 50.0, 0.0, 780.0, 600.0, 475.0, 390.0, 300.0, 290.0, 580.0, 605.0, 350.0, 650.0, 185.0, 390.0, 255.0, 440.0, 855.0, 620.0, 290.0, 315.0, 100.0, 450.0, 945.0, 275.0, 235.0, 15.0, 25.0, 695.0, 785.0, 0.0, 990.0, 0.0, 240.0, 710.0, 320.0, 590.0, 275.0, 500.0, 550.0, 800.0, 305.0, 235.0, 490.0, 165.0, 90.0, 810.0, 460.0, 400.0, 415.0, 390.0, 0.0, 10.0, 110.0, 660.0, 660.0, 415.0, 100.0, 595.0, 120.0, 560.0, 245.0, 160.0, 125.0, 245.0, 245.0, 90.0, 270.0, 145.0, 315.0, 150.0, 690.0, 310.0, 200.0, 140.0, 370.0, 300.0, 480.0, 460.0, 0.0, 65.0, 0.0, 810.0, 440.0, 325.0, 535.0, 150.0, 30.0, 55.0, 60.0, 335.0, 0.0, 165.0, 345.0, 570.0, 455.0, 260.0, 385.0, 380.0, 55.0, 385.0, 20.0, 0.0, 160.0, 195.0, 35.0, 255.0, 0.0, 170.0, 120.0, 560.0, 40.0, 135.0, 0.0, 20.0, 135.0, 10.0, 0.0, 0.0, 625.0, 120.0, 290.0, 405.0, 0.0, 100.0, 450.0, 270.0, 245.0, 565.0, 45.0, 575.0, 655.0, 130.0, 190.0, 495.0, 655.0, 325.0, 105.0, 475.0, 230.0, 160.0, 80.0, 150.0, 20.0, 5.0, 0.0, 0.0, 15.0, 45.0, 110.0, 90.0, 245.0, 275.0, 540.0, 55.0, 215.0, 275.0, 0.0, 230.0, 20.0, 10.0, 150.0, 95.0, 105.0, 160.0, 590.0, 565.0, 240.0, 95.0, 0.0, 595.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0422761614687646, "mean_inference_ms": 1.6573261095680625, "mean_action_processing_ms": 0.3687305738357986, "mean_env_wait_ms": 0.2618066236436867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004814743995666504, "StateBufferConnector_ms": 0.00557708740234375, "ViewRequirementAgentConnector_ms": 0.16543328762054443}, "num_episodes": 18, "episode_return_max": 594.0, "episode_return_min": -2683.0, "episode_return_mean": -521.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 47.99337771430209, "num_env_steps_trained_throughput_per_sec": 47.99337771430209, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 79300.373, "restore_workers_time_ms": 0.015, "training_step_time_ms": 79300.323, "sample_time_ms": 1602.095, "learn_time_ms": 77676.506, "learn_throughput": 51.496, "synch_weights_time_ms": 16.837}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 12, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-32-28", "timestamp": 1723487548, "time_this_iter_s": 83.39937615394592, "time_total_s": 954.5083382129669, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b104c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 954.5083382129669, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 41.93305084745763, "ram_util_percent": 82.61355932203388}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1684570374006922, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9833002085381366, "policy_loss": -0.010919533576238372, "vf_loss": 1.993098541312184, "vf_explained_var": -0.00023471233269847032, "kl": 0.00747464682058291, "entropy": 1.4882919153423173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 35250.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.367267397722454, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.083386337672565, "policy_loss": -0.01335635332948799, "vf_loss": 7.094916700302286, "vf_explained_var": 0.01223414436722478, "kl": 0.009129950448556384, "entropy": 1.4693295026079136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 35250.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "env_runners": {"episode_reward_max": 594.0, "episode_reward_min": -2683.0, "episode_reward_mean": -340.79, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1934.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -408.44666666666666, "predator_policy": 294.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-626.0, -2683.0, -899.0, -1050.0, -2078.0, -429.0, 257.0, -591.0, -649.0, -683.0, -2050.0, -462.0, 236.0, -873.0, -672.0, -1038.0, -476.0, -1872.0, -45.0, 270.0, -1989.0, -1994.0, -20.0, -1283.0, 531.0, -306.0, -2187.0, -235.0, -395.0, -837.0, -930.0, -562.0, -1513.0, -74.0, 15.0, -2645.0, -495.0, -411.0, 121.0, -644.0, -1747.0, -54.0, 467.0, -525.0, -378.0, -338.0, 324.0, 401.0, -544.0, 150.0, -736.0, -118.0, -735.0, -623.0, 404.0, 77.0, -736.0, 250.0, 125.0, 174.0, 65.0, -651.0, 390.0, 413.0, -1063.0, 183.0, -236.0, -278.0, -831.0, -136.0, -471.0, -504.0, 366.0, 594.0, 484.0, -220.0, 46.0, 434.0, 120.0, 399.0, -623.0, -448.0, -35.0, 394.0, 360.0, 569.0, 542.0, 183.0, 341.0, -45.0, 146.0, 505.0, 384.0, 450.0, -27.0, -53.0, -383.0, 288.0, 367.0, 330.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-768.0, -196.0, -1252.0, -1230.0, -900.0, -1373.0, -713.0, -1175.0, 24.0, -801.0, -1384.0, 200.0, -1395.0, -1219.0, -1384.0, 24.0, -1142.0, -856.0, -97.0, -361.0, 200.0, -427.0, -636.0, -1098.0, -768.0, -1032.0, -229.0, -75.0, -1472.0, -31.0, -1120.0, -878.0, -1692.0, -416.0, -834.0, -42.0, 46.0, -1450.0, 145.0, -438.0, -1736.0, -229.0, -889.0, -405.0, -163.0, -801.0, -240.0, -1032.0, -1648.0, -64.0, -64.0, -1340.0, -1307.0, -955.0, -1043.0, 200.0, -42.0, 46.0, 2.0, 57.0, -889.0, -1648.0, -1857.0, -977.0, -977.0, -1230.0, 79.0, -1747.0, 68.0, -1703.0, -757.0, -713.0, 200.0, -779.0, 200.0, 90.0, -1351.0, 200.0, -1340.0, -1153.0, -1549.0, -999.0, -416.0, 200.0, -119.0, -1527.0, -284.0, -119.0, -515.0, -1428.0, 2.0, -1813.0, -669.0, -1164.0, 79.0, -702.0, -1934.0, -1098.0, 24.0, 46.0, -328.0, -317.0, 200.0, 145.0, -1835.0, -1329.0, -735.0, -1571.0, -1604.0, 189.0, -350.0, -493.0, -1285.0, 2.0, 200.0, -1934.0, 200.0, 24.0, -713.0, -845.0, -724.0, -1538.0, -845.0, -438.0, -922.0, 101.0, -53.0, 200.0, 200.0, -1153.0, -1307.0, 200.0, -97.0, -1076.0, -20.0, -372.0, -1010.0, 79.0, 79.0, -570.0, 200.0, 200.0, 57.0, -361.0, 145.0, -1351.0, -493.0, -42.0, -350.0, -108.0, -735.0, -53.0, -1098.0, -42.0, 35.0, -636.0, 13.0, -724.0, -1274.0, -130.0, -394.0, -1109.0, 200.0, -9.0, 68.0, 90.0, -570.0, 57.0, -1120.0, -1175.0, 189.0, 167.0, 112.0, -1054.0, -416.0, 156.0, -75.0, -581.0, 200.0, 200.0, 13.0, -361.0, 123.0, 200.0, -856.0, -845.0, 200.0, -185.0, 200.0, -108.0, 200.0, 156.0, -779.0, -1109.0, 200.0, 112.0, -878.0, 134.0, -724.0, -20.0, -42.0, -427.0, 13.0, -944.0, -845.0, -438.0, -823.0, -20.0, -988.0, 57.0, -130.0, 101.0, -1527.0, -768.0, -240.0, -361.0, -64.0, 189.0, -9.0, 189.0, 200.0, 200.0, -20.0, 189.0, 145.0, -460.0, -53.0, -317.0, 189.0, 112.0, -1065.0, 178.0, -394.0, 145.0, 200.0, -141.0, -119.0, -361.0, 200.0, 200.0, -988.0, -1054.0, 24.0, 167.0, -372.0, -933.0, -196.0, -713.0, 79.0, -185.0, 189.0, 200.0, -53.0, 123.0, 90.0, 200.0, 200.0, 134.0, 178.0, 200.0, 134.0, -251.0, 57.0, 112.0, -361.0, 200.0, 167.0, -482.0, 200.0, -328.0, -141.0, -493.0, 200.0, 200.0, 134.0, 46.0, 46.0, -42.0, 200.0, 200.0, 145.0, -75.0, -1340.0, 68.0, 145.0, -75.0, -207.0, -196.0, -1153.0, -196.0, -394.0, -97.0, -130.0, 200.0, 200.0, 200.0, -768.0, -64.0, -86.0, 200.0], "policy_predator_policy_reward": [710.0, 540.0, 340.0, 30.0, 785.0, 5.0, 360.0, 285.0, 320.0, 150.0, 685.0, 100.0, 595.0, 655.0, 670.0, 505.0, 635.0, 405.0, 65.0, 365.0, 85.0, 605.0, 525.0, 440.0, 200.0, 485.0, 695.0, 0.0, 135.0, 760.0, 440.0, 355.0, 845.0, 270.0, 470.0, 90.0, 575.0, 460.0, 460.0, 530.0, 450.0, 550.0, 495.0, 135.0, 155.0, 605.0, 240.0, 190.0, 320.0, 740.0, 240.0, 725.0, 530.0, 475.0, 30.0, 495.0, 315.0, 120.0, 15.0, 30.0, 810.0, 915.0, 680.0, 615.0, 0.0, 575.0, 805.0, 220.0, 555.0, 620.0, 805.0, 465.0, 395.0, 80.0, 435.0, 705.0, 50.0, 0.0, 780.0, 600.0, 475.0, 390.0, 300.0, 290.0, 580.0, 605.0, 350.0, 650.0, 185.0, 390.0, 255.0, 440.0, 855.0, 620.0, 290.0, 315.0, 100.0, 450.0, 945.0, 275.0, 235.0, 15.0, 25.0, 695.0, 785.0, 0.0, 990.0, 0.0, 240.0, 710.0, 320.0, 590.0, 275.0, 500.0, 550.0, 800.0, 305.0, 235.0, 490.0, 165.0, 90.0, 810.0, 460.0, 400.0, 415.0, 390.0, 0.0, 10.0, 110.0, 660.0, 660.0, 415.0, 100.0, 595.0, 120.0, 560.0, 245.0, 160.0, 125.0, 245.0, 245.0, 90.0, 270.0, 145.0, 315.0, 150.0, 690.0, 310.0, 200.0, 140.0, 370.0, 300.0, 480.0, 460.0, 0.0, 65.0, 0.0, 810.0, 440.0, 325.0, 535.0, 150.0, 30.0, 55.0, 60.0, 335.0, 0.0, 165.0, 345.0, 570.0, 455.0, 260.0, 385.0, 380.0, 55.0, 385.0, 20.0, 0.0, 160.0, 195.0, 35.0, 255.0, 0.0, 170.0, 120.0, 560.0, 40.0, 135.0, 0.0, 20.0, 135.0, 10.0, 0.0, 0.0, 625.0, 120.0, 290.0, 405.0, 0.0, 100.0, 450.0, 270.0, 245.0, 565.0, 45.0, 575.0, 655.0, 130.0, 190.0, 495.0, 655.0, 325.0, 105.0, 475.0, 230.0, 160.0, 80.0, 150.0, 20.0, 5.0, 0.0, 0.0, 15.0, 45.0, 110.0, 90.0, 245.0, 275.0, 540.0, 55.0, 215.0, 275.0, 0.0, 230.0, 20.0, 10.0, 150.0, 95.0, 105.0, 160.0, 590.0, 565.0, 240.0, 95.0, 0.0, 595.0, 190.0, 230.0, 375.0, 15.0, 0.0, 175.0, 0.0, 155.0, 45.0, 10.0, 20.0, 5.0, 30.0, 0.0, 0.0, 60.0, 0.0, 205.0, 80.0, 10.0, 245.0, 0.0, 215.0, 350.0, 165.0, 235.0, 180.0, 0.0, 55.0, 70.0, 70.0, 0.0, 110.0, 70.0, 35.0, 75.0, 90.0, 330.0, 680.0, 35.0, 185.0, 205.0, 525.0, 690.0, 145.0, 160.0, 75.0, 80.0, 355.0, 5.0, 375.0, 120.0, 130.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0381587202358253, "mean_inference_ms": 1.6585563355162214, "mean_action_processing_ms": 0.36890428220644916, "mean_env_wait_ms": 0.2618846496583268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004909515380859375, "StateBufferConnector_ms": 0.005339860916137695, "ViewRequirementAgentConnector_ms": 0.16733384132385254}, "num_episodes": 18, "episode_return_max": 594.0, "episode_return_min": -2683.0, "episode_return_mean": -340.79, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 49.928705571419464, "num_env_steps_trained_throughput_per_sec": 49.928705571419464, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 79134.13, "restore_workers_time_ms": 0.015, "training_step_time_ms": 79134.072, "sample_time_ms": 1625.66, "learn_time_ms": 77485.943, "learn_throughput": 51.622, "synch_weights_time_ms": 16.787}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "training_iteration": 13, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-33-49", "timestamp": 1723487629, "time_this_iter_s": 80.13013982772827, "time_total_s": 1034.6384780406952, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b101f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1034.6384780406952, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 38.70263157894737, "ram_util_percent": 81.13421052631578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2699165484795334, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.798991115909096, "policy_loss": -0.011785385646677332, "vf_loss": 1.8095460069094988, "vf_explained_var": 8.904616883460511e-05, "kl": 0.008203287223864238, "entropy": 1.4681691554843956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 38070.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.282411780636362, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.057194137742333, "policy_loss": -0.014647382713444795, "vf_loss": 5.0705207247260615, "vf_explained_var": 0.018616218093439198, "kl": 0.00660396742457306, "entropy": 1.4654333260887904, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 38070.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -2645.0, "episode_reward_mean": -22.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1934.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": -217.78, "predator_policy": 210.28333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-235.0, -395.0, -837.0, -930.0, -562.0, -1513.0, -74.0, 15.0, -2645.0, -495.0, -411.0, 121.0, -644.0, -1747.0, -54.0, 467.0, -525.0, -378.0, -338.0, 324.0, 401.0, -544.0, 150.0, -736.0, -118.0, -735.0, -623.0, 404.0, 77.0, -736.0, 250.0, 125.0, 174.0, 65.0, -651.0, 390.0, 413.0, -1063.0, 183.0, -236.0, -278.0, -831.0, -136.0, -471.0, -504.0, 366.0, 594.0, 484.0, -220.0, 46.0, 434.0, 120.0, 399.0, -623.0, -448.0, -35.0, 394.0, 360.0, 569.0, 542.0, 183.0, 341.0, -45.0, 146.0, 505.0, 384.0, 450.0, -27.0, -53.0, -383.0, 288.0, 367.0, 330.0, 463.0, 539.0, 250.0, 465.0, 326.0, 570.0, -31.0, -707.0, 269.0, 600.0, -7.0, 130.0, 370.0, 529.0, 345.0, 403.0, 588.0, 307.0, -119.0, 425.0, 486.0, 341.0, 308.0, 570.0, 316.0, 108.0, 325.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-999.0, -416.0, 200.0, -119.0, -1527.0, -284.0, -119.0, -515.0, -1428.0, 2.0, -1813.0, -669.0, -1164.0, 79.0, -702.0, -1934.0, -1098.0, 24.0, 46.0, -328.0, -317.0, 200.0, 145.0, -1835.0, -1329.0, -735.0, -1571.0, -1604.0, 189.0, -350.0, -493.0, -1285.0, 2.0, 200.0, -1934.0, 200.0, 24.0, -713.0, -845.0, -724.0, -1538.0, -845.0, -438.0, -922.0, 101.0, -53.0, 200.0, 200.0, -1153.0, -1307.0, 200.0, -97.0, -1076.0, -20.0, -372.0, -1010.0, 79.0, 79.0, -570.0, 200.0, 200.0, 57.0, -361.0, 145.0, -1351.0, -493.0, -42.0, -350.0, -108.0, -735.0, -53.0, -1098.0, -42.0, 35.0, -636.0, 13.0, -724.0, -1274.0, -130.0, -394.0, -1109.0, 200.0, -9.0, 68.0, 90.0, -570.0, 57.0, -1120.0, -1175.0, 189.0, 167.0, 112.0, -1054.0, -416.0, 156.0, -75.0, -581.0, 200.0, 200.0, 13.0, -361.0, 123.0, 200.0, -856.0, -845.0, 200.0, -185.0, 200.0, -108.0, 200.0, 156.0, -779.0, -1109.0, 200.0, 112.0, -878.0, 134.0, -724.0, -20.0, -42.0, -427.0, 13.0, -944.0, -845.0, -438.0, -823.0, -20.0, -988.0, 57.0, -130.0, 101.0, -1527.0, -768.0, -240.0, -361.0, -64.0, 189.0, -9.0, 189.0, 200.0, 200.0, -20.0, 189.0, 145.0, -460.0, -53.0, -317.0, 189.0, 112.0, -1065.0, 178.0, -394.0, 145.0, 200.0, -141.0, -119.0, -361.0, 200.0, 200.0, -988.0, -1054.0, 24.0, 167.0, -372.0, -933.0, -196.0, -713.0, 79.0, -185.0, 189.0, 200.0, -53.0, 123.0, 90.0, 200.0, 200.0, 134.0, 178.0, 200.0, 134.0, -251.0, 57.0, 112.0, -361.0, 200.0, 167.0, -482.0, 200.0, -328.0, -141.0, -493.0, 200.0, 200.0, 134.0, 46.0, 46.0, -42.0, 200.0, 200.0, 145.0, -75.0, -1340.0, 68.0, 145.0, -75.0, -207.0, -196.0, -1153.0, -196.0, -394.0, -97.0, -130.0, 200.0, 200.0, 200.0, -768.0, -64.0, -86.0, 200.0, -834.0, 200.0, 167.0, -42.0, 200.0, 156.0, -97.0, 57.0, 35.0, 101.0, -20.0, 189.0, -108.0, -31.0, 200.0, 200.0, 200.0, 145.0, -515.0, -130.0, 79.0, -559.0, 13.0, -691.0, 189.0, 2.0, -97.0, 200.0, 200.0, 200.0, 2.0, -559.0, 35.0, -636.0, -31.0, 2.0, -86.0, 24.0, 2.0, 200.0, 101.0, 178.0, -86.0, 101.0, 200.0, 79.0, 167.0, -273.0, 200.0, 178.0, 200.0, -97.0, 24.0, 90.0, -174.0, -240.0, -185.0, 90.0, -20.0, 200.0, 35.0, 200.0, -9.0, 123.0, -273.0, 156.0, 13.0, 189.0, -559.0, 200.0, 189.0, 156.0, 79.0, 68.0, -196.0, 79.0, 35.0, -416.0, -64.0, 112.0, 57.0], "policy_predator_policy_reward": [390.0, 300.0, 290.0, 580.0, 605.0, 350.0, 650.0, 185.0, 390.0, 255.0, 440.0, 855.0, 620.0, 290.0, 315.0, 100.0, 450.0, 945.0, 275.0, 235.0, 15.0, 25.0, 695.0, 785.0, 0.0, 990.0, 0.0, 240.0, 710.0, 320.0, 590.0, 275.0, 500.0, 550.0, 800.0, 305.0, 235.0, 490.0, 165.0, 90.0, 810.0, 460.0, 400.0, 415.0, 390.0, 0.0, 10.0, 110.0, 660.0, 660.0, 415.0, 100.0, 595.0, 120.0, 560.0, 245.0, 160.0, 125.0, 245.0, 245.0, 90.0, 270.0, 145.0, 315.0, 150.0, 690.0, 310.0, 200.0, 140.0, 370.0, 300.0, 480.0, 460.0, 0.0, 65.0, 0.0, 810.0, 440.0, 325.0, 535.0, 150.0, 30.0, 55.0, 60.0, 335.0, 0.0, 165.0, 345.0, 570.0, 455.0, 260.0, 385.0, 380.0, 55.0, 385.0, 20.0, 0.0, 160.0, 195.0, 35.0, 255.0, 0.0, 170.0, 120.0, 560.0, 40.0, 135.0, 0.0, 20.0, 135.0, 10.0, 0.0, 0.0, 625.0, 120.0, 290.0, 405.0, 0.0, 100.0, 450.0, 270.0, 245.0, 565.0, 45.0, 575.0, 655.0, 130.0, 190.0, 495.0, 655.0, 325.0, 105.0, 475.0, 230.0, 160.0, 80.0, 150.0, 20.0, 5.0, 0.0, 0.0, 15.0, 45.0, 110.0, 90.0, 245.0, 275.0, 540.0, 55.0, 215.0, 275.0, 0.0, 230.0, 20.0, 10.0, 150.0, 95.0, 105.0, 160.0, 590.0, 565.0, 240.0, 95.0, 0.0, 595.0, 190.0, 230.0, 375.0, 15.0, 0.0, 175.0, 0.0, 155.0, 45.0, 10.0, 20.0, 5.0, 30.0, 0.0, 0.0, 60.0, 0.0, 205.0, 80.0, 10.0, 245.0, 0.0, 215.0, 350.0, 165.0, 235.0, 180.0, 0.0, 55.0, 70.0, 70.0, 0.0, 110.0, 70.0, 35.0, 75.0, 90.0, 330.0, 680.0, 35.0, 185.0, 205.0, 525.0, 690.0, 145.0, 160.0, 75.0, 80.0, 355.0, 5.0, 375.0, 120.0, 130.0, 30.0, 345.0, 260.0, 325.0, 20.0, 100.0, 105.0, 185.0, 70.0, 0.0, 85.0, 0.0, 110.0, 165.0, 0.0, 100.0, 25.0, 0.0, 0.0, 350.0, 185.0, 0.0, 85.0, 410.0, 35.0, 40.0, 30.0, 105.0, 0.0, 0.0, 0.0, 435.0, 0.0, 80.0, 175.0, 440.0, 180.0, 140.0, 190.0, 100.0, 5.0, 45.0, 0.0, 130.0, 0.0, 0.0, 145.0, 215.0, 70.0, 0.0, 0.0, 10.0, 140.0, 60.0, 90.0, 0.0, 205.0, 275.0, 70.0, 0.0, 85.0, 60.0, 100.0, 100.0, 145.0, 185.0, 5.0, 255.0, 345.0, 65.0, 25.0, 0.0, 0.0, 205.0, 90.0, 70.0, 40.0, 295.0, 75.0, 155.0, 55.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0414323228049904, "mean_inference_ms": 1.662833648038174, "mean_action_processing_ms": 0.3695608559872039, "mean_env_wait_ms": 0.26143237119821394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005051255226135254, "StateBufferConnector_ms": 0.005590200424194336, "ViewRequirementAgentConnector_ms": 0.18553471565246582}, "num_episodes": 27, "episode_return_max": 600.0, "episode_return_min": -2645.0, "episode_return_mean": -22.49, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 49.079106646788496, "num_env_steps_trained_throughput_per_sec": 49.079106646788496, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 79445.202, "restore_workers_time_ms": 0.015, "training_step_time_ms": 79445.144, "sample_time_ms": 1646.262, "learn_time_ms": 77776.076, "learn_throughput": 51.43, "synch_weights_time_ms": 16.783}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 14, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-35-10", "timestamp": 1723487710, "time_this_iter_s": 81.57062196731567, "time_total_s": 1116.2091000080109, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1058790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1116.2091000080109, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 41.288793103448285, "ram_util_percent": 81.8560344827586}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2162165724745033, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0866205048053823, "policy_loss": -0.009472101830699025, "vf_loss": 1.0950249905123355, "vf_explained_var": -0.00028636066626149713, "kl": 0.0071174369651003065, "entropy": 1.4598116894140312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 40890.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.44209917221509, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.963973971757483, "policy_loss": -0.01435850225741965, "vf_loss": 2.9766579437340406, "vf_explained_var": 0.03924359362176124, "kl": 0.008372638309054667, "entropy": 1.4658327904153376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 40890.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -1063.0, "episode_reward_mean": 152.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1527.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 810.0}, "policy_reward_mean": {"prey_policy": -100.52, "predator_policy": 151.46666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-338.0, 324.0, 401.0, -544.0, 150.0, -736.0, -118.0, -735.0, -623.0, 404.0, 77.0, -736.0, 250.0, 125.0, 174.0, 65.0, -651.0, 390.0, 413.0, -1063.0, 183.0, -236.0, -278.0, -831.0, -136.0, -471.0, -504.0, 366.0, 594.0, 484.0, -220.0, 46.0, 434.0, 120.0, 399.0, -623.0, -448.0, -35.0, 394.0, 360.0, 569.0, 542.0, 183.0, 341.0, -45.0, 146.0, 505.0, 384.0, 450.0, -27.0, -53.0, -383.0, 288.0, 367.0, 330.0, 463.0, 539.0, 250.0, 465.0, 326.0, 570.0, -31.0, -707.0, 269.0, 600.0, -7.0, 130.0, 370.0, 529.0, 345.0, 403.0, 588.0, 307.0, -119.0, 425.0, 486.0, 341.0, 308.0, 570.0, 316.0, 108.0, 325.0, 516.0, 600.0, 474.0, 270.0, 155.0, 441.0, -55.0, 431.0, 515.0, 600.0, 324.0, 556.0, 192.0, 405.0, 366.0, 214.0, 135.0, 552.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-372.0, -1010.0, 79.0, 79.0, -570.0, 200.0, 200.0, 57.0, -361.0, 145.0, -1351.0, -493.0, -42.0, -350.0, -108.0, -735.0, -53.0, -1098.0, -42.0, 35.0, -636.0, 13.0, -724.0, -1274.0, -130.0, -394.0, -1109.0, 200.0, -9.0, 68.0, 90.0, -570.0, 57.0, -1120.0, -1175.0, 189.0, 167.0, 112.0, -1054.0, -416.0, 156.0, -75.0, -581.0, 200.0, 200.0, 13.0, -361.0, 123.0, 200.0, -856.0, -845.0, 200.0, -185.0, 200.0, -108.0, 200.0, 156.0, -779.0, -1109.0, 200.0, 112.0, -878.0, 134.0, -724.0, -20.0, -42.0, -427.0, 13.0, -944.0, -845.0, -438.0, -823.0, -20.0, -988.0, 57.0, -130.0, 101.0, -1527.0, -768.0, -240.0, -361.0, -64.0, 189.0, -9.0, 189.0, 200.0, 200.0, -20.0, 189.0, 145.0, -460.0, -53.0, -317.0, 189.0, 112.0, -1065.0, 178.0, -394.0, 145.0, 200.0, -141.0, -119.0, -361.0, 200.0, 200.0, -988.0, -1054.0, 24.0, 167.0, -372.0, -933.0, -196.0, -713.0, 79.0, -185.0, 189.0, 200.0, -53.0, 123.0, 90.0, 200.0, 200.0, 134.0, 178.0, 200.0, 134.0, -251.0, 57.0, 112.0, -361.0, 200.0, 167.0, -482.0, 200.0, -328.0, -141.0, -493.0, 200.0, 200.0, 134.0, 46.0, 46.0, -42.0, 200.0, 200.0, 145.0, -75.0, -1340.0, 68.0, 145.0, -75.0, -207.0, -196.0, -1153.0, -196.0, -394.0, -97.0, -130.0, 200.0, 200.0, 200.0, -768.0, -64.0, -86.0, 200.0, -834.0, 200.0, 167.0, -42.0, 200.0, 156.0, -97.0, 57.0, 35.0, 101.0, -20.0, 189.0, -108.0, -31.0, 200.0, 200.0, 200.0, 145.0, -515.0, -130.0, 79.0, -559.0, 13.0, -691.0, 189.0, 2.0, -97.0, 200.0, 200.0, 200.0, 2.0, -559.0, 35.0, -636.0, -31.0, 2.0, -86.0, 24.0, 2.0, 200.0, 101.0, 178.0, -86.0, 101.0, 200.0, 79.0, 167.0, -273.0, 200.0, 178.0, 200.0, -97.0, 24.0, 90.0, -174.0, -240.0, -185.0, 90.0, -20.0, 200.0, 35.0, 200.0, -9.0, 123.0, -273.0, 156.0, 13.0, 189.0, -559.0, 200.0, 189.0, 156.0, 79.0, 68.0, -196.0, 79.0, 35.0, -416.0, -64.0, 112.0, 57.0, 200.0, 200.0, 46.0, 200.0, 200.0, 200.0, 90.0, 200.0, 79.0, 13.0, -97.0, 134.0, -64.0, 68.0, -504.0, 57.0, 90.0, 134.0, -570.0, -163.0, 123.0, 68.0, 79.0, 189.0, 189.0, 156.0, 145.0, 200.0, 200.0, 200.0, 101.0, -273.0, 156.0, 200.0, 200.0, 101.0, 200.0, -196.0, -97.0, 101.0, 200.0, -86.0, -218.0, 189.0, 200.0, 35.0, -42.0, -64.0, -64.0, 178.0, -504.0, 112.0, 200.0, 200.0], "policy_predator_policy_reward": [560.0, 245.0, 160.0, 125.0, 245.0, 245.0, 90.0, 270.0, 145.0, 315.0, 150.0, 690.0, 310.0, 200.0, 140.0, 370.0, 300.0, 480.0, 460.0, 0.0, 65.0, 0.0, 810.0, 440.0, 325.0, 535.0, 150.0, 30.0, 55.0, 60.0, 335.0, 0.0, 165.0, 345.0, 570.0, 455.0, 260.0, 385.0, 380.0, 55.0, 385.0, 20.0, 0.0, 160.0, 195.0, 35.0, 255.0, 0.0, 170.0, 120.0, 560.0, 40.0, 135.0, 0.0, 20.0, 135.0, 10.0, 0.0, 0.0, 625.0, 120.0, 290.0, 405.0, 0.0, 100.0, 450.0, 270.0, 245.0, 565.0, 45.0, 575.0, 655.0, 130.0, 190.0, 495.0, 655.0, 325.0, 105.0, 475.0, 230.0, 160.0, 80.0, 150.0, 20.0, 5.0, 0.0, 0.0, 15.0, 45.0, 110.0, 90.0, 245.0, 275.0, 540.0, 55.0, 215.0, 275.0, 0.0, 230.0, 20.0, 10.0, 150.0, 95.0, 105.0, 160.0, 590.0, 565.0, 240.0, 95.0, 0.0, 595.0, 190.0, 230.0, 375.0, 15.0, 0.0, 175.0, 0.0, 155.0, 45.0, 10.0, 20.0, 5.0, 30.0, 0.0, 0.0, 60.0, 0.0, 205.0, 80.0, 10.0, 245.0, 0.0, 215.0, 350.0, 165.0, 235.0, 180.0, 0.0, 55.0, 70.0, 70.0, 0.0, 110.0, 70.0, 35.0, 75.0, 90.0, 330.0, 680.0, 35.0, 185.0, 205.0, 525.0, 690.0, 145.0, 160.0, 75.0, 80.0, 355.0, 5.0, 375.0, 120.0, 130.0, 30.0, 345.0, 260.0, 325.0, 20.0, 100.0, 105.0, 185.0, 70.0, 0.0, 85.0, 0.0, 110.0, 165.0, 0.0, 100.0, 25.0, 0.0, 0.0, 350.0, 185.0, 0.0, 85.0, 410.0, 35.0, 40.0, 30.0, 105.0, 0.0, 0.0, 0.0, 435.0, 0.0, 80.0, 175.0, 440.0, 180.0, 140.0, 190.0, 100.0, 5.0, 45.0, 0.0, 130.0, 0.0, 0.0, 145.0, 215.0, 70.0, 0.0, 0.0, 10.0, 140.0, 60.0, 90.0, 0.0, 205.0, 275.0, 70.0, 0.0, 85.0, 60.0, 100.0, 100.0, 145.0, 185.0, 5.0, 255.0, 345.0, 65.0, 25.0, 0.0, 0.0, 205.0, 90.0, 70.0, 40.0, 295.0, 75.0, 155.0, 55.0, 10.0, 0.0, 70.0, 0.0, 0.0, 0.0, 0.0, 55.0, 50.0, 0.0, 105.0, 30.0, 85.0, 120.0, 215.0, 320.0, 85.0, 5.0, 70.0, 320.0, 60.0, 175.0, 0.0, 35.0, 60.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 150.0, 60.0, 130.0, 0.0, 10.0, 45.0, 110.0, 10.0, 165.0, 15.0, 130.0, 45.0, 195.0, 0.0, 0.0, 50.0, 235.0, 0.0, 10.0, 175.0, 340.0, 0.0, 35.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0429430856268425, "mean_inference_ms": 1.6661465610752504, "mean_action_processing_ms": 0.3701236717254794, "mean_env_wait_ms": 0.2623775581960336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047397613525390625, "StateBufferConnector_ms": 0.005261778831481934, "ViewRequirementAgentConnector_ms": 0.1862189769744873}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -1063.0, "episode_return_mean": 152.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 52.24482360875845, "num_env_steps_trained_throughput_per_sec": 52.24482360875845, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 79089.345, "restore_workers_time_ms": 0.015, "training_step_time_ms": 79089.286, "sample_time_ms": 1561.791, "learn_time_ms": 77505.264, "learn_throughput": 51.609, "synch_weights_time_ms": 16.443}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 15, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-36-27", "timestamp": 1723487787, "time_this_iter_s": 76.59791898727417, "time_total_s": 1192.807018995285, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b106a940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1192.807018995285, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 33.82201834862385, "ram_util_percent": 81.00091743119266}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2955924932944014, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7036686223238073, "policy_loss": -0.009495948949921215, "vf_loss": 1.7120021131021756, "vf_explained_var": -0.0001565600963349038, "kl": 0.007749758100581774, "entropy": 1.4458467438288614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 43710.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.04133998783345, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7325534619972216, "policy_loss": -0.016282054127779368, "vf_loss": 1.7471478807587995, "vf_explained_var": 0.02957780585221365, "kl": 0.008438190300691475, "entropy": 1.4667417284021986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 43710.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -1063.0, "episode_reward_mean": 228.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1527.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 690.0}, "policy_reward_mean": {"prey_policy": -48.63666666666666, "predator_policy": 124.68333333333334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [413.0, -1063.0, 183.0, -236.0, -278.0, -831.0, -136.0, -471.0, -504.0, 366.0, 594.0, 484.0, -220.0, 46.0, 434.0, 120.0, 399.0, -623.0, -448.0, -35.0, 394.0, 360.0, 569.0, 542.0, 183.0, 341.0, -45.0, 146.0, 505.0, 384.0, 450.0, -27.0, -53.0, -383.0, 288.0, 367.0, 330.0, 463.0, 539.0, 250.0, 465.0, 326.0, 570.0, -31.0, -707.0, 269.0, 600.0, -7.0, 130.0, 370.0, 529.0, 345.0, 403.0, 588.0, 307.0, -119.0, 425.0, 486.0, 341.0, 308.0, 570.0, 316.0, 108.0, 325.0, 516.0, 600.0, 474.0, 270.0, 155.0, 441.0, -55.0, 431.0, 515.0, 600.0, 324.0, 556.0, 192.0, 405.0, 366.0, 214.0, 135.0, 552.0, 241.0, 422.0, 488.0, 25.0, 594.0, 600.0, 241.0, 272.0, 296.0, 162.0, -130.0, -185.0, 540.0, 196.0, 558.0, 405.0, 248.0, 436.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-108.0, 200.0, 156.0, -779.0, -1109.0, 200.0, 112.0, -878.0, 134.0, -724.0, -20.0, -42.0, -427.0, 13.0, -944.0, -845.0, -438.0, -823.0, -20.0, -988.0, 57.0, -130.0, 101.0, -1527.0, -768.0, -240.0, -361.0, -64.0, 189.0, -9.0, 189.0, 200.0, 200.0, -20.0, 189.0, 145.0, -460.0, -53.0, -317.0, 189.0, 112.0, -1065.0, 178.0, -394.0, 145.0, 200.0, -141.0, -119.0, -361.0, 200.0, 200.0, -988.0, -1054.0, 24.0, 167.0, -372.0, -933.0, -196.0, -713.0, 79.0, -185.0, 189.0, 200.0, -53.0, 123.0, 90.0, 200.0, 200.0, 134.0, 178.0, 200.0, 134.0, -251.0, 57.0, 112.0, -361.0, 200.0, 167.0, -482.0, 200.0, -328.0, -141.0, -493.0, 200.0, 200.0, 134.0, 46.0, 46.0, -42.0, 200.0, 200.0, 145.0, -75.0, -1340.0, 68.0, 145.0, -75.0, -207.0, -196.0, -1153.0, -196.0, -394.0, -97.0, -130.0, 200.0, 200.0, 200.0, -768.0, -64.0, -86.0, 200.0, -834.0, 200.0, 167.0, -42.0, 200.0, 156.0, -97.0, 57.0, 35.0, 101.0, -20.0, 189.0, -108.0, -31.0, 200.0, 200.0, 200.0, 145.0, -515.0, -130.0, 79.0, -559.0, 13.0, -691.0, 189.0, 2.0, -97.0, 200.0, 200.0, 200.0, 2.0, -559.0, 35.0, -636.0, -31.0, 2.0, -86.0, 24.0, 2.0, 200.0, 101.0, 178.0, -86.0, 101.0, 200.0, 79.0, 167.0, -273.0, 200.0, 178.0, 200.0, -97.0, 24.0, 90.0, -174.0, -240.0, -185.0, 90.0, -20.0, 200.0, 35.0, 200.0, -9.0, 123.0, -273.0, 156.0, 13.0, 189.0, -559.0, 200.0, 189.0, 156.0, 79.0, 68.0, -196.0, 79.0, 35.0, -416.0, -64.0, 112.0, 57.0, 200.0, 200.0, 46.0, 200.0, 200.0, 200.0, 90.0, 200.0, 79.0, 13.0, -97.0, 134.0, -64.0, 68.0, -504.0, 57.0, 90.0, 134.0, -570.0, -163.0, 123.0, 68.0, 79.0, 189.0, 189.0, 156.0, 145.0, 200.0, 200.0, 200.0, 101.0, -273.0, 156.0, 200.0, 200.0, 101.0, 200.0, -196.0, -97.0, 101.0, 200.0, -86.0, -218.0, 189.0, 200.0, 35.0, -42.0, -64.0, -64.0, 178.0, -504.0, 112.0, 200.0, 200.0, -20.0, 35.0, 101.0, 200.0, 112.0, -75.0, 134.0, 200.0, 79.0, -75.0, -295.0, 35.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -42.0, -97.0, 90.0, 200.0, -955.0, 57.0, -119.0, 101.0, 24.0, -75.0, -471.0, 178.0, -185.0, -196.0, -229.0, -130.0, -108.0, -317.0, 200.0, 90.0, 200.0, -9.0, -207.0, 2.0, 200.0, 200.0, 123.0, 200.0, -75.0, 90.0, 35.0, -185.0, 13.0, 178.0, -53.0, 101.0], "policy_predator_policy_reward": [20.0, 135.0, 10.0, 0.0, 0.0, 625.0, 120.0, 290.0, 405.0, 0.0, 100.0, 450.0, 270.0, 245.0, 565.0, 45.0, 575.0, 655.0, 130.0, 190.0, 495.0, 655.0, 325.0, 105.0, 475.0, 230.0, 160.0, 80.0, 150.0, 20.0, 5.0, 0.0, 0.0, 15.0, 45.0, 110.0, 90.0, 245.0, 275.0, 540.0, 55.0, 215.0, 275.0, 0.0, 230.0, 20.0, 10.0, 150.0, 95.0, 105.0, 160.0, 590.0, 565.0, 240.0, 95.0, 0.0, 595.0, 190.0, 230.0, 375.0, 15.0, 0.0, 175.0, 0.0, 155.0, 45.0, 10.0, 20.0, 5.0, 30.0, 0.0, 0.0, 60.0, 0.0, 205.0, 80.0, 10.0, 245.0, 0.0, 215.0, 350.0, 165.0, 235.0, 180.0, 0.0, 55.0, 70.0, 70.0, 0.0, 110.0, 70.0, 35.0, 75.0, 90.0, 330.0, 680.0, 35.0, 185.0, 205.0, 525.0, 690.0, 145.0, 160.0, 75.0, 80.0, 355.0, 5.0, 375.0, 120.0, 130.0, 30.0, 345.0, 260.0, 325.0, 20.0, 100.0, 105.0, 185.0, 70.0, 0.0, 85.0, 0.0, 110.0, 165.0, 0.0, 100.0, 25.0, 0.0, 0.0, 350.0, 185.0, 0.0, 85.0, 410.0, 35.0, 40.0, 30.0, 105.0, 0.0, 0.0, 0.0, 435.0, 0.0, 80.0, 175.0, 440.0, 180.0, 140.0, 190.0, 100.0, 5.0, 45.0, 0.0, 130.0, 0.0, 0.0, 145.0, 215.0, 70.0, 0.0, 0.0, 10.0, 140.0, 60.0, 90.0, 0.0, 205.0, 275.0, 70.0, 0.0, 85.0, 60.0, 100.0, 100.0, 145.0, 185.0, 5.0, 255.0, 345.0, 65.0, 25.0, 0.0, 0.0, 205.0, 90.0, 70.0, 40.0, 295.0, 75.0, 155.0, 55.0, 10.0, 0.0, 70.0, 0.0, 0.0, 0.0, 0.0, 55.0, 50.0, 0.0, 105.0, 30.0, 85.0, 120.0, 215.0, 320.0, 85.0, 5.0, 70.0, 320.0, 60.0, 175.0, 0.0, 35.0, 60.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 150.0, 60.0, 130.0, 0.0, 10.0, 45.0, 110.0, 10.0, 165.0, 15.0, 130.0, 45.0, 195.0, 0.0, 0.0, 50.0, 235.0, 0.0, 10.0, 175.0, 340.0, 0.0, 35.0, 5.0, 100.0, 0.0, 25.0, 20.0, 95.0, 70.0, 20.0, 0.0, 55.0, 5.0, 130.0, 225.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 125.0, 0.0, 165.0, 295.0, 335.0, 340.0, 130.0, 130.0, 30.0, 215.0, 155.0, 160.0, 80.0, 180.0, 220.0, 90.0, 15.0, 265.0, 50.0, 0.0, 0.0, 185.0, 140.0, 85.0, 0.0, 35.0, 0.0, 15.0, 50.0, 125.0, 135.0, 155.0, 95.0, 100.0, 85.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0419311887199836, "mean_inference_ms": 1.6649631866741088, "mean_action_processing_ms": 0.369752894962345, "mean_env_wait_ms": 0.26209199560100255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052231550216674805, "StateBufferConnector_ms": 0.0050733089447021484, "ViewRequirementAgentConnector_ms": 0.18616390228271484}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -1063.0, "episode_return_mean": 228.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 52.21464018474551, "num_env_steps_trained_throughput_per_sec": 52.21464018474551, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 79012.495, "restore_workers_time_ms": 0.015, "training_step_time_ms": 79012.436, "sample_time_ms": 1558.44, "learn_time_ms": 77432.14, "learn_throughput": 51.658, "synch_weights_time_ms": 16.565}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 16, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-37-43", "timestamp": 1723487863, "time_this_iter_s": 76.64361500740051, "time_total_s": 1269.4506340026855, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b104c9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1269.4506340026855, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 34.67706422018349, "ram_util_percent": 80.86605504587153}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3098044144452041, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1978141981659207, "policy_loss": -0.012773071228384522, "vf_loss": 1.2090583810358182, "vf_explained_var": 0.001685611808553655, "kl": 0.01019258979521712, "entropy": 1.4542208663115264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 46530.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.55033996498331, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6034993451326451, "policy_loss": -0.01474867675962019, "vf_loss": 1.6166661941201974, "vf_explained_var": 0.030866565497208995, "kl": 0.007909151628941643, "entropy": 1.4718350391438666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 46530.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -1085.0, "episode_reward_mean": 274.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1340.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 690.0}, "policy_reward_mean": {"prey_policy": -8.633333333333333, "predator_policy": 99.98333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-448.0, -35.0, 394.0, 360.0, 569.0, 542.0, 183.0, 341.0, -45.0, 146.0, 505.0, 384.0, 450.0, -27.0, -53.0, -383.0, 288.0, 367.0, 330.0, 463.0, 539.0, 250.0, 465.0, 326.0, 570.0, -31.0, -707.0, 269.0, 600.0, -7.0, 130.0, 370.0, 529.0, 345.0, 403.0, 588.0, 307.0, -119.0, 425.0, 486.0, 341.0, 308.0, 570.0, 316.0, 108.0, 325.0, 516.0, 600.0, 474.0, 270.0, 155.0, 441.0, -55.0, 431.0, 515.0, 600.0, 324.0, 556.0, 192.0, 405.0, 366.0, 214.0, 135.0, 552.0, 241.0, 422.0, 488.0, 25.0, 594.0, 600.0, 241.0, 272.0, 296.0, 162.0, -130.0, -185.0, 540.0, 196.0, 558.0, 405.0, 248.0, 436.0, 458.0, 451.0, -18.0, 186.0, 90.0, 564.0, -64.0, -1085.0, 494.0, -479.0, 83.0, 486.0, 319.0, 467.0, 510.0, 326.0, -56.0, 536.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [167.0, -372.0, -933.0, -196.0, -713.0, 79.0, -185.0, 189.0, 200.0, -53.0, 123.0, 90.0, 200.0, 200.0, 134.0, 178.0, 200.0, 134.0, -251.0, 57.0, 112.0, -361.0, 200.0, 167.0, -482.0, 200.0, -328.0, -141.0, -493.0, 200.0, 200.0, 134.0, 46.0, 46.0, -42.0, 200.0, 200.0, 145.0, -75.0, -1340.0, 68.0, 145.0, -75.0, -207.0, -196.0, -1153.0, -196.0, -394.0, -97.0, -130.0, 200.0, 200.0, 200.0, -768.0, -64.0, -86.0, 200.0, -834.0, 200.0, 167.0, -42.0, 200.0, 156.0, -97.0, 57.0, 35.0, 101.0, -20.0, 189.0, -108.0, -31.0, 200.0, 200.0, 200.0, 145.0, -515.0, -130.0, 79.0, -559.0, 13.0, -691.0, 189.0, 2.0, -97.0, 200.0, 200.0, 200.0, 2.0, -559.0, 35.0, -636.0, -31.0, 2.0, -86.0, 24.0, 2.0, 200.0, 101.0, 178.0, -86.0, 101.0, 200.0, 79.0, 167.0, -273.0, 200.0, 178.0, 200.0, -97.0, 24.0, 90.0, -174.0, -240.0, -185.0, 90.0, -20.0, 200.0, 35.0, 200.0, -9.0, 123.0, -273.0, 156.0, 13.0, 189.0, -559.0, 200.0, 189.0, 156.0, 79.0, 68.0, -196.0, 79.0, 35.0, -416.0, -64.0, 112.0, 57.0, 200.0, 200.0, 46.0, 200.0, 200.0, 200.0, 90.0, 200.0, 79.0, 13.0, -97.0, 134.0, -64.0, 68.0, -504.0, 57.0, 90.0, 134.0, -570.0, -163.0, 123.0, 68.0, 79.0, 189.0, 189.0, 156.0, 145.0, 200.0, 200.0, 200.0, 101.0, -273.0, 156.0, 200.0, 200.0, 101.0, 200.0, -196.0, -97.0, 101.0, 200.0, -86.0, -218.0, 189.0, 200.0, 35.0, -42.0, -64.0, -64.0, 178.0, -504.0, 112.0, 200.0, 200.0, -20.0, 35.0, 101.0, 200.0, 112.0, -75.0, 134.0, 200.0, 79.0, -75.0, -295.0, 35.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -42.0, -97.0, 90.0, 200.0, -955.0, 57.0, -119.0, 101.0, 24.0, -75.0, -471.0, 178.0, -185.0, -196.0, -229.0, -130.0, -108.0, -317.0, 200.0, 90.0, 200.0, -9.0, -207.0, 2.0, 200.0, 200.0, 123.0, 200.0, -75.0, 90.0, 35.0, -185.0, 13.0, 178.0, -53.0, 101.0, 178.0, -97.0, 167.0, 24.0, 57.0, 200.0, -1043.0, 200.0, 200.0, -64.0, 200.0, -75.0, -64.0, -86.0, -75.0, 145.0, 200.0, 189.0, -196.0, 101.0, -284.0, -438.0, -526.0, -471.0, 79.0, 200.0, 90.0, -317.0, -108.0, -449.0, 2.0, -152.0, 68.0, -9.0, 200.0, 200.0, 24.0, 101.0, -31.0, 200.0, 46.0, 101.0, 156.0, 189.0, 90.0, 178.0, -273.0, 101.0, -284.0, -152.0, -75.0, 178.0, 200.0, 123.0], "policy_predator_policy_reward": [95.0, 0.0, 595.0, 190.0, 230.0, 375.0, 15.0, 0.0, 175.0, 0.0, 155.0, 45.0, 10.0, 20.0, 5.0, 30.0, 0.0, 0.0, 60.0, 0.0, 205.0, 80.0, 10.0, 245.0, 0.0, 215.0, 350.0, 165.0, 235.0, 180.0, 0.0, 55.0, 70.0, 70.0, 0.0, 110.0, 70.0, 35.0, 75.0, 90.0, 330.0, 680.0, 35.0, 185.0, 205.0, 525.0, 690.0, 145.0, 160.0, 75.0, 80.0, 355.0, 5.0, 375.0, 120.0, 130.0, 30.0, 345.0, 260.0, 325.0, 20.0, 100.0, 105.0, 185.0, 70.0, 0.0, 85.0, 0.0, 110.0, 165.0, 0.0, 100.0, 25.0, 0.0, 0.0, 350.0, 185.0, 0.0, 85.0, 410.0, 35.0, 40.0, 30.0, 105.0, 0.0, 0.0, 0.0, 435.0, 0.0, 80.0, 175.0, 440.0, 180.0, 140.0, 190.0, 100.0, 5.0, 45.0, 0.0, 130.0, 0.0, 0.0, 145.0, 215.0, 70.0, 0.0, 0.0, 10.0, 140.0, 60.0, 90.0, 0.0, 205.0, 275.0, 70.0, 0.0, 85.0, 60.0, 100.0, 100.0, 145.0, 185.0, 5.0, 255.0, 345.0, 65.0, 25.0, 0.0, 0.0, 205.0, 90.0, 70.0, 40.0, 295.0, 75.0, 155.0, 55.0, 10.0, 0.0, 70.0, 0.0, 0.0, 0.0, 0.0, 55.0, 50.0, 0.0, 105.0, 30.0, 85.0, 120.0, 215.0, 320.0, 85.0, 5.0, 70.0, 320.0, 60.0, 175.0, 0.0, 35.0, 60.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 150.0, 60.0, 130.0, 0.0, 10.0, 45.0, 110.0, 10.0, 165.0, 15.0, 130.0, 45.0, 195.0, 0.0, 0.0, 50.0, 235.0, 0.0, 10.0, 175.0, 340.0, 0.0, 35.0, 5.0, 100.0, 0.0, 25.0, 20.0, 95.0, 70.0, 20.0, 0.0, 55.0, 5.0, 130.0, 225.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 125.0, 0.0, 165.0, 295.0, 335.0, 340.0, 130.0, 130.0, 30.0, 215.0, 155.0, 160.0, 80.0, 180.0, 220.0, 90.0, 15.0, 265.0, 50.0, 0.0, 0.0, 185.0, 140.0, 85.0, 0.0, 35.0, 0.0, 15.0, 50.0, 125.0, 135.0, 155.0, 95.0, 100.0, 85.0, 25.0, 20.0, 125.0, 65.0, 45.0, 125.0, 0.0, 315.0, 120.0, 190.0, 0.0, 125.0, 0.0, 135.0, 90.0, 90.0, 25.0, 5.0, 0.0, 0.0, 40.0, 275.0, 350.0, 0.0, 0.0, 35.0, 55.0, 35.0, 0.0, 330.0, 65.0, 0.0, 0.0, 165.0, 45.0, 0.0, 50.0, 65.0, 110.0, 50.0, 70.0, 40.0, 10.0, 20.0, 55.0, 0.0, 155.0, 70.0, 95.0, 100.0, 210.0, 145.0, 35.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0404168085170493, "mean_inference_ms": 1.662638649142103, "mean_action_processing_ms": 0.3689254445184572, "mean_env_wait_ms": 0.2617972826723521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00671839714050293, "StateBufferConnector_ms": 0.00431060791015625, "ViewRequirementAgentConnector_ms": 0.17970037460327148}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -1085.0, "episode_return_mean": 274.05, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 50.835923072667015, "num_env_steps_trained_throughput_per_sec": 50.835923072667015, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 79155.567, "restore_workers_time_ms": 0.015, "training_step_time_ms": 79155.51, "sample_time_ms": 1573.138, "learn_time_ms": 77562.24, "learn_throughput": 51.571, "synch_weights_time_ms": 14.993}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "training_iteration": 17, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-39-02", "timestamp": 1723487942, "time_this_iter_s": 78.73186206817627, "time_total_s": 1348.1824960708618, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b101f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1348.1824960708618, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 40.54732142857143, "ram_util_percent": 82.50625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.269190914189139, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.224678342224013, "policy_loss": -0.01381826468855671, "vf_loss": 2.2367158586674547, "vf_explained_var": 0.0009219699083490575, "kl": 0.011871682087555971, "entropy": 1.4360197830707468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 49350.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.743872494837071, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.536289467541039, "policy_loss": -0.011097938421806003, "vf_loss": 3.5457945086431844, "vf_explained_var": 0.02179216017537083, "kl": 0.007964511112486887, "entropy": 1.4565177116410952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 49350.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -1085.0, "episode_reward_mean": 260.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1087.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 735.0}, "policy_reward_mean": {"prey_policy": -3.3533333333333335, "predator_policy": 90.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [465.0, 326.0, 570.0, -31.0, -707.0, 269.0, 600.0, -7.0, 130.0, 370.0, 529.0, 345.0, 403.0, 588.0, 307.0, -119.0, 425.0, 486.0, 341.0, 308.0, 570.0, 316.0, 108.0, 325.0, 516.0, 600.0, 474.0, 270.0, 155.0, 441.0, -55.0, 431.0, 515.0, 600.0, 324.0, 556.0, 192.0, 405.0, 366.0, 214.0, 135.0, 552.0, 241.0, 422.0, 488.0, 25.0, 594.0, 600.0, 241.0, 272.0, 296.0, 162.0, -130.0, -185.0, 540.0, 196.0, 558.0, 405.0, 248.0, 436.0, 458.0, 451.0, -18.0, 186.0, 90.0, 564.0, -64.0, -1085.0, 494.0, -479.0, 83.0, 486.0, 319.0, 467.0, 510.0, 326.0, -56.0, 536.0, 280.0, 6.0, 197.0, 168.0, 155.0, 438.0, -20.0, 581.0, -343.0, 251.0, 406.0, -680.0, 496.0, 74.0, 499.0, 61.0, 448.0, -430.0, 336.0, 332.0, 308.0, 221.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [101.0, -20.0, 189.0, -108.0, -31.0, 200.0, 200.0, 200.0, 145.0, -515.0, -130.0, 79.0, -559.0, 13.0, -691.0, 189.0, 2.0, -97.0, 200.0, 200.0, 200.0, 2.0, -559.0, 35.0, -636.0, -31.0, 2.0, -86.0, 24.0, 2.0, 200.0, 101.0, 178.0, -86.0, 101.0, 200.0, 79.0, 167.0, -273.0, 200.0, 178.0, 200.0, -97.0, 24.0, 90.0, -174.0, -240.0, -185.0, 90.0, -20.0, 200.0, 35.0, 200.0, -9.0, 123.0, -273.0, 156.0, 13.0, 189.0, -559.0, 200.0, 189.0, 156.0, 79.0, 68.0, -196.0, 79.0, 35.0, -416.0, -64.0, 112.0, 57.0, 200.0, 200.0, 46.0, 200.0, 200.0, 200.0, 90.0, 200.0, 79.0, 13.0, -97.0, 134.0, -64.0, 68.0, -504.0, 57.0, 90.0, 134.0, -570.0, -163.0, 123.0, 68.0, 79.0, 189.0, 189.0, 156.0, 145.0, 200.0, 200.0, 200.0, 101.0, -273.0, 156.0, 200.0, 200.0, 101.0, 200.0, -196.0, -97.0, 101.0, 200.0, -86.0, -218.0, 189.0, 200.0, 35.0, -42.0, -64.0, -64.0, 178.0, -504.0, 112.0, 200.0, 200.0, -20.0, 35.0, 101.0, 200.0, 112.0, -75.0, 134.0, 200.0, 79.0, -75.0, -295.0, 35.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -42.0, -97.0, 90.0, 200.0, -955.0, 57.0, -119.0, 101.0, 24.0, -75.0, -471.0, 178.0, -185.0, -196.0, -229.0, -130.0, -108.0, -317.0, 200.0, 90.0, 200.0, -9.0, -207.0, 2.0, 200.0, 200.0, 123.0, 200.0, -75.0, 90.0, 35.0, -185.0, 13.0, 178.0, -53.0, 101.0, 178.0, -97.0, 167.0, 24.0, 57.0, 200.0, -1043.0, 200.0, 200.0, -64.0, 200.0, -75.0, -64.0, -86.0, -75.0, 145.0, 200.0, 189.0, -196.0, 101.0, -284.0, -438.0, -526.0, -471.0, 79.0, 200.0, 90.0, -317.0, -108.0, -449.0, 2.0, -152.0, 68.0, -9.0, 200.0, 200.0, 24.0, 101.0, -31.0, 200.0, 46.0, 101.0, 156.0, 189.0, 90.0, 178.0, -273.0, 101.0, -284.0, -152.0, -75.0, 178.0, 200.0, 123.0, -119.0, 189.0, -20.0, -449.0, 24.0, -174.0, -9.0, -207.0, 68.0, 112.0, -31.0, -273.0, -416.0, 123.0, 123.0, -97.0, 200.0, 200.0, -229.0, -339.0, 178.0, 200.0, 200.0, 156.0, -196.0, -64.0, -603.0, -438.0, 156.0, 123.0, 2.0, 200.0, 79.0, -988.0, -438.0, -64.0, 123.0, 189.0, 24.0, 200.0, -97.0, -229.0, 200.0, 189.0, 35.0, -229.0, 35.0, 35.0, 112.0, -9.0, 200.0, -1087.0, 200.0, -218.0, 167.0, 46.0, -97.0, -130.0, 134.0, 13.0, -273.0, 112.0, 189.0, -9.0, 112.0, -207.0], "policy_predator_policy_reward": [85.0, 0.0, 110.0, 165.0, 0.0, 100.0, 25.0, 0.0, 0.0, 350.0, 185.0, 0.0, 85.0, 410.0, 35.0, 40.0, 30.0, 105.0, 0.0, 0.0, 0.0, 435.0, 0.0, 80.0, 175.0, 440.0, 180.0, 140.0, 190.0, 100.0, 5.0, 45.0, 0.0, 130.0, 0.0, 0.0, 145.0, 215.0, 70.0, 0.0, 0.0, 10.0, 140.0, 60.0, 90.0, 0.0, 205.0, 275.0, 70.0, 0.0, 85.0, 60.0, 100.0, 100.0, 145.0, 185.0, 5.0, 255.0, 345.0, 65.0, 25.0, 0.0, 0.0, 205.0, 90.0, 70.0, 40.0, 295.0, 75.0, 155.0, 55.0, 10.0, 0.0, 70.0, 0.0, 0.0, 0.0, 0.0, 55.0, 50.0, 0.0, 105.0, 30.0, 85.0, 120.0, 215.0, 320.0, 85.0, 5.0, 70.0, 320.0, 60.0, 175.0, 0.0, 35.0, 60.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 150.0, 60.0, 130.0, 0.0, 10.0, 45.0, 110.0, 10.0, 165.0, 15.0, 130.0, 45.0, 195.0, 0.0, 0.0, 50.0, 235.0, 0.0, 10.0, 175.0, 340.0, 0.0, 35.0, 5.0, 100.0, 0.0, 25.0, 20.0, 95.0, 70.0, 20.0, 0.0, 55.0, 5.0, 130.0, 225.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 125.0, 0.0, 165.0, 295.0, 335.0, 340.0, 130.0, 130.0, 30.0, 215.0, 155.0, 160.0, 80.0, 180.0, 220.0, 90.0, 15.0, 265.0, 50.0, 0.0, 0.0, 185.0, 140.0, 85.0, 0.0, 35.0, 0.0, 15.0, 50.0, 125.0, 135.0, 155.0, 95.0, 100.0, 85.0, 25.0, 20.0, 125.0, 65.0, 45.0, 125.0, 0.0, 315.0, 120.0, 190.0, 0.0, 125.0, 0.0, 135.0, 90.0, 90.0, 25.0, 5.0, 0.0, 0.0, 40.0, 275.0, 350.0, 0.0, 0.0, 35.0, 55.0, 35.0, 0.0, 330.0, 65.0, 0.0, 0.0, 165.0, 45.0, 0.0, 50.0, 65.0, 110.0, 50.0, 70.0, 40.0, 10.0, 20.0, 55.0, 0.0, 155.0, 70.0, 95.0, 100.0, 210.0, 145.0, 35.0, 0.0, 0.0, 0.0, 50.0, 180.0, 335.0, 120.0, 150.0, 95.0, 195.0, 55.0, 85.0, 130.0, 145.0, 35.0, 0.0, 290.0, 0.0, 115.0, 20.0, 10.0, 95.0, 265.0, 10.0, 15.0, 0.0, 485.0, 35.0, 0.0, 45.0, 90.0, 275.0, 55.0, 5.0, 65.0, 735.0, 60.0, 15.0, 45.0, 80.0, 35.0, 0.0, 200.0, 0.0, 75.0, 0.0, 0.0, 0.0, 195.0, 25.0, 0.0, 35.0, 110.0, 0.0, 275.0, 400.0, 165.0, 55.0, 0.0, 55.0, 115.0, 145.0, 40.0, 160.0, 80.0, 50.0, 185.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0396768233094962, "mean_inference_ms": 1.6823838967471227, "mean_action_processing_ms": 0.3682143479456061, "mean_env_wait_ms": 0.26122784155474904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007568836212158203, "StateBufferConnector_ms": 0.004334449768066406, "ViewRequirementAgentConnector_ms": 0.17409181594848633}, "num_episodes": 22, "episode_return_max": 600.0, "episode_return_min": -1085.0, "episode_return_mean": 260.69, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 52.49790397533844, "num_env_steps_trained_throughput_per_sec": 52.49790397533844, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 79093.544, "restore_workers_time_ms": 0.015, "training_step_time_ms": 79093.478, "sample_time_ms": 1675.798, "learn_time_ms": 77396.744, "learn_throughput": 51.682, "synch_weights_time_ms": 15.318}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 18, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-40-18", "timestamp": 1723488018, "time_this_iter_s": 76.24668312072754, "time_total_s": 1424.4291791915894, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b104c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1424.4291791915894, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 36.989814814814814, "ram_util_percent": 82.80740740740741}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3235943544946664, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.55943219999895, "policy_loss": -0.012932338721551502, "vf_loss": 4.570427996469728, "vf_explained_var": 0.00016665606633991213, "kl": 0.012910294168474914, "entropy": 1.320771226815298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 52170.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.104632140241616, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.164308726111202, "policy_loss": -0.016435028045094145, "vf_loss": 5.178389623063676, "vf_explained_var": 0.022158793291301594, "kl": 0.011770692993560641, "entropy": 1.4325725057446366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 52170.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -1980.0, "episode_reward_mean": 126.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1736.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -71.37, "predator_policy": 113.41666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [325.0, 516.0, 600.0, 474.0, 270.0, 155.0, 441.0, -55.0, 431.0, 515.0, 600.0, 324.0, 556.0, 192.0, 405.0, 366.0, 214.0, 135.0, 552.0, 241.0, 422.0, 488.0, 25.0, 594.0, 600.0, 241.0, 272.0, 296.0, 162.0, -130.0, -185.0, 540.0, 196.0, 558.0, 405.0, 248.0, 436.0, 458.0, 451.0, -18.0, 186.0, 90.0, 564.0, -64.0, -1085.0, 494.0, -479.0, 83.0, 486.0, 319.0, 467.0, 510.0, 326.0, -56.0, 536.0, 280.0, 6.0, 197.0, 168.0, 155.0, 438.0, -20.0, 581.0, -343.0, 251.0, 406.0, -680.0, 496.0, 74.0, 499.0, 61.0, 448.0, -430.0, 336.0, 332.0, 308.0, 221.0, 456.0, 97.0, -715.0, 515.0, -1980.0, -846.0, -1886.0, 460.0, -611.0, -124.0, 465.0, -390.0, 31.0, -41.0, 394.0, -1255.0, -1080.0, 275.0, 306.0, 5.0, 547.0, -970.0, -516.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-64.0, 112.0, 57.0, 200.0, 200.0, 46.0, 200.0, 200.0, 200.0, 90.0, 200.0, 79.0, 13.0, -97.0, 134.0, -64.0, 68.0, -504.0, 57.0, 90.0, 134.0, -570.0, -163.0, 123.0, 68.0, 79.0, 189.0, 189.0, 156.0, 145.0, 200.0, 200.0, 200.0, 101.0, -273.0, 156.0, 200.0, 200.0, 101.0, 200.0, -196.0, -97.0, 101.0, 200.0, -86.0, -218.0, 189.0, 200.0, 35.0, -42.0, -64.0, -64.0, 178.0, -504.0, 112.0, 200.0, 200.0, -20.0, 35.0, 101.0, 200.0, 112.0, -75.0, 134.0, 200.0, 79.0, -75.0, -295.0, 35.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -42.0, -97.0, 90.0, 200.0, -955.0, 57.0, -119.0, 101.0, 24.0, -75.0, -471.0, 178.0, -185.0, -196.0, -229.0, -130.0, -108.0, -317.0, 200.0, 90.0, 200.0, -9.0, -207.0, 2.0, 200.0, 200.0, 123.0, 200.0, -75.0, 90.0, 35.0, -185.0, 13.0, 178.0, -53.0, 101.0, 178.0, -97.0, 167.0, 24.0, 57.0, 200.0, -1043.0, 200.0, 200.0, -64.0, 200.0, -75.0, -64.0, -86.0, -75.0, 145.0, 200.0, 189.0, -196.0, 101.0, -284.0, -438.0, -526.0, -471.0, 79.0, 200.0, 90.0, -317.0, -108.0, -449.0, 2.0, -152.0, 68.0, -9.0, 200.0, 200.0, 24.0, 101.0, -31.0, 200.0, 46.0, 101.0, 156.0, 189.0, 90.0, 178.0, -273.0, 101.0, -284.0, -152.0, -75.0, 178.0, 200.0, 123.0, -119.0, 189.0, -20.0, -449.0, 24.0, -174.0, -9.0, -207.0, 68.0, 112.0, -31.0, -273.0, -416.0, 123.0, 123.0, -97.0, 200.0, 200.0, -229.0, -339.0, 178.0, 200.0, 200.0, 156.0, -196.0, -64.0, -603.0, -438.0, 156.0, 123.0, 2.0, 200.0, 79.0, -988.0, -438.0, -64.0, 123.0, 189.0, 24.0, 200.0, -97.0, -229.0, 200.0, 189.0, 35.0, -229.0, 35.0, 35.0, 112.0, -9.0, 200.0, -1087.0, 200.0, -218.0, 167.0, 46.0, -97.0, -130.0, 134.0, 13.0, -273.0, 112.0, 189.0, -9.0, 112.0, -207.0, 200.0, -31.0, 167.0, 156.0, -614.0, 145.0, -889.0, -1076.0, 145.0, 200.0, 200.0, -20.0, -746.0, -966.0, -823.0, -856.0, 189.0, -779.0, -1065.0, -350.0, -1736.0, 123.0, -75.0, 167.0, -658.0, -42.0, -471.0, 13.0, -922.0, 145.0, 200.0, 112.0, -152.0, -449.0, 167.0, -493.0, -625.0, 200.0, -64.0, -317.0, -779.0, 200.0, 145.0, 145.0, -86.0, -383.0, -1021.0, -856.0, -185.0, -1274.0, -746.0, -394.0, 200.0, 189.0, 24.0, -86.0, 123.0, 167.0, -350.0, -152.0, 200.0, 123.0, 134.0, -130.0, -1725.0, -1285.0, -757.0, -427.0, -207.0], "policy_predator_policy_reward": [155.0, 55.0, 10.0, 0.0, 70.0, 0.0, 0.0, 0.0, 0.0, 55.0, 50.0, 0.0, 105.0, 30.0, 85.0, 120.0, 215.0, 320.0, 85.0, 5.0, 70.0, 320.0, 60.0, 175.0, 0.0, 35.0, 60.0, 25.0, 0.0, 0.0, 0.0, 0.0, 0.0, 150.0, 60.0, 130.0, 0.0, 10.0, 45.0, 110.0, 10.0, 165.0, 15.0, 130.0, 45.0, 195.0, 0.0, 0.0, 50.0, 235.0, 0.0, 10.0, 175.0, 340.0, 0.0, 35.0, 5.0, 100.0, 0.0, 25.0, 20.0, 95.0, 70.0, 20.0, 0.0, 55.0, 5.0, 130.0, 225.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 125.0, 0.0, 165.0, 295.0, 335.0, 340.0, 130.0, 130.0, 30.0, 215.0, 155.0, 160.0, 80.0, 180.0, 220.0, 90.0, 15.0, 265.0, 50.0, 0.0, 0.0, 185.0, 140.0, 85.0, 0.0, 35.0, 0.0, 15.0, 50.0, 125.0, 135.0, 155.0, 95.0, 100.0, 85.0, 25.0, 20.0, 125.0, 65.0, 45.0, 125.0, 0.0, 315.0, 120.0, 190.0, 0.0, 125.0, 0.0, 135.0, 90.0, 90.0, 25.0, 5.0, 0.0, 0.0, 40.0, 275.0, 350.0, 0.0, 0.0, 35.0, 55.0, 35.0, 0.0, 330.0, 65.0, 0.0, 0.0, 165.0, 45.0, 0.0, 50.0, 65.0, 110.0, 50.0, 70.0, 40.0, 10.0, 20.0, 55.0, 0.0, 155.0, 70.0, 95.0, 100.0, 210.0, 145.0, 35.0, 0.0, 0.0, 0.0, 50.0, 180.0, 335.0, 120.0, 150.0, 95.0, 195.0, 55.0, 85.0, 130.0, 145.0, 35.0, 0.0, 290.0, 0.0, 115.0, 20.0, 10.0, 95.0, 265.0, 10.0, 15.0, 0.0, 485.0, 35.0, 0.0, 45.0, 90.0, 275.0, 55.0, 5.0, 65.0, 735.0, 60.0, 15.0, 45.0, 80.0, 35.0, 0.0, 200.0, 0.0, 75.0, 0.0, 0.0, 0.0, 195.0, 25.0, 0.0, 35.0, 110.0, 0.0, 275.0, 400.0, 165.0, 55.0, 0.0, 55.0, 115.0, 145.0, 40.0, 160.0, 80.0, 50.0, 185.0, 90.0, 120.0, 0.0, 0.0, 35.0, 370.0, 5.0, 60.0, 880.0, 165.0, 90.0, 45.0, 0.0, 0.0, 50.0, 505.0, 0.0, 435.0, 165.0, 90.0, 175.0, 1000.0, 70.0, 60.0, 115.0, 135.0, 425.0, 0.0, 85.0, 535.0, 20.0, 30.0, 165.0, 110.0, 55.0, 265.0, 65.0, 105.0, 375.0, 40.0, 0.0, 430.0, 425.0, 45.0, 30.0, 115.0, 310.0, 695.0, 0.0, 550.0, 190.0, 385.0, 260.0, 0.0, 20.0, 0.0, 115.0, 130.0, 0.0, 325.0, 15.0, 35.0, 25.0, 30.0, 705.0, 585.0, 880.0, 360.0, 245.0, 270.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0315632064921794, "mean_inference_ms": 1.6988631135331835, "mean_action_processing_ms": 0.36702257266349464, "mean_env_wait_ms": 0.26121979483573454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008709192276000977, "StateBufferConnector_ms": 0.004341244697570801, "ViewRequirementAgentConnector_ms": 0.15740108489990234}, "num_episodes": 23, "episode_return_max": 600.0, "episode_return_min": -1980.0, "episode_return_mean": 126.14, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.790117965096336, "num_env_steps_trained_throughput_per_sec": 54.790117965096336, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 78544.271, "restore_workers_time_ms": 0.015, "training_step_time_ms": 78544.208, "sample_time_ms": 1669.713, "learn_time_ms": 76854.498, "learn_throughput": 52.046, "synch_weights_time_ms": 14.605}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "training_iteration": 19, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-41-32", "timestamp": 1723488092, "time_this_iter_s": 73.07110714912415, "time_total_s": 1497.5002863407135, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b101fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1497.5002863407135, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 33.91153846153846, "ram_util_percent": 82.92788461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4914993925931606, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9587671213538935, "policy_loss": -0.010482302142500363, "vf_loss": 2.967881252621928, "vf_explained_var": -2.9903248692235203e-05, "kl": 0.009121141589889976, "entropy": 1.2757867024722673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 54990.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.956449448681893, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8724487980206805, "policy_loss": -0.013769654564415798, "vf_loss": 3.8843544386802837, "vf_explained_var": 0.02226053793379601, "kl": 0.009320093566443215, "entropy": 1.4305724511755273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 54990.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -1980.0, "episode_reward_mean": 54.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1736.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -107.08333333333333, "predator_policy": 125.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [552.0, 241.0, 422.0, 488.0, 25.0, 594.0, 600.0, 241.0, 272.0, 296.0, 162.0, -130.0, -185.0, 540.0, 196.0, 558.0, 405.0, 248.0, 436.0, 458.0, 451.0, -18.0, 186.0, 90.0, 564.0, -64.0, -1085.0, 494.0, -479.0, 83.0, 486.0, 319.0, 467.0, 510.0, 326.0, -56.0, 536.0, 280.0, 6.0, 197.0, 168.0, 155.0, 438.0, -20.0, 581.0, -343.0, 251.0, 406.0, -680.0, 496.0, 74.0, 499.0, 61.0, 448.0, -430.0, 336.0, 332.0, 308.0, 221.0, 456.0, 97.0, -715.0, 515.0, -1980.0, -846.0, -1886.0, 460.0, -611.0, -124.0, 465.0, -390.0, 31.0, -41.0, 394.0, -1255.0, -1080.0, 275.0, 306.0, 5.0, 547.0, -970.0, -516.0, 392.0, -1275.0, 161.0, 509.0, -358.0, -65.0, -563.0, 189.0, 440.0, 209.0, 105.0, -205.0, -1468.0, 582.0, 576.0, -881.0, 490.0, 432.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [112.0, 200.0, 200.0, -20.0, 35.0, 101.0, 200.0, 112.0, -75.0, 134.0, 200.0, 79.0, -75.0, -295.0, 35.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -42.0, -97.0, 90.0, 200.0, -955.0, 57.0, -119.0, 101.0, 24.0, -75.0, -471.0, 178.0, -185.0, -196.0, -229.0, -130.0, -108.0, -317.0, 200.0, 90.0, 200.0, -9.0, -207.0, 2.0, 200.0, 200.0, 123.0, 200.0, -75.0, 90.0, 35.0, -185.0, 13.0, 178.0, -53.0, 101.0, 178.0, -97.0, 167.0, 24.0, 57.0, 200.0, -1043.0, 200.0, 200.0, -64.0, 200.0, -75.0, -64.0, -86.0, -75.0, 145.0, 200.0, 189.0, -196.0, 101.0, -284.0, -438.0, -526.0, -471.0, 79.0, 200.0, 90.0, -317.0, -108.0, -449.0, 2.0, -152.0, 68.0, -9.0, 200.0, 200.0, 24.0, 101.0, -31.0, 200.0, 46.0, 101.0, 156.0, 189.0, 90.0, 178.0, -273.0, 101.0, -284.0, -152.0, -75.0, 178.0, 200.0, 123.0, -119.0, 189.0, -20.0, -449.0, 24.0, -174.0, -9.0, -207.0, 68.0, 112.0, -31.0, -273.0, -416.0, 123.0, 123.0, -97.0, 200.0, 200.0, -229.0, -339.0, 178.0, 200.0, 200.0, 156.0, -196.0, -64.0, -603.0, -438.0, 156.0, 123.0, 2.0, 200.0, 79.0, -988.0, -438.0, -64.0, 123.0, 189.0, 24.0, 200.0, -97.0, -229.0, 200.0, 189.0, 35.0, -229.0, 35.0, 35.0, 112.0, -9.0, 200.0, -1087.0, 200.0, -218.0, 167.0, 46.0, -97.0, -130.0, 134.0, 13.0, -273.0, 112.0, 189.0, -9.0, 112.0, -207.0, 200.0, -31.0, 167.0, 156.0, -614.0, 145.0, -889.0, -1076.0, 145.0, 200.0, 200.0, -20.0, -746.0, -966.0, -823.0, -856.0, 189.0, -779.0, -1065.0, -350.0, -1736.0, 123.0, -75.0, 167.0, -658.0, -42.0, -471.0, 13.0, -922.0, 145.0, 200.0, 112.0, -152.0, -449.0, 167.0, -493.0, -625.0, 200.0, -64.0, -317.0, -779.0, 200.0, 145.0, 145.0, -86.0, -383.0, -1021.0, -856.0, -185.0, -1274.0, -746.0, -394.0, 200.0, 189.0, 24.0, -86.0, 123.0, 167.0, -350.0, -152.0, 200.0, 123.0, 134.0, -130.0, -1725.0, -1285.0, -757.0, -427.0, -207.0, -20.0, 101.0, 156.0, -889.0, -889.0, -372.0, 189.0, -97.0, -196.0, -64.0, 178.0, 200.0, 2.0, -108.0, -922.0, -86.0, -174.0, -240.0, -240.0, -1164.0, -64.0, -9.0, 189.0, -306.0, 123.0, 79.0, 123.0, 134.0, -735.0, 200.0, -229.0, -196.0, 35.0, -471.0, -218.0, -86.0, -559.0, -999.0, -955.0, 200.0, 112.0, 200.0, 156.0, 200.0, 200.0, -559.0, 2.0, -834.0, 200.0, 200.0, -20.0, 178.0, -64.0, 178.0], "policy_predator_policy_reward": [0.0, 35.0, 5.0, 100.0, 0.0, 25.0, 20.0, 95.0, 70.0, 20.0, 0.0, 55.0, 5.0, 130.0, 225.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 125.0, 0.0, 165.0, 295.0, 335.0, 340.0, 130.0, 130.0, 30.0, 215.0, 155.0, 160.0, 80.0, 180.0, 220.0, 90.0, 15.0, 265.0, 50.0, 0.0, 0.0, 185.0, 140.0, 85.0, 0.0, 35.0, 0.0, 15.0, 50.0, 125.0, 135.0, 155.0, 95.0, 100.0, 85.0, 25.0, 20.0, 125.0, 65.0, 45.0, 125.0, 0.0, 315.0, 120.0, 190.0, 0.0, 125.0, 0.0, 135.0, 90.0, 90.0, 25.0, 5.0, 0.0, 0.0, 40.0, 275.0, 350.0, 0.0, 0.0, 35.0, 55.0, 35.0, 0.0, 330.0, 65.0, 0.0, 0.0, 165.0, 45.0, 0.0, 50.0, 65.0, 110.0, 50.0, 70.0, 40.0, 10.0, 20.0, 55.0, 0.0, 155.0, 70.0, 95.0, 100.0, 210.0, 145.0, 35.0, 0.0, 0.0, 0.0, 50.0, 180.0, 335.0, 120.0, 150.0, 95.0, 195.0, 55.0, 85.0, 130.0, 145.0, 35.0, 0.0, 290.0, 0.0, 115.0, 20.0, 10.0, 95.0, 265.0, 10.0, 15.0, 0.0, 485.0, 35.0, 0.0, 45.0, 90.0, 275.0, 55.0, 5.0, 65.0, 735.0, 60.0, 15.0, 45.0, 80.0, 35.0, 0.0, 200.0, 0.0, 75.0, 0.0, 0.0, 0.0, 195.0, 25.0, 0.0, 35.0, 110.0, 0.0, 275.0, 400.0, 165.0, 55.0, 0.0, 55.0, 115.0, 145.0, 40.0, 160.0, 80.0, 50.0, 185.0, 90.0, 120.0, 0.0, 0.0, 35.0, 370.0, 5.0, 60.0, 880.0, 165.0, 90.0, 45.0, 0.0, 0.0, 50.0, 505.0, 0.0, 435.0, 165.0, 90.0, 175.0, 1000.0, 70.0, 60.0, 115.0, 135.0, 425.0, 0.0, 85.0, 535.0, 20.0, 30.0, 165.0, 110.0, 55.0, 265.0, 65.0, 105.0, 375.0, 40.0, 0.0, 430.0, 425.0, 45.0, 30.0, 115.0, 310.0, 695.0, 0.0, 550.0, 190.0, 385.0, 260.0, 0.0, 20.0, 0.0, 115.0, 130.0, 0.0, 325.0, 15.0, 35.0, 25.0, 30.0, 705.0, 585.0, 880.0, 360.0, 245.0, 270.0, 20.0, 45.0, 90.0, 750.0, 25.0, 100.0, 105.0, 160.0, 0.0, 120.0, 10.0, 65.0, 605.0, 65.0, 0.0, 200.0, 125.0, 110.0, 65.0, 605.0, 235.0, 55.0, 200.0, 60.0, 30.0, 45.0, 40.0, 170.0, 395.0, 45.0, 265.0, 40.0, 190.0, 335.0, 115.0, 120.0, 100.0, 855.0, 90.0, 0.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 0.0, 510.0, 10.0, 0.0, 100.0, 130.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.026648234627883, "mean_inference_ms": 1.7123070948756458, "mean_action_processing_ms": 0.3664611423139108, "mean_env_wait_ms": 0.2611595922455342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009284377098083496, "StateBufferConnector_ms": 0.004426360130310059, "ViewRequirementAgentConnector_ms": 0.15581226348876953}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -1980.0, "episode_return_mean": 54.2, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.37744849322377, "num_env_steps_trained_throughput_per_sec": 54.37744849322377, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 78040.926, "restore_workers_time_ms": 0.015, "training_step_time_ms": 78040.864, "sample_time_ms": 1674.505, "learn_time_ms": 76345.654, "learn_throughput": 52.393, "synch_weights_time_ms": 14.872}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 20, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-42-45", "timestamp": 1723488165, "time_this_iter_s": 73.6155571937561, "time_total_s": 1571.1158435344696, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b104c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1571.1158435344696, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 35.312380952380956, "ram_util_percent": 83.18095238095238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5329183063185807, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.047281524729222, "policy_loss": -0.012296744568747343, "vf_loss": 5.05804109539546, "vf_explained_var": 0.0005147354822632269, "kl": 0.010247812994474055, "entropy": 1.2803193366273922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 57810.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.271480125442464, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.405426256369192, "policy_loss": -0.01436523073732668, "vf_loss": 6.418267885843913, "vf_explained_var": 0.020396717516243036, "kl": 0.0076179560206944665, "entropy": 1.4060956054968192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 57810.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -2990.0, "episode_reward_mean": -57.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1736.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -166.55666666666667, "predator_policy": 147.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [436.0, 458.0, 451.0, -18.0, 186.0, 90.0, 564.0, -64.0, -1085.0, 494.0, -479.0, 83.0, 486.0, 319.0, 467.0, 510.0, 326.0, -56.0, 536.0, 280.0, 6.0, 197.0, 168.0, 155.0, 438.0, -20.0, 581.0, -343.0, 251.0, 406.0, -680.0, 496.0, 74.0, 499.0, 61.0, 448.0, -430.0, 336.0, 332.0, 308.0, 221.0, 456.0, 97.0, -715.0, 515.0, -1980.0, -846.0, -1886.0, 460.0, -611.0, -124.0, 465.0, -390.0, 31.0, -41.0, 394.0, -1255.0, -1080.0, 275.0, 306.0, 5.0, 547.0, -970.0, -516.0, 392.0, -1275.0, 161.0, 509.0, -358.0, -65.0, -563.0, 189.0, 440.0, 209.0, 105.0, -205.0, -1468.0, 582.0, 576.0, -881.0, 490.0, 432.0, 179.0, -637.0, 304.0, -1884.0, 500.0, 183.0, 205.0, -103.0, -2990.0, -245.0, 600.0, -792.0, -1326.0, -186.0, 115.0, -456.0, 500.0, 361.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.0, -53.0, 101.0, 178.0, -97.0, 167.0, 24.0, 57.0, 200.0, -1043.0, 200.0, 200.0, -64.0, 200.0, -75.0, -64.0, -86.0, -75.0, 145.0, 200.0, 189.0, -196.0, 101.0, -284.0, -438.0, -526.0, -471.0, 79.0, 200.0, 90.0, -317.0, -108.0, -449.0, 2.0, -152.0, 68.0, -9.0, 200.0, 200.0, 24.0, 101.0, -31.0, 200.0, 46.0, 101.0, 156.0, 189.0, 90.0, 178.0, -273.0, 101.0, -284.0, -152.0, -75.0, 178.0, 200.0, 123.0, -119.0, 189.0, -20.0, -449.0, 24.0, -174.0, -9.0, -207.0, 68.0, 112.0, -31.0, -273.0, -416.0, 123.0, 123.0, -97.0, 200.0, 200.0, -229.0, -339.0, 178.0, 200.0, 200.0, 156.0, -196.0, -64.0, -603.0, -438.0, 156.0, 123.0, 2.0, 200.0, 79.0, -988.0, -438.0, -64.0, 123.0, 189.0, 24.0, 200.0, -97.0, -229.0, 200.0, 189.0, 35.0, -229.0, 35.0, 35.0, 112.0, -9.0, 200.0, -1087.0, 200.0, -218.0, 167.0, 46.0, -97.0, -130.0, 134.0, 13.0, -273.0, 112.0, 189.0, -9.0, 112.0, -207.0, 200.0, -31.0, 167.0, 156.0, -614.0, 145.0, -889.0, -1076.0, 145.0, 200.0, 200.0, -20.0, -746.0, -966.0, -823.0, -856.0, 189.0, -779.0, -1065.0, -350.0, -1736.0, 123.0, -75.0, 167.0, -658.0, -42.0, -471.0, 13.0, -922.0, 145.0, 200.0, 112.0, -152.0, -449.0, 167.0, -493.0, -625.0, 200.0, -64.0, -317.0, -779.0, 200.0, 145.0, 145.0, -86.0, -383.0, -1021.0, -856.0, -185.0, -1274.0, -746.0, -394.0, 200.0, 189.0, 24.0, -86.0, 123.0, 167.0, -350.0, -152.0, 200.0, 123.0, 134.0, -130.0, -1725.0, -1285.0, -757.0, -427.0, -207.0, -20.0, 101.0, 156.0, -889.0, -889.0, -372.0, 189.0, -97.0, -196.0, -64.0, 178.0, 200.0, 2.0, -108.0, -922.0, -86.0, -174.0, -240.0, -240.0, -1164.0, -64.0, -9.0, 189.0, -306.0, 123.0, 79.0, 123.0, 134.0, -735.0, 200.0, -229.0, -196.0, 35.0, -471.0, -218.0, -86.0, -559.0, -999.0, -955.0, 200.0, 112.0, 200.0, 156.0, 200.0, 200.0, -559.0, 2.0, -834.0, 200.0, 200.0, -20.0, 178.0, -64.0, 178.0, -746.0, 200.0, 200.0, -405.0, -669.0, -603.0, 178.0, -262.0, 68.0, -1351.0, -636.0, -1637.0, 167.0, 123.0, 145.0, 2.0, -196.0, -163.0, -185.0, -9.0, 134.0, -251.0, -834.0, -53.0, -1648.0, -735.0, -1692.0, -240.0, -251.0, -119.0, 200.0, 200.0, 200.0, -526.0, -911.0, -350.0, -911.0, -1065.0, -570.0, 46.0, 13.0, -735.0, -53.0, -570.0, -42.0, -328.0, -460.0, -328.0, 200.0, 200.0, -20.0, 79.0, -53.0, 145.0], "policy_predator_policy_reward": [100.0, 85.0, 25.0, 20.0, 125.0, 65.0, 45.0, 125.0, 0.0, 315.0, 120.0, 190.0, 0.0, 125.0, 0.0, 135.0, 90.0, 90.0, 25.0, 5.0, 0.0, 0.0, 40.0, 275.0, 350.0, 0.0, 0.0, 35.0, 55.0, 35.0, 0.0, 330.0, 65.0, 0.0, 0.0, 165.0, 45.0, 0.0, 50.0, 65.0, 110.0, 50.0, 70.0, 40.0, 10.0, 20.0, 55.0, 0.0, 155.0, 70.0, 95.0, 100.0, 210.0, 145.0, 35.0, 0.0, 0.0, 0.0, 50.0, 180.0, 335.0, 120.0, 150.0, 95.0, 195.0, 55.0, 85.0, 130.0, 145.0, 35.0, 0.0, 290.0, 0.0, 115.0, 20.0, 10.0, 95.0, 265.0, 10.0, 15.0, 0.0, 485.0, 35.0, 0.0, 45.0, 90.0, 275.0, 55.0, 5.0, 65.0, 735.0, 60.0, 15.0, 45.0, 80.0, 35.0, 0.0, 200.0, 0.0, 75.0, 0.0, 0.0, 0.0, 195.0, 25.0, 0.0, 35.0, 110.0, 0.0, 275.0, 400.0, 165.0, 55.0, 0.0, 55.0, 115.0, 145.0, 40.0, 160.0, 80.0, 50.0, 185.0, 90.0, 120.0, 0.0, 0.0, 35.0, 370.0, 5.0, 60.0, 880.0, 165.0, 90.0, 45.0, 0.0, 0.0, 50.0, 505.0, 0.0, 435.0, 165.0, 90.0, 175.0, 1000.0, 70.0, 60.0, 115.0, 135.0, 425.0, 0.0, 85.0, 535.0, 20.0, 30.0, 165.0, 110.0, 55.0, 265.0, 65.0, 105.0, 375.0, 40.0, 0.0, 430.0, 425.0, 45.0, 30.0, 115.0, 310.0, 695.0, 0.0, 550.0, 190.0, 385.0, 260.0, 0.0, 20.0, 0.0, 115.0, 130.0, 0.0, 325.0, 15.0, 35.0, 25.0, 30.0, 705.0, 585.0, 880.0, 360.0, 245.0, 270.0, 20.0, 45.0, 90.0, 750.0, 25.0, 100.0, 105.0, 160.0, 0.0, 120.0, 10.0, 65.0, 605.0, 65.0, 0.0, 200.0, 125.0, 110.0, 65.0, 605.0, 235.0, 55.0, 200.0, 60.0, 30.0, 45.0, 40.0, 170.0, 395.0, 45.0, 265.0, 40.0, 190.0, 335.0, 115.0, 120.0, 100.0, 855.0, 90.0, 0.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 0.0, 510.0, 10.0, 0.0, 100.0, 130.0, 10.0, 0.0, 90.0, 380.0, 55.0, 490.0, 545.0, 5.0, 60.0, 40.0, 220.0, 775.0, 615.0, 350.0, 15.0, 15.0, 35.0, 315.0, 55.0, 170.0, 50.0, 175.0, 40.0, 460.0, 170.0, 405.0, 155.0, 70.0, 860.0, 0.0, 355.0, 10.0, 0.0, 0.0, 0.0, 120.0, 535.0, 340.0, 115.0, 570.0, 535.0, 50.0, 335.0, 105.0, 110.0, 270.0, 400.0, 170.0, 270.0, 220.0, 50.0, 70.0, 0.0, 75.0, 25.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.022637341816958, "mean_inference_ms": 1.725347665100611, "mean_action_processing_ms": 0.36618770600221656, "mean_env_wait_ms": 0.2611650621393723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008843421936035156, "StateBufferConnector_ms": 0.004443049430847168, "ViewRequirementAgentConnector_ms": 0.15369951725006104}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -2990.0, "episode_return_mean": -57.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.98098927098778, "num_env_steps_trained_throughput_per_sec": 53.98098927098778, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 77367.366, "restore_workers_time_ms": 0.014, "training_step_time_ms": 77367.304, "sample_time_ms": 1641.863, "learn_time_ms": 75704.851, "learn_throughput": 52.837, "synch_weights_time_ms": 14.611}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "training_iteration": 21, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-43-59", "timestamp": 1723488239, "time_this_iter_s": 74.1379120349884, "time_total_s": 1645.253755569458, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32f77f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1645.253755569458, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 34.72, "ram_util_percent": 82.80761904761904}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.489608309835407, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.989938463725097, "policy_loss": -0.011776765640445238, "vf_loss": 7.00007253217359, "vf_explained_var": 0.00022022850970004467, "kl": 0.010951349832420987, "entropy": 1.2552094611715763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 60630.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.755193096779762, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.068308745884726, "policy_loss": -0.013076262046081007, "vf_loss": 9.07978420764842, "vf_explained_var": 0.007248662000006818, "kl": 0.008004002708110861, "entropy": 1.3845914888889232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 60630.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -3871.0, "episode_reward_mean": -388.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -338.37666666666667, "predator_policy": 208.73333333333332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [536.0, 280.0, 6.0, 197.0, 168.0, 155.0, 438.0, -20.0, 581.0, -343.0, 251.0, 406.0, -680.0, 496.0, 74.0, 499.0, 61.0, 448.0, -430.0, 336.0, 332.0, 308.0, 221.0, 456.0, 97.0, -715.0, 515.0, -1980.0, -846.0, -1886.0, 460.0, -611.0, -124.0, 465.0, -390.0, 31.0, -41.0, 394.0, -1255.0, -1080.0, 275.0, 306.0, 5.0, 547.0, -970.0, -516.0, 392.0, -1275.0, 161.0, 509.0, -358.0, -65.0, -563.0, 189.0, 440.0, 209.0, 105.0, -205.0, -1468.0, 582.0, 576.0, -881.0, 490.0, 432.0, 179.0, -637.0, 304.0, -1884.0, 500.0, 183.0, 205.0, -103.0, -2990.0, -245.0, 600.0, -792.0, -1326.0, -186.0, 115.0, -456.0, 500.0, 361.0, -2931.0, -2023.0, -712.0, -2848.0, 465.0, -2619.0, -945.0, -2231.0, -1463.0, -2243.0, -537.0, -3871.0, -2581.0, -1584.0, -49.0, -1282.0, -1988.0, -506.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.0, 200.0, 123.0, -119.0, 189.0, -20.0, -449.0, 24.0, -174.0, -9.0, -207.0, 68.0, 112.0, -31.0, -273.0, -416.0, 123.0, 123.0, -97.0, 200.0, 200.0, -229.0, -339.0, 178.0, 200.0, 200.0, 156.0, -196.0, -64.0, -603.0, -438.0, 156.0, 123.0, 2.0, 200.0, 79.0, -988.0, -438.0, -64.0, 123.0, 189.0, 24.0, 200.0, -97.0, -229.0, 200.0, 189.0, 35.0, -229.0, 35.0, 35.0, 112.0, -9.0, 200.0, -1087.0, 200.0, -218.0, 167.0, 46.0, -97.0, -130.0, 134.0, 13.0, -273.0, 112.0, 189.0, -9.0, 112.0, -207.0, 200.0, -31.0, 167.0, 156.0, -614.0, 145.0, -889.0, -1076.0, 145.0, 200.0, 200.0, -20.0, -746.0, -966.0, -823.0, -856.0, 189.0, -779.0, -1065.0, -350.0, -1736.0, 123.0, -75.0, 167.0, -658.0, -42.0, -471.0, 13.0, -922.0, 145.0, 200.0, 112.0, -152.0, -449.0, 167.0, -493.0, -625.0, 200.0, -64.0, -317.0, -779.0, 200.0, 145.0, 145.0, -86.0, -383.0, -1021.0, -856.0, -185.0, -1274.0, -746.0, -394.0, 200.0, 189.0, 24.0, -86.0, 123.0, 167.0, -350.0, -152.0, 200.0, 123.0, 134.0, -130.0, -1725.0, -1285.0, -757.0, -427.0, -207.0, -20.0, 101.0, 156.0, -889.0, -889.0, -372.0, 189.0, -97.0, -196.0, -64.0, 178.0, 200.0, 2.0, -108.0, -922.0, -86.0, -174.0, -240.0, -240.0, -1164.0, -64.0, -9.0, 189.0, -306.0, 123.0, 79.0, 123.0, 134.0, -735.0, 200.0, -229.0, -196.0, 35.0, -471.0, -218.0, -86.0, -559.0, -999.0, -955.0, 200.0, 112.0, 200.0, 156.0, 200.0, 200.0, -559.0, 2.0, -834.0, 200.0, 200.0, -20.0, 178.0, -64.0, 178.0, -746.0, 200.0, 200.0, -405.0, -669.0, -603.0, 178.0, -262.0, 68.0, -1351.0, -636.0, -1637.0, 167.0, 123.0, 145.0, 2.0, -196.0, -163.0, -185.0, -9.0, 134.0, -251.0, -834.0, -53.0, -1648.0, -735.0, -1692.0, -240.0, -251.0, -119.0, 200.0, 200.0, 200.0, -526.0, -911.0, -350.0, -911.0, -1065.0, -570.0, 46.0, 13.0, -735.0, -53.0, -570.0, -42.0, -328.0, -460.0, -328.0, 200.0, 200.0, -20.0, 79.0, -53.0, 145.0, -1890.0, -1582.0, -1659.0, -1373.0, -1021.0, -1604.0, -460.0, -1472.0, -75.0, -1659.0, -1274.0, -1560.0, 200.0, 46.0, 79.0, -1483.0, -1417.0, -1219.0, 13.0, -1791.0, -1032.0, -1175.0, -1527.0, -724.0, -1340.0, -361.0, -592.0, -1054.0, -1384.0, -1010.0, -581.0, -273.0, -108.0, -1472.0, -1670.0, -1714.0, -999.0, -1560.0, -1802.0, -724.0, -1043.0, -867.0, -20.0, -152.0, -262.0, -482.0, -2000.0, -900.0, -1703.0, -537.0, -823.0, -1516.0, -97.0, 2.0], "policy_predator_policy_reward": [35.0, 0.0, 0.0, 0.0, 50.0, 180.0, 335.0, 120.0, 150.0, 95.0, 195.0, 55.0, 85.0, 130.0, 145.0, 35.0, 0.0, 290.0, 0.0, 115.0, 20.0, 10.0, 95.0, 265.0, 10.0, 15.0, 0.0, 485.0, 35.0, 0.0, 45.0, 90.0, 275.0, 55.0, 5.0, 65.0, 735.0, 60.0, 15.0, 45.0, 80.0, 35.0, 0.0, 200.0, 0.0, 75.0, 0.0, 0.0, 0.0, 195.0, 25.0, 0.0, 35.0, 110.0, 0.0, 275.0, 400.0, 165.0, 55.0, 0.0, 55.0, 115.0, 145.0, 40.0, 160.0, 80.0, 50.0, 185.0, 90.0, 120.0, 0.0, 0.0, 35.0, 370.0, 5.0, 60.0, 880.0, 165.0, 90.0, 45.0, 0.0, 0.0, 50.0, 505.0, 0.0, 435.0, 165.0, 90.0, 175.0, 1000.0, 70.0, 60.0, 115.0, 135.0, 425.0, 0.0, 85.0, 535.0, 20.0, 30.0, 165.0, 110.0, 55.0, 265.0, 65.0, 105.0, 375.0, 40.0, 0.0, 430.0, 425.0, 45.0, 30.0, 115.0, 310.0, 695.0, 0.0, 550.0, 190.0, 385.0, 260.0, 0.0, 20.0, 0.0, 115.0, 130.0, 0.0, 325.0, 15.0, 35.0, 25.0, 30.0, 705.0, 585.0, 880.0, 360.0, 245.0, 270.0, 20.0, 45.0, 90.0, 750.0, 25.0, 100.0, 105.0, 160.0, 0.0, 120.0, 10.0, 65.0, 605.0, 65.0, 0.0, 200.0, 125.0, 110.0, 65.0, 605.0, 235.0, 55.0, 200.0, 60.0, 30.0, 45.0, 40.0, 170.0, 395.0, 45.0, 265.0, 40.0, 190.0, 335.0, 115.0, 120.0, 100.0, 855.0, 90.0, 0.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 0.0, 510.0, 10.0, 0.0, 100.0, 130.0, 10.0, 0.0, 90.0, 380.0, 55.0, 490.0, 545.0, 5.0, 60.0, 40.0, 220.0, 775.0, 615.0, 350.0, 15.0, 15.0, 35.0, 315.0, 55.0, 170.0, 50.0, 175.0, 40.0, 460.0, 170.0, 405.0, 155.0, 70.0, 860.0, 0.0, 355.0, 10.0, 0.0, 0.0, 0.0, 120.0, 535.0, 340.0, 115.0, 570.0, 535.0, 50.0, 335.0, 105.0, 110.0, 270.0, 400.0, 170.0, 270.0, 220.0, 50.0, 70.0, 0.0, 75.0, 25.0, 90.0, 980.0, 705.0, 515.0, 805.0, 705.0, 465.0, 230.0, 270.0, 795.0, 125.0, 650.0, 870.0, 120.0, 20.0, 0.0, 650.0, 850.0, 0.0, 630.0, 670.0, 565.0, 815.0, 380.0, 0.0, 90.0, 0.0, 740.0, 785.0, 0.0, 420.0, 0.0, 0.0, 425.0, 0.0, 900.0, 85.0, 865.0, 890.0, 25.0, 15.0, 670.0, 365.0, 235.0, 125.0, 25.0, 645.0, 930.0, 525.0, 150.0, 90.0, 835.0, 330.0, 475.0, 300.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0175373930159741, "mean_inference_ms": 1.734587627156651, "mean_action_processing_ms": 0.36557279428518924, "mean_env_wait_ms": 0.2606518571032585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008086323738098145, "StateBufferConnector_ms": 0.004381060600280762, "ViewRequirementAgentConnector_ms": 0.14635157585144043}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -3871.0, "episode_return_mean": -388.93, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 52.15543397523379, "num_env_steps_trained_throughput_per_sec": 52.15543397523379, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 76702.266, "restore_workers_time_ms": 0.014, "training_step_time_ms": 76702.203, "sample_time_ms": 1607.166, "learn_time_ms": 75073.634, "learn_throughput": 53.281, "synch_weights_time_ms": 14.89}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 22, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-45-16", "timestamp": 1723488316, "time_this_iter_s": 76.71211504936218, "time_total_s": 1721.9658706188202, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b104c820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1721.9658706188202, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 38.933333333333344, "ram_util_percent": 83.01111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5588312010393075, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.410280773656588, "policy_loss": -0.013779602487002258, "vf_loss": 8.422467453936314, "vf_explained_var": -1.978269705535672e-05, "kl": 0.010619458177988447, "entropy": 1.2401380781586289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 63450.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.323850279729417, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.324166960411883, "policy_loss": -0.013901630874412756, "vf_loss": 9.33637478909594, "vf_explained_var": 0.006127203948108863, "kl": 0.008468966646904066, "entropy": 1.3534964506085037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 63450.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -3871.0, "episode_reward_mean": -922.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -609.7466666666667, "predator_policy": 302.3666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1980.0, -846.0, -1886.0, 460.0, -611.0, -124.0, 465.0, -390.0, 31.0, -41.0, 394.0, -1255.0, -1080.0, 275.0, 306.0, 5.0, 547.0, -970.0, -516.0, 392.0, -1275.0, 161.0, 509.0, -358.0, -65.0, -563.0, 189.0, 440.0, 209.0, 105.0, -205.0, -1468.0, 582.0, 576.0, -881.0, 490.0, 432.0, 179.0, -637.0, 304.0, -1884.0, 500.0, 183.0, 205.0, -103.0, -2990.0, -245.0, 600.0, -792.0, -1326.0, -186.0, 115.0, -456.0, 500.0, 361.0, -2931.0, -2023.0, -712.0, -2848.0, 465.0, -2619.0, -945.0, -2231.0, -1463.0, -2243.0, -537.0, -3871.0, -2581.0, -1584.0, -49.0, -1282.0, -1988.0, -506.0, -2496.0, -2395.0, 370.0, -1207.0, -2462.0, -2089.0, -163.0, -2231.0, -271.0, -1549.0, -3176.0, -2793.0, -2886.0, -2037.0, -1698.0, -3187.0, -1911.0, -784.0, -2416.0, -1429.0, -3300.0, 510.0, -1876.0, -1377.0, -591.0, -3290.0, -1914.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-746.0, -966.0, -823.0, -856.0, 189.0, -779.0, -1065.0, -350.0, -1736.0, 123.0, -75.0, 167.0, -658.0, -42.0, -471.0, 13.0, -922.0, 145.0, 200.0, 112.0, -152.0, -449.0, 167.0, -493.0, -625.0, 200.0, -64.0, -317.0, -779.0, 200.0, 145.0, 145.0, -86.0, -383.0, -1021.0, -856.0, -185.0, -1274.0, -746.0, -394.0, 200.0, 189.0, 24.0, -86.0, 123.0, 167.0, -350.0, -152.0, 200.0, 123.0, 134.0, -130.0, -1725.0, -1285.0, -757.0, -427.0, -207.0, -20.0, 101.0, 156.0, -889.0, -889.0, -372.0, 189.0, -97.0, -196.0, -64.0, 178.0, 200.0, 2.0, -108.0, -922.0, -86.0, -174.0, -240.0, -240.0, -1164.0, -64.0, -9.0, 189.0, -306.0, 123.0, 79.0, 123.0, 134.0, -735.0, 200.0, -229.0, -196.0, 35.0, -471.0, -218.0, -86.0, -559.0, -999.0, -955.0, 200.0, 112.0, 200.0, 156.0, 200.0, 200.0, -559.0, 2.0, -834.0, 200.0, 200.0, -20.0, 178.0, -64.0, 178.0, -746.0, 200.0, 200.0, -405.0, -669.0, -603.0, 178.0, -262.0, 68.0, -1351.0, -636.0, -1637.0, 167.0, 123.0, 145.0, 2.0, -196.0, -163.0, -185.0, -9.0, 134.0, -251.0, -834.0, -53.0, -1648.0, -735.0, -1692.0, -240.0, -251.0, -119.0, 200.0, 200.0, 200.0, -526.0, -911.0, -350.0, -911.0, -1065.0, -570.0, 46.0, 13.0, -735.0, -53.0, -570.0, -42.0, -328.0, -460.0, -328.0, 200.0, 200.0, -20.0, 79.0, -53.0, 145.0, -1890.0, -1582.0, -1659.0, -1373.0, -1021.0, -1604.0, -460.0, -1472.0, -75.0, -1659.0, -1274.0, -1560.0, 200.0, 46.0, 79.0, -1483.0, -1417.0, -1219.0, 13.0, -1791.0, -1032.0, -1175.0, -1527.0, -724.0, -1340.0, -361.0, -592.0, -1054.0, -1384.0, -1010.0, -581.0, -273.0, -108.0, -1472.0, -1670.0, -1714.0, -999.0, -1560.0, -1802.0, -724.0, -1043.0, -867.0, -20.0, -152.0, -262.0, -482.0, -2000.0, -900.0, -1703.0, -537.0, -823.0, -1516.0, -97.0, 2.0, -1505.0, -1230.0, -1351.0, -1054.0, -1549.0, -1032.0, -42.0, -97.0, 79.0, -768.0, -1032.0, -592.0, -1956.0, -944.0, -1472.0, -1285.0, -768.0, -1626.0, -174.0, -86.0, -218.0, -933.0, -1648.0, -1120.0, -262.0, -317.0, -427.0, -812.0, -669.0, -768.0, -1351.0, -1329.0, -1736.0, -1824.0, -1153.0, -1131.0, -1549.0, -1318.0, -1549.0, -1373.0, -1582.0, -482.0, -1274.0, -1142.0, -1142.0, -1362.0, -1417.0, -1758.0, -1681.0, -152.0, -1868.0, -1439.0, -372.0, -493.0, -1406.0, -1670.0, -1725.0, -1329.0, 24.0, -1769.0, -2000.0, -1692.0, -1868.0, 101.0, 200.0, 134.0, -922.0, -1098.0, -1021.0, -768.0, -1263.0, -1131.0, -350.0, -471.0, -515.0, -1923.0, -1857.0, -1725.0, -911.0, -1032.0, -1296.0], "policy_predator_policy_reward": [0.0, 50.0, 505.0, 0.0, 435.0, 165.0, 90.0, 175.0, 1000.0, 70.0, 60.0, 115.0, 135.0, 425.0, 0.0, 85.0, 535.0, 20.0, 30.0, 165.0, 110.0, 55.0, 265.0, 65.0, 105.0, 375.0, 40.0, 0.0, 430.0, 425.0, 45.0, 30.0, 115.0, 310.0, 695.0, 0.0, 550.0, 190.0, 385.0, 260.0, 0.0, 20.0, 0.0, 115.0, 130.0, 0.0, 325.0, 15.0, 35.0, 25.0, 30.0, 705.0, 585.0, 880.0, 360.0, 245.0, 270.0, 20.0, 45.0, 90.0, 750.0, 25.0, 100.0, 105.0, 160.0, 0.0, 120.0, 10.0, 65.0, 605.0, 65.0, 0.0, 200.0, 125.0, 110.0, 65.0, 605.0, 235.0, 55.0, 200.0, 60.0, 30.0, 45.0, 40.0, 170.0, 395.0, 45.0, 265.0, 40.0, 190.0, 335.0, 115.0, 120.0, 100.0, 855.0, 90.0, 0.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 0.0, 510.0, 10.0, 0.0, 100.0, 130.0, 10.0, 0.0, 90.0, 380.0, 55.0, 490.0, 545.0, 5.0, 60.0, 40.0, 220.0, 775.0, 615.0, 350.0, 15.0, 15.0, 35.0, 315.0, 55.0, 170.0, 50.0, 175.0, 40.0, 460.0, 170.0, 405.0, 155.0, 70.0, 860.0, 0.0, 355.0, 10.0, 0.0, 0.0, 0.0, 120.0, 535.0, 340.0, 115.0, 570.0, 535.0, 50.0, 335.0, 105.0, 110.0, 270.0, 400.0, 170.0, 270.0, 220.0, 50.0, 70.0, 0.0, 75.0, 25.0, 90.0, 980.0, 705.0, 515.0, 805.0, 705.0, 465.0, 230.0, 270.0, 795.0, 125.0, 650.0, 870.0, 120.0, 20.0, 0.0, 650.0, 850.0, 0.0, 630.0, 670.0, 565.0, 815.0, 380.0, 0.0, 90.0, 0.0, 740.0, 785.0, 0.0, 420.0, 0.0, 0.0, 425.0, 0.0, 900.0, 85.0, 865.0, 890.0, 25.0, 15.0, 670.0, 365.0, 235.0, 125.0, 25.0, 645.0, 930.0, 525.0, 150.0, 90.0, 835.0, 330.0, 475.0, 300.0, 325.0, 805.0, 460.0, 695.0, 515.0, 30.0, 135.0, 180.0, 115.0, 295.0, 375.0, 515.0, 500.0, 920.0, 490.0, 710.0, 210.0, 670.0, 170.0, 75.0, 70.0, 765.0, 670.0, 35.0, 200.0, 130.0, 405.0, 535.0, 100.0, 65.0, 165.0, 895.0, 180.0, 970.0, 255.0, 90.0, 90.0, 510.0, 930.0, 350.0, 830.0, 220.0, 755.0, 475.0, 630.0, 390.0, 280.0, 680.0, 465.0, 925.0, 400.0, 695.0, 630.0, 195.0, 875.0, 585.0, 925.0, 545.0, 805.0, 295.0, 870.0, 950.0, 440.0, 45.0, 30.0, 0.0, 230.0, 405.0, 530.0, 855.0, 555.0, 375.0, 345.0, 205.0, 195.0, 765.0, 480.0, 970.0, 525.0, 710.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0102678561730243, "mean_inference_ms": 1.7230767905806457, "mean_action_processing_ms": 0.36456591104735525, "mean_env_wait_ms": 0.2592497563496941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006629347801208496, "StateBufferConnector_ms": 0.005149722099304199, "ViewRequirementAgentConnector_ms": 0.15123474597930908}, "num_episodes": 27, "episode_return_max": 600.0, "episode_return_min": -3871.0, "episode_return_mean": -922.14, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 51.266052447353516, "num_env_steps_trained_throughput_per_sec": 51.266052447353516, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 76493.276, "restore_workers_time_ms": 0.014, "training_step_time_ms": 76493.221, "sample_time_ms": 1612.959, "learn_time_ms": 74859.813, "learn_throughput": 53.433, "synch_weights_time_ms": 14.734}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "training_iteration": 23, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-46-34", "timestamp": 1723488394, "time_this_iter_s": 78.06408882141113, "time_total_s": 1800.0299594402313, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b106aa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1800.0299594402313, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 40.38288288288289, "ram_util_percent": 82.72522522522524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5084529215773792, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.331811560130289, "policy_loss": -0.010171702355191818, "vf_loss": 8.340830621482633, "vf_explained_var": -5.762860284629443e-05, "kl": 0.007684374065094792, "entropy": 1.222522550271758, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 66270.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.730907610396967, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.667432625243004, "policy_loss": -0.014422662209980322, "vf_loss": 8.679961875651745, "vf_explained_var": 0.010994174928529887, "kl": 0.009466989186449797, "entropy": 1.3424260315742897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 66270.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -3871.0, "episode_reward_mean": -1132.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -742.7, "predator_policy": 365.0833333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-516.0, 392.0, -1275.0, 161.0, 509.0, -358.0, -65.0, -563.0, 189.0, 440.0, 209.0, 105.0, -205.0, -1468.0, 582.0, 576.0, -881.0, 490.0, 432.0, 179.0, -637.0, 304.0, -1884.0, 500.0, 183.0, 205.0, -103.0, -2990.0, -245.0, 600.0, -792.0, -1326.0, -186.0, 115.0, -456.0, 500.0, 361.0, -2931.0, -2023.0, -712.0, -2848.0, 465.0, -2619.0, -945.0, -2231.0, -1463.0, -2243.0, -537.0, -3871.0, -2581.0, -1584.0, -49.0, -1282.0, -1988.0, -506.0, -2496.0, -2395.0, 370.0, -1207.0, -2462.0, -2089.0, -163.0, -2231.0, -271.0, -1549.0, -3176.0, -2793.0, -2886.0, -2037.0, -1698.0, -3187.0, -1911.0, -784.0, -2416.0, -1429.0, -3300.0, 510.0, -1876.0, -1377.0, -591.0, -3290.0, -1914.0, -2171.0, -2332.0, -818.0, -1106.0, -2126.0, -940.0, -1551.0, -2205.0, -1938.0, -409.0, 70.0, -3255.0, -1788.0, -1548.0, -901.0, -1663.0, -3164.0, 74.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-757.0, -427.0, -207.0, -20.0, 101.0, 156.0, -889.0, -889.0, -372.0, 189.0, -97.0, -196.0, -64.0, 178.0, 200.0, 2.0, -108.0, -922.0, -86.0, -174.0, -240.0, -240.0, -1164.0, -64.0, -9.0, 189.0, -306.0, 123.0, 79.0, 123.0, 134.0, -735.0, 200.0, -229.0, -196.0, 35.0, -471.0, -218.0, -86.0, -559.0, -999.0, -955.0, 200.0, 112.0, 200.0, 156.0, 200.0, 200.0, -559.0, 2.0, -834.0, 200.0, 200.0, -20.0, 178.0, -64.0, 178.0, -746.0, 200.0, 200.0, -405.0, -669.0, -603.0, 178.0, -262.0, 68.0, -1351.0, -636.0, -1637.0, 167.0, 123.0, 145.0, 2.0, -196.0, -163.0, -185.0, -9.0, 134.0, -251.0, -834.0, -53.0, -1648.0, -735.0, -1692.0, -240.0, -251.0, -119.0, 200.0, 200.0, 200.0, -526.0, -911.0, -350.0, -911.0, -1065.0, -570.0, 46.0, 13.0, -735.0, -53.0, -570.0, -42.0, -328.0, -460.0, -328.0, 200.0, 200.0, -20.0, 79.0, -53.0, 145.0, -1890.0, -1582.0, -1659.0, -1373.0, -1021.0, -1604.0, -460.0, -1472.0, -75.0, -1659.0, -1274.0, -1560.0, 200.0, 46.0, 79.0, -1483.0, -1417.0, -1219.0, 13.0, -1791.0, -1032.0, -1175.0, -1527.0, -724.0, -1340.0, -361.0, -592.0, -1054.0, -1384.0, -1010.0, -581.0, -273.0, -108.0, -1472.0, -1670.0, -1714.0, -999.0, -1560.0, -1802.0, -724.0, -1043.0, -867.0, -20.0, -152.0, -262.0, -482.0, -2000.0, -900.0, -1703.0, -537.0, -823.0, -1516.0, -97.0, 2.0, -1505.0, -1230.0, -1351.0, -1054.0, -1549.0, -1032.0, -42.0, -97.0, 79.0, -768.0, -1032.0, -592.0, -1956.0, -944.0, -1472.0, -1285.0, -768.0, -1626.0, -174.0, -86.0, -218.0, -933.0, -1648.0, -1120.0, -262.0, -317.0, -427.0, -812.0, -669.0, -768.0, -1351.0, -1329.0, -1736.0, -1824.0, -1153.0, -1131.0, -1549.0, -1318.0, -1549.0, -1373.0, -1582.0, -482.0, -1274.0, -1142.0, -1142.0, -1362.0, -1417.0, -1758.0, -1681.0, -152.0, -1868.0, -1439.0, -372.0, -493.0, -1406.0, -1670.0, -1725.0, -1329.0, 24.0, -1769.0, -2000.0, -1692.0, -1868.0, 101.0, 200.0, 134.0, -922.0, -1098.0, -1021.0, -768.0, -1263.0, -1131.0, -350.0, -471.0, -515.0, -1923.0, -1857.0, -1725.0, -911.0, -1032.0, -1296.0, -1285.0, -1197.0, -1219.0, -1637.0, -1087.0, -1208.0, -1406.0, -724.0, -493.0, -1681.0, -1703.0, -42.0, -1582.0, -977.0, -1967.0, -97.0, -1846.0, -1142.0, -988.0, -911.0, -812.0, -1934.0, -1791.0, 35.0, -1835.0, -757.0, -1351.0, -933.0, 57.0, -493.0, 200.0, 200.0, -845.0, -1857.0, -1912.0, -1461.0, -812.0, -1483.0, -1428.0, 68.0, -1593.0, -1593.0, -779.0, -768.0, -614.0, -1307.0, -1428.0, -493.0, -1604.0, -1725.0, -2000.0, 79.0, -1868.0, 68.0], "policy_predator_policy_reward": [360.0, 245.0, 270.0, 20.0, 45.0, 90.0, 750.0, 25.0, 100.0, 105.0, 160.0, 0.0, 120.0, 10.0, 65.0, 605.0, 65.0, 0.0, 200.0, 125.0, 110.0, 65.0, 605.0, 235.0, 55.0, 200.0, 60.0, 30.0, 45.0, 40.0, 170.0, 395.0, 45.0, 265.0, 40.0, 190.0, 335.0, 115.0, 120.0, 100.0, 855.0, 90.0, 0.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 0.0, 510.0, 10.0, 0.0, 100.0, 130.0, 10.0, 0.0, 90.0, 380.0, 55.0, 490.0, 545.0, 5.0, 60.0, 40.0, 220.0, 775.0, 615.0, 350.0, 15.0, 15.0, 35.0, 315.0, 55.0, 170.0, 50.0, 175.0, 40.0, 460.0, 170.0, 405.0, 155.0, 70.0, 860.0, 0.0, 355.0, 10.0, 0.0, 0.0, 0.0, 120.0, 535.0, 340.0, 115.0, 570.0, 535.0, 50.0, 335.0, 105.0, 110.0, 270.0, 400.0, 170.0, 270.0, 220.0, 50.0, 70.0, 0.0, 75.0, 25.0, 90.0, 980.0, 705.0, 515.0, 805.0, 705.0, 465.0, 230.0, 270.0, 795.0, 125.0, 650.0, 870.0, 120.0, 20.0, 0.0, 650.0, 850.0, 0.0, 630.0, 670.0, 565.0, 815.0, 380.0, 0.0, 90.0, 0.0, 740.0, 785.0, 0.0, 420.0, 0.0, 0.0, 425.0, 0.0, 900.0, 85.0, 865.0, 890.0, 25.0, 15.0, 670.0, 365.0, 235.0, 125.0, 25.0, 645.0, 930.0, 525.0, 150.0, 90.0, 835.0, 330.0, 475.0, 300.0, 325.0, 805.0, 460.0, 695.0, 515.0, 30.0, 135.0, 180.0, 115.0, 295.0, 375.0, 515.0, 500.0, 920.0, 490.0, 710.0, 210.0, 670.0, 170.0, 75.0, 70.0, 765.0, 670.0, 35.0, 200.0, 130.0, 405.0, 535.0, 100.0, 65.0, 165.0, 895.0, 180.0, 970.0, 255.0, 90.0, 90.0, 510.0, 930.0, 350.0, 830.0, 220.0, 755.0, 475.0, 630.0, 390.0, 280.0, 680.0, 465.0, 925.0, 400.0, 695.0, 630.0, 195.0, 875.0, 585.0, 925.0, 545.0, 805.0, 295.0, 870.0, 950.0, 440.0, 45.0, 30.0, 0.0, 230.0, 405.0, 530.0, 855.0, 555.0, 375.0, 345.0, 205.0, 195.0, 765.0, 480.0, 970.0, 525.0, 710.0, 90.0, 380.0, 890.0, 260.0, 635.0, 165.0, 800.0, 495.0, 570.0, 740.0, 615.0, 920.0, 785.0, 905.0, 540.0, 955.0, 820.0, 430.0, 895.0, 375.0, 215.0, 570.0, 280.0, 980.0, 225.0, 545.0, 630.0, 830.0, 370.0, 225.0, 365.0, 205.0, 0.0, 310.0, 965.0, 330.0, 680.0, 460.0, 865.0, 610.0, 840.0, 525.0, 205.0, 550.0, 370.0, 340.0, 695.0, 15.0, 855.0, 690.0, 995.0, 480.0, 610.0, 585.0, 600.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0064270725815812, "mean_inference_ms": 1.7176258964896687, "mean_action_processing_ms": 0.3643182638827484, "mean_env_wait_ms": 0.259413059279004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055959224700927734, "StateBufferConnector_ms": 0.005152583122253418, "ViewRequirementAgentConnector_ms": 0.15098309516906738}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -3871.0, "episode_return_mean": -1132.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 51.886951858345896, "num_env_steps_trained_throughput_per_sec": 51.886951858345896, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 76052.236, "restore_workers_time_ms": 0.014, "training_step_time_ms": 76052.181, "sample_time_ms": 1603.137, "learn_time_ms": 74427.505, "learn_throughput": 53.744, "synch_weights_time_ms": 15.74}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 24, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-47-51", "timestamp": 1723488471, "time_this_iter_s": 77.12759232521057, "time_total_s": 1877.157551765442, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b231c160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1877.157551765442, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 41.470909090909096, "ram_util_percent": 83.06363636363638}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5879662949776818, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.463753244217406, "policy_loss": -0.009711678450636512, "vf_loss": 8.47244729928091, "vf_explained_var": -0.0009656421047575931, "kl": 0.0067842652802940885, "entropy": 1.1793848646025287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 69090.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.630597703528743, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.583115968974769, "policy_loss": -0.015066330825434402, "vf_loss": 7.596155787697921, "vf_explained_var": 0.01513177088811888, "kl": 0.010132567539806904, "entropy": 1.3348033631947023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 69090.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -3871.0, "episode_reward_mean": -1336.32, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -873.49, "predator_policy": 428.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [432.0, 179.0, -637.0, 304.0, -1884.0, 500.0, 183.0, 205.0, -103.0, -2990.0, -245.0, 600.0, -792.0, -1326.0, -186.0, 115.0, -456.0, 500.0, 361.0, -2931.0, -2023.0, -712.0, -2848.0, 465.0, -2619.0, -945.0, -2231.0, -1463.0, -2243.0, -537.0, -3871.0, -2581.0, -1584.0, -49.0, -1282.0, -1988.0, -506.0, -2496.0, -2395.0, 370.0, -1207.0, -2462.0, -2089.0, -163.0, -2231.0, -271.0, -1549.0, -3176.0, -2793.0, -2886.0, -2037.0, -1698.0, -3187.0, -1911.0, -784.0, -2416.0, -1429.0, -3300.0, 510.0, -1876.0, -1377.0, -591.0, -3290.0, -1914.0, -2171.0, -2332.0, -818.0, -1106.0, -2126.0, -940.0, -1551.0, -2205.0, -1938.0, -409.0, 70.0, -3255.0, -1788.0, -1548.0, -901.0, -1663.0, -3164.0, 74.0, -668.0, -657.0, 517.0, -1264.0, -694.0, -420.0, -484.0, -2759.0, -2349.0, -530.0, -2671.0, -532.0, -3104.0, -663.0, -1267.0, -1717.0, -1767.0, -996.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.0, -64.0, 178.0, -746.0, 200.0, 200.0, -405.0, -669.0, -603.0, 178.0, -262.0, 68.0, -1351.0, -636.0, -1637.0, 167.0, 123.0, 145.0, 2.0, -196.0, -163.0, -185.0, -9.0, 134.0, -251.0, -834.0, -53.0, -1648.0, -735.0, -1692.0, -240.0, -251.0, -119.0, 200.0, 200.0, 200.0, -526.0, -911.0, -350.0, -911.0, -1065.0, -570.0, 46.0, 13.0, -735.0, -53.0, -570.0, -42.0, -328.0, -460.0, -328.0, 200.0, 200.0, -20.0, 79.0, -53.0, 145.0, -1890.0, -1582.0, -1659.0, -1373.0, -1021.0, -1604.0, -460.0, -1472.0, -75.0, -1659.0, -1274.0, -1560.0, 200.0, 46.0, 79.0, -1483.0, -1417.0, -1219.0, 13.0, -1791.0, -1032.0, -1175.0, -1527.0, -724.0, -1340.0, -361.0, -592.0, -1054.0, -1384.0, -1010.0, -581.0, -273.0, -108.0, -1472.0, -1670.0, -1714.0, -999.0, -1560.0, -1802.0, -724.0, -1043.0, -867.0, -20.0, -152.0, -262.0, -482.0, -2000.0, -900.0, -1703.0, -537.0, -823.0, -1516.0, -97.0, 2.0, -1505.0, -1230.0, -1351.0, -1054.0, -1549.0, -1032.0, -42.0, -97.0, 79.0, -768.0, -1032.0, -592.0, -1956.0, -944.0, -1472.0, -1285.0, -768.0, -1626.0, -174.0, -86.0, -218.0, -933.0, -1648.0, -1120.0, -262.0, -317.0, -427.0, -812.0, -669.0, -768.0, -1351.0, -1329.0, -1736.0, -1824.0, -1153.0, -1131.0, -1549.0, -1318.0, -1549.0, -1373.0, -1582.0, -482.0, -1274.0, -1142.0, -1142.0, -1362.0, -1417.0, -1758.0, -1681.0, -152.0, -1868.0, -1439.0, -372.0, -493.0, -1406.0, -1670.0, -1725.0, -1329.0, 24.0, -1769.0, -2000.0, -1692.0, -1868.0, 101.0, 200.0, 134.0, -922.0, -1098.0, -1021.0, -768.0, -1263.0, -1131.0, -350.0, -471.0, -515.0, -1923.0, -1857.0, -1725.0, -911.0, -1032.0, -1296.0, -1285.0, -1197.0, -1219.0, -1637.0, -1087.0, -1208.0, -1406.0, -724.0, -493.0, -1681.0, -1703.0, -42.0, -1582.0, -977.0, -1967.0, -97.0, -1846.0, -1142.0, -988.0, -911.0, -812.0, -1934.0, -1791.0, 35.0, -1835.0, -757.0, -1351.0, -933.0, 57.0, -493.0, 200.0, 200.0, -845.0, -1857.0, -1912.0, -1461.0, -812.0, -1483.0, -1428.0, 68.0, -1593.0, -1593.0, -779.0, -768.0, -614.0, -1307.0, -1428.0, -493.0, -1604.0, -1725.0, -2000.0, 79.0, -1868.0, 68.0, -724.0, -427.0, -537.0, 200.0, -1626.0, -1131.0, 178.0, 79.0, 200.0, -1648.0, -405.0, -911.0, -900.0, -405.0, -284.0, -1241.0, 13.0, -812.0, -570.0, -317.0, -97.0, -1692.0, -1703.0, -1329.0, -1725.0, -1758.0, -1296.0, -691.0, 68.0, -1362.0, -1285.0, -1142.0, -1384.0, -669.0, -317.0, -746.0, -1604.0, -1615.0, -1945.0, -295.0, -350.0, -1483.0, -988.0, -911.0, -1373.0, -1054.0, -1164.0, -1384.0, -548.0, -1736.0, -1043.0, -867.0, -1901.0, -493.0], "policy_predator_policy_reward": [130.0, 10.0, 0.0, 90.0, 380.0, 55.0, 490.0, 545.0, 5.0, 60.0, 40.0, 220.0, 775.0, 615.0, 350.0, 15.0, 15.0, 35.0, 315.0, 55.0, 170.0, 50.0, 175.0, 40.0, 460.0, 170.0, 405.0, 155.0, 70.0, 860.0, 0.0, 355.0, 10.0, 0.0, 0.0, 0.0, 120.0, 535.0, 340.0, 115.0, 570.0, 535.0, 50.0, 335.0, 105.0, 110.0, 270.0, 400.0, 170.0, 270.0, 220.0, 50.0, 70.0, 0.0, 75.0, 25.0, 90.0, 980.0, 705.0, 515.0, 805.0, 705.0, 465.0, 230.0, 270.0, 795.0, 125.0, 650.0, 870.0, 120.0, 20.0, 0.0, 650.0, 850.0, 0.0, 630.0, 670.0, 565.0, 815.0, 380.0, 0.0, 90.0, 0.0, 740.0, 785.0, 0.0, 420.0, 0.0, 0.0, 425.0, 0.0, 900.0, 85.0, 865.0, 890.0, 25.0, 15.0, 670.0, 365.0, 235.0, 125.0, 25.0, 645.0, 930.0, 525.0, 150.0, 90.0, 835.0, 330.0, 475.0, 300.0, 325.0, 805.0, 460.0, 695.0, 515.0, 30.0, 135.0, 180.0, 115.0, 295.0, 375.0, 515.0, 500.0, 920.0, 490.0, 710.0, 210.0, 670.0, 170.0, 75.0, 70.0, 765.0, 670.0, 35.0, 200.0, 130.0, 405.0, 535.0, 100.0, 65.0, 165.0, 895.0, 180.0, 970.0, 255.0, 90.0, 90.0, 510.0, 930.0, 350.0, 830.0, 220.0, 755.0, 475.0, 630.0, 390.0, 280.0, 680.0, 465.0, 925.0, 400.0, 695.0, 630.0, 195.0, 875.0, 585.0, 925.0, 545.0, 805.0, 295.0, 870.0, 950.0, 440.0, 45.0, 30.0, 0.0, 230.0, 405.0, 530.0, 855.0, 555.0, 375.0, 345.0, 205.0, 195.0, 765.0, 480.0, 970.0, 525.0, 710.0, 90.0, 380.0, 890.0, 260.0, 635.0, 165.0, 800.0, 495.0, 570.0, 740.0, 615.0, 920.0, 785.0, 905.0, 540.0, 955.0, 820.0, 430.0, 895.0, 375.0, 215.0, 570.0, 280.0, 980.0, 225.0, 545.0, 630.0, 830.0, 370.0, 225.0, 365.0, 205.0, 0.0, 310.0, 965.0, 330.0, 680.0, 460.0, 865.0, 610.0, 840.0, 525.0, 205.0, 550.0, 370.0, 340.0, 695.0, 15.0, 855.0, 690.0, 995.0, 480.0, 610.0, 585.0, 600.0, 330.0, 335.0, 355.0, 375.0, 780.0, 745.0, 5.0, 15.0, 40.0, 685.0, 505.0, 510.0, 375.0, 50.0, 470.0, 530.0, 560.0, 530.0, 0.0, 50.0, 450.0, 965.0, 315.0, 685.0, 895.0, 735.0, 800.0, 455.0, 535.0, 465.0, 40.0, 225.0, 875.0, 380.0, 390.0, 430.0, 915.0, 945.0, 200.0, 755.0, 335.0, 375.0, 555.0, 760.0, 690.0, 655.0, 695.0, 535.0, 360.0, 470.0, 730.0, 675.0, 730.0, 860.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.003634046824752, "mean_inference_ms": 1.7131987861911284, "mean_action_processing_ms": 0.36431626313638643, "mean_env_wait_ms": 0.25942218364286357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005002379417419434, "StateBufferConnector_ms": 0.005286097526550293, "ViewRequirementAgentConnector_ms": 0.14929568767547607}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -3871.0, "episode_return_mean": -1336.32, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 51.96204122184207, "num_env_steps_trained_throughput_per_sec": 51.96204122184207, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 76093.902, "restore_workers_time_ms": 0.014, "training_step_time_ms": 76093.833, "sample_time_ms": 1622.396, "learn_time_ms": 74449.164, "learn_throughput": 53.728, "synch_weights_time_ms": 16.07}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 25, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-49-08", "timestamp": 1723488548, "time_this_iter_s": 77.01806998252869, "time_total_s": 1954.1756217479706, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b21c2f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1954.1756217479706, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 38.87339449541284, "ram_util_percent": 83.11467889908255}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4281421013334965, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.808377837627492, "policy_loss": -0.010421269600517414, "vf_loss": 7.817596130506367, "vf_explained_var": 1.9837863056372242e-05, "kl": 0.008019830619366288, "entropy": 1.1750679946960287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 71910.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.2500874265499995, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.580126520167005, "policy_loss": -0.013966162677115144, "vf_loss": 5.592325544526391, "vf_explained_var": 0.02001170243354554, "kl": 0.00883565415567352, "entropy": 1.3516000732885185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 71910.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 517.0, "episode_reward_min": -3871.0, "episode_reward_mean": -1394.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -955.22, "predator_policy": 490.48333333333335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [361.0, -2931.0, -2023.0, -712.0, -2848.0, 465.0, -2619.0, -945.0, -2231.0, -1463.0, -2243.0, -537.0, -3871.0, -2581.0, -1584.0, -49.0, -1282.0, -1988.0, -506.0, -2496.0, -2395.0, 370.0, -1207.0, -2462.0, -2089.0, -163.0, -2231.0, -271.0, -1549.0, -3176.0, -2793.0, -2886.0, -2037.0, -1698.0, -3187.0, -1911.0, -784.0, -2416.0, -1429.0, -3300.0, 510.0, -1876.0, -1377.0, -591.0, -3290.0, -1914.0, -2171.0, -2332.0, -818.0, -1106.0, -2126.0, -940.0, -1551.0, -2205.0, -1938.0, -409.0, 70.0, -3255.0, -1788.0, -1548.0, -901.0, -1663.0, -3164.0, 74.0, -668.0, -657.0, 517.0, -1264.0, -694.0, -420.0, -484.0, -2759.0, -2349.0, -530.0, -2671.0, -532.0, -3104.0, -663.0, -1267.0, -1717.0, -1767.0, -996.0, -1462.0, -1462.0, -1176.0, 325.0, -369.0, -596.0, -1103.0, -174.0, -1215.0, 452.0, -1087.0, 2.0, 231.0, 96.0, -1420.0, -1225.0, -1271.0, 64.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.0, -53.0, 145.0, -1890.0, -1582.0, -1659.0, -1373.0, -1021.0, -1604.0, -460.0, -1472.0, -75.0, -1659.0, -1274.0, -1560.0, 200.0, 46.0, 79.0, -1483.0, -1417.0, -1219.0, 13.0, -1791.0, -1032.0, -1175.0, -1527.0, -724.0, -1340.0, -361.0, -592.0, -1054.0, -1384.0, -1010.0, -581.0, -273.0, -108.0, -1472.0, -1670.0, -1714.0, -999.0, -1560.0, -1802.0, -724.0, -1043.0, -867.0, -20.0, -152.0, -262.0, -482.0, -2000.0, -900.0, -1703.0, -537.0, -823.0, -1516.0, -97.0, 2.0, -1505.0, -1230.0, -1351.0, -1054.0, -1549.0, -1032.0, -42.0, -97.0, 79.0, -768.0, -1032.0, -592.0, -1956.0, -944.0, -1472.0, -1285.0, -768.0, -1626.0, -174.0, -86.0, -218.0, -933.0, -1648.0, -1120.0, -262.0, -317.0, -427.0, -812.0, -669.0, -768.0, -1351.0, -1329.0, -1736.0, -1824.0, -1153.0, -1131.0, -1549.0, -1318.0, -1549.0, -1373.0, -1582.0, -482.0, -1274.0, -1142.0, -1142.0, -1362.0, -1417.0, -1758.0, -1681.0, -152.0, -1868.0, -1439.0, -372.0, -493.0, -1406.0, -1670.0, -1725.0, -1329.0, 24.0, -1769.0, -2000.0, -1692.0, -1868.0, 101.0, 200.0, 134.0, -922.0, -1098.0, -1021.0, -768.0, -1263.0, -1131.0, -350.0, -471.0, -515.0, -1923.0, -1857.0, -1725.0, -911.0, -1032.0, -1296.0, -1285.0, -1197.0, -1219.0, -1637.0, -1087.0, -1208.0, -1406.0, -724.0, -493.0, -1681.0, -1703.0, -42.0, -1582.0, -977.0, -1967.0, -97.0, -1846.0, -1142.0, -988.0, -911.0, -812.0, -1934.0, -1791.0, 35.0, -1835.0, -757.0, -1351.0, -933.0, 57.0, -493.0, 200.0, 200.0, -845.0, -1857.0, -1912.0, -1461.0, -812.0, -1483.0, -1428.0, 68.0, -1593.0, -1593.0, -779.0, -768.0, -614.0, -1307.0, -1428.0, -493.0, -1604.0, -1725.0, -2000.0, 79.0, -1868.0, 68.0, -724.0, -427.0, -537.0, 200.0, -1626.0, -1131.0, 178.0, 79.0, 200.0, -1648.0, -405.0, -911.0, -900.0, -405.0, -284.0, -1241.0, 13.0, -812.0, -570.0, -317.0, -97.0, -1692.0, -1703.0, -1329.0, -1725.0, -1758.0, -1296.0, -691.0, 68.0, -1362.0, -1285.0, -1142.0, -1384.0, -669.0, -317.0, -746.0, -1604.0, -1615.0, -1945.0, -295.0, -350.0, -1483.0, -988.0, -911.0, -1373.0, -1054.0, -1164.0, -1384.0, -548.0, -1736.0, -1043.0, -867.0, -1901.0, -493.0, -372.0, -1505.0, -1450.0, -1120.0, -1263.0, -1329.0, -1593.0, -1318.0, -185.0, 112.0, -372.0, 200.0, -746.0, -999.0, -9.0, -537.0, -1571.0, -438.0, -1329.0, -53.0, -1516.0, -1032.0, -152.0, 200.0, -680.0, -735.0, -680.0, 200.0, -1758.0, 200.0, -1395.0, -361.0, -1241.0, -1637.0, 2.0, 57.0, -438.0, -1901.0, 200.0, -1648.0, 101.0, 68.0, -1318.0, -537.0, -2000.0, -735.0, -559.0, -691.0, -1769.0, -295.0, -1747.0, -119.0, -75.0, -1637.0], "policy_predator_policy_reward": [75.0, 25.0, 90.0, 980.0, 705.0, 515.0, 805.0, 705.0, 465.0, 230.0, 270.0, 795.0, 125.0, 650.0, 870.0, 120.0, 20.0, 0.0, 650.0, 850.0, 0.0, 630.0, 670.0, 565.0, 815.0, 380.0, 0.0, 90.0, 0.0, 740.0, 785.0, 0.0, 420.0, 0.0, 0.0, 425.0, 0.0, 900.0, 85.0, 865.0, 890.0, 25.0, 15.0, 670.0, 365.0, 235.0, 125.0, 25.0, 645.0, 930.0, 525.0, 150.0, 90.0, 835.0, 330.0, 475.0, 300.0, 325.0, 805.0, 460.0, 695.0, 515.0, 30.0, 135.0, 180.0, 115.0, 295.0, 375.0, 515.0, 500.0, 920.0, 490.0, 710.0, 210.0, 670.0, 170.0, 75.0, 70.0, 765.0, 670.0, 35.0, 200.0, 130.0, 405.0, 535.0, 100.0, 65.0, 165.0, 895.0, 180.0, 970.0, 255.0, 90.0, 90.0, 510.0, 930.0, 350.0, 830.0, 220.0, 755.0, 475.0, 630.0, 390.0, 280.0, 680.0, 465.0, 925.0, 400.0, 695.0, 630.0, 195.0, 875.0, 585.0, 925.0, 545.0, 805.0, 295.0, 870.0, 950.0, 440.0, 45.0, 30.0, 0.0, 230.0, 405.0, 530.0, 855.0, 555.0, 375.0, 345.0, 205.0, 195.0, 765.0, 480.0, 970.0, 525.0, 710.0, 90.0, 380.0, 890.0, 260.0, 635.0, 165.0, 800.0, 495.0, 570.0, 740.0, 615.0, 920.0, 785.0, 905.0, 540.0, 955.0, 820.0, 430.0, 895.0, 375.0, 215.0, 570.0, 280.0, 980.0, 225.0, 545.0, 630.0, 830.0, 370.0, 225.0, 365.0, 205.0, 0.0, 310.0, 965.0, 330.0, 680.0, 460.0, 865.0, 610.0, 840.0, 525.0, 205.0, 550.0, 370.0, 340.0, 695.0, 15.0, 855.0, 690.0, 995.0, 480.0, 610.0, 585.0, 600.0, 330.0, 335.0, 355.0, 375.0, 780.0, 745.0, 5.0, 15.0, 40.0, 685.0, 505.0, 510.0, 375.0, 50.0, 470.0, 530.0, 560.0, 530.0, 0.0, 50.0, 450.0, 965.0, 315.0, 685.0, 895.0, 735.0, 800.0, 455.0, 535.0, 465.0, 40.0, 225.0, 875.0, 380.0, 390.0, 430.0, 915.0, 945.0, 200.0, 755.0, 335.0, 375.0, 555.0, 760.0, 690.0, 655.0, 695.0, 535.0, 360.0, 470.0, 730.0, 675.0, 730.0, 860.0, 850.0, 215.0, 800.0, 765.0, 895.0, 590.0, 650.0, 490.0, 780.0, 250.0, 15.0, 120.0, 430.0, 560.0, 395.0, 725.0, 590.0, 635.0, 800.0, 605.0, 390.0, 120.0, 575.0, 115.0, 305.0, 185.0, 390.0, 755.0, 590.0, 465.0, 510.0, 850.0, 550.0, 525.0, 645.0, 410.0, 705.0, 820.0, 845.0, 695.0, 395.0, 485.0, 745.0, 760.0, 930.0, 460.0, 265.0, 35.0, 815.0, 760.0, 965.0, 365.0, 690.0, 840.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0011774989968063, "mean_inference_ms": 1.709134158658428, "mean_action_processing_ms": 0.36437869402247186, "mean_env_wait_ms": 0.25942797706501325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004994511604309082, "StateBufferConnector_ms": 0.005311131477355957, "ViewRequirementAgentConnector_ms": 0.14972126483917236}, "num_episodes": 18, "episode_return_max": 517.0, "episode_return_min": -3871.0, "episode_return_mean": -1394.21, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 50.68852956426696, "num_env_steps_trained_throughput_per_sec": 50.68852956426696, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 76324.547, "restore_workers_time_ms": 0.014, "training_step_time_ms": 76324.478, "sample_time_ms": 1624.668, "learn_time_ms": 74678.1, "learn_throughput": 53.563, "synch_weights_time_ms": 15.816}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 26, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-50-27", "timestamp": 1723488627, "time_this_iter_s": 78.9551248550415, "time_total_s": 2033.130746603012, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b230f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2033.130746603012, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 40.38230088495576, "ram_util_percent": 81.93628318584071}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3983423372955186, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.443651940298419, "policy_loss": -0.010164963398979158, "vf_loss": 4.452932045645747, "vf_explained_var": 6.232779499486829e-05, "kl": 0.005899102655951053, "entropy": 1.1637191293510138, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 74730.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.031256976279806, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7326247216961908, "policy_loss": -0.012847339694597924, "vf_loss": 3.7440263802278126, "vf_explained_var": 0.020745595845770327, "kl": 0.0072284040455600765, "entropy": 1.3620990094986367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 74730.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "env_runners": {"episode_reward_max": 532.0, "episode_reward_min": -3300.0, "episode_reward_mean": -1179.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -883.5366666666666, "predator_policy": 490.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1207.0, -2462.0, -2089.0, -163.0, -2231.0, -271.0, -1549.0, -3176.0, -2793.0, -2886.0, -2037.0, -1698.0, -3187.0, -1911.0, -784.0, -2416.0, -1429.0, -3300.0, 510.0, -1876.0, -1377.0, -591.0, -3290.0, -1914.0, -2171.0, -2332.0, -818.0, -1106.0, -2126.0, -940.0, -1551.0, -2205.0, -1938.0, -409.0, 70.0, -3255.0, -1788.0, -1548.0, -901.0, -1663.0, -3164.0, 74.0, -668.0, -657.0, 517.0, -1264.0, -694.0, -420.0, -484.0, -2759.0, -2349.0, -530.0, -2671.0, -532.0, -3104.0, -663.0, -1267.0, -1717.0, -1767.0, -996.0, -1462.0, -1462.0, -1176.0, 325.0, -369.0, -596.0, -1103.0, -174.0, -1215.0, 452.0, -1087.0, 2.0, 231.0, 96.0, -1420.0, -1225.0, -1271.0, 64.0, 147.0, -322.0, -287.0, -170.0, -1478.0, -68.0, -2240.0, -709.0, 151.0, -1874.0, -784.0, 218.0, -1344.0, -1553.0, -201.0, 340.0, -516.0, -1245.0, -498.0, -952.0, 210.0, 532.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-768.0, -1032.0, -592.0, -1956.0, -944.0, -1472.0, -1285.0, -768.0, -1626.0, -174.0, -86.0, -218.0, -933.0, -1648.0, -1120.0, -262.0, -317.0, -427.0, -812.0, -669.0, -768.0, -1351.0, -1329.0, -1736.0, -1824.0, -1153.0, -1131.0, -1549.0, -1318.0, -1549.0, -1373.0, -1582.0, -482.0, -1274.0, -1142.0, -1142.0, -1362.0, -1417.0, -1758.0, -1681.0, -152.0, -1868.0, -1439.0, -372.0, -493.0, -1406.0, -1670.0, -1725.0, -1329.0, 24.0, -1769.0, -2000.0, -1692.0, -1868.0, 101.0, 200.0, 134.0, -922.0, -1098.0, -1021.0, -768.0, -1263.0, -1131.0, -350.0, -471.0, -515.0, -1923.0, -1857.0, -1725.0, -911.0, -1032.0, -1296.0, -1285.0, -1197.0, -1219.0, -1637.0, -1087.0, -1208.0, -1406.0, -724.0, -493.0, -1681.0, -1703.0, -42.0, -1582.0, -977.0, -1967.0, -97.0, -1846.0, -1142.0, -988.0, -911.0, -812.0, -1934.0, -1791.0, 35.0, -1835.0, -757.0, -1351.0, -933.0, 57.0, -493.0, 200.0, 200.0, -845.0, -1857.0, -1912.0, -1461.0, -812.0, -1483.0, -1428.0, 68.0, -1593.0, -1593.0, -779.0, -768.0, -614.0, -1307.0, -1428.0, -493.0, -1604.0, -1725.0, -2000.0, 79.0, -1868.0, 68.0, -724.0, -427.0, -537.0, 200.0, -1626.0, -1131.0, 178.0, 79.0, 200.0, -1648.0, -405.0, -911.0, -900.0, -405.0, -284.0, -1241.0, 13.0, -812.0, -570.0, -317.0, -97.0, -1692.0, -1703.0, -1329.0, -1725.0, -1758.0, -1296.0, -691.0, 68.0, -1362.0, -1285.0, -1142.0, -1384.0, -669.0, -317.0, -746.0, -1604.0, -1615.0, -1945.0, -295.0, -350.0, -1483.0, -988.0, -911.0, -1373.0, -1054.0, -1164.0, -1384.0, -548.0, -1736.0, -1043.0, -867.0, -1901.0, -493.0, -372.0, -1505.0, -1450.0, -1120.0, -1263.0, -1329.0, -1593.0, -1318.0, -185.0, 112.0, -372.0, 200.0, -746.0, -999.0, -9.0, -537.0, -1571.0, -438.0, -1329.0, -53.0, -1516.0, -1032.0, -152.0, 200.0, -680.0, -735.0, -680.0, 200.0, -1758.0, 200.0, -1395.0, -361.0, -1241.0, -1637.0, 2.0, 57.0, -438.0, -1901.0, 200.0, -1648.0, 101.0, 68.0, -1318.0, -537.0, -2000.0, -735.0, -559.0, -691.0, -1769.0, -295.0, -1747.0, -119.0, -75.0, -1637.0, -9.0, 178.0, -207.0, -1824.0, -218.0, -350.0, -20.0, -372.0, -955.0, 178.0, -185.0, -1208.0, -834.0, -790.0, -944.0, -108.0, -284.0, -361.0, -1450.0, -1043.0, -1417.0, -1230.0, -1164.0, -515.0, -75.0, -229.0, 200.0, -1076.0, -1362.0, -1406.0, -1417.0, -724.0, -438.0, 112.0, 35.0, -174.0, -1450.0, -1054.0, -845.0, -757.0, -691.0, -1340.0, -141.0, -427.0, -273.0, -9.0, 178.0, 46.0, -1736.0, -801.0, -64.0, -229.0, -1813.0, -1538.0, -394.0, -1560.0, -339.0, -713.0, -482.0, -482.0, -669.0, 46.0, 123.0, 200.0, -108.0, 200.0], "policy_predator_policy_reward": [295.0, 375.0, 515.0, 500.0, 920.0, 490.0, 710.0, 210.0, 670.0, 170.0, 75.0, 70.0, 765.0, 670.0, 35.0, 200.0, 130.0, 405.0, 535.0, 100.0, 65.0, 165.0, 895.0, 180.0, 970.0, 255.0, 90.0, 90.0, 510.0, 930.0, 350.0, 830.0, 220.0, 755.0, 475.0, 630.0, 390.0, 280.0, 680.0, 465.0, 925.0, 400.0, 695.0, 630.0, 195.0, 875.0, 585.0, 925.0, 545.0, 805.0, 295.0, 870.0, 950.0, 440.0, 45.0, 30.0, 0.0, 230.0, 405.0, 530.0, 855.0, 555.0, 375.0, 345.0, 205.0, 195.0, 765.0, 480.0, 970.0, 525.0, 710.0, 90.0, 380.0, 890.0, 260.0, 635.0, 165.0, 800.0, 495.0, 570.0, 740.0, 615.0, 920.0, 785.0, 905.0, 540.0, 955.0, 820.0, 430.0, 895.0, 375.0, 215.0, 570.0, 280.0, 980.0, 225.0, 545.0, 630.0, 830.0, 370.0, 225.0, 365.0, 205.0, 0.0, 310.0, 965.0, 330.0, 680.0, 460.0, 865.0, 610.0, 840.0, 525.0, 205.0, 550.0, 370.0, 340.0, 695.0, 15.0, 855.0, 690.0, 995.0, 480.0, 610.0, 585.0, 600.0, 330.0, 335.0, 355.0, 375.0, 780.0, 745.0, 5.0, 15.0, 40.0, 685.0, 505.0, 510.0, 375.0, 50.0, 470.0, 530.0, 560.0, 530.0, 0.0, 50.0, 450.0, 965.0, 315.0, 685.0, 895.0, 735.0, 800.0, 455.0, 535.0, 465.0, 40.0, 225.0, 875.0, 380.0, 390.0, 430.0, 915.0, 945.0, 200.0, 755.0, 335.0, 375.0, 555.0, 760.0, 690.0, 655.0, 695.0, 535.0, 360.0, 470.0, 730.0, 675.0, 730.0, 860.0, 850.0, 215.0, 800.0, 765.0, 895.0, 590.0, 650.0, 490.0, 780.0, 250.0, 15.0, 120.0, 430.0, 560.0, 395.0, 725.0, 590.0, 635.0, 800.0, 605.0, 390.0, 120.0, 575.0, 115.0, 305.0, 185.0, 390.0, 755.0, 590.0, 465.0, 510.0, 850.0, 550.0, 525.0, 645.0, 410.0, 705.0, 820.0, 845.0, 695.0, 395.0, 485.0, 745.0, 760.0, 930.0, 460.0, 265.0, 35.0, 815.0, 760.0, 965.0, 365.0, 690.0, 840.0, 185.0, 0.0, 0.0, 750.0, 685.0, 635.0, 310.0, 270.0, 480.0, 220.0, 305.0, 520.0, 535.0, 230.0, 325.0, 155.0, 260.0, 270.0, 695.0, 665.0, 310.0, 735.0, 915.0, 550.0, 0.0, 95.0, 160.0, 815.0, 530.0, 625.0, 535.0, 565.0, 695.0, 0.0, 50.0, 195.0, 485.0, 715.0, 805.0, 365.0, 215.0, 655.0, 95.0, 255.0, 290.0, 0.0, 125.0, 0.0, 600.0, 800.0, 685.0, 695.0, 740.0, 900.0, 735.0, 675.0, 385.0, 80.0, 410.0, 235.0, 310.0, 20.0, 380.0, 100.0, 140.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9998614152002827, "mean_inference_ms": 1.706184607877139, "mean_action_processing_ms": 0.3647542038125916, "mean_env_wait_ms": 0.2593559269858745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049591064453125, "StateBufferConnector_ms": 0.005313873291015625, "ViewRequirementAgentConnector_ms": 0.16221082210540771}, "num_episodes": 22, "episode_return_max": 532.0, "episode_return_min": -3300.0, "episode_return_mean": -1179.56, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.924012604563615, "num_env_steps_trained_throughput_per_sec": 53.924012604563615, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 75873.941, "restore_workers_time_ms": 0.014, "training_step_time_ms": 75873.872, "sample_time_ms": 1594.045, "learn_time_ms": 74258.585, "learn_throughput": 53.866, "synch_weights_time_ms": 15.371}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "training_iteration": 27, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-51-42", "timestamp": 1723488702, "time_this_iter_s": 74.22551989555359, "time_total_s": 2107.3562664985657, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b106aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2107.3562664985657, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 33.915238095238095, "ram_util_percent": 81.96285714285716}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3776996446628098, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.0361080193350505, "policy_loss": -0.010182947605594015, "vf_loss": 6.045186751446826, "vf_explained_var": 2.1768842183106333e-05, "kl": 0.007361465756809056, "entropy": 1.1564718709347095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 77550.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.213865666144283, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.4862653340853695, "policy_loss": -0.018168291857248133, "vf_loss": 4.501940383894223, "vf_explained_var": 0.01752750002746041, "kl": 0.012466196541334072, "entropy": 1.366348463550527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 77550.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 550.0, "episode_reward_min": -4080.0, "episode_reward_mean": -818.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -732.5433333333333, "predator_policy": 459.8666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1914.0, -2171.0, -2332.0, -818.0, -1106.0, -2126.0, -940.0, -1551.0, -2205.0, -1938.0, -409.0, 70.0, -3255.0, -1788.0, -1548.0, -901.0, -1663.0, -3164.0, 74.0, -668.0, -657.0, 517.0, -1264.0, -694.0, -420.0, -484.0, -2759.0, -2349.0, -530.0, -2671.0, -532.0, -3104.0, -663.0, -1267.0, -1717.0, -1767.0, -996.0, -1462.0, -1462.0, -1176.0, 325.0, -369.0, -596.0, -1103.0, -174.0, -1215.0, 452.0, -1087.0, 2.0, 231.0, 96.0, -1420.0, -1225.0, -1271.0, 64.0, 147.0, -322.0, -287.0, -170.0, -1478.0, -68.0, -2240.0, -709.0, 151.0, -1874.0, -784.0, 218.0, -1344.0, -1553.0, -201.0, 340.0, -516.0, -1245.0, -498.0, -952.0, 210.0, 532.0, -1466.0, 338.0, 111.0, 439.0, 516.0, 142.0, -1401.0, 388.0, 545.0, 143.0, 411.0, -681.0, 514.0, -1287.0, -702.0, -611.0, -4080.0, 550.0, -614.0, 203.0, 401.0, 101.0, -20.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-911.0, -1032.0, -1296.0, -1285.0, -1197.0, -1219.0, -1637.0, -1087.0, -1208.0, -1406.0, -724.0, -493.0, -1681.0, -1703.0, -42.0, -1582.0, -977.0, -1967.0, -97.0, -1846.0, -1142.0, -988.0, -911.0, -812.0, -1934.0, -1791.0, 35.0, -1835.0, -757.0, -1351.0, -933.0, 57.0, -493.0, 200.0, 200.0, -845.0, -1857.0, -1912.0, -1461.0, -812.0, -1483.0, -1428.0, 68.0, -1593.0, -1593.0, -779.0, -768.0, -614.0, -1307.0, -1428.0, -493.0, -1604.0, -1725.0, -2000.0, 79.0, -1868.0, 68.0, -724.0, -427.0, -537.0, 200.0, -1626.0, -1131.0, 178.0, 79.0, 200.0, -1648.0, -405.0, -911.0, -900.0, -405.0, -284.0, -1241.0, 13.0, -812.0, -570.0, -317.0, -97.0, -1692.0, -1703.0, -1329.0, -1725.0, -1758.0, -1296.0, -691.0, 68.0, -1362.0, -1285.0, -1142.0, -1384.0, -669.0, -317.0, -746.0, -1604.0, -1615.0, -1945.0, -295.0, -350.0, -1483.0, -988.0, -911.0, -1373.0, -1054.0, -1164.0, -1384.0, -548.0, -1736.0, -1043.0, -867.0, -1901.0, -493.0, -372.0, -1505.0, -1450.0, -1120.0, -1263.0, -1329.0, -1593.0, -1318.0, -185.0, 112.0, -372.0, 200.0, -746.0, -999.0, -9.0, -537.0, -1571.0, -438.0, -1329.0, -53.0, -1516.0, -1032.0, -152.0, 200.0, -680.0, -735.0, -680.0, 200.0, -1758.0, 200.0, -1395.0, -361.0, -1241.0, -1637.0, 2.0, 57.0, -438.0, -1901.0, 200.0, -1648.0, 101.0, 68.0, -1318.0, -537.0, -2000.0, -735.0, -559.0, -691.0, -1769.0, -295.0, -1747.0, -119.0, -75.0, -1637.0, -9.0, 178.0, -207.0, -1824.0, -218.0, -350.0, -20.0, -372.0, -955.0, 178.0, -185.0, -1208.0, -834.0, -790.0, -944.0, -108.0, -284.0, -361.0, -1450.0, -1043.0, -1417.0, -1230.0, -1164.0, -515.0, -75.0, -229.0, 200.0, -1076.0, -1362.0, -1406.0, -1417.0, -724.0, -438.0, 112.0, 35.0, -174.0, -1450.0, -1054.0, -845.0, -757.0, -691.0, -1340.0, -141.0, -427.0, -273.0, -9.0, 178.0, 46.0, -1736.0, -801.0, -64.0, -229.0, -1813.0, -1538.0, -394.0, -1560.0, -339.0, -713.0, -482.0, -482.0, -669.0, 46.0, 123.0, 200.0, -108.0, 200.0, -1703.0, -1417.0, -416.0, 200.0, -1593.0, 46.0, 35.0, -581.0, 57.0, 189.0, -1373.0, 123.0, 46.0, 200.0, 200.0, 200.0, -361.0, 13.0, -900.0, -1098.0, -1373.0, 156.0, 35.0, -273.0, 189.0, -75.0, 156.0, 200.0, -185.0, -1197.0, 189.0, 200.0, -493.0, -174.0, -647.0, -405.0, -1186.0, 200.0, 35.0, -779.0, -746.0, -1087.0, -240.0, -372.0, -625.0, -1516.0, -812.0, 112.0, -1439.0, -1923.0, -1923.0, -603.0, 200.0, -262.0, -1043.0, -515.0, -636.0, -1912.0, 145.0, 200.0, 57.0, 101.0, 178.0, -163.0, -163.0, 112.0, -295.0, -504.0, 134.0], "policy_predator_policy_reward": [525.0, 710.0, 90.0, 380.0, 890.0, 260.0, 635.0, 165.0, 800.0, 495.0, 570.0, 740.0, 615.0, 920.0, 785.0, 905.0, 540.0, 955.0, 820.0, 430.0, 895.0, 375.0, 215.0, 570.0, 280.0, 980.0, 225.0, 545.0, 630.0, 830.0, 370.0, 225.0, 365.0, 205.0, 0.0, 310.0, 965.0, 330.0, 680.0, 460.0, 865.0, 610.0, 840.0, 525.0, 205.0, 550.0, 370.0, 340.0, 695.0, 15.0, 855.0, 690.0, 995.0, 480.0, 610.0, 585.0, 600.0, 330.0, 335.0, 355.0, 375.0, 780.0, 745.0, 5.0, 15.0, 40.0, 685.0, 505.0, 510.0, 375.0, 50.0, 470.0, 530.0, 560.0, 530.0, 0.0, 50.0, 450.0, 965.0, 315.0, 685.0, 895.0, 735.0, 800.0, 455.0, 535.0, 465.0, 40.0, 225.0, 875.0, 380.0, 390.0, 430.0, 915.0, 945.0, 200.0, 755.0, 335.0, 375.0, 555.0, 760.0, 690.0, 655.0, 695.0, 535.0, 360.0, 470.0, 730.0, 675.0, 730.0, 860.0, 850.0, 215.0, 800.0, 765.0, 895.0, 590.0, 650.0, 490.0, 780.0, 250.0, 15.0, 120.0, 430.0, 560.0, 395.0, 725.0, 590.0, 635.0, 800.0, 605.0, 390.0, 120.0, 575.0, 115.0, 305.0, 185.0, 390.0, 755.0, 590.0, 465.0, 510.0, 850.0, 550.0, 525.0, 645.0, 410.0, 705.0, 820.0, 845.0, 695.0, 395.0, 485.0, 745.0, 760.0, 930.0, 460.0, 265.0, 35.0, 815.0, 760.0, 965.0, 365.0, 690.0, 840.0, 185.0, 0.0, 0.0, 750.0, 685.0, 635.0, 310.0, 270.0, 480.0, 220.0, 305.0, 520.0, 535.0, 230.0, 325.0, 155.0, 260.0, 270.0, 695.0, 665.0, 310.0, 735.0, 915.0, 550.0, 0.0, 95.0, 160.0, 815.0, 530.0, 625.0, 535.0, 565.0, 695.0, 0.0, 50.0, 195.0, 485.0, 715.0, 805.0, 365.0, 215.0, 655.0, 95.0, 255.0, 290.0, 0.0, 125.0, 0.0, 600.0, 800.0, 685.0, 695.0, 740.0, 900.0, 735.0, 675.0, 385.0, 80.0, 410.0, 235.0, 310.0, 20.0, 380.0, 100.0, 140.0, 0.0, 505.0, 725.0, 840.0, 560.0, 750.0, 375.0, 335.0, 140.0, 125.0, 575.0, 455.0, 470.0, 70.0, 0.0, 0.0, 30.0, 5.0, 255.0, 635.0, 650.0, 685.0, 15.0, 165.0, 290.0, 75.0, 85.0, 115.0, 555.0, 200.0, 570.0, 100.0, 110.0, 305.0, 30.0, 115.0, 400.0, 490.0, 550.0, 425.0, 560.0, 365.0, 400.0, 0.0, 380.0, 155.0, 480.0, 770.0, 355.0, 860.0, 0.0, 345.0, 470.0, 475.0, 270.0, 595.0, 730.0, 255.0, 505.0, 670.0, 595.0, 0.0, 65.0, 0.0, 155.0, 70.0, 90.0, 275.0, 45.0, 325.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9963224058175496, "mean_inference_ms": 1.6996755144382902, "mean_action_processing_ms": 0.3644942991154615, "mean_env_wait_ms": 0.2595369881338862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004665851593017578, "StateBufferConnector_ms": 0.004425644874572754, "ViewRequirementAgentConnector_ms": 0.15486669540405273}, "num_episodes": 23, "episode_return_max": 550.0, "episode_return_min": -4080.0, "episode_return_mean": -818.03, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.35039048361107, "num_env_steps_trained_throughput_per_sec": 53.35039048361107, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 75752.191, "restore_workers_time_ms": 0.014, "training_step_time_ms": 75752.128, "sample_time_ms": 1489.363, "learn_time_ms": 74240.812, "learn_throughput": 53.879, "synch_weights_time_ms": 15.612}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 28, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-52-57", "timestamp": 1723488777, "time_this_iter_s": 75.03365707397461, "time_total_s": 2182.3899235725403, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b10789d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2182.3899235725403, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 36.328971962616826, "ram_util_percent": 82.388785046729}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4126364980817687, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.524831780474237, "policy_loss": -0.010417290785554664, "vf_loss": 5.5342198356669, "vf_explained_var": 0.00020307186224781875, "kl": 0.006861540234749258, "entropy": 1.0846310058172712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 80370.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.558978618691999, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9681653158884522, "policy_loss": -0.015558112731966329, "vf_loss": 3.9820457892215, "vf_explained_var": 0.020588933322446566, "kl": 0.008388178817700037, "entropy": 1.3691774341231542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 80370.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "env_runners": {"episode_reward_max": 558.0, "episode_reward_min": -4080.0, "episode_reward_mean": -526.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 965.0}, "policy_reward_mean": {"prey_policy": -598.8566666666667, "predator_policy": 423.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [74.0, -668.0, -657.0, 517.0, -1264.0, -694.0, -420.0, -484.0, -2759.0, -2349.0, -530.0, -2671.0, -532.0, -3104.0, -663.0, -1267.0, -1717.0, -1767.0, -996.0, -1462.0, -1462.0, -1176.0, 325.0, -369.0, -596.0, -1103.0, -174.0, -1215.0, 452.0, -1087.0, 2.0, 231.0, 96.0, -1420.0, -1225.0, -1271.0, 64.0, 147.0, -322.0, -287.0, -170.0, -1478.0, -68.0, -2240.0, -709.0, 151.0, -1874.0, -784.0, 218.0, -1344.0, -1553.0, -201.0, 340.0, -516.0, -1245.0, -498.0, -952.0, 210.0, 532.0, -1466.0, 338.0, 111.0, 439.0, 516.0, 142.0, -1401.0, 388.0, 545.0, 143.0, 411.0, -681.0, 514.0, -1287.0, -702.0, -611.0, -4080.0, 550.0, -614.0, 203.0, 401.0, 101.0, -20.0, 334.0, 445.0, -405.0, 296.0, 196.0, -6.0, -262.0, 313.0, -1737.0, 558.0, 98.0, 417.0, -1230.0, 321.0, 231.0, -71.0, -636.0, 545.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.0, -1868.0, 68.0, -724.0, -427.0, -537.0, 200.0, -1626.0, -1131.0, 178.0, 79.0, 200.0, -1648.0, -405.0, -911.0, -900.0, -405.0, -284.0, -1241.0, 13.0, -812.0, -570.0, -317.0, -97.0, -1692.0, -1703.0, -1329.0, -1725.0, -1758.0, -1296.0, -691.0, 68.0, -1362.0, -1285.0, -1142.0, -1384.0, -669.0, -317.0, -746.0, -1604.0, -1615.0, -1945.0, -295.0, -350.0, -1483.0, -988.0, -911.0, -1373.0, -1054.0, -1164.0, -1384.0, -548.0, -1736.0, -1043.0, -867.0, -1901.0, -493.0, -372.0, -1505.0, -1450.0, -1120.0, -1263.0, -1329.0, -1593.0, -1318.0, -185.0, 112.0, -372.0, 200.0, -746.0, -999.0, -9.0, -537.0, -1571.0, -438.0, -1329.0, -53.0, -1516.0, -1032.0, -152.0, 200.0, -680.0, -735.0, -680.0, 200.0, -1758.0, 200.0, -1395.0, -361.0, -1241.0, -1637.0, 2.0, 57.0, -438.0, -1901.0, 200.0, -1648.0, 101.0, 68.0, -1318.0, -537.0, -2000.0, -735.0, -559.0, -691.0, -1769.0, -295.0, -1747.0, -119.0, -75.0, -1637.0, -9.0, 178.0, -207.0, -1824.0, -218.0, -350.0, -20.0, -372.0, -955.0, 178.0, -185.0, -1208.0, -834.0, -790.0, -944.0, -108.0, -284.0, -361.0, -1450.0, -1043.0, -1417.0, -1230.0, -1164.0, -515.0, -75.0, -229.0, 200.0, -1076.0, -1362.0, -1406.0, -1417.0, -724.0, -438.0, 112.0, 35.0, -174.0, -1450.0, -1054.0, -845.0, -757.0, -691.0, -1340.0, -141.0, -427.0, -273.0, -9.0, 178.0, 46.0, -1736.0, -801.0, -64.0, -229.0, -1813.0, -1538.0, -394.0, -1560.0, -339.0, -713.0, -482.0, -482.0, -669.0, 46.0, 123.0, 200.0, -108.0, 200.0, -1703.0, -1417.0, -416.0, 200.0, -1593.0, 46.0, 35.0, -581.0, 57.0, 189.0, -1373.0, 123.0, 46.0, 200.0, 200.0, 200.0, -361.0, 13.0, -900.0, -1098.0, -1373.0, 156.0, 35.0, -273.0, 189.0, -75.0, 156.0, 200.0, -185.0, -1197.0, 189.0, 200.0, -493.0, -174.0, -647.0, -405.0, -1186.0, 200.0, 35.0, -779.0, -746.0, -1087.0, -240.0, -372.0, -625.0, -1516.0, -812.0, 112.0, -1439.0, -1923.0, -1923.0, -603.0, 200.0, -262.0, -1043.0, -515.0, -636.0, -1912.0, 145.0, 200.0, 57.0, 101.0, 178.0, -163.0, -163.0, 112.0, -295.0, -504.0, 134.0, -614.0, 200.0, -207.0, 134.0, -724.0, 90.0, -9.0, -515.0, -526.0, 200.0, 200.0, -504.0, 200.0, -229.0, -240.0, -416.0, 200.0, -515.0, -460.0, -163.0, -1769.0, -31.0, -53.0, 112.0, -1109.0, -1582.0, -1131.0, 123.0, 200.0, -680.0, -350.0, -702.0, 200.0, -75.0, 167.0, 200.0, -977.0, -801.0, -1527.0, 134.0, 200.0, -1923.0, 2.0, -108.0, -273.0, 189.0, -394.0, -1131.0, -1604.0, -537.0, -460.0, 189.0, -174.0, 200.0], "policy_predator_policy_reward": [610.0, 585.0, 600.0, 330.0, 335.0, 355.0, 375.0, 780.0, 745.0, 5.0, 15.0, 40.0, 685.0, 505.0, 510.0, 375.0, 50.0, 470.0, 530.0, 560.0, 530.0, 0.0, 50.0, 450.0, 965.0, 315.0, 685.0, 895.0, 735.0, 800.0, 455.0, 535.0, 465.0, 40.0, 225.0, 875.0, 380.0, 390.0, 430.0, 915.0, 945.0, 200.0, 755.0, 335.0, 375.0, 555.0, 760.0, 690.0, 655.0, 695.0, 535.0, 360.0, 470.0, 730.0, 675.0, 730.0, 860.0, 850.0, 215.0, 800.0, 765.0, 895.0, 590.0, 650.0, 490.0, 780.0, 250.0, 15.0, 120.0, 430.0, 560.0, 395.0, 725.0, 590.0, 635.0, 800.0, 605.0, 390.0, 120.0, 575.0, 115.0, 305.0, 185.0, 390.0, 755.0, 590.0, 465.0, 510.0, 850.0, 550.0, 525.0, 645.0, 410.0, 705.0, 820.0, 845.0, 695.0, 395.0, 485.0, 745.0, 760.0, 930.0, 460.0, 265.0, 35.0, 815.0, 760.0, 965.0, 365.0, 690.0, 840.0, 185.0, 0.0, 0.0, 750.0, 685.0, 635.0, 310.0, 270.0, 480.0, 220.0, 305.0, 520.0, 535.0, 230.0, 325.0, 155.0, 260.0, 270.0, 695.0, 665.0, 310.0, 735.0, 915.0, 550.0, 0.0, 95.0, 160.0, 815.0, 530.0, 625.0, 535.0, 565.0, 695.0, 0.0, 50.0, 195.0, 485.0, 715.0, 805.0, 365.0, 215.0, 655.0, 95.0, 255.0, 290.0, 0.0, 125.0, 0.0, 600.0, 800.0, 685.0, 695.0, 740.0, 900.0, 735.0, 675.0, 385.0, 80.0, 410.0, 235.0, 310.0, 20.0, 380.0, 100.0, 140.0, 0.0, 505.0, 725.0, 840.0, 560.0, 750.0, 375.0, 335.0, 140.0, 125.0, 575.0, 455.0, 470.0, 70.0, 0.0, 0.0, 30.0, 5.0, 255.0, 635.0, 650.0, 685.0, 15.0, 165.0, 290.0, 75.0, 85.0, 115.0, 555.0, 200.0, 570.0, 100.0, 110.0, 305.0, 30.0, 115.0, 400.0, 490.0, 550.0, 425.0, 560.0, 365.0, 400.0, 0.0, 380.0, 155.0, 480.0, 770.0, 355.0, 860.0, 0.0, 345.0, 470.0, 475.0, 270.0, 595.0, 730.0, 255.0, 505.0, 670.0, 595.0, 0.0, 65.0, 0.0, 155.0, 70.0, 90.0, 275.0, 45.0, 325.0, 175.0, 465.0, 315.0, 410.0, 220.0, 315.0, 340.0, 165.0, 140.0, 145.0, 200.0, 55.0, 150.0, 145.0, 170.0, 120.0, 215.0, 390.0, 665.0, 790.0, 675.0, 95.0, 150.0, 40.0, 710.0, 800.0, 575.0, 235.0, 320.0, 360.0, 275.0, 270.0, 405.0, 0.0, 125.0, 0.0, 665.0, 760.0, 650.0, 755.0, 590.0, 565.0, 105.0, 270.0, 235.0, 465.0, 390.0, 410.0, 680.0, 460.0, 825.0, 75.0, 130.0, 125.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9954259956459809, "mean_inference_ms": 1.696340611997079, "mean_action_processing_ms": 0.3646411635815477, "mean_env_wait_ms": 0.2594425338143761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006668567657470703, "StateBufferConnector_ms": 0.004279375076293945, "ViewRequirementAgentConnector_ms": 0.16224932670593262}, "num_episodes": 18, "episode_return_max": 558.0, "episode_return_min": -4080.0, "episode_return_mean": -526.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 52.97698397719007, "num_env_steps_trained_throughput_per_sec": 52.97698397719007, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 76002.053, "restore_workers_time_ms": 0.014, "training_step_time_ms": 76001.989, "sample_time_ms": 1526.34, "learn_time_ms": 74453.411, "learn_throughput": 53.725, "synch_weights_time_ms": 15.993}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "training_iteration": 29, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-54-12", "timestamp": 1723488852, "time_this_iter_s": 75.56081199645996, "time_total_s": 2257.9507355690002, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1085f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2257.9507355690002, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 37.94392523364486, "ram_util_percent": 82.71682242990653}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3725046301353063, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9103646770436713, "policy_loss": -0.013228754179489448, "vf_loss": 3.9223425367199782, "vf_explained_var": 0.0004174809083870962, "kl": 0.008339296753816814, "entropy": 1.0854157192487244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 83190.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.4109440448436334, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3756060618880794, "policy_loss": -0.013469941416633123, "vf_loss": 3.3873759025377583, "vf_explained_var": 0.017973190017625797, "kl": 0.00850051103807539, "entropy": 1.3626115661563603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 83190.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 558.0, "episode_reward_min": -4080.0, "episode_reward_mean": -415.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -522.81, "predator_policy": 384.18333333333334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-996.0, -1462.0, -1462.0, -1176.0, 325.0, -369.0, -596.0, -1103.0, -174.0, -1215.0, 452.0, -1087.0, 2.0, 231.0, 96.0, -1420.0, -1225.0, -1271.0, 64.0, 147.0, -322.0, -287.0, -170.0, -1478.0, -68.0, -2240.0, -709.0, 151.0, -1874.0, -784.0, 218.0, -1344.0, -1553.0, -201.0, 340.0, -516.0, -1245.0, -498.0, -952.0, 210.0, 532.0, -1466.0, 338.0, 111.0, 439.0, 516.0, 142.0, -1401.0, 388.0, 545.0, 143.0, 411.0, -681.0, 514.0, -1287.0, -702.0, -611.0, -4080.0, 550.0, -614.0, 203.0, 401.0, 101.0, -20.0, 334.0, 445.0, -405.0, 296.0, 196.0, -6.0, -262.0, 313.0, -1737.0, 558.0, 98.0, 417.0, -1230.0, 321.0, 231.0, -71.0, -636.0, 545.0, -3221.0, 298.0, -2903.0, 374.0, 128.0, 257.0, -2131.0, -49.0, 139.0, 290.0, 15.0, 13.0, 251.0, 153.0, 124.0, -2261.0, -1085.0, -298.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-867.0, -1901.0, -493.0, -372.0, -1505.0, -1450.0, -1120.0, -1263.0, -1329.0, -1593.0, -1318.0, -185.0, 112.0, -372.0, 200.0, -746.0, -999.0, -9.0, -537.0, -1571.0, -438.0, -1329.0, -53.0, -1516.0, -1032.0, -152.0, 200.0, -680.0, -735.0, -680.0, 200.0, -1758.0, 200.0, -1395.0, -361.0, -1241.0, -1637.0, 2.0, 57.0, -438.0, -1901.0, 200.0, -1648.0, 101.0, 68.0, -1318.0, -537.0, -2000.0, -735.0, -559.0, -691.0, -1769.0, -295.0, -1747.0, -119.0, -75.0, -1637.0, -9.0, 178.0, -207.0, -1824.0, -218.0, -350.0, -20.0, -372.0, -955.0, 178.0, -185.0, -1208.0, -834.0, -790.0, -944.0, -108.0, -284.0, -361.0, -1450.0, -1043.0, -1417.0, -1230.0, -1164.0, -515.0, -75.0, -229.0, 200.0, -1076.0, -1362.0, -1406.0, -1417.0, -724.0, -438.0, 112.0, 35.0, -174.0, -1450.0, -1054.0, -845.0, -757.0, -691.0, -1340.0, -141.0, -427.0, -273.0, -9.0, 178.0, 46.0, -1736.0, -801.0, -64.0, -229.0, -1813.0, -1538.0, -394.0, -1560.0, -339.0, -713.0, -482.0, -482.0, -669.0, 46.0, 123.0, 200.0, -108.0, 200.0, -1703.0, -1417.0, -416.0, 200.0, -1593.0, 46.0, 35.0, -581.0, 57.0, 189.0, -1373.0, 123.0, 46.0, 200.0, 200.0, 200.0, -361.0, 13.0, -900.0, -1098.0, -1373.0, 156.0, 35.0, -273.0, 189.0, -75.0, 156.0, 200.0, -185.0, -1197.0, 189.0, 200.0, -493.0, -174.0, -647.0, -405.0, -1186.0, 200.0, 35.0, -779.0, -746.0, -1087.0, -240.0, -372.0, -625.0, -1516.0, -812.0, 112.0, -1439.0, -1923.0, -1923.0, -603.0, 200.0, -262.0, -1043.0, -515.0, -636.0, -1912.0, 145.0, 200.0, 57.0, 101.0, 178.0, -163.0, -163.0, 112.0, -295.0, -504.0, 134.0, -614.0, 200.0, -207.0, 134.0, -724.0, 90.0, -9.0, -515.0, -526.0, 200.0, 200.0, -504.0, 200.0, -229.0, -240.0, -416.0, 200.0, -515.0, -460.0, -163.0, -1769.0, -31.0, -53.0, 112.0, -1109.0, -1582.0, -1131.0, 123.0, 200.0, -680.0, -350.0, -702.0, 200.0, -75.0, 167.0, 200.0, -977.0, -801.0, -1527.0, 134.0, 200.0, -1923.0, 2.0, -108.0, -273.0, 189.0, -394.0, -1131.0, -1604.0, -537.0, -460.0, 189.0, -174.0, 200.0, -1813.0, -966.0, -1967.0, -53.0, 200.0, -64.0, -1637.0, -1263.0, -1538.0, 79.0, 200.0, -185.0, -1087.0, 145.0, 200.0, 13.0, 156.0, -42.0, -1329.0, -1296.0, -856.0, -42.0, -394.0, -548.0, -119.0, 46.0, -53.0, -889.0, 101.0, 178.0, -53.0, -262.0, -130.0, -757.0, -229.0, 79.0, -284.0, -735.0, 145.0, 57.0, -647.0, 178.0, -207.0, -64.0, 145.0, -1428.0, -988.0, -625.0, -526.0, -1109.0, -955.0, -9.0, -878.0, -691.0], "policy_predator_policy_reward": [675.0, 730.0, 860.0, 850.0, 215.0, 800.0, 765.0, 895.0, 590.0, 650.0, 490.0, 780.0, 250.0, 15.0, 120.0, 430.0, 560.0, 395.0, 725.0, 590.0, 635.0, 800.0, 605.0, 390.0, 120.0, 575.0, 115.0, 305.0, 185.0, 390.0, 755.0, 590.0, 465.0, 510.0, 850.0, 550.0, 525.0, 645.0, 410.0, 705.0, 820.0, 845.0, 695.0, 395.0, 485.0, 745.0, 760.0, 930.0, 460.0, 265.0, 35.0, 815.0, 760.0, 965.0, 365.0, 690.0, 840.0, 185.0, 0.0, 0.0, 750.0, 685.0, 635.0, 310.0, 270.0, 480.0, 220.0, 305.0, 520.0, 535.0, 230.0, 325.0, 155.0, 260.0, 270.0, 695.0, 665.0, 310.0, 735.0, 915.0, 550.0, 0.0, 95.0, 160.0, 815.0, 530.0, 625.0, 535.0, 565.0, 695.0, 0.0, 50.0, 195.0, 485.0, 715.0, 805.0, 365.0, 215.0, 655.0, 95.0, 255.0, 290.0, 0.0, 125.0, 0.0, 600.0, 800.0, 685.0, 695.0, 740.0, 900.0, 735.0, 675.0, 385.0, 80.0, 410.0, 235.0, 310.0, 20.0, 380.0, 100.0, 140.0, 0.0, 505.0, 725.0, 840.0, 560.0, 750.0, 375.0, 335.0, 140.0, 125.0, 575.0, 455.0, 470.0, 70.0, 0.0, 0.0, 30.0, 5.0, 255.0, 635.0, 650.0, 685.0, 15.0, 165.0, 290.0, 75.0, 85.0, 115.0, 555.0, 200.0, 570.0, 100.0, 110.0, 305.0, 30.0, 115.0, 400.0, 490.0, 550.0, 425.0, 560.0, 365.0, 400.0, 0.0, 380.0, 155.0, 480.0, 770.0, 355.0, 860.0, 0.0, 345.0, 470.0, 475.0, 270.0, 595.0, 730.0, 255.0, 505.0, 670.0, 595.0, 0.0, 65.0, 0.0, 155.0, 70.0, 90.0, 275.0, 45.0, 325.0, 175.0, 465.0, 315.0, 410.0, 220.0, 315.0, 340.0, 165.0, 140.0, 145.0, 200.0, 55.0, 150.0, 145.0, 170.0, 120.0, 215.0, 390.0, 665.0, 790.0, 675.0, 95.0, 150.0, 40.0, 710.0, 800.0, 575.0, 235.0, 320.0, 360.0, 275.0, 270.0, 405.0, 0.0, 125.0, 0.0, 665.0, 760.0, 650.0, 755.0, 590.0, 565.0, 105.0, 270.0, 235.0, 465.0, 390.0, 410.0, 680.0, 460.0, 825.0, 75.0, 130.0, 125.0, 1000.0, 520.0, 5.0, 140.0, 30.0, 45.0, 850.0, 410.0, 275.0, 50.0, 175.0, 55.0, 290.0, 310.0, 270.0, 0.0, 110.0, 20.0, 505.0, 765.0, 80.0, 230.0, 410.0, 295.0, 30.0, 130.0, 105.0, 390.0, 365.0, 145.0, 50.0, 130.0, 280.0, 290.0, 245.0, 385.0, 320.0, 395.0, 410.0, 245.0, 170.0, 150.0, 200.0, 5.0, 45.0, 15.0, 760.0, 5.0, 580.0, 545.0, 380.0, 395.0, 325.0, 560.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.993929904159678, "mean_inference_ms": 1.692131847405052, "mean_action_processing_ms": 0.36465649860483706, "mean_env_wait_ms": 0.2590358049789143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006696105003356934, "StateBufferConnector_ms": 0.0044242143630981445, "ViewRequirementAgentConnector_ms": 0.165030837059021}, "num_episodes": 18, "episode_return_max": 558.0, "episode_return_min": -4080.0, "episode_return_mean": -415.88, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.3982199871907, "num_env_steps_trained_throughput_per_sec": 53.3982199871907, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 76136.949, "restore_workers_time_ms": 0.014, "training_step_time_ms": 76136.884, "sample_time_ms": 1522.301, "learn_time_ms": 74593.053, "learn_throughput": 53.624, "synch_weights_time_ms": 15.741}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 30, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-55-27", "timestamp": 1723488927, "time_this_iter_s": 74.95177912712097, "time_total_s": 2332.902514696121, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1078d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2332.902514696121, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 35.426415094339625, "ram_util_percent": 82.86981132075472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3513620461766602, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.857046677626617, "policy_loss": -0.011499258579441894, "vf_loss": 4.867465208861844, "vf_explained_var": 0.00019310482427583518, "kl": 0.007204801063530549, "entropy": 1.0664768127050805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 86010.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.4360815169117975, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.11351893421606, "policy_loss": -0.013620383917694212, "vf_loss": 4.125343646140808, "vf_explained_var": 0.014767155600777754, "kl": 0.008978374739221804, "entropy": 1.3703153574720341, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 86010.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "env_runners": {"episode_reward_max": 588.0, "episode_reward_min": -4080.0, "episode_reward_mean": -318.1, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -436.35, "predator_policy": 330.31666666666666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [64.0, 147.0, -322.0, -287.0, -170.0, -1478.0, -68.0, -2240.0, -709.0, 151.0, -1874.0, -784.0, 218.0, -1344.0, -1553.0, -201.0, 340.0, -516.0, -1245.0, -498.0, -952.0, 210.0, 532.0, -1466.0, 338.0, 111.0, 439.0, 516.0, 142.0, -1401.0, 388.0, 545.0, 143.0, 411.0, -681.0, 514.0, -1287.0, -702.0, -611.0, -4080.0, 550.0, -614.0, 203.0, 401.0, 101.0, -20.0, 334.0, 445.0, -405.0, 296.0, 196.0, -6.0, -262.0, 313.0, -1737.0, 558.0, 98.0, 417.0, -1230.0, 321.0, 231.0, -71.0, -636.0, 545.0, -3221.0, 298.0, -2903.0, 374.0, 128.0, 257.0, -2131.0, -49.0, 139.0, 290.0, 15.0, 13.0, 251.0, 153.0, 124.0, -2261.0, -1085.0, -298.0, 519.0, -2421.0, 178.0, 459.0, -5.0, 553.0, 588.0, 298.0, 374.0, -342.0, 18.0, 278.0, 121.0, -3705.0, -252.0, 251.0, 221.0, 195.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-119.0, -75.0, -1637.0, -9.0, 178.0, -207.0, -1824.0, -218.0, -350.0, -20.0, -372.0, -955.0, 178.0, -185.0, -1208.0, -834.0, -790.0, -944.0, -108.0, -284.0, -361.0, -1450.0, -1043.0, -1417.0, -1230.0, -1164.0, -515.0, -75.0, -229.0, 200.0, -1076.0, -1362.0, -1406.0, -1417.0, -724.0, -438.0, 112.0, 35.0, -174.0, -1450.0, -1054.0, -845.0, -757.0, -691.0, -1340.0, -141.0, -427.0, -273.0, -9.0, 178.0, 46.0, -1736.0, -801.0, -64.0, -229.0, -1813.0, -1538.0, -394.0, -1560.0, -339.0, -713.0, -482.0, -482.0, -669.0, 46.0, 123.0, 200.0, -108.0, 200.0, -1703.0, -1417.0, -416.0, 200.0, -1593.0, 46.0, 35.0, -581.0, 57.0, 189.0, -1373.0, 123.0, 46.0, 200.0, 200.0, 200.0, -361.0, 13.0, -900.0, -1098.0, -1373.0, 156.0, 35.0, -273.0, 189.0, -75.0, 156.0, 200.0, -185.0, -1197.0, 189.0, 200.0, -493.0, -174.0, -647.0, -405.0, -1186.0, 200.0, 35.0, -779.0, -746.0, -1087.0, -240.0, -372.0, -625.0, -1516.0, -812.0, 112.0, -1439.0, -1923.0, -1923.0, -603.0, 200.0, -262.0, -1043.0, -515.0, -636.0, -1912.0, 145.0, 200.0, 57.0, 101.0, 178.0, -163.0, -163.0, 112.0, -295.0, -504.0, 134.0, -614.0, 200.0, -207.0, 134.0, -724.0, 90.0, -9.0, -515.0, -526.0, 200.0, 200.0, -504.0, 200.0, -229.0, -240.0, -416.0, 200.0, -515.0, -460.0, -163.0, -1769.0, -31.0, -53.0, 112.0, -1109.0, -1582.0, -1131.0, 123.0, 200.0, -680.0, -350.0, -702.0, 200.0, -75.0, 167.0, 200.0, -977.0, -801.0, -1527.0, 134.0, 200.0, -1923.0, 2.0, -108.0, -273.0, 189.0, -394.0, -1131.0, -1604.0, -537.0, -460.0, 189.0, -174.0, 200.0, -1813.0, -966.0, -1967.0, -53.0, 200.0, -64.0, -1637.0, -1263.0, -1538.0, 79.0, 200.0, -185.0, -1087.0, 145.0, 200.0, 13.0, 156.0, -42.0, -1329.0, -1296.0, -856.0, -42.0, -394.0, -548.0, -119.0, 46.0, -53.0, -889.0, 101.0, 178.0, -53.0, -262.0, -130.0, -757.0, -229.0, 79.0, -284.0, -735.0, 145.0, 57.0, -647.0, 178.0, -207.0, -64.0, 145.0, -1428.0, -988.0, -625.0, -526.0, -1109.0, -955.0, -9.0, -878.0, -691.0, 46.0, 123.0, -625.0, -1329.0, -911.0, -1076.0, -416.0, -537.0, 46.0, 57.0, 167.0, -295.0, -240.0, -196.0, -394.0, -1307.0, 112.0, 178.0, 200.0, 200.0, 178.0, -427.0, -75.0, 200.0, 123.0, -185.0, 101.0, -570.0, -526.0, 134.0, -163.0, -977.0, -42.0, -350.0, -20.0, 178.0, -229.0, -416.0, -64.0, -1593.0, -1505.0, -1637.0, -75.0, -97.0, -405.0, -900.0, -163.0, -31.0, -64.0, 200.0, -130.0, -317.0, -196.0, -757.0], "policy_predator_policy_reward": [365.0, 690.0, 840.0, 185.0, 0.0, 0.0, 750.0, 685.0, 635.0, 310.0, 270.0, 480.0, 220.0, 305.0, 520.0, 535.0, 230.0, 325.0, 155.0, 260.0, 270.0, 695.0, 665.0, 310.0, 735.0, 915.0, 550.0, 0.0, 95.0, 160.0, 815.0, 530.0, 625.0, 535.0, 565.0, 695.0, 0.0, 50.0, 195.0, 485.0, 715.0, 805.0, 365.0, 215.0, 655.0, 95.0, 255.0, 290.0, 0.0, 125.0, 0.0, 600.0, 800.0, 685.0, 695.0, 740.0, 900.0, 735.0, 675.0, 385.0, 80.0, 410.0, 235.0, 310.0, 20.0, 380.0, 100.0, 140.0, 0.0, 505.0, 725.0, 840.0, 560.0, 750.0, 375.0, 335.0, 140.0, 125.0, 575.0, 455.0, 470.0, 70.0, 0.0, 0.0, 30.0, 5.0, 255.0, 635.0, 650.0, 685.0, 15.0, 165.0, 290.0, 75.0, 85.0, 115.0, 555.0, 200.0, 570.0, 100.0, 110.0, 305.0, 30.0, 115.0, 400.0, 490.0, 550.0, 425.0, 560.0, 365.0, 400.0, 0.0, 380.0, 155.0, 480.0, 770.0, 355.0, 860.0, 0.0, 345.0, 470.0, 475.0, 270.0, 595.0, 730.0, 255.0, 505.0, 670.0, 595.0, 0.0, 65.0, 0.0, 155.0, 70.0, 90.0, 275.0, 45.0, 325.0, 175.0, 465.0, 315.0, 410.0, 220.0, 315.0, 340.0, 165.0, 140.0, 145.0, 200.0, 55.0, 150.0, 145.0, 170.0, 120.0, 215.0, 390.0, 665.0, 790.0, 675.0, 95.0, 150.0, 40.0, 710.0, 800.0, 575.0, 235.0, 320.0, 360.0, 275.0, 270.0, 405.0, 0.0, 125.0, 0.0, 665.0, 760.0, 650.0, 755.0, 590.0, 565.0, 105.0, 270.0, 235.0, 465.0, 390.0, 410.0, 680.0, 460.0, 825.0, 75.0, 130.0, 125.0, 1000.0, 520.0, 5.0, 140.0, 30.0, 45.0, 850.0, 410.0, 275.0, 50.0, 175.0, 55.0, 290.0, 310.0, 270.0, 0.0, 110.0, 20.0, 505.0, 765.0, 80.0, 230.0, 410.0, 295.0, 30.0, 130.0, 105.0, 390.0, 365.0, 145.0, 50.0, 130.0, 280.0, 290.0, 245.0, 385.0, 320.0, 395.0, 410.0, 245.0, 170.0, 150.0, 200.0, 5.0, 45.0, 15.0, 760.0, 5.0, 580.0, 545.0, 380.0, 395.0, 325.0, 560.0, 325.0, 335.0, 315.0, 165.0, 720.0, 10.0, 300.0, 420.0, 365.0, 170.0, 175.0, 185.0, 235.0, 265.0, 325.0, 635.0, 455.0, 480.0, 10.0, 0.0, 0.0, 285.0, 260.0, 55.0, 120.0, 120.0, 95.0, 110.0, 225.0, 285.0, 430.0, 405.0, 365.0, 195.0, 145.0, 130.0, 220.0, 385.0, 225.0, 1000.0, 15.0, 15.0, 200.0, 0.0, 125.0, 385.0, 505.0, 455.0, 125.0, 90.0, 0.0, 570.0, 480.0, 415.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9926556771205913, "mean_inference_ms": 1.6882580110141316, "mean_action_processing_ms": 0.3645761100225644, "mean_env_wait_ms": 0.25861227836428463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007314920425415039, "StateBufferConnector_ms": 0.004521846771240234, "ViewRequirementAgentConnector_ms": 0.17377698421478271}, "num_episodes": 18, "episode_return_max": 588.0, "episode_return_min": -4080.0, "episode_return_mean": -318.1, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.07945015732382, "num_env_steps_trained_throughput_per_sec": 54.07945015732382, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 76123.458, "restore_workers_time_ms": 0.014, "training_step_time_ms": 76123.387, "sample_time_ms": 1522.34, "learn_time_ms": 74578.8, "learn_throughput": 53.635, "synch_weights_time_ms": 16.241}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "training_iteration": 31, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-56-41", "timestamp": 1723489001, "time_this_iter_s": 73.99966597557068, "time_total_s": 2406.902180671692, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b10850d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2406.902180671692, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 34.1047619047619, "ram_util_percent": 82.75142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2725395147999128, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2737983184503325, "policy_loss": -0.011884940849907748, "vf_loss": 3.2844199427053438, "vf_explained_var": 0.00017762841485070843, "kl": 0.008422049319223017, "entropy": 0.9765890258001098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 88830.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.5402533295518115, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.744971373656117, "policy_loss": -0.015750593637283032, "vf_loss": 4.758847019773849, "vf_explained_var": 0.010348673048594319, "kl": 0.009374779401650017, "entropy": 1.3970027735470034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 88830.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -4219.0, "episode_reward_mean": -449.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -438.73333333333335, "predator_policy": 288.8833333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [516.0, 142.0, -1401.0, 388.0, 545.0, 143.0, 411.0, -681.0, 514.0, -1287.0, -702.0, -611.0, -4080.0, 550.0, -614.0, 203.0, 401.0, 101.0, -20.0, 334.0, 445.0, -405.0, 296.0, 196.0, -6.0, -262.0, 313.0, -1737.0, 558.0, 98.0, 417.0, -1230.0, 321.0, 231.0, -71.0, -636.0, 545.0, -3221.0, 298.0, -2903.0, 374.0, 128.0, 257.0, -2131.0, -49.0, 139.0, 290.0, 15.0, 13.0, 251.0, 153.0, 124.0, -2261.0, -1085.0, -298.0, 519.0, -2421.0, 178.0, 459.0, -5.0, 553.0, 588.0, 298.0, 374.0, -342.0, 18.0, 278.0, 121.0, -3705.0, -252.0, 251.0, 221.0, 195.0, -35.0, 600.0, -3439.0, 359.0, 447.0, -360.0, -815.0, 600.0, -3260.0, -1929.0, -1746.0, -2579.0, -4219.0, -1587.0, 442.0, -120.0, -3360.0, 570.0, -416.0, 154.0, 493.0, 0.0, -178.0, -2627.0, 346.0, -4017.0, 374.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [46.0, 200.0, 200.0, 200.0, -361.0, 13.0, -900.0, -1098.0, -1373.0, 156.0, 35.0, -273.0, 189.0, -75.0, 156.0, 200.0, -185.0, -1197.0, 189.0, 200.0, -493.0, -174.0, -647.0, -405.0, -1186.0, 200.0, 35.0, -779.0, -746.0, -1087.0, -240.0, -372.0, -625.0, -1516.0, -812.0, 112.0, -1439.0, -1923.0, -1923.0, -603.0, 200.0, -262.0, -1043.0, -515.0, -636.0, -1912.0, 145.0, 200.0, 57.0, 101.0, 178.0, -163.0, -163.0, 112.0, -295.0, -504.0, 134.0, -614.0, 200.0, -207.0, 134.0, -724.0, 90.0, -9.0, -515.0, -526.0, 200.0, 200.0, -504.0, 200.0, -229.0, -240.0, -416.0, 200.0, -515.0, -460.0, -163.0, -1769.0, -31.0, -53.0, 112.0, -1109.0, -1582.0, -1131.0, 123.0, 200.0, -680.0, -350.0, -702.0, 200.0, -75.0, 167.0, 200.0, -977.0, -801.0, -1527.0, 134.0, 200.0, -1923.0, 2.0, -108.0, -273.0, 189.0, -394.0, -1131.0, -1604.0, -537.0, -460.0, 189.0, -174.0, 200.0, -1813.0, -966.0, -1967.0, -53.0, 200.0, -64.0, -1637.0, -1263.0, -1538.0, 79.0, 200.0, -185.0, -1087.0, 145.0, 200.0, 13.0, 156.0, -42.0, -1329.0, -1296.0, -856.0, -42.0, -394.0, -548.0, -119.0, 46.0, -53.0, -889.0, 101.0, 178.0, -53.0, -262.0, -130.0, -757.0, -229.0, 79.0, -284.0, -735.0, 145.0, 57.0, -647.0, 178.0, -207.0, -64.0, 145.0, -1428.0, -988.0, -625.0, -526.0, -1109.0, -955.0, -9.0, -878.0, -691.0, 46.0, 123.0, -625.0, -1329.0, -911.0, -1076.0, -416.0, -537.0, 46.0, 57.0, 167.0, -295.0, -240.0, -196.0, -394.0, -1307.0, 112.0, 178.0, 200.0, 200.0, 178.0, -427.0, -75.0, 200.0, 123.0, -185.0, 101.0, -570.0, -526.0, 134.0, -163.0, -977.0, -42.0, -350.0, -20.0, 178.0, -229.0, -416.0, -64.0, -1593.0, -1505.0, -1637.0, -75.0, -97.0, -405.0, -900.0, -163.0, -31.0, -64.0, 200.0, -130.0, -317.0, -196.0, -757.0, -482.0, -328.0, -460.0, 200.0, 200.0, 200.0, -1538.0, -1395.0, -1571.0, -306.0, 189.0, 101.0, 200.0, -108.0, 200.0, -658.0, 68.0, -735.0, -361.0, -911.0, -548.0, 200.0, 200.0, 200.0, -1505.0, -1208.0, -1692.0, -1428.0, -614.0, -1197.0, -658.0, -1439.0, -779.0, -1978.0, -1384.0, -537.0, -2000.0, -1725.0, -1934.0, -988.0, -702.0, -867.0, 200.0, -86.0, 68.0, -240.0, -955.0, -405.0, -1197.0, -1846.0, -1802.0, 200.0, 200.0, 145.0, -97.0, -867.0, -372.0, -97.0, -218.0, -86.0, 200.0, 145.0, -97.0, 200.0, -680.0, -240.0, -317.0, -196.0, -350.0, -1571.0, -1472.0, -614.0, -306.0, -53.0, 200.0, -1626.0, -1978.0, -1538.0, 200.0, -295.0, 134.0], "policy_predator_policy_reward": [70.0, 0.0, 0.0, 30.0, 5.0, 255.0, 635.0, 650.0, 685.0, 15.0, 165.0, 290.0, 75.0, 85.0, 115.0, 555.0, 200.0, 570.0, 100.0, 110.0, 305.0, 30.0, 115.0, 400.0, 490.0, 550.0, 425.0, 560.0, 365.0, 400.0, 0.0, 380.0, 155.0, 480.0, 770.0, 355.0, 860.0, 0.0, 345.0, 470.0, 475.0, 270.0, 595.0, 730.0, 255.0, 505.0, 670.0, 595.0, 0.0, 65.0, 0.0, 155.0, 70.0, 90.0, 275.0, 45.0, 325.0, 175.0, 465.0, 315.0, 410.0, 220.0, 315.0, 340.0, 165.0, 140.0, 145.0, 200.0, 55.0, 150.0, 145.0, 170.0, 120.0, 215.0, 390.0, 665.0, 790.0, 675.0, 95.0, 150.0, 40.0, 710.0, 800.0, 575.0, 235.0, 320.0, 360.0, 275.0, 270.0, 405.0, 0.0, 125.0, 0.0, 665.0, 760.0, 650.0, 755.0, 590.0, 565.0, 105.0, 270.0, 235.0, 465.0, 390.0, 410.0, 680.0, 460.0, 825.0, 75.0, 130.0, 125.0, 1000.0, 520.0, 5.0, 140.0, 30.0, 45.0, 850.0, 410.0, 275.0, 50.0, 175.0, 55.0, 290.0, 310.0, 270.0, 0.0, 110.0, 20.0, 505.0, 765.0, 80.0, 230.0, 410.0, 295.0, 30.0, 130.0, 105.0, 390.0, 365.0, 145.0, 50.0, 130.0, 280.0, 290.0, 245.0, 385.0, 320.0, 395.0, 410.0, 245.0, 170.0, 150.0, 200.0, 5.0, 45.0, 15.0, 760.0, 5.0, 580.0, 545.0, 380.0, 395.0, 325.0, 560.0, 325.0, 335.0, 315.0, 165.0, 720.0, 10.0, 300.0, 420.0, 365.0, 170.0, 175.0, 185.0, 235.0, 265.0, 325.0, 635.0, 455.0, 480.0, 10.0, 0.0, 0.0, 285.0, 260.0, 55.0, 120.0, 120.0, 95.0, 110.0, 225.0, 285.0, 430.0, 405.0, 365.0, 195.0, 145.0, 130.0, 220.0, 385.0, 225.0, 1000.0, 15.0, 15.0, 200.0, 0.0, 125.0, 385.0, 505.0, 455.0, 125.0, 90.0, 0.0, 570.0, 480.0, 415.0, 405.0, 245.0, 585.0, 0.0, 0.0, 0.0, 140.0, 910.0, 15.0, 90.0, 35.0, 250.0, 135.0, 20.0, 0.0, 275.0, 530.0, 160.0, 335.0, 155.0, 515.0, 0.0, 0.0, 0.0, 175.0, 910.0, 60.0, 260.0, 360.0, 690.0, 660.0, 190.0, 280.0, 995.0, 300.0, 25.0, 305.0, 135.0, 1000.0, 695.0, 165.0, 110.0, 110.0, 110.0, 40.0, 545.0, 310.0, 625.0, 265.0, 290.0, 930.0, 0.0, 25.0, 0.0, 320.0, 315.0, 285.0, 230.0, 240.0, 85.0, 95.0, 0.0, 150.0, 215.0, 160.0, 345.0, 135.0, 245.0, 305.0, 875.0, 0.0, 155.0, 180.0, 145.0, 180.0, 90.0, 1000.0, 35.0, 165.0, 65.0, 105.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9916239762638507, "mean_inference_ms": 1.6846815956876333, "mean_action_processing_ms": 0.364716271993578, "mean_env_wait_ms": 0.2578222649469511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00932931900024414, "StateBufferConnector_ms": 0.004598021507263184, "ViewRequirementAgentConnector_ms": 0.16340136528015137}, "num_episodes": 27, "episode_return_max": 600.0, "episode_return_min": -4219.0, "episode_return_mean": -449.55, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.07456949250308, "num_env_steps_trained_throughput_per_sec": 54.07456949250308, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 75851.268, "restore_workers_time_ms": 0.014, "training_step_time_ms": 75851.197, "sample_time_ms": 1538.832, "learn_time_ms": 74287.65, "learn_throughput": 53.845, "synch_weights_time_ms": 18.872}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 32, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-57-55", "timestamp": 1723489075, "time_this_iter_s": 74.01757264137268, "time_total_s": 2480.9197533130646, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b231e280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2480.9197533130646, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 33.46923076923077, "ram_util_percent": 82.8423076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3239263594573272, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9719775121262733, "policy_loss": -0.012598857523544017, "vf_loss": 3.983286511221676, "vf_explained_var": -1.0702309879005379e-05, "kl": 0.008599034760683359, "entropy": 0.8902290607175083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 91650.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.12850002084218, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.720737372983432, "policy_loss": -0.011177651591661735, "vf_loss": 4.730613117353291, "vf_explained_var": 0.012758590122486682, "kl": 0.006509546976098015, "entropy": 1.3796219153607145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 91650.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -4219.0, "episode_reward_mean": -531.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -456.18666666666667, "predator_policy": 278.8833333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, 334.0, 445.0, -405.0, 296.0, 196.0, -6.0, -262.0, 313.0, -1737.0, 558.0, 98.0, 417.0, -1230.0, 321.0, 231.0, -71.0, -636.0, 545.0, -3221.0, 298.0, -2903.0, 374.0, 128.0, 257.0, -2131.0, -49.0, 139.0, 290.0, 15.0, 13.0, 251.0, 153.0, 124.0, -2261.0, -1085.0, -298.0, 519.0, -2421.0, 178.0, 459.0, -5.0, 553.0, 588.0, 298.0, 374.0, -342.0, 18.0, 278.0, 121.0, -3705.0, -252.0, 251.0, 221.0, 195.0, -35.0, 600.0, -3439.0, 359.0, 447.0, -360.0, -815.0, 600.0, -3260.0, -1929.0, -1746.0, -2579.0, -4219.0, -1587.0, 442.0, -120.0, -3360.0, 570.0, -416.0, 154.0, 493.0, 0.0, -178.0, -2627.0, 346.0, -4017.0, 374.0, -2934.0, 377.0, 539.0, -166.0, -3759.0, -3566.0, -1577.0, -242.0, 449.0, 407.0, -157.0, 522.0, -41.0, -2125.0, -168.0, -2247.0, 390.0, 600.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-295.0, -504.0, 134.0, -614.0, 200.0, -207.0, 134.0, -724.0, 90.0, -9.0, -515.0, -526.0, 200.0, 200.0, -504.0, 200.0, -229.0, -240.0, -416.0, 200.0, -515.0, -460.0, -163.0, -1769.0, -31.0, -53.0, 112.0, -1109.0, -1582.0, -1131.0, 123.0, 200.0, -680.0, -350.0, -702.0, 200.0, -75.0, 167.0, 200.0, -977.0, -801.0, -1527.0, 134.0, 200.0, -1923.0, 2.0, -108.0, -273.0, 189.0, -394.0, -1131.0, -1604.0, -537.0, -460.0, 189.0, -174.0, 200.0, -1813.0, -966.0, -1967.0, -53.0, 200.0, -64.0, -1637.0, -1263.0, -1538.0, 79.0, 200.0, -185.0, -1087.0, 145.0, 200.0, 13.0, 156.0, -42.0, -1329.0, -1296.0, -856.0, -42.0, -394.0, -548.0, -119.0, 46.0, -53.0, -889.0, 101.0, 178.0, -53.0, -262.0, -130.0, -757.0, -229.0, 79.0, -284.0, -735.0, 145.0, 57.0, -647.0, 178.0, -207.0, -64.0, 145.0, -1428.0, -988.0, -625.0, -526.0, -1109.0, -955.0, -9.0, -878.0, -691.0, 46.0, 123.0, -625.0, -1329.0, -911.0, -1076.0, -416.0, -537.0, 46.0, 57.0, 167.0, -295.0, -240.0, -196.0, -394.0, -1307.0, 112.0, 178.0, 200.0, 200.0, 178.0, -427.0, -75.0, 200.0, 123.0, -185.0, 101.0, -570.0, -526.0, 134.0, -163.0, -977.0, -42.0, -350.0, -20.0, 178.0, -229.0, -416.0, -64.0, -1593.0, -1505.0, -1637.0, -75.0, -97.0, -405.0, -900.0, -163.0, -31.0, -64.0, 200.0, -130.0, -317.0, -196.0, -757.0, -482.0, -328.0, -460.0, 200.0, 200.0, 200.0, -1538.0, -1395.0, -1571.0, -306.0, 189.0, 101.0, 200.0, -108.0, 200.0, -658.0, 68.0, -735.0, -361.0, -911.0, -548.0, 200.0, 200.0, 200.0, -1505.0, -1208.0, -1692.0, -1428.0, -614.0, -1197.0, -658.0, -1439.0, -779.0, -1978.0, -1384.0, -537.0, -2000.0, -1725.0, -1934.0, -988.0, -702.0, -867.0, 200.0, -86.0, 68.0, -240.0, -955.0, -405.0, -1197.0, -1846.0, -1802.0, 200.0, 200.0, 145.0, -97.0, -867.0, -372.0, -97.0, -218.0, -86.0, 200.0, 145.0, -97.0, 200.0, -680.0, -240.0, -317.0, -196.0, -350.0, -1571.0, -1472.0, -614.0, -306.0, -53.0, 200.0, -1626.0, -1978.0, -1538.0, 200.0, -295.0, 134.0, -1439.0, -1285.0, -1230.0, -559.0, 200.0, 46.0, 200.0, 200.0, 79.0, -394.0, -196.0, -196.0, -1582.0, -1604.0, -1978.0, -1758.0, -1538.0, -1285.0, 134.0, -1626.0, -1285.0, -306.0, 35.0, -636.0, 134.0, 167.0, 68.0, -185.0, 145.0, -933.0, -119.0, -647.0, 189.0, 200.0, 189.0, 68.0, -592.0, 79.0, 2.0, -1087.0, -1142.0, -1736.0, -185.0, -284.0, -229.0, -1285.0, -1450.0, -1362.0, 2.0, -42.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [275.0, 45.0, 325.0, 175.0, 465.0, 315.0, 410.0, 220.0, 315.0, 340.0, 165.0, 140.0, 145.0, 200.0, 55.0, 150.0, 145.0, 170.0, 120.0, 215.0, 390.0, 665.0, 790.0, 675.0, 95.0, 150.0, 40.0, 710.0, 800.0, 575.0, 235.0, 320.0, 360.0, 275.0, 270.0, 405.0, 0.0, 125.0, 0.0, 665.0, 760.0, 650.0, 755.0, 590.0, 565.0, 105.0, 270.0, 235.0, 465.0, 390.0, 410.0, 680.0, 460.0, 825.0, 75.0, 130.0, 125.0, 1000.0, 520.0, 5.0, 140.0, 30.0, 45.0, 850.0, 410.0, 275.0, 50.0, 175.0, 55.0, 290.0, 310.0, 270.0, 0.0, 110.0, 20.0, 505.0, 765.0, 80.0, 230.0, 410.0, 295.0, 30.0, 130.0, 105.0, 390.0, 365.0, 145.0, 50.0, 130.0, 280.0, 290.0, 245.0, 385.0, 320.0, 395.0, 410.0, 245.0, 170.0, 150.0, 200.0, 5.0, 45.0, 15.0, 760.0, 5.0, 580.0, 545.0, 380.0, 395.0, 325.0, 560.0, 325.0, 335.0, 315.0, 165.0, 720.0, 10.0, 300.0, 420.0, 365.0, 170.0, 175.0, 185.0, 235.0, 265.0, 325.0, 635.0, 455.0, 480.0, 10.0, 0.0, 0.0, 285.0, 260.0, 55.0, 120.0, 120.0, 95.0, 110.0, 225.0, 285.0, 430.0, 405.0, 365.0, 195.0, 145.0, 130.0, 220.0, 385.0, 225.0, 1000.0, 15.0, 15.0, 200.0, 0.0, 125.0, 385.0, 505.0, 455.0, 125.0, 90.0, 0.0, 570.0, 480.0, 415.0, 405.0, 245.0, 585.0, 0.0, 0.0, 0.0, 140.0, 910.0, 15.0, 90.0, 35.0, 250.0, 135.0, 20.0, 0.0, 275.0, 530.0, 160.0, 335.0, 155.0, 515.0, 0.0, 0.0, 0.0, 175.0, 910.0, 60.0, 260.0, 360.0, 690.0, 660.0, 190.0, 280.0, 995.0, 300.0, 25.0, 305.0, 135.0, 1000.0, 695.0, 165.0, 110.0, 110.0, 110.0, 40.0, 545.0, 310.0, 625.0, 265.0, 290.0, 930.0, 0.0, 25.0, 0.0, 320.0, 315.0, 285.0, 230.0, 240.0, 85.0, 95.0, 0.0, 150.0, 215.0, 160.0, 345.0, 135.0, 245.0, 305.0, 875.0, 0.0, 155.0, 180.0, 145.0, 180.0, 90.0, 1000.0, 35.0, 165.0, 65.0, 105.0, 50.0, 95.0, 875.0, 215.0, 265.0, 210.0, 0.0, 45.0, 15.0, 275.0, 140.0, 205.0, 960.0, 90.0, 355.0, 0.0, 20.0, 995.0, 170.0, 135.0, 895.0, 110.0, 550.0, 5.0, 20.0, 60.0, 0.0, 465.0, 430.0, 485.0, 0.0, 30.0, 390.0, 5.0, 60.0, 0.0, 90.0, 215.0, 165.0, 20.0, 940.0, 880.0, 195.0, 170.0, 165.0, 85.0, 860.0, 905.0, 0.0, 130.0, 100.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9940962840433464, "mean_inference_ms": 1.690310879729052, "mean_action_processing_ms": 0.36670866561173054, "mean_env_wait_ms": 0.258814888246296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010105729103088379, "StateBufferConnector_ms": 0.004907488822937012, "ViewRequirementAgentConnector_ms": 0.19347822666168213}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -4219.0, "episode_return_mean": -531.91, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 52.08670219024883, "num_env_steps_trained_throughput_per_sec": 52.08670219024883, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 75728.337, "restore_workers_time_ms": 0.015, "training_step_time_ms": 75728.265, "sample_time_ms": 1629.886, "learn_time_ms": 74072.958, "learn_throughput": 54.001, "synch_weights_time_ms": 19.591}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "training_iteration": 33, "trial_id": "f7bd5_00000", "date": "2024-08-12_14-59-12", "timestamp": 1723489152, "time_this_iter_s": 76.85746479034424, "time_total_s": 2557.777218103409, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b104c430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2557.777218103409, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 40.57339449541284, "ram_util_percent": 82.57155963302753}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3557561711745059, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.104035167575728, "policy_loss": -0.011041736049026066, "vf_loss": 5.113831824698346, "vf_explained_var": -0.0001091596505320664, "kl": 0.008300442186472107, "entropy": 0.861005876736438, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 94470.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.782988384661945, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.146400365930923, "policy_loss": -0.01567566359027806, "vf_loss": 7.16007054240991, "vf_explained_var": 0.013939803733047864, "kl": 0.010027446367581409, "entropy": 1.367320278138979, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 94470.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -4263.0, "episode_reward_mean": -816.21, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -562.52, "predator_policy": 290.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [545.0, -3221.0, 298.0, -2903.0, 374.0, 128.0, 257.0, -2131.0, -49.0, 139.0, 290.0, 15.0, 13.0, 251.0, 153.0, 124.0, -2261.0, -1085.0, -298.0, 519.0, -2421.0, 178.0, 459.0, -5.0, 553.0, 588.0, 298.0, 374.0, -342.0, 18.0, 278.0, 121.0, -3705.0, -252.0, 251.0, 221.0, 195.0, -35.0, 600.0, -3439.0, 359.0, 447.0, -360.0, -815.0, 600.0, -3260.0, -1929.0, -1746.0, -2579.0, -4219.0, -1587.0, 442.0, -120.0, -3360.0, 570.0, -416.0, 154.0, 493.0, 0.0, -178.0, -2627.0, 346.0, -4017.0, 374.0, -2934.0, 377.0, 539.0, -166.0, -3759.0, -3566.0, -1577.0, -242.0, 449.0, 407.0, -157.0, 522.0, -41.0, -2125.0, -168.0, -2247.0, 390.0, 600.0, -4263.0, 195.0, 243.0, -2674.0, -1958.0, -2567.0, -2353.0, -3302.0, 170.0, -503.0, -710.0, 488.0, -4255.0, -3448.0, 600.0, -370.0, -662.0, -4219.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [189.0, -174.0, 200.0, -1813.0, -966.0, -1967.0, -53.0, 200.0, -64.0, -1637.0, -1263.0, -1538.0, 79.0, 200.0, -185.0, -1087.0, 145.0, 200.0, 13.0, 156.0, -42.0, -1329.0, -1296.0, -856.0, -42.0, -394.0, -548.0, -119.0, 46.0, -53.0, -889.0, 101.0, 178.0, -53.0, -262.0, -130.0, -757.0, -229.0, 79.0, -284.0, -735.0, 145.0, 57.0, -647.0, 178.0, -207.0, -64.0, 145.0, -1428.0, -988.0, -625.0, -526.0, -1109.0, -955.0, -9.0, -878.0, -691.0, 46.0, 123.0, -625.0, -1329.0, -911.0, -1076.0, -416.0, -537.0, 46.0, 57.0, 167.0, -295.0, -240.0, -196.0, -394.0, -1307.0, 112.0, 178.0, 200.0, 200.0, 178.0, -427.0, -75.0, 200.0, 123.0, -185.0, 101.0, -570.0, -526.0, 134.0, -163.0, -977.0, -42.0, -350.0, -20.0, 178.0, -229.0, -416.0, -64.0, -1593.0, -1505.0, -1637.0, -75.0, -97.0, -405.0, -900.0, -163.0, -31.0, -64.0, 200.0, -130.0, -317.0, -196.0, -757.0, -482.0, -328.0, -460.0, 200.0, 200.0, 200.0, -1538.0, -1395.0, -1571.0, -306.0, 189.0, 101.0, 200.0, -108.0, 200.0, -658.0, 68.0, -735.0, -361.0, -911.0, -548.0, 200.0, 200.0, 200.0, -1505.0, -1208.0, -1692.0, -1428.0, -614.0, -1197.0, -658.0, -1439.0, -779.0, -1978.0, -1384.0, -537.0, -2000.0, -1725.0, -1934.0, -988.0, -702.0, -867.0, 200.0, -86.0, 68.0, -240.0, -955.0, -405.0, -1197.0, -1846.0, -1802.0, 200.0, 200.0, 145.0, -97.0, -867.0, -372.0, -97.0, -218.0, -86.0, 200.0, 145.0, -97.0, 200.0, -680.0, -240.0, -317.0, -196.0, -350.0, -1571.0, -1472.0, -614.0, -306.0, -53.0, 200.0, -1626.0, -1978.0, -1538.0, 200.0, -295.0, 134.0, -1439.0, -1285.0, -1230.0, -559.0, 200.0, 46.0, 200.0, 200.0, 79.0, -394.0, -196.0, -196.0, -1582.0, -1604.0, -1978.0, -1758.0, -1538.0, -1285.0, 134.0, -1626.0, -1285.0, -306.0, 35.0, -636.0, 134.0, 167.0, 68.0, -185.0, 145.0, -933.0, -119.0, -647.0, 189.0, 200.0, 189.0, 68.0, -592.0, 79.0, 2.0, -1087.0, -1142.0, -1736.0, -185.0, -284.0, -229.0, -1285.0, -1450.0, -1362.0, 2.0, -42.0, 200.0, 200.0, 200.0, 200.0, -1615.0, -1846.0, -1802.0, 112.0, -515.0, 178.0, 200.0, -317.0, 35.0, -1703.0, -1868.0, -1043.0, -1461.0, -1571.0, -1241.0, -1395.0, -1351.0, -1956.0, -1417.0, -988.0, -1318.0, -1912.0, -1989.0, -1351.0, 200.0, -273.0, -97.0, -1428.0, -1109.0, 134.0, -559.0, -955.0, -526.0, -141.0, -735.0, -86.0, -1758.0, -1879.0, -1923.0, -1791.0, -1307.0, -1340.0, 200.0, 200.0, 200.0, 200.0, -438.0, -757.0, -966.0, -108.0, -1483.0, -1747.0, -1989.0, -1758.0], "policy_predator_policy_reward": [75.0, 130.0, 125.0, 1000.0, 520.0, 5.0, 140.0, 30.0, 45.0, 850.0, 410.0, 275.0, 50.0, 175.0, 55.0, 290.0, 310.0, 270.0, 0.0, 110.0, 20.0, 505.0, 765.0, 80.0, 230.0, 410.0, 295.0, 30.0, 130.0, 105.0, 390.0, 365.0, 145.0, 50.0, 130.0, 280.0, 290.0, 245.0, 385.0, 320.0, 395.0, 410.0, 245.0, 170.0, 150.0, 200.0, 5.0, 45.0, 15.0, 760.0, 5.0, 580.0, 545.0, 380.0, 395.0, 325.0, 560.0, 325.0, 335.0, 315.0, 165.0, 720.0, 10.0, 300.0, 420.0, 365.0, 170.0, 175.0, 185.0, 235.0, 265.0, 325.0, 635.0, 455.0, 480.0, 10.0, 0.0, 0.0, 285.0, 260.0, 55.0, 120.0, 120.0, 95.0, 110.0, 225.0, 285.0, 430.0, 405.0, 365.0, 195.0, 145.0, 130.0, 220.0, 385.0, 225.0, 1000.0, 15.0, 15.0, 200.0, 0.0, 125.0, 385.0, 505.0, 455.0, 125.0, 90.0, 0.0, 570.0, 480.0, 415.0, 405.0, 245.0, 585.0, 0.0, 0.0, 0.0, 140.0, 910.0, 15.0, 90.0, 35.0, 250.0, 135.0, 20.0, 0.0, 275.0, 530.0, 160.0, 335.0, 155.0, 515.0, 0.0, 0.0, 0.0, 175.0, 910.0, 60.0, 260.0, 360.0, 690.0, 660.0, 190.0, 280.0, 995.0, 300.0, 25.0, 305.0, 135.0, 1000.0, 695.0, 165.0, 110.0, 110.0, 110.0, 40.0, 545.0, 310.0, 625.0, 265.0, 290.0, 930.0, 0.0, 25.0, 0.0, 320.0, 315.0, 285.0, 230.0, 240.0, 85.0, 95.0, 0.0, 150.0, 215.0, 160.0, 345.0, 135.0, 245.0, 305.0, 875.0, 0.0, 155.0, 180.0, 145.0, 180.0, 90.0, 1000.0, 35.0, 165.0, 65.0, 105.0, 50.0, 95.0, 875.0, 215.0, 265.0, 210.0, 0.0, 45.0, 15.0, 275.0, 140.0, 205.0, 960.0, 90.0, 355.0, 0.0, 20.0, 995.0, 170.0, 135.0, 895.0, 110.0, 550.0, 5.0, 20.0, 60.0, 0.0, 465.0, 430.0, 485.0, 0.0, 30.0, 390.0, 5.0, 60.0, 0.0, 90.0, 215.0, 165.0, 20.0, 940.0, 880.0, 195.0, 170.0, 165.0, 85.0, 860.0, 905.0, 0.0, 130.0, 100.0, 0.0, 0.0, 0.0, 55.0, 915.0, 30.0, 120.0, 100.0, 200.0, 165.0, 5.0, 155.0, 955.0, 250.0, 735.0, 675.0, 890.0, 750.0, 135.0, 1000.0, 1000.0, 770.0, 280.0, 320.0, 0.0, 950.0, 1000.0, 5.0, 5.0, 330.0, 950.0, 780.0, 170.0, 435.0, 355.0, 540.0, 545.0, 430.0, 475.0, 925.0, 160.0, 220.0, 60.0, 10.0, 920.0, 0.0, 0.0, 0.0, 610.0, 15.0, 0.0, 255.0, 805.0, 835.0, 90.0, 995.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9957293583518313, "mean_inference_ms": 1.693326447357524, "mean_action_processing_ms": 0.3679733222496266, "mean_env_wait_ms": 0.25916814268856914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008516430854797363, "StateBufferConnector_ms": 0.004881143569946289, "ViewRequirementAgentConnector_ms": 0.18521380424499512}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -4263.0, "episode_return_mean": -816.21, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.233424036077565, "num_env_steps_trained_throughput_per_sec": 53.233424036077565, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 75533.346, "restore_workers_time_ms": 0.015, "training_step_time_ms": 75533.274, "sample_time_ms": 1615.424, "learn_time_ms": 73893.698, "learn_throughput": 54.132, "synch_weights_time_ms": 18.656}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 34, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-00-28", "timestamp": 1723489228, "time_this_iter_s": 75.17489004135132, "time_total_s": 2632.95210814476, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2321700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2632.95210814476, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 35.800000000000004, "ram_util_percent": 82.61792452830188}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3099709905631154, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.904701611758969, "policy_loss": -0.009128253010897534, "vf_loss": 4.912793257726845, "vf_explained_var": 5.771156321180628e-05, "kl": 0.006910679356044433, "entropy": 0.8092247133136641, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 97290.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.483757369526734, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.925219492709383, "policy_loss": -0.01643813485434487, "vf_loss": 6.9397333080886945, "vf_explained_var": 0.013771936846963057, "kl": 0.00962153381809416, "entropy": 1.3791429886158477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 97290.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -4263.0, "episode_reward_mean": -1001.9, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -636.3666666666667, "predator_policy": 302.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-298.0, 519.0, -2421.0, 178.0, 459.0, -5.0, 553.0, 588.0, 298.0, 374.0, -342.0, 18.0, 278.0, 121.0, -3705.0, -252.0, 251.0, 221.0, 195.0, -35.0, 600.0, -3439.0, 359.0, 447.0, -360.0, -815.0, 600.0, -3260.0, -1929.0, -1746.0, -2579.0, -4219.0, -1587.0, 442.0, -120.0, -3360.0, 570.0, -416.0, 154.0, 493.0, 0.0, -178.0, -2627.0, 346.0, -4017.0, 374.0, -2934.0, 377.0, 539.0, -166.0, -3759.0, -3566.0, -1577.0, -242.0, 449.0, 407.0, -157.0, 522.0, -41.0, -2125.0, -168.0, -2247.0, 390.0, 600.0, -4263.0, 195.0, 243.0, -2674.0, -1958.0, -2567.0, -2353.0, -3302.0, 170.0, -503.0, -710.0, 488.0, -4255.0, -3448.0, 600.0, -370.0, -662.0, -4219.0, -948.0, -1758.0, -3827.0, 110.0, 379.0, -2366.0, -2647.0, -724.0, 534.0, -2167.0, -3173.0, -1218.0, -3260.0, -274.0, -1248.0, 600.0, -3691.0, -1954.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.0, -878.0, -691.0, 46.0, 123.0, -625.0, -1329.0, -911.0, -1076.0, -416.0, -537.0, 46.0, 57.0, 167.0, -295.0, -240.0, -196.0, -394.0, -1307.0, 112.0, 178.0, 200.0, 200.0, 178.0, -427.0, -75.0, 200.0, 123.0, -185.0, 101.0, -570.0, -526.0, 134.0, -163.0, -977.0, -42.0, -350.0, -20.0, 178.0, -229.0, -416.0, -64.0, -1593.0, -1505.0, -1637.0, -75.0, -97.0, -405.0, -900.0, -163.0, -31.0, -64.0, 200.0, -130.0, -317.0, -196.0, -757.0, -482.0, -328.0, -460.0, 200.0, 200.0, 200.0, -1538.0, -1395.0, -1571.0, -306.0, 189.0, 101.0, 200.0, -108.0, 200.0, -658.0, 68.0, -735.0, -361.0, -911.0, -548.0, 200.0, 200.0, 200.0, -1505.0, -1208.0, -1692.0, -1428.0, -614.0, -1197.0, -658.0, -1439.0, -779.0, -1978.0, -1384.0, -537.0, -2000.0, -1725.0, -1934.0, -988.0, -702.0, -867.0, 200.0, -86.0, 68.0, -240.0, -955.0, -405.0, -1197.0, -1846.0, -1802.0, 200.0, 200.0, 145.0, -97.0, -867.0, -372.0, -97.0, -218.0, -86.0, 200.0, 145.0, -97.0, 200.0, -680.0, -240.0, -317.0, -196.0, -350.0, -1571.0, -1472.0, -614.0, -306.0, -53.0, 200.0, -1626.0, -1978.0, -1538.0, 200.0, -295.0, 134.0, -1439.0, -1285.0, -1230.0, -559.0, 200.0, 46.0, 200.0, 200.0, 79.0, -394.0, -196.0, -196.0, -1582.0, -1604.0, -1978.0, -1758.0, -1538.0, -1285.0, 134.0, -1626.0, -1285.0, -306.0, 35.0, -636.0, 134.0, 167.0, 68.0, -185.0, 145.0, -933.0, -119.0, -647.0, 189.0, 200.0, 189.0, 68.0, -592.0, 79.0, 2.0, -1087.0, -1142.0, -1736.0, -185.0, -284.0, -229.0, -1285.0, -1450.0, -1362.0, 2.0, -42.0, 200.0, 200.0, 200.0, 200.0, -1615.0, -1846.0, -1802.0, 112.0, -515.0, 178.0, 200.0, -317.0, 35.0, -1703.0, -1868.0, -1043.0, -1461.0, -1571.0, -1241.0, -1395.0, -1351.0, -1956.0, -1417.0, -988.0, -1318.0, -1912.0, -1989.0, -1351.0, 200.0, -273.0, -97.0, -1428.0, -1109.0, 134.0, -559.0, -955.0, -526.0, -141.0, -735.0, -86.0, -1758.0, -1879.0, -1923.0, -1791.0, -1307.0, -1340.0, 200.0, 200.0, 200.0, 200.0, -438.0, -757.0, -966.0, -108.0, -1483.0, -1747.0, -1989.0, -1758.0, -625.0, 156.0, -1494.0, -1648.0, 200.0, -1285.0, -1692.0, -1802.0, -1428.0, -185.0, -515.0, 145.0, 79.0, 200.0, -130.0, -1791.0, 167.0, -1747.0, -526.0, -1406.0, -1725.0, -152.0, 200.0, -1912.0, 90.0, 189.0, 200.0, -1791.0, 200.0, -1571.0, -955.0, -1670.0, -1538.0, 200.0, -1109.0, -1219.0, -1362.0, -1912.0, -1626.0, -383.0, 35.0, -856.0, -1846.0, -1538.0, 46.0, 200.0, 200.0, 200.0, -1527.0, -1659.0, -1780.0, -1769.0, -262.0, -1428.0], "policy_predator_policy_reward": [395.0, 325.0, 560.0, 325.0, 335.0, 315.0, 165.0, 720.0, 10.0, 300.0, 420.0, 365.0, 170.0, 175.0, 185.0, 235.0, 265.0, 325.0, 635.0, 455.0, 480.0, 10.0, 0.0, 0.0, 285.0, 260.0, 55.0, 120.0, 120.0, 95.0, 110.0, 225.0, 285.0, 430.0, 405.0, 365.0, 195.0, 145.0, 130.0, 220.0, 385.0, 225.0, 1000.0, 15.0, 15.0, 200.0, 0.0, 125.0, 385.0, 505.0, 455.0, 125.0, 90.0, 0.0, 570.0, 480.0, 415.0, 405.0, 245.0, 585.0, 0.0, 0.0, 0.0, 140.0, 910.0, 15.0, 90.0, 35.0, 250.0, 135.0, 20.0, 0.0, 275.0, 530.0, 160.0, 335.0, 155.0, 515.0, 0.0, 0.0, 0.0, 175.0, 910.0, 60.0, 260.0, 360.0, 690.0, 660.0, 190.0, 280.0, 995.0, 300.0, 25.0, 305.0, 135.0, 1000.0, 695.0, 165.0, 110.0, 110.0, 110.0, 40.0, 545.0, 310.0, 625.0, 265.0, 290.0, 930.0, 0.0, 25.0, 0.0, 320.0, 315.0, 285.0, 230.0, 240.0, 85.0, 95.0, 0.0, 150.0, 215.0, 160.0, 345.0, 135.0, 245.0, 305.0, 875.0, 0.0, 155.0, 180.0, 145.0, 180.0, 90.0, 1000.0, 35.0, 165.0, 65.0, 105.0, 50.0, 95.0, 875.0, 215.0, 265.0, 210.0, 0.0, 45.0, 15.0, 275.0, 140.0, 205.0, 960.0, 90.0, 355.0, 0.0, 20.0, 995.0, 170.0, 135.0, 895.0, 110.0, 550.0, 5.0, 20.0, 60.0, 0.0, 465.0, 430.0, 485.0, 0.0, 30.0, 390.0, 5.0, 60.0, 0.0, 90.0, 215.0, 165.0, 20.0, 940.0, 880.0, 195.0, 170.0, 165.0, 85.0, 860.0, 905.0, 0.0, 130.0, 100.0, 0.0, 0.0, 0.0, 55.0, 915.0, 30.0, 120.0, 100.0, 200.0, 165.0, 5.0, 155.0, 955.0, 250.0, 735.0, 675.0, 890.0, 750.0, 135.0, 1000.0, 1000.0, 770.0, 280.0, 320.0, 0.0, 950.0, 1000.0, 5.0, 5.0, 330.0, 950.0, 780.0, 170.0, 435.0, 355.0, 540.0, 545.0, 430.0, 475.0, 925.0, 160.0, 220.0, 60.0, 10.0, 920.0, 0.0, 0.0, 0.0, 610.0, 15.0, 0.0, 255.0, 805.0, 835.0, 90.0, 995.0, 190.0, 770.0, 140.0, 105.0, 0.0, 50.0, 925.0, 1000.0, 75.0, 20.0, 125.0, 400.0, 140.0, 95.0, 135.0, 0.0, 15.0, 975.0, 15.0, 35.0, 55.0, 920.0, 175.0, 100.0, 865.0, 50.0, 0.0, 5.0, 0.0, 985.0, 10.0, 875.0, 115.0, 0.0, 905.0, 0.0, 5.0, 930.0, 300.0, 410.0, 285.0, 325.0, 320.0, 920.0, 935.0, 235.0, 0.0, 0.0, 0.0, 180.0, 975.0, 120.0, 285.0, 325.0, 895.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9971736046488238, "mean_inference_ms": 1.696430656546859, "mean_action_processing_ms": 0.3692329440448048, "mean_env_wait_ms": 0.25954720412367177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009081840515136719, "StateBufferConnector_ms": 0.004568934440612793, "ViewRequirementAgentConnector_ms": 0.1852729320526123}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -4263.0, "episode_return_mean": -1001.9, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.525204604056505, "num_env_steps_trained_throughput_per_sec": 53.525204604056505, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 75308.533, "restore_workers_time_ms": 0.015, "training_step_time_ms": 75308.476, "sample_time_ms": 1592.669, "learn_time_ms": 73692.482, "learn_throughput": 54.28, "synch_weights_time_ms": 18.253}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 35, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-01-42", "timestamp": 1723489302, "time_this_iter_s": 74.80935573577881, "time_total_s": 2707.761463880539, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1085dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2707.761463880539, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 34.70566037735849, "ram_util_percent": 82.92641509433959}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.427501182522334, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.455166687356665, "policy_loss": -0.010872588444299705, "vf_loss": 6.465035914022026, "vf_explained_var": 0.0006807883580525716, "kl": 0.006689056634044809, "entropy": 0.766728763229458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 100110.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.627603798660826, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.603065223220392, "policy_loss": -0.017784772947073934, "vf_loss": 6.618681041230547, "vf_explained_var": 0.016147644130896168, "kl": 0.010844714515983513, "entropy": 1.365321207426964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 100110.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -4360.0, "episode_reward_mean": -1243.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -742.8833333333333, "predator_policy": 328.3666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [359.0, 447.0, -360.0, -815.0, 600.0, -3260.0, -1929.0, -1746.0, -2579.0, -4219.0, -1587.0, 442.0, -120.0, -3360.0, 570.0, -416.0, 154.0, 493.0, 0.0, -178.0, -2627.0, 346.0, -4017.0, 374.0, -2934.0, 377.0, 539.0, -166.0, -3759.0, -3566.0, -1577.0, -242.0, 449.0, 407.0, -157.0, 522.0, -41.0, -2125.0, -168.0, -2247.0, 390.0, 600.0, -4263.0, 195.0, 243.0, -2674.0, -1958.0, -2567.0, -2353.0, -3302.0, 170.0, -503.0, -710.0, 488.0, -4255.0, -3448.0, 600.0, -370.0, -662.0, -4219.0, -948.0, -1758.0, -3827.0, 110.0, 379.0, -2366.0, -2647.0, -724.0, 534.0, -2167.0, -3173.0, -1218.0, -3260.0, -274.0, -1248.0, 600.0, -3691.0, -1954.0, -1466.0, 8.0, -2318.0, 465.0, -1058.0, -822.0, 402.0, -1487.0, -538.0, -4360.0, 46.0, -452.0, -7.0, -2339.0, -3575.0, -2540.0, -2663.0, -1222.0, -3806.0, -1263.0, -877.0, -137.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-306.0, 189.0, 101.0, 200.0, -108.0, 200.0, -658.0, 68.0, -735.0, -361.0, -911.0, -548.0, 200.0, 200.0, 200.0, -1505.0, -1208.0, -1692.0, -1428.0, -614.0, -1197.0, -658.0, -1439.0, -779.0, -1978.0, -1384.0, -537.0, -2000.0, -1725.0, -1934.0, -988.0, -702.0, -867.0, 200.0, -86.0, 68.0, -240.0, -955.0, -405.0, -1197.0, -1846.0, -1802.0, 200.0, 200.0, 145.0, -97.0, -867.0, -372.0, -97.0, -218.0, -86.0, 200.0, 145.0, -97.0, 200.0, -680.0, -240.0, -317.0, -196.0, -350.0, -1571.0, -1472.0, -614.0, -306.0, -53.0, 200.0, -1626.0, -1978.0, -1538.0, 200.0, -295.0, 134.0, -1439.0, -1285.0, -1230.0, -559.0, 200.0, 46.0, 200.0, 200.0, 79.0, -394.0, -196.0, -196.0, -1582.0, -1604.0, -1978.0, -1758.0, -1538.0, -1285.0, 134.0, -1626.0, -1285.0, -306.0, 35.0, -636.0, 134.0, 167.0, 68.0, -185.0, 145.0, -933.0, -119.0, -647.0, 189.0, 200.0, 189.0, 68.0, -592.0, 79.0, 2.0, -1087.0, -1142.0, -1736.0, -185.0, -284.0, -229.0, -1285.0, -1450.0, -1362.0, 2.0, -42.0, 200.0, 200.0, 200.0, 200.0, -1615.0, -1846.0, -1802.0, 112.0, -515.0, 178.0, 200.0, -317.0, 35.0, -1703.0, -1868.0, -1043.0, -1461.0, -1571.0, -1241.0, -1395.0, -1351.0, -1956.0, -1417.0, -988.0, -1318.0, -1912.0, -1989.0, -1351.0, 200.0, -273.0, -97.0, -1428.0, -1109.0, 134.0, -559.0, -955.0, -526.0, -141.0, -735.0, -86.0, -1758.0, -1879.0, -1923.0, -1791.0, -1307.0, -1340.0, 200.0, 200.0, 200.0, 200.0, -438.0, -757.0, -966.0, -108.0, -1483.0, -1747.0, -1989.0, -1758.0, -625.0, 156.0, -1494.0, -1648.0, 200.0, -1285.0, -1692.0, -1802.0, -1428.0, -185.0, -515.0, 145.0, 79.0, 200.0, -130.0, -1791.0, 167.0, -1747.0, -526.0, -1406.0, -1725.0, -152.0, 200.0, -1912.0, 90.0, 189.0, 200.0, -1791.0, 200.0, -1571.0, -955.0, -1670.0, -1538.0, 200.0, -1109.0, -1219.0, -1362.0, -1912.0, -1626.0, -383.0, 35.0, -856.0, -1846.0, -1538.0, 46.0, 200.0, 200.0, 200.0, -1527.0, -1659.0, -1780.0, -1769.0, -262.0, -1428.0, 200.0, -1802.0, -1164.0, -405.0, -669.0, 112.0, -1351.0, -1505.0, -977.0, 200.0, -20.0, 145.0, -9.0, -1285.0, -1219.0, -1670.0, -218.0, -9.0, -251.0, 189.0, 189.0, -1120.0, -1428.0, -669.0, -768.0, -658.0, 178.0, -2000.0, -1890.0, -1780.0, 200.0, -119.0, -1285.0, 200.0, 200.0, -1747.0, 200.0, 2.0, -889.0, -1670.0, -1285.0, -1274.0, -1626.0, -1450.0, -1549.0, -1065.0, -1142.0, -1428.0, -1186.0, -1351.0, -1021.0, -207.0, -1318.0, -1582.0, -1791.0, -1835.0, -2000.0, 200.0, -1802.0, -1021.0, -526.0, -1021.0, -735.0, -1153.0, -42.0, 68.0], "policy_predator_policy_reward": [90.0, 35.0, 250.0, 135.0, 20.0, 0.0, 275.0, 530.0, 160.0, 335.0, 155.0, 515.0, 0.0, 0.0, 0.0, 175.0, 910.0, 60.0, 260.0, 360.0, 690.0, 660.0, 190.0, 280.0, 995.0, 300.0, 25.0, 305.0, 135.0, 1000.0, 695.0, 165.0, 110.0, 110.0, 110.0, 40.0, 545.0, 310.0, 625.0, 265.0, 290.0, 930.0, 0.0, 25.0, 0.0, 320.0, 315.0, 285.0, 230.0, 240.0, 85.0, 95.0, 0.0, 150.0, 215.0, 160.0, 345.0, 135.0, 245.0, 305.0, 875.0, 0.0, 155.0, 180.0, 145.0, 180.0, 90.0, 1000.0, 35.0, 165.0, 65.0, 105.0, 50.0, 95.0, 875.0, 215.0, 265.0, 210.0, 0.0, 45.0, 15.0, 275.0, 140.0, 205.0, 960.0, 90.0, 355.0, 0.0, 20.0, 995.0, 170.0, 135.0, 895.0, 110.0, 550.0, 5.0, 20.0, 60.0, 0.0, 465.0, 430.0, 485.0, 0.0, 30.0, 390.0, 5.0, 60.0, 0.0, 90.0, 215.0, 165.0, 20.0, 940.0, 880.0, 195.0, 170.0, 165.0, 85.0, 860.0, 905.0, 0.0, 130.0, 100.0, 0.0, 0.0, 0.0, 55.0, 915.0, 30.0, 120.0, 100.0, 200.0, 165.0, 5.0, 155.0, 955.0, 250.0, 735.0, 675.0, 890.0, 750.0, 135.0, 1000.0, 1000.0, 770.0, 280.0, 320.0, 0.0, 950.0, 1000.0, 5.0, 5.0, 330.0, 950.0, 780.0, 170.0, 435.0, 355.0, 540.0, 545.0, 430.0, 475.0, 925.0, 160.0, 220.0, 60.0, 10.0, 920.0, 0.0, 0.0, 0.0, 610.0, 15.0, 0.0, 255.0, 805.0, 835.0, 90.0, 995.0, 190.0, 770.0, 140.0, 105.0, 0.0, 50.0, 925.0, 1000.0, 75.0, 20.0, 125.0, 400.0, 140.0, 95.0, 135.0, 0.0, 15.0, 975.0, 15.0, 35.0, 55.0, 920.0, 175.0, 100.0, 865.0, 50.0, 0.0, 5.0, 0.0, 985.0, 10.0, 875.0, 115.0, 0.0, 905.0, 0.0, 5.0, 930.0, 300.0, 410.0, 285.0, 325.0, 320.0, 920.0, 935.0, 235.0, 0.0, 0.0, 0.0, 180.0, 975.0, 120.0, 285.0, 325.0, 895.0, 905.0, 220.0, 175.0, 580.0, 20.0, 370.0, 645.0, 475.0, 395.0, 60.0, 0.0, 80.0, 630.0, 720.0, 105.0, 710.0, 360.0, 5.0, 115.0, 95.0, 65.0, 630.0, 570.0, 530.0, 220.0, 490.0, 0.0, 30.0, 280.0, 1000.0, 645.0, 460.0, 145.0, 0.0, 10.0, 885.0, 160.0, 60.0, 460.0, 430.0, 875.0, 585.0, 905.0, 55.0, 90.0, 825.0, 0.0, 270.0, 95.0, 660.0, 140.0, 600.0, 460.0, 825.0, 510.0, 435.0, 875.0, 0.0, 915.0, 445.0, 555.0, 590.0, 260.0, 365.0, 295.0, 330.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9993444410620146, "mean_inference_ms": 1.7007881318572655, "mean_action_processing_ms": 0.370804952855314, "mean_env_wait_ms": 0.25991130637056825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008180022239685059, "StateBufferConnector_ms": 0.0044291019439697266, "ViewRequirementAgentConnector_ms": 0.18177664279937744}, "num_episodes": 22, "episode_return_max": 600.0, "episode_return_min": -4360.0, "episode_return_mean": -1243.55, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.38151474030399, "num_env_steps_trained_throughput_per_sec": 53.38151474030399, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 74910.432, "restore_workers_time_ms": 0.015, "training_step_time_ms": 74910.374, "sample_time_ms": 1586.925, "learn_time_ms": 73298.423, "learn_throughput": 54.571, "synch_weights_time_ms": 19.681}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 36, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-02-57", "timestamp": 1723489377, "time_this_iter_s": 74.96522235870361, "time_total_s": 2782.7266862392426, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b232ac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2782.7266862392426, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 35.077358490566034, "ram_util_percent": 82.89245283018869}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5814437598835491, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.398327024946822, "policy_loss": -0.01070953053232375, "vf_loss": 7.407968774078586, "vf_explained_var": -0.00019941069978348752, "kl": 0.0071184833740058065, "entropy": 0.7517124019827403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 102930.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.165546066456653, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.588630080983994, "policy_loss": -0.019452817288425222, "vf_loss": 5.605231118878574, "vf_explained_var": 0.020823658759712326, "kl": 0.014258908771630231, "entropy": 1.3580686177345032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 102930.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -4360.0, "episode_reward_mean": -1085.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -704.8233333333334, "predator_policy": 343.01666666666665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [374.0, -2934.0, 377.0, 539.0, -166.0, -3759.0, -3566.0, -1577.0, -242.0, 449.0, 407.0, -157.0, 522.0, -41.0, -2125.0, -168.0, -2247.0, 390.0, 600.0, -4263.0, 195.0, 243.0, -2674.0, -1958.0, -2567.0, -2353.0, -3302.0, 170.0, -503.0, -710.0, 488.0, -4255.0, -3448.0, 600.0, -370.0, -662.0, -4219.0, -948.0, -1758.0, -3827.0, 110.0, 379.0, -2366.0, -2647.0, -724.0, 534.0, -2167.0, -3173.0, -1218.0, -3260.0, -274.0, -1248.0, 600.0, -3691.0, -1954.0, -1466.0, 8.0, -2318.0, 465.0, -1058.0, -822.0, 402.0, -1487.0, -538.0, -4360.0, 46.0, -452.0, -7.0, -2339.0, -3575.0, -2540.0, -2663.0, -1222.0, -3806.0, -1263.0, -877.0, -137.0, -2078.0, 391.0, -561.0, 416.0, -1337.0, -65.0, -323.0, 412.0, 528.0, -1561.0, -364.0, -7.0, -59.0, -585.0, -614.0, 144.0, -1672.0, 582.0, -709.0, -285.0, -665.0, 207.0, 216.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -295.0, 134.0, -1439.0, -1285.0, -1230.0, -559.0, 200.0, 46.0, 200.0, 200.0, 79.0, -394.0, -196.0, -196.0, -1582.0, -1604.0, -1978.0, -1758.0, -1538.0, -1285.0, 134.0, -1626.0, -1285.0, -306.0, 35.0, -636.0, 134.0, 167.0, 68.0, -185.0, 145.0, -933.0, -119.0, -647.0, 189.0, 200.0, 189.0, 68.0, -592.0, 79.0, 2.0, -1087.0, -1142.0, -1736.0, -185.0, -284.0, -229.0, -1285.0, -1450.0, -1362.0, 2.0, -42.0, 200.0, 200.0, 200.0, 200.0, -1615.0, -1846.0, -1802.0, 112.0, -515.0, 178.0, 200.0, -317.0, 35.0, -1703.0, -1868.0, -1043.0, -1461.0, -1571.0, -1241.0, -1395.0, -1351.0, -1956.0, -1417.0, -988.0, -1318.0, -1912.0, -1989.0, -1351.0, 200.0, -273.0, -97.0, -1428.0, -1109.0, 134.0, -559.0, -955.0, -526.0, -141.0, -735.0, -86.0, -1758.0, -1879.0, -1923.0, -1791.0, -1307.0, -1340.0, 200.0, 200.0, 200.0, 200.0, -438.0, -757.0, -966.0, -108.0, -1483.0, -1747.0, -1989.0, -1758.0, -625.0, 156.0, -1494.0, -1648.0, 200.0, -1285.0, -1692.0, -1802.0, -1428.0, -185.0, -515.0, 145.0, 79.0, 200.0, -130.0, -1791.0, 167.0, -1747.0, -526.0, -1406.0, -1725.0, -152.0, 200.0, -1912.0, 90.0, 189.0, 200.0, -1791.0, 200.0, -1571.0, -955.0, -1670.0, -1538.0, 200.0, -1109.0, -1219.0, -1362.0, -1912.0, -1626.0, -383.0, 35.0, -856.0, -1846.0, -1538.0, 46.0, 200.0, 200.0, 200.0, -1527.0, -1659.0, -1780.0, -1769.0, -262.0, -1428.0, 200.0, -1802.0, -1164.0, -405.0, -669.0, 112.0, -1351.0, -1505.0, -977.0, 200.0, -20.0, 145.0, -9.0, -1285.0, -1219.0, -1670.0, -218.0, -9.0, -251.0, 189.0, 189.0, -1120.0, -1428.0, -669.0, -768.0, -658.0, 178.0, -2000.0, -1890.0, -1780.0, 200.0, -119.0, -1285.0, 200.0, 200.0, -1747.0, 200.0, 2.0, -889.0, -1670.0, -1285.0, -1274.0, -1626.0, -1450.0, -1549.0, -1065.0, -1142.0, -1428.0, -1186.0, -1351.0, -1021.0, -207.0, -1318.0, -1582.0, -1791.0, -1835.0, -2000.0, 200.0, -1802.0, -1021.0, -526.0, -1021.0, -735.0, -1153.0, -42.0, 68.0, -1923.0, -1780.0, -405.0, 134.0, -53.0, 145.0, -1208.0, 2.0, -405.0, -42.0, 200.0, -317.0, -394.0, -1098.0, -1505.0, -834.0, 200.0, -141.0, -933.0, -801.0, 101.0, 200.0, -75.0, 2.0, 200.0, 68.0, 200.0, -427.0, -1252.0, -1197.0, -691.0, 200.0, -1318.0, -427.0, 90.0, -460.0, -1439.0, 156.0, 189.0, -1043.0, -1054.0, 112.0, -1021.0, -350.0, -218.0, -295.0, -86.0, 35.0, -482.0, -1065.0, -1450.0, 167.0, 200.0, 200.0, -1659.0, -1021.0, 156.0, -691.0, 200.0, -1109.0, -548.0, -361.0, -801.0, -592.0, 79.0, -295.0, 200.0, -1604.0, 200.0], "policy_predator_policy_reward": [165.0, 65.0, 105.0, 50.0, 95.0, 875.0, 215.0, 265.0, 210.0, 0.0, 45.0, 15.0, 275.0, 140.0, 205.0, 960.0, 90.0, 355.0, 0.0, 20.0, 995.0, 170.0, 135.0, 895.0, 110.0, 550.0, 5.0, 20.0, 60.0, 0.0, 465.0, 430.0, 485.0, 0.0, 30.0, 390.0, 5.0, 60.0, 0.0, 90.0, 215.0, 165.0, 20.0, 940.0, 880.0, 195.0, 170.0, 165.0, 85.0, 860.0, 905.0, 0.0, 130.0, 100.0, 0.0, 0.0, 0.0, 55.0, 915.0, 30.0, 120.0, 100.0, 200.0, 165.0, 5.0, 155.0, 955.0, 250.0, 735.0, 675.0, 890.0, 750.0, 135.0, 1000.0, 1000.0, 770.0, 280.0, 320.0, 0.0, 950.0, 1000.0, 5.0, 5.0, 330.0, 950.0, 780.0, 170.0, 435.0, 355.0, 540.0, 545.0, 430.0, 475.0, 925.0, 160.0, 220.0, 60.0, 10.0, 920.0, 0.0, 0.0, 0.0, 610.0, 15.0, 0.0, 255.0, 805.0, 835.0, 90.0, 995.0, 190.0, 770.0, 140.0, 105.0, 0.0, 50.0, 925.0, 1000.0, 75.0, 20.0, 125.0, 400.0, 140.0, 95.0, 135.0, 0.0, 15.0, 975.0, 15.0, 35.0, 55.0, 920.0, 175.0, 100.0, 865.0, 50.0, 0.0, 5.0, 0.0, 985.0, 10.0, 875.0, 115.0, 0.0, 905.0, 0.0, 5.0, 930.0, 300.0, 410.0, 285.0, 325.0, 320.0, 920.0, 935.0, 235.0, 0.0, 0.0, 0.0, 180.0, 975.0, 120.0, 285.0, 325.0, 895.0, 905.0, 220.0, 175.0, 580.0, 20.0, 370.0, 645.0, 475.0, 395.0, 60.0, 0.0, 80.0, 630.0, 720.0, 105.0, 710.0, 360.0, 5.0, 115.0, 95.0, 65.0, 630.0, 570.0, 530.0, 220.0, 490.0, 0.0, 30.0, 280.0, 1000.0, 645.0, 460.0, 145.0, 0.0, 10.0, 885.0, 160.0, 60.0, 460.0, 430.0, 875.0, 585.0, 905.0, 55.0, 90.0, 825.0, 0.0, 270.0, 95.0, 660.0, 140.0, 600.0, 460.0, 825.0, 510.0, 435.0, 875.0, 0.0, 915.0, 445.0, 555.0, 590.0, 260.0, 365.0, 295.0, 330.0, 580.0, 550.0, 900.0, 140.0, 0.0, 25.0, 530.0, 80.0, 440.0, 240.0, 0.0, 335.0, 145.0, 845.0, 670.0, 100.0, 405.0, 205.0, 415.0, 420.0, 475.0, 90.0, 115.0, 80.0, 60.0, 0.0, 0.0, 730.0, 210.0, 375.0, 605.0, 330.0, 510.0, 350.0, 0.0, 440.0, 400.0, 460.0, 175.0, 410.0, 630.0, 360.0, 245.0, 350.0, 380.0, 65.0, 200.0, 225.0, 775.0, 205.0, 345.0, 0.0, 0.0, 15.0, 600.0, 690.0, 525.0, 560.0, 520.0, 235.0, 465.0, 390.0, 190.0, 485.0, 210.0, 320.0, 395.0, 285.0, 740.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0057711295143634, "mean_inference_ms": 1.7152066010712992, "mean_action_processing_ms": 0.374342304981095, "mean_env_wait_ms": 0.2623473178541917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007139682769775391, "StateBufferConnector_ms": 0.004900932312011719, "ViewRequirementAgentConnector_ms": 0.20161914825439453}, "num_episodes": 23, "episode_return_max": 600.0, "episode_return_min": -4360.0, "episode_return_mean": -1085.42, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.11928446493636, "num_env_steps_trained_throughput_per_sec": 53.11928446493636, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 75022.808, "restore_workers_time_ms": 0.015, "training_step_time_ms": 75022.75, "sample_time_ms": 1745.731, "learn_time_ms": 73251.818, "learn_throughput": 54.606, "synch_weights_time_ms": 19.739}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "training_iteration": 37, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-04-13", "timestamp": 1723489453, "time_this_iter_s": 75.34074020385742, "time_total_s": 2858.0674264431, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1085310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2858.0674264431, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 35.75754716981132, "ram_util_percent": 82.50471698113209}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5596796878474823, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.047751978525879, "policy_loss": -0.008210170930144145, "vf_loss": 4.055204653063565, "vf_explained_var": 0.0007093573927033878, "kl": 0.005049927282194835, "entropy": 0.7668219514561038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 105750.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.162794394167602, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.529159243859298, "policy_loss": -0.020614914469840335, "vf_loss": 2.547814107025769, "vf_explained_var": 0.02491518770549314, "kl": 0.009800238553738272, "entropy": 1.35833778854803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 105750.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -4360.0, "episode_reward_mean": -938.03, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -655.91, "predator_policy": 343.23333333333335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [600.0, -4263.0, 195.0, 243.0, -2674.0, -1958.0, -2567.0, -2353.0, -3302.0, 170.0, -503.0, -710.0, 488.0, -4255.0, -3448.0, 600.0, -370.0, -662.0, -4219.0, -948.0, -1758.0, -3827.0, 110.0, 379.0, -2366.0, -2647.0, -724.0, 534.0, -2167.0, -3173.0, -1218.0, -3260.0, -274.0, -1248.0, 600.0, -3691.0, -1954.0, -1466.0, 8.0, -2318.0, 465.0, -1058.0, -822.0, 402.0, -1487.0, -538.0, -4360.0, 46.0, -452.0, -7.0, -2339.0, -3575.0, -2540.0, -2663.0, -1222.0, -3806.0, -1263.0, -877.0, -137.0, -2078.0, 391.0, -561.0, 416.0, -1337.0, -65.0, -323.0, 412.0, 528.0, -1561.0, -364.0, -7.0, -59.0, -585.0, -614.0, 144.0, -1672.0, 582.0, -709.0, -285.0, -665.0, 207.0, 216.0, 188.0, 527.0, 129.0, 12.0, -425.0, 138.0, 408.0, 458.0, 488.0, -1938.0, 540.0, 551.0, -153.0, 235.0, 169.0, 130.0, 462.0, -1104.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, -1615.0, -1846.0, -1802.0, 112.0, -515.0, 178.0, 200.0, -317.0, 35.0, -1703.0, -1868.0, -1043.0, -1461.0, -1571.0, -1241.0, -1395.0, -1351.0, -1956.0, -1417.0, -988.0, -1318.0, -1912.0, -1989.0, -1351.0, 200.0, -273.0, -97.0, -1428.0, -1109.0, 134.0, -559.0, -955.0, -526.0, -141.0, -735.0, -86.0, -1758.0, -1879.0, -1923.0, -1791.0, -1307.0, -1340.0, 200.0, 200.0, 200.0, 200.0, -438.0, -757.0, -966.0, -108.0, -1483.0, -1747.0, -1989.0, -1758.0, -625.0, 156.0, -1494.0, -1648.0, 200.0, -1285.0, -1692.0, -1802.0, -1428.0, -185.0, -515.0, 145.0, 79.0, 200.0, -130.0, -1791.0, 167.0, -1747.0, -526.0, -1406.0, -1725.0, -152.0, 200.0, -1912.0, 90.0, 189.0, 200.0, -1791.0, 200.0, -1571.0, -955.0, -1670.0, -1538.0, 200.0, -1109.0, -1219.0, -1362.0, -1912.0, -1626.0, -383.0, 35.0, -856.0, -1846.0, -1538.0, 46.0, 200.0, 200.0, 200.0, -1527.0, -1659.0, -1780.0, -1769.0, -262.0, -1428.0, 200.0, -1802.0, -1164.0, -405.0, -669.0, 112.0, -1351.0, -1505.0, -977.0, 200.0, -20.0, 145.0, -9.0, -1285.0, -1219.0, -1670.0, -218.0, -9.0, -251.0, 189.0, 189.0, -1120.0, -1428.0, -669.0, -768.0, -658.0, 178.0, -2000.0, -1890.0, -1780.0, 200.0, -119.0, -1285.0, 200.0, 200.0, -1747.0, 200.0, 2.0, -889.0, -1670.0, -1285.0, -1274.0, -1626.0, -1450.0, -1549.0, -1065.0, -1142.0, -1428.0, -1186.0, -1351.0, -1021.0, -207.0, -1318.0, -1582.0, -1791.0, -1835.0, -2000.0, 200.0, -1802.0, -1021.0, -526.0, -1021.0, -735.0, -1153.0, -42.0, 68.0, -1923.0, -1780.0, -405.0, 134.0, -53.0, 145.0, -1208.0, 2.0, -405.0, -42.0, 200.0, -317.0, -394.0, -1098.0, -1505.0, -834.0, 200.0, -141.0, -933.0, -801.0, 101.0, 200.0, -75.0, 2.0, 200.0, 68.0, 200.0, -427.0, -1252.0, -1197.0, -691.0, 200.0, -1318.0, -427.0, 90.0, -460.0, -1439.0, 156.0, 189.0, -1043.0, -1054.0, 112.0, -1021.0, -350.0, -218.0, -295.0, -86.0, 35.0, -482.0, -1065.0, -1450.0, 167.0, 200.0, 200.0, -1659.0, -1021.0, 156.0, -691.0, 200.0, -1109.0, -548.0, -361.0, -801.0, -592.0, 79.0, -295.0, 200.0, -1604.0, 200.0, -152.0, -53.0, 68.0, 145.0, 200.0, 57.0, -592.0, -42.0, 123.0, -427.0, 46.0, -42.0, 46.0, -1912.0, -284.0, 200.0, -1857.0, -240.0, -317.0, 200.0, 200.0, 200.0, -317.0, -20.0, -1197.0, 200.0, 200.0, -856.0, -1175.0, -1472.0, 200.0, 90.0, 200.0, 167.0, 156.0, 178.0, -405.0, -31.0, -1527.0, 123.0, 13.0, -141.0, 145.0, -42.0, -779.0, -746.0, 46.0, 145.0, 200.0, -273.0, 200.0, -823.0, -97.0, -1054.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 55.0, 915.0, 30.0, 120.0, 100.0, 200.0, 165.0, 5.0, 155.0, 955.0, 250.0, 735.0, 675.0, 890.0, 750.0, 135.0, 1000.0, 1000.0, 770.0, 280.0, 320.0, 0.0, 950.0, 1000.0, 5.0, 5.0, 330.0, 950.0, 780.0, 170.0, 435.0, 355.0, 540.0, 545.0, 430.0, 475.0, 925.0, 160.0, 220.0, 60.0, 10.0, 920.0, 0.0, 0.0, 0.0, 610.0, 15.0, 0.0, 255.0, 805.0, 835.0, 90.0, 995.0, 190.0, 770.0, 140.0, 105.0, 0.0, 50.0, 925.0, 1000.0, 75.0, 20.0, 125.0, 400.0, 140.0, 95.0, 135.0, 0.0, 15.0, 975.0, 15.0, 35.0, 55.0, 920.0, 175.0, 100.0, 865.0, 50.0, 0.0, 5.0, 0.0, 985.0, 10.0, 875.0, 115.0, 0.0, 905.0, 0.0, 5.0, 930.0, 300.0, 410.0, 285.0, 325.0, 320.0, 920.0, 935.0, 235.0, 0.0, 0.0, 0.0, 180.0, 975.0, 120.0, 285.0, 325.0, 895.0, 905.0, 220.0, 175.0, 580.0, 20.0, 370.0, 645.0, 475.0, 395.0, 60.0, 0.0, 80.0, 630.0, 720.0, 105.0, 710.0, 360.0, 5.0, 115.0, 95.0, 65.0, 630.0, 570.0, 530.0, 220.0, 490.0, 0.0, 30.0, 280.0, 1000.0, 645.0, 460.0, 145.0, 0.0, 10.0, 885.0, 160.0, 60.0, 460.0, 430.0, 875.0, 585.0, 905.0, 55.0, 90.0, 825.0, 0.0, 270.0, 95.0, 660.0, 140.0, 600.0, 460.0, 825.0, 510.0, 435.0, 875.0, 0.0, 915.0, 445.0, 555.0, 590.0, 260.0, 365.0, 295.0, 330.0, 580.0, 550.0, 900.0, 140.0, 0.0, 25.0, 530.0, 80.0, 440.0, 240.0, 0.0, 335.0, 145.0, 845.0, 670.0, 100.0, 405.0, 205.0, 415.0, 420.0, 475.0, 90.0, 115.0, 80.0, 60.0, 0.0, 0.0, 730.0, 210.0, 375.0, 605.0, 330.0, 510.0, 350.0, 0.0, 440.0, 400.0, 460.0, 175.0, 410.0, 630.0, 360.0, 245.0, 350.0, 380.0, 65.0, 200.0, 225.0, 775.0, 205.0, 345.0, 0.0, 0.0, 15.0, 600.0, 690.0, 525.0, 560.0, 520.0, 235.0, 465.0, 390.0, 190.0, 485.0, 210.0, 320.0, 395.0, 285.0, 740.0, 165.0, 45.0, 115.0, 45.0, 55.0, 25.0, 285.0, 170.0, 185.0, 245.0, 45.0, 145.0, 385.0, 485.0, 855.0, 840.0, 330.0, 865.0, 140.0, 185.0, 0.0, 200.0, 195.0, 200.0, 340.0, 445.0, 500.0, 405.0, 540.0, 620.0, 50.0, 0.0, 0.0, 0.0, 20.0, 30.0, 745.0, 495.0, 570.0, 60.0, 130.0, 50.0, 215.0, 390.0, 240.0, 90.0, 170.0, 425.0, 105.0, 215.0, 15.0, 620.0, 165.0, 85.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0070689859416715, "mean_inference_ms": 1.7190338689869609, "mean_action_processing_ms": 0.37553530385019557, "mean_env_wait_ms": 0.2632032381526255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006674528121948242, "StateBufferConnector_ms": 0.004738807678222656, "ViewRequirementAgentConnector_ms": 0.18531572818756104}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -4360.0, "episode_return_mean": -938.03, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.35634978597405, "num_env_steps_trained_throughput_per_sec": 53.35634978597405, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 75021.971, "restore_workers_time_ms": 0.015, "training_step_time_ms": 75021.912, "sample_time_ms": 1749.095, "learn_time_ms": 73248.375, "learn_throughput": 54.609, "synch_weights_time_ms": 19.792}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 38, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-05-28", "timestamp": 1723489528, "time_this_iter_s": 75.00807595252991, "time_total_s": 2933.07550239563, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2310310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2933.07550239563, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 35.37830188679245, "ram_util_percent": 82.62924528301888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4194965085662004, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1105133543623253, "policy_loss": -0.01027955471398474, "vf_loss": 2.11977759861777, "vf_explained_var": 0.0001610566538276402, "kl": 0.006768772522874297, "entropy": 0.779824390880605, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 108570.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.142794183023432, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2980361921144716, "policy_loss": -0.016457091366825955, "vf_loss": 1.3131011642462818, "vf_explained_var": 0.024860511329157134, "kl": 0.0069605809173142194, "entropy": 1.351279363945021, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 108570.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -4360.0, "episode_reward_mean": -635.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -506.60333333333335, "predator_policy": 294.6333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4219.0, -948.0, -1758.0, -3827.0, 110.0, 379.0, -2366.0, -2647.0, -724.0, 534.0, -2167.0, -3173.0, -1218.0, -3260.0, -274.0, -1248.0, 600.0, -3691.0, -1954.0, -1466.0, 8.0, -2318.0, 465.0, -1058.0, -822.0, 402.0, -1487.0, -538.0, -4360.0, 46.0, -452.0, -7.0, -2339.0, -3575.0, -2540.0, -2663.0, -1222.0, -3806.0, -1263.0, -877.0, -137.0, -2078.0, 391.0, -561.0, 416.0, -1337.0, -65.0, -323.0, 412.0, 528.0, -1561.0, -364.0, -7.0, -59.0, -585.0, -614.0, 144.0, -1672.0, 582.0, -709.0, -285.0, -665.0, 207.0, 216.0, 188.0, 527.0, 129.0, 12.0, -425.0, 138.0, 408.0, 458.0, 488.0, -1938.0, 540.0, 551.0, -153.0, 235.0, 169.0, 130.0, 462.0, -1104.0, 600.0, 444.0, 171.0, 406.0, 570.0, -238.0, 556.0, -295.0, 366.0, 447.0, 463.0, 474.0, 588.0, 462.0, 349.0, 355.0, 392.0, -667.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1747.0, -1989.0, -1758.0, -625.0, 156.0, -1494.0, -1648.0, 200.0, -1285.0, -1692.0, -1802.0, -1428.0, -185.0, -515.0, 145.0, 79.0, 200.0, -130.0, -1791.0, 167.0, -1747.0, -526.0, -1406.0, -1725.0, -152.0, 200.0, -1912.0, 90.0, 189.0, 200.0, -1791.0, 200.0, -1571.0, -955.0, -1670.0, -1538.0, 200.0, -1109.0, -1219.0, -1362.0, -1912.0, -1626.0, -383.0, 35.0, -856.0, -1846.0, -1538.0, 46.0, 200.0, 200.0, 200.0, -1527.0, -1659.0, -1780.0, -1769.0, -262.0, -1428.0, 200.0, -1802.0, -1164.0, -405.0, -669.0, 112.0, -1351.0, -1505.0, -977.0, 200.0, -20.0, 145.0, -9.0, -1285.0, -1219.0, -1670.0, -218.0, -9.0, -251.0, 189.0, 189.0, -1120.0, -1428.0, -669.0, -768.0, -658.0, 178.0, -2000.0, -1890.0, -1780.0, 200.0, -119.0, -1285.0, 200.0, 200.0, -1747.0, 200.0, 2.0, -889.0, -1670.0, -1285.0, -1274.0, -1626.0, -1450.0, -1549.0, -1065.0, -1142.0, -1428.0, -1186.0, -1351.0, -1021.0, -207.0, -1318.0, -1582.0, -1791.0, -1835.0, -2000.0, 200.0, -1802.0, -1021.0, -526.0, -1021.0, -735.0, -1153.0, -42.0, 68.0, -1923.0, -1780.0, -405.0, 134.0, -53.0, 145.0, -1208.0, 2.0, -405.0, -42.0, 200.0, -317.0, -394.0, -1098.0, -1505.0, -834.0, 200.0, -141.0, -933.0, -801.0, 101.0, 200.0, -75.0, 2.0, 200.0, 68.0, 200.0, -427.0, -1252.0, -1197.0, -691.0, 200.0, -1318.0, -427.0, 90.0, -460.0, -1439.0, 156.0, 189.0, -1043.0, -1054.0, 112.0, -1021.0, -350.0, -218.0, -295.0, -86.0, 35.0, -482.0, -1065.0, -1450.0, 167.0, 200.0, 200.0, -1659.0, -1021.0, 156.0, -691.0, 200.0, -1109.0, -548.0, -361.0, -801.0, -592.0, 79.0, -295.0, 200.0, -1604.0, 200.0, -152.0, -53.0, 68.0, 145.0, 200.0, 57.0, -592.0, -42.0, 123.0, -427.0, 46.0, -42.0, 46.0, -1912.0, -284.0, 200.0, -1857.0, -240.0, -317.0, 200.0, 200.0, 200.0, -317.0, -20.0, -1197.0, 200.0, 200.0, -856.0, -1175.0, -1472.0, 200.0, 90.0, 200.0, 167.0, 156.0, 178.0, -405.0, -31.0, -1527.0, 123.0, 13.0, -141.0, 145.0, -42.0, -779.0, -746.0, 46.0, 145.0, 200.0, -273.0, 200.0, -823.0, -97.0, -1054.0, 200.0, 200.0, 200.0, 200.0, 101.0, 13.0, -1010.0, 189.0, 167.0, -108.0, 134.0, 200.0, 200.0, 145.0, 200.0, -1582.0, 200.0, -196.0, 156.0, 200.0, 145.0, 13.0, 2.0, -1780.0, -119.0, 145.0, 35.0, 200.0, -31.0, 68.0, 35.0, 68.0, 200.0, 90.0, 79.0, 200.0, 178.0, 200.0, 200.0, 200.0, 57.0, 90.0, -273.0, 200.0, 2.0, 134.0, 13.0, 13.0, -53.0, -53.0, 178.0, -1186.0, -394.0, 68.0], "policy_predator_policy_reward": [90.0, 995.0, 190.0, 770.0, 140.0, 105.0, 0.0, 50.0, 925.0, 1000.0, 75.0, 20.0, 125.0, 400.0, 140.0, 95.0, 135.0, 0.0, 15.0, 975.0, 15.0, 35.0, 55.0, 920.0, 175.0, 100.0, 865.0, 50.0, 0.0, 5.0, 0.0, 985.0, 10.0, 875.0, 115.0, 0.0, 905.0, 0.0, 5.0, 930.0, 300.0, 410.0, 285.0, 325.0, 320.0, 920.0, 935.0, 235.0, 0.0, 0.0, 0.0, 180.0, 975.0, 120.0, 285.0, 325.0, 895.0, 905.0, 220.0, 175.0, 580.0, 20.0, 370.0, 645.0, 475.0, 395.0, 60.0, 0.0, 80.0, 630.0, 720.0, 105.0, 710.0, 360.0, 5.0, 115.0, 95.0, 65.0, 630.0, 570.0, 530.0, 220.0, 490.0, 0.0, 30.0, 280.0, 1000.0, 645.0, 460.0, 145.0, 0.0, 10.0, 885.0, 160.0, 60.0, 460.0, 430.0, 875.0, 585.0, 905.0, 55.0, 90.0, 825.0, 0.0, 270.0, 95.0, 660.0, 140.0, 600.0, 460.0, 825.0, 510.0, 435.0, 875.0, 0.0, 915.0, 445.0, 555.0, 590.0, 260.0, 365.0, 295.0, 330.0, 580.0, 550.0, 900.0, 140.0, 0.0, 25.0, 530.0, 80.0, 440.0, 240.0, 0.0, 335.0, 145.0, 845.0, 670.0, 100.0, 405.0, 205.0, 415.0, 420.0, 475.0, 90.0, 115.0, 80.0, 60.0, 0.0, 0.0, 730.0, 210.0, 375.0, 605.0, 330.0, 510.0, 350.0, 0.0, 440.0, 400.0, 460.0, 175.0, 410.0, 630.0, 360.0, 245.0, 350.0, 380.0, 65.0, 200.0, 225.0, 775.0, 205.0, 345.0, 0.0, 0.0, 15.0, 600.0, 690.0, 525.0, 560.0, 520.0, 235.0, 465.0, 390.0, 190.0, 485.0, 210.0, 320.0, 395.0, 285.0, 740.0, 165.0, 45.0, 115.0, 45.0, 55.0, 25.0, 285.0, 170.0, 185.0, 245.0, 45.0, 145.0, 385.0, 485.0, 855.0, 840.0, 330.0, 865.0, 140.0, 185.0, 0.0, 200.0, 195.0, 200.0, 340.0, 445.0, 500.0, 405.0, 540.0, 620.0, 50.0, 0.0, 0.0, 0.0, 20.0, 30.0, 745.0, 495.0, 570.0, 60.0, 130.0, 50.0, 215.0, 390.0, 240.0, 90.0, 170.0, 425.0, 105.0, 215.0, 15.0, 620.0, 165.0, 85.0, 0.0, 0.0, 0.0, 5.0, 125.0, 0.0, 310.0, 375.0, 140.0, 140.0, 40.0, 0.0, 0.0, 25.0, 0.0, 415.0, 540.0, 385.0, 25.0, 30.0, 0.0, 835.0, 520.0, 115.0, 110.0, 95.0, 100.0, 85.0, 0.0, 125.0, 65.0, 60.0, 35.0, 50.0, 0.0, 55.0, 10.0, 0.0, 0.0, 50.0, 65.0, 0.0, 205.0, 215.0, 0.0, 80.0, 95.0, 20.0, 110.0, 95.0, 115.0, 135.0, 545.0, 165.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0079067343104815, "mean_inference_ms": 1.7220847965270087, "mean_action_processing_ms": 0.3765223805982775, "mean_env_wait_ms": 0.2639569535101917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005988001823425293, "StateBufferConnector_ms": 0.004564404487609863, "ViewRequirementAgentConnector_ms": 0.17009711265563965}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -4360.0, "episode_return_mean": -635.91, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.2173972800465, "num_env_steps_trained_throughput_per_sec": 55.2173972800465, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 74715.616, "restore_workers_time_ms": 0.015, "training_step_time_ms": 74715.55, "sample_time_ms": 1703.286, "learn_time_ms": 72987.861, "learn_throughput": 54.804, "synch_weights_time_ms": 19.983}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "training_iteration": 39, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-06-40", "timestamp": 1723489600, "time_this_iter_s": 72.51310396194458, "time_total_s": 3005.5886063575745, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b106ac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3005.5886063575745, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 31.88932038834952, "ram_util_percent": 81.93106796116508}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.257343598629566, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6647340653635931, "policy_loss": -0.008362389837535336, "vf_loss": 1.6722740388085655, "vf_explained_var": 8.315870947871648e-05, "kl": 0.005482804730800352, "entropy": 0.7030362697146463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 111390.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.157529192613372, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1288129128779925, "policy_loss": -0.021823155557871333, "vf_loss": 1.1492567614143623, "vf_explained_var": 0.040486431671372544, "kl": 0.006896545859751444, "entropy": 1.353911444058655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 111390.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 641.0, "episode_reward_min": -4360.0, "episode_reward_mean": -200.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -314.03, "predator_policy": 247.23333333333332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [465.0, -1058.0, -822.0, 402.0, -1487.0, -538.0, -4360.0, 46.0, -452.0, -7.0, -2339.0, -3575.0, -2540.0, -2663.0, -1222.0, -3806.0, -1263.0, -877.0, -137.0, -2078.0, 391.0, -561.0, 416.0, -1337.0, -65.0, -323.0, 412.0, 528.0, -1561.0, -364.0, -7.0, -59.0, -585.0, -614.0, 144.0, -1672.0, 582.0, -709.0, -285.0, -665.0, 207.0, 216.0, 188.0, 527.0, 129.0, 12.0, -425.0, 138.0, 408.0, 458.0, 488.0, -1938.0, 540.0, 551.0, -153.0, 235.0, 169.0, 130.0, 462.0, -1104.0, 600.0, 444.0, 171.0, 406.0, 570.0, -238.0, 556.0, -295.0, 366.0, 447.0, 463.0, 474.0, 588.0, 462.0, 349.0, 355.0, 392.0, -667.0, 380.0, 329.0, 187.0, 150.0, 573.0, 358.0, 126.0, 600.0, 641.0, 454.0, 196.0, 241.0, 188.0, 458.0, 477.0, 130.0, 495.0, 405.0, 454.0, 116.0, 567.0, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -20.0, 145.0, -9.0, -1285.0, -1219.0, -1670.0, -218.0, -9.0, -251.0, 189.0, 189.0, -1120.0, -1428.0, -669.0, -768.0, -658.0, 178.0, -2000.0, -1890.0, -1780.0, 200.0, -119.0, -1285.0, 200.0, 200.0, -1747.0, 200.0, 2.0, -889.0, -1670.0, -1285.0, -1274.0, -1626.0, -1450.0, -1549.0, -1065.0, -1142.0, -1428.0, -1186.0, -1351.0, -1021.0, -207.0, -1318.0, -1582.0, -1791.0, -1835.0, -2000.0, 200.0, -1802.0, -1021.0, -526.0, -1021.0, -735.0, -1153.0, -42.0, 68.0, -1923.0, -1780.0, -405.0, 134.0, -53.0, 145.0, -1208.0, 2.0, -405.0, -42.0, 200.0, -317.0, -394.0, -1098.0, -1505.0, -834.0, 200.0, -141.0, -933.0, -801.0, 101.0, 200.0, -75.0, 2.0, 200.0, 68.0, 200.0, -427.0, -1252.0, -1197.0, -691.0, 200.0, -1318.0, -427.0, 90.0, -460.0, -1439.0, 156.0, 189.0, -1043.0, -1054.0, 112.0, -1021.0, -350.0, -218.0, -295.0, -86.0, 35.0, -482.0, -1065.0, -1450.0, 167.0, 200.0, 200.0, -1659.0, -1021.0, 156.0, -691.0, 200.0, -1109.0, -548.0, -361.0, -801.0, -592.0, 79.0, -295.0, 200.0, -1604.0, 200.0, -152.0, -53.0, 68.0, 145.0, 200.0, 57.0, -592.0, -42.0, 123.0, -427.0, 46.0, -42.0, 46.0, -1912.0, -284.0, 200.0, -1857.0, -240.0, -317.0, 200.0, 200.0, 200.0, -317.0, -20.0, -1197.0, 200.0, 200.0, -856.0, -1175.0, -1472.0, 200.0, 90.0, 200.0, 167.0, 156.0, 178.0, -405.0, -31.0, -1527.0, 123.0, 13.0, -141.0, 145.0, -42.0, -779.0, -746.0, 46.0, 145.0, 200.0, -273.0, 200.0, -823.0, -97.0, -1054.0, 200.0, 200.0, 200.0, 200.0, 101.0, 13.0, -1010.0, 189.0, 167.0, -108.0, 134.0, 200.0, 200.0, 145.0, 200.0, -1582.0, 200.0, -196.0, 156.0, 200.0, 145.0, 13.0, 2.0, -1780.0, -119.0, 145.0, 35.0, 200.0, -31.0, 68.0, 35.0, 68.0, 200.0, 90.0, 79.0, 200.0, 178.0, 200.0, 200.0, 200.0, 57.0, 90.0, -273.0, 200.0, 2.0, 134.0, 13.0, 13.0, -53.0, -53.0, 178.0, -1186.0, -394.0, 68.0, 200.0, -31.0, -9.0, 200.0, -152.0, 46.0, 189.0, 79.0, -1241.0, 123.0, -31.0, -427.0, 200.0, 200.0, 68.0, 68.0, -31.0, 156.0, -163.0, 79.0, -130.0, 200.0, 200.0, 200.0, 167.0, 200.0, -581.0, 123.0, 134.0, -328.0, 79.0, 79.0, -1417.0, 200.0, 134.0, -603.0, -559.0, 200.0, 2.0, 189.0, -20.0, 134.0, -9.0, 200.0, 101.0, -185.0, 57.0, -42.0, 200.0, -20.0, 200.0, -9.0, -31.0, 200.0, 90.0, 200.0, 79.0, -262.0, 46.0, -163.0, 178.0, 134.0, 200.0, 200.0, 2.0, 68.0], "policy_predator_policy_reward": [60.0, 0.0, 80.0, 630.0, 720.0, 105.0, 710.0, 360.0, 5.0, 115.0, 95.0, 65.0, 630.0, 570.0, 530.0, 220.0, 490.0, 0.0, 30.0, 280.0, 1000.0, 645.0, 460.0, 145.0, 0.0, 10.0, 885.0, 160.0, 60.0, 460.0, 430.0, 875.0, 585.0, 905.0, 55.0, 90.0, 825.0, 0.0, 270.0, 95.0, 660.0, 140.0, 600.0, 460.0, 825.0, 510.0, 435.0, 875.0, 0.0, 915.0, 445.0, 555.0, 590.0, 260.0, 365.0, 295.0, 330.0, 580.0, 550.0, 900.0, 140.0, 0.0, 25.0, 530.0, 80.0, 440.0, 240.0, 0.0, 335.0, 145.0, 845.0, 670.0, 100.0, 405.0, 205.0, 415.0, 420.0, 475.0, 90.0, 115.0, 80.0, 60.0, 0.0, 0.0, 730.0, 210.0, 375.0, 605.0, 330.0, 510.0, 350.0, 0.0, 440.0, 400.0, 460.0, 175.0, 410.0, 630.0, 360.0, 245.0, 350.0, 380.0, 65.0, 200.0, 225.0, 775.0, 205.0, 345.0, 0.0, 0.0, 15.0, 600.0, 690.0, 525.0, 560.0, 520.0, 235.0, 465.0, 390.0, 190.0, 485.0, 210.0, 320.0, 395.0, 285.0, 740.0, 165.0, 45.0, 115.0, 45.0, 55.0, 25.0, 285.0, 170.0, 185.0, 245.0, 45.0, 145.0, 385.0, 485.0, 855.0, 840.0, 330.0, 865.0, 140.0, 185.0, 0.0, 200.0, 195.0, 200.0, 340.0, 445.0, 500.0, 405.0, 540.0, 620.0, 50.0, 0.0, 0.0, 0.0, 20.0, 30.0, 745.0, 495.0, 570.0, 60.0, 130.0, 50.0, 215.0, 390.0, 240.0, 90.0, 170.0, 425.0, 105.0, 215.0, 15.0, 620.0, 165.0, 85.0, 0.0, 0.0, 0.0, 5.0, 125.0, 0.0, 310.0, 375.0, 140.0, 140.0, 40.0, 0.0, 0.0, 25.0, 0.0, 415.0, 540.0, 385.0, 25.0, 30.0, 0.0, 835.0, 520.0, 115.0, 110.0, 95.0, 100.0, 85.0, 0.0, 125.0, 65.0, 60.0, 35.0, 50.0, 0.0, 55.0, 10.0, 0.0, 0.0, 50.0, 65.0, 0.0, 205.0, 215.0, 0.0, 80.0, 95.0, 20.0, 110.0, 95.0, 115.0, 135.0, 545.0, 165.0, 105.0, 20.0, 95.0, 155.0, 60.0, 20.0, 360.0, 460.0, 340.0, 195.0, 45.0, 245.0, 60.0, 45.0, 0.0, 0.0, 60.0, 105.0, 35.0, 135.0, 170.0, 0.0, 0.0, 0.0, 340.0, 220.0, 295.0, 65.0, 205.0, 255.0, 540.0, 665.0, 250.0, 265.0, 140.0, 105.0, 295.0, 125.0, 125.0, 50.0, 105.0, 0.0, 70.0, 30.0, 85.0, 185.0, 60.0, 55.0, 50.0, 0.0, 65.0, 105.0, 105.0, 35.0, 0.0, 30.0, 55.0, 215.0, 90.0, 190.0, 10.0, 15.0, 30.0, 0.0, 90.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.00964003785842, "mean_inference_ms": 1.7265299283904372, "mean_action_processing_ms": 0.3779232310404143, "mean_env_wait_ms": 0.26461562637593233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058901309967041016, "StateBufferConnector_ms": 0.004709720611572266, "ViewRequirementAgentConnector_ms": 0.16958928108215332}, "num_episodes": 22, "episode_return_max": 641.0, "episode_return_min": -4360.0, "episode_return_mean": -200.39, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.72950191609164, "num_env_steps_trained_throughput_per_sec": 53.72950191609164, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 74669.429, "restore_workers_time_ms": 0.015, "training_step_time_ms": 74669.363, "sample_time_ms": 1696.301, "learn_time_ms": 72948.421, "learn_throughput": 54.833, "synch_weights_time_ms": 20.417}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 40, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-07-55", "timestamp": 1723489675, "time_this_iter_s": 74.52494883537292, "time_total_s": 3080.1135551929474, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2324940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3080.1135551929474, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 33.2, "ram_util_percent": 82.32857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.54195063535309, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7272917621207575, "policy_loss": -0.009668223879657973, "vf_loss": 0.7361421696313307, "vf_explained_var": -0.00026288935055969454, "kl": 0.005452098997298287, "entropy": 0.7001891768993216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 114210.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.793446411657418, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8242112776107676, "policy_loss": -0.01564356190803071, "vf_loss": 0.8385796956612286, "vf_explained_var": 0.04411120245642696, "kl": 0.006375726064675553, "entropy": 1.3522842565749553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 114210.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "env_runners": {"episode_reward_max": 641.0, "episode_reward_min": -1938.0, "episode_reward_mean": 167.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1912.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 865.0}, "policy_reward_mean": {"prey_policy": -118.52333333333333, "predator_policy": 174.23333333333332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1337.0, -65.0, -323.0, 412.0, 528.0, -1561.0, -364.0, -7.0, -59.0, -585.0, -614.0, 144.0, -1672.0, 582.0, -709.0, -285.0, -665.0, 207.0, 216.0, 188.0, 527.0, 129.0, 12.0, -425.0, 138.0, 408.0, 458.0, 488.0, -1938.0, 540.0, 551.0, -153.0, 235.0, 169.0, 130.0, 462.0, -1104.0, 600.0, 444.0, 171.0, 406.0, 570.0, -238.0, 556.0, -295.0, 366.0, 447.0, 463.0, 474.0, 588.0, 462.0, 349.0, 355.0, 392.0, -667.0, 380.0, 329.0, 187.0, 150.0, 573.0, 358.0, 126.0, 600.0, 641.0, 454.0, 196.0, 241.0, 188.0, 458.0, 477.0, 130.0, 495.0, 405.0, 454.0, 116.0, 567.0, 400.0, 474.0, 402.0, 530.0, 540.0, 146.0, 454.0, 528.0, 571.0, -208.0, 340.0, 546.0, 87.0, 291.0, 600.0, 433.0, -75.0, 571.0, 516.0, 306.0, 425.0, 546.0, 261.0, 403.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-394.0, -1098.0, -1505.0, -834.0, 200.0, -141.0, -933.0, -801.0, 101.0, 200.0, -75.0, 2.0, 200.0, 68.0, 200.0, -427.0, -1252.0, -1197.0, -691.0, 200.0, -1318.0, -427.0, 90.0, -460.0, -1439.0, 156.0, 189.0, -1043.0, -1054.0, 112.0, -1021.0, -350.0, -218.0, -295.0, -86.0, 35.0, -482.0, -1065.0, -1450.0, 167.0, 200.0, 200.0, -1659.0, -1021.0, 156.0, -691.0, 200.0, -1109.0, -548.0, -361.0, -801.0, -592.0, 79.0, -295.0, 200.0, -1604.0, 200.0, -152.0, -53.0, 68.0, 145.0, 200.0, 57.0, -592.0, -42.0, 123.0, -427.0, 46.0, -42.0, 46.0, -1912.0, -284.0, 200.0, -1857.0, -240.0, -317.0, 200.0, 200.0, 200.0, -317.0, -20.0, -1197.0, 200.0, 200.0, -856.0, -1175.0, -1472.0, 200.0, 90.0, 200.0, 167.0, 156.0, 178.0, -405.0, -31.0, -1527.0, 123.0, 13.0, -141.0, 145.0, -42.0, -779.0, -746.0, 46.0, 145.0, 200.0, -273.0, 200.0, -823.0, -97.0, -1054.0, 200.0, 200.0, 200.0, 200.0, 101.0, 13.0, -1010.0, 189.0, 167.0, -108.0, 134.0, 200.0, 200.0, 145.0, 200.0, -1582.0, 200.0, -196.0, 156.0, 200.0, 145.0, 13.0, 2.0, -1780.0, -119.0, 145.0, 35.0, 200.0, -31.0, 68.0, 35.0, 68.0, 200.0, 90.0, 79.0, 200.0, 178.0, 200.0, 200.0, 200.0, 57.0, 90.0, -273.0, 200.0, 2.0, 134.0, 13.0, 13.0, -53.0, -53.0, 178.0, -1186.0, -394.0, 68.0, 200.0, -31.0, -9.0, 200.0, -152.0, 46.0, 189.0, 79.0, -1241.0, 123.0, -31.0, -427.0, 200.0, 200.0, 68.0, 68.0, -31.0, 156.0, -163.0, 79.0, -130.0, 200.0, 200.0, 200.0, 167.0, 200.0, -581.0, 123.0, 134.0, -328.0, 79.0, 79.0, -1417.0, 200.0, 134.0, -603.0, -559.0, 200.0, 2.0, 189.0, -20.0, 134.0, -9.0, 200.0, 101.0, -185.0, 57.0, -42.0, 200.0, -20.0, 200.0, -9.0, -31.0, 200.0, 90.0, 200.0, 79.0, -262.0, 46.0, -163.0, 178.0, 134.0, 200.0, 200.0, 2.0, 68.0, 57.0, 178.0, 134.0, 57.0, -20.0, 200.0, 189.0, -9.0, 145.0, 189.0, 200.0, 101.0, 68.0, -152.0, -75.0, 134.0, 200.0, -20.0, 200.0, 79.0, 189.0, 200.0, 178.0, 178.0, 145.0, -240.0, -878.0, 145.0, -141.0, 101.0, 101.0, 200.0, 200.0, 189.0, -152.0, -130.0, 79.0, 35.0, 57.0, 200.0, 200.0, 200.0, 101.0, -108.0, 200.0, -75.0, -31.0, -119.0, -130.0, 156.0, 200.0, 123.0, 123.0, 200.0, -86.0, 178.0, 24.0, 90.0, 35.0, 200.0, 101.0, 200.0, 200.0, 68.0, -20.0, 68.0, 68.0, 24.0, 156.0], "policy_predator_policy_reward": [145.0, 845.0, 670.0, 100.0, 405.0, 205.0, 415.0, 420.0, 475.0, 90.0, 115.0, 80.0, 60.0, 0.0, 0.0, 730.0, 210.0, 375.0, 605.0, 330.0, 510.0, 350.0, 0.0, 440.0, 400.0, 460.0, 175.0, 410.0, 630.0, 360.0, 245.0, 350.0, 380.0, 65.0, 200.0, 225.0, 775.0, 205.0, 345.0, 0.0, 0.0, 15.0, 600.0, 690.0, 525.0, 560.0, 520.0, 235.0, 465.0, 390.0, 190.0, 485.0, 210.0, 320.0, 395.0, 285.0, 740.0, 165.0, 45.0, 115.0, 45.0, 55.0, 25.0, 285.0, 170.0, 185.0, 245.0, 45.0, 145.0, 385.0, 485.0, 855.0, 840.0, 330.0, 865.0, 140.0, 185.0, 0.0, 200.0, 195.0, 200.0, 340.0, 445.0, 500.0, 405.0, 540.0, 620.0, 50.0, 0.0, 0.0, 0.0, 20.0, 30.0, 745.0, 495.0, 570.0, 60.0, 130.0, 50.0, 215.0, 390.0, 240.0, 90.0, 170.0, 425.0, 105.0, 215.0, 15.0, 620.0, 165.0, 85.0, 0.0, 0.0, 0.0, 5.0, 125.0, 0.0, 310.0, 375.0, 140.0, 140.0, 40.0, 0.0, 0.0, 25.0, 0.0, 415.0, 540.0, 385.0, 25.0, 30.0, 0.0, 835.0, 520.0, 115.0, 110.0, 95.0, 100.0, 85.0, 0.0, 125.0, 65.0, 60.0, 35.0, 50.0, 0.0, 55.0, 10.0, 0.0, 0.0, 50.0, 65.0, 0.0, 205.0, 215.0, 0.0, 80.0, 95.0, 20.0, 110.0, 95.0, 115.0, 135.0, 545.0, 165.0, 105.0, 20.0, 95.0, 155.0, 60.0, 20.0, 360.0, 460.0, 340.0, 195.0, 45.0, 245.0, 60.0, 45.0, 0.0, 0.0, 60.0, 105.0, 35.0, 135.0, 170.0, 0.0, 0.0, 0.0, 340.0, 220.0, 295.0, 65.0, 205.0, 255.0, 540.0, 665.0, 250.0, 265.0, 140.0, 105.0, 295.0, 125.0, 125.0, 50.0, 105.0, 0.0, 70.0, 30.0, 85.0, 185.0, 60.0, 55.0, 50.0, 0.0, 65.0, 105.0, 105.0, 35.0, 0.0, 30.0, 55.0, 215.0, 90.0, 190.0, 10.0, 15.0, 30.0, 0.0, 90.0, 40.0, 75.0, 0.0, 30.0, 100.0, 25.0, 40.0, 55.0, 60.0, 90.0, 5.0, 0.0, 45.0, 75.0, 95.0, 135.0, 100.0, 40.0, 0.0, 5.0, 0.0, 55.0, 0.0, 15.0, 0.0, 195.0, 500.0, 70.0, 45.0, 180.0, 10.0, 0.0, 0.0, 45.0, 180.0, 0.0, 0.0, 120.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 140.0, 100.0, 5.0, 0.0, 145.0, 120.0, 110.0, 115.0, 0.0, 35.0, 35.0, 15.0, 45.0, 130.0, 5.0, 95.0, 0.0, 0.0, 0.0, 45.0, 0.0, 145.0, 0.0, 60.0, 40.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0108189927070255, "mean_inference_ms": 1.7283856721313453, "mean_action_processing_ms": 0.3788307805372731, "mean_env_wait_ms": 0.2654154964974595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059239864349365234, "StateBufferConnector_ms": 0.004750847816467285, "ViewRequirementAgentConnector_ms": 0.16422975063323975}, "num_episodes": 23, "episode_return_max": 641.0, "episode_return_min": -1938.0, "episode_return_mean": 167.13, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 52.38066871303631, "num_env_steps_trained_throughput_per_sec": 52.38066871303631, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 74909.309, "restore_workers_time_ms": 0.015, "training_step_time_ms": 74909.249, "sample_time_ms": 1703.314, "learn_time_ms": 73181.367, "learn_throughput": 54.659, "synch_weights_time_ms": 20.56}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "training_iteration": 41, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-09-11", "timestamp": 1723489751, "time_this_iter_s": 76.42077732086182, "time_total_s": 3156.534332513809, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b104ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3156.534332513809, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 39.69541284403671, "ram_util_percent": 80.55963302752295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4010411064041421, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3632739531867049, "policy_loss": -0.00756922957573271, "vf_loss": 1.3700711344467833, "vf_explained_var": -5.279301751589945e-06, "kl": 0.005146993914695693, "entropy": 0.6749787390020722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 117030.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.776971541947507, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.104787045920347, "policy_loss": -0.01673176391058476, "vf_loss": 1.1204529734685067, "vf_explained_var": 0.059508098651331366, "kl": 0.005329188527878749, "entropy": 1.3323317015847416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 117030.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 641.0, "episode_reward_min": -1938.0, "episode_reward_mean": 297.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1912.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 865.0}, "policy_reward_mean": {"prey_policy": -29.386666666666667, "predator_policy": 128.68333333333334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [216.0, 188.0, 527.0, 129.0, 12.0, -425.0, 138.0, 408.0, 458.0, 488.0, -1938.0, 540.0, 551.0, -153.0, 235.0, 169.0, 130.0, 462.0, -1104.0, 600.0, 444.0, 171.0, 406.0, 570.0, -238.0, 556.0, -295.0, 366.0, 447.0, 463.0, 474.0, 588.0, 462.0, 349.0, 355.0, 392.0, -667.0, 380.0, 329.0, 187.0, 150.0, 573.0, 358.0, 126.0, 600.0, 641.0, 454.0, 196.0, 241.0, 188.0, 458.0, 477.0, 130.0, 495.0, 405.0, 454.0, 116.0, 567.0, 400.0, 474.0, 402.0, 530.0, 540.0, 146.0, 454.0, 528.0, 571.0, -208.0, 340.0, 546.0, 87.0, 291.0, 600.0, 433.0, -75.0, 571.0, 516.0, 306.0, 425.0, 546.0, 261.0, 403.0, 442.0, 435.0, 301.0, 204.0, 539.0, 319.0, 502.0, 600.0, 159.0, 516.0, 60.0, 258.0, 471.0, 215.0, 400.0, 360.0, 575.0, 347.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -1604.0, 200.0, -152.0, -53.0, 68.0, 145.0, 200.0, 57.0, -592.0, -42.0, 123.0, -427.0, 46.0, -42.0, 46.0, -1912.0, -284.0, 200.0, -1857.0, -240.0, -317.0, 200.0, 200.0, 200.0, -317.0, -20.0, -1197.0, 200.0, 200.0, -856.0, -1175.0, -1472.0, 200.0, 90.0, 200.0, 167.0, 156.0, 178.0, -405.0, -31.0, -1527.0, 123.0, 13.0, -141.0, 145.0, -42.0, -779.0, -746.0, 46.0, 145.0, 200.0, -273.0, 200.0, -823.0, -97.0, -1054.0, 200.0, 200.0, 200.0, 200.0, 101.0, 13.0, -1010.0, 189.0, 167.0, -108.0, 134.0, 200.0, 200.0, 145.0, 200.0, -1582.0, 200.0, -196.0, 156.0, 200.0, 145.0, 13.0, 2.0, -1780.0, -119.0, 145.0, 35.0, 200.0, -31.0, 68.0, 35.0, 68.0, 200.0, 90.0, 79.0, 200.0, 178.0, 200.0, 200.0, 200.0, 57.0, 90.0, -273.0, 200.0, 2.0, 134.0, 13.0, 13.0, -53.0, -53.0, 178.0, -1186.0, -394.0, 68.0, 200.0, -31.0, -9.0, 200.0, -152.0, 46.0, 189.0, 79.0, -1241.0, 123.0, -31.0, -427.0, 200.0, 200.0, 68.0, 68.0, -31.0, 156.0, -163.0, 79.0, -130.0, 200.0, 200.0, 200.0, 167.0, 200.0, -581.0, 123.0, 134.0, -328.0, 79.0, 79.0, -1417.0, 200.0, 134.0, -603.0, -559.0, 200.0, 2.0, 189.0, -20.0, 134.0, -9.0, 200.0, 101.0, -185.0, 57.0, -42.0, 200.0, -20.0, 200.0, -9.0, -31.0, 200.0, 90.0, 200.0, 79.0, -262.0, 46.0, -163.0, 178.0, 134.0, 200.0, 200.0, 2.0, 68.0, 57.0, 178.0, 134.0, 57.0, -20.0, 200.0, 189.0, -9.0, 145.0, 189.0, 200.0, 101.0, 68.0, -152.0, -75.0, 134.0, 200.0, -20.0, 200.0, 79.0, 189.0, 200.0, 178.0, 178.0, 145.0, -240.0, -878.0, 145.0, -141.0, 101.0, 101.0, 200.0, 200.0, 189.0, -152.0, -130.0, 79.0, 35.0, 57.0, 200.0, 200.0, 200.0, 101.0, -108.0, 200.0, -75.0, -31.0, -119.0, -130.0, 156.0, 200.0, 123.0, 123.0, 200.0, -86.0, 178.0, 24.0, 90.0, 35.0, 200.0, 101.0, 200.0, 200.0, 68.0, -20.0, 68.0, 68.0, 24.0, 156.0, 167.0, 112.0, 68.0, 57.0, 24.0, 189.0, 101.0, -108.0, 123.0, -548.0, 167.0, 145.0, 178.0, 200.0, 101.0, -240.0, 79.0, 200.0, 134.0, 178.0, 90.0, 200.0, 200.0, 200.0, -20.0, -592.0, 101.0, 46.0, 200.0, 200.0, -141.0, 35.0, -119.0, 2.0, 2.0, 134.0, -306.0, 189.0, 123.0, -9.0, 134.0, -515.0, 134.0, 112.0, 24.0, 178.0, -20.0, 2.0, 35.0, 200.0, 200.0, 24.0, -97.0, 90.0], "policy_predator_policy_reward": [395.0, 285.0, 740.0, 165.0, 45.0, 115.0, 45.0, 55.0, 25.0, 285.0, 170.0, 185.0, 245.0, 45.0, 145.0, 385.0, 485.0, 855.0, 840.0, 330.0, 865.0, 140.0, 185.0, 0.0, 200.0, 195.0, 200.0, 340.0, 445.0, 500.0, 405.0, 540.0, 620.0, 50.0, 0.0, 0.0, 0.0, 20.0, 30.0, 745.0, 495.0, 570.0, 60.0, 130.0, 50.0, 215.0, 390.0, 240.0, 90.0, 170.0, 425.0, 105.0, 215.0, 15.0, 620.0, 165.0, 85.0, 0.0, 0.0, 0.0, 5.0, 125.0, 0.0, 310.0, 375.0, 140.0, 140.0, 40.0, 0.0, 0.0, 25.0, 0.0, 415.0, 540.0, 385.0, 25.0, 30.0, 0.0, 835.0, 520.0, 115.0, 110.0, 95.0, 100.0, 85.0, 0.0, 125.0, 65.0, 60.0, 35.0, 50.0, 0.0, 55.0, 10.0, 0.0, 0.0, 50.0, 65.0, 0.0, 205.0, 215.0, 0.0, 80.0, 95.0, 20.0, 110.0, 95.0, 115.0, 135.0, 545.0, 165.0, 105.0, 20.0, 95.0, 155.0, 60.0, 20.0, 360.0, 460.0, 340.0, 195.0, 45.0, 245.0, 60.0, 45.0, 0.0, 0.0, 60.0, 105.0, 35.0, 135.0, 170.0, 0.0, 0.0, 0.0, 340.0, 220.0, 295.0, 65.0, 205.0, 255.0, 540.0, 665.0, 250.0, 265.0, 140.0, 105.0, 295.0, 125.0, 125.0, 50.0, 105.0, 0.0, 70.0, 30.0, 85.0, 185.0, 60.0, 55.0, 50.0, 0.0, 65.0, 105.0, 105.0, 35.0, 0.0, 30.0, 55.0, 215.0, 90.0, 190.0, 10.0, 15.0, 30.0, 0.0, 90.0, 40.0, 75.0, 0.0, 30.0, 100.0, 25.0, 40.0, 55.0, 60.0, 90.0, 5.0, 0.0, 45.0, 75.0, 95.0, 135.0, 100.0, 40.0, 0.0, 5.0, 0.0, 55.0, 0.0, 15.0, 0.0, 195.0, 500.0, 70.0, 45.0, 180.0, 10.0, 0.0, 0.0, 45.0, 180.0, 0.0, 0.0, 120.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 140.0, 100.0, 5.0, 0.0, 145.0, 120.0, 110.0, 115.0, 0.0, 35.0, 35.0, 15.0, 45.0, 130.0, 5.0, 95.0, 0.0, 0.0, 0.0, 45.0, 0.0, 145.0, 0.0, 60.0, 40.0, 55.0, 0.0, 50.0, 45.0, 25.0, 60.0, 80.0, 0.0, 45.0, 140.0, 100.0, 135.0, 205.0, 15.0, 45.0, 0.0, 10.0, 100.0, 170.0, 50.0, 25.0, 25.0, 0.0, 0.0, 0.0, 360.0, 0.0, 310.0, 0.0, 70.0, 0.0, 135.0, 70.0, 80.0, 90.0, 0.0, 30.0, 140.0, 135.0, 190.0, 175.0, 255.0, 175.0, 40.0, 70.0, 20.0, 30.0, 105.0, 65.0, 0.0, 75.0, 65.0, 115.0, 115.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0070934431078729, "mean_inference_ms": 1.7226357109721784, "mean_action_processing_ms": 0.3780546739852022, "mean_env_wait_ms": 0.2648416208461165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050203800201416016, "StateBufferConnector_ms": 0.004202365875244141, "ViewRequirementAgentConnector_ms": 0.1418675184249878}, "num_episodes": 18, "episode_return_max": 641.0, "episode_return_min": -1938.0, "episode_return_mean": 297.89, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.23650123008624, "num_env_steps_trained_throughput_per_sec": 54.23650123008624, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 74887.224, "restore_workers_time_ms": 0.015, "training_step_time_ms": 74887.164, "sample_time_ms": 1688.191, "learn_time_ms": 73177.194, "learn_throughput": 54.662, "synch_weights_time_ms": 18.228}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 42, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-10-25", "timestamp": 1723489825, "time_this_iter_s": 73.83555197715759, "time_total_s": 3230.369884490967, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b23361f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3230.369884490967, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 33.6647619047619, "ram_util_percent": 78.45714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4641672173607434, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8483601959144815, "policy_loss": -0.007461950138330143, "vf_loss": 0.8549797833652784, "vf_explained_var": -4.6741328340895636e-05, "kl": 0.005615717994860074, "entropy": 0.6464938848048237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 119850.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.916334962348143, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7814353602777767, "policy_loss": -0.013443310421533183, "vf_loss": 0.7935609756262167, "vf_explained_var": 0.03653617795054794, "kl": 0.006588485729077033, "entropy": 1.3368790494212022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 119850.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "env_runners": {"episode_reward_max": 641.0, "episode_reward_min": -1104.0, "episode_reward_mean": 343.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1780.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 835.0}, "policy_reward_mean": {"prey_policy": 22.423333333333332, "predator_policy": 92.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1104.0, 600.0, 444.0, 171.0, 406.0, 570.0, -238.0, 556.0, -295.0, 366.0, 447.0, 463.0, 474.0, 588.0, 462.0, 349.0, 355.0, 392.0, -667.0, 380.0, 329.0, 187.0, 150.0, 573.0, 358.0, 126.0, 600.0, 641.0, 454.0, 196.0, 241.0, 188.0, 458.0, 477.0, 130.0, 495.0, 405.0, 454.0, 116.0, 567.0, 400.0, 474.0, 402.0, 530.0, 540.0, 146.0, 454.0, 528.0, 571.0, -208.0, 340.0, 546.0, 87.0, 291.0, 600.0, 433.0, -75.0, 571.0, 516.0, 306.0, 425.0, 546.0, 261.0, 403.0, 442.0, 435.0, 301.0, 204.0, 539.0, 319.0, 502.0, 600.0, 159.0, 516.0, 60.0, 258.0, 471.0, 215.0, 400.0, 360.0, 575.0, 347.0, 470.0, 461.0, 406.0, 459.0, 410.0, 474.0, 186.0, 233.0, 457.0, 111.0, 434.0, 588.0, 376.0, 371.0, 420.0, 144.0, 175.0, 558.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-823.0, -97.0, -1054.0, 200.0, 200.0, 200.0, 200.0, 101.0, 13.0, -1010.0, 189.0, 167.0, -108.0, 134.0, 200.0, 200.0, 145.0, 200.0, -1582.0, 200.0, -196.0, 156.0, 200.0, 145.0, 13.0, 2.0, -1780.0, -119.0, 145.0, 35.0, 200.0, -31.0, 68.0, 35.0, 68.0, 200.0, 90.0, 79.0, 200.0, 178.0, 200.0, 200.0, 200.0, 57.0, 90.0, -273.0, 200.0, 2.0, 134.0, 13.0, 13.0, -53.0, -53.0, 178.0, -1186.0, -394.0, 68.0, 200.0, -31.0, -9.0, 200.0, -152.0, 46.0, 189.0, 79.0, -1241.0, 123.0, -31.0, -427.0, 200.0, 200.0, 68.0, 68.0, -31.0, 156.0, -163.0, 79.0, -130.0, 200.0, 200.0, 200.0, 167.0, 200.0, -581.0, 123.0, 134.0, -328.0, 79.0, 79.0, -1417.0, 200.0, 134.0, -603.0, -559.0, 200.0, 2.0, 189.0, -20.0, 134.0, -9.0, 200.0, 101.0, -185.0, 57.0, -42.0, 200.0, -20.0, 200.0, -9.0, -31.0, 200.0, 90.0, 200.0, 79.0, -262.0, 46.0, -163.0, 178.0, 134.0, 200.0, 200.0, 2.0, 68.0, 57.0, 178.0, 134.0, 57.0, -20.0, 200.0, 189.0, -9.0, 145.0, 189.0, 200.0, 101.0, 68.0, -152.0, -75.0, 134.0, 200.0, -20.0, 200.0, 79.0, 189.0, 200.0, 178.0, 178.0, 145.0, -240.0, -878.0, 145.0, -141.0, 101.0, 101.0, 200.0, 200.0, 189.0, -152.0, -130.0, 79.0, 35.0, 57.0, 200.0, 200.0, 200.0, 101.0, -108.0, 200.0, -75.0, -31.0, -119.0, -130.0, 156.0, 200.0, 123.0, 123.0, 200.0, -86.0, 178.0, 24.0, 90.0, 35.0, 200.0, 101.0, 200.0, 200.0, 68.0, -20.0, 68.0, 68.0, 24.0, 156.0, 167.0, 112.0, 68.0, 57.0, 24.0, 189.0, 101.0, -108.0, 123.0, -548.0, 167.0, 145.0, 178.0, 200.0, 101.0, -240.0, 79.0, 200.0, 134.0, 178.0, 90.0, 200.0, 200.0, 200.0, -20.0, -592.0, 101.0, 46.0, 200.0, 200.0, -141.0, 35.0, -119.0, 2.0, 2.0, 134.0, -306.0, 189.0, 123.0, -9.0, 134.0, -515.0, 134.0, 112.0, 24.0, 178.0, -20.0, 2.0, 35.0, 200.0, 200.0, 24.0, -97.0, 90.0, 134.0, 112.0, 134.0, 13.0, 68.0, 200.0, 200.0, 46.0, 90.0, 167.0, 2.0, 200.0, 79.0, 90.0, 156.0, 167.0, 200.0, 2.0, -97.0, -75.0, 13.0, -141.0, 79.0, -185.0, 101.0, 200.0, -9.0, -141.0, -20.0, 2.0, 200.0, 57.0, 112.0, 200.0, 178.0, 200.0, 156.0, 90.0, -405.0, 123.0, 46.0, 2.0, -130.0, 200.0, 200.0, -20.0, 112.0, -108.0, -31.0, -317.0, 13.0, 200.0, 123.0, 200.0], "policy_predator_policy_reward": [620.0, 165.0, 85.0, 0.0, 0.0, 0.0, 5.0, 125.0, 0.0, 310.0, 375.0, 140.0, 140.0, 40.0, 0.0, 0.0, 25.0, 0.0, 415.0, 540.0, 385.0, 25.0, 30.0, 0.0, 835.0, 520.0, 115.0, 110.0, 95.0, 100.0, 85.0, 0.0, 125.0, 65.0, 60.0, 35.0, 50.0, 0.0, 55.0, 10.0, 0.0, 0.0, 50.0, 65.0, 0.0, 205.0, 215.0, 0.0, 80.0, 95.0, 20.0, 110.0, 95.0, 115.0, 135.0, 545.0, 165.0, 105.0, 20.0, 95.0, 155.0, 60.0, 20.0, 360.0, 460.0, 340.0, 195.0, 45.0, 245.0, 60.0, 45.0, 0.0, 0.0, 60.0, 105.0, 35.0, 135.0, 170.0, 0.0, 0.0, 0.0, 340.0, 220.0, 295.0, 65.0, 205.0, 255.0, 540.0, 665.0, 250.0, 265.0, 140.0, 105.0, 295.0, 125.0, 125.0, 50.0, 105.0, 0.0, 70.0, 30.0, 85.0, 185.0, 60.0, 55.0, 50.0, 0.0, 65.0, 105.0, 105.0, 35.0, 0.0, 30.0, 55.0, 215.0, 90.0, 190.0, 10.0, 15.0, 30.0, 0.0, 90.0, 40.0, 75.0, 0.0, 30.0, 100.0, 25.0, 40.0, 55.0, 60.0, 90.0, 5.0, 0.0, 45.0, 75.0, 95.0, 135.0, 100.0, 40.0, 0.0, 5.0, 0.0, 55.0, 0.0, 15.0, 0.0, 195.0, 500.0, 70.0, 45.0, 180.0, 10.0, 0.0, 0.0, 45.0, 180.0, 0.0, 0.0, 120.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 140.0, 100.0, 5.0, 0.0, 145.0, 120.0, 110.0, 115.0, 0.0, 35.0, 35.0, 15.0, 45.0, 130.0, 5.0, 95.0, 0.0, 0.0, 0.0, 45.0, 0.0, 145.0, 0.0, 60.0, 40.0, 55.0, 0.0, 50.0, 45.0, 25.0, 60.0, 80.0, 0.0, 45.0, 140.0, 100.0, 135.0, 205.0, 15.0, 45.0, 0.0, 10.0, 100.0, 170.0, 50.0, 25.0, 25.0, 0.0, 0.0, 0.0, 360.0, 0.0, 310.0, 0.0, 70.0, 0.0, 135.0, 70.0, 80.0, 90.0, 0.0, 30.0, 140.0, 135.0, 190.0, 175.0, 255.0, 175.0, 40.0, 70.0, 20.0, 30.0, 105.0, 65.0, 0.0, 75.0, 65.0, 115.0, 115.0, 100.0, 40.0, 0.0, 50.0, 90.0, 90.0, 0.0, 0.0, 0.0, 70.0, 90.0, 0.0, 0.0, 65.0, 20.0, 0.0, 0.0, 90.0, 15.0, 140.0, 70.0, 135.0, 160.0, 195.0, 125.0, 40.0, 125.0, 0.0, 65.0, 0.0, 205.0, 65.0, 0.0, 0.0, 0.0, 10.0, 0.0, 135.0, 185.0, 215.0, 65.0, 40.0, 95.0, 0.0, 150.0, 0.0, 0.0, 10.0, 150.0, 235.0, 105.0, 170.0, 35.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0051789528818336, "mean_inference_ms": 1.718948998674917, "mean_action_processing_ms": 0.3778474525161494, "mean_env_wait_ms": 0.26462685534479646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00492250919342041, "StateBufferConnector_ms": 0.0042645931243896484, "ViewRequirementAgentConnector_ms": 0.14723217487335205}, "num_episodes": 18, "episode_return_max": 641.0, "episode_return_min": -1104.0, "episode_return_mean": 343.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.33692236440681, "num_env_steps_trained_throughput_per_sec": 54.33692236440681, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 1032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 74569.197, "restore_workers_time_ms": 0.015, "training_step_time_ms": 74569.139, "sample_time_ms": 1603.635, "learn_time_ms": 72944.231, "learn_throughput": 54.836, "synch_weights_time_ms": 17.887}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "training_iteration": 43, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-11-39", "timestamp": 1723489899, "time_this_iter_s": 73.64989185333252, "time_total_s": 3304.0197763442993, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1085dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3304.0197763442993, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 34.38653846153846, "ram_util_percent": 79.08653846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4071893633415935, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5619135778740788, "policy_loss": -0.008177851541265053, "vf_loss": 0.5691907163471618, "vf_explained_var": -9.521628525240201e-05, "kl": 0.006004745301941566, "entropy": 0.6733676961550475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 122670.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.24161273893101, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6184611121656585, "policy_loss": -0.01545767378233743, "vf_loss": 0.6326517050544209, "vf_explained_var": 0.037696830325938284, "kl": 0.006335404288861339, "entropy": 1.347000803254175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 122670.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 641.0, "episode_reward_min": -667.0, "episode_reward_mean": 370.52, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1417.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 665.0}, "policy_reward_mean": {"prey_policy": 42.406666666666666, "predator_policy": 81.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-667.0, 380.0, 329.0, 187.0, 150.0, 573.0, 358.0, 126.0, 600.0, 641.0, 454.0, 196.0, 241.0, 188.0, 458.0, 477.0, 130.0, 495.0, 405.0, 454.0, 116.0, 567.0, 400.0, 474.0, 402.0, 530.0, 540.0, 146.0, 454.0, 528.0, 571.0, -208.0, 340.0, 546.0, 87.0, 291.0, 600.0, 433.0, -75.0, 571.0, 516.0, 306.0, 425.0, 546.0, 261.0, 403.0, 442.0, 435.0, 301.0, 204.0, 539.0, 319.0, 502.0, 600.0, 159.0, 516.0, 60.0, 258.0, 471.0, 215.0, 400.0, 360.0, 575.0, 347.0, 470.0, 461.0, 406.0, 459.0, 410.0, 474.0, 186.0, 233.0, 457.0, 111.0, 434.0, 588.0, 376.0, 371.0, 420.0, 144.0, 175.0, 558.0, 256.0, 203.0, 382.0, 459.0, 564.0, 526.0, 438.0, 452.0, 161.0, 546.0, 547.0, 173.0, 328.0, 575.0, 536.0, 485.0, 501.0, 539.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1186.0, -394.0, 68.0, 200.0, -31.0, -9.0, 200.0, -152.0, 46.0, 189.0, 79.0, -1241.0, 123.0, -31.0, -427.0, 200.0, 200.0, 68.0, 68.0, -31.0, 156.0, -163.0, 79.0, -130.0, 200.0, 200.0, 200.0, 167.0, 200.0, -581.0, 123.0, 134.0, -328.0, 79.0, 79.0, -1417.0, 200.0, 134.0, -603.0, -559.0, 200.0, 2.0, 189.0, -20.0, 134.0, -9.0, 200.0, 101.0, -185.0, 57.0, -42.0, 200.0, -20.0, 200.0, -9.0, -31.0, 200.0, 90.0, 200.0, 79.0, -262.0, 46.0, -163.0, 178.0, 134.0, 200.0, 200.0, 2.0, 68.0, 57.0, 178.0, 134.0, 57.0, -20.0, 200.0, 189.0, -9.0, 145.0, 189.0, 200.0, 101.0, 68.0, -152.0, -75.0, 134.0, 200.0, -20.0, 200.0, 79.0, 189.0, 200.0, 178.0, 178.0, 145.0, -240.0, -878.0, 145.0, -141.0, 101.0, 101.0, 200.0, 200.0, 189.0, -152.0, -130.0, 79.0, 35.0, 57.0, 200.0, 200.0, 200.0, 101.0, -108.0, 200.0, -75.0, -31.0, -119.0, -130.0, 156.0, 200.0, 123.0, 123.0, 200.0, -86.0, 178.0, 24.0, 90.0, 35.0, 200.0, 101.0, 200.0, 200.0, 68.0, -20.0, 68.0, 68.0, 24.0, 156.0, 167.0, 112.0, 68.0, 57.0, 24.0, 189.0, 101.0, -108.0, 123.0, -548.0, 167.0, 145.0, 178.0, 200.0, 101.0, -240.0, 79.0, 200.0, 134.0, 178.0, 90.0, 200.0, 200.0, 200.0, -20.0, -592.0, 101.0, 46.0, 200.0, 200.0, -141.0, 35.0, -119.0, 2.0, 2.0, 134.0, -306.0, 189.0, 123.0, -9.0, 134.0, -515.0, 134.0, 112.0, 24.0, 178.0, -20.0, 2.0, 35.0, 200.0, 200.0, 24.0, -97.0, 90.0, 134.0, 112.0, 134.0, 13.0, 68.0, 200.0, 200.0, 46.0, 90.0, 167.0, 2.0, 200.0, 79.0, 90.0, 156.0, 167.0, 200.0, 2.0, -97.0, -75.0, 13.0, -141.0, 79.0, -185.0, 101.0, 200.0, -9.0, -141.0, -20.0, 2.0, 200.0, 57.0, 112.0, 200.0, 178.0, 200.0, 156.0, 90.0, -405.0, 123.0, 46.0, 2.0, -130.0, 200.0, 200.0, -20.0, 112.0, -108.0, -31.0, -317.0, 13.0, 200.0, 123.0, 200.0, 35.0, 90.0, -504.0, -86.0, 145.0, -31.0, 156.0, 35.0, -9.0, 123.0, 68.0, 123.0, 79.0, 200.0, 200.0, 200.0, 200.0, -9.0, 200.0, -20.0, 123.0, 112.0, 90.0, 200.0, 167.0, -570.0, 189.0, 200.0, 200.0, 101.0, 46.0, 200.0, 156.0, -130.0, -97.0, 90.0, 2.0, -218.0, 79.0, 145.0, 200.0, 200.0, 200.0, 200.0, 46.0, 156.0, 200.0, 24.0, 200.0, 46.0, 145.0, -31.0, 200.0, 200.0], "policy_predator_policy_reward": [135.0, 545.0, 165.0, 105.0, 20.0, 95.0, 155.0, 60.0, 20.0, 360.0, 460.0, 340.0, 195.0, 45.0, 245.0, 60.0, 45.0, 0.0, 0.0, 60.0, 105.0, 35.0, 135.0, 170.0, 0.0, 0.0, 0.0, 340.0, 220.0, 295.0, 65.0, 205.0, 255.0, 540.0, 665.0, 250.0, 265.0, 140.0, 105.0, 295.0, 125.0, 125.0, 50.0, 105.0, 0.0, 70.0, 30.0, 85.0, 185.0, 60.0, 55.0, 50.0, 0.0, 65.0, 105.0, 105.0, 35.0, 0.0, 30.0, 55.0, 215.0, 90.0, 190.0, 10.0, 15.0, 30.0, 0.0, 90.0, 40.0, 75.0, 0.0, 30.0, 100.0, 25.0, 40.0, 55.0, 60.0, 90.0, 5.0, 0.0, 45.0, 75.0, 95.0, 135.0, 100.0, 40.0, 0.0, 5.0, 0.0, 55.0, 0.0, 15.0, 0.0, 195.0, 500.0, 70.0, 45.0, 180.0, 10.0, 0.0, 0.0, 45.0, 180.0, 0.0, 0.0, 120.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 140.0, 100.0, 5.0, 0.0, 145.0, 120.0, 110.0, 115.0, 0.0, 35.0, 35.0, 15.0, 45.0, 130.0, 5.0, 95.0, 0.0, 0.0, 0.0, 45.0, 0.0, 145.0, 0.0, 60.0, 40.0, 55.0, 0.0, 50.0, 45.0, 25.0, 60.0, 80.0, 0.0, 45.0, 140.0, 100.0, 135.0, 205.0, 15.0, 45.0, 0.0, 10.0, 100.0, 170.0, 50.0, 25.0, 25.0, 0.0, 0.0, 0.0, 360.0, 0.0, 310.0, 0.0, 70.0, 0.0, 135.0, 70.0, 80.0, 90.0, 0.0, 30.0, 140.0, 135.0, 190.0, 175.0, 255.0, 175.0, 40.0, 70.0, 20.0, 30.0, 105.0, 65.0, 0.0, 75.0, 65.0, 115.0, 115.0, 100.0, 40.0, 0.0, 50.0, 90.0, 90.0, 0.0, 0.0, 0.0, 70.0, 90.0, 0.0, 0.0, 65.0, 20.0, 0.0, 0.0, 90.0, 15.0, 140.0, 70.0, 135.0, 160.0, 195.0, 125.0, 40.0, 125.0, 0.0, 65.0, 0.0, 205.0, 65.0, 0.0, 0.0, 0.0, 10.0, 0.0, 135.0, 185.0, 215.0, 65.0, 40.0, 95.0, 0.0, 150.0, 0.0, 0.0, 10.0, 150.0, 235.0, 105.0, 170.0, 35.0, 0.0, 0.0, 355.0, 150.0, 130.0, 5.0, 170.0, 0.0, 80.0, 40.0, 80.0, 45.0, 30.0, 70.0, 55.0, 30.0, 0.0, 90.0, 45.0, 0.0, 100.0, 20.0, 15.0, 0.0, 50.0, 0.0, 0.0, 360.0, 15.0, 0.0, 45.0, 0.0, 55.0, 5.0, 85.0, 150.0, 120.0, 40.0, 135.0, 155.0, 175.0, 25.0, 0.0, 5.0, 0.0, 70.0, 20.0, 80.0, 5.0, 20.0, 70.0, 0.0, 40.0, 55.0, 40.0, 75.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0035728526988503, "mean_inference_ms": 1.7161019425043411, "mean_action_processing_ms": 0.377877604025419, "mean_env_wait_ms": 0.26452830334885885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005177617073059082, "StateBufferConnector_ms": 0.00441431999206543, "ViewRequirementAgentConnector_ms": 0.16718339920043945}, "num_episodes": 18, "episode_return_max": 641.0, "episode_return_min": -667.0, "episode_return_mean": 370.52, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.52930495243222, "num_env_steps_trained_throughput_per_sec": 54.52930495243222, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 74390.627, "restore_workers_time_ms": 0.015, "training_step_time_ms": 74390.569, "sample_time_ms": 1604.89, "learn_time_ms": 72764.234, "learn_throughput": 54.972, "synch_weights_time_ms": 18.164}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 44, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-12-52", "timestamp": 1723489972, "time_this_iter_s": 73.40798020362854, "time_total_s": 3377.427756547928, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b106b820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3377.427756547928, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 32.941904761904766, "ram_util_percent": 79.36952380952383}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5512766984126247, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9736255167118201, "policy_loss": -0.010377213696978907, "vf_loss": 0.9830562212365739, "vf_explained_var": -2.680953512800501e-05, "kl": 0.006310044433793196, "entropy": 0.7435624963425576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 125490.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.175150890489842, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9048702762173224, "policy_loss": -0.01814811028633432, "vf_loss": 0.9216859747701925, "vf_explained_var": 0.03695536181859091, "kl": 0.0066620710792959096, "entropy": 1.3545891531815766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 125490.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -208.0, "episode_reward_mean": 382.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -878.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 500.0}, "policy_reward_mean": {"prey_policy": 61.84, "predator_policy": 65.58333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 474.0, 402.0, 530.0, 540.0, 146.0, 454.0, 528.0, 571.0, -208.0, 340.0, 546.0, 87.0, 291.0, 600.0, 433.0, -75.0, 571.0, 516.0, 306.0, 425.0, 546.0, 261.0, 403.0, 442.0, 435.0, 301.0, 204.0, 539.0, 319.0, 502.0, 600.0, 159.0, 516.0, 60.0, 258.0, 471.0, 215.0, 400.0, 360.0, 575.0, 347.0, 470.0, 461.0, 406.0, 459.0, 410.0, 474.0, 186.0, 233.0, 457.0, 111.0, 434.0, 588.0, 376.0, 371.0, 420.0, 144.0, 175.0, 558.0, 256.0, 203.0, 382.0, 459.0, 564.0, 526.0, 438.0, 452.0, 161.0, 546.0, 547.0, 173.0, 328.0, 575.0, 536.0, 485.0, 501.0, 539.0, 368.0, 385.0, 288.0, 515.0, -191.0, 474.0, -10.0, 362.0, 130.0, 297.0, 564.0, 577.0, 517.0, 103.0, 600.0, 509.0, 255.0, 546.0, 379.0, 435.0, 558.0, 372.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 2.0, 68.0, 57.0, 178.0, 134.0, 57.0, -20.0, 200.0, 189.0, -9.0, 145.0, 189.0, 200.0, 101.0, 68.0, -152.0, -75.0, 134.0, 200.0, -20.0, 200.0, 79.0, 189.0, 200.0, 178.0, 178.0, 145.0, -240.0, -878.0, 145.0, -141.0, 101.0, 101.0, 200.0, 200.0, 189.0, -152.0, -130.0, 79.0, 35.0, 57.0, 200.0, 200.0, 200.0, 101.0, -108.0, 200.0, -75.0, -31.0, -119.0, -130.0, 156.0, 200.0, 123.0, 123.0, 200.0, -86.0, 178.0, 24.0, 90.0, 35.0, 200.0, 101.0, 200.0, 200.0, 68.0, -20.0, 68.0, 68.0, 24.0, 156.0, 167.0, 112.0, 68.0, 57.0, 24.0, 189.0, 101.0, -108.0, 123.0, -548.0, 167.0, 145.0, 178.0, 200.0, 101.0, -240.0, 79.0, 200.0, 134.0, 178.0, 90.0, 200.0, 200.0, 200.0, -20.0, -592.0, 101.0, 46.0, 200.0, 200.0, -141.0, 35.0, -119.0, 2.0, 2.0, 134.0, -306.0, 189.0, 123.0, -9.0, 134.0, -515.0, 134.0, 112.0, 24.0, 178.0, -20.0, 2.0, 35.0, 200.0, 200.0, 24.0, -97.0, 90.0, 134.0, 112.0, 134.0, 13.0, 68.0, 200.0, 200.0, 46.0, 90.0, 167.0, 2.0, 200.0, 79.0, 90.0, 156.0, 167.0, 200.0, 2.0, -97.0, -75.0, 13.0, -141.0, 79.0, -185.0, 101.0, 200.0, -9.0, -141.0, -20.0, 2.0, 200.0, 57.0, 112.0, 200.0, 178.0, 200.0, 156.0, 90.0, -405.0, 123.0, 46.0, 2.0, -130.0, 200.0, 200.0, -20.0, 112.0, -108.0, -31.0, -317.0, 13.0, 200.0, 123.0, 200.0, 35.0, 90.0, -504.0, -86.0, 145.0, -31.0, 156.0, 35.0, -9.0, 123.0, 68.0, 123.0, 79.0, 200.0, 200.0, 200.0, 200.0, -9.0, 200.0, -20.0, 123.0, 112.0, 90.0, 200.0, 167.0, -570.0, 189.0, 200.0, 200.0, 101.0, 46.0, 200.0, 156.0, -130.0, -97.0, 90.0, 2.0, -218.0, 79.0, 145.0, 200.0, 200.0, 200.0, 200.0, 46.0, 156.0, 200.0, 24.0, 200.0, 46.0, 145.0, -31.0, 200.0, 200.0, 57.0, 145.0, 101.0, 167.0, 90.0, 13.0, 200.0, -75.0, -97.0, 200.0, 35.0, 200.0, -713.0, 123.0, -306.0, 68.0, 112.0, 189.0, -273.0, -207.0, 200.0, 200.0, 112.0, -75.0, 178.0, -383.0, -75.0, 200.0, -306.0, 68.0, 200.0, 134.0, 200.0, 200.0, 112.0, 200.0, 189.0, 156.0, 112.0, -64.0, -339.0, 46.0, 200.0, 200.0, 200.0, 178.0, 101.0, 145.0, -31.0, 46.0, -75.0, 200.0, 101.0, 200.0, -20.0, 156.0, 68.0, -97.0, 112.0, 200.0, 200.0, 200.0, 123.0, -273.0, 189.0, -9.0], "policy_predator_policy_reward": [0.0, 90.0, 40.0, 75.0, 0.0, 30.0, 100.0, 25.0, 40.0, 55.0, 60.0, 90.0, 5.0, 0.0, 45.0, 75.0, 95.0, 135.0, 100.0, 40.0, 0.0, 5.0, 0.0, 55.0, 0.0, 15.0, 0.0, 195.0, 500.0, 70.0, 45.0, 180.0, 10.0, 0.0, 0.0, 45.0, 180.0, 0.0, 0.0, 120.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 140.0, 100.0, 5.0, 0.0, 145.0, 120.0, 110.0, 115.0, 0.0, 35.0, 35.0, 15.0, 45.0, 130.0, 5.0, 95.0, 0.0, 0.0, 0.0, 45.0, 0.0, 145.0, 0.0, 60.0, 40.0, 55.0, 0.0, 50.0, 45.0, 25.0, 60.0, 80.0, 0.0, 45.0, 140.0, 100.0, 135.0, 205.0, 15.0, 45.0, 0.0, 10.0, 100.0, 170.0, 50.0, 25.0, 25.0, 0.0, 0.0, 0.0, 360.0, 0.0, 310.0, 0.0, 70.0, 0.0, 135.0, 70.0, 80.0, 90.0, 0.0, 30.0, 140.0, 135.0, 190.0, 175.0, 255.0, 175.0, 40.0, 70.0, 20.0, 30.0, 105.0, 65.0, 0.0, 75.0, 65.0, 115.0, 115.0, 100.0, 40.0, 0.0, 50.0, 90.0, 90.0, 0.0, 0.0, 0.0, 70.0, 90.0, 0.0, 0.0, 65.0, 20.0, 0.0, 0.0, 90.0, 15.0, 140.0, 70.0, 135.0, 160.0, 195.0, 125.0, 40.0, 125.0, 0.0, 65.0, 0.0, 205.0, 65.0, 0.0, 0.0, 0.0, 10.0, 0.0, 135.0, 185.0, 215.0, 65.0, 40.0, 95.0, 0.0, 150.0, 0.0, 0.0, 10.0, 150.0, 235.0, 105.0, 170.0, 35.0, 0.0, 0.0, 355.0, 150.0, 130.0, 5.0, 170.0, 0.0, 80.0, 40.0, 80.0, 45.0, 30.0, 70.0, 55.0, 30.0, 0.0, 90.0, 45.0, 0.0, 100.0, 20.0, 15.0, 0.0, 50.0, 0.0, 0.0, 360.0, 15.0, 0.0, 45.0, 0.0, 55.0, 5.0, 85.0, 150.0, 120.0, 40.0, 135.0, 155.0, 175.0, 25.0, 0.0, 5.0, 0.0, 70.0, 20.0, 80.0, 5.0, 20.0, 70.0, 0.0, 40.0, 55.0, 40.0, 75.0, 0.0, 0.0, 65.0, 0.0, 15.0, 100.0, 0.0, 125.0, 135.0, 35.0, 45.0, 0.0, 370.0, 195.0, 140.0, 5.0, 40.0, 60.0, 0.0, 15.0, 255.0, 0.0, 125.0, 0.0, 60.0, 210.0, 140.0, 45.0, 230.0, 60.0, 15.0, 0.0, 15.0, 25.0, 0.0, 40.0, 0.0, 20.0, 40.0, 145.0, 220.0, 95.0, 0.0, 0.0, 0.0, 0.0, 40.0, 45.0, 140.0, 105.0, 70.0, 0.0, 45.0, 0.0, 60.0, 15.0, 100.0, 110.0, 85.0, 25.0, 0.0, 0.0, 35.0, 180.0, 120.0, 165.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.003107276795805, "mean_inference_ms": 1.714497961607633, "mean_action_processing_ms": 0.37817990924161266, "mean_env_wait_ms": 0.26480668440484856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004899024963378906, "StateBufferConnector_ms": 0.0051566362380981445, "ViewRequirementAgentConnector_ms": 0.17704617977142334}, "num_episodes": 22, "episode_return_max": 600.0, "episode_return_min": -208.0, "episode_return_mean": 382.27, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.501367323891536, "num_env_steps_trained_throughput_per_sec": 53.501367323891536, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 74393.956, "restore_workers_time_ms": 0.015, "training_step_time_ms": 74393.899, "sample_time_ms": 1650.235, "learn_time_ms": 72722.065, "learn_throughput": 55.004, "synch_weights_time_ms": 18.067}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 45, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-14-07", "timestamp": 1723490047, "time_this_iter_s": 74.80676698684692, "time_total_s": 3452.234523534775, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1078dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3452.234523534775, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 34.968867924528304, "ram_util_percent": 79.67169811320754}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.469323441660996, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6292505618422589, "policy_loss": -0.009514643594123925, "vf_loss": 0.6377620930050282, "vf_explained_var": -5.839760844589125e-05, "kl": 0.006687394153042785, "entropy": 0.7821853635370308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 128310.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.421020062753917, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6061522906646545, "policy_loss": -0.016321138121478312, "vf_loss": 0.6212561165715785, "vf_explained_var": 0.05408473665832628, "kl": 0.0060865577167625515, "entropy": 1.3689671855446295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 128310.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -191.0, "episode_reward_mean": 394.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -713.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 370.0}, "policy_reward_mean": {"prey_policy": 67.23, "predator_policy": 64.23333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [403.0, 442.0, 435.0, 301.0, 204.0, 539.0, 319.0, 502.0, 600.0, 159.0, 516.0, 60.0, 258.0, 471.0, 215.0, 400.0, 360.0, 575.0, 347.0, 470.0, 461.0, 406.0, 459.0, 410.0, 474.0, 186.0, 233.0, 457.0, 111.0, 434.0, 588.0, 376.0, 371.0, 420.0, 144.0, 175.0, 558.0, 256.0, 203.0, 382.0, 459.0, 564.0, 526.0, 438.0, 452.0, 161.0, 546.0, 547.0, 173.0, 328.0, 575.0, 536.0, 485.0, 501.0, 539.0, 368.0, 385.0, 288.0, 515.0, -191.0, 474.0, -10.0, 362.0, 130.0, 297.0, 564.0, 577.0, 517.0, 103.0, 600.0, 509.0, 255.0, 546.0, 379.0, 435.0, 558.0, 372.0, 600.0, 565.0, 588.0, 542.0, 373.0, 249.0, 225.0, 318.0, 300.0, 259.0, 471.0, 564.0, 502.0, 528.0, 399.0, 594.0, 510.0, 558.0, 530.0, 276.0, 10.0, 474.0, 461.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [68.0, 24.0, 156.0, 167.0, 112.0, 68.0, 57.0, 24.0, 189.0, 101.0, -108.0, 123.0, -548.0, 167.0, 145.0, 178.0, 200.0, 101.0, -240.0, 79.0, 200.0, 134.0, 178.0, 90.0, 200.0, 200.0, 200.0, -20.0, -592.0, 101.0, 46.0, 200.0, 200.0, -141.0, 35.0, -119.0, 2.0, 2.0, 134.0, -306.0, 189.0, 123.0, -9.0, 134.0, -515.0, 134.0, 112.0, 24.0, 178.0, -20.0, 2.0, 35.0, 200.0, 200.0, 24.0, -97.0, 90.0, 134.0, 112.0, 134.0, 13.0, 68.0, 200.0, 200.0, 46.0, 90.0, 167.0, 2.0, 200.0, 79.0, 90.0, 156.0, 167.0, 200.0, 2.0, -97.0, -75.0, 13.0, -141.0, 79.0, -185.0, 101.0, 200.0, -9.0, -141.0, -20.0, 2.0, 200.0, 57.0, 112.0, 200.0, 178.0, 200.0, 156.0, 90.0, -405.0, 123.0, 46.0, 2.0, -130.0, 200.0, 200.0, -20.0, 112.0, -108.0, -31.0, -317.0, 13.0, 200.0, 123.0, 200.0, 35.0, 90.0, -504.0, -86.0, 145.0, -31.0, 156.0, 35.0, -9.0, 123.0, 68.0, 123.0, 79.0, 200.0, 200.0, 200.0, 200.0, -9.0, 200.0, -20.0, 123.0, 112.0, 90.0, 200.0, 167.0, -570.0, 189.0, 200.0, 200.0, 101.0, 46.0, 200.0, 156.0, -130.0, -97.0, 90.0, 2.0, -218.0, 79.0, 145.0, 200.0, 200.0, 200.0, 200.0, 46.0, 156.0, 200.0, 24.0, 200.0, 46.0, 145.0, -31.0, 200.0, 200.0, 57.0, 145.0, 101.0, 167.0, 90.0, 13.0, 200.0, -75.0, -97.0, 200.0, 35.0, 200.0, -713.0, 123.0, -306.0, 68.0, 112.0, 189.0, -273.0, -207.0, 200.0, 200.0, 112.0, -75.0, 178.0, -383.0, -75.0, 200.0, -306.0, 68.0, 200.0, 134.0, 200.0, 200.0, 112.0, 200.0, 189.0, 156.0, 112.0, -64.0, -339.0, 46.0, 200.0, 200.0, 200.0, 178.0, 101.0, 145.0, -31.0, 46.0, -75.0, 200.0, 101.0, 200.0, -20.0, 156.0, 68.0, -97.0, 112.0, 200.0, 200.0, 200.0, 123.0, -273.0, 189.0, -9.0, 200.0, 200.0, 200.0, 200.0, -20.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, 57.0, 24.0, -53.0, 167.0, -141.0, 46.0, 189.0, 46.0, -174.0, 68.0, 200.0, -119.0, -53.0, 200.0, -20.0, -20.0, 2.0, 189.0, -97.0, 123.0, 123.0, 145.0, 134.0, 200.0, 200.0, 167.0, 156.0, 134.0, 2.0, 167.0, 134.0, 167.0, 46.0, 46.0, 189.0, 200.0, 200.0, -20.0, 189.0, 156.0, 200.0, 123.0, 200.0, 134.0, 200.0, 46.0, 35.0, 24.0, 57.0, -163.0, -174.0, -163.0, 178.0, -119.0, 200.0, 167.0, 112.0, 112.0], "policy_predator_policy_reward": [60.0, 40.0, 55.0, 0.0, 50.0, 45.0, 25.0, 60.0, 80.0, 0.0, 45.0, 140.0, 100.0, 135.0, 205.0, 15.0, 45.0, 0.0, 10.0, 100.0, 170.0, 50.0, 25.0, 25.0, 0.0, 0.0, 0.0, 360.0, 0.0, 310.0, 0.0, 70.0, 0.0, 135.0, 70.0, 80.0, 90.0, 0.0, 30.0, 140.0, 135.0, 190.0, 175.0, 255.0, 175.0, 40.0, 70.0, 20.0, 30.0, 105.0, 65.0, 0.0, 75.0, 65.0, 115.0, 115.0, 100.0, 40.0, 0.0, 50.0, 90.0, 90.0, 0.0, 0.0, 0.0, 70.0, 90.0, 0.0, 0.0, 65.0, 20.0, 0.0, 0.0, 90.0, 15.0, 140.0, 70.0, 135.0, 160.0, 195.0, 125.0, 40.0, 125.0, 0.0, 65.0, 0.0, 205.0, 65.0, 0.0, 0.0, 0.0, 10.0, 0.0, 135.0, 185.0, 215.0, 65.0, 40.0, 95.0, 0.0, 150.0, 0.0, 0.0, 10.0, 150.0, 235.0, 105.0, 170.0, 35.0, 0.0, 0.0, 355.0, 150.0, 130.0, 5.0, 170.0, 0.0, 80.0, 40.0, 80.0, 45.0, 30.0, 70.0, 55.0, 30.0, 0.0, 90.0, 45.0, 0.0, 100.0, 20.0, 15.0, 0.0, 50.0, 0.0, 0.0, 360.0, 15.0, 0.0, 45.0, 0.0, 55.0, 5.0, 85.0, 150.0, 120.0, 40.0, 135.0, 155.0, 175.0, 25.0, 0.0, 5.0, 0.0, 70.0, 20.0, 80.0, 5.0, 20.0, 70.0, 0.0, 40.0, 55.0, 40.0, 75.0, 0.0, 0.0, 65.0, 0.0, 15.0, 100.0, 0.0, 125.0, 135.0, 35.0, 45.0, 0.0, 370.0, 195.0, 140.0, 5.0, 40.0, 60.0, 0.0, 15.0, 255.0, 0.0, 125.0, 0.0, 60.0, 210.0, 140.0, 45.0, 230.0, 60.0, 15.0, 0.0, 15.0, 25.0, 0.0, 40.0, 0.0, 20.0, 40.0, 145.0, 220.0, 95.0, 0.0, 0.0, 0.0, 0.0, 40.0, 45.0, 140.0, 105.0, 70.0, 0.0, 45.0, 0.0, 60.0, 15.0, 100.0, 110.0, 85.0, 25.0, 0.0, 0.0, 35.0, 180.0, 120.0, 165.0, 0.0, 0.0, 0.0, 75.0, 50.0, 60.0, 10.0, 0.0, 0.0, 65.0, 0.0, 20.0, 40.0, 60.0, 135.0, 155.0, 0.0, 0.0, 70.0, 0.0, 215.0, 80.0, 65.0, 145.0, 90.0, 50.0, 0.0, 0.0, 35.0, 130.0, 35.0, 0.0, 45.0, 25.0, 5.0, 0.0, 15.0, 0.0, 30.0, 90.0, 90.0, 45.0, 0.0, 0.0, 140.0, 0.0, 5.0, 0.0, 65.0, 70.0, 50.0, 35.0, 0.0, 0.0, 30.0, 50.0, 70.0, 145.0, 0.0, 15.0, 210.0, 140.0, 160.0, 130.0, 55.0, 30.0, 40.0, 30.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0025791007634648, "mean_inference_ms": 1.7129213330023754, "mean_action_processing_ms": 0.3784393448412638, "mean_env_wait_ms": 0.2649857751279296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005213141441345215, "StateBufferConnector_ms": 0.005040526390075684, "ViewRequirementAgentConnector_ms": 0.17371046543121338}, "num_episodes": 23, "episode_return_max": 600.0, "episode_return_min": -191.0, "episode_return_mean": 394.39, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.56172295201639, "num_env_steps_trained_throughput_per_sec": 54.56172295201639, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 74231.872, "restore_workers_time_ms": 0.014, "training_step_time_ms": 74231.816, "sample_time_ms": 1657.343, "learn_time_ms": 72554.661, "learn_throughput": 55.131, "synch_weights_time_ms": 16.578}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 46, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-15-21", "timestamp": 1723490121, "time_this_iter_s": 73.36783075332642, "time_total_s": 3525.602354288101, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b106b940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3525.602354288101, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 32.45631067961165, "ram_util_percent": 79.97572815533981}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3748268881799481, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7319805263944551, "policy_loss": -0.007270053983500875, "vf_loss": 0.7384009231357498, "vf_explained_var": -8.326840738878182e-05, "kl": 0.005664359620420635, "entropy": 0.7491830410052699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 131130.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.533865681639377, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.577712225040577, "policy_loss": -0.017586173046568527, "vf_loss": 0.5942098258809163, "vf_explained_var": 0.050684629539225964, "kl": 0.0054428601654853345, "entropy": 1.3612199716956903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 131130.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -191.0, "episode_reward_mean": 411.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -713.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 370.0}, "policy_reward_mean": {"prey_policy": 78.45, "predator_policy": 58.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [347.0, 470.0, 461.0, 406.0, 459.0, 410.0, 474.0, 186.0, 233.0, 457.0, 111.0, 434.0, 588.0, 376.0, 371.0, 420.0, 144.0, 175.0, 558.0, 256.0, 203.0, 382.0, 459.0, 564.0, 526.0, 438.0, 452.0, 161.0, 546.0, 547.0, 173.0, 328.0, 575.0, 536.0, 485.0, 501.0, 539.0, 368.0, 385.0, 288.0, 515.0, -191.0, 474.0, -10.0, 362.0, 130.0, 297.0, 564.0, 577.0, 517.0, 103.0, 600.0, 509.0, 255.0, 546.0, 379.0, 435.0, 558.0, 372.0, 600.0, 565.0, 588.0, 542.0, 373.0, 249.0, 225.0, 318.0, 300.0, 259.0, 471.0, 564.0, 502.0, 528.0, 399.0, 594.0, 510.0, 558.0, 530.0, 276.0, 10.0, 474.0, 461.0, 389.0, 516.0, 549.0, 563.0, 450.0, 540.0, 558.0, 588.0, 600.0, 333.0, 469.0, 465.0, 120.0, 511.0, 600.0, 274.0, 583.0, 357.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [24.0, -97.0, 90.0, 134.0, 112.0, 134.0, 13.0, 68.0, 200.0, 200.0, 46.0, 90.0, 167.0, 2.0, 200.0, 79.0, 90.0, 156.0, 167.0, 200.0, 2.0, -97.0, -75.0, 13.0, -141.0, 79.0, -185.0, 101.0, 200.0, -9.0, -141.0, -20.0, 2.0, 200.0, 57.0, 112.0, 200.0, 178.0, 200.0, 156.0, 90.0, -405.0, 123.0, 46.0, 2.0, -130.0, 200.0, 200.0, -20.0, 112.0, -108.0, -31.0, -317.0, 13.0, 200.0, 123.0, 200.0, 35.0, 90.0, -504.0, -86.0, 145.0, -31.0, 156.0, 35.0, -9.0, 123.0, 68.0, 123.0, 79.0, 200.0, 200.0, 200.0, 200.0, -9.0, 200.0, -20.0, 123.0, 112.0, 90.0, 200.0, 167.0, -570.0, 189.0, 200.0, 200.0, 101.0, 46.0, 200.0, 156.0, -130.0, -97.0, 90.0, 2.0, -218.0, 79.0, 145.0, 200.0, 200.0, 200.0, 200.0, 46.0, 156.0, 200.0, 24.0, 200.0, 46.0, 145.0, -31.0, 200.0, 200.0, 57.0, 145.0, 101.0, 167.0, 90.0, 13.0, 200.0, -75.0, -97.0, 200.0, 35.0, 200.0, -713.0, 123.0, -306.0, 68.0, 112.0, 189.0, -273.0, -207.0, 200.0, 200.0, 112.0, -75.0, 178.0, -383.0, -75.0, 200.0, -306.0, 68.0, 200.0, 134.0, 200.0, 200.0, 112.0, 200.0, 189.0, 156.0, 112.0, -64.0, -339.0, 46.0, 200.0, 200.0, 200.0, 178.0, 101.0, 145.0, -31.0, 46.0, -75.0, 200.0, 101.0, 200.0, -20.0, 156.0, 68.0, -97.0, 112.0, 200.0, 200.0, 200.0, 123.0, -273.0, 189.0, -9.0, 200.0, 200.0, 200.0, 200.0, -20.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, 57.0, 24.0, -53.0, 167.0, -141.0, 46.0, 189.0, 46.0, -174.0, 68.0, 200.0, -119.0, -53.0, 200.0, -20.0, -20.0, 2.0, 189.0, -97.0, 123.0, 123.0, 145.0, 134.0, 200.0, 200.0, 167.0, 156.0, 134.0, 2.0, 167.0, 134.0, 167.0, 46.0, 46.0, 189.0, 200.0, 200.0, -20.0, 189.0, 156.0, 200.0, 123.0, 200.0, 134.0, 200.0, 46.0, 35.0, 24.0, 57.0, -163.0, -174.0, -163.0, 178.0, -119.0, 200.0, 167.0, 112.0, 112.0, 101.0, 35.0, 123.0, 200.0, 46.0, 200.0, 200.0, 79.0, 200.0, 200.0, 200.0, -42.0, 200.0, 90.0, 90.0, 90.0, 200.0, 200.0, 167.0, 156.0, 200.0, 178.0, 200.0, 200.0, 200.0, 200.0, 200.0, -515.0, 200.0, 123.0, 57.0, 178.0, 24.0, 178.0, 68.0, 79.0, 13.0, -163.0, -75.0, 134.0, 57.0, 200.0, 200.0, 200.0, 200.0, 68.0, 90.0, -174.0, 200.0, 123.0, 200.0, 189.0, -9.0, 2.0], "policy_predator_policy_reward": [115.0, 115.0, 100.0, 40.0, 0.0, 50.0, 90.0, 90.0, 0.0, 0.0, 0.0, 70.0, 90.0, 0.0, 0.0, 65.0, 20.0, 0.0, 0.0, 90.0, 15.0, 140.0, 70.0, 135.0, 160.0, 195.0, 125.0, 40.0, 125.0, 0.0, 65.0, 0.0, 205.0, 65.0, 0.0, 0.0, 0.0, 10.0, 0.0, 135.0, 185.0, 215.0, 65.0, 40.0, 95.0, 0.0, 150.0, 0.0, 0.0, 10.0, 150.0, 235.0, 105.0, 170.0, 35.0, 0.0, 0.0, 355.0, 150.0, 130.0, 5.0, 170.0, 0.0, 80.0, 40.0, 80.0, 45.0, 30.0, 70.0, 55.0, 30.0, 0.0, 90.0, 45.0, 0.0, 100.0, 20.0, 15.0, 0.0, 50.0, 0.0, 0.0, 360.0, 15.0, 0.0, 45.0, 0.0, 55.0, 5.0, 85.0, 150.0, 120.0, 40.0, 135.0, 155.0, 175.0, 25.0, 0.0, 5.0, 0.0, 70.0, 20.0, 80.0, 5.0, 20.0, 70.0, 0.0, 40.0, 55.0, 40.0, 75.0, 0.0, 0.0, 65.0, 0.0, 15.0, 100.0, 0.0, 125.0, 135.0, 35.0, 45.0, 0.0, 370.0, 195.0, 140.0, 5.0, 40.0, 60.0, 0.0, 15.0, 255.0, 0.0, 125.0, 0.0, 60.0, 210.0, 140.0, 45.0, 230.0, 60.0, 15.0, 0.0, 15.0, 25.0, 0.0, 40.0, 0.0, 20.0, 40.0, 145.0, 220.0, 95.0, 0.0, 0.0, 0.0, 0.0, 40.0, 45.0, 140.0, 105.0, 70.0, 0.0, 45.0, 0.0, 60.0, 15.0, 100.0, 110.0, 85.0, 25.0, 0.0, 0.0, 35.0, 180.0, 120.0, 165.0, 0.0, 0.0, 0.0, 75.0, 50.0, 60.0, 10.0, 0.0, 0.0, 65.0, 0.0, 20.0, 40.0, 60.0, 135.0, 155.0, 0.0, 0.0, 70.0, 0.0, 215.0, 80.0, 65.0, 145.0, 90.0, 50.0, 0.0, 0.0, 35.0, 130.0, 35.0, 0.0, 45.0, 25.0, 5.0, 0.0, 15.0, 0.0, 30.0, 90.0, 90.0, 45.0, 0.0, 0.0, 140.0, 0.0, 5.0, 0.0, 65.0, 70.0, 50.0, 35.0, 0.0, 0.0, 30.0, 50.0, 70.0, 145.0, 0.0, 15.0, 210.0, 140.0, 160.0, 130.0, 55.0, 30.0, 40.0, 30.0, 0.0, 0.0, 40.0, 90.0, 70.0, 0.0, 0.0, 45.0, 10.0, 15.0, 70.0, 70.0, 65.0, 5.0, 0.0, 65.0, 0.0, 0.0, 50.0, 15.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 65.0, 315.0, 115.0, 95.0, 0.0, 60.0, 25.0, 55.0, 55.0, 150.0, 140.0, 65.0, 0.0, 55.0, 0.0, 0.0, 0.0, 35.0, 95.0, 160.0, 25.0, 35.0, 0.0, 125.0, 45.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0038326169586909, "mean_inference_ms": 1.7134929467857907, "mean_action_processing_ms": 0.3788567347530998, "mean_env_wait_ms": 0.265506962572319, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056542158126831055, "StateBufferConnector_ms": 0.005014300346374512, "ViewRequirementAgentConnector_ms": 0.19686388969421387}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -191.0, "episode_return_mean": 411.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.30004300260854, "num_env_steps_trained_throughput_per_sec": 53.30004300260854, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 1128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 74206.335, "restore_workers_time_ms": 0.014, "training_step_time_ms": 74206.278, "sample_time_ms": 1554.908, "learn_time_ms": 72631.339, "learn_throughput": 55.073, "synch_weights_time_ms": 16.97}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "training_iteration": 47, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-16-36", "timestamp": 1723490196, "time_this_iter_s": 75.09751796722412, "time_total_s": 3600.6998722553253, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1078940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3600.6998722553253, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 35.575471698113205, "ram_util_percent": 80.57264150943396}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.34842080323303, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5424132773322417, "policy_loss": -0.007706386505309096, "vf_loss": 0.5492164149351999, "vf_explained_var": 3.318649234501182e-05, "kl": 0.006021636876383946, "entropy": 0.6762466838807925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 133950.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.526488389391848, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6053891707124215, "policy_loss": -0.014765725065524697, "vf_loss": 0.6189915328363785, "vf_explained_var": 0.051893484148573366, "kl": 0.005816812282566774, "entropy": 1.313900297203808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 133950.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -191.0, "episode_reward_mean": 419.71, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -713.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 390.0}, "policy_reward_mean": {"prey_policy": 84.72, "predator_policy": 55.18333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [558.0, 256.0, 203.0, 382.0, 459.0, 564.0, 526.0, 438.0, 452.0, 161.0, 546.0, 547.0, 173.0, 328.0, 575.0, 536.0, 485.0, 501.0, 539.0, 368.0, 385.0, 288.0, 515.0, -191.0, 474.0, -10.0, 362.0, 130.0, 297.0, 564.0, 577.0, 517.0, 103.0, 600.0, 509.0, 255.0, 546.0, 379.0, 435.0, 558.0, 372.0, 600.0, 565.0, 588.0, 542.0, 373.0, 249.0, 225.0, 318.0, 300.0, 259.0, 471.0, 564.0, 502.0, 528.0, 399.0, 594.0, 510.0, 558.0, 530.0, 276.0, 10.0, 474.0, 461.0, 389.0, 516.0, 549.0, 563.0, 450.0, 540.0, 558.0, 588.0, 600.0, 333.0, 469.0, 465.0, 120.0, 511.0, 600.0, 274.0, 583.0, 357.0, 528.0, 451.0, 352.0, 521.0, 371.0, 391.0, 353.0, 269.0, 491.0, 248.0, 257.0, 332.0, 459.0, 552.0, 510.0, 377.0, 406.0, 480.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 123.0, 200.0, 35.0, 90.0, -504.0, -86.0, 145.0, -31.0, 156.0, 35.0, -9.0, 123.0, 68.0, 123.0, 79.0, 200.0, 200.0, 200.0, 200.0, -9.0, 200.0, -20.0, 123.0, 112.0, 90.0, 200.0, 167.0, -570.0, 189.0, 200.0, 200.0, 101.0, 46.0, 200.0, 156.0, -130.0, -97.0, 90.0, 2.0, -218.0, 79.0, 145.0, 200.0, 200.0, 200.0, 200.0, 46.0, 156.0, 200.0, 24.0, 200.0, 46.0, 145.0, -31.0, 200.0, 200.0, 57.0, 145.0, 101.0, 167.0, 90.0, 13.0, 200.0, -75.0, -97.0, 200.0, 35.0, 200.0, -713.0, 123.0, -306.0, 68.0, 112.0, 189.0, -273.0, -207.0, 200.0, 200.0, 112.0, -75.0, 178.0, -383.0, -75.0, 200.0, -306.0, 68.0, 200.0, 134.0, 200.0, 200.0, 112.0, 200.0, 189.0, 156.0, 112.0, -64.0, -339.0, 46.0, 200.0, 200.0, 200.0, 178.0, 101.0, 145.0, -31.0, 46.0, -75.0, 200.0, 101.0, 200.0, -20.0, 156.0, 68.0, -97.0, 112.0, 200.0, 200.0, 200.0, 123.0, -273.0, 189.0, -9.0, 200.0, 200.0, 200.0, 200.0, -20.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, 57.0, 24.0, -53.0, 167.0, -141.0, 46.0, 189.0, 46.0, -174.0, 68.0, 200.0, -119.0, -53.0, 200.0, -20.0, -20.0, 2.0, 189.0, -97.0, 123.0, 123.0, 145.0, 134.0, 200.0, 200.0, 167.0, 156.0, 134.0, 2.0, 167.0, 134.0, 167.0, 46.0, 46.0, 189.0, 200.0, 200.0, -20.0, 189.0, 156.0, 200.0, 123.0, 200.0, 134.0, 200.0, 46.0, 35.0, 24.0, 57.0, -163.0, -174.0, -163.0, 178.0, -119.0, 200.0, 167.0, 112.0, 112.0, 101.0, 35.0, 123.0, 200.0, 46.0, 200.0, 200.0, 79.0, 200.0, 200.0, 200.0, -42.0, 200.0, 90.0, 90.0, 90.0, 200.0, 200.0, 167.0, 156.0, 200.0, 178.0, 200.0, 200.0, 200.0, 200.0, 200.0, -515.0, 200.0, 123.0, 57.0, 178.0, 24.0, 178.0, 68.0, 79.0, 13.0, -163.0, -75.0, 134.0, 57.0, 200.0, 200.0, 200.0, 200.0, 68.0, 90.0, -174.0, 200.0, 123.0, 200.0, 189.0, -9.0, 2.0, 79.0, 200.0, 189.0, -9.0, 167.0, 68.0, 35.0, 35.0, 167.0, 123.0, 200.0, 123.0, -108.0, 145.0, 189.0, 145.0, -20.0, 101.0, 200.0, 35.0, 13.0, -9.0, 35.0, 68.0, 134.0, 156.0, 101.0, -42.0, 123.0, -53.0, -702.0, 189.0, 35.0, 57.0, 57.0, 13.0, 134.0, 123.0, 167.0, 189.0, 200.0, 123.0, 101.0, 134.0, 200.0, 156.0, 13.0, 123.0, 156.0, 101.0, 24.0, 200.0, -20.0, 200.0], "policy_predator_policy_reward": [35.0, 0.0, 0.0, 355.0, 150.0, 130.0, 5.0, 170.0, 0.0, 80.0, 40.0, 80.0, 45.0, 30.0, 70.0, 55.0, 30.0, 0.0, 90.0, 45.0, 0.0, 100.0, 20.0, 15.0, 0.0, 50.0, 0.0, 0.0, 360.0, 15.0, 0.0, 45.0, 0.0, 55.0, 5.0, 85.0, 150.0, 120.0, 40.0, 135.0, 155.0, 175.0, 25.0, 0.0, 5.0, 0.0, 70.0, 20.0, 80.0, 5.0, 20.0, 70.0, 0.0, 40.0, 55.0, 40.0, 75.0, 0.0, 0.0, 65.0, 0.0, 15.0, 100.0, 0.0, 125.0, 135.0, 35.0, 45.0, 0.0, 370.0, 195.0, 140.0, 5.0, 40.0, 60.0, 0.0, 15.0, 255.0, 0.0, 125.0, 0.0, 60.0, 210.0, 140.0, 45.0, 230.0, 60.0, 15.0, 0.0, 15.0, 25.0, 0.0, 40.0, 0.0, 20.0, 40.0, 145.0, 220.0, 95.0, 0.0, 0.0, 0.0, 0.0, 40.0, 45.0, 140.0, 105.0, 70.0, 0.0, 45.0, 0.0, 60.0, 15.0, 100.0, 110.0, 85.0, 25.0, 0.0, 0.0, 35.0, 180.0, 120.0, 165.0, 0.0, 0.0, 0.0, 75.0, 50.0, 60.0, 10.0, 0.0, 0.0, 65.0, 0.0, 20.0, 40.0, 60.0, 135.0, 155.0, 0.0, 0.0, 70.0, 0.0, 215.0, 80.0, 65.0, 145.0, 90.0, 50.0, 0.0, 0.0, 35.0, 130.0, 35.0, 0.0, 45.0, 25.0, 5.0, 0.0, 15.0, 0.0, 30.0, 90.0, 90.0, 45.0, 0.0, 0.0, 140.0, 0.0, 5.0, 0.0, 65.0, 70.0, 50.0, 35.0, 0.0, 0.0, 30.0, 50.0, 70.0, 145.0, 0.0, 15.0, 210.0, 140.0, 160.0, 130.0, 55.0, 30.0, 40.0, 30.0, 0.0, 0.0, 40.0, 90.0, 70.0, 0.0, 0.0, 45.0, 10.0, 15.0, 70.0, 70.0, 65.0, 5.0, 0.0, 65.0, 0.0, 0.0, 50.0, 15.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 65.0, 315.0, 115.0, 95.0, 0.0, 60.0, 25.0, 55.0, 55.0, 150.0, 140.0, 65.0, 0.0, 55.0, 0.0, 0.0, 0.0, 35.0, 95.0, 160.0, 25.0, 35.0, 0.0, 125.0, 45.0, 5.0, 55.0, 5.0, 0.0, 95.0, 80.0, 50.0, 15.0, 20.0, 80.0, 5.0, 35.0, 35.0, 5.0, 0.0, 140.0, 65.0, 0.0, 100.0, 105.0, 0.0, 0.0, 0.0, 155.0, 20.0, 65.0, 30.0, 5.0, 70.0, 35.0, 115.0, 230.0, 115.0, 390.0, 65.0, 75.0, 65.0, 35.0, 0.0, 0.0, 0.0, 5.0, 35.0, 20.0, 55.0, 0.0, 85.0, 0.0, 0.0, 80.0, 0.0, 45.0, 75.0, 25.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.004256764263327, "mean_inference_ms": 1.712315244928146, "mean_action_processing_ms": 0.3788523418305679, "mean_env_wait_ms": 0.2656598131728229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006026268005371094, "StateBufferConnector_ms": 0.00492405891418457, "ViewRequirementAgentConnector_ms": 0.19347059726715088}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -191.0, "episode_return_mean": 419.71, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.20324187428604, "num_env_steps_trained_throughput_per_sec": 54.20324187428604, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 74089.203, "restore_workers_time_ms": 0.015, "training_step_time_ms": 74089.149, "sample_time_ms": 1553.396, "learn_time_ms": 72516.045, "learn_throughput": 55.16, "synch_weights_time_ms": 16.225}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 48, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-17-50", "timestamp": 1723490270, "time_this_iter_s": 73.85728192329407, "time_total_s": 3674.5571541786194, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2328280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3674.5571541786194, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 35.86380952380952, "ram_util_percent": 81.09809523809525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4577692269433475, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6402656873701312, "policy_loss": -0.008809309239261487, "vf_loss": 0.6482916003846108, "vf_explained_var": -4.540305611089612e-05, "kl": 0.005222598485377502, "entropy": 0.6838472465885447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 136770.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.17180037023962, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6518216364346576, "policy_loss": -0.02066481321330136, "vf_loss": 0.6711652498426831, "vf_explained_var": 0.0604263074854587, "kl": 0.006605998376782938, "entropy": 1.3001130128160436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 136770.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "env_runners": {"episode_reward_max": 602.0, "episode_reward_min": -191.0, "episode_reward_mean": 419.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -713.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 390.0}, "policy_reward_mean": {"prey_policy": 86.48, "predator_policy": 53.266666666666666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [515.0, -191.0, 474.0, -10.0, 362.0, 130.0, 297.0, 564.0, 577.0, 517.0, 103.0, 600.0, 509.0, 255.0, 546.0, 379.0, 435.0, 558.0, 372.0, 600.0, 565.0, 588.0, 542.0, 373.0, 249.0, 225.0, 318.0, 300.0, 259.0, 471.0, 564.0, 502.0, 528.0, 399.0, 594.0, 510.0, 558.0, 530.0, 276.0, 10.0, 474.0, 461.0, 389.0, 516.0, 549.0, 563.0, 450.0, 540.0, 558.0, 588.0, 600.0, 333.0, 469.0, 465.0, 120.0, 511.0, 600.0, 274.0, 583.0, 357.0, 528.0, 451.0, 352.0, 521.0, 371.0, 391.0, 353.0, 269.0, 491.0, 248.0, 257.0, 332.0, 459.0, 552.0, 510.0, 377.0, 406.0, 480.0, 540.0, 315.0, 542.0, 96.0, 387.0, 411.0, 410.0, 600.0, 328.0, 534.0, 306.0, 474.0, 455.0, 304.0, 602.0, 244.0, 481.0, 467.0, 321.0, 600.0, 368.0, 438.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 35.0, 200.0, -713.0, 123.0, -306.0, 68.0, 112.0, 189.0, -273.0, -207.0, 200.0, 200.0, 112.0, -75.0, 178.0, -383.0, -75.0, 200.0, -306.0, 68.0, 200.0, 134.0, 200.0, 200.0, 112.0, 200.0, 189.0, 156.0, 112.0, -64.0, -339.0, 46.0, 200.0, 200.0, 200.0, 178.0, 101.0, 145.0, -31.0, 46.0, -75.0, 200.0, 101.0, 200.0, -20.0, 156.0, 68.0, -97.0, 112.0, 200.0, 200.0, 200.0, 123.0, -273.0, 189.0, -9.0, 200.0, 200.0, 200.0, 200.0, -20.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, 57.0, 24.0, -53.0, 167.0, -141.0, 46.0, 189.0, 46.0, -174.0, 68.0, 200.0, -119.0, -53.0, 200.0, -20.0, -20.0, 2.0, 189.0, -97.0, 123.0, 123.0, 145.0, 134.0, 200.0, 200.0, 167.0, 156.0, 134.0, 2.0, 167.0, 134.0, 167.0, 46.0, 46.0, 189.0, 200.0, 200.0, -20.0, 189.0, 156.0, 200.0, 123.0, 200.0, 134.0, 200.0, 46.0, 35.0, 24.0, 57.0, -163.0, -174.0, -163.0, 178.0, -119.0, 200.0, 167.0, 112.0, 112.0, 101.0, 35.0, 123.0, 200.0, 46.0, 200.0, 200.0, 79.0, 200.0, 200.0, 200.0, -42.0, 200.0, 90.0, 90.0, 90.0, 200.0, 200.0, 167.0, 156.0, 200.0, 178.0, 200.0, 200.0, 200.0, 200.0, 200.0, -515.0, 200.0, 123.0, 57.0, 178.0, 24.0, 178.0, 68.0, 79.0, 13.0, -163.0, -75.0, 134.0, 57.0, 200.0, 200.0, 200.0, 200.0, 68.0, 90.0, -174.0, 200.0, 123.0, 200.0, 189.0, -9.0, 2.0, 79.0, 200.0, 189.0, -9.0, 167.0, 68.0, 35.0, 35.0, 167.0, 123.0, 200.0, 123.0, -108.0, 145.0, 189.0, 145.0, -20.0, 101.0, 200.0, 35.0, 13.0, -9.0, 35.0, 68.0, 134.0, 156.0, 101.0, -42.0, 123.0, -53.0, -702.0, 189.0, 35.0, 57.0, 57.0, 13.0, 134.0, 123.0, 167.0, 189.0, 200.0, 123.0, 101.0, 134.0, 200.0, 156.0, 13.0, 123.0, 156.0, 101.0, 24.0, 200.0, -20.0, 200.0, 90.0, 200.0, 200.0, -152.0, 79.0, 68.0, 167.0, 145.0, 200.0, 46.0, -317.0, 57.0, -152.0, 24.0, 200.0, 90.0, 123.0, -97.0, -64.0, 145.0, 189.0, 200.0, 200.0, 200.0, 35.0, 200.0, -152.0, 79.0, 200.0, 200.0, -31.0, 200.0, -53.0, 79.0, 90.0, 200.0, 178.0, 57.0, 145.0, 35.0, 79.0, 35.0, 167.0, 200.0, 200.0, -9.0, 178.0, -75.0, -9.0, 200.0, -20.0, 200.0, 145.0, 57.0, 101.0, 200.0, -130.0, 200.0, 200.0, 200.0, 178.0, -185.0, 200.0, 2.0, 101.0, 200.0], "policy_predator_policy_reward": [35.0, 45.0, 0.0, 370.0, 195.0, 140.0, 5.0, 40.0, 60.0, 0.0, 15.0, 255.0, 0.0, 125.0, 0.0, 60.0, 210.0, 140.0, 45.0, 230.0, 60.0, 15.0, 0.0, 15.0, 25.0, 0.0, 40.0, 0.0, 20.0, 40.0, 145.0, 220.0, 95.0, 0.0, 0.0, 0.0, 0.0, 40.0, 45.0, 140.0, 105.0, 70.0, 0.0, 45.0, 0.0, 60.0, 15.0, 100.0, 110.0, 85.0, 25.0, 0.0, 0.0, 35.0, 180.0, 120.0, 165.0, 0.0, 0.0, 0.0, 75.0, 50.0, 60.0, 10.0, 0.0, 0.0, 65.0, 0.0, 20.0, 40.0, 60.0, 135.0, 155.0, 0.0, 0.0, 70.0, 0.0, 215.0, 80.0, 65.0, 145.0, 90.0, 50.0, 0.0, 0.0, 35.0, 130.0, 35.0, 0.0, 45.0, 25.0, 5.0, 0.0, 15.0, 0.0, 30.0, 90.0, 90.0, 45.0, 0.0, 0.0, 140.0, 0.0, 5.0, 0.0, 65.0, 70.0, 50.0, 35.0, 0.0, 0.0, 30.0, 50.0, 70.0, 145.0, 0.0, 15.0, 210.0, 140.0, 160.0, 130.0, 55.0, 30.0, 40.0, 30.0, 0.0, 0.0, 40.0, 90.0, 70.0, 0.0, 0.0, 45.0, 10.0, 15.0, 70.0, 70.0, 65.0, 5.0, 0.0, 65.0, 0.0, 0.0, 50.0, 15.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 65.0, 315.0, 115.0, 95.0, 0.0, 60.0, 25.0, 55.0, 55.0, 150.0, 140.0, 65.0, 0.0, 55.0, 0.0, 0.0, 0.0, 35.0, 95.0, 160.0, 25.0, 35.0, 0.0, 125.0, 45.0, 5.0, 55.0, 5.0, 0.0, 95.0, 80.0, 50.0, 15.0, 20.0, 80.0, 5.0, 35.0, 35.0, 5.0, 0.0, 140.0, 65.0, 0.0, 100.0, 105.0, 0.0, 0.0, 0.0, 155.0, 20.0, 65.0, 30.0, 5.0, 70.0, 35.0, 115.0, 230.0, 115.0, 390.0, 65.0, 75.0, 65.0, 35.0, 0.0, 0.0, 0.0, 5.0, 35.0, 20.0, 55.0, 0.0, 85.0, 0.0, 0.0, 80.0, 0.0, 45.0, 75.0, 25.0, 0.0, 50.0, 0.0, 0.0, 235.0, 30.0, 55.0, 5.0, 25.0, 0.0, 235.0, 70.0, 5.0, 100.0, 160.0, 55.0, 115.0, 130.0, 50.0, 120.0, 15.0, 5.0, 0.0, 0.0, 0.0, 80.0, 75.0, 90.0, 0.0, 55.0, 0.0, 170.0, 20.0, 0.0, 20.0, 0.0, 85.0, 0.0, 75.0, 0.0, 80.0, 75.0, 0.0, 15.0, 5.0, 15.0, 55.0, 0.0, 95.0, 70.0, 95.0, 145.0, 0.0, 0.0, 65.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 125.0, 45.0, 5.0, 95.0, 0.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.005259614389077, "mean_inference_ms": 1.7113702993934252, "mean_action_processing_ms": 0.3791779268997874, "mean_env_wait_ms": 0.26577907082475805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006512165069580078, "StateBufferConnector_ms": 0.0047605037689208984, "ViewRequirementAgentConnector_ms": 0.17707324028015137}, "num_episodes": 22, "episode_return_max": 602.0, "episode_return_min": -191.0, "episode_return_mean": 419.24, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 52.994726042367915, "num_env_steps_trained_throughput_per_sec": 52.994726042367915, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 1176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 74393.03, "restore_workers_time_ms": 0.015, "training_step_time_ms": 74392.982, "sample_time_ms": 1583.344, "learn_time_ms": 72790.447, "learn_throughput": 54.952, "synch_weights_time_ms": 15.705}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "training_iteration": 49, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-19-05", "timestamp": 1723490345, "time_this_iter_s": 75.50524115562439, "time_total_s": 3750.062395334244, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b106b940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3750.062395334244, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 37.44245283018868, "ram_util_percent": 82.20471698113208}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4980623014746828, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6267226764337813, "policy_loss": -0.007039007842738895, "vf_loss": 0.6328697710568811, "vf_explained_var": -0.00011072535041376209, "kl": 0.0059460428259495365, "entropy": 0.6888278735867629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 139590.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.388976349084513, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6775146655100134, "policy_loss": -0.018998346932509794, "vf_loss": 0.6953574496143041, "vf_explained_var": 0.03476800261237097, "kl": 0.005777817139565379, "entropy": 1.323211486246569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 139590.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 602.0, "episode_reward_min": 10.0, "episode_reward_mean": 424.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -702.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 390.0}, "policy_reward_mean": {"prey_policy": 91.35666666666667, "predator_policy": 50.03333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.0, 249.0, 225.0, 318.0, 300.0, 259.0, 471.0, 564.0, 502.0, 528.0, 399.0, 594.0, 510.0, 558.0, 530.0, 276.0, 10.0, 474.0, 461.0, 389.0, 516.0, 549.0, 563.0, 450.0, 540.0, 558.0, 588.0, 600.0, 333.0, 469.0, 465.0, 120.0, 511.0, 600.0, 274.0, 583.0, 357.0, 528.0, 451.0, 352.0, 521.0, 371.0, 391.0, 353.0, 269.0, 491.0, 248.0, 257.0, 332.0, 459.0, 552.0, 510.0, 377.0, 406.0, 480.0, 540.0, 315.0, 542.0, 96.0, 387.0, 411.0, 410.0, 600.0, 328.0, 534.0, 306.0, 474.0, 455.0, 304.0, 602.0, 244.0, 481.0, 467.0, 321.0, 600.0, 368.0, 438.0, 427.0, 558.0, 594.0, 561.0, 501.0, 36.0, 564.0, 400.0, 403.0, 399.0, 367.0, 210.0, 508.0, 392.0, 42.0, 492.0, 572.0, 507.0, 404.0, 324.0, 572.0, 401.0, 546.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [24.0, -53.0, 167.0, -141.0, 46.0, 189.0, 46.0, -174.0, 68.0, 200.0, -119.0, -53.0, 200.0, -20.0, -20.0, 2.0, 189.0, -97.0, 123.0, 123.0, 145.0, 134.0, 200.0, 200.0, 167.0, 156.0, 134.0, 2.0, 167.0, 134.0, 167.0, 46.0, 46.0, 189.0, 200.0, 200.0, -20.0, 189.0, 156.0, 200.0, 123.0, 200.0, 134.0, 200.0, 46.0, 35.0, 24.0, 57.0, -163.0, -174.0, -163.0, 178.0, -119.0, 200.0, 167.0, 112.0, 112.0, 101.0, 35.0, 123.0, 200.0, 46.0, 200.0, 200.0, 79.0, 200.0, 200.0, 200.0, -42.0, 200.0, 90.0, 90.0, 90.0, 200.0, 200.0, 167.0, 156.0, 200.0, 178.0, 200.0, 200.0, 200.0, 200.0, 200.0, -515.0, 200.0, 123.0, 57.0, 178.0, 24.0, 178.0, 68.0, 79.0, 13.0, -163.0, -75.0, 134.0, 57.0, 200.0, 200.0, 200.0, 200.0, 68.0, 90.0, -174.0, 200.0, 123.0, 200.0, 189.0, -9.0, 2.0, 79.0, 200.0, 189.0, -9.0, 167.0, 68.0, 35.0, 35.0, 167.0, 123.0, 200.0, 123.0, -108.0, 145.0, 189.0, 145.0, -20.0, 101.0, 200.0, 35.0, 13.0, -9.0, 35.0, 68.0, 134.0, 156.0, 101.0, -42.0, 123.0, -53.0, -702.0, 189.0, 35.0, 57.0, 57.0, 13.0, 134.0, 123.0, 167.0, 189.0, 200.0, 123.0, 101.0, 134.0, 200.0, 156.0, 13.0, 123.0, 156.0, 101.0, 24.0, 200.0, -20.0, 200.0, 90.0, 200.0, 200.0, -152.0, 79.0, 68.0, 167.0, 145.0, 200.0, 46.0, -317.0, 57.0, -152.0, 24.0, 200.0, 90.0, 123.0, -97.0, -64.0, 145.0, 189.0, 200.0, 200.0, 200.0, 35.0, 200.0, -152.0, 79.0, 200.0, 200.0, -31.0, 200.0, -53.0, 79.0, 90.0, 200.0, 178.0, 57.0, 145.0, 35.0, 79.0, 35.0, 167.0, 200.0, 200.0, -9.0, 178.0, -75.0, -9.0, 200.0, -20.0, 200.0, 145.0, 57.0, 101.0, 200.0, -130.0, 200.0, 200.0, 200.0, 178.0, -185.0, 200.0, 2.0, 101.0, 200.0, 189.0, 79.0, 24.0, 123.0, 200.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -64.0, 145.0, 112.0, 189.0, 123.0, -9.0, -383.0, 200.0, 200.0, 24.0, 134.0, 35.0, 46.0, 2.0, 156.0, 35.0, -108.0, 101.0, 156.0, 57.0, 145.0, 90.0, 46.0, 46.0, 13.0, 200.0, 145.0, 68.0, 90.0, 46.0, 101.0, 46.0, -42.0, -152.0, 200.0, 2.0, 200.0, 200.0, 200.0, 112.0, 145.0, 200.0, 57.0, 178.0, 90.0, 46.0, -42.0, 46.0, 200.0, -262.0, 189.0, 200.0, 134.0, 178.0, -86.0, 101.0, 200.0, 200.0], "policy_predator_policy_reward": [40.0, 60.0, 135.0, 155.0, 0.0, 0.0, 70.0, 0.0, 215.0, 80.0, 65.0, 145.0, 90.0, 50.0, 0.0, 0.0, 35.0, 130.0, 35.0, 0.0, 45.0, 25.0, 5.0, 0.0, 15.0, 0.0, 30.0, 90.0, 90.0, 45.0, 0.0, 0.0, 140.0, 0.0, 5.0, 0.0, 65.0, 70.0, 50.0, 35.0, 0.0, 0.0, 30.0, 50.0, 70.0, 145.0, 0.0, 15.0, 210.0, 140.0, 160.0, 130.0, 55.0, 30.0, 40.0, 30.0, 0.0, 0.0, 40.0, 90.0, 70.0, 0.0, 0.0, 45.0, 10.0, 15.0, 70.0, 70.0, 65.0, 5.0, 0.0, 65.0, 0.0, 0.0, 50.0, 15.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 65.0, 315.0, 115.0, 95.0, 0.0, 60.0, 25.0, 55.0, 55.0, 150.0, 140.0, 65.0, 0.0, 55.0, 0.0, 0.0, 0.0, 35.0, 95.0, 160.0, 25.0, 35.0, 0.0, 125.0, 45.0, 5.0, 55.0, 5.0, 0.0, 95.0, 80.0, 50.0, 15.0, 20.0, 80.0, 5.0, 35.0, 35.0, 5.0, 0.0, 140.0, 65.0, 0.0, 100.0, 105.0, 0.0, 0.0, 0.0, 155.0, 20.0, 65.0, 30.0, 5.0, 70.0, 35.0, 115.0, 230.0, 115.0, 390.0, 65.0, 75.0, 65.0, 35.0, 0.0, 0.0, 0.0, 5.0, 35.0, 20.0, 55.0, 0.0, 85.0, 0.0, 0.0, 80.0, 0.0, 45.0, 75.0, 25.0, 0.0, 50.0, 0.0, 0.0, 235.0, 30.0, 55.0, 5.0, 25.0, 0.0, 235.0, 70.0, 5.0, 100.0, 160.0, 55.0, 115.0, 130.0, 50.0, 120.0, 15.0, 5.0, 0.0, 0.0, 0.0, 80.0, 75.0, 90.0, 0.0, 55.0, 0.0, 170.0, 20.0, 0.0, 20.0, 0.0, 85.0, 0.0, 75.0, 0.0, 80.0, 75.0, 0.0, 15.0, 5.0, 15.0, 55.0, 0.0, 95.0, 70.0, 95.0, 145.0, 0.0, 0.0, 65.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 125.0, 45.0, 5.0, 95.0, 0.0, 40.0, 50.0, 5.0, 80.0, 0.0, 0.0, 35.0, 5.0, 0.0, 0.0, 50.0, 120.0, 55.0, 0.0, 55.0, 0.0, 270.0, 15.0, 20.0, 0.0, 75.0, 65.0, 95.0, 60.0, 30.0, 90.0, 30.0, 90.0, 45.0, 140.0, 65.0, 5.0, 60.0, 10.0, 0.0, 0.0, 105.0, 60.0, 5.0, 30.0, 50.0, 10.0, 95.0, 160.0, 5.0, 25.0, 5.0, 85.0, 0.0, 0.0, 20.0, 40.0, 0.0, 45.0, 60.0, 10.0, 80.0, 0.0, 15.0, 100.0, 5.0, 115.0, 190.0, 140.0, 10.0, 35.0, 130.0, 40.0, 0.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0050335253518161, "mean_inference_ms": 1.7084421118056259, "mean_action_processing_ms": 0.37860008307330445, "mean_env_wait_ms": 0.26574494128552356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006640315055847168, "StateBufferConnector_ms": 0.0038704872131347656, "ViewRequirementAgentConnector_ms": 0.16514134407043457}, "num_episodes": 23, "episode_return_max": 602.0, "episode_return_min": 10.0, "episode_return_mean": 424.17, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.22991214334001, "num_env_steps_trained_throughput_per_sec": 54.22991214334001, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 74324.333, "restore_workers_time_ms": 0.015, "training_step_time_ms": 74324.283, "sample_time_ms": 1584.608, "learn_time_ms": 72720.568, "learn_throughput": 55.005, "synch_weights_time_ms": 15.323}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 50, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-20-19", "timestamp": 1723490419, "time_this_iter_s": 73.81263732910156, "time_total_s": 3823.8750326633453, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b231baf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3823.8750326633453, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 33.0647619047619, "ram_util_percent": 82.12761904761902}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4993206030193795, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4914037635985842, "policy_loss": -0.008638492271866392, "vf_loss": 1.49912396128296, "vf_explained_var": 2.1564622297354623e-06, "kl": 0.006121726107477867, "entropy": 0.7162722465839791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 142410.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.851997340771746, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0762230051509667, "policy_loss": -0.022466524446495405, "vf_loss": 1.097532788732796, "vf_explained_var": 0.051931033235915164, "kl": 0.005783707066846407, "entropy": 1.3218807532009504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 142410.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "env_runners": {"episode_reward_max": 609.0, "episode_reward_min": -204.0, "episode_reward_mean": 416.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -834.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 420.0}, "policy_reward_mean": {"prey_policy": 79.69666666666667, "predator_policy": 59.28333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [461.0, 389.0, 516.0, 549.0, 563.0, 450.0, 540.0, 558.0, 588.0, 600.0, 333.0, 469.0, 465.0, 120.0, 511.0, 600.0, 274.0, 583.0, 357.0, 528.0, 451.0, 352.0, 521.0, 371.0, 391.0, 353.0, 269.0, 491.0, 248.0, 257.0, 332.0, 459.0, 552.0, 510.0, 377.0, 406.0, 480.0, 540.0, 315.0, 542.0, 96.0, 387.0, 411.0, 410.0, 600.0, 328.0, 534.0, 306.0, 474.0, 455.0, 304.0, 602.0, 244.0, 481.0, 467.0, 321.0, 600.0, 368.0, 438.0, 427.0, 558.0, 594.0, 561.0, 501.0, 36.0, 564.0, 400.0, 403.0, 399.0, 367.0, 210.0, 508.0, 392.0, 42.0, 492.0, 572.0, 507.0, 404.0, 324.0, 572.0, 401.0, 546.0, 479.0, 480.0, 432.0, 383.0, 484.0, 609.0, 280.0, 230.0, 342.0, 316.0, -204.0, 456.0, 123.0, 497.0, 503.0, 279.0, 424.0, 304.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [167.0, 112.0, 112.0, 101.0, 35.0, 123.0, 200.0, 46.0, 200.0, 200.0, 79.0, 200.0, 200.0, 200.0, -42.0, 200.0, 90.0, 90.0, 90.0, 200.0, 200.0, 167.0, 156.0, 200.0, 178.0, 200.0, 200.0, 200.0, 200.0, 200.0, -515.0, 200.0, 123.0, 57.0, 178.0, 24.0, 178.0, 68.0, 79.0, 13.0, -163.0, -75.0, 134.0, 57.0, 200.0, 200.0, 200.0, 200.0, 68.0, 90.0, -174.0, 200.0, 123.0, 200.0, 189.0, -9.0, 2.0, 79.0, 200.0, 189.0, -9.0, 167.0, 68.0, 35.0, 35.0, 167.0, 123.0, 200.0, 123.0, -108.0, 145.0, 189.0, 145.0, -20.0, 101.0, 200.0, 35.0, 13.0, -9.0, 35.0, 68.0, 134.0, 156.0, 101.0, -42.0, 123.0, -53.0, -702.0, 189.0, 35.0, 57.0, 57.0, 13.0, 134.0, 123.0, 167.0, 189.0, 200.0, 123.0, 101.0, 134.0, 200.0, 156.0, 13.0, 123.0, 156.0, 101.0, 24.0, 200.0, -20.0, 200.0, 90.0, 200.0, 200.0, -152.0, 79.0, 68.0, 167.0, 145.0, 200.0, 46.0, -317.0, 57.0, -152.0, 24.0, 200.0, 90.0, 123.0, -97.0, -64.0, 145.0, 189.0, 200.0, 200.0, 200.0, 35.0, 200.0, -152.0, 79.0, 200.0, 200.0, -31.0, 200.0, -53.0, 79.0, 90.0, 200.0, 178.0, 57.0, 145.0, 35.0, 79.0, 35.0, 167.0, 200.0, 200.0, -9.0, 178.0, -75.0, -9.0, 200.0, -20.0, 200.0, 145.0, 57.0, 101.0, 200.0, -130.0, 200.0, 200.0, 200.0, 178.0, -185.0, 200.0, 2.0, 101.0, 200.0, 189.0, 79.0, 24.0, 123.0, 200.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -64.0, 145.0, 112.0, 189.0, 123.0, -9.0, -383.0, 200.0, 200.0, 24.0, 134.0, 35.0, 46.0, 2.0, 156.0, 35.0, -108.0, 101.0, 156.0, 57.0, 145.0, 90.0, 46.0, 46.0, 13.0, 200.0, 145.0, 68.0, 90.0, 46.0, 101.0, 46.0, -42.0, -152.0, 200.0, 2.0, 200.0, 200.0, 200.0, 112.0, 145.0, 200.0, 57.0, 178.0, 90.0, 46.0, -42.0, 46.0, 200.0, -262.0, 189.0, 200.0, 134.0, 178.0, -86.0, 101.0, 200.0, 200.0, 167.0, 13.0, 189.0, -647.0, 79.0, 68.0, 46.0, -119.0, 200.0, -9.0, -262.0, 134.0, 200.0, 156.0, 68.0, 200.0, 24.0, 200.0, 35.0, 13.0, 57.0, 200.0, -196.0, -834.0, 123.0, 90.0, -86.0, -42.0, 13.0, 145.0, -174.0, -119.0, -141.0, -240.0, 200.0, 46.0, -75.0, -42.0, -20.0, -53.0, 200.0, 200.0, 134.0, 24.0, 200.0, 200.0, -64.0, -262.0, 200.0, 2.0, 57.0, 35.0, -20.0, 79.0], "policy_predator_policy_reward": [40.0, 30.0, 0.0, 0.0, 40.0, 90.0, 70.0, 0.0, 0.0, 45.0, 10.0, 15.0, 70.0, 70.0, 65.0, 5.0, 0.0, 65.0, 0.0, 0.0, 50.0, 15.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 65.0, 315.0, 115.0, 95.0, 0.0, 60.0, 25.0, 55.0, 55.0, 150.0, 140.0, 65.0, 0.0, 55.0, 0.0, 0.0, 0.0, 35.0, 95.0, 160.0, 25.0, 35.0, 0.0, 125.0, 45.0, 5.0, 55.0, 5.0, 0.0, 95.0, 80.0, 50.0, 15.0, 20.0, 80.0, 5.0, 35.0, 35.0, 5.0, 0.0, 140.0, 65.0, 0.0, 100.0, 105.0, 0.0, 0.0, 0.0, 155.0, 20.0, 65.0, 30.0, 5.0, 70.0, 35.0, 115.0, 230.0, 115.0, 390.0, 65.0, 75.0, 65.0, 35.0, 0.0, 0.0, 0.0, 5.0, 35.0, 20.0, 55.0, 0.0, 85.0, 0.0, 0.0, 80.0, 0.0, 45.0, 75.0, 25.0, 0.0, 50.0, 0.0, 0.0, 235.0, 30.0, 55.0, 5.0, 25.0, 0.0, 235.0, 70.0, 5.0, 100.0, 160.0, 55.0, 115.0, 130.0, 50.0, 120.0, 15.0, 5.0, 0.0, 0.0, 0.0, 80.0, 75.0, 90.0, 0.0, 55.0, 0.0, 170.0, 20.0, 0.0, 20.0, 0.0, 85.0, 0.0, 75.0, 0.0, 80.0, 75.0, 0.0, 15.0, 5.0, 15.0, 55.0, 0.0, 95.0, 70.0, 95.0, 145.0, 0.0, 0.0, 65.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 125.0, 45.0, 5.0, 95.0, 0.0, 40.0, 50.0, 5.0, 80.0, 0.0, 0.0, 35.0, 5.0, 0.0, 0.0, 50.0, 120.0, 55.0, 0.0, 55.0, 0.0, 270.0, 15.0, 20.0, 0.0, 75.0, 65.0, 95.0, 60.0, 30.0, 90.0, 30.0, 90.0, 45.0, 140.0, 65.0, 5.0, 60.0, 10.0, 0.0, 0.0, 105.0, 60.0, 5.0, 30.0, 50.0, 10.0, 95.0, 160.0, 5.0, 25.0, 5.0, 85.0, 0.0, 0.0, 20.0, 40.0, 0.0, 45.0, 60.0, 10.0, 80.0, 0.0, 15.0, 100.0, 5.0, 115.0, 190.0, 140.0, 10.0, 35.0, 130.0, 40.0, 0.0, 5.0, 10.0, 85.0, 15.0, 380.0, 340.0, 260.0, 155.0, 150.0, 0.0, 170.0, 140.0, 210.0, 0.0, 60.0, 0.0, 65.0, 65.0, 55.0, 30.0, 85.0, 60.0, 330.0, 420.0, 310.0, 165.0, 0.0, 50.0, 85.0, 90.0, 25.0, 60.0, 170.0, 0.0, 100.0, 170.0, 180.0, 155.0, 0.0, 105.0, 40.0, 50.0, 60.0, 80.0, 15.0, 50.0, 215.0, 10.0, 180.0, 60.0, 105.0, 0.0, 70.0, 20.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0039084786571422, "mean_inference_ms": 1.70643352909277, "mean_action_processing_ms": 0.37830367636022944, "mean_env_wait_ms": 0.26584261309585755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00629115104675293, "StateBufferConnector_ms": 0.0038985013961791992, "ViewRequirementAgentConnector_ms": 0.1670321226119995}, "num_episodes": 18, "episode_return_max": 609.0, "episode_return_min": -204.0, "episode_return_mean": 416.94, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.40671991812966, "num_env_steps_trained_throughput_per_sec": 54.40671991812966, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 1224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 74039.961, "restore_workers_time_ms": 0.014, "training_step_time_ms": 74039.912, "sample_time_ms": 1574.386, "learn_time_ms": 72447.005, "learn_throughput": 55.213, "synch_weights_time_ms": 15.007}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "training_iteration": 51, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-21-33", "timestamp": 1723490493, "time_this_iter_s": 73.54496002197266, "time_total_s": 3897.419992685318, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b104cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3897.419992685318, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 34.14807692307692, "ram_util_percent": 82.30576923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.209046012533049, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4515905783214468, "policy_loss": -0.008450512578611838, "vf_loss": 0.45923015474104634, "vf_explained_var": 0.0006346824955432973, "kl": 0.005406194323680094, "entropy": 0.6697192063568331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 145230.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.5401468819760264, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3965016768289175, "policy_loss": -0.016360862920282025, "vf_loss": 0.41188197791253767, "vf_explained_var": 0.058688547911373436, "kl": 0.004902810042560936, "entropy": 1.2895106892213755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 145230.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 609.0, "episode_reward_min": -204.0, "episode_reward_mean": 421.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -834.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 420.0}, "policy_reward_mean": {"prey_policy": 81.89666666666666, "predator_policy": 58.71666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.0, 528.0, 451.0, 352.0, 521.0, 371.0, 391.0, 353.0, 269.0, 491.0, 248.0, 257.0, 332.0, 459.0, 552.0, 510.0, 377.0, 406.0, 480.0, 540.0, 315.0, 542.0, 96.0, 387.0, 411.0, 410.0, 600.0, 328.0, 534.0, 306.0, 474.0, 455.0, 304.0, 602.0, 244.0, 481.0, 467.0, 321.0, 600.0, 368.0, 438.0, 427.0, 558.0, 594.0, 561.0, 501.0, 36.0, 564.0, 400.0, 403.0, 399.0, 367.0, 210.0, 508.0, 392.0, 42.0, 492.0, 572.0, 507.0, 404.0, 324.0, 572.0, 401.0, 546.0, 479.0, 480.0, 432.0, 383.0, 484.0, 609.0, 280.0, 230.0, 342.0, 316.0, -204.0, 456.0, 123.0, 497.0, 503.0, 279.0, 424.0, 304.0, 478.0, 528.0, 581.0, 431.0, 432.0, 570.0, 534.0, 549.0, 443.0, 600.0, 469.0, 563.0, 327.0, 574.0, 276.0, 582.0, 546.0, 576.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [189.0, -9.0, 2.0, 79.0, 200.0, 189.0, -9.0, 167.0, 68.0, 35.0, 35.0, 167.0, 123.0, 200.0, 123.0, -108.0, 145.0, 189.0, 145.0, -20.0, 101.0, 200.0, 35.0, 13.0, -9.0, 35.0, 68.0, 134.0, 156.0, 101.0, -42.0, 123.0, -53.0, -702.0, 189.0, 35.0, 57.0, 57.0, 13.0, 134.0, 123.0, 167.0, 189.0, 200.0, 123.0, 101.0, 134.0, 200.0, 156.0, 13.0, 123.0, 156.0, 101.0, 24.0, 200.0, -20.0, 200.0, 90.0, 200.0, 200.0, -152.0, 79.0, 68.0, 167.0, 145.0, 200.0, 46.0, -317.0, 57.0, -152.0, 24.0, 200.0, 90.0, 123.0, -97.0, -64.0, 145.0, 189.0, 200.0, 200.0, 200.0, 35.0, 200.0, -152.0, 79.0, 200.0, 200.0, -31.0, 200.0, -53.0, 79.0, 90.0, 200.0, 178.0, 57.0, 145.0, 35.0, 79.0, 35.0, 167.0, 200.0, 200.0, -9.0, 178.0, -75.0, -9.0, 200.0, -20.0, 200.0, 145.0, 57.0, 101.0, 200.0, -130.0, 200.0, 200.0, 200.0, 178.0, -185.0, 200.0, 2.0, 101.0, 200.0, 189.0, 79.0, 24.0, 123.0, 200.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -64.0, 145.0, 112.0, 189.0, 123.0, -9.0, -383.0, 200.0, 200.0, 24.0, 134.0, 35.0, 46.0, 2.0, 156.0, 35.0, -108.0, 101.0, 156.0, 57.0, 145.0, 90.0, 46.0, 46.0, 13.0, 200.0, 145.0, 68.0, 90.0, 46.0, 101.0, 46.0, -42.0, -152.0, 200.0, 2.0, 200.0, 200.0, 200.0, 112.0, 145.0, 200.0, 57.0, 178.0, 90.0, 46.0, -42.0, 46.0, 200.0, -262.0, 189.0, 200.0, 134.0, 178.0, -86.0, 101.0, 200.0, 200.0, 167.0, 13.0, 189.0, -647.0, 79.0, 68.0, 46.0, -119.0, 200.0, -9.0, -262.0, 134.0, 200.0, 156.0, 68.0, 200.0, 24.0, 200.0, 35.0, 13.0, 57.0, 200.0, -196.0, -834.0, 123.0, 90.0, -86.0, -42.0, 13.0, 145.0, -174.0, -119.0, -141.0, -240.0, 200.0, 46.0, -75.0, -42.0, -20.0, -53.0, 200.0, 200.0, 134.0, 24.0, 200.0, 200.0, -64.0, -262.0, 200.0, 2.0, 57.0, 35.0, -20.0, 79.0, 90.0, 112.0, -119.0, 200.0, 200.0, 68.0, 200.0, 178.0, 178.0, 178.0, 90.0, 68.0, 13.0, 79.0, 200.0, 156.0, 189.0, 200.0, 189.0, 101.0, 189.0, 200.0, 24.0, 200.0, -240.0, 200.0, 68.0, 200.0, 200.0, 200.0, -64.0, 123.0, 200.0, 46.0, 200.0, 167.0, -42.0, 101.0, 123.0, 156.0, 178.0, 200.0, 24.0, -42.0, 24.0, 189.0, 200.0, 178.0, 200.0, 200.0, 101.0, 200.0, 156.0, 200.0], "policy_predator_policy_reward": [125.0, 45.0, 5.0, 55.0, 5.0, 0.0, 95.0, 80.0, 50.0, 15.0, 20.0, 80.0, 5.0, 35.0, 35.0, 5.0, 0.0, 140.0, 65.0, 0.0, 100.0, 105.0, 0.0, 0.0, 0.0, 155.0, 20.0, 65.0, 30.0, 5.0, 70.0, 35.0, 115.0, 230.0, 115.0, 390.0, 65.0, 75.0, 65.0, 35.0, 0.0, 0.0, 0.0, 5.0, 35.0, 20.0, 55.0, 0.0, 85.0, 0.0, 0.0, 80.0, 0.0, 45.0, 75.0, 25.0, 0.0, 50.0, 0.0, 0.0, 235.0, 30.0, 55.0, 5.0, 25.0, 0.0, 235.0, 70.0, 5.0, 100.0, 160.0, 55.0, 115.0, 130.0, 50.0, 120.0, 15.0, 5.0, 0.0, 0.0, 0.0, 80.0, 75.0, 90.0, 0.0, 55.0, 0.0, 170.0, 20.0, 0.0, 20.0, 0.0, 85.0, 0.0, 75.0, 0.0, 80.0, 75.0, 0.0, 15.0, 5.0, 15.0, 55.0, 0.0, 95.0, 70.0, 95.0, 145.0, 0.0, 0.0, 65.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 125.0, 45.0, 5.0, 95.0, 0.0, 40.0, 50.0, 5.0, 80.0, 0.0, 0.0, 35.0, 5.0, 0.0, 0.0, 50.0, 120.0, 55.0, 0.0, 55.0, 0.0, 270.0, 15.0, 20.0, 0.0, 75.0, 65.0, 95.0, 60.0, 30.0, 90.0, 30.0, 90.0, 45.0, 140.0, 65.0, 5.0, 60.0, 10.0, 0.0, 0.0, 105.0, 60.0, 5.0, 30.0, 50.0, 10.0, 95.0, 160.0, 5.0, 25.0, 5.0, 85.0, 0.0, 0.0, 20.0, 40.0, 0.0, 45.0, 60.0, 10.0, 80.0, 0.0, 15.0, 100.0, 5.0, 115.0, 190.0, 140.0, 10.0, 35.0, 130.0, 40.0, 0.0, 5.0, 10.0, 85.0, 15.0, 380.0, 340.0, 260.0, 155.0, 150.0, 0.0, 170.0, 140.0, 210.0, 0.0, 60.0, 0.0, 65.0, 65.0, 55.0, 30.0, 85.0, 60.0, 330.0, 420.0, 310.0, 165.0, 0.0, 50.0, 85.0, 90.0, 25.0, 60.0, 170.0, 0.0, 100.0, 170.0, 180.0, 155.0, 0.0, 105.0, 40.0, 50.0, 60.0, 80.0, 15.0, 50.0, 215.0, 10.0, 180.0, 60.0, 105.0, 0.0, 70.0, 20.0, 120.0, 115.0, 180.0, 100.0, 10.0, 0.0, 50.0, 15.0, 10.0, 0.0, 10.0, 60.0, 25.0, 85.0, 25.0, 30.0, 20.0, 0.0, 5.0, 45.0, 10.0, 0.0, 65.0, 55.0, 5.0, 115.0, 115.0, 185.0, 0.0, 0.0, 0.0, 60.0, 100.0, 50.0, 45.0, 60.0, 45.0, 0.0, 35.0, 110.0, 0.0, 20.0, 20.0, 135.0, 55.0, 80.0, 0.0, 5.0, 10.0, 45.0, 0.0, 0.0, 0.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0019829896296215, "mean_inference_ms": 1.7025705213532418, "mean_action_processing_ms": 0.3778433323031517, "mean_env_wait_ms": 0.2655301797263545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005880594253540039, "StateBufferConnector_ms": 0.004221677780151367, "ViewRequirementAgentConnector_ms": 0.15167009830474854}, "num_episodes": 18, "episode_return_max": 609.0, "episode_return_min": -204.0, "episode_return_mean": 421.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.594323952273584, "num_env_steps_trained_throughput_per_sec": 54.594323952273584, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 73991.623, "restore_workers_time_ms": 0.014, "training_step_time_ms": 73991.574, "sample_time_ms": 1576.171, "learn_time_ms": 72397.597, "learn_throughput": 55.25, "synch_weights_time_ms": 14.155}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 52, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-22-46", "timestamp": 1723490566, "time_this_iter_s": 73.31737613677979, "time_total_s": 3970.737368822098, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b23211f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3970.737368822098, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 33.48834951456311, "ram_util_percent": 82.47087378640776}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.263879154004315, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6898838647608216, "policy_loss": -0.007043281099957196, "vf_loss": 0.6960057502995569, "vf_explained_var": 4.966419639316856e-07, "kl": 0.006142537037102057, "entropy": 0.68204444067698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 148050.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0459290684062115, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5456215156664567, "policy_loss": -0.017777435454327972, "vf_loss": 0.5628294189667296, "vf_explained_var": 0.045287097282443484, "kl": 0.005695330823083323, "entropy": 1.2677291682848693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 148050.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "env_runners": {"episode_reward_max": 609.0, "episode_reward_min": -204.0, "episode_reward_mean": 428.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -834.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 420.0}, "policy_reward_mean": {"prey_policy": 84.79333333333334, "predator_policy": 58.18333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [480.0, 540.0, 315.0, 542.0, 96.0, 387.0, 411.0, 410.0, 600.0, 328.0, 534.0, 306.0, 474.0, 455.0, 304.0, 602.0, 244.0, 481.0, 467.0, 321.0, 600.0, 368.0, 438.0, 427.0, 558.0, 594.0, 561.0, 501.0, 36.0, 564.0, 400.0, 403.0, 399.0, 367.0, 210.0, 508.0, 392.0, 42.0, 492.0, 572.0, 507.0, 404.0, 324.0, 572.0, 401.0, 546.0, 479.0, 480.0, 432.0, 383.0, 484.0, 609.0, 280.0, 230.0, 342.0, 316.0, -204.0, 456.0, 123.0, 497.0, 503.0, 279.0, 424.0, 304.0, 478.0, 528.0, 581.0, 431.0, 432.0, 570.0, 534.0, 549.0, 443.0, 600.0, 469.0, 563.0, 327.0, 574.0, 276.0, 582.0, 546.0, 576.0, 535.0, 366.0, 503.0, 575.0, 489.0, 468.0, 348.0, 367.0, 281.0, 600.0, 600.0, 396.0, 396.0, 426.0, 323.0, 200.0, 497.0, 564.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -20.0, 200.0, 90.0, 200.0, 200.0, -152.0, 79.0, 68.0, 167.0, 145.0, 200.0, 46.0, -317.0, 57.0, -152.0, 24.0, 200.0, 90.0, 123.0, -97.0, -64.0, 145.0, 189.0, 200.0, 200.0, 200.0, 35.0, 200.0, -152.0, 79.0, 200.0, 200.0, -31.0, 200.0, -53.0, 79.0, 90.0, 200.0, 178.0, 57.0, 145.0, 35.0, 79.0, 35.0, 167.0, 200.0, 200.0, -9.0, 178.0, -75.0, -9.0, 200.0, -20.0, 200.0, 145.0, 57.0, 101.0, 200.0, -130.0, 200.0, 200.0, 200.0, 178.0, -185.0, 200.0, 2.0, 101.0, 200.0, 189.0, 79.0, 24.0, 123.0, 200.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -64.0, 145.0, 112.0, 189.0, 123.0, -9.0, -383.0, 200.0, 200.0, 24.0, 134.0, 35.0, 46.0, 2.0, 156.0, 35.0, -108.0, 101.0, 156.0, 57.0, 145.0, 90.0, 46.0, 46.0, 13.0, 200.0, 145.0, 68.0, 90.0, 46.0, 101.0, 46.0, -42.0, -152.0, 200.0, 2.0, 200.0, 200.0, 200.0, 112.0, 145.0, 200.0, 57.0, 178.0, 90.0, 46.0, -42.0, 46.0, 200.0, -262.0, 189.0, 200.0, 134.0, 178.0, -86.0, 101.0, 200.0, 200.0, 167.0, 13.0, 189.0, -647.0, 79.0, 68.0, 46.0, -119.0, 200.0, -9.0, -262.0, 134.0, 200.0, 156.0, 68.0, 200.0, 24.0, 200.0, 35.0, 13.0, 57.0, 200.0, -196.0, -834.0, 123.0, 90.0, -86.0, -42.0, 13.0, 145.0, -174.0, -119.0, -141.0, -240.0, 200.0, 46.0, -75.0, -42.0, -20.0, -53.0, 200.0, 200.0, 134.0, 24.0, 200.0, 200.0, -64.0, -262.0, 200.0, 2.0, 57.0, 35.0, -20.0, 79.0, 90.0, 112.0, -119.0, 200.0, 200.0, 68.0, 200.0, 178.0, 178.0, 178.0, 90.0, 68.0, 13.0, 79.0, 200.0, 156.0, 189.0, 200.0, 189.0, 101.0, 189.0, 200.0, 24.0, 200.0, -240.0, 200.0, 68.0, 200.0, 200.0, 200.0, -64.0, 123.0, 200.0, 46.0, 200.0, 167.0, -42.0, 101.0, 123.0, 156.0, 178.0, 200.0, 24.0, -42.0, 24.0, 189.0, 200.0, 178.0, 200.0, 200.0, 101.0, 200.0, 156.0, 200.0, 200.0, -185.0, 145.0, 123.0, 24.0, 134.0, 79.0, 46.0, 178.0, 200.0, 145.0, 200.0, 200.0, 167.0, 57.0, 200.0, 68.0, 90.0, 13.0, 90.0, 90.0, 57.0, 35.0, 200.0, -42.0, 13.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 24.0, 35.0, 24.0, 35.0, 167.0, 123.0, 90.0, 13.0, 68.0, 13.0, -108.0, 35.0, -196.0, 101.0, -20.0, 167.0, 200.0, 167.0, 200.0, 167.0], "policy_predator_policy_reward": [75.0, 25.0, 0.0, 50.0, 0.0, 0.0, 235.0, 30.0, 55.0, 5.0, 25.0, 0.0, 235.0, 70.0, 5.0, 100.0, 160.0, 55.0, 115.0, 130.0, 50.0, 120.0, 15.0, 5.0, 0.0, 0.0, 0.0, 80.0, 75.0, 90.0, 0.0, 55.0, 0.0, 170.0, 20.0, 0.0, 20.0, 0.0, 85.0, 0.0, 75.0, 0.0, 80.0, 75.0, 0.0, 15.0, 5.0, 15.0, 55.0, 0.0, 95.0, 70.0, 95.0, 145.0, 0.0, 0.0, 65.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 125.0, 45.0, 5.0, 95.0, 0.0, 40.0, 50.0, 5.0, 80.0, 0.0, 0.0, 35.0, 5.0, 0.0, 0.0, 50.0, 120.0, 55.0, 0.0, 55.0, 0.0, 270.0, 15.0, 20.0, 0.0, 75.0, 65.0, 95.0, 60.0, 30.0, 90.0, 30.0, 90.0, 45.0, 140.0, 65.0, 5.0, 60.0, 10.0, 0.0, 0.0, 105.0, 60.0, 5.0, 30.0, 50.0, 10.0, 95.0, 160.0, 5.0, 25.0, 5.0, 85.0, 0.0, 0.0, 20.0, 40.0, 0.0, 45.0, 60.0, 10.0, 80.0, 0.0, 15.0, 100.0, 5.0, 115.0, 190.0, 140.0, 10.0, 35.0, 130.0, 40.0, 0.0, 5.0, 10.0, 85.0, 15.0, 380.0, 340.0, 260.0, 155.0, 150.0, 0.0, 170.0, 140.0, 210.0, 0.0, 60.0, 0.0, 65.0, 65.0, 55.0, 30.0, 85.0, 60.0, 330.0, 420.0, 310.0, 165.0, 0.0, 50.0, 85.0, 90.0, 25.0, 60.0, 170.0, 0.0, 100.0, 170.0, 180.0, 155.0, 0.0, 105.0, 40.0, 50.0, 60.0, 80.0, 15.0, 50.0, 215.0, 10.0, 180.0, 60.0, 105.0, 0.0, 70.0, 20.0, 120.0, 115.0, 180.0, 100.0, 10.0, 0.0, 50.0, 15.0, 10.0, 0.0, 10.0, 60.0, 25.0, 85.0, 25.0, 30.0, 20.0, 0.0, 5.0, 45.0, 10.0, 0.0, 65.0, 55.0, 5.0, 115.0, 115.0, 185.0, 0.0, 0.0, 0.0, 60.0, 100.0, 50.0, 45.0, 60.0, 45.0, 0.0, 35.0, 110.0, 0.0, 20.0, 20.0, 135.0, 55.0, 80.0, 0.0, 5.0, 10.0, 45.0, 0.0, 0.0, 0.0, 0.0, 20.0, 105.0, 200.0, 70.0, 80.0, 0.0, 5.0, 70.0, 60.0, 70.0, 0.0, 5.0, 25.0, 0.0, 65.0, 0.0, 0.0, 110.0, 0.0, 0.0, 155.0, 0.0, 75.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 135.0, 55.0, 45.0, 65.0, 60.0, 55.0, 85.0, 60.0, 105.0, 160.0, 85.0, 80.0, 180.0, 0.0, 50.0, 0.0, 100.0, 15.0, 15.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.000135336579672, "mean_inference_ms": 1.699083661435847, "mean_action_processing_ms": 0.3774532835958254, "mean_env_wait_ms": 0.26529624858260353, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008518338203430176, "StateBufferConnector_ms": 0.0043964385986328125, "ViewRequirementAgentConnector_ms": 0.15121996402740479}, "num_episodes": 18, "episode_return_max": 609.0, "episode_return_min": -204.0, "episode_return_mean": 428.93, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 52.36492510072175, "num_env_steps_trained_throughput_per_sec": 52.36492510072175, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 1272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 74268.847, "restore_workers_time_ms": 0.014, "training_step_time_ms": 74268.798, "sample_time_ms": 1540.999, "learn_time_ms": 72709.535, "learn_throughput": 55.013, "synch_weights_time_ms": 14.632}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "training_iteration": 53, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-24-03", "timestamp": 1723490643, "time_this_iter_s": 76.43664908409119, "time_total_s": 4047.174017906189, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1078c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4047.174017906189, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 40.12499999999999, "ram_util_percent": 82.12962962962962}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5626872312885227, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0127559158396213, "policy_loss": -0.011035738020461608, "vf_loss": 1.0226626085157091, "vf_explained_var": 2.120407760566008e-05, "kl": 0.007526776090218827, "entropy": 0.7375915454634538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 150870.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.875455031274481, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9647396020460808, "policy_loss": -0.021431444913598028, "vf_loss": 0.9853608971950433, "vf_explained_var": 0.0571224662006324, "kl": 0.008101495123900956, "entropy": 1.267465582257467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 150870.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 616.0, "episode_reward_min": -204.0, "episode_reward_mean": 436.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -834.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 420.0}, "policy_reward_mean": {"prey_policy": 83.51, "predator_policy": 62.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [438.0, 427.0, 558.0, 594.0, 561.0, 501.0, 36.0, 564.0, 400.0, 403.0, 399.0, 367.0, 210.0, 508.0, 392.0, 42.0, 492.0, 572.0, 507.0, 404.0, 324.0, 572.0, 401.0, 546.0, 479.0, 480.0, 432.0, 383.0, 484.0, 609.0, 280.0, 230.0, 342.0, 316.0, -204.0, 456.0, 123.0, 497.0, 503.0, 279.0, 424.0, 304.0, 478.0, 528.0, 581.0, 431.0, 432.0, 570.0, 534.0, 549.0, 443.0, 600.0, 469.0, 563.0, 327.0, 574.0, 276.0, 582.0, 546.0, 576.0, 535.0, 366.0, 503.0, 575.0, 489.0, 468.0, 348.0, 367.0, 281.0, 600.0, 600.0, 396.0, 396.0, 426.0, 323.0, 200.0, 497.0, 564.0, 568.0, 230.0, 340.0, 253.0, 497.0, 509.0, 483.0, 443.0, 594.0, 445.0, 363.0, 616.0, 568.0, 582.0, 559.0, 138.0, 261.0, 502.0, 576.0, 528.0, 490.0, 525.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2.0, 101.0, 200.0, 189.0, 79.0, 24.0, 123.0, 200.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -64.0, 145.0, 112.0, 189.0, 123.0, -9.0, -383.0, 200.0, 200.0, 24.0, 134.0, 35.0, 46.0, 2.0, 156.0, 35.0, -108.0, 101.0, 156.0, 57.0, 145.0, 90.0, 46.0, 46.0, 13.0, 200.0, 145.0, 68.0, 90.0, 46.0, 101.0, 46.0, -42.0, -152.0, 200.0, 2.0, 200.0, 200.0, 200.0, 112.0, 145.0, 200.0, 57.0, 178.0, 90.0, 46.0, -42.0, 46.0, 200.0, -262.0, 189.0, 200.0, 134.0, 178.0, -86.0, 101.0, 200.0, 200.0, 167.0, 13.0, 189.0, -647.0, 79.0, 68.0, 46.0, -119.0, 200.0, -9.0, -262.0, 134.0, 200.0, 156.0, 68.0, 200.0, 24.0, 200.0, 35.0, 13.0, 57.0, 200.0, -196.0, -834.0, 123.0, 90.0, -86.0, -42.0, 13.0, 145.0, -174.0, -119.0, -141.0, -240.0, 200.0, 46.0, -75.0, -42.0, -20.0, -53.0, 200.0, 200.0, 134.0, 24.0, 200.0, 200.0, -64.0, -262.0, 200.0, 2.0, 57.0, 35.0, -20.0, 79.0, 90.0, 112.0, -119.0, 200.0, 200.0, 68.0, 200.0, 178.0, 178.0, 178.0, 90.0, 68.0, 13.0, 79.0, 200.0, 156.0, 189.0, 200.0, 189.0, 101.0, 189.0, 200.0, 24.0, 200.0, -240.0, 200.0, 68.0, 200.0, 200.0, 200.0, -64.0, 123.0, 200.0, 46.0, 200.0, 167.0, -42.0, 101.0, 123.0, 156.0, 178.0, 200.0, 24.0, -42.0, 24.0, 189.0, 200.0, 178.0, 200.0, 200.0, 101.0, 200.0, 156.0, 200.0, 200.0, -185.0, 145.0, 123.0, 24.0, 134.0, 79.0, 46.0, 178.0, 200.0, 145.0, 200.0, 200.0, 167.0, 57.0, 200.0, 68.0, 90.0, 13.0, 90.0, 90.0, 57.0, 35.0, 200.0, -42.0, 13.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 24.0, 35.0, 24.0, 35.0, 167.0, 123.0, 90.0, 13.0, 68.0, 13.0, -108.0, 35.0, -196.0, 101.0, -20.0, 167.0, 200.0, 167.0, 200.0, 167.0, 189.0, 200.0, 134.0, -86.0, 101.0, -75.0, 200.0, 101.0, -196.0, -295.0, 189.0, 79.0, 24.0, 178.0, 145.0, 189.0, 2.0, 68.0, 145.0, 101.0, 167.0, 101.0, -53.0, 200.0, 189.0, 200.0, 200.0, 13.0, 68.0, 189.0, 68.0, 68.0, 112.0, 200.0, 200.0, -174.0, 68.0, 200.0, 200.0, 200.0, 167.0, 200.0, 200.0, 200.0, 24.0, -53.0, 167.0, -636.0, -229.0, 145.0, 35.0, 46.0, 200.0, 156.0, 200.0, 200.0, 156.0, 200.0, -42.0, 200.0, 200.0, 200.0, -570.0, 200.0, 112.0, 123.0], "policy_predator_policy_reward": [95.0, 0.0, 40.0, 50.0, 5.0, 80.0, 0.0, 0.0, 35.0, 5.0, 0.0, 0.0, 50.0, 120.0, 55.0, 0.0, 55.0, 0.0, 270.0, 15.0, 20.0, 0.0, 75.0, 65.0, 95.0, 60.0, 30.0, 90.0, 30.0, 90.0, 45.0, 140.0, 65.0, 5.0, 60.0, 10.0, 0.0, 0.0, 105.0, 60.0, 5.0, 30.0, 50.0, 10.0, 95.0, 160.0, 5.0, 25.0, 5.0, 85.0, 0.0, 0.0, 20.0, 40.0, 0.0, 45.0, 60.0, 10.0, 80.0, 0.0, 15.0, 100.0, 5.0, 115.0, 190.0, 140.0, 10.0, 35.0, 130.0, 40.0, 0.0, 5.0, 10.0, 85.0, 15.0, 380.0, 340.0, 260.0, 155.0, 150.0, 0.0, 170.0, 140.0, 210.0, 0.0, 60.0, 0.0, 65.0, 65.0, 55.0, 30.0, 85.0, 60.0, 330.0, 420.0, 310.0, 165.0, 0.0, 50.0, 85.0, 90.0, 25.0, 60.0, 170.0, 0.0, 100.0, 170.0, 180.0, 155.0, 0.0, 105.0, 40.0, 50.0, 60.0, 80.0, 15.0, 50.0, 215.0, 10.0, 180.0, 60.0, 105.0, 0.0, 70.0, 20.0, 120.0, 115.0, 180.0, 100.0, 10.0, 0.0, 50.0, 15.0, 10.0, 0.0, 10.0, 60.0, 25.0, 85.0, 25.0, 30.0, 20.0, 0.0, 5.0, 45.0, 10.0, 0.0, 65.0, 55.0, 5.0, 115.0, 115.0, 185.0, 0.0, 0.0, 0.0, 60.0, 100.0, 50.0, 45.0, 60.0, 45.0, 0.0, 35.0, 110.0, 0.0, 20.0, 20.0, 135.0, 55.0, 80.0, 0.0, 5.0, 10.0, 45.0, 0.0, 0.0, 0.0, 0.0, 20.0, 105.0, 200.0, 70.0, 80.0, 0.0, 5.0, 70.0, 60.0, 70.0, 0.0, 5.0, 25.0, 0.0, 65.0, 0.0, 0.0, 110.0, 0.0, 0.0, 155.0, 0.0, 75.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 135.0, 55.0, 45.0, 65.0, 60.0, 55.0, 85.0, 60.0, 105.0, 160.0, 85.0, 80.0, 180.0, 0.0, 50.0, 0.0, 100.0, 15.0, 15.0, 0.0, 0.0, 10.0, 35.0, 105.0, 125.0, 60.0, 180.0, 55.0, 0.0, 0.0, 225.0, 55.0, 65.0, 60.0, 25.0, 70.0, 120.0, 60.0, 50.0, 20.0, 0.0, 25.0, 65.0, 105.0, 5.0, 0.0, 0.0, 50.0, 55.0, 70.0, 90.0, 10.0, 15.0, 100.0, 140.0, 150.0, 40.0, 60.0, 0.0, 0.0, 0.0, 15.0, 75.0, 40.0, 20.0, 70.0, 315.0, 275.0, 45.0, 240.0, 25.0, 0.0, 85.0, 15.0, 20.0, 0.0, 0.0, 100.0, 60.0, 10.0, 270.0, 230.0, 160.0, 35.0, 15.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.997651362454545, "mean_inference_ms": 1.6942488970929133, "mean_action_processing_ms": 0.3768331241234402, "mean_env_wait_ms": 0.2649484251215258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0078812837600708, "StateBufferConnector_ms": 0.00447535514831543, "ViewRequirementAgentConnector_ms": 0.15056681632995605}, "num_episodes": 22, "episode_return_max": 616.0, "episode_return_min": -204.0, "episode_return_mean": 436.98, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.67596882038815, "num_env_steps_trained_throughput_per_sec": 54.67596882038815, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 74249.17, "restore_workers_time_ms": 0.014, "training_step_time_ms": 74249.121, "sample_time_ms": 1539.134, "learn_time_ms": 72692.475, "learn_throughput": 55.026, "synch_weights_time_ms": 13.888}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 54, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-25-16", "timestamp": 1723490716, "time_this_iter_s": 73.21530175209045, "time_total_s": 4120.389319658279, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b231b5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4120.389319658279, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 32.71538461538462, "ram_util_percent": 82.25865384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5926782517251394, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2640675541356945, "policy_loss": -0.00943485501648343, "vf_loss": 1.2725053306484053, "vf_explained_var": -4.723437711702171e-05, "kl": 0.006646892686753326, "entropy": 0.7604937952460972, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 153690.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.660692939817483, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.160241528803892, "policy_loss": -0.0220969230043933, "vf_loss": 1.1814120828894012, "vf_explained_var": 0.04082269015464377, "kl": 0.009263685197884692, "entropy": 1.3056496790537597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 153690.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 616.0, "episode_reward_min": -254.0, "episode_reward_mean": 406.1, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -834.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 420.0}, "policy_reward_mean": {"prey_policy": 64.51666666666667, "predator_policy": 70.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [546.0, 479.0, 480.0, 432.0, 383.0, 484.0, 609.0, 280.0, 230.0, 342.0, 316.0, -204.0, 456.0, 123.0, 497.0, 503.0, 279.0, 424.0, 304.0, 478.0, 528.0, 581.0, 431.0, 432.0, 570.0, 534.0, 549.0, 443.0, 600.0, 469.0, 563.0, 327.0, 574.0, 276.0, 582.0, 546.0, 576.0, 535.0, 366.0, 503.0, 575.0, 489.0, 468.0, 348.0, 367.0, 281.0, 600.0, 600.0, 396.0, 396.0, 426.0, 323.0, 200.0, 497.0, 564.0, 568.0, 230.0, 340.0, 253.0, 497.0, 509.0, 483.0, 443.0, 594.0, 445.0, 363.0, 616.0, 568.0, 582.0, 559.0, 138.0, 261.0, 502.0, 576.0, 528.0, 490.0, 525.0, 416.0, 441.0, 220.0, 477.0, 368.0, 446.0, 273.0, 306.0, -254.0, 539.0, 120.0, 273.0, 359.0, 253.0, 229.0, 275.0, 406.0, 316.0, 459.0, -249.0, 455.0, 94.0, 362.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [101.0, 200.0, 200.0, 167.0, 13.0, 189.0, -647.0, 79.0, 68.0, 46.0, -119.0, 200.0, -9.0, -262.0, 134.0, 200.0, 156.0, 68.0, 200.0, 24.0, 200.0, 35.0, 13.0, 57.0, 200.0, -196.0, -834.0, 123.0, 90.0, -86.0, -42.0, 13.0, 145.0, -174.0, -119.0, -141.0, -240.0, 200.0, 46.0, -75.0, -42.0, -20.0, -53.0, 200.0, 200.0, 134.0, 24.0, 200.0, 200.0, -64.0, -262.0, 200.0, 2.0, 57.0, 35.0, -20.0, 79.0, 90.0, 112.0, -119.0, 200.0, 200.0, 68.0, 200.0, 178.0, 178.0, 178.0, 90.0, 68.0, 13.0, 79.0, 200.0, 156.0, 189.0, 200.0, 189.0, 101.0, 189.0, 200.0, 24.0, 200.0, -240.0, 200.0, 68.0, 200.0, 200.0, 200.0, -64.0, 123.0, 200.0, 46.0, 200.0, 167.0, -42.0, 101.0, 123.0, 156.0, 178.0, 200.0, 24.0, -42.0, 24.0, 189.0, 200.0, 178.0, 200.0, 200.0, 101.0, 200.0, 156.0, 200.0, 200.0, -185.0, 145.0, 123.0, 24.0, 134.0, 79.0, 46.0, 178.0, 200.0, 145.0, 200.0, 200.0, 167.0, 57.0, 200.0, 68.0, 90.0, 13.0, 90.0, 90.0, 57.0, 35.0, 200.0, -42.0, 13.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 24.0, 35.0, 24.0, 35.0, 167.0, 123.0, 90.0, 13.0, 68.0, 13.0, -108.0, 35.0, -196.0, 101.0, -20.0, 167.0, 200.0, 167.0, 200.0, 167.0, 189.0, 200.0, 134.0, -86.0, 101.0, -75.0, 200.0, 101.0, -196.0, -295.0, 189.0, 79.0, 24.0, 178.0, 145.0, 189.0, 2.0, 68.0, 145.0, 101.0, 167.0, 101.0, -53.0, 200.0, 189.0, 200.0, 200.0, 13.0, 68.0, 189.0, 68.0, 68.0, 112.0, 200.0, 200.0, -174.0, 68.0, 200.0, 200.0, 200.0, 167.0, 200.0, 200.0, 200.0, 24.0, -53.0, 167.0, -636.0, -229.0, 145.0, 35.0, 46.0, 200.0, 156.0, 200.0, 200.0, 156.0, 200.0, -42.0, 200.0, 200.0, 200.0, -570.0, 200.0, 112.0, 123.0, 156.0, 68.0, 2.0, 200.0, -86.0, 167.0, 167.0, -152.0, -350.0, 46.0, -218.0, 189.0, 145.0, 112.0, -9.0, 79.0, 112.0, 200.0, -207.0, 68.0, 112.0, 79.0, 68.0, -86.0, -251.0, -196.0, -97.0, -75.0, 189.0, 200.0, 112.0, -130.0, -262.0, 24.0, -9.0, 123.0, 79.0, 145.0, 35.0, -31.0, -361.0, 200.0, -97.0, 2.0, 189.0, 200.0, 200.0, -625.0, 200.0, 46.0, 90.0, 57.0, 200.0, -141.0, 57.0, 200.0, -163.0, -174.0, -350.0, -20.0, -119.0, 167.0, 167.0, -130.0, -9.0, -42.0, -108.0, 90.0, 145.0], "policy_predator_policy_reward": [40.0, 0.0, 5.0, 10.0, 85.0, 15.0, 380.0, 340.0, 260.0, 155.0, 150.0, 0.0, 170.0, 140.0, 210.0, 0.0, 60.0, 0.0, 65.0, 65.0, 55.0, 30.0, 85.0, 60.0, 330.0, 420.0, 310.0, 165.0, 0.0, 50.0, 85.0, 90.0, 25.0, 60.0, 170.0, 0.0, 100.0, 170.0, 180.0, 155.0, 0.0, 105.0, 40.0, 50.0, 60.0, 80.0, 15.0, 50.0, 215.0, 10.0, 180.0, 60.0, 105.0, 0.0, 70.0, 20.0, 120.0, 115.0, 180.0, 100.0, 10.0, 0.0, 50.0, 15.0, 10.0, 0.0, 10.0, 60.0, 25.0, 85.0, 25.0, 30.0, 20.0, 0.0, 5.0, 45.0, 10.0, 0.0, 65.0, 55.0, 5.0, 115.0, 115.0, 185.0, 0.0, 0.0, 0.0, 60.0, 100.0, 50.0, 45.0, 60.0, 45.0, 0.0, 35.0, 110.0, 0.0, 20.0, 20.0, 135.0, 55.0, 80.0, 0.0, 5.0, 10.0, 45.0, 0.0, 0.0, 0.0, 0.0, 20.0, 105.0, 200.0, 70.0, 80.0, 0.0, 5.0, 70.0, 60.0, 70.0, 0.0, 5.0, 25.0, 0.0, 65.0, 0.0, 0.0, 110.0, 0.0, 0.0, 155.0, 0.0, 75.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 135.0, 55.0, 45.0, 65.0, 60.0, 55.0, 85.0, 60.0, 105.0, 160.0, 85.0, 80.0, 180.0, 0.0, 50.0, 0.0, 100.0, 15.0, 15.0, 0.0, 0.0, 10.0, 35.0, 105.0, 125.0, 60.0, 180.0, 55.0, 0.0, 0.0, 225.0, 55.0, 65.0, 60.0, 25.0, 70.0, 120.0, 60.0, 50.0, 20.0, 0.0, 25.0, 65.0, 105.0, 5.0, 0.0, 0.0, 50.0, 55.0, 70.0, 90.0, 10.0, 15.0, 100.0, 140.0, 150.0, 40.0, 60.0, 0.0, 0.0, 0.0, 15.0, 75.0, 40.0, 20.0, 70.0, 315.0, 275.0, 45.0, 240.0, 25.0, 0.0, 85.0, 15.0, 20.0, 0.0, 0.0, 100.0, 60.0, 10.0, 270.0, 230.0, 160.0, 35.0, 15.0, 40.0, 75.0, 55.0, 60.0, 90.0, 55.0, 15.0, 245.0, 145.0, 165.0, 105.0, 160.0, 195.0, 25.0, 95.0, 0.0, 0.0, 0.0, 55.0, 35.0, 85.0, 180.0, 55.0, 135.0, 55.0, 60.0, 5.0, 225.0, 125.0, 5.0, 95.0, 210.0, 130.0, 60.0, 10.0, 90.0, 35.0, 0.0, 0.0, 100.0, 115.0, 140.0, 190.0, 0.0, 135.0, 0.0, 75.0, 270.0, 155.0, 0.0, 0.0, 70.0, 155.0, 45.0, 0.0, 165.0, 75.0, 125.0, 0.0, 40.0, 255.0, 165.0, 0.0, 75.0, 225.0, 50.0, 0.0, 65.0, 110.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9953549035892931, "mean_inference_ms": 1.6900585128467542, "mean_action_processing_ms": 0.3763727302118254, "mean_env_wait_ms": 0.26464573187213203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007567167282104492, "StateBufferConnector_ms": 0.004505634307861328, "ViewRequirementAgentConnector_ms": 0.1548234224319458}, "num_episodes": 23, "episode_return_max": 616.0, "episode_return_min": -254.0, "episode_return_mean": 406.1, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.24843383953469, "num_env_steps_trained_throughput_per_sec": 53.24843383953469, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 74284.684, "restore_workers_time_ms": 0.014, "training_step_time_ms": 74284.634, "sample_time_ms": 1503.013, "learn_time_ms": 72763.534, "learn_throughput": 54.973, "synch_weights_time_ms": 14.37}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 55, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-26-31", "timestamp": 1723490791, "time_this_iter_s": 75.14586305618286, "time_total_s": 4195.535182714462, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b232aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4195.535182714462, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 39.54622641509434, "ram_util_percent": 82.72735849056605}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5704302611397514, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9788194329286298, "policy_loss": -0.007901209534528988, "vf_loss": 0.9857698964258881, "vf_explained_var": 1.919081447817755e-05, "kl": 0.00633806220988166, "entropy": 0.7764035689281233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 156510.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.22643021911594, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9510018315437045, "policy_loss": -0.0194780897776801, "vf_loss": 0.9697292147032547, "vf_explained_var": 0.051221862202840494, "kl": 0.007507094724143404, "entropy": 1.2513466851931092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 156510.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 616.0, "episode_reward_min": -254.0, "episode_reward_mean": 402.63, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -636.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 315.0}, "policy_reward_mean": {"prey_policy": 69.94333333333333, "predator_policy": 64.26666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [304.0, 478.0, 528.0, 581.0, 431.0, 432.0, 570.0, 534.0, 549.0, 443.0, 600.0, 469.0, 563.0, 327.0, 574.0, 276.0, 582.0, 546.0, 576.0, 535.0, 366.0, 503.0, 575.0, 489.0, 468.0, 348.0, 367.0, 281.0, 600.0, 600.0, 396.0, 396.0, 426.0, 323.0, 200.0, 497.0, 564.0, 568.0, 230.0, 340.0, 253.0, 497.0, 509.0, 483.0, 443.0, 594.0, 445.0, 363.0, 616.0, 568.0, 582.0, 559.0, 138.0, 261.0, 502.0, 576.0, 528.0, 490.0, 525.0, 416.0, 441.0, 220.0, 477.0, 368.0, 446.0, 273.0, 306.0, -254.0, 539.0, 120.0, 273.0, 359.0, 253.0, 229.0, 275.0, 406.0, 316.0, 459.0, -249.0, 455.0, 94.0, 362.0, 600.0, -62.0, 468.0, 163.0, 360.0, 498.0, 510.0, 372.0, 600.0, 563.0, 208.0, 169.0, -21.0, 236.0, 558.0, 147.0, 452.0, 491.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [35.0, -20.0, 79.0, 90.0, 112.0, -119.0, 200.0, 200.0, 68.0, 200.0, 178.0, 178.0, 178.0, 90.0, 68.0, 13.0, 79.0, 200.0, 156.0, 189.0, 200.0, 189.0, 101.0, 189.0, 200.0, 24.0, 200.0, -240.0, 200.0, 68.0, 200.0, 200.0, 200.0, -64.0, 123.0, 200.0, 46.0, 200.0, 167.0, -42.0, 101.0, 123.0, 156.0, 178.0, 200.0, 24.0, -42.0, 24.0, 189.0, 200.0, 178.0, 200.0, 200.0, 101.0, 200.0, 156.0, 200.0, 200.0, -185.0, 145.0, 123.0, 24.0, 134.0, 79.0, 46.0, 178.0, 200.0, 145.0, 200.0, 200.0, 167.0, 57.0, 200.0, 68.0, 90.0, 13.0, 90.0, 90.0, 57.0, 35.0, 200.0, -42.0, 13.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 24.0, 35.0, 24.0, 35.0, 167.0, 123.0, 90.0, 13.0, 68.0, 13.0, -108.0, 35.0, -196.0, 101.0, -20.0, 167.0, 200.0, 167.0, 200.0, 167.0, 189.0, 200.0, 134.0, -86.0, 101.0, -75.0, 200.0, 101.0, -196.0, -295.0, 189.0, 79.0, 24.0, 178.0, 145.0, 189.0, 2.0, 68.0, 145.0, 101.0, 167.0, 101.0, -53.0, 200.0, 189.0, 200.0, 200.0, 13.0, 68.0, 189.0, 68.0, 68.0, 112.0, 200.0, 200.0, -174.0, 68.0, 200.0, 200.0, 200.0, 167.0, 200.0, 200.0, 200.0, 24.0, -53.0, 167.0, -636.0, -229.0, 145.0, 35.0, 46.0, 200.0, 156.0, 200.0, 200.0, 156.0, 200.0, -42.0, 200.0, 200.0, 200.0, -570.0, 200.0, 112.0, 123.0, 156.0, 68.0, 2.0, 200.0, -86.0, 167.0, 167.0, -152.0, -350.0, 46.0, -218.0, 189.0, 145.0, 112.0, -9.0, 79.0, 112.0, 200.0, -207.0, 68.0, 112.0, 79.0, 68.0, -86.0, -251.0, -196.0, -97.0, -75.0, 189.0, 200.0, 112.0, -130.0, -262.0, 24.0, -9.0, 123.0, 79.0, 145.0, 35.0, -31.0, -361.0, 200.0, -97.0, 2.0, 189.0, 200.0, 200.0, -625.0, 200.0, 46.0, 90.0, 57.0, 200.0, -141.0, 57.0, 200.0, -163.0, -174.0, -350.0, -20.0, -119.0, 167.0, 167.0, -130.0, -9.0, -42.0, -108.0, 90.0, 145.0, 200.0, 200.0, 200.0, -449.0, -240.0, 112.0, 200.0, 57.0, -9.0, -31.0, -86.0, -75.0, -20.0, 35.0, 145.0, 79.0, 178.0, 156.0, 189.0, 68.0, 178.0, 200.0, 13.0, -31.0, 200.0, 200.0, 200.0, 200.0, 35.0, 178.0, -86.0, -196.0, 200.0, 57.0, 134.0, -262.0, -240.0, 167.0, -273.0, -493.0, 13.0, 46.0, 123.0, 200.0, 200.0, -42.0, 2.0, 2.0, 90.0, 112.0, 200.0, 79.0, 112.0, 200.0], "policy_predator_policy_reward": [70.0, 20.0, 120.0, 115.0, 180.0, 100.0, 10.0, 0.0, 50.0, 15.0, 10.0, 0.0, 10.0, 60.0, 25.0, 85.0, 25.0, 30.0, 20.0, 0.0, 5.0, 45.0, 10.0, 0.0, 65.0, 55.0, 5.0, 115.0, 115.0, 185.0, 0.0, 0.0, 0.0, 60.0, 100.0, 50.0, 45.0, 60.0, 45.0, 0.0, 35.0, 110.0, 0.0, 20.0, 20.0, 135.0, 55.0, 80.0, 0.0, 5.0, 10.0, 45.0, 0.0, 0.0, 0.0, 0.0, 20.0, 105.0, 200.0, 70.0, 80.0, 0.0, 5.0, 70.0, 60.0, 70.0, 0.0, 5.0, 25.0, 0.0, 65.0, 0.0, 0.0, 110.0, 0.0, 0.0, 155.0, 0.0, 75.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 135.0, 55.0, 45.0, 65.0, 60.0, 55.0, 85.0, 60.0, 105.0, 160.0, 85.0, 80.0, 180.0, 0.0, 50.0, 0.0, 100.0, 15.0, 15.0, 0.0, 0.0, 10.0, 35.0, 105.0, 125.0, 60.0, 180.0, 55.0, 0.0, 0.0, 225.0, 55.0, 65.0, 60.0, 25.0, 70.0, 120.0, 60.0, 50.0, 20.0, 0.0, 25.0, 65.0, 105.0, 5.0, 0.0, 0.0, 50.0, 55.0, 70.0, 90.0, 10.0, 15.0, 100.0, 140.0, 150.0, 40.0, 60.0, 0.0, 0.0, 0.0, 15.0, 75.0, 40.0, 20.0, 70.0, 315.0, 275.0, 45.0, 240.0, 25.0, 0.0, 85.0, 15.0, 20.0, 0.0, 0.0, 100.0, 60.0, 10.0, 270.0, 230.0, 160.0, 35.0, 15.0, 40.0, 75.0, 55.0, 60.0, 90.0, 55.0, 15.0, 245.0, 145.0, 165.0, 105.0, 160.0, 195.0, 25.0, 95.0, 0.0, 0.0, 0.0, 55.0, 35.0, 85.0, 180.0, 55.0, 135.0, 55.0, 60.0, 5.0, 225.0, 125.0, 5.0, 95.0, 210.0, 130.0, 60.0, 10.0, 90.0, 35.0, 0.0, 0.0, 100.0, 115.0, 140.0, 190.0, 0.0, 135.0, 0.0, 75.0, 270.0, 155.0, 0.0, 0.0, 70.0, 155.0, 45.0, 0.0, 165.0, 75.0, 125.0, 0.0, 40.0, 255.0, 165.0, 0.0, 75.0, 225.0, 50.0, 0.0, 65.0, 110.0, 60.0, 0.0, 0.0, 0.0, 240.0, 20.0, 255.0, 80.0, 50.0, 90.0, 115.0, 110.0, 130.0, 75.0, 75.0, 50.0, 20.0, 15.0, 50.0, 0.0, 0.0, 75.0, 85.0, 0.0, 105.0, 0.0, 0.0, 0.0, 50.0, 35.0, 65.0, 15.0, 60.0, 215.0, 30.0, 0.0, 210.0, 215.0, 15.0, 95.0, 235.0, 155.0, 280.0, 30.0, 0.0, 5.0, 50.0, 135.0, 0.0, 50.0, 0.0, 0.0, 45.0, 0.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9937917392680307, "mean_inference_ms": 1.6870129660936248, "mean_action_processing_ms": 0.3760561854094789, "mean_env_wait_ms": 0.26437148788547365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007605910301208496, "StateBufferConnector_ms": 0.005403876304626465, "ViewRequirementAgentConnector_ms": 0.1574314832687378}, "num_episodes": 18, "episode_return_max": 616.0, "episode_return_min": -254.0, "episode_return_mean": 402.63, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.66340826212778, "num_env_steps_trained_throughput_per_sec": 6.66340826212778, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 126982.877, "restore_workers_time_ms": 0.014, "training_step_time_ms": 126982.828, "sample_time_ms": 1506.496, "learn_time_ms": 125458.336, "learn_throughput": 31.883, "synch_weights_time_ms": 14.414}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 56, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-36-31", "timestamp": 1723491391, "time_this_iter_s": 600.379772901535, "time_total_s": 4795.914955615997, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b231eee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4795.914955615997, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 50.8625, "ram_util_percent": 81.8675}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.477803205360546, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8482045270026999, "policy_loss": -0.00945299169501118, "vf_loss": 0.8568269783353551, "vf_explained_var": -3.274207842265461e-05, "kl": 0.005536796788506853, "entropy": 0.7732754257976586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 159330.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8799429126242373, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9354522274556101, "policy_loss": -0.013993693199438037, "vf_loss": 0.9487167683000683, "vf_explained_var": 0.025587849963641336, "kl": 0.007291538695951335, "entropy": 1.2499241835682104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 159330.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "env_runners": {"episode_reward_max": 616.0, "episode_reward_min": -1628.0, "episode_reward_mean": 366.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1087.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 690.0}, "policy_reward_mean": {"prey_policy": 54.946666666666665, "predator_policy": 67.18333333333334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [576.0, 535.0, 366.0, 503.0, 575.0, 489.0, 468.0, 348.0, 367.0, 281.0, 600.0, 600.0, 396.0, 396.0, 426.0, 323.0, 200.0, 497.0, 564.0, 568.0, 230.0, 340.0, 253.0, 497.0, 509.0, 483.0, 443.0, 594.0, 445.0, 363.0, 616.0, 568.0, 582.0, 559.0, 138.0, 261.0, 502.0, 576.0, 528.0, 490.0, 525.0, 416.0, 441.0, 220.0, 477.0, 368.0, 446.0, 273.0, 306.0, -254.0, 539.0, 120.0, 273.0, 359.0, 253.0, 229.0, 275.0, 406.0, 316.0, 459.0, -249.0, 455.0, 94.0, 362.0, 600.0, -62.0, 468.0, 163.0, 360.0, 498.0, 510.0, 372.0, 600.0, 563.0, 208.0, 169.0, -21.0, 236.0, 558.0, 147.0, 452.0, 491.0, 341.0, 339.0, 439.0, -1628.0, 348.0, 497.0, 564.0, 356.0, 318.0, 202.0, 340.0, 493.0, 600.0, 384.0, 431.0, 344.0, 408.0, 387.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 156.0, 200.0, 200.0, -185.0, 145.0, 123.0, 24.0, 134.0, 79.0, 46.0, 178.0, 200.0, 145.0, 200.0, 200.0, 167.0, 57.0, 200.0, 68.0, 90.0, 13.0, 90.0, 90.0, 57.0, 35.0, 200.0, -42.0, 13.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 24.0, 35.0, 24.0, 35.0, 167.0, 123.0, 90.0, 13.0, 68.0, 13.0, -108.0, 35.0, -196.0, 101.0, -20.0, 167.0, 200.0, 167.0, 200.0, 167.0, 189.0, 200.0, 134.0, -86.0, 101.0, -75.0, 200.0, 101.0, -196.0, -295.0, 189.0, 79.0, 24.0, 178.0, 145.0, 189.0, 2.0, 68.0, 145.0, 101.0, 167.0, 101.0, -53.0, 200.0, 189.0, 200.0, 200.0, 13.0, 68.0, 189.0, 68.0, 68.0, 112.0, 200.0, 200.0, -174.0, 68.0, 200.0, 200.0, 200.0, 167.0, 200.0, 200.0, 200.0, 24.0, -53.0, 167.0, -636.0, -229.0, 145.0, 35.0, 46.0, 200.0, 156.0, 200.0, 200.0, 156.0, 200.0, -42.0, 200.0, 200.0, 200.0, -570.0, 200.0, 112.0, 123.0, 156.0, 68.0, 2.0, 200.0, -86.0, 167.0, 167.0, -152.0, -350.0, 46.0, -218.0, 189.0, 145.0, 112.0, -9.0, 79.0, 112.0, 200.0, -207.0, 68.0, 112.0, 79.0, 68.0, -86.0, -251.0, -196.0, -97.0, -75.0, 189.0, 200.0, 112.0, -130.0, -262.0, 24.0, -9.0, 123.0, 79.0, 145.0, 35.0, -31.0, -361.0, 200.0, -97.0, 2.0, 189.0, 200.0, 200.0, -625.0, 200.0, 46.0, 90.0, 57.0, 200.0, -141.0, 57.0, 200.0, -163.0, -174.0, -350.0, -20.0, -119.0, 167.0, 167.0, -130.0, -9.0, -42.0, -108.0, 90.0, 145.0, 200.0, 200.0, 200.0, -449.0, -240.0, 112.0, 200.0, 57.0, -9.0, -31.0, -86.0, -75.0, -20.0, 35.0, 145.0, 79.0, 178.0, 156.0, 189.0, 68.0, 178.0, 200.0, 13.0, -31.0, 200.0, 200.0, 200.0, 200.0, 35.0, 178.0, -86.0, -196.0, 200.0, 57.0, 134.0, -262.0, -240.0, 167.0, -273.0, -493.0, 13.0, 46.0, 123.0, 200.0, 200.0, -42.0, 2.0, 2.0, 90.0, 112.0, 200.0, 79.0, 112.0, 200.0, 2.0, 189.0, 35.0, 13.0, -42.0, 68.0, -20.0, 178.0, 101.0, -966.0, -295.0, -1087.0, -64.0, 200.0, -108.0, 200.0, 79.0, 123.0, 200.0, 200.0, 134.0, 156.0, 90.0, 35.0, 156.0, -64.0, -9.0, 13.0, 13.0, -9.0, 112.0, -9.0, 112.0, 200.0, 79.0, 134.0, 200.0, 200.0, 200.0, 134.0, 101.0, -31.0, 46.0, -20.0, 200.0, 13.0, 46.0, 90.0, 68.0, 101.0, 134.0, 167.0, 46.0, 24.0], "policy_predator_policy_reward": [0.0, 0.0, 20.0, 105.0, 200.0, 70.0, 80.0, 0.0, 5.0, 70.0, 60.0, 70.0, 0.0, 5.0, 25.0, 0.0, 65.0, 0.0, 0.0, 110.0, 0.0, 0.0, 155.0, 0.0, 75.0, 0.0, 0.0, 110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 145.0, 135.0, 55.0, 45.0, 65.0, 60.0, 55.0, 85.0, 60.0, 105.0, 160.0, 85.0, 80.0, 180.0, 0.0, 50.0, 0.0, 100.0, 15.0, 15.0, 0.0, 0.0, 10.0, 35.0, 105.0, 125.0, 60.0, 180.0, 55.0, 0.0, 0.0, 225.0, 55.0, 65.0, 60.0, 25.0, 70.0, 120.0, 60.0, 50.0, 20.0, 0.0, 25.0, 65.0, 105.0, 5.0, 0.0, 0.0, 50.0, 55.0, 70.0, 90.0, 10.0, 15.0, 100.0, 140.0, 150.0, 40.0, 60.0, 0.0, 0.0, 0.0, 15.0, 75.0, 40.0, 20.0, 70.0, 315.0, 275.0, 45.0, 240.0, 25.0, 0.0, 85.0, 15.0, 20.0, 0.0, 0.0, 100.0, 60.0, 10.0, 270.0, 230.0, 160.0, 35.0, 15.0, 40.0, 75.0, 55.0, 60.0, 90.0, 55.0, 15.0, 245.0, 145.0, 165.0, 105.0, 160.0, 195.0, 25.0, 95.0, 0.0, 0.0, 0.0, 55.0, 35.0, 85.0, 180.0, 55.0, 135.0, 55.0, 60.0, 5.0, 225.0, 125.0, 5.0, 95.0, 210.0, 130.0, 60.0, 10.0, 90.0, 35.0, 0.0, 0.0, 100.0, 115.0, 140.0, 190.0, 0.0, 135.0, 0.0, 75.0, 270.0, 155.0, 0.0, 0.0, 70.0, 155.0, 45.0, 0.0, 165.0, 75.0, 125.0, 0.0, 40.0, 255.0, 165.0, 0.0, 75.0, 225.0, 50.0, 0.0, 65.0, 110.0, 60.0, 0.0, 0.0, 0.0, 240.0, 20.0, 255.0, 80.0, 50.0, 90.0, 115.0, 110.0, 130.0, 75.0, 75.0, 50.0, 20.0, 15.0, 50.0, 0.0, 0.0, 75.0, 85.0, 0.0, 105.0, 0.0, 0.0, 0.0, 50.0, 35.0, 65.0, 15.0, 60.0, 215.0, 30.0, 0.0, 210.0, 215.0, 15.0, 95.0, 235.0, 155.0, 280.0, 30.0, 0.0, 5.0, 50.0, 135.0, 0.0, 50.0, 0.0, 0.0, 45.0, 0.0, 55.0, 20.0, 95.0, 0.0, 50.0, 55.0, 195.0, 65.0, 65.0, 50.0, 30.0, 690.0, 0.0, 160.0, 40.0, 120.0, 45.0, 0.0, 50.0, 30.0, 0.0, 0.0, 0.0, 0.0, 75.0, 130.0, 45.0, 60.0, 90.0, 0.0, 95.0, 20.0, 5.0, 100.0, 0.0, 35.0, 45.0, 0.0, 0.0, 0.0, 75.0, 40.0, 65.0, 65.0, 50.0, 90.0, 65.0, 70.0, 60.0, 40.0, 65.0, 0.0, 65.0, 15.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9931187016771993, "mean_inference_ms": 1.6849043043733303, "mean_action_processing_ms": 0.37593508424381766, "mean_env_wait_ms": 0.26426358571552294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007631063461303711, "StateBufferConnector_ms": 0.005107283592224121, "ViewRequirementAgentConnector_ms": 0.15109527111053467}, "num_episodes": 18, "episode_return_max": 616.0, "episode_return_min": -1628.0, "episode_return_mean": 366.39, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.49516220610597, "num_env_steps_trained_throughput_per_sec": 54.49516220610597, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 1368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 126818.294, "restore_workers_time_ms": 0.014, "training_step_time_ms": 126818.24, "sample_time_ms": 1485.229, "learn_time_ms": 125313.498, "learn_throughput": 31.92, "synch_weights_time_ms": 15.697}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "training_iteration": 57, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-37-45", "timestamp": 1723491465, "time_this_iter_s": 73.45629620552063, "time_total_s": 4869.371251821518, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2dd5160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4869.371251821518, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 36.37115384615384, "ram_util_percent": 82.32211538461539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5524172761444504, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4874040703401499, "policy_loss": -0.008351633852225537, "vf_loss": 1.4949306274665164, "vf_explained_var": -7.0247878419592025e-06, "kl": 0.005500099415673116, "entropy": 0.6298385892459687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 162150.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.739252258298245, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8948073091342095, "policy_loss": -0.01881308474093725, "vf_loss": 1.9125928394337919, "vf_explained_var": 0.026677609567946577, "kl": 0.010275494390732496, "entropy": 1.2676023711549476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 162150.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 616.0, "episode_reward_min": -4339.0, "episode_reward_mean": 289.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1923.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 990.0}, "policy_reward_mean": {"prey_policy": 13.806666666666667, "predator_policy": 82.71666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [253.0, 497.0, 509.0, 483.0, 443.0, 594.0, 445.0, 363.0, 616.0, 568.0, 582.0, 559.0, 138.0, 261.0, 502.0, 576.0, 528.0, 490.0, 525.0, 416.0, 441.0, 220.0, 477.0, 368.0, 446.0, 273.0, 306.0, -254.0, 539.0, 120.0, 273.0, 359.0, 253.0, 229.0, 275.0, 406.0, 316.0, 459.0, -249.0, 455.0, 94.0, 362.0, 600.0, -62.0, 468.0, 163.0, 360.0, 498.0, 510.0, 372.0, 600.0, 563.0, 208.0, 169.0, -21.0, 236.0, 558.0, 147.0, 452.0, 491.0, 341.0, 339.0, 439.0, -1628.0, 348.0, 497.0, 564.0, 356.0, 318.0, 202.0, 340.0, 493.0, 600.0, 384.0, 431.0, 344.0, 408.0, 387.0, 448.0, 46.0, 318.0, 439.0, 151.0, 127.0, 416.0, 361.0, 333.0, 379.0, -4339.0, 327.0, 460.0, -471.0, 383.0, 540.0, 321.0, 111.0, 349.0, 150.0, 517.0, 600.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-295.0, 189.0, 79.0, 24.0, 178.0, 145.0, 189.0, 2.0, 68.0, 145.0, 101.0, 167.0, 101.0, -53.0, 200.0, 189.0, 200.0, 200.0, 13.0, 68.0, 189.0, 68.0, 68.0, 112.0, 200.0, 200.0, -174.0, 68.0, 200.0, 200.0, 200.0, 167.0, 200.0, 200.0, 200.0, 24.0, -53.0, 167.0, -636.0, -229.0, 145.0, 35.0, 46.0, 200.0, 156.0, 200.0, 200.0, 156.0, 200.0, -42.0, 200.0, 200.0, 200.0, -570.0, 200.0, 112.0, 123.0, 156.0, 68.0, 2.0, 200.0, -86.0, 167.0, 167.0, -152.0, -350.0, 46.0, -218.0, 189.0, 145.0, 112.0, -9.0, 79.0, 112.0, 200.0, -207.0, 68.0, 112.0, 79.0, 68.0, -86.0, -251.0, -196.0, -97.0, -75.0, 189.0, 200.0, 112.0, -130.0, -262.0, 24.0, -9.0, 123.0, 79.0, 145.0, 35.0, -31.0, -361.0, 200.0, -97.0, 2.0, 189.0, 200.0, 200.0, -625.0, 200.0, 46.0, 90.0, 57.0, 200.0, -141.0, 57.0, 200.0, -163.0, -174.0, -350.0, -20.0, -119.0, 167.0, 167.0, -130.0, -9.0, -42.0, -108.0, 90.0, 145.0, 200.0, 200.0, 200.0, -449.0, -240.0, 112.0, 200.0, 57.0, -9.0, -31.0, -86.0, -75.0, -20.0, 35.0, 145.0, 79.0, 178.0, 156.0, 189.0, 68.0, 178.0, 200.0, 13.0, -31.0, 200.0, 200.0, 200.0, 200.0, 35.0, 178.0, -86.0, -196.0, 200.0, 57.0, 134.0, -262.0, -240.0, 167.0, -273.0, -493.0, 13.0, 46.0, 123.0, 200.0, 200.0, -42.0, 2.0, 2.0, 90.0, 112.0, 200.0, 79.0, 112.0, 200.0, 2.0, 189.0, 35.0, 13.0, -42.0, 68.0, -20.0, 178.0, 101.0, -966.0, -295.0, -1087.0, -64.0, 200.0, -108.0, 200.0, 79.0, 123.0, 200.0, 200.0, 134.0, 156.0, 90.0, 35.0, 156.0, -64.0, -9.0, 13.0, 13.0, -9.0, 112.0, -9.0, 112.0, 200.0, 79.0, 134.0, 200.0, 200.0, 200.0, 134.0, 101.0, -31.0, 46.0, -20.0, 200.0, 13.0, 46.0, 90.0, 68.0, 101.0, 134.0, 167.0, 46.0, 24.0, 200.0, 200.0, -207.0, -295.0, 46.0, -20.0, 200.0, -42.0, -75.0, 200.0, 24.0, 90.0, -570.0, -20.0, -119.0, -537.0, -262.0, 156.0, 2.0, 90.0, 189.0, 46.0, 189.0, -64.0, 134.0, 35.0, -31.0, 46.0, 134.0, -251.0, -1769.0, -1637.0, -1923.0, 79.0, -207.0, 200.0, 200.0, 189.0, -64.0, -317.0, -1032.0, -372.0, -141.0, 112.0, 112.0, 35.0, 200.0, 200.0, -97.0, 112.0, 46.0, -163.0, -295.0, 79.0, 13.0, 178.0, -42.0, -75.0, 2.0, -42.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 225.0, 55.0, 65.0, 60.0, 25.0, 70.0, 120.0, 60.0, 50.0, 20.0, 0.0, 25.0, 65.0, 105.0, 5.0, 0.0, 0.0, 50.0, 55.0, 70.0, 90.0, 10.0, 15.0, 100.0, 140.0, 150.0, 40.0, 60.0, 0.0, 0.0, 0.0, 15.0, 75.0, 40.0, 20.0, 70.0, 315.0, 275.0, 45.0, 240.0, 25.0, 0.0, 85.0, 15.0, 20.0, 0.0, 0.0, 100.0, 60.0, 10.0, 270.0, 230.0, 160.0, 35.0, 15.0, 40.0, 75.0, 55.0, 60.0, 90.0, 55.0, 15.0, 245.0, 145.0, 165.0, 105.0, 160.0, 195.0, 25.0, 95.0, 0.0, 0.0, 0.0, 55.0, 35.0, 85.0, 180.0, 55.0, 135.0, 55.0, 60.0, 5.0, 225.0, 125.0, 5.0, 95.0, 210.0, 130.0, 60.0, 10.0, 90.0, 35.0, 0.0, 0.0, 100.0, 115.0, 140.0, 190.0, 0.0, 135.0, 0.0, 75.0, 270.0, 155.0, 0.0, 0.0, 70.0, 155.0, 45.0, 0.0, 165.0, 75.0, 125.0, 0.0, 40.0, 255.0, 165.0, 0.0, 75.0, 225.0, 50.0, 0.0, 65.0, 110.0, 60.0, 0.0, 0.0, 0.0, 240.0, 20.0, 255.0, 80.0, 50.0, 90.0, 115.0, 110.0, 130.0, 75.0, 75.0, 50.0, 20.0, 15.0, 50.0, 0.0, 0.0, 75.0, 85.0, 0.0, 105.0, 0.0, 0.0, 0.0, 50.0, 35.0, 65.0, 15.0, 60.0, 215.0, 30.0, 0.0, 210.0, 215.0, 15.0, 95.0, 235.0, 155.0, 280.0, 30.0, 0.0, 5.0, 50.0, 135.0, 0.0, 50.0, 0.0, 0.0, 45.0, 0.0, 55.0, 20.0, 95.0, 0.0, 50.0, 55.0, 195.0, 65.0, 65.0, 50.0, 30.0, 690.0, 0.0, 160.0, 40.0, 120.0, 45.0, 0.0, 50.0, 30.0, 0.0, 0.0, 0.0, 0.0, 75.0, 130.0, 45.0, 60.0, 90.0, 0.0, 95.0, 20.0, 5.0, 100.0, 0.0, 35.0, 45.0, 0.0, 0.0, 0.0, 75.0, 40.0, 65.0, 65.0, 50.0, 90.0, 65.0, 70.0, 60.0, 40.0, 65.0, 0.0, 65.0, 15.0, 70.0, 0.0, 150.0, 105.0, 220.0, 70.0, 25.0, 105.0, 130.0, 0.0, 75.0, 0.0, 50.0, 305.0, 215.0, 340.0, 225.0, 220.0, 325.0, 0.0, 50.0, 85.0, 85.0, 70.0, 35.0, 45.0, 30.0, 120.0, 170.0, 205.0, 75.0, 0.0, 990.0, 0.0, 170.0, 55.0, 30.0, 120.0, 0.0, 15.0, 500.0, 415.0, 335.0, 155.0, 145.0, 0.0, 0.0, 60.0, 45.0, 115.0, 75.0, 70.0, 140.0, 135.0, 215.0, 105.0, 85.0, 10.0, 60.0, 65.0, 140.0, 95.0, 0.0, 75.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9928682379500943, "mean_inference_ms": 1.6827909668641905, "mean_action_processing_ms": 0.37602894002882176, "mean_env_wait_ms": 0.2640125885924229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004724621772766113, "StateBufferConnector_ms": 0.006034731864929199, "ViewRequirementAgentConnector_ms": 0.15385878086090088}, "num_episodes": 22, "episode_return_max": 616.0, "episode_return_min": -4339.0, "episode_return_mean": 289.57, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.443469018216135, "num_env_steps_trained_throughput_per_sec": 53.443469018216135, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 126923.205, "restore_workers_time_ms": 0.014, "training_step_time_ms": 126923.152, "sample_time_ms": 1494.484, "learn_time_ms": 125408.525, "learn_throughput": 31.896, "synch_weights_time_ms": 16.751}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 58, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-39-00", "timestamp": 1723491540, "time_this_iter_s": 74.87695097923279, "time_total_s": 4944.248202800751, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2324790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4944.248202800751, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 36.56698113207547, "ram_util_percent": 82.40283018867923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5963904734093246, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4859306932129759, "policy_loss": -0.009845592519033086, "vf_loss": 1.4949120019555937, "vf_explained_var": -2.432431735045521e-05, "kl": 0.005761383430940142, "entropy": 0.7122270241274056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 164970.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.252775760914417, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.481677104067718, "policy_loss": -0.01732193864997582, "vf_loss": 1.4978835751401618, "vf_explained_var": 0.02599701963840647, "kl": 0.01115467421591218, "entropy": 1.26746091897606, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 164970.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "env_runners": {"episode_reward_max": 645.0, "episode_reward_min": -4437.0, "episode_reward_mean": 208.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -19.56, "predator_policy": 89.03333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [525.0, 416.0, 441.0, 220.0, 477.0, 368.0, 446.0, 273.0, 306.0, -254.0, 539.0, 120.0, 273.0, 359.0, 253.0, 229.0, 275.0, 406.0, 316.0, 459.0, -249.0, 455.0, 94.0, 362.0, 600.0, -62.0, 468.0, 163.0, 360.0, 498.0, 510.0, 372.0, 600.0, 563.0, 208.0, 169.0, -21.0, 236.0, 558.0, 147.0, 452.0, 491.0, 341.0, 339.0, 439.0, -1628.0, 348.0, 497.0, 564.0, 356.0, 318.0, 202.0, 340.0, 493.0, 600.0, 384.0, 431.0, 344.0, 408.0, 387.0, 448.0, 46.0, 318.0, 439.0, 151.0, 127.0, 416.0, 361.0, 333.0, 379.0, -4339.0, 327.0, 460.0, -471.0, 383.0, 540.0, 321.0, 111.0, 349.0, 150.0, 517.0, 600.0, 319.0, 165.0, -4437.0, 309.0, 534.0, 592.0, 289.0, 496.0, 432.0, 434.0, 299.0, 645.0, 457.0, 205.0, 332.0, 268.0, -1441.0, 394.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 112.0, 123.0, 156.0, 68.0, 2.0, 200.0, -86.0, 167.0, 167.0, -152.0, -350.0, 46.0, -218.0, 189.0, 145.0, 112.0, -9.0, 79.0, 112.0, 200.0, -207.0, 68.0, 112.0, 79.0, 68.0, -86.0, -251.0, -196.0, -97.0, -75.0, 189.0, 200.0, 112.0, -130.0, -262.0, 24.0, -9.0, 123.0, 79.0, 145.0, 35.0, -31.0, -361.0, 200.0, -97.0, 2.0, 189.0, 200.0, 200.0, -625.0, 200.0, 46.0, 90.0, 57.0, 200.0, -141.0, 57.0, 200.0, -163.0, -174.0, -350.0, -20.0, -119.0, 167.0, 167.0, -130.0, -9.0, -42.0, -108.0, 90.0, 145.0, 200.0, 200.0, 200.0, -449.0, -240.0, 112.0, 200.0, 57.0, -9.0, -31.0, -86.0, -75.0, -20.0, 35.0, 145.0, 79.0, 178.0, 156.0, 189.0, 68.0, 178.0, 200.0, 13.0, -31.0, 200.0, 200.0, 200.0, 200.0, 35.0, 178.0, -86.0, -196.0, 200.0, 57.0, 134.0, -262.0, -240.0, 167.0, -273.0, -493.0, 13.0, 46.0, 123.0, 200.0, 200.0, -42.0, 2.0, 2.0, 90.0, 112.0, 200.0, 79.0, 112.0, 200.0, 2.0, 189.0, 35.0, 13.0, -42.0, 68.0, -20.0, 178.0, 101.0, -966.0, -295.0, -1087.0, -64.0, 200.0, -108.0, 200.0, 79.0, 123.0, 200.0, 200.0, 134.0, 156.0, 90.0, 35.0, 156.0, -64.0, -9.0, 13.0, 13.0, -9.0, 112.0, -9.0, 112.0, 200.0, 79.0, 134.0, 200.0, 200.0, 200.0, 134.0, 101.0, -31.0, 46.0, -20.0, 200.0, 13.0, 46.0, 90.0, 68.0, 101.0, 134.0, 167.0, 46.0, 24.0, 200.0, 200.0, -207.0, -295.0, 46.0, -20.0, 200.0, -42.0, -75.0, 200.0, 24.0, 90.0, -570.0, -20.0, -119.0, -537.0, -262.0, 156.0, 2.0, 90.0, 189.0, 46.0, 189.0, -64.0, 134.0, 35.0, -31.0, 46.0, 134.0, -251.0, -1769.0, -1637.0, -1923.0, 79.0, -207.0, 200.0, 200.0, 189.0, -64.0, -317.0, -1032.0, -372.0, -141.0, 112.0, 112.0, 35.0, 200.0, 200.0, -97.0, 112.0, 46.0, -163.0, -295.0, 79.0, 13.0, 178.0, -42.0, -75.0, 2.0, -42.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, -75.0, -31.0, 200.0, -251.0, 200.0, -64.0, -1967.0, -2000.0, -1505.0, -515.0, 90.0, 79.0, 79.0, 200.0, 200.0, 200.0, 2.0, 200.0, 13.0, -20.0, 46.0, 200.0, 123.0, 13.0, 90.0, 200.0, 2.0, 200.0, -9.0, 68.0, 35.0, 79.0, 35.0, 200.0, -625.0, 200.0, -53.0, 200.0, 90.0, 134.0, -86.0, -108.0, 46.0, 200.0, -9.0, -31.0, -130.0, 134.0, -592.0, -647.0, -757.0, 200.0, 90.0, 24.0], "policy_predator_policy_reward": [35.0, 15.0, 40.0, 75.0, 55.0, 60.0, 90.0, 55.0, 15.0, 245.0, 145.0, 165.0, 105.0, 160.0, 195.0, 25.0, 95.0, 0.0, 0.0, 0.0, 55.0, 35.0, 85.0, 180.0, 55.0, 135.0, 55.0, 60.0, 5.0, 225.0, 125.0, 5.0, 95.0, 210.0, 130.0, 60.0, 10.0, 90.0, 35.0, 0.0, 0.0, 100.0, 115.0, 140.0, 190.0, 0.0, 135.0, 0.0, 75.0, 270.0, 155.0, 0.0, 0.0, 70.0, 155.0, 45.0, 0.0, 165.0, 75.0, 125.0, 0.0, 40.0, 255.0, 165.0, 0.0, 75.0, 225.0, 50.0, 0.0, 65.0, 110.0, 60.0, 0.0, 0.0, 0.0, 240.0, 20.0, 255.0, 80.0, 50.0, 90.0, 115.0, 110.0, 130.0, 75.0, 75.0, 50.0, 20.0, 15.0, 50.0, 0.0, 0.0, 75.0, 85.0, 0.0, 105.0, 0.0, 0.0, 0.0, 50.0, 35.0, 65.0, 15.0, 60.0, 215.0, 30.0, 0.0, 210.0, 215.0, 15.0, 95.0, 235.0, 155.0, 280.0, 30.0, 0.0, 5.0, 50.0, 135.0, 0.0, 50.0, 0.0, 0.0, 45.0, 0.0, 55.0, 20.0, 95.0, 0.0, 50.0, 55.0, 195.0, 65.0, 65.0, 50.0, 30.0, 690.0, 0.0, 160.0, 40.0, 120.0, 45.0, 0.0, 50.0, 30.0, 0.0, 0.0, 0.0, 0.0, 75.0, 130.0, 45.0, 60.0, 90.0, 0.0, 95.0, 20.0, 5.0, 100.0, 0.0, 35.0, 45.0, 0.0, 0.0, 0.0, 75.0, 40.0, 65.0, 65.0, 50.0, 90.0, 65.0, 70.0, 60.0, 40.0, 65.0, 0.0, 65.0, 15.0, 70.0, 0.0, 150.0, 105.0, 220.0, 70.0, 25.0, 105.0, 130.0, 0.0, 75.0, 0.0, 50.0, 305.0, 215.0, 340.0, 225.0, 220.0, 325.0, 0.0, 50.0, 85.0, 85.0, 70.0, 35.0, 45.0, 30.0, 120.0, 170.0, 205.0, 75.0, 0.0, 990.0, 0.0, 170.0, 55.0, 30.0, 120.0, 0.0, 15.0, 500.0, 415.0, 335.0, 155.0, 145.0, 0.0, 0.0, 60.0, 45.0, 115.0, 75.0, 70.0, 140.0, 135.0, 215.0, 105.0, 85.0, 10.0, 60.0, 65.0, 140.0, 95.0, 0.0, 75.0, 0.0, 0.0, 0.0, 65.0, 45.0, 115.0, 40.0, 35.0, 205.0, 35.0, 1000.0, 0.0, 95.0, 300.0, 260.0, 0.0, 55.0, 0.0, 65.0, 80.0, 45.0, 90.0, 95.0, 65.0, 85.0, 35.0, 40.0, 0.0, 95.0, 45.0, 0.0, 80.0, 95.0, 20.0, 75.0, 55.0, 290.0, 345.0, 235.0, 0.0, 115.0, 105.0, 165.0, 70.0, 30.0, 95.0, 0.0, 0.0, 35.0, 145.0, 115.0, 20.0, 455.0, 80.0, 0.0, 80.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9920797525150354, "mean_inference_ms": 1.680897773059848, "mean_action_processing_ms": 0.3756665956364395, "mean_env_wait_ms": 0.2639690109739555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00460660457611084, "StateBufferConnector_ms": 0.005940556526184082, "ViewRequirementAgentConnector_ms": 0.14922809600830078}, "num_episodes": 18, "episode_return_max": 645.0, "episode_return_min": -4437.0, "episode_return_mean": 208.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.861780944565396, "num_env_steps_trained_throughput_per_sec": 54.861780944565396, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 1416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 126666.334, "restore_workers_time_ms": 0.014, "training_step_time_ms": 126666.281, "sample_time_ms": 1465.911, "learn_time_ms": 125180.281, "learn_throughput": 31.954, "synch_weights_time_ms": 16.668}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "training_iteration": 59, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-40-13", "timestamp": 1723491613, "time_this_iter_s": 72.96300482749939, "time_total_s": 5017.21120762825, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2dd5d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5017.21120762825, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 33.69134615384615, "ram_util_percent": 82.86057692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.530350610201663, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0433583120187968, "policy_loss": -0.007631540731758091, "vf_loss": 1.0501351091878635, "vf_explained_var": 4.1480394119912e-06, "kl": 0.005697951515104992, "entropy": 0.7394700748911986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 167790.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.26213677351145, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.342453629275163, "policy_loss": -0.016758126055934065, "vf_loss": 1.3583988779508476, "vf_explained_var": 0.03507541149643296, "kl": 0.008128783480882723, "entropy": 1.2551771160981333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 167790.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 645.0, "episode_reward_min": -4437.0, "episode_reward_mean": 204.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -19.706666666666667, "predator_policy": 87.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.0, 600.0, -62.0, 468.0, 163.0, 360.0, 498.0, 510.0, 372.0, 600.0, 563.0, 208.0, 169.0, -21.0, 236.0, 558.0, 147.0, 452.0, 491.0, 341.0, 339.0, 439.0, -1628.0, 348.0, 497.0, 564.0, 356.0, 318.0, 202.0, 340.0, 493.0, 600.0, 384.0, 431.0, 344.0, 408.0, 387.0, 448.0, 46.0, 318.0, 439.0, 151.0, 127.0, 416.0, 361.0, 333.0, 379.0, -4339.0, 327.0, 460.0, -471.0, 383.0, 540.0, 321.0, 111.0, 349.0, 150.0, 517.0, 600.0, 319.0, 165.0, -4437.0, 309.0, 534.0, 592.0, 289.0, 496.0, 432.0, 434.0, 299.0, 645.0, 457.0, 205.0, 332.0, 268.0, -1441.0, 394.0, 132.0, 522.0, 333.0, 321.0, 486.0, 551.0, -249.0, 336.0, 521.0, 516.0, -180.0, 205.0, 600.0, 245.0, 600.0, 251.0, 356.0, 28.0, 430.0, 45.0, -124.0, -153.0, 576.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-108.0, 90.0, 145.0, 200.0, 200.0, 200.0, -449.0, -240.0, 112.0, 200.0, 57.0, -9.0, -31.0, -86.0, -75.0, -20.0, 35.0, 145.0, 79.0, 178.0, 156.0, 189.0, 68.0, 178.0, 200.0, 13.0, -31.0, 200.0, 200.0, 200.0, 200.0, 35.0, 178.0, -86.0, -196.0, 200.0, 57.0, 134.0, -262.0, -240.0, 167.0, -273.0, -493.0, 13.0, 46.0, 123.0, 200.0, 200.0, -42.0, 2.0, 2.0, 90.0, 112.0, 200.0, 79.0, 112.0, 200.0, 2.0, 189.0, 35.0, 13.0, -42.0, 68.0, -20.0, 178.0, 101.0, -966.0, -295.0, -1087.0, -64.0, 200.0, -108.0, 200.0, 79.0, 123.0, 200.0, 200.0, 134.0, 156.0, 90.0, 35.0, 156.0, -64.0, -9.0, 13.0, 13.0, -9.0, 112.0, -9.0, 112.0, 200.0, 79.0, 134.0, 200.0, 200.0, 200.0, 134.0, 101.0, -31.0, 46.0, -20.0, 200.0, 13.0, 46.0, 90.0, 68.0, 101.0, 134.0, 167.0, 46.0, 24.0, 200.0, 200.0, -207.0, -295.0, 46.0, -20.0, 200.0, -42.0, -75.0, 200.0, 24.0, 90.0, -570.0, -20.0, -119.0, -537.0, -262.0, 156.0, 2.0, 90.0, 189.0, 46.0, 189.0, -64.0, 134.0, 35.0, -31.0, 46.0, 134.0, -251.0, -1769.0, -1637.0, -1923.0, 79.0, -207.0, 200.0, 200.0, 189.0, -64.0, -317.0, -1032.0, -372.0, -141.0, 112.0, 112.0, 35.0, 200.0, 200.0, -97.0, 112.0, 46.0, -163.0, -295.0, 79.0, 13.0, 178.0, -42.0, -75.0, 2.0, -42.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, -75.0, -31.0, 200.0, -251.0, 200.0, -64.0, -1967.0, -2000.0, -1505.0, -515.0, 90.0, 79.0, 79.0, 200.0, 200.0, 200.0, 2.0, 200.0, 13.0, -20.0, 46.0, 200.0, 123.0, 13.0, 90.0, 200.0, 2.0, 200.0, -9.0, 68.0, 35.0, 79.0, 35.0, 200.0, -625.0, 200.0, -53.0, 200.0, 90.0, 134.0, -86.0, -108.0, 46.0, 200.0, -9.0, -31.0, -130.0, 134.0, -592.0, -647.0, -757.0, 200.0, 90.0, 24.0, -361.0, 101.0, 57.0, 200.0, 200.0, 57.0, 101.0, 145.0, -108.0, 90.0, -119.0, 200.0, -9.0, 200.0, 200.0, 200.0, 200.0, 46.0, -548.0, 178.0, -449.0, 156.0, 57.0, -97.0, 189.0, 178.0, 24.0, 90.0, 46.0, 200.0, -207.0, -141.0, -427.0, 46.0, 13.0, -9.0, 200.0, 200.0, 200.0, -31.0, 145.0, -119.0, 200.0, 200.0, 200.0, 35.0, 57.0, -86.0, 35.0, 90.0, 46.0, -174.0, -97.0, 24.0, 134.0, 167.0, 24.0, -97.0, -64.0, -64.0, -152.0, -933.0, -9.0, 79.0, -42.0, -570.0, 156.0, 200.0, 200.0], "policy_predator_policy_reward": [65.0, 110.0, 60.0, 0.0, 0.0, 0.0, 240.0, 20.0, 255.0, 80.0, 50.0, 90.0, 115.0, 110.0, 130.0, 75.0, 75.0, 50.0, 20.0, 15.0, 50.0, 0.0, 0.0, 75.0, 85.0, 0.0, 105.0, 0.0, 0.0, 0.0, 50.0, 35.0, 65.0, 15.0, 60.0, 215.0, 30.0, 0.0, 210.0, 215.0, 15.0, 95.0, 235.0, 155.0, 280.0, 30.0, 0.0, 5.0, 50.0, 135.0, 0.0, 50.0, 0.0, 0.0, 45.0, 0.0, 55.0, 20.0, 95.0, 0.0, 50.0, 55.0, 195.0, 65.0, 65.0, 50.0, 30.0, 690.0, 0.0, 160.0, 40.0, 120.0, 45.0, 0.0, 50.0, 30.0, 0.0, 0.0, 0.0, 0.0, 75.0, 130.0, 45.0, 60.0, 90.0, 0.0, 95.0, 20.0, 5.0, 100.0, 0.0, 35.0, 45.0, 0.0, 0.0, 0.0, 75.0, 40.0, 65.0, 65.0, 50.0, 90.0, 65.0, 70.0, 60.0, 40.0, 65.0, 0.0, 65.0, 15.0, 70.0, 0.0, 150.0, 105.0, 220.0, 70.0, 25.0, 105.0, 130.0, 0.0, 75.0, 0.0, 50.0, 305.0, 215.0, 340.0, 225.0, 220.0, 325.0, 0.0, 50.0, 85.0, 85.0, 70.0, 35.0, 45.0, 30.0, 120.0, 170.0, 205.0, 75.0, 0.0, 990.0, 0.0, 170.0, 55.0, 30.0, 120.0, 0.0, 15.0, 500.0, 415.0, 335.0, 155.0, 145.0, 0.0, 0.0, 60.0, 45.0, 115.0, 75.0, 70.0, 140.0, 135.0, 215.0, 105.0, 85.0, 10.0, 60.0, 65.0, 140.0, 95.0, 0.0, 75.0, 0.0, 0.0, 0.0, 65.0, 45.0, 115.0, 40.0, 35.0, 205.0, 35.0, 1000.0, 0.0, 95.0, 300.0, 260.0, 0.0, 55.0, 0.0, 65.0, 80.0, 45.0, 90.0, 95.0, 65.0, 85.0, 35.0, 40.0, 0.0, 95.0, 45.0, 0.0, 80.0, 95.0, 20.0, 75.0, 55.0, 290.0, 345.0, 235.0, 0.0, 115.0, 105.0, 165.0, 70.0, 30.0, 95.0, 0.0, 0.0, 35.0, 145.0, 115.0, 20.0, 455.0, 80.0, 0.0, 80.0, 0.0, 80.0, 255.0, 0.0, 0.0, 60.0, 5.0, 140.0, 55.0, 0.0, 150.0, 0.0, 0.0, 0.0, 0.0, 95.0, 0.0, 70.0, 35.0, 350.0, 35.0, 185.0, 65.0, 135.0, 20.0, 80.0, 15.0, 35.0, 60.0, 50.0, 70.0, 190.0, 285.0, 120.0, 80.0, 0.0, 75.0, 0.0, 0.0, 0.0, 250.0, 0.0, 0.0, 0.0, 0.0, 0.0, 130.0, 40.0, 75.0, 70.0, 45.0, 70.0, 170.0, 0.0, 105.0, 80.0, 10.0, 15.0, 85.0, 130.0, 55.0, 295.0, 195.0, 480.0, 0.0, 0.0, 380.0, 0.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9913599998360801, "mean_inference_ms": 1.678394244851789, "mean_action_processing_ms": 0.3755300615751861, "mean_env_wait_ms": 0.2638384986130455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050057172775268555, "StateBufferConnector_ms": 0.006058216094970703, "ViewRequirementAgentConnector_ms": 0.1518326997756958}, "num_episodes": 23, "episode_return_max": 645.0, "episode_return_min": -4437.0, "episode_return_mean": 204.43, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.63536034716705, "num_env_steps_trained_throughput_per_sec": 54.63536034716705, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 126611.597, "restore_workers_time_ms": 0.014, "training_step_time_ms": 126611.547, "sample_time_ms": 1468.429, "learn_time_ms": 125122.764, "learn_throughput": 31.969, "synch_weights_time_ms": 16.866}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 60, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-41-26", "timestamp": 1723491686, "time_this_iter_s": 73.27215886116028, "time_total_s": 5090.48336648941, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2332820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5090.48336648941, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 34.17115384615384, "ram_util_percent": 83.04807692307692}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.426803667848626, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.778466428467568, "policy_loss": -0.007652289538376127, "vf_loss": 0.7850273943327842, "vf_explained_var": -4.969399871555626e-06, "kl": 0.007275307457098622, "entropy": 0.6799424448123215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 170610.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1591683027909157, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7971982916539654, "policy_loss": -0.019511900980463945, "vf_loss": 0.8159566134795653, "vf_explained_var": 0.046375586800541435, "kl": 0.0075357873776499724, "entropy": 1.2716736433776559, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 170610.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "env_runners": {"episode_reward_max": 645.0, "episode_reward_min": -4437.0, "episode_reward_mean": 201.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -21.76, "predator_policy": 89.06666666666666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [491.0, 341.0, 339.0, 439.0, -1628.0, 348.0, 497.0, 564.0, 356.0, 318.0, 202.0, 340.0, 493.0, 600.0, 384.0, 431.0, 344.0, 408.0, 387.0, 448.0, 46.0, 318.0, 439.0, 151.0, 127.0, 416.0, 361.0, 333.0, 379.0, -4339.0, 327.0, 460.0, -471.0, 383.0, 540.0, 321.0, 111.0, 349.0, 150.0, 517.0, 600.0, 319.0, 165.0, -4437.0, 309.0, 534.0, 592.0, 289.0, 496.0, 432.0, 434.0, 299.0, 645.0, 457.0, 205.0, 332.0, 268.0, -1441.0, 394.0, 132.0, 522.0, 333.0, 321.0, 486.0, 551.0, -249.0, 336.0, 521.0, 516.0, -180.0, 205.0, 600.0, 245.0, 600.0, 251.0, 356.0, 28.0, 430.0, 45.0, -124.0, -153.0, 576.0, -299.0, 424.0, 460.0, 588.0, 515.0, 246.0, 197.0, 16.0, 507.0, 498.0, 207.0, 419.0, 276.0, 570.0, 405.0, 508.0, 474.0, -79.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.0, 112.0, 200.0, 2.0, 189.0, 35.0, 13.0, -42.0, 68.0, -20.0, 178.0, 101.0, -966.0, -295.0, -1087.0, -64.0, 200.0, -108.0, 200.0, 79.0, 123.0, 200.0, 200.0, 134.0, 156.0, 90.0, 35.0, 156.0, -64.0, -9.0, 13.0, 13.0, -9.0, 112.0, -9.0, 112.0, 200.0, 79.0, 134.0, 200.0, 200.0, 200.0, 134.0, 101.0, -31.0, 46.0, -20.0, 200.0, 13.0, 46.0, 90.0, 68.0, 101.0, 134.0, 167.0, 46.0, 24.0, 200.0, 200.0, -207.0, -295.0, 46.0, -20.0, 200.0, -42.0, -75.0, 200.0, 24.0, 90.0, -570.0, -20.0, -119.0, -537.0, -262.0, 156.0, 2.0, 90.0, 189.0, 46.0, 189.0, -64.0, 134.0, 35.0, -31.0, 46.0, 134.0, -251.0, -1769.0, -1637.0, -1923.0, 79.0, -207.0, 200.0, 200.0, 189.0, -64.0, -317.0, -1032.0, -372.0, -141.0, 112.0, 112.0, 35.0, 200.0, 200.0, -97.0, 112.0, 46.0, -163.0, -295.0, 79.0, 13.0, 178.0, -42.0, -75.0, 2.0, -42.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, -75.0, -31.0, 200.0, -251.0, 200.0, -64.0, -1967.0, -2000.0, -1505.0, -515.0, 90.0, 79.0, 79.0, 200.0, 200.0, 200.0, 2.0, 200.0, 13.0, -20.0, 46.0, 200.0, 123.0, 13.0, 90.0, 200.0, 2.0, 200.0, -9.0, 68.0, 35.0, 79.0, 35.0, 200.0, -625.0, 200.0, -53.0, 200.0, 90.0, 134.0, -86.0, -108.0, 46.0, 200.0, -9.0, -31.0, -130.0, 134.0, -592.0, -647.0, -757.0, 200.0, 90.0, 24.0, -361.0, 101.0, 57.0, 200.0, 200.0, 57.0, 101.0, 145.0, -108.0, 90.0, -119.0, 200.0, -9.0, 200.0, 200.0, 200.0, 200.0, 46.0, -548.0, 178.0, -449.0, 156.0, 57.0, -97.0, 189.0, 178.0, 24.0, 90.0, 46.0, 200.0, -207.0, -141.0, -427.0, 46.0, 13.0, -9.0, 200.0, 200.0, 200.0, -31.0, 145.0, -119.0, 200.0, 200.0, 200.0, 35.0, 57.0, -86.0, 35.0, 90.0, 46.0, -174.0, -97.0, 24.0, 134.0, 167.0, 24.0, -97.0, -64.0, -64.0, -152.0, -933.0, -9.0, 79.0, -42.0, -570.0, 156.0, 200.0, 200.0, -493.0, 134.0, -515.0, -42.0, 200.0, 156.0, 189.0, 24.0, 112.0, 200.0, 200.0, 178.0, 200.0, 156.0, 79.0, -42.0, -9.0, 57.0, 90.0, -75.0, -53.0, 46.0, -20.0, -955.0, 200.0, 189.0, 13.0, 24.0, 134.0, 200.0, -207.0, 167.0, -53.0, 200.0, -97.0, 101.0, -20.0, -20.0, -9.0, 200.0, 145.0, 200.0, 200.0, 57.0, -42.0, 13.0, 200.0, 200.0, 200.0, 200.0, -31.0, -53.0, -53.0, -328.0], "policy_predator_policy_reward": [45.0, 0.0, 55.0, 20.0, 95.0, 0.0, 50.0, 55.0, 195.0, 65.0, 65.0, 50.0, 30.0, 690.0, 0.0, 160.0, 40.0, 120.0, 45.0, 0.0, 50.0, 30.0, 0.0, 0.0, 0.0, 0.0, 75.0, 130.0, 45.0, 60.0, 90.0, 0.0, 95.0, 20.0, 5.0, 100.0, 0.0, 35.0, 45.0, 0.0, 0.0, 0.0, 75.0, 40.0, 65.0, 65.0, 50.0, 90.0, 65.0, 70.0, 60.0, 40.0, 65.0, 0.0, 65.0, 15.0, 70.0, 0.0, 150.0, 105.0, 220.0, 70.0, 25.0, 105.0, 130.0, 0.0, 75.0, 0.0, 50.0, 305.0, 215.0, 340.0, 225.0, 220.0, 325.0, 0.0, 50.0, 85.0, 85.0, 70.0, 35.0, 45.0, 30.0, 120.0, 170.0, 205.0, 75.0, 0.0, 990.0, 0.0, 170.0, 55.0, 30.0, 120.0, 0.0, 15.0, 500.0, 415.0, 335.0, 155.0, 145.0, 0.0, 0.0, 60.0, 45.0, 115.0, 75.0, 70.0, 140.0, 135.0, 215.0, 105.0, 85.0, 10.0, 60.0, 65.0, 140.0, 95.0, 0.0, 75.0, 0.0, 0.0, 0.0, 65.0, 45.0, 115.0, 40.0, 35.0, 205.0, 35.0, 1000.0, 0.0, 95.0, 300.0, 260.0, 0.0, 55.0, 0.0, 65.0, 80.0, 45.0, 90.0, 95.0, 65.0, 85.0, 35.0, 40.0, 0.0, 95.0, 45.0, 0.0, 80.0, 95.0, 20.0, 75.0, 55.0, 290.0, 345.0, 235.0, 0.0, 115.0, 105.0, 165.0, 70.0, 30.0, 95.0, 0.0, 0.0, 35.0, 145.0, 115.0, 20.0, 455.0, 80.0, 0.0, 80.0, 0.0, 80.0, 255.0, 0.0, 0.0, 60.0, 5.0, 140.0, 55.0, 0.0, 150.0, 0.0, 0.0, 0.0, 0.0, 95.0, 0.0, 70.0, 35.0, 350.0, 35.0, 185.0, 65.0, 135.0, 20.0, 80.0, 15.0, 35.0, 60.0, 50.0, 70.0, 190.0, 285.0, 120.0, 80.0, 0.0, 75.0, 0.0, 0.0, 0.0, 250.0, 0.0, 0.0, 0.0, 0.0, 0.0, 130.0, 40.0, 75.0, 70.0, 45.0, 70.0, 170.0, 0.0, 105.0, 80.0, 10.0, 15.0, 85.0, 130.0, 55.0, 295.0, 195.0, 480.0, 0.0, 0.0, 380.0, 0.0, 20.0, 0.0, 185.0, 50.0, 340.0, 0.0, 110.0, 0.0, 100.0, 35.0, 0.0, 0.0, 0.0, 10.0, 25.0, 0.0, 55.0, 0.0, 125.0, 115.0, 70.0, 125.0, 40.0, 360.0, 360.0, 225.0, 0.0, 15.0, 90.0, 40.0, 35.0, 65.0, 140.0, 60.0, 100.0, 0.0, 135.0, 80.0, 110.0, 90.0, 125.0, 25.0, 0.0, 0.0, 0.0, 75.0, 115.0, 0.0, 70.0, 25.0, 0.0, 105.0, 0.0, 115.0, 0.0, 240.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9908181685530297, "mean_inference_ms": 1.6765992183996008, "mean_action_processing_ms": 0.37536152212606483, "mean_env_wait_ms": 0.26376419392342787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005666375160217285, "StateBufferConnector_ms": 0.00523221492767334, "ViewRequirementAgentConnector_ms": 0.14962267875671387}, "num_episodes": 18, "episode_return_max": 645.0, "episode_return_min": -4437.0, "episode_return_mean": 201.92, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.23334734981866, "num_env_steps_trained_throughput_per_sec": 54.23334734981866, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 1464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 126635.1, "restore_workers_time_ms": 0.014, "training_step_time_ms": 126635.049, "sample_time_ms": 1473.409, "learn_time_ms": 125141.365, "learn_throughput": 31.964, "synch_weights_time_ms": 16.637}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "training_iteration": 61, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-42-40", "timestamp": 1723491760, "time_this_iter_s": 73.7945909500122, "time_total_s": 5164.277957439423, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b104c280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5164.277957439423, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 35.4701923076923, "ram_util_percent": 83.14230769230768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.473935382533158, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.17347651115546, "policy_loss": -0.008234385149685521, "vf_loss": 1.1809159642521372, "vf_explained_var": -4.55910009695283e-06, "kl": 0.005299134358571805, "entropy": 0.6728979759816582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 173430.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.344819350043933, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4256152458330418, "policy_loss": -0.017766721161375076, "vf_loss": 1.4424986527321186, "vf_explained_var": 0.024762448435979533, "kl": 0.008833167642247735, "entropy": 1.2763211267214294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 173430.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 645.0, "episode_reward_min": -4437.0, "episode_reward_mean": 169.79, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -38.736666666666665, "predator_policy": 95.33333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [387.0, 448.0, 46.0, 318.0, 439.0, 151.0, 127.0, 416.0, 361.0, 333.0, 379.0, -4339.0, 327.0, 460.0, -471.0, 383.0, 540.0, 321.0, 111.0, 349.0, 150.0, 517.0, 600.0, 319.0, 165.0, -4437.0, 309.0, 534.0, 592.0, 289.0, 496.0, 432.0, 434.0, 299.0, 645.0, 457.0, 205.0, 332.0, 268.0, -1441.0, 394.0, 132.0, 522.0, 333.0, 321.0, 486.0, 551.0, -249.0, 336.0, 521.0, 516.0, -180.0, 205.0, 600.0, 245.0, 600.0, 251.0, 356.0, 28.0, 430.0, 45.0, -124.0, -153.0, 576.0, -299.0, 424.0, 460.0, 588.0, 515.0, 246.0, 197.0, 16.0, 507.0, 498.0, 207.0, 419.0, 276.0, 570.0, 405.0, 508.0, 474.0, -79.0, 308.0, 494.0, 403.0, 390.0, 292.0, -33.0, 440.0, -59.0, 432.0, -842.0, 483.0, 443.0, 411.0, 252.0, 465.0, -2360.0, 43.0, 492.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [167.0, 46.0, 24.0, 200.0, 200.0, -207.0, -295.0, 46.0, -20.0, 200.0, -42.0, -75.0, 200.0, 24.0, 90.0, -570.0, -20.0, -119.0, -537.0, -262.0, 156.0, 2.0, 90.0, 189.0, 46.0, 189.0, -64.0, 134.0, 35.0, -31.0, 46.0, 134.0, -251.0, -1769.0, -1637.0, -1923.0, 79.0, -207.0, 200.0, 200.0, 189.0, -64.0, -317.0, -1032.0, -372.0, -141.0, 112.0, 112.0, 35.0, 200.0, 200.0, -97.0, 112.0, 46.0, -163.0, -295.0, 79.0, 13.0, 178.0, -42.0, -75.0, 2.0, -42.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, -75.0, -31.0, 200.0, -251.0, 200.0, -64.0, -1967.0, -2000.0, -1505.0, -515.0, 90.0, 79.0, 79.0, 200.0, 200.0, 200.0, 2.0, 200.0, 13.0, -20.0, 46.0, 200.0, 123.0, 13.0, 90.0, 200.0, 2.0, 200.0, -9.0, 68.0, 35.0, 79.0, 35.0, 200.0, -625.0, 200.0, -53.0, 200.0, 90.0, 134.0, -86.0, -108.0, 46.0, 200.0, -9.0, -31.0, -130.0, 134.0, -592.0, -647.0, -757.0, 200.0, 90.0, 24.0, -361.0, 101.0, 57.0, 200.0, 200.0, 57.0, 101.0, 145.0, -108.0, 90.0, -119.0, 200.0, -9.0, 200.0, 200.0, 200.0, 200.0, 46.0, -548.0, 178.0, -449.0, 156.0, 57.0, -97.0, 189.0, 178.0, 24.0, 90.0, 46.0, 200.0, -207.0, -141.0, -427.0, 46.0, 13.0, -9.0, 200.0, 200.0, 200.0, -31.0, 145.0, -119.0, 200.0, 200.0, 200.0, 35.0, 57.0, -86.0, 35.0, 90.0, 46.0, -174.0, -97.0, 24.0, 134.0, 167.0, 24.0, -97.0, -64.0, -64.0, -152.0, -933.0, -9.0, 79.0, -42.0, -570.0, 156.0, 200.0, 200.0, -493.0, 134.0, -515.0, -42.0, 200.0, 156.0, 189.0, 24.0, 112.0, 200.0, 200.0, 178.0, 200.0, 156.0, 79.0, -42.0, -9.0, 57.0, 90.0, -75.0, -53.0, 46.0, -20.0, -955.0, 200.0, 189.0, 13.0, 24.0, 134.0, 200.0, -207.0, 167.0, -53.0, 200.0, -97.0, 101.0, -20.0, -20.0, -9.0, 200.0, 145.0, 200.0, 200.0, 57.0, -42.0, 13.0, 200.0, 200.0, 200.0, 200.0, -31.0, -53.0, -53.0, -328.0, 200.0, -273.0, -119.0, -31.0, 200.0, 90.0, 35.0, 200.0, 13.0, 35.0, 35.0, 200.0, 167.0, 46.0, -86.0, -163.0, -460.0, 200.0, -86.0, 200.0, 46.0, -75.0, -163.0, -141.0, -31.0, 123.0, 200.0, -702.0, 35.0, -680.0, 167.0, 178.0, 68.0, -31.0, 24.0, 200.0, 189.0, 68.0, 79.0, -31.0, 200.0, -42.0, 134.0, -31.0, 167.0, -1692.0, -1747.0, -251.0, -119.0, 134.0, -152.0, 123.0, 200.0, 79.0], "policy_predator_policy_reward": [65.0, 15.0, 70.0, 0.0, 150.0, 105.0, 220.0, 70.0, 25.0, 105.0, 130.0, 0.0, 75.0, 0.0, 50.0, 305.0, 215.0, 340.0, 225.0, 220.0, 325.0, 0.0, 50.0, 85.0, 85.0, 70.0, 35.0, 45.0, 30.0, 120.0, 170.0, 205.0, 75.0, 0.0, 990.0, 0.0, 170.0, 55.0, 30.0, 120.0, 0.0, 15.0, 500.0, 415.0, 335.0, 155.0, 145.0, 0.0, 0.0, 60.0, 45.0, 115.0, 75.0, 70.0, 140.0, 135.0, 215.0, 105.0, 85.0, 10.0, 60.0, 65.0, 140.0, 95.0, 0.0, 75.0, 0.0, 0.0, 0.0, 65.0, 45.0, 115.0, 40.0, 35.0, 205.0, 35.0, 1000.0, 0.0, 95.0, 300.0, 260.0, 0.0, 55.0, 0.0, 65.0, 80.0, 45.0, 90.0, 95.0, 65.0, 85.0, 35.0, 40.0, 0.0, 95.0, 45.0, 0.0, 80.0, 95.0, 20.0, 75.0, 55.0, 290.0, 345.0, 235.0, 0.0, 115.0, 105.0, 165.0, 70.0, 30.0, 95.0, 0.0, 0.0, 35.0, 145.0, 115.0, 20.0, 455.0, 80.0, 0.0, 80.0, 0.0, 80.0, 255.0, 0.0, 0.0, 60.0, 5.0, 140.0, 55.0, 0.0, 150.0, 0.0, 0.0, 0.0, 0.0, 95.0, 0.0, 70.0, 35.0, 350.0, 35.0, 185.0, 65.0, 135.0, 20.0, 80.0, 15.0, 35.0, 60.0, 50.0, 70.0, 190.0, 285.0, 120.0, 80.0, 0.0, 75.0, 0.0, 0.0, 0.0, 250.0, 0.0, 0.0, 0.0, 0.0, 0.0, 130.0, 40.0, 75.0, 70.0, 45.0, 70.0, 170.0, 0.0, 105.0, 80.0, 10.0, 15.0, 85.0, 130.0, 55.0, 295.0, 195.0, 480.0, 0.0, 0.0, 380.0, 0.0, 20.0, 0.0, 185.0, 50.0, 340.0, 0.0, 110.0, 0.0, 100.0, 35.0, 0.0, 0.0, 0.0, 10.0, 25.0, 0.0, 55.0, 0.0, 125.0, 115.0, 70.0, 125.0, 40.0, 360.0, 360.0, 225.0, 0.0, 15.0, 90.0, 40.0, 35.0, 65.0, 140.0, 60.0, 100.0, 0.0, 135.0, 80.0, 110.0, 90.0, 125.0, 25.0, 0.0, 0.0, 0.0, 75.0, 115.0, 0.0, 70.0, 25.0, 0.0, 105.0, 0.0, 115.0, 0.0, 240.0, 175.0, 195.0, 130.0, 50.0, 105.0, 80.0, 60.0, 65.0, 30.0, 5.0, 40.0, 75.0, 35.0, 0.0, 130.0, 15.0, 70.0, 305.0, 40.0, 195.0, 45.0, 90.0, 60.0, 170.0, 105.0, 5.0, 30.0, 445.0, 40.0, 20.0, 0.0, 70.0, 0.0, 100.0, 65.0, 85.0, 75.0, 0.0, 0.0, 0.0, 115.0, 10.0, 105.0, 50.0, 40.0, 915.0, 190.0, 225.0, 10.0, 0.0, 170.0, 45.0, 35.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9894045651643801, "mean_inference_ms": 1.6740275101100213, "mean_action_processing_ms": 0.37498066120011836, "mean_env_wait_ms": 0.26351160922540795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006246089935302734, "StateBufferConnector_ms": 0.0052530765533447266, "ViewRequirementAgentConnector_ms": 0.1511744260787964}, "num_episodes": 18, "episode_return_max": 645.0, "episode_return_min": -4437.0, "episode_return_mean": 169.79, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.906854798075365, "num_env_steps_trained_throughput_per_sec": 54.906854798075365, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 126593.396, "restore_workers_time_ms": 0.014, "training_step_time_ms": 126593.345, "sample_time_ms": 1470.647, "learn_time_ms": 125102.543, "learn_throughput": 31.974, "synch_weights_time_ms": 16.596}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 62, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-43-53", "timestamp": 1723491833, "time_this_iter_s": 72.89463186264038, "time_total_s": 5237.172589302063, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2332ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5237.172589302063, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 32.886407766990295, "ram_util_percent": 82.99999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5148776586121278, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9186161980984059, "policy_loss": -0.008127776880753524, "vf_loss": 0.9257261596778605, "vf_explained_var": 8.490723921052108e-06, "kl": 0.006785185802525521, "entropy": 0.6689755301526252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 176250.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.102605784531181, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7908704940156998, "policy_loss": -0.022733068235254852, "vf_loss": 0.8128269426207593, "vf_explained_var": 0.06493965059730178, "kl": 0.007766197209363306, "entropy": 1.2528644134812321, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 176250.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "env_runners": {"episode_reward_max": 645.0, "episode_reward_min": -4437.0, "episode_reward_mean": 235.13, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -5.59, "predator_policy": 83.96666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [600.0, 319.0, 165.0, -4437.0, 309.0, 534.0, 592.0, 289.0, 496.0, 432.0, 434.0, 299.0, 645.0, 457.0, 205.0, 332.0, 268.0, -1441.0, 394.0, 132.0, 522.0, 333.0, 321.0, 486.0, 551.0, -249.0, 336.0, 521.0, 516.0, -180.0, 205.0, 600.0, 245.0, 600.0, 251.0, 356.0, 28.0, 430.0, 45.0, -124.0, -153.0, 576.0, -299.0, 424.0, 460.0, 588.0, 515.0, 246.0, 197.0, 16.0, 507.0, 498.0, 207.0, 419.0, 276.0, 570.0, 405.0, 508.0, 474.0, -79.0, 308.0, 494.0, 403.0, 390.0, 292.0, -33.0, 440.0, -59.0, 432.0, -842.0, 483.0, 443.0, 411.0, 252.0, 465.0, -2360.0, 43.0, 492.0, 509.0, 600.0, 452.0, -24.0, 445.0, 373.0, 347.0, 273.0, 457.0, 438.0, 400.0, 396.0, 358.0, 516.0, 200.0, 257.0, 428.0, 373.0, 571.0, 508.0, 152.0, 258.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, -75.0, -31.0, 200.0, -251.0, 200.0, -64.0, -1967.0, -2000.0, -1505.0, -515.0, 90.0, 79.0, 79.0, 200.0, 200.0, 200.0, 2.0, 200.0, 13.0, -20.0, 46.0, 200.0, 123.0, 13.0, 90.0, 200.0, 2.0, 200.0, -9.0, 68.0, 35.0, 79.0, 35.0, 200.0, -625.0, 200.0, -53.0, 200.0, 90.0, 134.0, -86.0, -108.0, 46.0, 200.0, -9.0, -31.0, -130.0, 134.0, -592.0, -647.0, -757.0, 200.0, 90.0, 24.0, -361.0, 101.0, 57.0, 200.0, 200.0, 57.0, 101.0, 145.0, -108.0, 90.0, -119.0, 200.0, -9.0, 200.0, 200.0, 200.0, 200.0, 46.0, -548.0, 178.0, -449.0, 156.0, 57.0, -97.0, 189.0, 178.0, 24.0, 90.0, 46.0, 200.0, -207.0, -141.0, -427.0, 46.0, 13.0, -9.0, 200.0, 200.0, 200.0, -31.0, 145.0, -119.0, 200.0, 200.0, 200.0, 35.0, 57.0, -86.0, 35.0, 90.0, 46.0, -174.0, -97.0, 24.0, 134.0, 167.0, 24.0, -97.0, -64.0, -64.0, -152.0, -933.0, -9.0, 79.0, -42.0, -570.0, 156.0, 200.0, 200.0, -493.0, 134.0, -515.0, -42.0, 200.0, 156.0, 189.0, 24.0, 112.0, 200.0, 200.0, 178.0, 200.0, 156.0, 79.0, -42.0, -9.0, 57.0, 90.0, -75.0, -53.0, 46.0, -20.0, -955.0, 200.0, 189.0, 13.0, 24.0, 134.0, 200.0, -207.0, 167.0, -53.0, 200.0, -97.0, 101.0, -20.0, -20.0, -9.0, 200.0, 145.0, 200.0, 200.0, 57.0, -42.0, 13.0, 200.0, 200.0, 200.0, 200.0, -31.0, -53.0, -53.0, -328.0, 200.0, -273.0, -119.0, -31.0, 200.0, 90.0, 35.0, 200.0, 13.0, 35.0, 35.0, 200.0, 167.0, 46.0, -86.0, -163.0, -460.0, 200.0, -86.0, 200.0, 46.0, -75.0, -163.0, -141.0, -31.0, 123.0, 200.0, -702.0, 35.0, -680.0, 167.0, 178.0, 68.0, -31.0, 24.0, 200.0, 189.0, 68.0, 79.0, -31.0, 200.0, -42.0, 134.0, -31.0, 167.0, -1692.0, -1747.0, -251.0, -119.0, 134.0, -152.0, 123.0, 200.0, 79.0, 145.0, 134.0, 200.0, 200.0, 200.0, 200.0, 145.0, -42.0, 134.0, -130.0, -119.0, -75.0, 189.0, 24.0, 112.0, 57.0, 46.0, 200.0, 178.0, -185.0, -86.0, -97.0, 200.0, -130.0, -75.0, 134.0, 123.0, 200.0, 145.0, -42.0, -174.0, 200.0, 189.0, 156.0, -152.0, 57.0, 200.0, 13.0, -130.0, 46.0, 200.0, 200.0, 68.0, -218.0, 35.0, -53.0, 145.0, -75.0, -9.0, 134.0, 68.0, 123.0, 68.0, 57.0, 200.0, 46.0, 200.0, 178.0, 101.0, 24.0, -273.0, 134.0, -64.0, -163.0, -86.0, 167.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 65.0, 45.0, 115.0, 40.0, 35.0, 205.0, 35.0, 1000.0, 0.0, 95.0, 300.0, 260.0, 0.0, 55.0, 0.0, 65.0, 80.0, 45.0, 90.0, 95.0, 65.0, 85.0, 35.0, 40.0, 0.0, 95.0, 45.0, 0.0, 80.0, 95.0, 20.0, 75.0, 55.0, 290.0, 345.0, 235.0, 0.0, 115.0, 105.0, 165.0, 70.0, 30.0, 95.0, 0.0, 0.0, 35.0, 145.0, 115.0, 20.0, 455.0, 80.0, 0.0, 80.0, 0.0, 80.0, 255.0, 0.0, 0.0, 60.0, 5.0, 140.0, 55.0, 0.0, 150.0, 0.0, 0.0, 0.0, 0.0, 95.0, 0.0, 70.0, 35.0, 350.0, 35.0, 185.0, 65.0, 135.0, 20.0, 80.0, 15.0, 35.0, 60.0, 50.0, 70.0, 190.0, 285.0, 120.0, 80.0, 0.0, 75.0, 0.0, 0.0, 0.0, 250.0, 0.0, 0.0, 0.0, 0.0, 0.0, 130.0, 40.0, 75.0, 70.0, 45.0, 70.0, 170.0, 0.0, 105.0, 80.0, 10.0, 15.0, 85.0, 130.0, 55.0, 295.0, 195.0, 480.0, 0.0, 0.0, 380.0, 0.0, 20.0, 0.0, 185.0, 50.0, 340.0, 0.0, 110.0, 0.0, 100.0, 35.0, 0.0, 0.0, 0.0, 10.0, 25.0, 0.0, 55.0, 0.0, 125.0, 115.0, 70.0, 125.0, 40.0, 360.0, 360.0, 225.0, 0.0, 15.0, 90.0, 40.0, 35.0, 65.0, 140.0, 60.0, 100.0, 0.0, 135.0, 80.0, 110.0, 90.0, 125.0, 25.0, 0.0, 0.0, 0.0, 75.0, 115.0, 0.0, 70.0, 25.0, 0.0, 105.0, 0.0, 115.0, 0.0, 240.0, 175.0, 195.0, 130.0, 50.0, 105.0, 80.0, 60.0, 65.0, 30.0, 5.0, 40.0, 75.0, 35.0, 0.0, 130.0, 15.0, 70.0, 305.0, 40.0, 195.0, 45.0, 90.0, 60.0, 170.0, 105.0, 5.0, 30.0, 445.0, 40.0, 20.0, 0.0, 70.0, 0.0, 100.0, 65.0, 85.0, 75.0, 0.0, 0.0, 0.0, 115.0, 10.0, 105.0, 50.0, 40.0, 915.0, 190.0, 225.0, 10.0, 0.0, 170.0, 45.0, 35.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 80.0, 45.0, 90.0, 165.0, 45.0, 90.0, 5.0, 35.0, 80.0, 70.0, 0.0, 0.0, 110.0, 135.0, 195.0, 115.0, 140.0, 45.0, 125.0, 115.0, 35.0, 30.0, 0.0, 105.0, 5.0, 10.0, 170.0, 115.0, 105.0, 115.0, 110.0, 105.0, 60.0, 0.0, 70.0, 0.0, 40.0, 205.0, 70.0, 0.0, 125.0, 115.0, 135.0, 100.0, 0.0, 35.0, 0.0, 90.0, 50.0, 25.0, 50.0, 50.0, 80.0, 75.0, 75.0, 240.0, 40.0, 130.0, 60.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9876175052861835, "mean_inference_ms": 1.670433727371729, "mean_action_processing_ms": 0.37439962460080345, "mean_env_wait_ms": 0.26313304294299195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007556557655334473, "StateBufferConnector_ms": 0.004172682762145996, "ViewRequirementAgentConnector_ms": 0.1475600004196167}, "num_episodes": 22, "episode_return_max": 645.0, "episode_return_min": -4437.0, "episode_return_mean": 235.13, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.610495080844856, "num_env_steps_trained_throughput_per_sec": 54.610495080844856, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 126279.294, "restore_workers_time_ms": 0.014, "training_step_time_ms": 126279.244, "sample_time_ms": 1467.911, "learn_time_ms": 124791.981, "learn_throughput": 32.053, "synch_weights_time_ms": 15.834}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": false, "training_iteration": 63, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-45-06", "timestamp": 1723491906, "time_this_iter_s": 73.2572410106659, "time_total_s": 5310.429830312729, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b232aaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5310.429830312729, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 34.097115384615385, "ram_util_percent": 82.7826923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3917592172240112, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9117444230098251, "policy_loss": -0.006876826889239952, "vf_loss": 0.9177659637856145, "vf_explained_var": -2.1454100067733872e-05, "kl": 0.005701669519103299, "entropy": 0.6548069651667954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 179070.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.441555151660392, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8502147858763643, "policy_loss": -0.01948973134817252, "vf_loss": 0.8687728149310998, "vf_explained_var": 0.03250194380046628, "kl": 0.009317026809087291, "entropy": 1.2614118366799456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 179070.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -2360.0, "episode_reward_mean": 298.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1747.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 915.0}, "policy_reward_mean": {"prey_policy": 19.82, "predator_policy": 79.63333333333334}, "custom_metrics": {}, "hist_stats": {"episode_reward": [486.0, 551.0, -249.0, 336.0, 521.0, 516.0, -180.0, 205.0, 600.0, 245.0, 600.0, 251.0, 356.0, 28.0, 430.0, 45.0, -124.0, -153.0, 576.0, -299.0, 424.0, 460.0, 588.0, 515.0, 246.0, 197.0, 16.0, 507.0, 498.0, 207.0, 419.0, 276.0, 570.0, 405.0, 508.0, 474.0, -79.0, 308.0, 494.0, 403.0, 390.0, 292.0, -33.0, 440.0, -59.0, 432.0, -842.0, 483.0, 443.0, 411.0, 252.0, 465.0, -2360.0, 43.0, 492.0, 509.0, 600.0, 452.0, -24.0, 445.0, 373.0, 347.0, 273.0, 457.0, 438.0, 400.0, 396.0, 358.0, 516.0, 200.0, 257.0, 428.0, 373.0, 571.0, 508.0, 152.0, 258.0, 253.0, 463.0, 422.0, 495.0, 331.0, 490.0, 534.0, 553.0, 257.0, 428.0, 303.0, 471.0, 517.0, 528.0, 402.0, 600.0, 252.0, 430.0, 172.0, -694.0, 443.0, 369.0, 504.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.0, 200.0, 200.0, 200.0, 200.0, 46.0, -548.0, 178.0, -449.0, 156.0, 57.0, -97.0, 189.0, 178.0, 24.0, 90.0, 46.0, 200.0, -207.0, -141.0, -427.0, 46.0, 13.0, -9.0, 200.0, 200.0, 200.0, -31.0, 145.0, -119.0, 200.0, 200.0, 200.0, 35.0, 57.0, -86.0, 35.0, 90.0, 46.0, -174.0, -97.0, 24.0, 134.0, 167.0, 24.0, -97.0, -64.0, -64.0, -152.0, -933.0, -9.0, 79.0, -42.0, -570.0, 156.0, 200.0, 200.0, -493.0, 134.0, -515.0, -42.0, 200.0, 156.0, 189.0, 24.0, 112.0, 200.0, 200.0, 178.0, 200.0, 156.0, 79.0, -42.0, -9.0, 57.0, 90.0, -75.0, -53.0, 46.0, -20.0, -955.0, 200.0, 189.0, 13.0, 24.0, 134.0, 200.0, -207.0, 167.0, -53.0, 200.0, -97.0, 101.0, -20.0, -20.0, -9.0, 200.0, 145.0, 200.0, 200.0, 57.0, -42.0, 13.0, 200.0, 200.0, 200.0, 200.0, -31.0, -53.0, -53.0, -328.0, 200.0, -273.0, -119.0, -31.0, 200.0, 90.0, 35.0, 200.0, 13.0, 35.0, 35.0, 200.0, 167.0, 46.0, -86.0, -163.0, -460.0, 200.0, -86.0, 200.0, 46.0, -75.0, -163.0, -141.0, -31.0, 123.0, 200.0, -702.0, 35.0, -680.0, 167.0, 178.0, 68.0, -31.0, 24.0, 200.0, 189.0, 68.0, 79.0, -31.0, 200.0, -42.0, 134.0, -31.0, 167.0, -1692.0, -1747.0, -251.0, -119.0, 134.0, -152.0, 123.0, 200.0, 79.0, 145.0, 134.0, 200.0, 200.0, 200.0, 200.0, 145.0, -42.0, 134.0, -130.0, -119.0, -75.0, 189.0, 24.0, 112.0, 57.0, 46.0, 200.0, 178.0, -185.0, -86.0, -97.0, 200.0, -130.0, -75.0, 134.0, 123.0, 200.0, 145.0, -42.0, -174.0, 200.0, 189.0, 156.0, -152.0, 57.0, 200.0, 13.0, -130.0, 46.0, 200.0, 200.0, 68.0, -218.0, 35.0, -53.0, 145.0, -75.0, -9.0, 134.0, 68.0, 123.0, 68.0, 57.0, 200.0, 46.0, 200.0, 178.0, 101.0, 24.0, -273.0, 134.0, -64.0, -163.0, -86.0, 167.0, 134.0, -284.0, -152.0, 90.0, 123.0, 200.0, -20.0, 189.0, 13.0, 200.0, -20.0, 200.0, -20.0, -152.0, 123.0, 79.0, 156.0, 200.0, 35.0, 189.0, 200.0, -20.0, 200.0, 178.0, -31.0, 200.0, -42.0, 90.0, -207.0, 145.0, 167.0, -262.0, 68.0, 156.0, 68.0, 112.0, 200.0, 178.0, 24.0, 68.0, 200.0, 200.0, 101.0, 112.0, 134.0, 200.0, 200.0, 200.0, 13.0, 145.0, -251.0, -53.0, 13.0, 200.0, -42.0, -119.0, 68.0, -438.0, -119.0, -812.0, 200.0, -20.0, 68.0, 2.0, 178.0, 79.0, -251.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 95.0, 0.0, 70.0, 35.0, 350.0, 35.0, 185.0, 65.0, 135.0, 20.0, 80.0, 15.0, 35.0, 60.0, 50.0, 70.0, 190.0, 285.0, 120.0, 80.0, 0.0, 75.0, 0.0, 0.0, 0.0, 250.0, 0.0, 0.0, 0.0, 0.0, 0.0, 130.0, 40.0, 75.0, 70.0, 45.0, 70.0, 170.0, 0.0, 105.0, 80.0, 10.0, 15.0, 85.0, 130.0, 55.0, 295.0, 195.0, 480.0, 0.0, 0.0, 380.0, 0.0, 20.0, 0.0, 185.0, 50.0, 340.0, 0.0, 110.0, 0.0, 100.0, 35.0, 0.0, 0.0, 0.0, 10.0, 25.0, 0.0, 55.0, 0.0, 125.0, 115.0, 70.0, 125.0, 40.0, 360.0, 360.0, 225.0, 0.0, 15.0, 90.0, 40.0, 35.0, 65.0, 140.0, 60.0, 100.0, 0.0, 135.0, 80.0, 110.0, 90.0, 125.0, 25.0, 0.0, 0.0, 0.0, 75.0, 115.0, 0.0, 70.0, 25.0, 0.0, 105.0, 0.0, 115.0, 0.0, 240.0, 175.0, 195.0, 130.0, 50.0, 105.0, 80.0, 60.0, 65.0, 30.0, 5.0, 40.0, 75.0, 35.0, 0.0, 130.0, 15.0, 70.0, 305.0, 40.0, 195.0, 45.0, 90.0, 60.0, 170.0, 105.0, 5.0, 30.0, 445.0, 40.0, 20.0, 0.0, 70.0, 0.0, 100.0, 65.0, 85.0, 75.0, 0.0, 0.0, 0.0, 115.0, 10.0, 105.0, 50.0, 40.0, 915.0, 190.0, 225.0, 10.0, 0.0, 170.0, 45.0, 35.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 80.0, 45.0, 90.0, 165.0, 45.0, 90.0, 5.0, 35.0, 80.0, 70.0, 0.0, 0.0, 110.0, 135.0, 195.0, 115.0, 140.0, 45.0, 125.0, 115.0, 35.0, 30.0, 0.0, 105.0, 5.0, 10.0, 170.0, 115.0, 105.0, 115.0, 110.0, 105.0, 60.0, 0.0, 70.0, 0.0, 40.0, 205.0, 70.0, 0.0, 125.0, 115.0, 135.0, 100.0, 0.0, 35.0, 0.0, 90.0, 50.0, 25.0, 50.0, 50.0, 80.0, 75.0, 75.0, 240.0, 40.0, 130.0, 60.0, 150.0, 225.0, 195.0, 135.0, 0.0, 50.0, 0.0, 85.0, 100.0, 55.0, 15.0, 0.0, 100.0, 95.0, 140.0, 145.0, 0.0, 55.0, 0.0, 60.0, 0.0, 50.0, 35.0, 60.0, 100.0, 60.0, 0.0, 70.0, 155.0, 95.0, 150.0, 55.0, 230.0, 45.0, 30.0, 65.0, 40.0, 10.0, 40.0, 65.0, 0.0, 60.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 105.0, 25.0, 215.0, 125.0, 140.0, 5.0, 135.0, 75.0, 55.0, 535.0, 50.0, 90.0, 55.0, 60.0, 80.0, 20.0, 90.0, 0.0, 110.0, 50.0, 195.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9865105059675439, "mean_inference_ms": 1.6676085056005272, "mean_action_processing_ms": 0.37413112593284603, "mean_env_wait_ms": 0.2628527648415431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009911417961120605, "StateBufferConnector_ms": 0.00430750846862793, "ViewRequirementAgentConnector_ms": 0.15306627750396729}, "num_episodes": 23, "episode_return_max": 600.0, "episode_return_min": -2360.0, "episode_return_mean": 298.36, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.32471401935024, "num_env_steps_trained_throughput_per_sec": 53.32471401935024, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 126464.679, "restore_workers_time_ms": 0.015, "training_step_time_ms": 126464.627, "sample_time_ms": 1471.336, "learn_time_ms": 124973.777, "learn_throughput": 32.007, "synch_weights_time_ms": 16.022}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 64, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-46-21", "timestamp": 1723491981, "time_this_iter_s": 75.04025602340698, "time_total_s": 5385.470086336136, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b106aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5385.470086336136, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 35.88018867924528, "ram_util_percent": 82.92358490566036}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4139472371984458, "cur_kl_coeff": 0.15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8893673869523596, "policy_loss": -0.004719281711154089, "vf_loss": 0.8934325675592355, "vf_explained_var": -3.5321902721486195e-05, "kl": 0.004360365304715951, "entropy": 0.6906973024420704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 181890.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.014529386358269, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.987340839026192, "policy_loss": -0.018359637302049297, "vf_loss": 1.0047100060692071, "vf_explained_var": 0.022033753103398262, "kl": 0.009904724071781772, "entropy": 1.275610827850112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 181890.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -2360.0, "episode_reward_mean": 316.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1747.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 915.0}, "policy_reward_mean": {"prey_policy": 31.626666666666665, "predator_policy": 73.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [576.0, -299.0, 424.0, 460.0, 588.0, 515.0, 246.0, 197.0, 16.0, 507.0, 498.0, 207.0, 419.0, 276.0, 570.0, 405.0, 508.0, 474.0, -79.0, 308.0, 494.0, 403.0, 390.0, 292.0, -33.0, 440.0, -59.0, 432.0, -842.0, 483.0, 443.0, 411.0, 252.0, 465.0, -2360.0, 43.0, 492.0, 509.0, 600.0, 452.0, -24.0, 445.0, 373.0, 347.0, 273.0, 457.0, 438.0, 400.0, 396.0, 358.0, 516.0, 200.0, 257.0, 428.0, 373.0, 571.0, 508.0, 152.0, 258.0, 253.0, 463.0, 422.0, 495.0, 331.0, 490.0, 534.0, 553.0, 257.0, 428.0, 303.0, 471.0, 517.0, 528.0, 402.0, 600.0, 252.0, 430.0, 172.0, -694.0, 443.0, 369.0, 504.0, 395.0, 348.0, 534.0, 600.0, 398.0, 351.0, 380.0, 497.0, -66.0, 486.0, 600.0, 486.0, 400.0, 156.0, 366.0, 277.0, 582.0, -489.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.0, 200.0, 200.0, -493.0, 134.0, -515.0, -42.0, 200.0, 156.0, 189.0, 24.0, 112.0, 200.0, 200.0, 178.0, 200.0, 156.0, 79.0, -42.0, -9.0, 57.0, 90.0, -75.0, -53.0, 46.0, -20.0, -955.0, 200.0, 189.0, 13.0, 24.0, 134.0, 200.0, -207.0, 167.0, -53.0, 200.0, -97.0, 101.0, -20.0, -20.0, -9.0, 200.0, 145.0, 200.0, 200.0, 57.0, -42.0, 13.0, 200.0, 200.0, 200.0, 200.0, -31.0, -53.0, -53.0, -328.0, 200.0, -273.0, -119.0, -31.0, 200.0, 90.0, 35.0, 200.0, 13.0, 35.0, 35.0, 200.0, 167.0, 46.0, -86.0, -163.0, -460.0, 200.0, -86.0, 200.0, 46.0, -75.0, -163.0, -141.0, -31.0, 123.0, 200.0, -702.0, 35.0, -680.0, 167.0, 178.0, 68.0, -31.0, 24.0, 200.0, 189.0, 68.0, 79.0, -31.0, 200.0, -42.0, 134.0, -31.0, 167.0, -1692.0, -1747.0, -251.0, -119.0, 134.0, -152.0, 123.0, 200.0, 79.0, 145.0, 134.0, 200.0, 200.0, 200.0, 200.0, 145.0, -42.0, 134.0, -130.0, -119.0, -75.0, 189.0, 24.0, 112.0, 57.0, 46.0, 200.0, 178.0, -185.0, -86.0, -97.0, 200.0, -130.0, -75.0, 134.0, 123.0, 200.0, 145.0, -42.0, -174.0, 200.0, 189.0, 156.0, -152.0, 57.0, 200.0, 13.0, -130.0, 46.0, 200.0, 200.0, 68.0, -218.0, 35.0, -53.0, 145.0, -75.0, -9.0, 134.0, 68.0, 123.0, 68.0, 57.0, 200.0, 46.0, 200.0, 178.0, 101.0, 24.0, -273.0, 134.0, -64.0, -163.0, -86.0, 167.0, 134.0, -284.0, -152.0, 90.0, 123.0, 200.0, -20.0, 189.0, 13.0, 200.0, -20.0, 200.0, -20.0, -152.0, 123.0, 79.0, 156.0, 200.0, 35.0, 189.0, 200.0, -20.0, 200.0, 178.0, -31.0, 200.0, -42.0, 90.0, -207.0, 145.0, 167.0, -262.0, 68.0, 156.0, 68.0, 112.0, 200.0, 178.0, 24.0, 68.0, 200.0, 200.0, 101.0, 112.0, 134.0, 200.0, 200.0, 200.0, 13.0, 145.0, -251.0, -53.0, 13.0, 200.0, -42.0, -119.0, 68.0, -438.0, -119.0, -812.0, 200.0, -20.0, 68.0, 2.0, 178.0, 79.0, -251.0, 200.0, 200.0, -97.0, 123.0, 134.0, 68.0, 200.0, -20.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 13.0, 57.0, 200.0, -75.0, 101.0, 68.0, 57.0, 90.0, 79.0, 200.0, 123.0, -284.0, -75.0, -97.0, 200.0, 2.0, 189.0, 200.0, 200.0, 200.0, 200.0, 46.0, 145.0, 13.0, 68.0, 134.0, -64.0, -130.0, 200.0, 200.0, 68.0, -317.0, -295.0, 145.0, 112.0, 167.0, 200.0, 200.0, -383.0, -669.0, 123.0], "policy_predator_policy_reward": [0.0, 20.0, 0.0, 185.0, 50.0, 340.0, 0.0, 110.0, 0.0, 100.0, 35.0, 0.0, 0.0, 0.0, 10.0, 25.0, 0.0, 55.0, 0.0, 125.0, 115.0, 70.0, 125.0, 40.0, 360.0, 360.0, 225.0, 0.0, 15.0, 90.0, 40.0, 35.0, 65.0, 140.0, 60.0, 100.0, 0.0, 135.0, 80.0, 110.0, 90.0, 125.0, 25.0, 0.0, 0.0, 0.0, 75.0, 115.0, 0.0, 70.0, 25.0, 0.0, 105.0, 0.0, 115.0, 0.0, 240.0, 175.0, 195.0, 130.0, 50.0, 105.0, 80.0, 60.0, 65.0, 30.0, 5.0, 40.0, 75.0, 35.0, 0.0, 130.0, 15.0, 70.0, 305.0, 40.0, 195.0, 45.0, 90.0, 60.0, 170.0, 105.0, 5.0, 30.0, 445.0, 40.0, 20.0, 0.0, 70.0, 0.0, 100.0, 65.0, 85.0, 75.0, 0.0, 0.0, 0.0, 115.0, 10.0, 105.0, 50.0, 40.0, 915.0, 190.0, 225.0, 10.0, 0.0, 170.0, 45.0, 35.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 80.0, 45.0, 90.0, 165.0, 45.0, 90.0, 5.0, 35.0, 80.0, 70.0, 0.0, 0.0, 110.0, 135.0, 195.0, 115.0, 140.0, 45.0, 125.0, 115.0, 35.0, 30.0, 0.0, 105.0, 5.0, 10.0, 170.0, 115.0, 105.0, 115.0, 110.0, 105.0, 60.0, 0.0, 70.0, 0.0, 40.0, 205.0, 70.0, 0.0, 125.0, 115.0, 135.0, 100.0, 0.0, 35.0, 0.0, 90.0, 50.0, 25.0, 50.0, 50.0, 80.0, 75.0, 75.0, 240.0, 40.0, 130.0, 60.0, 150.0, 225.0, 195.0, 135.0, 0.0, 50.0, 0.0, 85.0, 100.0, 55.0, 15.0, 0.0, 100.0, 95.0, 140.0, 145.0, 0.0, 55.0, 0.0, 60.0, 0.0, 50.0, 35.0, 60.0, 100.0, 60.0, 0.0, 70.0, 155.0, 95.0, 150.0, 55.0, 230.0, 45.0, 30.0, 65.0, 40.0, 10.0, 40.0, 65.0, 0.0, 60.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 105.0, 25.0, 215.0, 125.0, 140.0, 5.0, 135.0, 75.0, 55.0, 535.0, 50.0, 90.0, 55.0, 60.0, 80.0, 20.0, 90.0, 0.0, 110.0, 50.0, 195.0, 95.0, 30.0, 110.0, 100.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 85.0, 0.0, 0.0, 125.0, 70.0, 95.0, 0.0, 40.0, 5.0, 50.0, 60.0, 225.0, 105.0, 0.0, 90.0, 5.0, 0.0, 0.0, 0.0, 0.0, 70.0, 25.0, 80.0, 75.0, 30.0, 0.0, 150.0, 0.0, 220.0, 20.0, 175.0, 20.0, 180.0, 115.0, 0.0, 15.0, 0.0, 35.0, 0.0, 405.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9852364628069048, "mean_inference_ms": 1.6657176456441396, "mean_action_processing_ms": 0.3737164943432781, "mean_env_wait_ms": 0.2626757892126661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0103071928024292, "StateBufferConnector_ms": 0.004277944564819336, "ViewRequirementAgentConnector_ms": 0.15389800071716309}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -2360.0, "episode_return_mean": 316.73, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 53.86005903091768, "num_env_steps_trained_throughput_per_sec": 53.86005903091768, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 126379.374, "restore_workers_time_ms": 0.015, "training_step_time_ms": 126379.315, "sample_time_ms": 1480.97, "learn_time_ms": 124878.494, "learn_throughput": 32.031, "synch_weights_time_ms": 15.98}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 65, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-47-36", "timestamp": 1723492056, "time_this_iter_s": 74.30891180038452, "time_total_s": 5459.77899813652, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2332f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5459.77899813652, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 35.16095238095238, "ram_util_percent": 83.20761904761906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.450661432605686, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0805034995290403, "policy_loss": -0.008268925944258168, "vf_loss": 1.0882924860673593, "vf_explained_var": -9.79456495731435e-06, "kl": 0.006398414827308015, "entropy": 0.6375016235713418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 184710.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.290657335921383, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2471163311960003, "policy_loss": -0.019612191315634665, "vf_loss": 1.2658045705751324, "vf_explained_var": 0.03374309632795077, "kl": 0.009239525869213575, "entropy": 1.29965289370388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 184710.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -2447.0, "episode_reward_mean": 273.33, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": 10.543333333333333, "predator_policy": 80.56666666666666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-79.0, 308.0, 494.0, 403.0, 390.0, 292.0, -33.0, 440.0, -59.0, 432.0, -842.0, 483.0, 443.0, 411.0, 252.0, 465.0, -2360.0, 43.0, 492.0, 509.0, 600.0, 452.0, -24.0, 445.0, 373.0, 347.0, 273.0, 457.0, 438.0, 400.0, 396.0, 358.0, 516.0, 200.0, 257.0, 428.0, 373.0, 571.0, 508.0, 152.0, 258.0, 253.0, 463.0, 422.0, 495.0, 331.0, 490.0, 534.0, 553.0, 257.0, 428.0, 303.0, 471.0, 517.0, 528.0, 402.0, 600.0, 252.0, 430.0, 172.0, -694.0, 443.0, 369.0, 504.0, 395.0, 348.0, 534.0, 600.0, 398.0, 351.0, 380.0, 497.0, -66.0, 486.0, 600.0, 486.0, 400.0, 156.0, 366.0, 277.0, 582.0, -489.0, 390.0, 375.0, 562.0, 363.0, -2447.0, 114.0, 490.0, -186.0, 566.0, 474.0, 545.0, -1524.0, 315.0, 477.0, 420.0, 563.0, 150.0, 600.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-53.0, -53.0, -328.0, 200.0, -273.0, -119.0, -31.0, 200.0, 90.0, 35.0, 200.0, 13.0, 35.0, 35.0, 200.0, 167.0, 46.0, -86.0, -163.0, -460.0, 200.0, -86.0, 200.0, 46.0, -75.0, -163.0, -141.0, -31.0, 123.0, 200.0, -702.0, 35.0, -680.0, 167.0, 178.0, 68.0, -31.0, 24.0, 200.0, 189.0, 68.0, 79.0, -31.0, 200.0, -42.0, 134.0, -31.0, 167.0, -1692.0, -1747.0, -251.0, -119.0, 134.0, -152.0, 123.0, 200.0, 79.0, 145.0, 134.0, 200.0, 200.0, 200.0, 200.0, 145.0, -42.0, 134.0, -130.0, -119.0, -75.0, 189.0, 24.0, 112.0, 57.0, 46.0, 200.0, 178.0, -185.0, -86.0, -97.0, 200.0, -130.0, -75.0, 134.0, 123.0, 200.0, 145.0, -42.0, -174.0, 200.0, 189.0, 156.0, -152.0, 57.0, 200.0, 13.0, -130.0, 46.0, 200.0, 200.0, 68.0, -218.0, 35.0, -53.0, 145.0, -75.0, -9.0, 134.0, 68.0, 123.0, 68.0, 57.0, 200.0, 46.0, 200.0, 178.0, 101.0, 24.0, -273.0, 134.0, -64.0, -163.0, -86.0, 167.0, 134.0, -284.0, -152.0, 90.0, 123.0, 200.0, -20.0, 189.0, 13.0, 200.0, -20.0, 200.0, -20.0, -152.0, 123.0, 79.0, 156.0, 200.0, 35.0, 189.0, 200.0, -20.0, 200.0, 178.0, -31.0, 200.0, -42.0, 90.0, -207.0, 145.0, 167.0, -262.0, 68.0, 156.0, 68.0, 112.0, 200.0, 178.0, 24.0, 68.0, 200.0, 200.0, 101.0, 112.0, 134.0, 200.0, 200.0, 200.0, 13.0, 145.0, -251.0, -53.0, 13.0, 200.0, -42.0, -119.0, 68.0, -438.0, -119.0, -812.0, 200.0, -20.0, 68.0, 2.0, 178.0, 79.0, -251.0, 200.0, 200.0, -97.0, 123.0, 134.0, 68.0, 200.0, -20.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 13.0, 57.0, 200.0, -75.0, 101.0, 68.0, 57.0, 90.0, 79.0, 200.0, 123.0, -284.0, -75.0, -97.0, 200.0, 2.0, 189.0, 200.0, 200.0, 200.0, 200.0, 46.0, 145.0, 13.0, 68.0, 134.0, -64.0, -130.0, 200.0, 200.0, 68.0, -317.0, -295.0, 145.0, 112.0, 167.0, 200.0, 200.0, -383.0, -669.0, 123.0, 112.0, -9.0, 112.0, -42.0, 200.0, 57.0, 200.0, 200.0, 112.0, -9.0, -163.0, -295.0, -1835.0, 178.0, -2000.0, -31.0, -130.0, 35.0, -119.0, 200.0, 189.0, -669.0, -9.0, -53.0, 200.0, -64.0, 200.0, -20.0, 200.0, 189.0, 90.0, 200.0, 200.0, -1318.0, -383.0, -713.0, -31.0, 2.0, 79.0, -75.0, 112.0, 200.0, -86.0, 200.0, 156.0, 200.0, 145.0, 68.0, -53.0, -108.0, -9.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [115.0, 0.0, 240.0, 175.0, 195.0, 130.0, 50.0, 105.0, 80.0, 60.0, 65.0, 30.0, 5.0, 40.0, 75.0, 35.0, 0.0, 130.0, 15.0, 70.0, 305.0, 40.0, 195.0, 45.0, 90.0, 60.0, 170.0, 105.0, 5.0, 30.0, 445.0, 40.0, 20.0, 0.0, 70.0, 0.0, 100.0, 65.0, 85.0, 75.0, 0.0, 0.0, 0.0, 115.0, 10.0, 105.0, 50.0, 40.0, 915.0, 190.0, 225.0, 10.0, 0.0, 170.0, 45.0, 35.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 80.0, 45.0, 90.0, 165.0, 45.0, 90.0, 5.0, 35.0, 80.0, 70.0, 0.0, 0.0, 110.0, 135.0, 195.0, 115.0, 140.0, 45.0, 125.0, 115.0, 35.0, 30.0, 0.0, 105.0, 5.0, 10.0, 170.0, 115.0, 105.0, 115.0, 110.0, 105.0, 60.0, 0.0, 70.0, 0.0, 40.0, 205.0, 70.0, 0.0, 125.0, 115.0, 135.0, 100.0, 0.0, 35.0, 0.0, 90.0, 50.0, 25.0, 50.0, 50.0, 80.0, 75.0, 75.0, 240.0, 40.0, 130.0, 60.0, 150.0, 225.0, 195.0, 135.0, 0.0, 50.0, 0.0, 85.0, 100.0, 55.0, 15.0, 0.0, 100.0, 95.0, 140.0, 145.0, 0.0, 55.0, 0.0, 60.0, 0.0, 50.0, 35.0, 60.0, 100.0, 60.0, 0.0, 70.0, 155.0, 95.0, 150.0, 55.0, 230.0, 45.0, 30.0, 65.0, 40.0, 10.0, 40.0, 65.0, 0.0, 60.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 105.0, 25.0, 215.0, 125.0, 140.0, 5.0, 135.0, 75.0, 55.0, 535.0, 50.0, 90.0, 55.0, 60.0, 80.0, 20.0, 90.0, 0.0, 110.0, 50.0, 195.0, 95.0, 30.0, 110.0, 100.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 85.0, 0.0, 0.0, 125.0, 70.0, 95.0, 0.0, 40.0, 5.0, 50.0, 60.0, 225.0, 105.0, 0.0, 90.0, 5.0, 0.0, 0.0, 0.0, 0.0, 70.0, 25.0, 80.0, 75.0, 30.0, 0.0, 150.0, 0.0, 220.0, 20.0, 175.0, 20.0, 180.0, 115.0, 0.0, 15.0, 0.0, 35.0, 0.0, 405.0, 35.0, 45.0, 95.0, 110.0, 50.0, 0.0, 20.0, 20.0, 10.0, 255.0, 280.0, 295.0, 145.0, 65.0, 1000.0, 145.0, 0.0, 95.0, 0.0, 110.0, 110.0, 0.0, 395.0, 150.0, 0.0, 110.0, 120.0, 100.0, 0.0, 5.0, 0.0, 50.0, 5.0, 810.0, 80.0, 0.0, 125.0, 140.0, 0.0, 140.0, 100.0, 0.0, 20.0, 0.0, 130.0, 65.0, 40.0, 45.0, 95.0, 80.0, 145.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.984245343516807, "mean_inference_ms": 1.6636167825826869, "mean_action_processing_ms": 0.3734201628734266, "mean_env_wait_ms": 0.2624820004505369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009663224220275879, "StateBufferConnector_ms": 0.004236102104187012, "ViewRequirementAgentConnector_ms": 0.15390253067016602}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -2447.0, "episode_return_mean": 273.33, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.87571086263713, "num_env_steps_trained_throughput_per_sec": 54.87571086263713, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 73639.234, "restore_workers_time_ms": 0.015, "training_step_time_ms": 73639.173, "sample_time_ms": 1472.28, "learn_time_ms": 72146.861, "learn_throughput": 55.442, "synch_weights_time_ms": 16.084}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 66, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-48-48", "timestamp": 1723492128, "time_this_iter_s": 72.9366729259491, "time_total_s": 5532.7156710624695, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2332dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5532.7156710624695, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 31.900000000000006, "ram_util_percent": 82.96699029126212}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.742850812836319, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0611529745425738, "policy_loss": -0.006950988099819085, "vf_loss": 1.0675700116981852, "vf_explained_var": 1.6861139459812895e-06, "kl": 0.007118563424926545, "entropy": 0.5967433551735912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 187530.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.305640705194033, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0968601392119701, "policy_loss": -0.01838036764962995, "vf_loss": 1.1142131514054663, "vf_explained_var": 0.033385058539979, "kl": 0.010273559573012143, "entropy": 1.2381938007283717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 187530.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -2447.0, "episode_reward_mean": 312.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": 25.576666666666668, "predator_policy": 78.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-24.0, 445.0, 373.0, 347.0, 273.0, 457.0, 438.0, 400.0, 396.0, 358.0, 516.0, 200.0, 257.0, 428.0, 373.0, 571.0, 508.0, 152.0, 258.0, 253.0, 463.0, 422.0, 495.0, 331.0, 490.0, 534.0, 553.0, 257.0, 428.0, 303.0, 471.0, 517.0, 528.0, 402.0, 600.0, 252.0, 430.0, 172.0, -694.0, 443.0, 369.0, 504.0, 395.0, 348.0, 534.0, 600.0, 398.0, 351.0, 380.0, 497.0, -66.0, 486.0, 600.0, 486.0, 400.0, 156.0, 366.0, 277.0, 582.0, -489.0, 390.0, 375.0, 562.0, 363.0, -2447.0, 114.0, 490.0, -186.0, 566.0, 474.0, 545.0, -1524.0, 315.0, 477.0, 420.0, 563.0, 150.0, 600.0, -519.0, 346.0, 283.0, 452.0, 517.0, 588.0, 320.0, -367.0, 85.0, 504.0, 374.0, 350.0, 238.0, 462.0, 474.0, 477.0, 546.0, 268.0, 594.0, 429.0, 465.0, 540.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-130.0, -119.0, -75.0, 189.0, 24.0, 112.0, 57.0, 46.0, 200.0, 178.0, -185.0, -86.0, -97.0, 200.0, -130.0, -75.0, 134.0, 123.0, 200.0, 145.0, -42.0, -174.0, 200.0, 189.0, 156.0, -152.0, 57.0, 200.0, 13.0, -130.0, 46.0, 200.0, 200.0, 68.0, -218.0, 35.0, -53.0, 145.0, -75.0, -9.0, 134.0, 68.0, 123.0, 68.0, 57.0, 200.0, 46.0, 200.0, 178.0, 101.0, 24.0, -273.0, 134.0, -64.0, -163.0, -86.0, 167.0, 134.0, -284.0, -152.0, 90.0, 123.0, 200.0, -20.0, 189.0, 13.0, 200.0, -20.0, 200.0, -20.0, -152.0, 123.0, 79.0, 156.0, 200.0, 35.0, 189.0, 200.0, -20.0, 200.0, 178.0, -31.0, 200.0, -42.0, 90.0, -207.0, 145.0, 167.0, -262.0, 68.0, 156.0, 68.0, 112.0, 200.0, 178.0, 24.0, 68.0, 200.0, 200.0, 101.0, 112.0, 134.0, 200.0, 200.0, 200.0, 13.0, 145.0, -251.0, -53.0, 13.0, 200.0, -42.0, -119.0, 68.0, -438.0, -119.0, -812.0, 200.0, -20.0, 68.0, 2.0, 178.0, 79.0, -251.0, 200.0, 200.0, -97.0, 123.0, 134.0, 68.0, 200.0, -20.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 13.0, 57.0, 200.0, -75.0, 101.0, 68.0, 57.0, 90.0, 79.0, 200.0, 123.0, -284.0, -75.0, -97.0, 200.0, 2.0, 189.0, 200.0, 200.0, 200.0, 200.0, 46.0, 145.0, 13.0, 68.0, 134.0, -64.0, -130.0, 200.0, 200.0, 68.0, -317.0, -295.0, 145.0, 112.0, 167.0, 200.0, 200.0, -383.0, -669.0, 123.0, 112.0, -9.0, 112.0, -42.0, 200.0, 57.0, 200.0, 200.0, 112.0, -9.0, -163.0, -295.0, -1835.0, 178.0, -2000.0, -31.0, -130.0, 35.0, -119.0, 200.0, 189.0, -669.0, -9.0, -53.0, 200.0, -64.0, 200.0, -20.0, 200.0, 189.0, 90.0, 200.0, 200.0, -1318.0, -383.0, -713.0, -31.0, 2.0, 79.0, -75.0, 112.0, 200.0, -86.0, 200.0, 156.0, 200.0, 145.0, 68.0, -53.0, -108.0, -9.0, 200.0, 200.0, 200.0, -372.0, -317.0, -460.0, -119.0, -53.0, 178.0, 68.0, -119.0, -86.0, 178.0, 35.0, 134.0, 178.0, 79.0, 145.0, 200.0, 200.0, 178.0, -449.0, 101.0, 123.0, -394.0, -20.0, -438.0, -64.0, 35.0, -251.0, 200.0, 24.0, 200.0, 13.0, -141.0, 2.0, 178.0, -383.0, 200.0, 200.0, -339.0, 57.0, 200.0, -53.0, 200.0, 57.0, 112.0, 200.0, 200.0, 145.0, 57.0, 200.0, 200.0, 101.0, 46.0, -20.0, 2.0, 200.0, 189.0, 200.0, -53.0, 167.0, 200.0, 178.0, 145.0, 57.0, 90.0, 200.0, 200.0], "policy_predator_policy_reward": [165.0, 45.0, 90.0, 5.0, 35.0, 80.0, 70.0, 0.0, 0.0, 110.0, 135.0, 195.0, 115.0, 140.0, 45.0, 125.0, 115.0, 35.0, 30.0, 0.0, 105.0, 5.0, 10.0, 170.0, 115.0, 105.0, 115.0, 110.0, 105.0, 60.0, 0.0, 70.0, 0.0, 40.0, 205.0, 70.0, 0.0, 125.0, 115.0, 135.0, 100.0, 0.0, 35.0, 0.0, 90.0, 50.0, 25.0, 50.0, 50.0, 80.0, 75.0, 75.0, 240.0, 40.0, 130.0, 60.0, 150.0, 225.0, 195.0, 135.0, 0.0, 50.0, 0.0, 85.0, 100.0, 55.0, 15.0, 0.0, 100.0, 95.0, 140.0, 145.0, 0.0, 55.0, 0.0, 60.0, 0.0, 50.0, 35.0, 60.0, 100.0, 60.0, 0.0, 70.0, 155.0, 95.0, 150.0, 55.0, 230.0, 45.0, 30.0, 65.0, 40.0, 10.0, 40.0, 65.0, 0.0, 60.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 105.0, 25.0, 215.0, 125.0, 140.0, 5.0, 135.0, 75.0, 55.0, 535.0, 50.0, 90.0, 55.0, 60.0, 80.0, 20.0, 90.0, 0.0, 110.0, 50.0, 195.0, 95.0, 30.0, 110.0, 100.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 85.0, 0.0, 0.0, 125.0, 70.0, 95.0, 0.0, 40.0, 5.0, 50.0, 60.0, 225.0, 105.0, 0.0, 90.0, 5.0, 0.0, 0.0, 0.0, 0.0, 70.0, 25.0, 80.0, 75.0, 30.0, 0.0, 150.0, 0.0, 220.0, 20.0, 175.0, 20.0, 180.0, 115.0, 0.0, 15.0, 0.0, 35.0, 0.0, 405.0, 35.0, 45.0, 95.0, 110.0, 50.0, 0.0, 20.0, 20.0, 10.0, 255.0, 280.0, 295.0, 145.0, 65.0, 1000.0, 145.0, 0.0, 95.0, 0.0, 110.0, 110.0, 0.0, 395.0, 150.0, 0.0, 110.0, 120.0, 100.0, 0.0, 5.0, 0.0, 50.0, 5.0, 810.0, 80.0, 0.0, 125.0, 140.0, 0.0, 140.0, 100.0, 0.0, 20.0, 0.0, 130.0, 65.0, 40.0, 45.0, 95.0, 80.0, 145.0, 0.0, 0.0, 0.0, 255.0, 120.0, 255.0, 110.0, 160.0, 70.0, 95.0, 110.0, 215.0, 95.0, 0.0, 10.0, 35.0, 0.0, 80.0, 10.0, 0.0, 0.0, 165.0, 275.0, 105.0, 0.0, 285.0, 200.0, 290.0, 0.0, 75.0, 80.0, 0.0, 0.0, 180.0, 170.0, 150.0, 10.0, 250.0, 95.0, 65.0, 245.0, 10.0, 0.0, 5.0, 110.0, 40.0, 0.0, 65.0, 0.0, 10.0, 65.0, 0.0, 45.0, 0.0, 100.0, 0.0, 140.0, 0.0, 0.0, 5.0, 115.0, 0.0, 0.0, 80.0, 0.0, 5.0, 0.0, 50.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9835313422715509, "mean_inference_ms": 1.661230314227152, "mean_action_processing_ms": 0.37330027836997615, "mean_env_wait_ms": 0.26217326344386926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008643746376037598, "StateBufferConnector_ms": 0.005104541778564453, "ViewRequirementAgentConnector_ms": 0.15359711647033691}, "num_episodes": 22, "episode_return_max": 600.0, "episode_return_min": -2447.0, "episode_return_mean": 312.23, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.81820656591589, "num_env_steps_trained_throughput_per_sec": 54.81820656591589, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1608000, "timers": {"training_iteration_time_ms": 73595.979, "restore_workers_time_ms": 0.015, "training_step_time_ms": 73595.922, "sample_time_ms": 1434.66, "learn_time_ms": 72143.546, "learn_throughput": 55.445, "synch_weights_time_ms": 14.15}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1608000, "num_agent_steps_trained": 1608000}, "done": false, "training_iteration": 67, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-50-02", "timestamp": 1723492202, "time_this_iter_s": 72.98065185546875, "time_total_s": 5605.696322917938, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32f69cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5605.696322917938, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 31.475728155339805, "ram_util_percent": 81.52135922330096}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4625552295687352, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6781032890926861, "policy_loss": -0.00823954868911442, "vf_loss": 1.6857178714469816, "vf_explained_var": 2.0517440552407123e-05, "kl": 0.008331695934631964, "entropy": 0.6244580110125508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 190350.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.3082653452107245, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.328407141217526, "policy_loss": -0.016370090675715303, "vf_loss": 1.344047893974798, "vf_explained_var": 0.03028852734582644, "kl": 0.007293387288485547, "entropy": 1.2667552026873785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 190350.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -2447.0, "episode_reward_mean": 316.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": 21.066666666666666, "predator_policy": 84.48333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [258.0, 253.0, 463.0, 422.0, 495.0, 331.0, 490.0, 534.0, 553.0, 257.0, 428.0, 303.0, 471.0, 517.0, 528.0, 402.0, 600.0, 252.0, 430.0, 172.0, -694.0, 443.0, 369.0, 504.0, 395.0, 348.0, 534.0, 600.0, 398.0, 351.0, 380.0, 497.0, -66.0, 486.0, 600.0, 486.0, 400.0, 156.0, 366.0, 277.0, 582.0, -489.0, 390.0, 375.0, 562.0, 363.0, -2447.0, 114.0, 490.0, -186.0, 566.0, 474.0, 545.0, -1524.0, 315.0, 477.0, 420.0, 563.0, 150.0, 600.0, -519.0, 346.0, 283.0, 452.0, 517.0, 588.0, 320.0, -367.0, 85.0, 504.0, 374.0, 350.0, 238.0, 462.0, 474.0, 477.0, 546.0, 268.0, 594.0, 429.0, 465.0, 540.0, 410.0, 280.0, 193.0, 594.0, 571.0, 355.0, 557.0, 456.0, 205.0, 180.0, 549.0, 600.0, 222.0, 433.0, 186.0, 222.0, 297.0, 600.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-163.0, -86.0, 167.0, 134.0, -284.0, -152.0, 90.0, 123.0, 200.0, -20.0, 189.0, 13.0, 200.0, -20.0, 200.0, -20.0, -152.0, 123.0, 79.0, 156.0, 200.0, 35.0, 189.0, 200.0, -20.0, 200.0, 178.0, -31.0, 200.0, -42.0, 90.0, -207.0, 145.0, 167.0, -262.0, 68.0, 156.0, 68.0, 112.0, 200.0, 178.0, 24.0, 68.0, 200.0, 200.0, 101.0, 112.0, 134.0, 200.0, 200.0, 200.0, 13.0, 145.0, -251.0, -53.0, 13.0, 200.0, -42.0, -119.0, 68.0, -438.0, -119.0, -812.0, 200.0, -20.0, 68.0, 2.0, 178.0, 79.0, -251.0, 200.0, 200.0, -97.0, 123.0, 134.0, 68.0, 200.0, -20.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 13.0, 57.0, 200.0, -75.0, 101.0, 68.0, 57.0, 90.0, 79.0, 200.0, 123.0, -284.0, -75.0, -97.0, 200.0, 2.0, 189.0, 200.0, 200.0, 200.0, 200.0, 46.0, 145.0, 13.0, 68.0, 134.0, -64.0, -130.0, 200.0, 200.0, 68.0, -317.0, -295.0, 145.0, 112.0, 167.0, 200.0, 200.0, -383.0, -669.0, 123.0, 112.0, -9.0, 112.0, -42.0, 200.0, 57.0, 200.0, 200.0, 112.0, -9.0, -163.0, -295.0, -1835.0, 178.0, -2000.0, -31.0, -130.0, 35.0, -119.0, 200.0, 189.0, -669.0, -9.0, -53.0, 200.0, -64.0, 200.0, -20.0, 200.0, 189.0, 90.0, 200.0, 200.0, -1318.0, -383.0, -713.0, -31.0, 2.0, 79.0, -75.0, 112.0, 200.0, -86.0, 200.0, 156.0, 200.0, 145.0, 68.0, -53.0, -108.0, -9.0, 200.0, 200.0, 200.0, -372.0, -317.0, -460.0, -119.0, -53.0, 178.0, 68.0, -119.0, -86.0, 178.0, 35.0, 134.0, 178.0, 79.0, 145.0, 200.0, 200.0, 178.0, -449.0, 101.0, 123.0, -394.0, -20.0, -438.0, -64.0, 35.0, -251.0, 200.0, 24.0, 200.0, 13.0, -141.0, 2.0, 178.0, -383.0, 200.0, 200.0, -339.0, 57.0, 200.0, -53.0, 200.0, 57.0, 112.0, 200.0, 200.0, 145.0, 57.0, 200.0, 200.0, 101.0, 46.0, -20.0, 2.0, 200.0, 189.0, 200.0, -53.0, 167.0, 200.0, 178.0, 145.0, 57.0, 90.0, 200.0, 200.0, 189.0, -482.0, 178.0, -31.0, -108.0, -251.0, -86.0, -9.0, 13.0, 189.0, 200.0, 200.0, -229.0, 200.0, 200.0, -559.0, 167.0, 2.0, 112.0, 200.0, 200.0, 68.0, 68.0, 200.0, -218.0, 24.0, 24.0, -9.0, 2.0, 2.0, 167.0, 167.0, 200.0, 200.0, 200.0, 200.0, -86.0, -42.0, 200.0, 200.0, 79.0, -1516.0, 13.0, 57.0, -119.0, 101.0, -306.0, 112.0, 178.0, 123.0, -174.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [130.0, 60.0, 150.0, 225.0, 195.0, 135.0, 0.0, 50.0, 0.0, 85.0, 100.0, 55.0, 15.0, 0.0, 100.0, 95.0, 140.0, 145.0, 0.0, 55.0, 0.0, 60.0, 0.0, 50.0, 35.0, 60.0, 100.0, 60.0, 0.0, 70.0, 155.0, 95.0, 150.0, 55.0, 230.0, 45.0, 30.0, 65.0, 40.0, 10.0, 40.0, 65.0, 0.0, 60.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 0.0, 105.0, 25.0, 215.0, 125.0, 140.0, 5.0, 135.0, 75.0, 55.0, 535.0, 50.0, 90.0, 55.0, 60.0, 80.0, 20.0, 90.0, 0.0, 110.0, 50.0, 195.0, 95.0, 30.0, 110.0, 100.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 85.0, 0.0, 0.0, 125.0, 70.0, 95.0, 0.0, 40.0, 5.0, 50.0, 60.0, 225.0, 105.0, 0.0, 90.0, 5.0, 0.0, 0.0, 0.0, 0.0, 70.0, 25.0, 80.0, 75.0, 30.0, 0.0, 150.0, 0.0, 220.0, 20.0, 175.0, 20.0, 180.0, 115.0, 0.0, 15.0, 0.0, 35.0, 0.0, 405.0, 35.0, 45.0, 95.0, 110.0, 50.0, 0.0, 20.0, 20.0, 10.0, 255.0, 280.0, 295.0, 145.0, 65.0, 1000.0, 145.0, 0.0, 95.0, 0.0, 110.0, 110.0, 0.0, 395.0, 150.0, 0.0, 110.0, 120.0, 100.0, 0.0, 5.0, 0.0, 50.0, 5.0, 810.0, 80.0, 0.0, 125.0, 140.0, 0.0, 140.0, 100.0, 0.0, 20.0, 0.0, 130.0, 65.0, 40.0, 45.0, 95.0, 80.0, 145.0, 0.0, 0.0, 0.0, 255.0, 120.0, 255.0, 110.0, 160.0, 70.0, 95.0, 110.0, 215.0, 95.0, 0.0, 10.0, 35.0, 0.0, 80.0, 10.0, 0.0, 0.0, 165.0, 275.0, 105.0, 0.0, 285.0, 200.0, 290.0, 0.0, 75.0, 80.0, 0.0, 0.0, 180.0, 170.0, 150.0, 10.0, 250.0, 95.0, 65.0, 245.0, 10.0, 0.0, 5.0, 110.0, 40.0, 0.0, 65.0, 0.0, 10.0, 65.0, 0.0, 45.0, 0.0, 100.0, 0.0, 140.0, 0.0, 0.0, 5.0, 115.0, 0.0, 0.0, 80.0, 0.0, 5.0, 0.0, 50.0, 0.0, 100.0, 205.0, 220.0, 160.0, 280.0, 230.0, 75.0, 70.0, 130.0, 0.0, 0.0, 5.0, 195.0, 100.0, 105.0, 265.0, 350.0, 130.0, 5.0, 40.0, 0.0, 60.0, 0.0, 60.0, 155.0, 85.0, 135.0, 95.0, 90.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 150.0, 640.0, 520.0, 510.0, 5.0, 90.0, 140.0, 0.0, 135.0, 180.0, 170.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9820269852415016, "mean_inference_ms": 1.6587703177880444, "mean_action_processing_ms": 0.37273841764776877, "mean_env_wait_ms": 0.26201957536145926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007739663124084473, "StateBufferConnector_ms": 0.005093216896057129, "ViewRequirementAgentConnector_ms": 0.15100491046905518}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -2447.0, "episode_return_mean": 316.65, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.337898011026816, "num_env_steps_trained_throughput_per_sec": 56.337898011026816, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 73211.451, "restore_workers_time_ms": 0.015, "training_step_time_ms": 73211.394, "sample_time_ms": 1400.434, "learn_time_ms": 71792.747, "learn_throughput": 55.716, "synch_weights_time_ms": 13.887}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 68, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-51-13", "timestamp": 1723492273, "time_this_iter_s": 71.01714420318604, "time_total_s": 5676.713467121124, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b23320d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5676.713467121124, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 18.814851485148516, "ram_util_percent": 75.44653465346535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5722440089634124, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.536417334827971, "policy_loss": -0.008561456092716491, "vf_loss": 1.5443356029319426, "vf_explained_var": 1.0450807869011629e-05, "kl": 0.008574752422002379, "entropy": 0.6481294834867437, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 193170.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8855715087965024, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3635631350470139, "policy_loss": -0.021528688425871922, "vf_loss": 1.384180554028944, "vf_explained_var": 0.05131175034012355, "kl": 0.009112715737704783, "entropy": 1.223087339578791, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 193170.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "env_runners": {"episode_reward_max": 640.0, "episode_reward_min": -2447.0, "episode_reward_mean": 279.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -2.84, "predator_policy": 96.06666666666666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [504.0, 395.0, 348.0, 534.0, 600.0, 398.0, 351.0, 380.0, 497.0, -66.0, 486.0, 600.0, 486.0, 400.0, 156.0, 366.0, 277.0, 582.0, -489.0, 390.0, 375.0, 562.0, 363.0, -2447.0, 114.0, 490.0, -186.0, 566.0, 474.0, 545.0, -1524.0, 315.0, 477.0, 420.0, 563.0, 150.0, 600.0, -519.0, 346.0, 283.0, 452.0, 517.0, 588.0, 320.0, -367.0, 85.0, 504.0, 374.0, 350.0, 238.0, 462.0, 474.0, 477.0, 546.0, 268.0, 594.0, 429.0, 465.0, 540.0, 410.0, 280.0, 193.0, 594.0, 571.0, 355.0, 557.0, 456.0, 205.0, 180.0, 549.0, 600.0, 222.0, 433.0, 186.0, 222.0, 297.0, 600.0, 199.0, 255.0, -246.0, 209.0, 22.0, 576.0, 128.0, 173.0, 394.0, 157.0, 359.0, 385.0, 588.0, -65.0, 503.0, 198.0, 640.0, -1367.0, 378.0, 208.0, 275.0, 330.0, 281.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-251.0, 200.0, 200.0, -97.0, 123.0, 134.0, 68.0, 200.0, -20.0, 79.0, 200.0, 200.0, 200.0, 200.0, 200.0, 178.0, 13.0, 57.0, 200.0, -75.0, 101.0, 68.0, 57.0, 90.0, 79.0, 200.0, 123.0, -284.0, -75.0, -97.0, 200.0, 2.0, 189.0, 200.0, 200.0, 200.0, 200.0, 46.0, 145.0, 13.0, 68.0, 134.0, -64.0, -130.0, 200.0, 200.0, 68.0, -317.0, -295.0, 145.0, 112.0, 167.0, 200.0, 200.0, -383.0, -669.0, 123.0, 112.0, -9.0, 112.0, -42.0, 200.0, 57.0, 200.0, 200.0, 112.0, -9.0, -163.0, -295.0, -1835.0, 178.0, -2000.0, -31.0, -130.0, 35.0, -119.0, 200.0, 189.0, -669.0, -9.0, -53.0, 200.0, -64.0, 200.0, -20.0, 200.0, 189.0, 90.0, 200.0, 200.0, -1318.0, -383.0, -713.0, -31.0, 2.0, 79.0, -75.0, 112.0, 200.0, -86.0, 200.0, 156.0, 200.0, 145.0, 68.0, -53.0, -108.0, -9.0, 200.0, 200.0, 200.0, -372.0, -317.0, -460.0, -119.0, -53.0, 178.0, 68.0, -119.0, -86.0, 178.0, 35.0, 134.0, 178.0, 79.0, 145.0, 200.0, 200.0, 178.0, -449.0, 101.0, 123.0, -394.0, -20.0, -438.0, -64.0, 35.0, -251.0, 200.0, 24.0, 200.0, 13.0, -141.0, 2.0, 178.0, -383.0, 200.0, 200.0, -339.0, 57.0, 200.0, -53.0, 200.0, 57.0, 112.0, 200.0, 200.0, 145.0, 57.0, 200.0, 200.0, 101.0, 46.0, -20.0, 2.0, 200.0, 189.0, 200.0, -53.0, 167.0, 200.0, 178.0, 145.0, 57.0, 90.0, 200.0, 200.0, 189.0, -482.0, 178.0, -31.0, -108.0, -251.0, -86.0, -9.0, 13.0, 189.0, 200.0, 200.0, -229.0, 200.0, 200.0, -559.0, 167.0, 2.0, 112.0, 200.0, 200.0, 68.0, 68.0, 200.0, -218.0, 24.0, 24.0, -9.0, 2.0, 2.0, 167.0, 167.0, 200.0, 200.0, 200.0, 200.0, -86.0, -42.0, 200.0, 200.0, 79.0, -1516.0, 13.0, 57.0, -119.0, 101.0, -306.0, 112.0, 178.0, 123.0, -174.0, 200.0, 200.0, 200.0, -75.0, -251.0, 200.0, -119.0, 145.0, -196.0, -372.0, -339.0, 200.0, -31.0, 90.0, -20.0, -119.0, -97.0, -42.0, 101.0, 200.0, 200.0, 68.0, -1329.0, 24.0, 200.0, -295.0, -262.0, 200.0, 200.0, -196.0, -31.0, -64.0, 2.0, -592.0, -119.0, 200.0, 24.0, 134.0, 57.0, 200.0, 200.0, 178.0, 35.0, -779.0, -141.0, 13.0, 200.0, 200.0, -20.0, -152.0, 35.0, 200.0, -130.0, 200.0, -1032.0, -1758.0, 178.0, 200.0, 57.0, 46.0, -42.0, 200.0, -75.0, -251.0, 200.0, 46.0, 2.0, 200.0, 13.0, 24.0, 123.0, -86.0], "policy_predator_policy_reward": [110.0, 50.0, 195.0, 95.0, 30.0, 110.0, 100.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 85.0, 0.0, 0.0, 125.0, 70.0, 95.0, 0.0, 40.0, 5.0, 50.0, 60.0, 225.0, 105.0, 0.0, 90.0, 5.0, 0.0, 0.0, 0.0, 0.0, 70.0, 25.0, 80.0, 75.0, 30.0, 0.0, 150.0, 0.0, 220.0, 20.0, 175.0, 20.0, 180.0, 115.0, 0.0, 15.0, 0.0, 35.0, 0.0, 405.0, 35.0, 45.0, 95.0, 110.0, 50.0, 0.0, 20.0, 20.0, 10.0, 255.0, 280.0, 295.0, 145.0, 65.0, 1000.0, 145.0, 0.0, 95.0, 0.0, 110.0, 110.0, 0.0, 395.0, 150.0, 0.0, 110.0, 120.0, 100.0, 0.0, 5.0, 0.0, 50.0, 5.0, 810.0, 80.0, 0.0, 125.0, 140.0, 0.0, 140.0, 100.0, 0.0, 20.0, 0.0, 130.0, 65.0, 40.0, 45.0, 95.0, 80.0, 145.0, 0.0, 0.0, 0.0, 255.0, 120.0, 255.0, 110.0, 160.0, 70.0, 95.0, 110.0, 215.0, 95.0, 0.0, 10.0, 35.0, 0.0, 80.0, 10.0, 0.0, 0.0, 165.0, 275.0, 105.0, 0.0, 285.0, 200.0, 290.0, 0.0, 75.0, 80.0, 0.0, 0.0, 180.0, 170.0, 150.0, 10.0, 250.0, 95.0, 65.0, 245.0, 10.0, 0.0, 5.0, 110.0, 40.0, 0.0, 65.0, 0.0, 10.0, 65.0, 0.0, 45.0, 0.0, 100.0, 0.0, 140.0, 0.0, 0.0, 5.0, 115.0, 0.0, 0.0, 80.0, 0.0, 5.0, 0.0, 50.0, 0.0, 100.0, 205.0, 220.0, 160.0, 280.0, 230.0, 75.0, 70.0, 130.0, 0.0, 0.0, 5.0, 195.0, 100.0, 105.0, 265.0, 350.0, 130.0, 5.0, 40.0, 0.0, 60.0, 0.0, 60.0, 155.0, 85.0, 135.0, 95.0, 90.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 150.0, 640.0, 520.0, 510.0, 5.0, 90.0, 140.0, 0.0, 135.0, 180.0, 170.0, 0.0, 0.0, 0.0, 0.0, 0.0, 100.0, 45.0, 180.0, 75.0, 90.0, 260.0, 0.0, 0.0, 265.0, 60.0, 110.0, 0.0, 0.0, 100.0, 180.0, 0.0, 45.0, 30.0, 570.0, 445.0, 350.0, 105.0, 240.0, 185.0, 10.0, 180.0, 0.0, 105.0, 120.0, 25.0, 365.0, 180.0, 325.0, 20.0, 65.0, 85.0, 0.0, 10.0, 0.0, 445.0, 280.0, 95.0, 60.0, 0.0, 30.0, 100.0, 85.0, 150.0, 90.0, 130.0, 150.0, 875.0, 165.0, 205.0, 0.0, 70.0, 5.0, 125.0, 0.0, 0.0, 165.0, 70.0, 45.0, 15.0, 0.0, 100.0, 165.0, 35.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9798979378428955, "mean_inference_ms": 1.6547496357336247, "mean_action_processing_ms": 0.3720631414399711, "mean_env_wait_ms": 0.261522387581869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006074309349060059, "StateBufferConnector_ms": 0.00526881217956543, "ViewRequirementAgentConnector_ms": 0.15611350536346436}, "num_episodes": 23, "episode_return_max": 640.0, "episode_return_min": -2447.0, "episode_return_mean": 279.68, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.15405096708602, "num_env_steps_trained_throughput_per_sec": 56.15405096708602, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1656000, "timers": {"training_iteration_time_ms": 73043.662, "restore_workers_time_ms": 0.014, "training_step_time_ms": 73043.606, "sample_time_ms": 1387.445, "learn_time_ms": 71637.959, "learn_throughput": 55.836, "synch_weights_time_ms": 14.012}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1656000, "num_agent_steps_trained": 1656000}, "done": false, "training_iteration": 69, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-52-24", "timestamp": 1723492344, "time_this_iter_s": 71.28999471664429, "time_total_s": 5748.003461837769, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b231b550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5748.003461837769, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 18.81584158415842, "ram_util_percent": 77.26732673267325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.730004821601489, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4696838465565485, "policy_loss": -0.007215242577583512, "vf_loss": 1.4763707135797393, "vf_explained_var": 6.734344130712199e-05, "kl": 0.007044980860591234, "entropy": 0.6144848580584459, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 195990.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6148712131676946, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3405052063947027, "policy_loss": -0.01993819935394266, "vf_loss": 1.3593545139047272, "vf_explained_var": 0.0234478715252369, "kl": 0.010888906242145736, "entropy": 1.2107621128254749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 195990.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 640.0, "episode_reward_min": -2447.0, "episode_reward_mean": 262.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -17.25, "predator_policy": 104.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-489.0, 390.0, 375.0, 562.0, 363.0, -2447.0, 114.0, 490.0, -186.0, 566.0, 474.0, 545.0, -1524.0, 315.0, 477.0, 420.0, 563.0, 150.0, 600.0, -519.0, 346.0, 283.0, 452.0, 517.0, 588.0, 320.0, -367.0, 85.0, 504.0, 374.0, 350.0, 238.0, 462.0, 474.0, 477.0, 546.0, 268.0, 594.0, 429.0, 465.0, 540.0, 410.0, 280.0, 193.0, 594.0, 571.0, 355.0, 557.0, 456.0, 205.0, 180.0, 549.0, 600.0, 222.0, 433.0, 186.0, 222.0, 297.0, 600.0, 199.0, 255.0, -246.0, 209.0, 22.0, 576.0, 128.0, 173.0, 394.0, 157.0, 359.0, 385.0, 588.0, -65.0, 503.0, 198.0, 640.0, -1367.0, 378.0, 208.0, 275.0, 330.0, 281.0, 335.0, 526.0, 500.0, 311.0, 384.0, 363.0, 334.0, 182.0, 398.0, 294.0, -225.0, 552.0, 169.0, 173.0, 330.0, 444.0, 207.0, 314.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-383.0, -669.0, 123.0, 112.0, -9.0, 112.0, -42.0, 200.0, 57.0, 200.0, 200.0, 112.0, -9.0, -163.0, -295.0, -1835.0, 178.0, -2000.0, -31.0, -130.0, 35.0, -119.0, 200.0, 189.0, -669.0, -9.0, -53.0, 200.0, -64.0, 200.0, -20.0, 200.0, 189.0, 90.0, 200.0, 200.0, -1318.0, -383.0, -713.0, -31.0, 2.0, 79.0, -75.0, 112.0, 200.0, -86.0, 200.0, 156.0, 200.0, 145.0, 68.0, -53.0, -108.0, -9.0, 200.0, 200.0, 200.0, -372.0, -317.0, -460.0, -119.0, -53.0, 178.0, 68.0, -119.0, -86.0, 178.0, 35.0, 134.0, 178.0, 79.0, 145.0, 200.0, 200.0, 178.0, -449.0, 101.0, 123.0, -394.0, -20.0, -438.0, -64.0, 35.0, -251.0, 200.0, 24.0, 200.0, 13.0, -141.0, 2.0, 178.0, -383.0, 200.0, 200.0, -339.0, 57.0, 200.0, -53.0, 200.0, 57.0, 112.0, 200.0, 200.0, 145.0, 57.0, 200.0, 200.0, 101.0, 46.0, -20.0, 2.0, 200.0, 189.0, 200.0, -53.0, 167.0, 200.0, 178.0, 145.0, 57.0, 90.0, 200.0, 200.0, 189.0, -482.0, 178.0, -31.0, -108.0, -251.0, -86.0, -9.0, 13.0, 189.0, 200.0, 200.0, -229.0, 200.0, 200.0, -559.0, 167.0, 2.0, 112.0, 200.0, 200.0, 68.0, 68.0, 200.0, -218.0, 24.0, 24.0, -9.0, 2.0, 2.0, 167.0, 167.0, 200.0, 200.0, 200.0, 200.0, -86.0, -42.0, 200.0, 200.0, 79.0, -1516.0, 13.0, 57.0, -119.0, 101.0, -306.0, 112.0, 178.0, 123.0, -174.0, 200.0, 200.0, 200.0, -75.0, -251.0, 200.0, -119.0, 145.0, -196.0, -372.0, -339.0, 200.0, -31.0, 90.0, -20.0, -119.0, -97.0, -42.0, 101.0, 200.0, 200.0, 68.0, -1329.0, 24.0, 200.0, -295.0, -262.0, 200.0, 200.0, -196.0, -31.0, -64.0, 2.0, -592.0, -119.0, 200.0, 24.0, 134.0, 57.0, 200.0, 200.0, 178.0, 35.0, -779.0, -141.0, 13.0, 200.0, 200.0, -20.0, -152.0, 35.0, 200.0, -130.0, 200.0, -1032.0, -1758.0, 178.0, 200.0, 57.0, 46.0, -42.0, 200.0, -75.0, -251.0, 200.0, 46.0, 2.0, 200.0, 13.0, 24.0, 123.0, -86.0, -86.0, -31.0, 167.0, 200.0, 46.0, 200.0, -240.0, 200.0, 200.0, -9.0, -53.0, -427.0, -9.0, -42.0, 200.0, 101.0, 200.0, -53.0, 200.0, -262.0, -64.0, 79.0, 68.0, -460.0, 101.0, 90.0, 112.0, 200.0, -207.0, -119.0, -31.0, 35.0, -999.0, 200.0, 112.0, 200.0, -42.0, 46.0, 35.0, -405.0, -42.0, 200.0, 2.0, 156.0, -53.0, 200.0, 200.0, -86.0, -75.0, -20.0, -108.0, 46.0, -42.0, 200.0], "policy_predator_policy_reward": [35.0, 0.0, 405.0, 35.0, 45.0, 95.0, 110.0, 50.0, 0.0, 20.0, 20.0, 10.0, 255.0, 280.0, 295.0, 145.0, 65.0, 1000.0, 145.0, 0.0, 95.0, 0.0, 110.0, 110.0, 0.0, 395.0, 150.0, 0.0, 110.0, 120.0, 100.0, 0.0, 5.0, 0.0, 50.0, 5.0, 810.0, 80.0, 0.0, 125.0, 140.0, 0.0, 140.0, 100.0, 0.0, 20.0, 0.0, 130.0, 65.0, 40.0, 45.0, 95.0, 80.0, 145.0, 0.0, 0.0, 0.0, 255.0, 120.0, 255.0, 110.0, 160.0, 70.0, 95.0, 110.0, 215.0, 95.0, 0.0, 10.0, 35.0, 0.0, 80.0, 10.0, 0.0, 0.0, 165.0, 275.0, 105.0, 0.0, 285.0, 200.0, 290.0, 0.0, 75.0, 80.0, 0.0, 0.0, 180.0, 170.0, 150.0, 10.0, 250.0, 95.0, 65.0, 245.0, 10.0, 0.0, 5.0, 110.0, 40.0, 0.0, 65.0, 0.0, 10.0, 65.0, 0.0, 45.0, 0.0, 100.0, 0.0, 140.0, 0.0, 0.0, 5.0, 115.0, 0.0, 0.0, 80.0, 0.0, 5.0, 0.0, 50.0, 0.0, 100.0, 205.0, 220.0, 160.0, 280.0, 230.0, 75.0, 70.0, 130.0, 0.0, 0.0, 5.0, 195.0, 100.0, 105.0, 265.0, 350.0, 130.0, 5.0, 40.0, 0.0, 60.0, 0.0, 60.0, 155.0, 85.0, 135.0, 95.0, 90.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 150.0, 640.0, 520.0, 510.0, 5.0, 90.0, 140.0, 0.0, 135.0, 180.0, 170.0, 0.0, 0.0, 0.0, 0.0, 0.0, 100.0, 45.0, 180.0, 75.0, 90.0, 260.0, 0.0, 0.0, 265.0, 60.0, 110.0, 0.0, 0.0, 100.0, 180.0, 0.0, 45.0, 30.0, 570.0, 445.0, 350.0, 105.0, 240.0, 185.0, 10.0, 180.0, 0.0, 105.0, 120.0, 25.0, 365.0, 180.0, 325.0, 20.0, 65.0, 85.0, 0.0, 10.0, 0.0, 445.0, 280.0, 95.0, 60.0, 0.0, 30.0, 100.0, 85.0, 150.0, 90.0, 130.0, 150.0, 875.0, 165.0, 205.0, 0.0, 70.0, 5.0, 125.0, 0.0, 0.0, 165.0, 70.0, 45.0, 15.0, 0.0, 100.0, 165.0, 35.0, 20.0, 50.0, 130.0, 105.0, 40.0, 40.0, 0.0, 80.0, 200.0, 60.0, 260.0, 265.0, 275.0, 95.0, 30.0, 110.0, 115.0, 0.0, 0.0, 140.0, 145.0, 175.0, 200.0, 0.0, 295.0, 50.0, 0.0, 45.0, 90.0, 145.0, 185.0, 75.0, 245.0, 450.0, 40.0, 0.0, 0.0, 0.0, 125.0, 5.0, 275.0, 35.0, 110.0, 20.0, 90.0, 115.0, 130.0, 0.0, 0.0, 110.0, 135.0, 165.0, 110.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9781262744898385, "mean_inference_ms": 1.6516627966108508, "mean_action_processing_ms": 0.37152658077589934, "mean_env_wait_ms": 0.261103715024983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051239728927612305, "StateBufferConnector_ms": 0.005183696746826172, "ViewRequirementAgentConnector_ms": 0.14805293083190918}, "num_episodes": 18, "episode_return_max": 640.0, "episode_return_min": -2447.0, "episode_return_mean": 262.65, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.64407115699265, "num_env_steps_trained_throughput_per_sec": 54.64407115699265, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 73042.495, "restore_workers_time_ms": 0.014, "training_step_time_ms": 73042.437, "sample_time_ms": 1398.085, "learn_time_ms": 71626.613, "learn_throughput": 55.845, "synch_weights_time_ms": 13.691}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 70, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-53-37", "timestamp": 1723492417, "time_this_iter_s": 73.23370718955994, "time_total_s": 5821.2371690273285, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2332c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5821.2371690273285, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 23.049514563106793, "ram_util_percent": 78.45242718446603}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3781526090405511, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5021421485336115, "policy_loss": -0.006625353383124932, "vf_loss": 1.5082852298697682, "vf_explained_var": -2.5204119952857917e-05, "kl": 0.006430276243547159, "entropy": 0.5388904218343978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 198810.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.477038406036424, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8083660777367598, "policy_loss": -0.01766736004336453, "vf_loss": 1.825080436235624, "vf_explained_var": 0.018961401526809585, "kl": 0.009530030507867786, "entropy": 1.1883935583398697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 198810.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "env_runners": {"episode_reward_max": 640.0, "episode_reward_min": -2904.0, "episode_reward_mean": 246.48, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1758.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -26.49, "predator_policy": 108.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [600.0, -519.0, 346.0, 283.0, 452.0, 517.0, 588.0, 320.0, -367.0, 85.0, 504.0, 374.0, 350.0, 238.0, 462.0, 474.0, 477.0, 546.0, 268.0, 594.0, 429.0, 465.0, 540.0, 410.0, 280.0, 193.0, 594.0, 571.0, 355.0, 557.0, 456.0, 205.0, 180.0, 549.0, 600.0, 222.0, 433.0, 186.0, 222.0, 297.0, 600.0, 199.0, 255.0, -246.0, 209.0, 22.0, 576.0, 128.0, 173.0, 394.0, 157.0, 359.0, 385.0, 588.0, -65.0, 503.0, 198.0, 640.0, -1367.0, 378.0, 208.0, 275.0, 330.0, 281.0, 335.0, 526.0, 500.0, 311.0, 384.0, 363.0, 334.0, 182.0, 398.0, 294.0, -225.0, 552.0, 169.0, 173.0, 330.0, 444.0, 207.0, 314.0, 252.0, -599.0, 333.0, 588.0, -76.0, -78.0, 349.0, -2904.0, -1033.0, 90.0, 401.0, 372.0, -303.0, 600.0, 517.0, 504.0, 204.0, 324.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, -372.0, -317.0, -460.0, -119.0, -53.0, 178.0, 68.0, -119.0, -86.0, 178.0, 35.0, 134.0, 178.0, 79.0, 145.0, 200.0, 200.0, 178.0, -449.0, 101.0, 123.0, -394.0, -20.0, -438.0, -64.0, 35.0, -251.0, 200.0, 24.0, 200.0, 13.0, -141.0, 2.0, 178.0, -383.0, 200.0, 200.0, -339.0, 57.0, 200.0, -53.0, 200.0, 57.0, 112.0, 200.0, 200.0, 145.0, 57.0, 200.0, 200.0, 101.0, 46.0, -20.0, 2.0, 200.0, 189.0, 200.0, -53.0, 167.0, 200.0, 178.0, 145.0, 57.0, 90.0, 200.0, 200.0, 189.0, -482.0, 178.0, -31.0, -108.0, -251.0, -86.0, -9.0, 13.0, 189.0, 200.0, 200.0, -229.0, 200.0, 200.0, -559.0, 167.0, 2.0, 112.0, 200.0, 200.0, 68.0, 68.0, 200.0, -218.0, 24.0, 24.0, -9.0, 2.0, 2.0, 167.0, 167.0, 200.0, 200.0, 200.0, 200.0, -86.0, -42.0, 200.0, 200.0, 79.0, -1516.0, 13.0, 57.0, -119.0, 101.0, -306.0, 112.0, 178.0, 123.0, -174.0, 200.0, 200.0, 200.0, -75.0, -251.0, 200.0, -119.0, 145.0, -196.0, -372.0, -339.0, 200.0, -31.0, 90.0, -20.0, -119.0, -97.0, -42.0, 101.0, 200.0, 200.0, 68.0, -1329.0, 24.0, 200.0, -295.0, -262.0, 200.0, 200.0, -196.0, -31.0, -64.0, 2.0, -592.0, -119.0, 200.0, 24.0, 134.0, 57.0, 200.0, 200.0, 178.0, 35.0, -779.0, -141.0, 13.0, 200.0, 200.0, -20.0, -152.0, 35.0, 200.0, -130.0, 200.0, -1032.0, -1758.0, 178.0, 200.0, 57.0, 46.0, -42.0, 200.0, -75.0, -251.0, 200.0, 46.0, 2.0, 200.0, 13.0, 24.0, 123.0, -86.0, -86.0, -31.0, 167.0, 200.0, 46.0, 200.0, -240.0, 200.0, 200.0, -9.0, -53.0, -427.0, -9.0, -42.0, 200.0, 101.0, 200.0, -53.0, 200.0, -262.0, -64.0, 79.0, 68.0, -460.0, 101.0, 90.0, 112.0, 200.0, -207.0, -119.0, -31.0, 35.0, -999.0, 200.0, 112.0, 200.0, -42.0, 46.0, 35.0, -405.0, -42.0, 200.0, 2.0, 156.0, -53.0, 200.0, 200.0, -86.0, -75.0, -20.0, -108.0, 46.0, -42.0, 200.0, 57.0, 200.0, -295.0, -702.0, -636.0, -306.0, 200.0, -372.0, 200.0, 200.0, 178.0, 200.0, -372.0, 2.0, -251.0, -141.0, -163.0, -119.0, -42.0, 101.0, -75.0, -1626.0, -746.0, -1747.0, -911.0, -383.0, -669.0, -306.0, 68.0, 13.0, 200.0, -174.0, 35.0, 145.0, 200.0, -163.0, -163.0, -108.0, -592.0, 200.0, 200.0, 200.0, 200.0, -218.0, 200.0, 200.0, 200.0, 24.0, 13.0, -152.0, -42.0, 35.0, 112.0, 2.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 255.0, 120.0, 255.0, 110.0, 160.0, 70.0, 95.0, 110.0, 215.0, 95.0, 0.0, 10.0, 35.0, 0.0, 80.0, 10.0, 0.0, 0.0, 165.0, 275.0, 105.0, 0.0, 285.0, 200.0, 290.0, 0.0, 75.0, 80.0, 0.0, 0.0, 180.0, 170.0, 150.0, 10.0, 250.0, 95.0, 65.0, 245.0, 10.0, 0.0, 5.0, 110.0, 40.0, 0.0, 65.0, 0.0, 10.0, 65.0, 0.0, 45.0, 0.0, 100.0, 0.0, 140.0, 0.0, 0.0, 5.0, 115.0, 0.0, 0.0, 80.0, 0.0, 5.0, 0.0, 50.0, 0.0, 100.0, 205.0, 220.0, 160.0, 280.0, 230.0, 75.0, 70.0, 130.0, 0.0, 0.0, 5.0, 195.0, 100.0, 105.0, 265.0, 350.0, 130.0, 5.0, 40.0, 0.0, 60.0, 0.0, 60.0, 155.0, 85.0, 135.0, 95.0, 90.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 150.0, 640.0, 520.0, 510.0, 5.0, 90.0, 140.0, 0.0, 135.0, 180.0, 170.0, 0.0, 0.0, 0.0, 0.0, 0.0, 100.0, 45.0, 180.0, 75.0, 90.0, 260.0, 0.0, 0.0, 265.0, 60.0, 110.0, 0.0, 0.0, 100.0, 180.0, 0.0, 45.0, 30.0, 570.0, 445.0, 350.0, 105.0, 240.0, 185.0, 10.0, 180.0, 0.0, 105.0, 120.0, 25.0, 365.0, 180.0, 325.0, 20.0, 65.0, 85.0, 0.0, 10.0, 0.0, 445.0, 280.0, 95.0, 60.0, 0.0, 30.0, 100.0, 85.0, 150.0, 90.0, 130.0, 150.0, 875.0, 165.0, 205.0, 0.0, 70.0, 5.0, 125.0, 0.0, 0.0, 165.0, 70.0, 45.0, 15.0, 0.0, 100.0, 165.0, 35.0, 20.0, 50.0, 130.0, 105.0, 40.0, 40.0, 0.0, 80.0, 200.0, 60.0, 260.0, 265.0, 275.0, 95.0, 30.0, 110.0, 115.0, 0.0, 0.0, 140.0, 145.0, 175.0, 200.0, 0.0, 295.0, 50.0, 0.0, 45.0, 90.0, 145.0, 185.0, 75.0, 245.0, 450.0, 40.0, 0.0, 0.0, 0.0, 125.0, 5.0, 275.0, 35.0, 110.0, 20.0, 90.0, 115.0, 130.0, 0.0, 0.0, 110.0, 135.0, 165.0, 110.0, 0.0, 0.0, 225.0, 65.0, 0.0, 455.0, 305.0, 285.0, 160.0, 0.0, 145.0, 0.0, 10.0, 0.0, 245.0, 255.0, 45.0, 0.0, 220.0, 125.0, 165.0, 170.0, 30.0, 140.0, 975.0, 100.0, 365.0, 565.0, 0.0, 85.0, 0.0, 230.0, 0.0, 190.0, 150.0, 165.0, 25.0, 0.0, 200.0, 360.0, 0.0, 0.0, 0.0, 0.0, 35.0, 145.0, 155.0, 0.0, 80.0, 0.0, 90.0, 170.0, 125.0, 85.0, 0.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9761860257274135, "mean_inference_ms": 1.6484229787511457, "mean_action_processing_ms": 0.3709533143181201, "mean_env_wait_ms": 0.2606680430939779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00509333610534668, "StateBufferConnector_ms": 0.00518190860748291, "ViewRequirementAgentConnector_ms": 0.14648175239562988}, "num_episodes": 18, "episode_return_max": 640.0, "episode_return_min": -2904.0, "episode_return_mean": 246.48, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.40192454370216, "num_env_steps_trained_throughput_per_sec": 55.40192454370216, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1704000, "timers": {"training_iteration_time_ms": 72886.925, "restore_workers_time_ms": 0.014, "training_step_time_ms": 72886.866, "sample_time_ms": 1388.13, "learn_time_ms": 71480.618, "learn_throughput": 55.959, "synch_weights_time_ms": 14.07}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1704000, "num_agent_steps_trained": 1704000}, "done": false, "training_iteration": 71, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-54-49", "timestamp": 1723492489, "time_this_iter_s": 72.24735498428345, "time_total_s": 5893.484524011612, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b231bb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5893.484524011612, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 19.636274509803922, "ram_util_percent": 78.90098039215687}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5229617160685518, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5690784956969268, "policy_loss": -0.00802198029090221, "vf_loss": 1.5765665730157643, "vf_explained_var": -6.608728398668006e-05, "kl": 0.007118615265137564, "entropy": 0.5417576285752844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 201630.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4576600245972897, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9748082503570732, "policy_loss": -0.020722627730260717, "vf_loss": 1.9944460410175595, "vf_explained_var": 0.01864357222902014, "kl": 0.010848350248240135, "entropy": 1.16182306104518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 201630.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 640.0, "episode_reward_min": -4066.0, "episode_reward_mean": 182.62, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -57.693333333333335, "predator_policy": 118.56666666666666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [540.0, 410.0, 280.0, 193.0, 594.0, 571.0, 355.0, 557.0, 456.0, 205.0, 180.0, 549.0, 600.0, 222.0, 433.0, 186.0, 222.0, 297.0, 600.0, 199.0, 255.0, -246.0, 209.0, 22.0, 576.0, 128.0, 173.0, 394.0, 157.0, 359.0, 385.0, 588.0, -65.0, 503.0, 198.0, 640.0, -1367.0, 378.0, 208.0, 275.0, 330.0, 281.0, 335.0, 526.0, 500.0, 311.0, 384.0, 363.0, 334.0, 182.0, 398.0, 294.0, -225.0, 552.0, 169.0, 173.0, 330.0, 444.0, 207.0, 314.0, 252.0, -599.0, 333.0, 588.0, -76.0, -78.0, 349.0, -2904.0, -1033.0, 90.0, 401.0, 372.0, -303.0, 600.0, 517.0, 504.0, 204.0, 324.0, 184.0, 600.0, 445.0, 323.0, 483.0, 564.0, 186.0, 491.0, 170.0, 419.0, 481.0, 588.0, 538.0, 342.0, 401.0, -135.0, 441.0, 551.0, 507.0, -2279.0, -134.0, -4066.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [90.0, 200.0, 200.0, 189.0, -482.0, 178.0, -31.0, -108.0, -251.0, -86.0, -9.0, 13.0, 189.0, 200.0, 200.0, -229.0, 200.0, 200.0, -559.0, 167.0, 2.0, 112.0, 200.0, 200.0, 68.0, 68.0, 200.0, -218.0, 24.0, 24.0, -9.0, 2.0, 2.0, 167.0, 167.0, 200.0, 200.0, 200.0, 200.0, -86.0, -42.0, 200.0, 200.0, 79.0, -1516.0, 13.0, 57.0, -119.0, 101.0, -306.0, 112.0, 178.0, 123.0, -174.0, 200.0, 200.0, 200.0, -75.0, -251.0, 200.0, -119.0, 145.0, -196.0, -372.0, -339.0, 200.0, -31.0, 90.0, -20.0, -119.0, -97.0, -42.0, 101.0, 200.0, 200.0, 68.0, -1329.0, 24.0, 200.0, -295.0, -262.0, 200.0, 200.0, -196.0, -31.0, -64.0, 2.0, -592.0, -119.0, 200.0, 24.0, 134.0, 57.0, 200.0, 200.0, 178.0, 35.0, -779.0, -141.0, 13.0, 200.0, 200.0, -20.0, -152.0, 35.0, 200.0, -130.0, 200.0, -1032.0, -1758.0, 178.0, 200.0, 57.0, 46.0, -42.0, 200.0, -75.0, -251.0, 200.0, 46.0, 2.0, 200.0, 13.0, 24.0, 123.0, -86.0, -86.0, -31.0, 167.0, 200.0, 46.0, 200.0, -240.0, 200.0, 200.0, -9.0, -53.0, -427.0, -9.0, -42.0, 200.0, 101.0, 200.0, -53.0, 200.0, -262.0, -64.0, 79.0, 68.0, -460.0, 101.0, 90.0, 112.0, 200.0, -207.0, -119.0, -31.0, 35.0, -999.0, 200.0, 112.0, 200.0, -42.0, 46.0, 35.0, -405.0, -42.0, 200.0, 2.0, 156.0, -53.0, 200.0, 200.0, -86.0, -75.0, -20.0, -108.0, 46.0, -42.0, 200.0, 57.0, 200.0, -295.0, -702.0, -636.0, -306.0, 200.0, -372.0, 200.0, 200.0, 178.0, 200.0, -372.0, 2.0, -251.0, -141.0, -163.0, -119.0, -42.0, 101.0, -75.0, -1626.0, -746.0, -1747.0, -911.0, -383.0, -669.0, -306.0, 68.0, 13.0, 200.0, -174.0, 35.0, 145.0, 200.0, -163.0, -163.0, -108.0, -592.0, 200.0, 200.0, 200.0, 200.0, -218.0, 200.0, 200.0, 200.0, 24.0, 13.0, -152.0, -42.0, 35.0, 112.0, 2.0, -394.0, -482.0, 200.0, 200.0, 200.0, 200.0, 189.0, 156.0, -20.0, 79.0, 123.0, -119.0, 145.0, 200.0, 13.0, 200.0, 200.0, 134.0, 112.0, -108.0, -53.0, -119.0, 90.0, 200.0, -713.0, 200.0, -42.0, 134.0, 68.0, -163.0, 200.0, 200.0, -119.0, 200.0, 200.0, 178.0, 200.0, -977.0, 200.0, 68.0, -108.0, 2.0, 156.0, -64.0, 189.0, -262.0, -240.0, 112.0, 57.0, 167.0, 112.0, 200.0, -42.0, 178.0, 2.0, 178.0, 167.0, -1692.0, -317.0, -1340.0, -141.0, -64.0, -174.0, -1494.0, -1692.0, -2000.0], "policy_predator_policy_reward": [0.0, 50.0, 0.0, 100.0, 205.0, 220.0, 160.0, 280.0, 230.0, 75.0, 70.0, 130.0, 0.0, 0.0, 5.0, 195.0, 100.0, 105.0, 265.0, 350.0, 130.0, 5.0, 40.0, 0.0, 60.0, 0.0, 60.0, 155.0, 85.0, 135.0, 95.0, 90.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 150.0, 640.0, 520.0, 510.0, 5.0, 90.0, 140.0, 0.0, 135.0, 180.0, 170.0, 0.0, 0.0, 0.0, 0.0, 0.0, 100.0, 45.0, 180.0, 75.0, 90.0, 260.0, 0.0, 0.0, 265.0, 60.0, 110.0, 0.0, 0.0, 100.0, 180.0, 0.0, 45.0, 30.0, 570.0, 445.0, 350.0, 105.0, 240.0, 185.0, 10.0, 180.0, 0.0, 105.0, 120.0, 25.0, 365.0, 180.0, 325.0, 20.0, 65.0, 85.0, 0.0, 10.0, 0.0, 445.0, 280.0, 95.0, 60.0, 0.0, 30.0, 100.0, 85.0, 150.0, 90.0, 130.0, 150.0, 875.0, 165.0, 205.0, 0.0, 70.0, 5.0, 125.0, 0.0, 0.0, 165.0, 70.0, 45.0, 15.0, 0.0, 100.0, 165.0, 35.0, 20.0, 50.0, 130.0, 105.0, 40.0, 40.0, 0.0, 80.0, 200.0, 60.0, 260.0, 265.0, 275.0, 95.0, 30.0, 110.0, 115.0, 0.0, 0.0, 140.0, 145.0, 175.0, 200.0, 0.0, 295.0, 50.0, 0.0, 45.0, 90.0, 145.0, 185.0, 75.0, 245.0, 450.0, 40.0, 0.0, 0.0, 0.0, 125.0, 5.0, 275.0, 35.0, 110.0, 20.0, 90.0, 115.0, 130.0, 0.0, 0.0, 110.0, 135.0, 165.0, 110.0, 0.0, 0.0, 225.0, 65.0, 0.0, 455.0, 305.0, 285.0, 160.0, 0.0, 145.0, 0.0, 10.0, 0.0, 245.0, 255.0, 45.0, 0.0, 220.0, 125.0, 165.0, 170.0, 30.0, 140.0, 975.0, 100.0, 365.0, 565.0, 0.0, 85.0, 0.0, 230.0, 0.0, 190.0, 150.0, 165.0, 25.0, 0.0, 200.0, 360.0, 0.0, 0.0, 0.0, 0.0, 35.0, 145.0, 155.0, 0.0, 80.0, 0.0, 90.0, 170.0, 125.0, 85.0, 0.0, 90.0, 370.0, 380.0, 110.0, 0.0, 0.0, 0.0, 0.0, 70.0, 50.0, 145.0, 35.0, 60.0, 0.0, 50.0, 75.0, 30.0, 0.0, 0.0, 140.0, 80.0, 15.0, 140.0, 145.0, 35.0, 270.0, 125.0, 330.0, 90.0, 150.0, 140.0, 115.0, 10.0, 75.0, 10.0, 0.0, 0.0, 365.0, 335.0, 415.0, 110.0, 125.0, 145.0, 0.0, 0.0, 120.0, 215.0, 0.0, 40.0, 65.0, 40.0, 0.0, 90.0, 70.0, 55.0, 90.0, 25.0, 45.0, 85.0, 60.0, 925.0, 60.0, 180.0, 5.0, 55.0, 910.0, 155.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9735148417958638, "mean_inference_ms": 1.643812654920229, "mean_action_processing_ms": 0.3701736072036047, "mean_env_wait_ms": 0.26007444337383523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051184892654418945, "StateBufferConnector_ms": 0.0043288469314575195, "ViewRequirementAgentConnector_ms": 0.14463961124420166}, "num_episodes": 22, "episode_return_max": 640.0, "episode_return_min": -4066.0, "episode_return_mean": 182.62, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.80086641063078, "num_env_steps_trained_throughput_per_sec": 55.80086641063078, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 72770.208, "restore_workers_time_ms": 0.014, "training_step_time_ms": 72770.149, "sample_time_ms": 1373.968, "learn_time_ms": 71377.842, "learn_throughput": 56.04, "synch_weights_time_ms": 14.211}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 72, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-56-01", "timestamp": 1723492561, "time_this_iter_s": 71.7220709323883, "time_total_s": 5965.206594944, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32f69c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5965.206594944, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 19.137254901960784, "ram_util_percent": 79.62058823529411}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5734624931892605, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4060339619081916, "policy_loss": -0.006056131421776607, "vf_loss": 1.4115541720643956, "vf_explained_var": -5.6545933087666826e-05, "kl": 0.007145494865655035, "entropy": 0.6316631133463366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 204450.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.439905819074904, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4857142125249754, "policy_loss": -0.01690975665098307, "vf_loss": 1.5016865180950638, "vf_explained_var": 0.02332785780548204, "kl": 0.009374499177206399, "entropy": 1.1819261765649132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 204450.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "env_runners": {"episode_reward_max": 640.0, "episode_reward_min": -4066.0, "episode_reward_mean": 148.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -73.27666666666667, "predator_policy": 122.73333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.0, 576.0, 128.0, 173.0, 394.0, 157.0, 359.0, 385.0, 588.0, -65.0, 503.0, 198.0, 640.0, -1367.0, 378.0, 208.0, 275.0, 330.0, 281.0, 335.0, 526.0, 500.0, 311.0, 384.0, 363.0, 334.0, 182.0, 398.0, 294.0, -225.0, 552.0, 169.0, 173.0, 330.0, 444.0, 207.0, 314.0, 252.0, -599.0, 333.0, 588.0, -76.0, -78.0, 349.0, -2904.0, -1033.0, 90.0, 401.0, 372.0, -303.0, 600.0, 517.0, 504.0, 204.0, 324.0, 184.0, 600.0, 445.0, 323.0, 483.0, 564.0, 186.0, 491.0, 170.0, 419.0, 481.0, 588.0, 538.0, 342.0, 401.0, -135.0, 441.0, 551.0, 507.0, -2279.0, -134.0, -4066.0, 507.0, 317.0, 512.0, 111.0, 506.0, 379.0, 484.0, 238.0, 194.0, 532.0, 508.0, 71.0, 141.0, -144.0, 338.0, 45.0, 261.0, 125.0, 243.0, -682.0, -863.0, 472.0, 147.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-119.0, -97.0, -42.0, 101.0, 200.0, 200.0, 68.0, -1329.0, 24.0, 200.0, -295.0, -262.0, 200.0, 200.0, -196.0, -31.0, -64.0, 2.0, -592.0, -119.0, 200.0, 24.0, 134.0, 57.0, 200.0, 200.0, 178.0, 35.0, -779.0, -141.0, 13.0, 200.0, 200.0, -20.0, -152.0, 35.0, 200.0, -130.0, 200.0, -1032.0, -1758.0, 178.0, 200.0, 57.0, 46.0, -42.0, 200.0, -75.0, -251.0, 200.0, 46.0, 2.0, 200.0, 13.0, 24.0, 123.0, -86.0, -86.0, -31.0, 167.0, 200.0, 46.0, 200.0, -240.0, 200.0, 200.0, -9.0, -53.0, -427.0, -9.0, -42.0, 200.0, 101.0, 200.0, -53.0, 200.0, -262.0, -64.0, 79.0, 68.0, -460.0, 101.0, 90.0, 112.0, 200.0, -207.0, -119.0, -31.0, 35.0, -999.0, 200.0, 112.0, 200.0, -42.0, 46.0, 35.0, -405.0, -42.0, 200.0, 2.0, 156.0, -53.0, 200.0, 200.0, -86.0, -75.0, -20.0, -108.0, 46.0, -42.0, 200.0, 57.0, 200.0, -295.0, -702.0, -636.0, -306.0, 200.0, -372.0, 200.0, 200.0, 178.0, 200.0, -372.0, 2.0, -251.0, -141.0, -163.0, -119.0, -42.0, 101.0, -75.0, -1626.0, -746.0, -1747.0, -911.0, -383.0, -669.0, -306.0, 68.0, 13.0, 200.0, -174.0, 35.0, 145.0, 200.0, -163.0, -163.0, -108.0, -592.0, 200.0, 200.0, 200.0, 200.0, -218.0, 200.0, 200.0, 200.0, 24.0, 13.0, -152.0, -42.0, 35.0, 112.0, 2.0, -394.0, -482.0, 200.0, 200.0, 200.0, 200.0, 189.0, 156.0, -20.0, 79.0, 123.0, -119.0, 145.0, 200.0, 13.0, 200.0, 200.0, 134.0, 112.0, -108.0, -53.0, -119.0, 90.0, 200.0, -713.0, 200.0, -42.0, 134.0, 68.0, -163.0, 200.0, 200.0, -119.0, 200.0, 200.0, 178.0, 200.0, -977.0, 200.0, 68.0, -108.0, 2.0, 156.0, -64.0, 189.0, -262.0, -240.0, 112.0, 57.0, 167.0, 112.0, 200.0, -42.0, 178.0, 2.0, 178.0, 167.0, -1692.0, -317.0, -1340.0, -141.0, -64.0, -174.0, -1494.0, -1692.0, -2000.0, -108.0, 200.0, 200.0, 200.0, -97.0, -196.0, 46.0, 200.0, 156.0, 2.0, -31.0, -185.0, 200.0, 57.0, 134.0, 167.0, 13.0, 24.0, 200.0, -86.0, 200.0, 46.0, -130.0, 112.0, -141.0, 112.0, 68.0, 200.0, 200.0, 2.0, 200.0, 156.0, -53.0, -482.0, -97.0, 35.0, -207.0, 35.0, 13.0, -405.0, -141.0, -218.0, -592.0, -75.0, 200.0, 167.0, 101.0, -988.0, -207.0, 57.0, -9.0, -108.0, -108.0, 156.0, -64.0, 57.0, -20.0, 112.0, -504.0, -1010.0, -416.0, -306.0, -966.0, 90.0, -207.0, 189.0, 35.0, -64.0, -64.0], "policy_predator_policy_reward": [0.0, 100.0, 180.0, 0.0, 45.0, 30.0, 570.0, 445.0, 350.0, 105.0, 240.0, 185.0, 10.0, 180.0, 0.0, 105.0, 120.0, 25.0, 365.0, 180.0, 325.0, 20.0, 65.0, 85.0, 0.0, 10.0, 0.0, 445.0, 280.0, 95.0, 60.0, 0.0, 30.0, 100.0, 85.0, 150.0, 90.0, 130.0, 150.0, 875.0, 165.0, 205.0, 0.0, 70.0, 5.0, 125.0, 0.0, 0.0, 165.0, 70.0, 45.0, 15.0, 0.0, 100.0, 165.0, 35.0, 20.0, 50.0, 130.0, 105.0, 40.0, 40.0, 0.0, 80.0, 200.0, 60.0, 260.0, 265.0, 275.0, 95.0, 30.0, 110.0, 115.0, 0.0, 0.0, 140.0, 145.0, 175.0, 200.0, 0.0, 295.0, 50.0, 0.0, 45.0, 90.0, 145.0, 185.0, 75.0, 245.0, 450.0, 40.0, 0.0, 0.0, 0.0, 125.0, 5.0, 275.0, 35.0, 110.0, 20.0, 90.0, 115.0, 130.0, 0.0, 0.0, 110.0, 135.0, 165.0, 110.0, 0.0, 0.0, 225.0, 65.0, 0.0, 455.0, 305.0, 285.0, 160.0, 0.0, 145.0, 0.0, 10.0, 0.0, 245.0, 255.0, 45.0, 0.0, 220.0, 125.0, 165.0, 170.0, 30.0, 140.0, 975.0, 100.0, 365.0, 565.0, 0.0, 85.0, 0.0, 230.0, 0.0, 190.0, 150.0, 165.0, 25.0, 0.0, 200.0, 360.0, 0.0, 0.0, 0.0, 0.0, 35.0, 145.0, 155.0, 0.0, 80.0, 0.0, 90.0, 170.0, 125.0, 85.0, 0.0, 90.0, 370.0, 380.0, 110.0, 0.0, 0.0, 0.0, 0.0, 70.0, 50.0, 145.0, 35.0, 60.0, 0.0, 50.0, 75.0, 30.0, 0.0, 0.0, 140.0, 80.0, 15.0, 140.0, 145.0, 35.0, 270.0, 125.0, 330.0, 90.0, 150.0, 140.0, 115.0, 10.0, 75.0, 10.0, 0.0, 0.0, 365.0, 335.0, 415.0, 110.0, 125.0, 145.0, 0.0, 0.0, 120.0, 215.0, 0.0, 40.0, 65.0, 40.0, 0.0, 90.0, 70.0, 55.0, 90.0, 25.0, 45.0, 85.0, 60.0, 925.0, 60.0, 180.0, 5.0, 55.0, 910.0, 155.0, 75.0, 130.0, 10.0, 155.0, 185.0, 70.0, 60.0, 40.0, 10.0, 25.0, 185.0, 115.0, 55.0, 60.0, 0.0, 65.0, 100.0, 10.0, 40.0, 130.0, 0.0, 20.0, 150.0, 40.0, 0.0, 0.0, 155.0, 0.0, 40.0, 90.0, 55.0, 55.0, 95.0, 200.0, 235.0, 180.0, 15.0, 70.0, 215.0, 220.0, 275.0, 125.0, 360.0, 270.0, 175.0, 540.0, 0.0, 225.0, 200.0, 115.0, 105.0, 0.0, 175.0, 10.0, 100.0, 100.0, 70.0, 25.0, 205.0, 490.0, 110.0, 695.0, 20.0, 105.0, 130.0, 165.0, 95.0, 25.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9714614962788799, "mean_inference_ms": 1.640085626395422, "mean_action_processing_ms": 0.36959042208933246, "mean_env_wait_ms": 0.25956791729186074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005056977272033691, "StateBufferConnector_ms": 0.004275679588317871, "ViewRequirementAgentConnector_ms": 0.14324045181274414}, "num_episodes": 23, "episode_return_max": 640.0, "episode_return_min": -4066.0, "episode_return_mean": 148.37, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.57142338434336, "num_env_steps_trained_throughput_per_sec": 55.57142338434336, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1752000, "timers": {"training_iteration_time_ms": 72643.553, "restore_workers_time_ms": 0.014, "training_step_time_ms": 72643.493, "sample_time_ms": 1358.044, "learn_time_ms": 71266.266, "learn_throughput": 56.128, "synch_weights_time_ms": 14.543}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1752000, "num_agent_steps_trained": 1752000}, "done": false, "training_iteration": 73, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-57-13", "timestamp": 1723492633, "time_this_iter_s": 72.01327300071716, "time_total_s": 6037.219867944717, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b10783a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6037.219867944717, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 19.633333333333333, "ram_util_percent": 79.49411764705881}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6549803884316843, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7611463029333885, "policy_loss": -0.008471488462206214, "vf_loss": 1.7690709147470218, "vf_explained_var": -2.1297331397415053e-05, "kl": 0.007291210780055477, "entropy": 0.6019183877829118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 207270.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.490662295661919, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9981359846837132, "policy_loss": -0.017911291200211867, "vf_loss": 2.0151585406445442, "vf_explained_var": 0.0188002237402801, "kl": 0.008887344045207754, "entropy": 1.108533896157082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 207270.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -4066.0, "episode_reward_mean": 127.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -79.4, "predator_policy": 121.86666666666666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [281.0, 335.0, 526.0, 500.0, 311.0, 384.0, 363.0, 334.0, 182.0, 398.0, 294.0, -225.0, 552.0, 169.0, 173.0, 330.0, 444.0, 207.0, 314.0, 252.0, -599.0, 333.0, 588.0, -76.0, -78.0, 349.0, -2904.0, -1033.0, 90.0, 401.0, 372.0, -303.0, 600.0, 517.0, 504.0, 204.0, 324.0, 184.0, 600.0, 445.0, 323.0, 483.0, 564.0, 186.0, 491.0, 170.0, 419.0, 481.0, 588.0, 538.0, 342.0, 401.0, -135.0, 441.0, 551.0, 507.0, -2279.0, -134.0, -4066.0, 507.0, 317.0, 512.0, 111.0, 506.0, 379.0, 484.0, 238.0, 194.0, 532.0, 508.0, 71.0, 141.0, -144.0, 338.0, 45.0, 261.0, 125.0, 243.0, -682.0, -863.0, 472.0, 147.0, 164.0, 165.0, 152.0, 330.0, -19.0, 209.0, -324.0, 505.0, 200.0, 207.0, 364.0, -1036.0, -494.0, 462.0, -193.0, 600.0, 321.0, 172.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [24.0, 123.0, -86.0, -86.0, -31.0, 167.0, 200.0, 46.0, 200.0, -240.0, 200.0, 200.0, -9.0, -53.0, -427.0, -9.0, -42.0, 200.0, 101.0, 200.0, -53.0, 200.0, -262.0, -64.0, 79.0, 68.0, -460.0, 101.0, 90.0, 112.0, 200.0, -207.0, -119.0, -31.0, 35.0, -999.0, 200.0, 112.0, 200.0, -42.0, 46.0, 35.0, -405.0, -42.0, 200.0, 2.0, 156.0, -53.0, 200.0, 200.0, -86.0, -75.0, -20.0, -108.0, 46.0, -42.0, 200.0, 57.0, 200.0, -295.0, -702.0, -636.0, -306.0, 200.0, -372.0, 200.0, 200.0, 178.0, 200.0, -372.0, 2.0, -251.0, -141.0, -163.0, -119.0, -42.0, 101.0, -75.0, -1626.0, -746.0, -1747.0, -911.0, -383.0, -669.0, -306.0, 68.0, 13.0, 200.0, -174.0, 35.0, 145.0, 200.0, -163.0, -163.0, -108.0, -592.0, 200.0, 200.0, 200.0, 200.0, -218.0, 200.0, 200.0, 200.0, 24.0, 13.0, -152.0, -42.0, 35.0, 112.0, 2.0, -394.0, -482.0, 200.0, 200.0, 200.0, 200.0, 189.0, 156.0, -20.0, 79.0, 123.0, -119.0, 145.0, 200.0, 13.0, 200.0, 200.0, 134.0, 112.0, -108.0, -53.0, -119.0, 90.0, 200.0, -713.0, 200.0, -42.0, 134.0, 68.0, -163.0, 200.0, 200.0, -119.0, 200.0, 200.0, 178.0, 200.0, -977.0, 200.0, 68.0, -108.0, 2.0, 156.0, -64.0, 189.0, -262.0, -240.0, 112.0, 57.0, 167.0, 112.0, 200.0, -42.0, 178.0, 2.0, 178.0, 167.0, -1692.0, -317.0, -1340.0, -141.0, -64.0, -174.0, -1494.0, -1692.0, -2000.0, -108.0, 200.0, 200.0, 200.0, -97.0, -196.0, 46.0, 200.0, 156.0, 2.0, -31.0, -185.0, 200.0, 57.0, 134.0, 167.0, 13.0, 24.0, 200.0, -86.0, 200.0, 46.0, -130.0, 112.0, -141.0, 112.0, 68.0, 200.0, 200.0, 2.0, 200.0, 156.0, -53.0, -482.0, -97.0, 35.0, -207.0, 35.0, 13.0, -405.0, -141.0, -218.0, -592.0, -75.0, 200.0, 167.0, 101.0, -988.0, -207.0, 57.0, -9.0, -108.0, -108.0, 156.0, -64.0, 57.0, -20.0, 112.0, -504.0, -1010.0, -416.0, -306.0, -966.0, 90.0, -207.0, 189.0, 35.0, -64.0, -64.0, -9.0, -42.0, 90.0, 200.0, -273.0, -372.0, -163.0, 200.0, -240.0, -108.0, 13.0, 200.0, -64.0, -20.0, -185.0, -218.0, 79.0, 68.0, -218.0, -108.0, -328.0, -130.0, 200.0, 145.0, 134.0, -394.0, -185.0, -31.0, 57.0, -9.0, -31.0, 189.0, -9.0, -724.0, -680.0, -1087.0, -779.0, -438.0, 123.0, -42.0, 200.0, 79.0, -405.0, -20.0, -218.0, 200.0, 200.0, 200.0, -53.0, 200.0, -196.0, -75.0, 2.0, -75.0], "policy_predator_policy_reward": [165.0, 35.0, 20.0, 50.0, 130.0, 105.0, 40.0, 40.0, 0.0, 80.0, 200.0, 60.0, 260.0, 265.0, 275.0, 95.0, 30.0, 110.0, 115.0, 0.0, 0.0, 140.0, 145.0, 175.0, 200.0, 0.0, 295.0, 50.0, 0.0, 45.0, 90.0, 145.0, 185.0, 75.0, 245.0, 450.0, 40.0, 0.0, 0.0, 0.0, 125.0, 5.0, 275.0, 35.0, 110.0, 20.0, 90.0, 115.0, 130.0, 0.0, 0.0, 110.0, 135.0, 165.0, 110.0, 0.0, 0.0, 225.0, 65.0, 0.0, 455.0, 305.0, 285.0, 160.0, 0.0, 145.0, 0.0, 10.0, 0.0, 245.0, 255.0, 45.0, 0.0, 220.0, 125.0, 165.0, 170.0, 30.0, 140.0, 975.0, 100.0, 365.0, 565.0, 0.0, 85.0, 0.0, 230.0, 0.0, 190.0, 150.0, 165.0, 25.0, 0.0, 200.0, 360.0, 0.0, 0.0, 0.0, 0.0, 35.0, 145.0, 155.0, 0.0, 80.0, 0.0, 90.0, 170.0, 125.0, 85.0, 0.0, 90.0, 370.0, 380.0, 110.0, 0.0, 0.0, 0.0, 0.0, 70.0, 50.0, 145.0, 35.0, 60.0, 0.0, 50.0, 75.0, 30.0, 0.0, 0.0, 140.0, 80.0, 15.0, 140.0, 145.0, 35.0, 270.0, 125.0, 330.0, 90.0, 150.0, 140.0, 115.0, 10.0, 75.0, 10.0, 0.0, 0.0, 365.0, 335.0, 415.0, 110.0, 125.0, 145.0, 0.0, 0.0, 120.0, 215.0, 0.0, 40.0, 65.0, 40.0, 0.0, 90.0, 70.0, 55.0, 90.0, 25.0, 45.0, 85.0, 60.0, 925.0, 60.0, 180.0, 5.0, 55.0, 910.0, 155.0, 75.0, 130.0, 10.0, 155.0, 185.0, 70.0, 60.0, 40.0, 10.0, 25.0, 185.0, 115.0, 55.0, 60.0, 0.0, 65.0, 100.0, 10.0, 40.0, 130.0, 0.0, 20.0, 150.0, 40.0, 0.0, 0.0, 155.0, 0.0, 40.0, 90.0, 55.0, 55.0, 95.0, 200.0, 235.0, 180.0, 15.0, 70.0, 215.0, 220.0, 275.0, 125.0, 360.0, 270.0, 175.0, 540.0, 0.0, 225.0, 200.0, 115.0, 105.0, 0.0, 175.0, 10.0, 100.0, 100.0, 70.0, 25.0, 205.0, 490.0, 110.0, 695.0, 20.0, 105.0, 130.0, 165.0, 95.0, 25.0, 120.0, 5.0, 0.0, 120.0, 260.0, 165.0, 185.0, 95.0, 160.0, 100.0, 30.0, 55.0, 140.0, 200.0, 0.0, 50.0, 190.0, 90.0, 0.0, 0.0, 325.0, 5.0, 140.0, 150.0, 0.0, 250.0, 175.0, 220.0, 20.0, 70.0, 100.0, 70.0, 0.0, 145.0, 275.0, 720.0, 460.0, 155.0, 35.0, 410.0, 65.0, 110.0, 50.0, 190.0, 215.0, 45.0, 0.0, 0.0, 0.0, 130.0, 160.0, 80.0, 145.0, 80.0, 95.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9692898479627696, "mean_inference_ms": 1.6367279944358393, "mean_action_processing_ms": 0.36897987205776295, "mean_env_wait_ms": 0.2591752239420007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004368901252746582, "StateBufferConnector_ms": 0.004002690315246582, "ViewRequirementAgentConnector_ms": 0.1326812505722046}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -4066.0, "episode_return_mean": 127.4, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.55814277517083, "num_env_steps_trained_throughput_per_sec": 55.55814277517083, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 72342.005, "restore_workers_time_ms": 0.014, "training_step_time_ms": 72341.945, "sample_time_ms": 1339.205, "learn_time_ms": 70982.472, "learn_throughput": 56.352, "synch_weights_time_ms": 14.589}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 74, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-58-25", "timestamp": 1723492705, "time_this_iter_s": 72.03859090805054, "time_total_s": 6109.258458852768, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32f69c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6109.258458852768, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 22.525490196078437, "ram_util_percent": 80.53823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.279659481875017, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.088402572062844, "policy_loss": -0.006273917585292646, "vf_loss": 1.0941844165430847, "vf_explained_var": -5.447862418830817e-05, "kl": 0.0065603720662242085, "entropy": 0.6058926460802132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 210090.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8498110012276796, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4547248912777038, "policy_loss": -0.019400310191756826, "vf_loss": 1.4732629828841974, "vf_explained_var": 0.023880685918720057, "kl": 0.008622156908075298, "entropy": 1.1542041077681466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 210090.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -4066.0, "episode_reward_mean": 103.97, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -86.11, "predator_policy": 120.76666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [314.0, 252.0, -599.0, 333.0, 588.0, -76.0, -78.0, 349.0, -2904.0, -1033.0, 90.0, 401.0, 372.0, -303.0, 600.0, 517.0, 504.0, 204.0, 324.0, 184.0, 600.0, 445.0, 323.0, 483.0, 564.0, 186.0, 491.0, 170.0, 419.0, 481.0, 588.0, 538.0, 342.0, 401.0, -135.0, 441.0, 551.0, 507.0, -2279.0, -134.0, -4066.0, 507.0, 317.0, 512.0, 111.0, 506.0, 379.0, 484.0, 238.0, 194.0, 532.0, 508.0, 71.0, 141.0, -144.0, 338.0, 45.0, 261.0, 125.0, 243.0, -682.0, -863.0, 472.0, 147.0, 164.0, 165.0, 152.0, 330.0, -19.0, 209.0, -324.0, 505.0, 200.0, 207.0, 364.0, -1036.0, -494.0, 462.0, -193.0, 600.0, 321.0, 172.0, -399.0, 504.0, 143.0, 433.0, 104.0, 534.0, -1102.0, 522.0, 137.0, 416.0, 481.0, 402.0, 212.0, 314.0, 368.0, -605.0, 576.0, 175.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [46.0, -42.0, 200.0, 57.0, 200.0, -295.0, -702.0, -636.0, -306.0, 200.0, -372.0, 200.0, 200.0, 178.0, 200.0, -372.0, 2.0, -251.0, -141.0, -163.0, -119.0, -42.0, 101.0, -75.0, -1626.0, -746.0, -1747.0, -911.0, -383.0, -669.0, -306.0, 68.0, 13.0, 200.0, -174.0, 35.0, 145.0, 200.0, -163.0, -163.0, -108.0, -592.0, 200.0, 200.0, 200.0, 200.0, -218.0, 200.0, 200.0, 200.0, 24.0, 13.0, -152.0, -42.0, 35.0, 112.0, 2.0, -394.0, -482.0, 200.0, 200.0, 200.0, 200.0, 189.0, 156.0, -20.0, 79.0, 123.0, -119.0, 145.0, 200.0, 13.0, 200.0, 200.0, 134.0, 112.0, -108.0, -53.0, -119.0, 90.0, 200.0, -713.0, 200.0, -42.0, 134.0, 68.0, -163.0, 200.0, 200.0, -119.0, 200.0, 200.0, 178.0, 200.0, -977.0, 200.0, 68.0, -108.0, 2.0, 156.0, -64.0, 189.0, -262.0, -240.0, 112.0, 57.0, 167.0, 112.0, 200.0, -42.0, 178.0, 2.0, 178.0, 167.0, -1692.0, -317.0, -1340.0, -141.0, -64.0, -174.0, -1494.0, -1692.0, -2000.0, -108.0, 200.0, 200.0, 200.0, -97.0, -196.0, 46.0, 200.0, 156.0, 2.0, -31.0, -185.0, 200.0, 57.0, 134.0, 167.0, 13.0, 24.0, 200.0, -86.0, 200.0, 46.0, -130.0, 112.0, -141.0, 112.0, 68.0, 200.0, 200.0, 2.0, 200.0, 156.0, -53.0, -482.0, -97.0, 35.0, -207.0, 35.0, 13.0, -405.0, -141.0, -218.0, -592.0, -75.0, 200.0, 167.0, 101.0, -988.0, -207.0, 57.0, -9.0, -108.0, -108.0, 156.0, -64.0, 57.0, -20.0, 112.0, -504.0, -1010.0, -416.0, -306.0, -966.0, 90.0, -207.0, 189.0, 35.0, -64.0, -64.0, -9.0, -42.0, 90.0, 200.0, -273.0, -372.0, -163.0, 200.0, -240.0, -108.0, 13.0, 200.0, -64.0, -20.0, -185.0, -218.0, 79.0, 68.0, -218.0, -108.0, -328.0, -130.0, 200.0, 145.0, 134.0, -394.0, -185.0, -31.0, 57.0, -9.0, -31.0, 189.0, -9.0, -724.0, -680.0, -1087.0, -779.0, -438.0, 123.0, -42.0, 200.0, 79.0, -405.0, -20.0, -218.0, 200.0, 200.0, 200.0, -53.0, 200.0, -196.0, -75.0, 2.0, -75.0, -251.0, -383.0, -405.0, 200.0, 200.0, 24.0, -53.0, -262.0, 178.0, 200.0, 79.0, -141.0, -328.0, -306.0, 178.0, 79.0, 200.0, 200.0, -779.0, -515.0, -768.0, 178.0, 79.0, 200.0, 200.0, 2.0, -295.0, 200.0, 90.0, -449.0, 156.0, 156.0, 134.0, 101.0, 123.0, 68.0, 90.0, -185.0, 57.0, 57.0, 13.0, -31.0, 200.0, -42.0, 35.0, 123.0, -658.0, -515.0, 200.0, 156.0, 200.0, -130.0, 24.0, -9.0], "policy_predator_policy_reward": [110.0, 0.0, 0.0, 225.0, 65.0, 0.0, 455.0, 305.0, 285.0, 160.0, 0.0, 145.0, 0.0, 10.0, 0.0, 245.0, 255.0, 45.0, 0.0, 220.0, 125.0, 165.0, 170.0, 30.0, 140.0, 975.0, 100.0, 365.0, 565.0, 0.0, 85.0, 0.0, 230.0, 0.0, 190.0, 150.0, 165.0, 25.0, 0.0, 200.0, 360.0, 0.0, 0.0, 0.0, 0.0, 35.0, 145.0, 155.0, 0.0, 80.0, 0.0, 90.0, 170.0, 125.0, 85.0, 0.0, 90.0, 370.0, 380.0, 110.0, 0.0, 0.0, 0.0, 0.0, 70.0, 50.0, 145.0, 35.0, 60.0, 0.0, 50.0, 75.0, 30.0, 0.0, 0.0, 140.0, 80.0, 15.0, 140.0, 145.0, 35.0, 270.0, 125.0, 330.0, 90.0, 150.0, 140.0, 115.0, 10.0, 75.0, 10.0, 0.0, 0.0, 365.0, 335.0, 415.0, 110.0, 125.0, 145.0, 0.0, 0.0, 120.0, 215.0, 0.0, 40.0, 65.0, 40.0, 0.0, 90.0, 70.0, 55.0, 90.0, 25.0, 45.0, 85.0, 60.0, 925.0, 60.0, 180.0, 5.0, 55.0, 910.0, 155.0, 75.0, 130.0, 10.0, 155.0, 185.0, 70.0, 60.0, 40.0, 10.0, 25.0, 185.0, 115.0, 55.0, 60.0, 0.0, 65.0, 100.0, 10.0, 40.0, 130.0, 0.0, 20.0, 150.0, 40.0, 0.0, 0.0, 155.0, 0.0, 40.0, 90.0, 55.0, 55.0, 95.0, 200.0, 235.0, 180.0, 15.0, 70.0, 215.0, 220.0, 275.0, 125.0, 360.0, 270.0, 175.0, 540.0, 0.0, 225.0, 200.0, 115.0, 105.0, 0.0, 175.0, 10.0, 100.0, 100.0, 70.0, 25.0, 205.0, 490.0, 110.0, 695.0, 20.0, 105.0, 130.0, 165.0, 95.0, 25.0, 120.0, 5.0, 0.0, 120.0, 260.0, 165.0, 185.0, 95.0, 160.0, 100.0, 30.0, 55.0, 140.0, 200.0, 0.0, 50.0, 190.0, 90.0, 0.0, 0.0, 325.0, 5.0, 140.0, 150.0, 0.0, 250.0, 175.0, 220.0, 20.0, 70.0, 100.0, 70.0, 0.0, 145.0, 275.0, 720.0, 460.0, 155.0, 35.0, 410.0, 65.0, 110.0, 50.0, 190.0, 215.0, 45.0, 0.0, 0.0, 0.0, 130.0, 160.0, 80.0, 145.0, 80.0, 95.0, 275.0, 205.0, 160.0, 0.0, 80.0, 0.0, 170.0, 110.0, 0.0, 0.0, 140.0, 155.0, 320.0, 240.0, 0.0, 55.0, 0.0, 0.0, 165.0, 765.0, 30.0, 65.0, 0.0, 0.0, 230.0, 0.0, 0.0, 290.0, 240.0, 45.0, 0.0, 0.0, 35.0, 75.0, 0.0, 35.0, 75.0, 125.0, 50.0, 115.0, 70.0, 90.0, 85.0, 5.0, 85.0, 15.0, 400.0, 30.0, 20.0, 0.0, 0.0, 150.0, 60.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9673184617057313, "mean_inference_ms": 1.6333049387414578, "mean_action_processing_ms": 0.36843033798804936, "mean_env_wait_ms": 0.25874929317075024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004378318786621094, "StateBufferConnector_ms": 0.003946781158447266, "ViewRequirementAgentConnector_ms": 0.13068127632141113}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -4066.0, "episode_return_mean": 103.97, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.43641339052514, "num_env_steps_trained_throughput_per_sec": 55.43641339052514, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 72130.825, "restore_workers_time_ms": 0.014, "training_step_time_ms": 72130.774, "sample_time_ms": 1314.384, "learn_time_ms": 70796.889, "learn_throughput": 56.5, "synch_weights_time_ms": 14.407}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 75, "trial_id": "f7bd5_00000", "date": "2024-08-12_15-59-38", "timestamp": 1723492778, "time_this_iter_s": 72.19619083404541, "time_total_s": 6181.454649686813, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2328310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6181.454649686813, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 21.4578431372549, "ram_util_percent": 81.1656862745098}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4124419487114495, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7663837961694027, "policy_loss": -0.006997342766898334, "vf_loss": 1.7727081444457913, "vf_explained_var": -3.395391271469441e-05, "kl": 0.008971920517992253, "entropy": 0.6177261997621956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 212910.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.697703460429577, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.605491243144299, "policy_loss": -0.022194549470152442, "vf_loss": 2.6267398759405665, "vf_explained_var": 0.018455840044833246, "kl": 0.009459154669447474, "entropy": 1.15673261931602, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 212910.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -4315.0, "episode_reward_mean": 38.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -108.99, "predator_policy": 121.73333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [323.0, 483.0, 564.0, 186.0, 491.0, 170.0, 419.0, 481.0, 588.0, 538.0, 342.0, 401.0, -135.0, 441.0, 551.0, 507.0, -2279.0, -134.0, -4066.0, 507.0, 317.0, 512.0, 111.0, 506.0, 379.0, 484.0, 238.0, 194.0, 532.0, 508.0, 71.0, 141.0, -144.0, 338.0, 45.0, 261.0, 125.0, 243.0, -682.0, -863.0, 472.0, 147.0, 164.0, 165.0, 152.0, 330.0, -19.0, 209.0, -324.0, 505.0, 200.0, 207.0, 364.0, -1036.0, -494.0, 462.0, -193.0, 600.0, 321.0, 172.0, -399.0, 504.0, 143.0, 433.0, 104.0, 534.0, -1102.0, 522.0, 137.0, 416.0, 481.0, 402.0, 212.0, 314.0, 368.0, -605.0, 576.0, 175.0, -2530.0, 50.0, 362.0, 352.0, 427.0, -2739.0, 511.0, 457.0, 449.0, 461.0, -4315.0, -755.0, 546.0, 419.0, 523.0, 423.0, 260.0, -823.0, 408.0, 534.0, -613.0, 103.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.0, 123.0, -119.0, 145.0, 200.0, 13.0, 200.0, 200.0, 134.0, 112.0, -108.0, -53.0, -119.0, 90.0, 200.0, -713.0, 200.0, -42.0, 134.0, 68.0, -163.0, 200.0, 200.0, -119.0, 200.0, 200.0, 178.0, 200.0, -977.0, 200.0, 68.0, -108.0, 2.0, 156.0, -64.0, 189.0, -262.0, -240.0, 112.0, 57.0, 167.0, 112.0, 200.0, -42.0, 178.0, 2.0, 178.0, 167.0, -1692.0, -317.0, -1340.0, -141.0, -64.0, -174.0, -1494.0, -1692.0, -2000.0, -108.0, 200.0, 200.0, 200.0, -97.0, -196.0, 46.0, 200.0, 156.0, 2.0, -31.0, -185.0, 200.0, 57.0, 134.0, 167.0, 13.0, 24.0, 200.0, -86.0, 200.0, 46.0, -130.0, 112.0, -141.0, 112.0, 68.0, 200.0, 200.0, 2.0, 200.0, 156.0, -53.0, -482.0, -97.0, 35.0, -207.0, 35.0, 13.0, -405.0, -141.0, -218.0, -592.0, -75.0, 200.0, 167.0, 101.0, -988.0, -207.0, 57.0, -9.0, -108.0, -108.0, 156.0, -64.0, 57.0, -20.0, 112.0, -504.0, -1010.0, -416.0, -306.0, -966.0, 90.0, -207.0, 189.0, 35.0, -64.0, -64.0, -9.0, -42.0, 90.0, 200.0, -273.0, -372.0, -163.0, 200.0, -240.0, -108.0, 13.0, 200.0, -64.0, -20.0, -185.0, -218.0, 79.0, 68.0, -218.0, -108.0, -328.0, -130.0, 200.0, 145.0, 134.0, -394.0, -185.0, -31.0, 57.0, -9.0, -31.0, 189.0, -9.0, -724.0, -680.0, -1087.0, -779.0, -438.0, 123.0, -42.0, 200.0, 79.0, -405.0, -20.0, -218.0, 200.0, 200.0, 200.0, -53.0, 200.0, -196.0, -75.0, 2.0, -75.0, -251.0, -383.0, -405.0, 200.0, 200.0, 24.0, -53.0, -262.0, 178.0, 200.0, 79.0, -141.0, -328.0, -306.0, 178.0, 79.0, 200.0, 200.0, -779.0, -515.0, -768.0, 178.0, 79.0, 200.0, 200.0, 2.0, -295.0, 200.0, 90.0, -449.0, 156.0, 156.0, 134.0, 101.0, 123.0, 68.0, 90.0, -185.0, 57.0, 57.0, 13.0, -31.0, 200.0, -42.0, 35.0, 123.0, -658.0, -515.0, 200.0, 156.0, 200.0, -130.0, 24.0, -9.0, -1505.0, -1824.0, -306.0, -262.0, 200.0, -273.0, 200.0, -141.0, 68.0, -493.0, 90.0, 200.0, 200.0, -328.0, 145.0, -625.0, -1703.0, -1571.0, 145.0, 112.0, 189.0, 145.0, 200.0, 2.0, 90.0, 24.0, 200.0, 79.0, 200.0, 57.0, -1615.0, -1923.0, -1967.0, 2.0, -724.0, -823.0, 112.0, 189.0, 200.0, 2.0, 167.0, -20.0, 123.0, -75.0, 200.0, -53.0, 178.0, 123.0, -53.0, -9.0, 2.0, -823.0, -812.0, 112.0, 200.0, -119.0, 167.0, 200.0, 79.0, 200.0, -449.0, -174.0, -295.0, -240.0, 2.0, 101.0], "policy_predator_policy_reward": [145.0, 35.0, 60.0, 0.0, 50.0, 75.0, 30.0, 0.0, 0.0, 140.0, 80.0, 15.0, 140.0, 145.0, 35.0, 270.0, 125.0, 330.0, 90.0, 150.0, 140.0, 115.0, 10.0, 75.0, 10.0, 0.0, 0.0, 365.0, 335.0, 415.0, 110.0, 125.0, 145.0, 0.0, 0.0, 120.0, 215.0, 0.0, 40.0, 65.0, 40.0, 0.0, 90.0, 70.0, 55.0, 90.0, 25.0, 45.0, 85.0, 60.0, 925.0, 60.0, 180.0, 5.0, 55.0, 910.0, 155.0, 75.0, 130.0, 10.0, 155.0, 185.0, 70.0, 60.0, 40.0, 10.0, 25.0, 185.0, 115.0, 55.0, 60.0, 0.0, 65.0, 100.0, 10.0, 40.0, 130.0, 0.0, 20.0, 150.0, 40.0, 0.0, 0.0, 155.0, 0.0, 40.0, 90.0, 55.0, 55.0, 95.0, 200.0, 235.0, 180.0, 15.0, 70.0, 215.0, 220.0, 275.0, 125.0, 360.0, 270.0, 175.0, 540.0, 0.0, 225.0, 200.0, 115.0, 105.0, 0.0, 175.0, 10.0, 100.0, 100.0, 70.0, 25.0, 205.0, 490.0, 110.0, 695.0, 20.0, 105.0, 130.0, 165.0, 95.0, 25.0, 120.0, 5.0, 0.0, 120.0, 260.0, 165.0, 185.0, 95.0, 160.0, 100.0, 30.0, 55.0, 140.0, 200.0, 0.0, 50.0, 190.0, 90.0, 0.0, 0.0, 325.0, 5.0, 140.0, 150.0, 0.0, 250.0, 175.0, 220.0, 20.0, 70.0, 100.0, 70.0, 0.0, 145.0, 275.0, 720.0, 460.0, 155.0, 35.0, 410.0, 65.0, 110.0, 50.0, 190.0, 215.0, 45.0, 0.0, 0.0, 0.0, 130.0, 160.0, 80.0, 145.0, 80.0, 95.0, 275.0, 205.0, 160.0, 0.0, 80.0, 0.0, 170.0, 110.0, 0.0, 0.0, 140.0, 155.0, 320.0, 240.0, 0.0, 55.0, 0.0, 0.0, 165.0, 765.0, 30.0, 65.0, 0.0, 0.0, 230.0, 0.0, 0.0, 290.0, 240.0, 45.0, 0.0, 0.0, 35.0, 75.0, 0.0, 35.0, 75.0, 125.0, 50.0, 115.0, 70.0, 90.0, 85.0, 5.0, 85.0, 15.0, 400.0, 30.0, 20.0, 0.0, 0.0, 150.0, 60.0, 80.0, 0.0, 950.0, 155.0, 160.0, 35.0, 190.0, 60.0, 30.0, 145.0, 295.0, 260.0, 0.0, 35.0, 205.0, 170.0, 1000.0, 125.0, 35.0, 0.0, 25.0, 40.0, 0.0, 0.0, 110.0, 35.0, 80.0, 20.0, 65.0, 60.0, 0.0, 0.0, 190.0, 1000.0, 0.0, 320.0, 470.0, 10.0, 0.0, 35.0, 85.0, 100.0, 85.0, 55.0, 135.0, 85.0, 50.0, 0.0, 125.0, 90.0, 105.0, 125.0, 490.0, 5.0, 205.0, 0.0, 15.0, 145.0, 0.0, 55.0, 0.0, 0.0, 15.0, 290.0, 140.0, 100.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9653406881456263, "mean_inference_ms": 1.6291227265731378, "mean_action_processing_ms": 0.3679286295304094, "mean_env_wait_ms": 0.2581101281818314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005135178565979004, "StateBufferConnector_ms": 0.003882884979248047, "ViewRequirementAgentConnector_ms": 0.12782657146453857}, "num_episodes": 22, "episode_return_max": 600.0, "episode_return_min": -4315.0, "episode_return_mean": 38.23, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.14898786318288, "num_env_steps_trained_throughput_per_sec": 56.14898786318288, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 71965.53, "restore_workers_time_ms": 0.013, "training_step_time_ms": 71965.479, "sample_time_ms": 1301.261, "learn_time_ms": 70644.282, "learn_throughput": 56.622, "synch_weights_time_ms": 14.3}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 76, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-00-49", "timestamp": 1723492849, "time_this_iter_s": 71.30169296264648, "time_total_s": 6252.75634264946, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32f69cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6252.75634264946, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 18.78910891089109, "ram_util_percent": 80.82277227722773}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4931851984761286, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.533362742074838, "policy_loss": -0.006332777084944545, "vf_loss": 1.5391179962995205, "vf_explained_var": -2.9594741814525414e-05, "kl": 0.007699075076731129, "entropy": 0.6579209639671001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 215730.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.039448952611457, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8952047008677577, "policy_loss": -0.022568235822527254, "vf_loss": 1.9166704788487008, "vf_explained_var": 0.025821074674315485, "kl": 0.011024555569223375, "entropy": 1.1120712974392777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 215730.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -4315.0, "episode_reward_mean": 22.2, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -116.8, "predator_policy": 124.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-4066.0, 507.0, 317.0, 512.0, 111.0, 506.0, 379.0, 484.0, 238.0, 194.0, 532.0, 508.0, 71.0, 141.0, -144.0, 338.0, 45.0, 261.0, 125.0, 243.0, -682.0, -863.0, 472.0, 147.0, 164.0, 165.0, 152.0, 330.0, -19.0, 209.0, -324.0, 505.0, 200.0, 207.0, 364.0, -1036.0, -494.0, 462.0, -193.0, 600.0, 321.0, 172.0, -399.0, 504.0, 143.0, 433.0, 104.0, 534.0, -1102.0, 522.0, 137.0, 416.0, 481.0, 402.0, 212.0, 314.0, 368.0, -605.0, 576.0, 175.0, -2530.0, 50.0, 362.0, 352.0, 427.0, -2739.0, 511.0, 457.0, 449.0, 461.0, -4315.0, -755.0, 546.0, 419.0, 523.0, 423.0, 260.0, -823.0, 408.0, 534.0, -613.0, 103.0, 450.0, 571.0, 177.0, 431.0, -788.0, 268.0, 246.0, -693.0, 395.0, 289.0, -1407.0, 390.0, 72.0, 395.0, 600.0, 365.0, 154.0, 419.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1494.0, -1692.0, -2000.0, -108.0, 200.0, 200.0, 200.0, -97.0, -196.0, 46.0, 200.0, 156.0, 2.0, -31.0, -185.0, 200.0, 57.0, 134.0, 167.0, 13.0, 24.0, 200.0, -86.0, 200.0, 46.0, -130.0, 112.0, -141.0, 112.0, 68.0, 200.0, 200.0, 2.0, 200.0, 156.0, -53.0, -482.0, -97.0, 35.0, -207.0, 35.0, 13.0, -405.0, -141.0, -218.0, -592.0, -75.0, 200.0, 167.0, 101.0, -988.0, -207.0, 57.0, -9.0, -108.0, -108.0, 156.0, -64.0, 57.0, -20.0, 112.0, -504.0, -1010.0, -416.0, -306.0, -966.0, 90.0, -207.0, 189.0, 35.0, -64.0, -64.0, -9.0, -42.0, 90.0, 200.0, -273.0, -372.0, -163.0, 200.0, -240.0, -108.0, 13.0, 200.0, -64.0, -20.0, -185.0, -218.0, 79.0, 68.0, -218.0, -108.0, -328.0, -130.0, 200.0, 145.0, 134.0, -394.0, -185.0, -31.0, 57.0, -9.0, -31.0, 189.0, -9.0, -724.0, -680.0, -1087.0, -779.0, -438.0, 123.0, -42.0, 200.0, 79.0, -405.0, -20.0, -218.0, 200.0, 200.0, 200.0, -53.0, 200.0, -196.0, -75.0, 2.0, -75.0, -251.0, -383.0, -405.0, 200.0, 200.0, 24.0, -53.0, -262.0, 178.0, 200.0, 79.0, -141.0, -328.0, -306.0, 178.0, 79.0, 200.0, 200.0, -779.0, -515.0, -768.0, 178.0, 79.0, 200.0, 200.0, 2.0, -295.0, 200.0, 90.0, -449.0, 156.0, 156.0, 134.0, 101.0, 123.0, 68.0, 90.0, -185.0, 57.0, 57.0, 13.0, -31.0, 200.0, -42.0, 35.0, 123.0, -658.0, -515.0, 200.0, 156.0, 200.0, -130.0, 24.0, -9.0, -1505.0, -1824.0, -306.0, -262.0, 200.0, -273.0, 200.0, -141.0, 68.0, -493.0, 90.0, 200.0, 200.0, -328.0, 145.0, -625.0, -1703.0, -1571.0, 145.0, 112.0, 189.0, 145.0, 200.0, 2.0, 90.0, 24.0, 200.0, 79.0, 200.0, 57.0, -1615.0, -1923.0, -1967.0, 2.0, -724.0, -823.0, 112.0, 189.0, 200.0, 2.0, 167.0, -20.0, 123.0, -75.0, 200.0, -53.0, 178.0, 123.0, -53.0, -9.0, 2.0, -823.0, -812.0, 112.0, 200.0, -119.0, 167.0, 200.0, 79.0, 200.0, -449.0, -174.0, -295.0, -240.0, 2.0, 101.0, -42.0, 123.0, 134.0, 200.0, 189.0, 167.0, -361.0, 24.0, 134.0, 57.0, 200.0, -86.0, -262.0, -262.0, -1054.0, 178.0, -108.0, -97.0, -361.0, 200.0, 112.0, -614.0, -603.0, -361.0, -31.0, -504.0, 200.0, -416.0, -53.0, 178.0, -1208.0, -328.0, -691.0, 167.0, 35.0, 13.0, -493.0, 79.0, 46.0, 68.0, 145.0, 2.0, 200.0, 200.0, 200.0, -20.0, 189.0, -64.0, 90.0, -86.0, -75.0, 101.0, 145.0, 68.0], "policy_predator_policy_reward": [55.0, 910.0, 155.0, 75.0, 130.0, 10.0, 155.0, 185.0, 70.0, 60.0, 40.0, 10.0, 25.0, 185.0, 115.0, 55.0, 60.0, 0.0, 65.0, 100.0, 10.0, 40.0, 130.0, 0.0, 20.0, 150.0, 40.0, 0.0, 0.0, 155.0, 0.0, 40.0, 90.0, 55.0, 55.0, 95.0, 200.0, 235.0, 180.0, 15.0, 70.0, 215.0, 220.0, 275.0, 125.0, 360.0, 270.0, 175.0, 540.0, 0.0, 225.0, 200.0, 115.0, 105.0, 0.0, 175.0, 10.0, 100.0, 100.0, 70.0, 25.0, 205.0, 490.0, 110.0, 695.0, 20.0, 105.0, 130.0, 165.0, 95.0, 25.0, 120.0, 5.0, 0.0, 120.0, 260.0, 165.0, 185.0, 95.0, 160.0, 100.0, 30.0, 55.0, 140.0, 200.0, 0.0, 50.0, 190.0, 90.0, 0.0, 0.0, 325.0, 5.0, 140.0, 150.0, 0.0, 250.0, 175.0, 220.0, 20.0, 70.0, 100.0, 70.0, 0.0, 145.0, 275.0, 720.0, 460.0, 155.0, 35.0, 410.0, 65.0, 110.0, 50.0, 190.0, 215.0, 45.0, 0.0, 0.0, 0.0, 130.0, 160.0, 80.0, 145.0, 80.0, 95.0, 275.0, 205.0, 160.0, 0.0, 80.0, 0.0, 170.0, 110.0, 0.0, 0.0, 140.0, 155.0, 320.0, 240.0, 0.0, 55.0, 0.0, 0.0, 165.0, 765.0, 30.0, 65.0, 0.0, 0.0, 230.0, 0.0, 0.0, 290.0, 240.0, 45.0, 0.0, 0.0, 35.0, 75.0, 0.0, 35.0, 75.0, 125.0, 50.0, 115.0, 70.0, 90.0, 85.0, 5.0, 85.0, 15.0, 400.0, 30.0, 20.0, 0.0, 0.0, 150.0, 60.0, 80.0, 0.0, 950.0, 155.0, 160.0, 35.0, 190.0, 60.0, 30.0, 145.0, 295.0, 260.0, 0.0, 35.0, 205.0, 170.0, 1000.0, 125.0, 35.0, 0.0, 25.0, 40.0, 0.0, 0.0, 110.0, 35.0, 80.0, 20.0, 65.0, 60.0, 0.0, 0.0, 190.0, 1000.0, 0.0, 320.0, 470.0, 10.0, 0.0, 35.0, 85.0, 100.0, 85.0, 55.0, 135.0, 85.0, 50.0, 0.0, 125.0, 90.0, 105.0, 125.0, 490.0, 5.0, 205.0, 0.0, 15.0, 145.0, 0.0, 55.0, 0.0, 0.0, 15.0, 290.0, 140.0, 100.0, 0.0, 40.0, 90.0, 105.0, 0.0, 15.0, 0.0, 100.0, 25.0, 255.0, 105.0, 75.0, 80.0, 765.0, 5.0, 20.0, 70.0, 60.0, 165.0, 250.0, 5.0, 40.0, 580.0, 105.0, 200.0, 185.0, 255.0, 290.0, 245.0, 240.0, 95.0, 0.0, 810.0, 10.0, 0.0, 175.0, 0.0, 45.0, 80.0, 315.0, 30.0, 60.0, 90.0, 0.0, 0.0, 0.0, 25.0, 55.0, 180.0, 130.0, 45.0, 50.0, 60.0, 0.0, 45.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9631564328440001, "mean_inference_ms": 1.6256925080312599, "mean_action_processing_ms": 0.36717481392956697, "mean_env_wait_ms": 0.2577196920192913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005487799644470215, "StateBufferConnector_ms": 0.00377500057220459, "ViewRequirementAgentConnector_ms": 0.12330079078674316}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -4315.0, "episode_return_mean": 22.2, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.58102638103858, "num_env_steps_trained_throughput_per_sec": 56.58102638103858, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1848000, "timers": {"training_iteration_time_ms": 71738.192, "restore_workers_time_ms": 0.013, "training_step_time_ms": 71738.142, "sample_time_ms": 1284.547, "learn_time_ms": 70433.401, "learn_throughput": 56.791, "synch_weights_time_ms": 14.628}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1848000, "num_agent_steps_trained": 1848000}, "done": false, "training_iteration": 77, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-02-00", "timestamp": 1723492920, "time_this_iter_s": 70.72493100166321, "time_total_s": 6323.481273651123, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2328ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6323.481273651123, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 18.705000000000002, "ram_util_percent": 80.87400000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8005326160091035, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5075639031034833, "policy_loss": -0.008004749202621928, "vf_loss": 2.5150156075227343, "vf_explained_var": -1.154417264546063e-05, "kl": 0.007372334278282887, "entropy": 0.6275109308091461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 218550.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.310882782471095, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4397860995421174, "policy_loss": -0.020552677661923573, "vf_loss": 2.4593987187172504, "vf_explained_var": 0.019956460679676515, "kl": 0.009400578259809373, "entropy": 1.107956370098371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 218550.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": 605.0, "episode_reward_min": -4315.0, "episode_reward_mean": 24.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -123.87666666666667, "predator_policy": 131.91666666666666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [147.0, 164.0, 165.0, 152.0, 330.0, -19.0, 209.0, -324.0, 505.0, 200.0, 207.0, 364.0, -1036.0, -494.0, 462.0, -193.0, 600.0, 321.0, 172.0, -399.0, 504.0, 143.0, 433.0, 104.0, 534.0, -1102.0, 522.0, 137.0, 416.0, 481.0, 402.0, 212.0, 314.0, 368.0, -605.0, 576.0, 175.0, -2530.0, 50.0, 362.0, 352.0, 427.0, -2739.0, 511.0, 457.0, 449.0, 461.0, -4315.0, -755.0, 546.0, 419.0, 523.0, 423.0, 260.0, -823.0, 408.0, 534.0, -613.0, 103.0, 450.0, 571.0, 177.0, 431.0, -788.0, 268.0, 246.0, -693.0, 395.0, 289.0, -1407.0, 390.0, 72.0, 395.0, 600.0, 365.0, 154.0, 419.0, 416.0, -221.0, -1437.0, 325.0, 605.0, -357.0, -1784.0, 576.0, -108.0, 336.0, 462.0, 279.0, 534.0, 343.0, 484.0, -832.0, 3.0, 140.0, 206.0, -499.0, 437.0, 528.0, -15.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [35.0, -64.0, -64.0, -9.0, -42.0, 90.0, 200.0, -273.0, -372.0, -163.0, 200.0, -240.0, -108.0, 13.0, 200.0, -64.0, -20.0, -185.0, -218.0, 79.0, 68.0, -218.0, -108.0, -328.0, -130.0, 200.0, 145.0, 134.0, -394.0, -185.0, -31.0, 57.0, -9.0, -31.0, 189.0, -9.0, -724.0, -680.0, -1087.0, -779.0, -438.0, 123.0, -42.0, 200.0, 79.0, -405.0, -20.0, -218.0, 200.0, 200.0, 200.0, -53.0, 200.0, -196.0, -75.0, 2.0, -75.0, -251.0, -383.0, -405.0, 200.0, 200.0, 24.0, -53.0, -262.0, 178.0, 200.0, 79.0, -141.0, -328.0, -306.0, 178.0, 79.0, 200.0, 200.0, -779.0, -515.0, -768.0, 178.0, 79.0, 200.0, 200.0, 2.0, -295.0, 200.0, 90.0, -449.0, 156.0, 156.0, 134.0, 101.0, 123.0, 68.0, 90.0, -185.0, 57.0, 57.0, 13.0, -31.0, 200.0, -42.0, 35.0, 123.0, -658.0, -515.0, 200.0, 156.0, 200.0, -130.0, 24.0, -9.0, -1505.0, -1824.0, -306.0, -262.0, 200.0, -273.0, 200.0, -141.0, 68.0, -493.0, 90.0, 200.0, 200.0, -328.0, 145.0, -625.0, -1703.0, -1571.0, 145.0, 112.0, 189.0, 145.0, 200.0, 2.0, 90.0, 24.0, 200.0, 79.0, 200.0, 57.0, -1615.0, -1923.0, -1967.0, 2.0, -724.0, -823.0, 112.0, 189.0, 200.0, 2.0, 167.0, -20.0, 123.0, -75.0, 200.0, -53.0, 178.0, 123.0, -53.0, -9.0, 2.0, -823.0, -812.0, 112.0, 200.0, -119.0, 167.0, 200.0, 79.0, 200.0, -449.0, -174.0, -295.0, -240.0, 2.0, 101.0, -42.0, 123.0, 134.0, 200.0, 189.0, 167.0, -361.0, 24.0, 134.0, 57.0, 200.0, -86.0, -262.0, -262.0, -1054.0, 178.0, -108.0, -97.0, -361.0, 200.0, 112.0, -614.0, -603.0, -361.0, -31.0, -504.0, 200.0, -416.0, -53.0, 178.0, -1208.0, -328.0, -691.0, 167.0, 35.0, 13.0, -493.0, 79.0, 46.0, 68.0, 145.0, 2.0, 200.0, 200.0, 200.0, -20.0, 189.0, -64.0, 90.0, -86.0, -75.0, 101.0, 145.0, 68.0, 134.0, -328.0, 90.0, -273.0, -350.0, -163.0, -911.0, -1208.0, -53.0, -31.0, 200.0, -944.0, -75.0, 200.0, 200.0, 123.0, -548.0, -427.0, -1318.0, -537.0, -669.0, 156.0, 200.0, 200.0, -636.0, 200.0, -152.0, 79.0, -273.0, 200.0, 200.0, 79.0, -207.0, -306.0, 90.0, 200.0, 145.0, 200.0, 134.0, 79.0, -284.0, 13.0, 90.0, -284.0, 123.0, -1153.0, -163.0, -691.0, 112.0, -207.0, -482.0, -251.0, -119.0, 200.0, -625.0, 200.0, 46.0, -966.0, -207.0, 24.0, 156.0, -64.0, 200.0, -141.0, 79.0, 200.0, 112.0, -251.0, -526.0], "policy_predator_policy_reward": [95.0, 25.0, 120.0, 5.0, 0.0, 120.0, 260.0, 165.0, 185.0, 95.0, 160.0, 100.0, 30.0, 55.0, 140.0, 200.0, 0.0, 50.0, 190.0, 90.0, 0.0, 0.0, 325.0, 5.0, 140.0, 150.0, 0.0, 250.0, 175.0, 220.0, 20.0, 70.0, 100.0, 70.0, 0.0, 145.0, 275.0, 720.0, 460.0, 155.0, 35.0, 410.0, 65.0, 110.0, 50.0, 190.0, 215.0, 45.0, 0.0, 0.0, 0.0, 130.0, 160.0, 80.0, 145.0, 80.0, 95.0, 275.0, 205.0, 160.0, 0.0, 80.0, 0.0, 170.0, 110.0, 0.0, 0.0, 140.0, 155.0, 320.0, 240.0, 0.0, 55.0, 0.0, 0.0, 165.0, 765.0, 30.0, 65.0, 0.0, 0.0, 230.0, 0.0, 0.0, 290.0, 240.0, 45.0, 0.0, 0.0, 35.0, 75.0, 0.0, 35.0, 75.0, 125.0, 50.0, 115.0, 70.0, 90.0, 85.0, 5.0, 85.0, 15.0, 400.0, 30.0, 20.0, 0.0, 0.0, 150.0, 60.0, 80.0, 0.0, 950.0, 155.0, 160.0, 35.0, 190.0, 60.0, 30.0, 145.0, 295.0, 260.0, 0.0, 35.0, 205.0, 170.0, 1000.0, 125.0, 35.0, 0.0, 25.0, 40.0, 0.0, 0.0, 110.0, 35.0, 80.0, 20.0, 65.0, 60.0, 0.0, 0.0, 190.0, 1000.0, 0.0, 320.0, 470.0, 10.0, 0.0, 35.0, 85.0, 100.0, 85.0, 55.0, 135.0, 85.0, 50.0, 0.0, 125.0, 90.0, 105.0, 125.0, 490.0, 5.0, 205.0, 0.0, 15.0, 145.0, 0.0, 55.0, 0.0, 0.0, 15.0, 290.0, 140.0, 100.0, 0.0, 40.0, 90.0, 105.0, 0.0, 15.0, 0.0, 100.0, 25.0, 255.0, 105.0, 75.0, 80.0, 765.0, 5.0, 20.0, 70.0, 60.0, 165.0, 250.0, 5.0, 40.0, 580.0, 105.0, 200.0, 185.0, 255.0, 290.0, 245.0, 240.0, 95.0, 0.0, 810.0, 10.0, 0.0, 175.0, 0.0, 45.0, 80.0, 315.0, 30.0, 60.0, 90.0, 0.0, 0.0, 0.0, 25.0, 55.0, 180.0, 130.0, 45.0, 50.0, 60.0, 0.0, 45.0, 135.0, 190.0, 195.0, 190.0, 120.0, 255.0, 0.0, 735.0, 0.0, 240.0, 470.0, 390.0, 90.0, 105.0, 85.0, 350.0, 35.0, 110.0, 0.0, 0.0, 740.0, 20.0, 0.0, 0.0, 195.0, 0.0, 285.0, 55.0, 190.0, 85.0, 170.0, 90.0, 130.0, 125.0, 50.0, 120.0, 30.0, 25.0, 0.0, 185.0, 185.0, 165.0, 185.0, 150.0, 220.0, 480.0, 305.0, 390.0, 310.0, 185.0, 85.0, 205.0, 70.0, 35.0, 180.0, 45.0, 360.0, 125.0, 495.0, 30.0, 105.0, 20.0, 20.0, 140.0, 100.0, 150.0, 205.0, 205.0, 240.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9608476387935134, "mean_inference_ms": 1.6214369089060268, "mean_action_processing_ms": 0.36643844625209576, "mean_env_wait_ms": 0.2571208061072073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008260846138000488, "StateBufferConnector_ms": 0.003975391387939453, "ViewRequirementAgentConnector_ms": 0.12910211086273193}, "num_episodes": 23, "episode_return_max": 605.0, "episode_return_min": -4315.0, "episode_return_mean": 24.12, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.13495009544391, "num_env_steps_trained_throughput_per_sec": 56.13495009544391, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 71763.861, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71763.811, "sample_time_ms": 1294.366, "learn_time_ms": 70450.858, "learn_throughput": 56.777, "synch_weights_time_ms": 13.958}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 78, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-03-11", "timestamp": 1723492991, "time_this_iter_s": 71.28612995147705, "time_total_s": 6394.7674036026, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1078c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6394.7674036026, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 19.313, "ram_util_percent": 81.34899999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3985502267243168, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4567627680005757, "policy_loss": -0.006414456517478543, "vf_loss": 1.4625999232133229, "vf_explained_var": -5.2651128870375615e-05, "kl": 0.007696209168086971, "entropy": 0.6738136284106166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 221370.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.237387423766843, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6761180011304557, "policy_loss": -0.017401547818807952, "vf_loss": 1.692728348953504, "vf_explained_var": 0.024206069450006418, "kl": 0.00791204646533383, "entropy": 1.0256810627507826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 221370.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "env_runners": {"episode_reward_max": 605.0, "episode_reward_min": -4626.0, "episode_reward_mean": -8.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -134.69333333333333, "predator_policy": 131.88333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.0, -399.0, 504.0, 143.0, 433.0, 104.0, 534.0, -1102.0, 522.0, 137.0, 416.0, 481.0, 402.0, 212.0, 314.0, 368.0, -605.0, 576.0, 175.0, -2530.0, 50.0, 362.0, 352.0, 427.0, -2739.0, 511.0, 457.0, 449.0, 461.0, -4315.0, -755.0, 546.0, 419.0, 523.0, 423.0, 260.0, -823.0, 408.0, 534.0, -613.0, 103.0, 450.0, 571.0, 177.0, 431.0, -788.0, 268.0, 246.0, -693.0, 395.0, 289.0, -1407.0, 390.0, 72.0, 395.0, 600.0, 365.0, 154.0, 419.0, 416.0, -221.0, -1437.0, 325.0, 605.0, -357.0, -1784.0, 576.0, -108.0, 336.0, 462.0, 279.0, 534.0, 343.0, 484.0, -832.0, 3.0, 140.0, 206.0, -499.0, 437.0, 528.0, -15.0, 215.0, 478.0, 439.0, 405.0, 28.0, 441.0, 20.0, 436.0, 160.0, -636.0, -534.0, 342.0, -4626.0, 318.0, -52.0, 426.0, 297.0, 348.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-75.0, 2.0, -75.0, -251.0, -383.0, -405.0, 200.0, 200.0, 24.0, -53.0, -262.0, 178.0, 200.0, 79.0, -141.0, -328.0, -306.0, 178.0, 79.0, 200.0, 200.0, -779.0, -515.0, -768.0, 178.0, 79.0, 200.0, 200.0, 2.0, -295.0, 200.0, 90.0, -449.0, 156.0, 156.0, 134.0, 101.0, 123.0, 68.0, 90.0, -185.0, 57.0, 57.0, 13.0, -31.0, 200.0, -42.0, 35.0, 123.0, -658.0, -515.0, 200.0, 156.0, 200.0, -130.0, 24.0, -9.0, -1505.0, -1824.0, -306.0, -262.0, 200.0, -273.0, 200.0, -141.0, 68.0, -493.0, 90.0, 200.0, 200.0, -328.0, 145.0, -625.0, -1703.0, -1571.0, 145.0, 112.0, 189.0, 145.0, 200.0, 2.0, 90.0, 24.0, 200.0, 79.0, 200.0, 57.0, -1615.0, -1923.0, -1967.0, 2.0, -724.0, -823.0, 112.0, 189.0, 200.0, 2.0, 167.0, -20.0, 123.0, -75.0, 200.0, -53.0, 178.0, 123.0, -53.0, -9.0, 2.0, -823.0, -812.0, 112.0, 200.0, -119.0, 167.0, 200.0, 79.0, 200.0, -449.0, -174.0, -295.0, -240.0, 2.0, 101.0, -42.0, 123.0, 134.0, 200.0, 189.0, 167.0, -361.0, 24.0, 134.0, 57.0, 200.0, -86.0, -262.0, -262.0, -1054.0, 178.0, -108.0, -97.0, -361.0, 200.0, 112.0, -614.0, -603.0, -361.0, -31.0, -504.0, 200.0, -416.0, -53.0, 178.0, -1208.0, -328.0, -691.0, 167.0, 35.0, 13.0, -493.0, 79.0, 46.0, 68.0, 145.0, 2.0, 200.0, 200.0, 200.0, -20.0, 189.0, -64.0, 90.0, -86.0, -75.0, 101.0, 145.0, 68.0, 134.0, -328.0, 90.0, -273.0, -350.0, -163.0, -911.0, -1208.0, -53.0, -31.0, 200.0, -944.0, -75.0, 200.0, 200.0, 123.0, -548.0, -427.0, -1318.0, -537.0, -669.0, 156.0, 200.0, 200.0, -636.0, 200.0, -152.0, 79.0, -273.0, 200.0, 200.0, 79.0, -207.0, -306.0, 90.0, 200.0, 145.0, 200.0, 134.0, 79.0, -284.0, 13.0, 90.0, -284.0, 123.0, -1153.0, -163.0, -691.0, 112.0, -207.0, -482.0, -251.0, -119.0, 200.0, -625.0, 200.0, 46.0, -966.0, -207.0, 24.0, 156.0, -64.0, 200.0, -141.0, 79.0, 200.0, 112.0, -251.0, -526.0, 200.0, -493.0, 178.0, 79.0, 134.0, 200.0, 156.0, -647.0, 200.0, 178.0, -152.0, 79.0, 200.0, -581.0, -306.0, 200.0, 90.0, 101.0, -372.0, -9.0, 46.0, 145.0, -64.0, 200.0, 101.0, -735.0, 79.0, -812.0, -669.0, 145.0, -482.0, -460.0, -372.0, 68.0, -31.0, 200.0, -1879.0, -1824.0, -1923.0, -20.0, -42.0, 200.0, 200.0, -350.0, -152.0, -119.0, 200.0, 200.0, -20.0, 134.0, 13.0, 13.0, 200.0, 35.0], "policy_predator_policy_reward": [145.0, 80.0, 95.0, 275.0, 205.0, 160.0, 0.0, 80.0, 0.0, 170.0, 110.0, 0.0, 0.0, 140.0, 155.0, 320.0, 240.0, 0.0, 55.0, 0.0, 0.0, 165.0, 765.0, 30.0, 65.0, 0.0, 0.0, 230.0, 0.0, 0.0, 290.0, 240.0, 45.0, 0.0, 0.0, 35.0, 75.0, 0.0, 35.0, 75.0, 125.0, 50.0, 115.0, 70.0, 90.0, 85.0, 5.0, 85.0, 15.0, 400.0, 30.0, 20.0, 0.0, 0.0, 150.0, 60.0, 80.0, 0.0, 950.0, 155.0, 160.0, 35.0, 190.0, 60.0, 30.0, 145.0, 295.0, 260.0, 0.0, 35.0, 205.0, 170.0, 1000.0, 125.0, 35.0, 0.0, 25.0, 40.0, 0.0, 0.0, 110.0, 35.0, 80.0, 20.0, 65.0, 60.0, 0.0, 0.0, 190.0, 1000.0, 0.0, 320.0, 470.0, 10.0, 0.0, 35.0, 85.0, 100.0, 85.0, 55.0, 135.0, 85.0, 50.0, 0.0, 125.0, 90.0, 105.0, 125.0, 490.0, 5.0, 205.0, 0.0, 15.0, 145.0, 0.0, 55.0, 0.0, 0.0, 15.0, 290.0, 140.0, 100.0, 0.0, 40.0, 90.0, 105.0, 0.0, 15.0, 0.0, 100.0, 25.0, 255.0, 105.0, 75.0, 80.0, 765.0, 5.0, 20.0, 70.0, 60.0, 165.0, 250.0, 5.0, 40.0, 580.0, 105.0, 200.0, 185.0, 255.0, 290.0, 245.0, 240.0, 95.0, 0.0, 810.0, 10.0, 0.0, 175.0, 0.0, 45.0, 80.0, 315.0, 30.0, 60.0, 90.0, 0.0, 0.0, 0.0, 25.0, 55.0, 180.0, 130.0, 45.0, 50.0, 60.0, 0.0, 45.0, 135.0, 190.0, 195.0, 190.0, 120.0, 255.0, 0.0, 735.0, 0.0, 240.0, 470.0, 390.0, 90.0, 105.0, 85.0, 350.0, 35.0, 110.0, 0.0, 0.0, 740.0, 20.0, 0.0, 0.0, 195.0, 0.0, 285.0, 55.0, 190.0, 85.0, 170.0, 90.0, 130.0, 125.0, 50.0, 120.0, 30.0, 25.0, 0.0, 185.0, 185.0, 165.0, 185.0, 150.0, 220.0, 480.0, 305.0, 390.0, 310.0, 185.0, 85.0, 205.0, 70.0, 35.0, 180.0, 45.0, 360.0, 125.0, 495.0, 30.0, 105.0, 20.0, 20.0, 140.0, 100.0, 150.0, 205.0, 205.0, 240.0, 0.0, 15.0, 315.0, 10.0, 0.0, 55.0, 240.0, 205.0, 285.0, 140.0, 0.0, 160.0, 335.0, 160.0, 220.0, 0.0, 0.0, 50.0, 260.0, 50.0, 45.0, 90.0, 40.0, 25.0, 260.0, 400.0, 55.0, 70.0, 540.0, 90.0, 295.0, 245.0, 240.0, 105.0, 0.0, 0.0, 0.0, 0.0, 1000.0, 55.0, 0.0, 125.0, 60.0, 190.0, 0.0, 0.0, 145.0, 0.0, 50.0, 120.0, 0.0, 100.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.959148415258284, "mean_inference_ms": 1.6184026608280555, "mean_action_processing_ms": 0.3659137307310301, "mean_env_wait_ms": 0.2566940790495146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009150385856628418, "StateBufferConnector_ms": 0.00420832633972168, "ViewRequirementAgentConnector_ms": 0.13698303699493408}, "num_episodes": 18, "episode_return_max": 605.0, "episode_return_min": -4626.0, "episode_return_mean": -8.43, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.34993429486207, "num_env_steps_trained_throughput_per_sec": 55.34993429486207, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1896000, "timers": {"training_iteration_time_ms": 71867.347, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71867.297, "sample_time_ms": 1314.086, "learn_time_ms": 70534.298, "learn_throughput": 56.71, "synch_weights_time_ms": 14.037}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1896000, "num_agent_steps_trained": 1896000}, "done": false, "training_iteration": 79, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-04-23", "timestamp": 1723493063, "time_this_iter_s": 72.28970122337341, "time_total_s": 6467.0571048259735, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2328430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6467.0571048259735, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 19.695145631067962, "ram_util_percent": 81.40776699029125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5090459510895378, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4658368784485134, "policy_loss": -0.006405443900243333, "vf_loss": 1.4717144123522947, "vf_explained_var": -1.1883306165113517e-06, "kl": 0.00703770758989116, "entropy": 0.5923820232140257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 224190.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3573199978322847, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.13990621405079, "policy_loss": -0.022391553279854596, "vf_loss": 1.1615648624956185, "vf_explained_var": 0.033567731938463574, "kl": 0.007329044199658382, "entropy": 0.991392598443843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 224190.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 656.0, "episode_reward_min": -4626.0, "episode_reward_mean": 29.22, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -123.32666666666667, "predator_policy": 133.06666666666666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [352.0, 427.0, -2739.0, 511.0, 457.0, 449.0, 461.0, -4315.0, -755.0, 546.0, 419.0, 523.0, 423.0, 260.0, -823.0, 408.0, 534.0, -613.0, 103.0, 450.0, 571.0, 177.0, 431.0, -788.0, 268.0, 246.0, -693.0, 395.0, 289.0, -1407.0, 390.0, 72.0, 395.0, 600.0, 365.0, 154.0, 419.0, 416.0, -221.0, -1437.0, 325.0, 605.0, -357.0, -1784.0, 576.0, -108.0, 336.0, 462.0, 279.0, 534.0, 343.0, 484.0, -832.0, 3.0, 140.0, 206.0, -499.0, 437.0, 528.0, -15.0, 215.0, 478.0, 439.0, 405.0, 28.0, 441.0, 20.0, 436.0, 160.0, -636.0, -534.0, 342.0, -4626.0, 318.0, -52.0, 426.0, 297.0, 348.0, 555.0, -245.0, 517.0, -141.0, 196.0, 449.0, 374.0, 656.0, 600.0, 378.0, -617.0, -135.0, -58.0, 527.0, 594.0, 302.0, -15.0, -263.0, 540.0, 600.0, 229.0, -9.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-493.0, 90.0, 200.0, 200.0, -328.0, 145.0, -625.0, -1703.0, -1571.0, 145.0, 112.0, 189.0, 145.0, 200.0, 2.0, 90.0, 24.0, 200.0, 79.0, 200.0, 57.0, -1615.0, -1923.0, -1967.0, 2.0, -724.0, -823.0, 112.0, 189.0, 200.0, 2.0, 167.0, -20.0, 123.0, -75.0, 200.0, -53.0, 178.0, 123.0, -53.0, -9.0, 2.0, -823.0, -812.0, 112.0, 200.0, -119.0, 167.0, 200.0, 79.0, 200.0, -449.0, -174.0, -295.0, -240.0, 2.0, 101.0, -42.0, 123.0, 134.0, 200.0, 189.0, 167.0, -361.0, 24.0, 134.0, 57.0, 200.0, -86.0, -262.0, -262.0, -1054.0, 178.0, -108.0, -97.0, -361.0, 200.0, 112.0, -614.0, -603.0, -361.0, -31.0, -504.0, 200.0, -416.0, -53.0, 178.0, -1208.0, -328.0, -691.0, 167.0, 35.0, 13.0, -493.0, 79.0, 46.0, 68.0, 145.0, 2.0, 200.0, 200.0, 200.0, -20.0, 189.0, -64.0, 90.0, -86.0, -75.0, 101.0, 145.0, 68.0, 134.0, -328.0, 90.0, -273.0, -350.0, -163.0, -911.0, -1208.0, -53.0, -31.0, 200.0, -944.0, -75.0, 200.0, 200.0, 123.0, -548.0, -427.0, -1318.0, -537.0, -669.0, 156.0, 200.0, 200.0, -636.0, 200.0, -152.0, 79.0, -273.0, 200.0, 200.0, 79.0, -207.0, -306.0, 90.0, 200.0, 145.0, 200.0, 134.0, 79.0, -284.0, 13.0, 90.0, -284.0, 123.0, -1153.0, -163.0, -691.0, 112.0, -207.0, -482.0, -251.0, -119.0, 200.0, -625.0, 200.0, 46.0, -966.0, -207.0, 24.0, 156.0, -64.0, 200.0, -141.0, 79.0, 200.0, 112.0, -251.0, -526.0, 200.0, -493.0, 178.0, 79.0, 134.0, 200.0, 156.0, -647.0, 200.0, 178.0, -152.0, 79.0, 200.0, -581.0, -306.0, 200.0, 90.0, 101.0, -372.0, -9.0, 46.0, 145.0, -64.0, 200.0, 101.0, -735.0, 79.0, -812.0, -669.0, 145.0, -482.0, -460.0, -372.0, 68.0, -31.0, 200.0, -1879.0, -1824.0, -1923.0, -20.0, -42.0, 200.0, 200.0, -350.0, -152.0, -119.0, 200.0, 200.0, -20.0, 134.0, 13.0, 13.0, 200.0, 35.0, 200.0, 200.0, 90.0, -119.0, -174.0, -152.0, 200.0, 2.0, 200.0, -207.0, -427.0, -152.0, -31.0, -284.0, 156.0, 200.0, -141.0, 200.0, 101.0, 145.0, -207.0, 200.0, -229.0, 200.0, 200.0, 200.0, 200.0, -218.0, 101.0, 200.0, -559.0, -526.0, -372.0, -405.0, -515.0, 200.0, -339.0, -240.0, 156.0, 145.0, -75.0, 167.0, 200.0, 200.0, 189.0, -1263.0, 13.0, 2.0, 90.0, -185.0, -515.0, -416.0, -86.0, -86.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 57.0, 79.0, -152.0, 200.0, -163.0, -251.0], "policy_predator_policy_reward": [295.0, 260.0, 0.0, 35.0, 205.0, 170.0, 1000.0, 125.0, 35.0, 0.0, 25.0, 40.0, 0.0, 0.0, 110.0, 35.0, 80.0, 20.0, 65.0, 60.0, 0.0, 0.0, 190.0, 1000.0, 0.0, 320.0, 470.0, 10.0, 0.0, 35.0, 85.0, 100.0, 85.0, 55.0, 135.0, 85.0, 50.0, 0.0, 125.0, 90.0, 105.0, 125.0, 490.0, 5.0, 205.0, 0.0, 15.0, 145.0, 0.0, 55.0, 0.0, 0.0, 15.0, 290.0, 140.0, 100.0, 0.0, 40.0, 90.0, 105.0, 0.0, 15.0, 0.0, 100.0, 25.0, 255.0, 105.0, 75.0, 80.0, 765.0, 5.0, 20.0, 70.0, 60.0, 165.0, 250.0, 5.0, 40.0, 580.0, 105.0, 200.0, 185.0, 255.0, 290.0, 245.0, 240.0, 95.0, 0.0, 810.0, 10.0, 0.0, 175.0, 0.0, 45.0, 80.0, 315.0, 30.0, 60.0, 90.0, 0.0, 0.0, 0.0, 25.0, 55.0, 180.0, 130.0, 45.0, 50.0, 60.0, 0.0, 45.0, 135.0, 190.0, 195.0, 190.0, 120.0, 255.0, 0.0, 735.0, 0.0, 240.0, 470.0, 390.0, 90.0, 105.0, 85.0, 350.0, 35.0, 110.0, 0.0, 0.0, 740.0, 20.0, 0.0, 0.0, 195.0, 0.0, 285.0, 55.0, 190.0, 85.0, 170.0, 90.0, 130.0, 125.0, 50.0, 120.0, 30.0, 25.0, 0.0, 185.0, 185.0, 165.0, 185.0, 150.0, 220.0, 480.0, 305.0, 390.0, 310.0, 185.0, 85.0, 205.0, 70.0, 35.0, 180.0, 45.0, 360.0, 125.0, 495.0, 30.0, 105.0, 20.0, 20.0, 140.0, 100.0, 150.0, 205.0, 205.0, 240.0, 0.0, 15.0, 315.0, 10.0, 0.0, 55.0, 240.0, 205.0, 285.0, 140.0, 0.0, 160.0, 335.0, 160.0, 220.0, 0.0, 0.0, 50.0, 260.0, 50.0, 45.0, 90.0, 40.0, 25.0, 260.0, 400.0, 55.0, 70.0, 540.0, 90.0, 295.0, 245.0, 240.0, 105.0, 0.0, 0.0, 0.0, 0.0, 1000.0, 55.0, 0.0, 125.0, 60.0, 190.0, 0.0, 0.0, 145.0, 0.0, 50.0, 120.0, 0.0, 100.0, 0.0, 0.0, 15.0, 50.0, 0.0, 200.0, 0.0, 0.0, 90.0, 25.0, 0.0, 160.0, 330.0, 155.0, 70.0, 175.0, 110.0, 95.0, 95.0, 0.0, 115.0, 175.0, 45.0, 155.0, 195.0, 135.0, 0.0, 0.0, 0.0, 90.0, 150.0, 55.0, 545.0, 230.0, 65.0, 330.0, 250.0, 5.0, 0.0, 260.0, 105.0, 115.0, 95.0, 80.0, 0.0, 0.0, 5.0, 640.0, 320.0, 590.0, 0.0, 270.0, 325.0, 280.0, 45.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 160.0, 0.0, 205.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9577518745425354, "mean_inference_ms": 1.6153179391464465, "mean_action_processing_ms": 0.365565420070689, "mean_env_wait_ms": 0.25613036006864354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009373068809509277, "StateBufferConnector_ms": 0.01132500171661377, "ViewRequirementAgentConnector_ms": 0.1421043872833252}, "num_episodes": 22, "episode_return_max": 656.0, "episode_return_min": -4626.0, "episode_return_mean": 29.22, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.69585719549623, "num_env_steps_trained_throughput_per_sec": 55.69585719549623, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 71729.111, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71729.064, "sample_time_ms": 1315.303, "learn_time_ms": 70395.101, "learn_throughput": 56.822, "synch_weights_time_ms": 13.907}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 80, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-05-35", "timestamp": 1723493135, "time_this_iter_s": 71.83361172676086, "time_total_s": 6538.890716552734, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1078820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6538.890716552734, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 20.115841584158417, "ram_util_percent": 81.82475247524752}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6063763628297665, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7067199387871628, "policy_loss": -0.008569074980192158, "vf_loss": 1.714714519986024, "vf_explained_var": -1.705024682038219e-05, "kl": 0.007658876264293544, "entropy": 0.5776433495025263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 227010.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8756600856041232, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6977064784325606, "policy_loss": -0.02129901307651522, "vf_loss": 1.718331312245511, "vf_explained_var": 0.019823568805735162, "kl": 0.00674178346809287, "entropy": 0.9897453622826448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 227010.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "env_runners": {"episode_reward_max": 667.0, "episode_reward_min": -4626.0, "episode_reward_mean": 95.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1923.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -101.58333333333333, "predator_policy": 133.51666666666668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.0, 450.0, 571.0, 177.0, 431.0, -788.0, 268.0, 246.0, -693.0, 395.0, 289.0, -1407.0, 390.0, 72.0, 395.0, 600.0, 365.0, 154.0, 419.0, 416.0, -221.0, -1437.0, 325.0, 605.0, -357.0, -1784.0, 576.0, -108.0, 336.0, 462.0, 279.0, 534.0, 343.0, 484.0, -832.0, 3.0, 140.0, 206.0, -499.0, 437.0, 528.0, -15.0, 215.0, 478.0, 439.0, 405.0, 28.0, 441.0, 20.0, 436.0, 160.0, -636.0, -534.0, 342.0, -4626.0, 318.0, -52.0, 426.0, 297.0, 348.0, 555.0, -245.0, 517.0, -141.0, 196.0, 449.0, 374.0, 656.0, 600.0, 378.0, -617.0, -135.0, -58.0, 527.0, 594.0, 302.0, -15.0, -263.0, 540.0, 600.0, 229.0, -9.0, 13.0, 80.0, -43.0, -510.0, 495.0, 515.0, 453.0, 321.0, 43.0, 266.0, 397.0, 236.0, 582.0, 172.0, 572.0, 667.0, 576.0, -1652.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-240.0, 2.0, 101.0, -42.0, 123.0, 134.0, 200.0, 189.0, 167.0, -361.0, 24.0, 134.0, 57.0, 200.0, -86.0, -262.0, -262.0, -1054.0, 178.0, -108.0, -97.0, -361.0, 200.0, 112.0, -614.0, -603.0, -361.0, -31.0, -504.0, 200.0, -416.0, -53.0, 178.0, -1208.0, -328.0, -691.0, 167.0, 35.0, 13.0, -493.0, 79.0, 46.0, 68.0, 145.0, 2.0, 200.0, 200.0, 200.0, -20.0, 189.0, -64.0, 90.0, -86.0, -75.0, 101.0, 145.0, 68.0, 134.0, -328.0, 90.0, -273.0, -350.0, -163.0, -911.0, -1208.0, -53.0, -31.0, 200.0, -944.0, -75.0, 200.0, 200.0, 123.0, -548.0, -427.0, -1318.0, -537.0, -669.0, 156.0, 200.0, 200.0, -636.0, 200.0, -152.0, 79.0, -273.0, 200.0, 200.0, 79.0, -207.0, -306.0, 90.0, 200.0, 145.0, 200.0, 134.0, 79.0, -284.0, 13.0, 90.0, -284.0, 123.0, -1153.0, -163.0, -691.0, 112.0, -207.0, -482.0, -251.0, -119.0, 200.0, -625.0, 200.0, 46.0, -966.0, -207.0, 24.0, 156.0, -64.0, 200.0, -141.0, 79.0, 200.0, 112.0, -251.0, -526.0, 200.0, -493.0, 178.0, 79.0, 134.0, 200.0, 156.0, -647.0, 200.0, 178.0, -152.0, 79.0, 200.0, -581.0, -306.0, 200.0, 90.0, 101.0, -372.0, -9.0, 46.0, 145.0, -64.0, 200.0, 101.0, -735.0, 79.0, -812.0, -669.0, 145.0, -482.0, -460.0, -372.0, 68.0, -31.0, 200.0, -1879.0, -1824.0, -1923.0, -20.0, -42.0, 200.0, 200.0, -350.0, -152.0, -119.0, 200.0, 200.0, -20.0, 134.0, 13.0, 13.0, 200.0, 35.0, 200.0, 200.0, 90.0, -119.0, -174.0, -152.0, 200.0, 2.0, 200.0, -207.0, -427.0, -152.0, -31.0, -284.0, 156.0, 200.0, -141.0, 200.0, 101.0, 145.0, -207.0, 200.0, -229.0, 200.0, 200.0, 200.0, 200.0, -218.0, 101.0, 200.0, -559.0, -526.0, -372.0, -405.0, -515.0, 200.0, -339.0, -240.0, 156.0, 145.0, -75.0, 167.0, 200.0, 200.0, 189.0, -1263.0, 13.0, 2.0, 90.0, -185.0, -515.0, -416.0, -86.0, -86.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 57.0, 79.0, -152.0, 200.0, -163.0, -251.0, 145.0, -361.0, -86.0, -53.0, -229.0, -53.0, 101.0, -141.0, -273.0, -460.0, -262.0, -328.0, 101.0, 24.0, 200.0, -9.0, 200.0, 134.0, 123.0, 145.0, 90.0, 2.0, 57.0, 112.0, -130.0, -53.0, -64.0, 123.0, -1131.0, 189.0, 2.0, 167.0, -152.0, 57.0, -229.0, 123.0, 200.0, 200.0, 2.0, 200.0, -152.0, -416.0, 200.0, 200.0, 2.0, 200.0, 189.0, -317.0, 200.0, 101.0, 200.0, -922.0, -1021.0, -944.0], "policy_predator_policy_reward": [140.0, 100.0, 0.0, 40.0, 90.0, 105.0, 0.0, 15.0, 0.0, 100.0, 25.0, 255.0, 105.0, 75.0, 80.0, 765.0, 5.0, 20.0, 70.0, 60.0, 165.0, 250.0, 5.0, 40.0, 580.0, 105.0, 200.0, 185.0, 255.0, 290.0, 245.0, 240.0, 95.0, 0.0, 810.0, 10.0, 0.0, 175.0, 0.0, 45.0, 80.0, 315.0, 30.0, 60.0, 90.0, 0.0, 0.0, 0.0, 25.0, 55.0, 180.0, 130.0, 45.0, 50.0, 60.0, 0.0, 45.0, 135.0, 190.0, 195.0, 190.0, 120.0, 255.0, 0.0, 735.0, 0.0, 240.0, 470.0, 390.0, 90.0, 105.0, 85.0, 350.0, 35.0, 110.0, 0.0, 0.0, 740.0, 20.0, 0.0, 0.0, 195.0, 0.0, 285.0, 55.0, 190.0, 85.0, 170.0, 90.0, 130.0, 125.0, 50.0, 120.0, 30.0, 25.0, 0.0, 185.0, 185.0, 165.0, 185.0, 150.0, 220.0, 480.0, 305.0, 390.0, 310.0, 185.0, 85.0, 205.0, 70.0, 35.0, 180.0, 45.0, 360.0, 125.0, 495.0, 30.0, 105.0, 20.0, 20.0, 140.0, 100.0, 150.0, 205.0, 205.0, 240.0, 0.0, 15.0, 315.0, 10.0, 0.0, 55.0, 240.0, 205.0, 285.0, 140.0, 0.0, 160.0, 335.0, 160.0, 220.0, 0.0, 0.0, 50.0, 260.0, 50.0, 45.0, 90.0, 40.0, 25.0, 260.0, 400.0, 55.0, 70.0, 540.0, 90.0, 295.0, 245.0, 240.0, 105.0, 0.0, 0.0, 0.0, 0.0, 1000.0, 55.0, 0.0, 125.0, 60.0, 190.0, 0.0, 0.0, 145.0, 0.0, 50.0, 120.0, 0.0, 100.0, 0.0, 0.0, 15.0, 50.0, 0.0, 200.0, 0.0, 0.0, 90.0, 25.0, 0.0, 160.0, 330.0, 155.0, 70.0, 175.0, 110.0, 95.0, 95.0, 0.0, 115.0, 175.0, 45.0, 155.0, 195.0, 135.0, 0.0, 0.0, 0.0, 90.0, 150.0, 55.0, 545.0, 230.0, 65.0, 330.0, 250.0, 5.0, 0.0, 260.0, 105.0, 115.0, 95.0, 80.0, 0.0, 0.0, 5.0, 640.0, 320.0, 590.0, 0.0, 270.0, 325.0, 280.0, 45.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 160.0, 0.0, 205.0, 0.0, 25.0, 35.0, 255.0, 105.0, 110.0, 200.0, 0.0, 270.0, 0.0, 35.0, 430.0, 75.0, 45.0, 60.0, 65.0, 0.0, 95.0, 95.0, 55.0, 20.0, 20.0, 0.0, 30.0, 120.0, 115.0, 75.0, 100.0, 605.0, 340.0, 140.0, 115.0, 130.0, 135.0, 55.0, 195.0, 35.0, 75.0, 70.0, 35.0, 280.0, 100.0, 160.0, 0.0, 80.0, 90.0, 195.0, 190.0, 210.0, 35.0, 10.0, 30.0, 340.0, 680.0, 215.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9560800860870057, "mean_inference_ms": 1.6129359895878361, "mean_action_processing_ms": 0.3650119512294519, "mean_env_wait_ms": 0.2558648427074445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008865833282470703, "StateBufferConnector_ms": 0.011500239372253418, "ViewRequirementAgentConnector_ms": 0.1480116844177246}, "num_episodes": 18, "episode_return_max": 667.0, "episode_return_min": -4626.0, "episode_return_mean": 95.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.04453582147603, "num_env_steps_trained_throughput_per_sec": 56.04453582147603, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1944000, "timers": {"training_iteration_time_ms": 71646.326, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71646.279, "sample_time_ms": 1303.057, "learn_time_ms": 70324.397, "learn_throughput": 56.879, "synch_weights_time_ms": 13.84}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1944000, "num_agent_steps_trained": 1944000}, "done": false, "training_iteration": 81, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-06-47", "timestamp": 1723493207, "time_this_iter_s": 71.42465496063232, "time_total_s": 6610.315371513367, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2328790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6610.315371513367, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 19.382178217821785, "ram_util_percent": 82.22970297029701}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4215141931535504, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.546690085001871, "policy_loss": -0.0074001504222248144, "vf_loss": 1.553533221897504, "vf_explained_var": -2.5295978742288358e-05, "kl": 0.0074258452338096925, "entropy": 0.6325188555404649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 229830.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.2117452189431965, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.824805341851204, "policy_loss": -0.019991926982146788, "vf_loss": 1.843812010896967, "vf_explained_var": 0.03495825431871076, "kl": 0.009852589690140669, "entropy": 0.9951925772301694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 229830.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": 667.0, "episode_reward_min": -4626.0, "episode_reward_mean": 112.43, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1923.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -89.00666666666666, "predator_policy": 126.48333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [605.0, -357.0, -1784.0, 576.0, -108.0, 336.0, 462.0, 279.0, 534.0, 343.0, 484.0, -832.0, 3.0, 140.0, 206.0, -499.0, 437.0, 528.0, -15.0, 215.0, 478.0, 439.0, 405.0, 28.0, 441.0, 20.0, 436.0, 160.0, -636.0, -534.0, 342.0, -4626.0, 318.0, -52.0, 426.0, 297.0, 348.0, 555.0, -245.0, 517.0, -141.0, 196.0, 449.0, 374.0, 656.0, 600.0, 378.0, -617.0, -135.0, -58.0, 527.0, 594.0, 302.0, -15.0, -263.0, 540.0, 600.0, 229.0, -9.0, 13.0, 80.0, -43.0, -510.0, 495.0, 515.0, 453.0, 321.0, 43.0, 266.0, 397.0, 236.0, 582.0, 172.0, 572.0, 667.0, 576.0, -1652.0, -4054.0, 494.0, 646.0, 342.0, 159.0, -322.0, 466.0, 196.0, 371.0, 198.0, 201.0, 429.0, 493.0, 540.0, 534.0, -153.0, 405.0, 540.0, 351.0, 386.0, 504.0, -161.0, 618.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-75.0, 200.0, 200.0, 123.0, -548.0, -427.0, -1318.0, -537.0, -669.0, 156.0, 200.0, 200.0, -636.0, 200.0, -152.0, 79.0, -273.0, 200.0, 200.0, 79.0, -207.0, -306.0, 90.0, 200.0, 145.0, 200.0, 134.0, 79.0, -284.0, 13.0, 90.0, -284.0, 123.0, -1153.0, -163.0, -691.0, 112.0, -207.0, -482.0, -251.0, -119.0, 200.0, -625.0, 200.0, 46.0, -966.0, -207.0, 24.0, 156.0, -64.0, 200.0, -141.0, 79.0, 200.0, 112.0, -251.0, -526.0, 200.0, -493.0, 178.0, 79.0, 134.0, 200.0, 156.0, -647.0, 200.0, 178.0, -152.0, 79.0, 200.0, -581.0, -306.0, 200.0, 90.0, 101.0, -372.0, -9.0, 46.0, 145.0, -64.0, 200.0, 101.0, -735.0, 79.0, -812.0, -669.0, 145.0, -482.0, -460.0, -372.0, 68.0, -31.0, 200.0, -1879.0, -1824.0, -1923.0, -20.0, -42.0, 200.0, 200.0, -350.0, -152.0, -119.0, 200.0, 200.0, -20.0, 134.0, 13.0, 13.0, 200.0, 35.0, 200.0, 200.0, 90.0, -119.0, -174.0, -152.0, 200.0, 2.0, 200.0, -207.0, -427.0, -152.0, -31.0, -284.0, 156.0, 200.0, -141.0, 200.0, 101.0, 145.0, -207.0, 200.0, -229.0, 200.0, 200.0, 200.0, 200.0, -218.0, 101.0, 200.0, -559.0, -526.0, -372.0, -405.0, -515.0, 200.0, -339.0, -240.0, 156.0, 145.0, -75.0, 167.0, 200.0, 200.0, 189.0, -1263.0, 13.0, 2.0, 90.0, -185.0, -515.0, -416.0, -86.0, -86.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 57.0, 79.0, -152.0, 200.0, -163.0, -251.0, 145.0, -361.0, -86.0, -53.0, -229.0, -53.0, 101.0, -141.0, -273.0, -460.0, -262.0, -328.0, 101.0, 24.0, 200.0, -9.0, 200.0, 134.0, 123.0, 145.0, 90.0, 2.0, 57.0, 112.0, -130.0, -53.0, -64.0, 123.0, -1131.0, 189.0, 2.0, 167.0, -152.0, 57.0, -229.0, 123.0, 200.0, 200.0, 2.0, 200.0, -152.0, -416.0, 200.0, 200.0, 2.0, 200.0, 189.0, -317.0, 200.0, 101.0, 200.0, -922.0, -1021.0, -944.0, -1747.0, -1824.0, -1758.0, -306.0, 200.0, 200.0, 200.0, 200.0, -669.0, -9.0, 200.0, -64.0, -229.0, -31.0, -86.0, -416.0, -394.0, -262.0, -218.0, 200.0, 134.0, 79.0, -185.0, 2.0, -97.0, 68.0, 200.0, -9.0, -262.0, -31.0, -163.0, 200.0, -31.0, 200.0, -20.0, 134.0, 200.0, -119.0, 112.0, 90.0, 200.0, 200.0, 200.0, 200.0, 79.0, -240.0, 200.0, -383.0, 123.0, 79.0, 68.0, 189.0, 200.0, 101.0, -361.0, 189.0, 123.0, 24.0, 90.0, 112.0, 145.0, 79.0, 200.0, 79.0, -306.0, -339.0, 123.0, 200.0, 200.0], "policy_predator_policy_reward": [90.0, 105.0, 85.0, 350.0, 35.0, 110.0, 0.0, 0.0, 740.0, 20.0, 0.0, 0.0, 195.0, 0.0, 285.0, 55.0, 190.0, 85.0, 170.0, 90.0, 130.0, 125.0, 50.0, 120.0, 30.0, 25.0, 0.0, 185.0, 185.0, 165.0, 185.0, 150.0, 220.0, 480.0, 305.0, 390.0, 310.0, 185.0, 85.0, 205.0, 70.0, 35.0, 180.0, 45.0, 360.0, 125.0, 495.0, 30.0, 105.0, 20.0, 20.0, 140.0, 100.0, 150.0, 205.0, 205.0, 240.0, 0.0, 15.0, 315.0, 10.0, 0.0, 55.0, 240.0, 205.0, 285.0, 140.0, 0.0, 160.0, 335.0, 160.0, 220.0, 0.0, 0.0, 50.0, 260.0, 50.0, 45.0, 90.0, 40.0, 25.0, 260.0, 400.0, 55.0, 70.0, 540.0, 90.0, 295.0, 245.0, 240.0, 105.0, 0.0, 0.0, 0.0, 0.0, 1000.0, 55.0, 0.0, 125.0, 60.0, 190.0, 0.0, 0.0, 145.0, 0.0, 50.0, 120.0, 0.0, 100.0, 0.0, 0.0, 15.0, 50.0, 0.0, 200.0, 0.0, 0.0, 90.0, 25.0, 0.0, 160.0, 330.0, 155.0, 70.0, 175.0, 110.0, 95.0, 95.0, 0.0, 115.0, 175.0, 45.0, 155.0, 195.0, 135.0, 0.0, 0.0, 0.0, 90.0, 150.0, 55.0, 545.0, 230.0, 65.0, 330.0, 250.0, 5.0, 0.0, 260.0, 105.0, 115.0, 95.0, 80.0, 0.0, 0.0, 5.0, 640.0, 320.0, 590.0, 0.0, 270.0, 325.0, 280.0, 45.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 160.0, 0.0, 205.0, 0.0, 25.0, 35.0, 255.0, 105.0, 110.0, 200.0, 0.0, 270.0, 0.0, 35.0, 430.0, 75.0, 45.0, 60.0, 65.0, 0.0, 95.0, 95.0, 55.0, 20.0, 20.0, 0.0, 30.0, 120.0, 115.0, 75.0, 100.0, 605.0, 340.0, 140.0, 115.0, 130.0, 135.0, 55.0, 195.0, 35.0, 75.0, 70.0, 35.0, 280.0, 100.0, 160.0, 0.0, 80.0, 90.0, 195.0, 190.0, 210.0, 35.0, 10.0, 30.0, 340.0, 680.0, 215.0, 995.0, 180.0, 100.0, 190.0, 160.0, 50.0, 345.0, 200.0, 370.0, 120.0, 40.0, 55.0, 155.0, 145.0, 205.0, 365.0, 265.0, 120.0, 40.0, 105.0, 205.0, 85.0, 175.0, 40.0, 60.0, 80.0, 60.0, 315.0, 145.0, 40.0, 150.0, 45.0, 0.0, 15.0, 0.0, 100.0, 125.0, 85.0, 90.0, 0.0, 50.0, 0.0, 0.0, 55.0, 0.0, 270.0, 0.0, 0.0, 0.0, 95.0, 40.0, 0.0, 45.0, 5.0, 115.0, 115.0, 170.0, 80.0, 10.0, 70.0, 0.0, 30.0, 50.0, 105.0, 245.0, 55.0, 35.0, 30.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9547053265423422, "mean_inference_ms": 1.6102847581797448, "mean_action_processing_ms": 0.3645846457266805, "mean_env_wait_ms": 0.25540642071987213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008140087127685547, "StateBufferConnector_ms": 0.011594533920288086, "ViewRequirementAgentConnector_ms": 0.14709973335266113}, "num_episodes": 23, "episode_return_max": 667.0, "episode_return_min": -4626.0, "episode_return_mean": 112.43, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.91588849529525, "num_env_steps_trained_throughput_per_sec": 55.91588849529525, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 71631.58, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71631.533, "sample_time_ms": 1309.835, "learn_time_ms": 70302.468, "learn_throughput": 56.897, "synch_weights_time_ms": 13.895}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 82, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-07-58", "timestamp": 1723493278, "time_this_iter_s": 71.57529902458191, "time_total_s": 6681.890670537949, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b231b280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6681.890670537949, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 19.708823529411767, "ram_util_percent": 82.37058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.484779600862493, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1605079107039364, "policy_loss": -0.00618716488940747, "vf_loss": 1.1660850352852057, "vf_explained_var": -1.3256855044804567e-05, "kl": 0.008133002612530617, "entropy": 0.6117035015149319, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 232650.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.978062737579887, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0721744971125262, "policy_loss": -0.0209595967581205, "vf_loss": 1.0922999548996595, "vf_explained_var": 0.027618597331621968, "kl": 0.008341431243645038, "entropy": 1.0443539761059673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 232650.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "env_runners": {"episode_reward_max": 667.0, "episode_reward_min": -4626.0, "episode_reward_mean": 158.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1923.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -63.23, "predator_policy": 116.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-15.0, 215.0, 478.0, 439.0, 405.0, 28.0, 441.0, 20.0, 436.0, 160.0, -636.0, -534.0, 342.0, -4626.0, 318.0, -52.0, 426.0, 297.0, 348.0, 555.0, -245.0, 517.0, -141.0, 196.0, 449.0, 374.0, 656.0, 600.0, 378.0, -617.0, -135.0, -58.0, 527.0, 594.0, 302.0, -15.0, -263.0, 540.0, 600.0, 229.0, -9.0, 13.0, 80.0, -43.0, -510.0, 495.0, 515.0, 453.0, 321.0, 43.0, 266.0, 397.0, 236.0, 582.0, 172.0, 572.0, 667.0, 576.0, -1652.0, -4054.0, 494.0, 646.0, 342.0, 159.0, -322.0, 466.0, 196.0, 371.0, 198.0, 201.0, 429.0, 493.0, 540.0, 534.0, -153.0, 405.0, 540.0, 351.0, 386.0, 504.0, -161.0, 618.0, 390.0, 480.0, 385.0, 555.0, 505.0, -926.0, 294.0, 588.0, 474.0, 444.0, 162.0, 428.0, 554.0, 455.0, 309.0, -246.0, 583.0, 522.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [112.0, -251.0, -526.0, 200.0, -493.0, 178.0, 79.0, 134.0, 200.0, 156.0, -647.0, 200.0, 178.0, -152.0, 79.0, 200.0, -581.0, -306.0, 200.0, 90.0, 101.0, -372.0, -9.0, 46.0, 145.0, -64.0, 200.0, 101.0, -735.0, 79.0, -812.0, -669.0, 145.0, -482.0, -460.0, -372.0, 68.0, -31.0, 200.0, -1879.0, -1824.0, -1923.0, -20.0, -42.0, 200.0, 200.0, -350.0, -152.0, -119.0, 200.0, 200.0, -20.0, 134.0, 13.0, 13.0, 200.0, 35.0, 200.0, 200.0, 90.0, -119.0, -174.0, -152.0, 200.0, 2.0, 200.0, -207.0, -427.0, -152.0, -31.0, -284.0, 156.0, 200.0, -141.0, 200.0, 101.0, 145.0, -207.0, 200.0, -229.0, 200.0, 200.0, 200.0, 200.0, -218.0, 101.0, 200.0, -559.0, -526.0, -372.0, -405.0, -515.0, 200.0, -339.0, -240.0, 156.0, 145.0, -75.0, 167.0, 200.0, 200.0, 189.0, -1263.0, 13.0, 2.0, 90.0, -185.0, -515.0, -416.0, -86.0, -86.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 57.0, 79.0, -152.0, 200.0, -163.0, -251.0, 145.0, -361.0, -86.0, -53.0, -229.0, -53.0, 101.0, -141.0, -273.0, -460.0, -262.0, -328.0, 101.0, 24.0, 200.0, -9.0, 200.0, 134.0, 123.0, 145.0, 90.0, 2.0, 57.0, 112.0, -130.0, -53.0, -64.0, 123.0, -1131.0, 189.0, 2.0, 167.0, -152.0, 57.0, -229.0, 123.0, 200.0, 200.0, 2.0, 200.0, -152.0, -416.0, 200.0, 200.0, 2.0, 200.0, 189.0, -317.0, 200.0, 101.0, 200.0, -922.0, -1021.0, -944.0, -1747.0, -1824.0, -1758.0, -306.0, 200.0, 200.0, 200.0, 200.0, -669.0, -9.0, 200.0, -64.0, -229.0, -31.0, -86.0, -416.0, -394.0, -262.0, -218.0, 200.0, 134.0, 79.0, -185.0, 2.0, -97.0, 68.0, 200.0, -9.0, -262.0, -31.0, -163.0, 200.0, -31.0, 200.0, -20.0, 134.0, 200.0, -119.0, 112.0, 90.0, 200.0, 200.0, 200.0, 200.0, 79.0, -240.0, 200.0, -383.0, 123.0, 79.0, 68.0, 189.0, 200.0, 101.0, -361.0, 189.0, 123.0, 24.0, 90.0, 112.0, 145.0, 79.0, 200.0, 79.0, -306.0, -339.0, 123.0, 200.0, 200.0, 112.0, -9.0, 57.0, 156.0, 79.0, 145.0, 189.0, -449.0, 200.0, 200.0, 35.0, 200.0, 24.0, 200.0, -284.0, -889.0, -867.0, 200.0, -196.0, 35.0, 200.0, 200.0, 200.0, 178.0, 46.0, 200.0, 68.0, -196.0, 200.0, 145.0, -317.0, 101.0, -207.0, 200.0, 123.0, -405.0, 200.0, 156.0, 178.0, 178.0, 57.0, 35.0, -130.0, 200.0, -31.0, -97.0, -405.0, -174.0, 189.0, 189.0, 200.0, 79.0, 178.0, 200.0], "policy_predator_policy_reward": [205.0, 205.0, 240.0, 0.0, 15.0, 315.0, 10.0, 0.0, 55.0, 240.0, 205.0, 285.0, 140.0, 0.0, 160.0, 335.0, 160.0, 220.0, 0.0, 0.0, 50.0, 260.0, 50.0, 45.0, 90.0, 40.0, 25.0, 260.0, 400.0, 55.0, 70.0, 540.0, 90.0, 295.0, 245.0, 240.0, 105.0, 0.0, 0.0, 0.0, 0.0, 1000.0, 55.0, 0.0, 125.0, 60.0, 190.0, 0.0, 0.0, 145.0, 0.0, 50.0, 120.0, 0.0, 100.0, 0.0, 0.0, 15.0, 50.0, 0.0, 200.0, 0.0, 0.0, 90.0, 25.0, 0.0, 160.0, 330.0, 155.0, 70.0, 175.0, 110.0, 95.0, 95.0, 0.0, 115.0, 175.0, 45.0, 155.0, 195.0, 135.0, 0.0, 0.0, 0.0, 90.0, 150.0, 55.0, 545.0, 230.0, 65.0, 330.0, 250.0, 5.0, 0.0, 260.0, 105.0, 115.0, 95.0, 80.0, 0.0, 0.0, 5.0, 640.0, 320.0, 590.0, 0.0, 270.0, 325.0, 280.0, 45.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 160.0, 0.0, 205.0, 0.0, 25.0, 35.0, 255.0, 105.0, 110.0, 200.0, 0.0, 270.0, 0.0, 35.0, 430.0, 75.0, 45.0, 60.0, 65.0, 0.0, 95.0, 95.0, 55.0, 20.0, 20.0, 0.0, 30.0, 120.0, 115.0, 75.0, 100.0, 605.0, 340.0, 140.0, 115.0, 130.0, 135.0, 55.0, 195.0, 35.0, 75.0, 70.0, 35.0, 280.0, 100.0, 160.0, 0.0, 80.0, 90.0, 195.0, 190.0, 210.0, 35.0, 10.0, 30.0, 340.0, 680.0, 215.0, 995.0, 180.0, 100.0, 190.0, 160.0, 50.0, 345.0, 200.0, 370.0, 120.0, 40.0, 55.0, 155.0, 145.0, 205.0, 365.0, 265.0, 120.0, 40.0, 105.0, 205.0, 85.0, 175.0, 40.0, 60.0, 80.0, 60.0, 315.0, 145.0, 40.0, 150.0, 45.0, 0.0, 15.0, 0.0, 100.0, 125.0, 85.0, 90.0, 0.0, 50.0, 0.0, 0.0, 55.0, 0.0, 270.0, 0.0, 0.0, 0.0, 95.0, 40.0, 0.0, 45.0, 5.0, 115.0, 115.0, 170.0, 80.0, 10.0, 70.0, 0.0, 30.0, 50.0, 105.0, 245.0, 55.0, 35.0, 30.0, 30.0, 80.0, 95.0, 55.0, 75.0, 0.0, 25.0, 65.0, 215.0, 165.0, 75.0, 45.0, 0.0, 190.0, 185.0, 190.0, 495.0, 0.0, 135.0, 0.0, 185.0, 70.0, 0.0, 10.0, 0.0, 35.0, 40.0, 85.0, 160.0, 135.0, 0.0, 225.0, 220.0, 140.0, 255.0, 160.0, 95.0, 0.0, 20.0, 0.0, 80.0, 0.0, 105.0, 85.0, 100.0, 85.0, 75.0, 255.0, 100.0, 0.0, 0.0, 5.0, 0.0, 0.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9538709933611282, "mean_inference_ms": 1.6088883907507239, "mean_action_processing_ms": 0.3643488251783208, "mean_env_wait_ms": 0.25526999786053406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005562782287597656, "StateBufferConnector_ms": 0.011412501335144043, "ViewRequirementAgentConnector_ms": 0.1538703441619873}, "num_episodes": 18, "episode_return_max": 667.0, "episode_return_min": -4626.0, "episode_return_mean": 158.46, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.561128350583985, "num_env_steps_trained_throughput_per_sec": 54.561128350583985, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1992000, "timers": {"training_iteration_time_ms": 71764.862, "restore_workers_time_ms": 0.013, "training_step_time_ms": 71764.817, "sample_time_ms": 1375.496, "learn_time_ms": 70370.634, "learn_throughput": 56.842, "synch_weights_time_ms": 13.404}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1992000, "num_agent_steps_trained": 1992000}, "done": false, "training_iteration": 83, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-09-12", "timestamp": 1723493352, "time_this_iter_s": 73.34274411201477, "time_total_s": 6755.233414649963, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b21bbca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6755.233414649963, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 22.839805825242717, "ram_util_percent": 81.81165048543689}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4734798519535268, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8659863682503397, "policy_loss": -0.007373960016143396, "vf_loss": 1.8727098637016106, "vf_explained_var": -1.026480755907424e-05, "kl": 0.008671856599810755, "entropy": 0.5783478675898931, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 235470.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.189871874631297, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.629343664508762, "policy_loss": -0.0264513537859881, "vf_loss": 1.6548413894489302, "vf_explained_var": 0.0275356595397841, "kl": 0.009536302122462885, "entropy": 0.9727864250646415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 235470.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 779.0, "episode_reward_min": -4054.0, "episode_reward_mean": 199.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1824.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -50.50666666666667, "predator_policy": 117.01666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [348.0, 555.0, -245.0, 517.0, -141.0, 196.0, 449.0, 374.0, 656.0, 600.0, 378.0, -617.0, -135.0, -58.0, 527.0, 594.0, 302.0, -15.0, -263.0, 540.0, 600.0, 229.0, -9.0, 13.0, 80.0, -43.0, -510.0, 495.0, 515.0, 453.0, 321.0, 43.0, 266.0, 397.0, 236.0, 582.0, 172.0, 572.0, 667.0, 576.0, -1652.0, -4054.0, 494.0, 646.0, 342.0, 159.0, -322.0, 466.0, 196.0, 371.0, 198.0, 201.0, 429.0, 493.0, 540.0, 534.0, -153.0, 405.0, 540.0, 351.0, 386.0, 504.0, -161.0, 618.0, 390.0, 480.0, 385.0, 555.0, 505.0, -926.0, 294.0, 588.0, 474.0, 444.0, 162.0, 428.0, 554.0, 455.0, 309.0, -246.0, 583.0, 522.0, 533.0, 594.0, 297.0, -2974.0, 332.0, 352.0, 261.0, -659.0, 343.0, 248.0, 274.0, 779.0, 504.0, 366.0, 322.0, 534.0, 108.0, 35.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.0, 200.0, 35.0, 200.0, 200.0, 90.0, -119.0, -174.0, -152.0, 200.0, 2.0, 200.0, -207.0, -427.0, -152.0, -31.0, -284.0, 156.0, 200.0, -141.0, 200.0, 101.0, 145.0, -207.0, 200.0, -229.0, 200.0, 200.0, 200.0, 200.0, -218.0, 101.0, 200.0, -559.0, -526.0, -372.0, -405.0, -515.0, 200.0, -339.0, -240.0, 156.0, 145.0, -75.0, 167.0, 200.0, 200.0, 189.0, -1263.0, 13.0, 2.0, 90.0, -185.0, -515.0, -416.0, -86.0, -86.0, 200.0, 200.0, 90.0, 200.0, 200.0, 200.0, 57.0, 79.0, -152.0, 200.0, -163.0, -251.0, 145.0, -361.0, -86.0, -53.0, -229.0, -53.0, 101.0, -141.0, -273.0, -460.0, -262.0, -328.0, 101.0, 24.0, 200.0, -9.0, 200.0, 134.0, 123.0, 145.0, 90.0, 2.0, 57.0, 112.0, -130.0, -53.0, -64.0, 123.0, -1131.0, 189.0, 2.0, 167.0, -152.0, 57.0, -229.0, 123.0, 200.0, 200.0, 2.0, 200.0, -152.0, -416.0, 200.0, 200.0, 2.0, 200.0, 189.0, -317.0, 200.0, 101.0, 200.0, -922.0, -1021.0, -944.0, -1747.0, -1824.0, -1758.0, -306.0, 200.0, 200.0, 200.0, 200.0, -669.0, -9.0, 200.0, -64.0, -229.0, -31.0, -86.0, -416.0, -394.0, -262.0, -218.0, 200.0, 134.0, 79.0, -185.0, 2.0, -97.0, 68.0, 200.0, -9.0, -262.0, -31.0, -163.0, 200.0, -31.0, 200.0, -20.0, 134.0, 200.0, -119.0, 112.0, 90.0, 200.0, 200.0, 200.0, 200.0, 79.0, -240.0, 200.0, -383.0, 123.0, 79.0, 68.0, 189.0, 200.0, 101.0, -361.0, 189.0, 123.0, 24.0, 90.0, 112.0, 145.0, 79.0, 200.0, 79.0, -306.0, -339.0, 123.0, 200.0, 200.0, 112.0, -9.0, 57.0, 156.0, 79.0, 145.0, 189.0, -449.0, 200.0, 200.0, 35.0, 200.0, 24.0, 200.0, -284.0, -889.0, -867.0, 200.0, -196.0, 35.0, 200.0, 200.0, 200.0, 178.0, 46.0, 200.0, 68.0, -196.0, 200.0, 145.0, -317.0, 101.0, -207.0, 200.0, 123.0, -405.0, 200.0, 156.0, 178.0, 178.0, 57.0, 35.0, -130.0, 200.0, -31.0, -97.0, -405.0, -174.0, 189.0, 189.0, 200.0, 79.0, 178.0, 200.0, 68.0, 200.0, 200.0, 189.0, 200.0, 200.0, -163.0, 68.0, 167.0, -1571.0, -1417.0, -1076.0, -240.0, 200.0, 112.0, 200.0, 112.0, -625.0, -152.0, 189.0, -86.0, -702.0, -405.0, -97.0, 2.0, -229.0, 145.0, 35.0, 145.0, -482.0, 200.0, -328.0, 112.0, 200.0, 101.0, -1252.0, 200.0, 90.0, 134.0, 167.0, -405.0, 189.0, 13.0, 200.0, 24.0, 145.0, 200.0, 134.0, 46.0, -427.0, 79.0, -108.0, -328.0, -9.0], "policy_predator_policy_reward": [100.0, 0.0, 0.0, 15.0, 50.0, 0.0, 200.0, 0.0, 0.0, 90.0, 25.0, 0.0, 160.0, 330.0, 155.0, 70.0, 175.0, 110.0, 95.0, 95.0, 0.0, 115.0, 175.0, 45.0, 155.0, 195.0, 135.0, 0.0, 0.0, 0.0, 90.0, 150.0, 55.0, 545.0, 230.0, 65.0, 330.0, 250.0, 5.0, 0.0, 260.0, 105.0, 115.0, 95.0, 80.0, 0.0, 0.0, 5.0, 640.0, 320.0, 590.0, 0.0, 270.0, 325.0, 280.0, 45.0, 0.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 85.0, 160.0, 0.0, 205.0, 0.0, 25.0, 35.0, 255.0, 105.0, 110.0, 200.0, 0.0, 270.0, 0.0, 35.0, 430.0, 75.0, 45.0, 60.0, 65.0, 0.0, 95.0, 95.0, 55.0, 20.0, 20.0, 0.0, 30.0, 120.0, 115.0, 75.0, 100.0, 605.0, 340.0, 140.0, 115.0, 130.0, 135.0, 55.0, 195.0, 35.0, 75.0, 70.0, 35.0, 280.0, 100.0, 160.0, 0.0, 80.0, 90.0, 195.0, 190.0, 210.0, 35.0, 10.0, 30.0, 340.0, 680.0, 215.0, 995.0, 180.0, 100.0, 190.0, 160.0, 50.0, 345.0, 200.0, 370.0, 120.0, 40.0, 55.0, 155.0, 145.0, 205.0, 365.0, 265.0, 120.0, 40.0, 105.0, 205.0, 85.0, 175.0, 40.0, 60.0, 80.0, 60.0, 315.0, 145.0, 40.0, 150.0, 45.0, 0.0, 15.0, 0.0, 100.0, 125.0, 85.0, 90.0, 0.0, 50.0, 0.0, 0.0, 55.0, 0.0, 270.0, 0.0, 0.0, 0.0, 95.0, 40.0, 0.0, 45.0, 5.0, 115.0, 115.0, 170.0, 80.0, 10.0, 70.0, 0.0, 30.0, 50.0, 105.0, 245.0, 55.0, 35.0, 30.0, 30.0, 80.0, 95.0, 55.0, 75.0, 0.0, 25.0, 65.0, 215.0, 165.0, 75.0, 45.0, 0.0, 190.0, 185.0, 190.0, 495.0, 0.0, 135.0, 0.0, 185.0, 70.0, 0.0, 10.0, 0.0, 35.0, 40.0, 85.0, 160.0, 135.0, 0.0, 225.0, 220.0, 140.0, 255.0, 160.0, 95.0, 0.0, 20.0, 0.0, 80.0, 0.0, 105.0, 85.0, 100.0, 85.0, 75.0, 255.0, 100.0, 0.0, 0.0, 5.0, 0.0, 0.0, 65.0, 0.0, 55.0, 10.0, 0.0, 5.0, 0.0, 60.0, 0.0, 165.0, 140.0, 0.0, 950.0, 100.0, 40.0, 120.0, 205.0, 390.0, 70.0, 100.0, 130.0, 80.0, 130.0, 415.0, 0.0, 240.0, 40.0, 145.0, 180.0, 340.0, 30.0, 10.0, 40.0, 240.0, 545.0, 580.0, 605.0, 30.0, 0.0, 50.0, 275.0, 45.0, 95.0, 0.0, 85.0, 0.0, 25.0, 30.0, 0.0, 0.0, 85.0, 325.0, 205.0, 105.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9533373006138776, "mean_inference_ms": 1.607498209517197, "mean_action_processing_ms": 0.3641378558711679, "mean_env_wait_ms": 0.25508736011185973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004712224006652832, "StateBufferConnector_ms": 0.011175870895385742, "ViewRequirementAgentConnector_ms": 0.14707422256469727}, "num_episodes": 18, "episode_return_max": 779.0, "episode_return_min": -4054.0, "episode_return_mean": 199.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.05371978747745, "num_env_steps_trained_throughput_per_sec": 56.05371978747745, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 71701.209, "restore_workers_time_ms": 0.013, "training_step_time_ms": 71701.164, "sample_time_ms": 1374.225, "learn_time_ms": 70309.265, "learn_throughput": 56.892, "synch_weights_time_ms": 13.372}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 84, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-10-23", "timestamp": 1723493423, "time_this_iter_s": 71.38760375976562, "time_total_s": 6826.621018409729, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e34b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6826.621018409729, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 20.075247524752474, "ram_util_percent": 82.53465346534654}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5368454237567617, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3949385680839526, "policy_loss": -0.008048092123411649, "vf_loss": 1.4023715107681904, "vf_explained_var": 3.7228807489922707e-06, "kl": 0.008201106771672769, "entropy": 0.5983800119964789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 238290.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8165561312902057, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1447217299318906, "policy_loss": -0.01852988991291916, "vf_loss": 1.1626280672795384, "vf_explained_var": 0.034054758320463466, "kl": 0.006235519091861742, "entropy": 0.9558847798523328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 238290.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 779.0, "episode_reward_min": -4054.0, "episode_reward_mean": 222.89, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1824.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -41.67, "predator_policy": 115.96666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.0, 13.0, 80.0, -43.0, -510.0, 495.0, 515.0, 453.0, 321.0, 43.0, 266.0, 397.0, 236.0, 582.0, 172.0, 572.0, 667.0, 576.0, -1652.0, -4054.0, 494.0, 646.0, 342.0, 159.0, -322.0, 466.0, 196.0, 371.0, 198.0, 201.0, 429.0, 493.0, 540.0, 534.0, -153.0, 405.0, 540.0, 351.0, 386.0, 504.0, -161.0, 618.0, 390.0, 480.0, 385.0, 555.0, 505.0, -926.0, 294.0, 588.0, 474.0, 444.0, 162.0, 428.0, 554.0, 455.0, 309.0, -246.0, 583.0, 522.0, 533.0, 594.0, 297.0, -2974.0, 332.0, 352.0, 261.0, -659.0, 343.0, 248.0, 274.0, 779.0, 504.0, 366.0, 322.0, 534.0, 108.0, 35.0, 487.0, 600.0, 429.0, 346.0, 552.0, 444.0, 600.0, 600.0, 488.0, 15.0, 199.0, 419.0, 551.0, 355.0, 257.0, 575.0, -130.0, 236.0, 320.0, 186.0, 411.0, -213.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -163.0, -251.0, 145.0, -361.0, -86.0, -53.0, -229.0, -53.0, 101.0, -141.0, -273.0, -460.0, -262.0, -328.0, 101.0, 24.0, 200.0, -9.0, 200.0, 134.0, 123.0, 145.0, 90.0, 2.0, 57.0, 112.0, -130.0, -53.0, -64.0, 123.0, -1131.0, 189.0, 2.0, 167.0, -152.0, 57.0, -229.0, 123.0, 200.0, 200.0, 2.0, 200.0, -152.0, -416.0, 200.0, 200.0, 2.0, 200.0, 189.0, -317.0, 200.0, 101.0, 200.0, -922.0, -1021.0, -944.0, -1747.0, -1824.0, -1758.0, -306.0, 200.0, 200.0, 200.0, 200.0, -669.0, -9.0, 200.0, -64.0, -229.0, -31.0, -86.0, -416.0, -394.0, -262.0, -218.0, 200.0, 134.0, 79.0, -185.0, 2.0, -97.0, 68.0, 200.0, -9.0, -262.0, -31.0, -163.0, 200.0, -31.0, 200.0, -20.0, 134.0, 200.0, -119.0, 112.0, 90.0, 200.0, 200.0, 200.0, 200.0, 79.0, -240.0, 200.0, -383.0, 123.0, 79.0, 68.0, 189.0, 200.0, 101.0, -361.0, 189.0, 123.0, 24.0, 90.0, 112.0, 145.0, 79.0, 200.0, 79.0, -306.0, -339.0, 123.0, 200.0, 200.0, 112.0, -9.0, 57.0, 156.0, 79.0, 145.0, 189.0, -449.0, 200.0, 200.0, 35.0, 200.0, 24.0, 200.0, -284.0, -889.0, -867.0, 200.0, -196.0, 35.0, 200.0, 200.0, 200.0, 178.0, 46.0, 200.0, 68.0, -196.0, 200.0, 145.0, -317.0, 101.0, -207.0, 200.0, 123.0, -405.0, 200.0, 156.0, 178.0, 178.0, 57.0, 35.0, -130.0, 200.0, -31.0, -97.0, -405.0, -174.0, 189.0, 189.0, 200.0, 79.0, 178.0, 200.0, 68.0, 200.0, 200.0, 189.0, 200.0, 200.0, -163.0, 68.0, 167.0, -1571.0, -1417.0, -1076.0, -240.0, 200.0, 112.0, 200.0, 112.0, -625.0, -152.0, 189.0, -86.0, -702.0, -405.0, -97.0, 2.0, -229.0, 145.0, 35.0, 145.0, -482.0, 200.0, -328.0, 112.0, 200.0, 101.0, -1252.0, 200.0, 90.0, 134.0, 167.0, -405.0, 189.0, 13.0, 200.0, 24.0, 145.0, 200.0, 134.0, 46.0, -427.0, 79.0, -108.0, -328.0, -9.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 167.0, 57.0, 90.0, 68.0, 90.0, 13.0, 200.0, 57.0, 200.0, -31.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 35.0, 200.0, -64.0, -515.0, -196.0, 90.0, -812.0, -9.0, -735.0, 90.0, 24.0, 200.0, 178.0, -97.0, 35.0, 134.0, 46.0, 35.0, 68.0, -86.0, 200.0, 200.0, 90.0, -1186.0, 200.0, 46.0, -9.0, -64.0, -31.0, -97.0, -53.0, 200.0, 35.0, -163.0, -31.0, 200.0, -482.0, -97.0, -218.0, -207.0, -218.0], "policy_predator_policy_reward": [0.0, 205.0, 0.0, 25.0, 35.0, 255.0, 105.0, 110.0, 200.0, 0.0, 270.0, 0.0, 35.0, 430.0, 75.0, 45.0, 60.0, 65.0, 0.0, 95.0, 95.0, 55.0, 20.0, 20.0, 0.0, 30.0, 120.0, 115.0, 75.0, 100.0, 605.0, 340.0, 140.0, 115.0, 130.0, 135.0, 55.0, 195.0, 35.0, 75.0, 70.0, 35.0, 280.0, 100.0, 160.0, 0.0, 80.0, 90.0, 195.0, 190.0, 210.0, 35.0, 10.0, 30.0, 340.0, 680.0, 215.0, 995.0, 180.0, 100.0, 190.0, 160.0, 50.0, 345.0, 200.0, 370.0, 120.0, 40.0, 55.0, 155.0, 145.0, 205.0, 365.0, 265.0, 120.0, 40.0, 105.0, 205.0, 85.0, 175.0, 40.0, 60.0, 80.0, 60.0, 315.0, 145.0, 40.0, 150.0, 45.0, 0.0, 15.0, 0.0, 100.0, 125.0, 85.0, 90.0, 0.0, 50.0, 0.0, 0.0, 55.0, 0.0, 270.0, 0.0, 0.0, 0.0, 95.0, 40.0, 0.0, 45.0, 5.0, 115.0, 115.0, 170.0, 80.0, 10.0, 70.0, 0.0, 30.0, 50.0, 105.0, 245.0, 55.0, 35.0, 30.0, 30.0, 80.0, 95.0, 55.0, 75.0, 0.0, 25.0, 65.0, 215.0, 165.0, 75.0, 45.0, 0.0, 190.0, 185.0, 190.0, 495.0, 0.0, 135.0, 0.0, 185.0, 70.0, 0.0, 10.0, 0.0, 35.0, 40.0, 85.0, 160.0, 135.0, 0.0, 225.0, 220.0, 140.0, 255.0, 160.0, 95.0, 0.0, 20.0, 0.0, 80.0, 0.0, 105.0, 85.0, 100.0, 85.0, 75.0, 255.0, 100.0, 0.0, 0.0, 5.0, 0.0, 0.0, 65.0, 0.0, 55.0, 10.0, 0.0, 5.0, 0.0, 60.0, 0.0, 165.0, 140.0, 0.0, 950.0, 100.0, 40.0, 120.0, 205.0, 390.0, 70.0, 100.0, 130.0, 80.0, 130.0, 415.0, 0.0, 240.0, 40.0, 145.0, 180.0, 340.0, 30.0, 10.0, 40.0, 240.0, 545.0, 580.0, 605.0, 30.0, 0.0, 50.0, 275.0, 45.0, 95.0, 0.0, 85.0, 0.0, 25.0, 30.0, 0.0, 0.0, 85.0, 325.0, 205.0, 105.0, 170.0, 50.0, 35.0, 55.0, 0.0, 0.0, 0.0, 50.0, 65.0, 0.0, 40.0, 50.0, 85.0, 65.0, 25.0, 5.0, 25.0, 105.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 70.0, 55.0, 320.0, 195.0, 275.0, 380.0, 390.0, 160.0, 265.0, 355.0, 420.0, 10.0, 125.0, 135.0, 110.0, 30.0, 0.0, 120.0, 0.0, 120.0, 0.0, 50.0, 35.0, 145.0, 435.0, 230.0, 130.0, 100.0, 110.0, 135.0, 95.0, 40.0, 75.0, 165.0, 105.0, 280.0, 290.0, 220.0, 0.0, 285.0, 145.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9523309344390989, "mean_inference_ms": 1.6049164885208893, "mean_action_processing_ms": 0.36375073826708276, "mean_env_wait_ms": 0.25478052309894755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043305158615112305, "StateBufferConnector_ms": 0.004046440124511719, "ViewRequirementAgentConnector_ms": 0.14474928379058838}, "num_episodes": 22, "episode_return_max": 779.0, "episode_return_min": -4054.0, "episode_return_mean": 222.89, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.5232702667992, "num_env_steps_trained_throughput_per_sec": 55.5232702667992, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 71689.922, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71689.876, "sample_time_ms": 1363.309, "learn_time_ms": 70308.813, "learn_throughput": 56.892, "synch_weights_time_ms": 13.29}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 85, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-11-35", "timestamp": 1723493495, "time_this_iter_s": 72.10020804405212, "time_total_s": 6898.721226453781, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b21db550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6898.721226453781, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 21.660784313725497, "ram_util_percent": 82.97450980392156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5046791526019996, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2437180311544567, "policy_loss": -0.00492093153578619, "vf_loss": 1.2481438977287171, "vf_explained_var": -1.1326848192417875e-05, "kl": 0.006599953922533662, "entropy": 0.5796507321773692, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 241110.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.843033574828019, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4327756994529397, "policy_loss": -0.01960426466539502, "vf_loss": 1.4514169948003817, "vf_explained_var": 0.03294896272057337, "kl": 0.009629699472104342, "entropy": 0.976419534433818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 241110.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": 779.0, "episode_reward_min": -4054.0, "episode_reward_mean": 214.44, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1824.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -49.18666666666667, "predator_policy": 120.66666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1652.0, -4054.0, 494.0, 646.0, 342.0, 159.0, -322.0, 466.0, 196.0, 371.0, 198.0, 201.0, 429.0, 493.0, 540.0, 534.0, -153.0, 405.0, 540.0, 351.0, 386.0, 504.0, -161.0, 618.0, 390.0, 480.0, 385.0, 555.0, 505.0, -926.0, 294.0, 588.0, 474.0, 444.0, 162.0, 428.0, 554.0, 455.0, 309.0, -246.0, 583.0, 522.0, 533.0, 594.0, 297.0, -2974.0, 332.0, 352.0, 261.0, -659.0, 343.0, 248.0, 274.0, 779.0, 504.0, 366.0, 322.0, 534.0, 108.0, 35.0, 487.0, 600.0, 429.0, 346.0, 552.0, 444.0, 600.0, 600.0, 488.0, 15.0, 199.0, 419.0, 551.0, 355.0, 257.0, 575.0, -130.0, 236.0, 320.0, 186.0, 411.0, -213.0, -345.0, 130.0, 421.0, -869.0, 594.0, 638.0, 395.0, 310.0, 461.0, 600.0, 540.0, 409.0, 21.0, 593.0, 418.0, -891.0, 91.0, 465.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-922.0, -1021.0, -944.0, -1747.0, -1824.0, -1758.0, -306.0, 200.0, 200.0, 200.0, 200.0, -669.0, -9.0, 200.0, -64.0, -229.0, -31.0, -86.0, -416.0, -394.0, -262.0, -218.0, 200.0, 134.0, 79.0, -185.0, 2.0, -97.0, 68.0, 200.0, -9.0, -262.0, -31.0, -163.0, 200.0, -31.0, 200.0, -20.0, 134.0, 200.0, -119.0, 112.0, 90.0, 200.0, 200.0, 200.0, 200.0, 79.0, -240.0, 200.0, -383.0, 123.0, 79.0, 68.0, 189.0, 200.0, 101.0, -361.0, 189.0, 123.0, 24.0, 90.0, 112.0, 145.0, 79.0, 200.0, 79.0, -306.0, -339.0, 123.0, 200.0, 200.0, 112.0, -9.0, 57.0, 156.0, 79.0, 145.0, 189.0, -449.0, 200.0, 200.0, 35.0, 200.0, 24.0, 200.0, -284.0, -889.0, -867.0, 200.0, -196.0, 35.0, 200.0, 200.0, 200.0, 178.0, 46.0, 200.0, 68.0, -196.0, 200.0, 145.0, -317.0, 101.0, -207.0, 200.0, 123.0, -405.0, 200.0, 156.0, 178.0, 178.0, 57.0, 35.0, -130.0, 200.0, -31.0, -97.0, -405.0, -174.0, 189.0, 189.0, 200.0, 79.0, 178.0, 200.0, 68.0, 200.0, 200.0, 189.0, 200.0, 200.0, -163.0, 68.0, 167.0, -1571.0, -1417.0, -1076.0, -240.0, 200.0, 112.0, 200.0, 112.0, -625.0, -152.0, 189.0, -86.0, -702.0, -405.0, -97.0, 2.0, -229.0, 145.0, 35.0, 145.0, -482.0, 200.0, -328.0, 112.0, 200.0, 101.0, -1252.0, 200.0, 90.0, 134.0, 167.0, -405.0, 189.0, 13.0, 200.0, 24.0, 145.0, 200.0, 134.0, 46.0, -427.0, 79.0, -108.0, -328.0, -9.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 167.0, 57.0, 90.0, 68.0, 90.0, 13.0, 200.0, 57.0, 200.0, -31.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 35.0, 200.0, -64.0, -515.0, -196.0, 90.0, -812.0, -9.0, -735.0, 90.0, 24.0, 200.0, 178.0, -97.0, 35.0, 134.0, 46.0, 35.0, 68.0, -86.0, 200.0, 200.0, 90.0, -1186.0, 200.0, 46.0, -9.0, -64.0, -31.0, -97.0, -53.0, 200.0, 35.0, -163.0, -31.0, 200.0, -482.0, -97.0, -218.0, -207.0, -218.0, -64.0, -1032.0, -64.0, -174.0, 68.0, 46.0, 200.0, 90.0, -9.0, -900.0, -581.0, 57.0, 200.0, 189.0, 200.0, 200.0, -416.0, 134.0, 200.0, 101.0, -31.0, -383.0, -262.0, 200.0, -9.0, 200.0, -240.0, 200.0, 200.0, 200.0, 101.0, 189.0, 200.0, 178.0, -394.0, 145.0, 13.0, -328.0, -284.0, 68.0, -614.0, 189.0, 156.0, 79.0, 13.0, -603.0, -977.0, -86.0, -207.0, 200.0, -317.0, 134.0, 68.0, 178.0], "policy_predator_policy_reward": [340.0, 680.0, 215.0, 995.0, 180.0, 100.0, 190.0, 160.0, 50.0, 345.0, 200.0, 370.0, 120.0, 40.0, 55.0, 155.0, 145.0, 205.0, 365.0, 265.0, 120.0, 40.0, 105.0, 205.0, 85.0, 175.0, 40.0, 60.0, 80.0, 60.0, 315.0, 145.0, 40.0, 150.0, 45.0, 0.0, 15.0, 0.0, 100.0, 125.0, 85.0, 90.0, 0.0, 50.0, 0.0, 0.0, 55.0, 0.0, 270.0, 0.0, 0.0, 0.0, 95.0, 40.0, 0.0, 45.0, 5.0, 115.0, 115.0, 170.0, 80.0, 10.0, 70.0, 0.0, 30.0, 50.0, 105.0, 245.0, 55.0, 35.0, 30.0, 30.0, 80.0, 95.0, 55.0, 75.0, 0.0, 25.0, 65.0, 215.0, 165.0, 75.0, 45.0, 0.0, 190.0, 185.0, 190.0, 495.0, 0.0, 135.0, 0.0, 185.0, 70.0, 0.0, 10.0, 0.0, 35.0, 40.0, 85.0, 160.0, 135.0, 0.0, 225.0, 220.0, 140.0, 255.0, 160.0, 95.0, 0.0, 20.0, 0.0, 80.0, 0.0, 105.0, 85.0, 100.0, 85.0, 75.0, 255.0, 100.0, 0.0, 0.0, 5.0, 0.0, 0.0, 65.0, 0.0, 55.0, 10.0, 0.0, 5.0, 0.0, 60.0, 0.0, 165.0, 140.0, 0.0, 950.0, 100.0, 40.0, 120.0, 205.0, 390.0, 70.0, 100.0, 130.0, 80.0, 130.0, 415.0, 0.0, 240.0, 40.0, 145.0, 180.0, 340.0, 30.0, 10.0, 40.0, 240.0, 545.0, 580.0, 605.0, 30.0, 0.0, 50.0, 275.0, 45.0, 95.0, 0.0, 85.0, 0.0, 25.0, 30.0, 0.0, 0.0, 85.0, 325.0, 205.0, 105.0, 170.0, 50.0, 35.0, 55.0, 0.0, 0.0, 0.0, 50.0, 65.0, 0.0, 40.0, 50.0, 85.0, 65.0, 25.0, 5.0, 25.0, 105.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 70.0, 55.0, 320.0, 195.0, 275.0, 380.0, 390.0, 160.0, 265.0, 355.0, 420.0, 10.0, 125.0, 135.0, 110.0, 30.0, 0.0, 120.0, 0.0, 120.0, 0.0, 50.0, 35.0, 145.0, 435.0, 230.0, 130.0, 100.0, 110.0, 135.0, 95.0, 40.0, 75.0, 165.0, 105.0, 280.0, 290.0, 220.0, 0.0, 285.0, 145.0, 85.0, 130.0, 600.0, 0.0, 190.0, 0.0, 25.0, 40.0, 75.0, 10.0, 20.0, 525.0, 0.0, 0.0, 5.0, 235.0, 220.0, 265.0, 60.0, 65.0, 0.0, 245.0, 245.0, 265.0, 185.0, 160.0, 165.0, 0.0, 0.0, 0.0, 0.0, 30.0, 20.0, 25.0, 215.0, 240.0, 130.0, 250.0, 240.0, 325.0, 245.0, 380.0, 35.0, 50.0, 85.0, 125.0, 590.0, 60.0, 300.0, 115.0, 0.0, 10.0, 45.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.951501823429823, "mean_inference_ms": 1.60296218918486, "mean_action_processing_ms": 0.36342960593102147, "mean_env_wait_ms": 0.2545162652927763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041086673736572266, "StateBufferConnector_ms": 0.003819108009338379, "ViewRequirementAgentConnector_ms": 0.13747942447662354}, "num_episodes": 18, "episode_return_max": 779.0, "episode_return_min": -4054.0, "episode_return_mean": 214.44, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.57275000890951, "num_env_steps_trained_throughput_per_sec": 55.57275000890951, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 71763.79, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71763.744, "sample_time_ms": 1370.657, "learn_time_ms": 70375.679, "learn_throughput": 56.838, "synch_weights_time_ms": 13.425}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 86, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-12-47", "timestamp": 1723493567, "time_this_iter_s": 72.02873015403748, "time_total_s": 6970.749956607819, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b21bbca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 6970.749956607819, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 23.08823529411765, "ram_util_percent": 82.93529411764708}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4892968591857463, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2202779763133813, "policy_loss": -0.00762003821598247, "vf_loss": 1.2273937019790317, "vf_explained_var": -1.0068006549321169e-05, "kl": 0.006723322589248345, "entropy": 0.593989199442221, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 243930.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.400059917315524, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7978106411002206, "policy_loss": -0.020576528850975877, "vf_loss": 1.81740160882473, "vf_explained_var": 0.015719476490156026, "kl": 0.009855612751279625, "entropy": 0.9590779282311176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 243930.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "env_runners": {"episode_reward_max": 779.0, "episode_reward_min": -3389.0, "episode_reward_mean": 238.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1802.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -30.633333333333333, "predator_policy": 110.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [618.0, 390.0, 480.0, 385.0, 555.0, 505.0, -926.0, 294.0, 588.0, 474.0, 444.0, 162.0, 428.0, 554.0, 455.0, 309.0, -246.0, 583.0, 522.0, 533.0, 594.0, 297.0, -2974.0, 332.0, 352.0, 261.0, -659.0, 343.0, 248.0, 274.0, 779.0, 504.0, 366.0, 322.0, 534.0, 108.0, 35.0, 487.0, 600.0, 429.0, 346.0, 552.0, 444.0, 600.0, 600.0, 488.0, 15.0, 199.0, 419.0, 551.0, 355.0, 257.0, 575.0, -130.0, 236.0, 320.0, 186.0, 411.0, -213.0, -345.0, 130.0, 421.0, -869.0, 594.0, 638.0, 395.0, 310.0, 461.0, 600.0, 540.0, 409.0, 21.0, 593.0, 418.0, -891.0, 91.0, 465.0, 450.0, 174.0, 505.0, 294.0, 25.0, 356.0, 574.0, -1560.0, 425.0, 479.0, -512.0, 566.0, 600.0, 600.0, 600.0, -3389.0, 600.0, 505.0, 493.0, 328.0, 400.0, 302.0, 479.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [123.0, 200.0, 200.0, 112.0, -9.0, 57.0, 156.0, 79.0, 145.0, 189.0, -449.0, 200.0, 200.0, 35.0, 200.0, 24.0, 200.0, -284.0, -889.0, -867.0, 200.0, -196.0, 35.0, 200.0, 200.0, 200.0, 178.0, 46.0, 200.0, 68.0, -196.0, 200.0, 145.0, -317.0, 101.0, -207.0, 200.0, 123.0, -405.0, 200.0, 156.0, 178.0, 178.0, 57.0, 35.0, -130.0, 200.0, -31.0, -97.0, -405.0, -174.0, 189.0, 189.0, 200.0, 79.0, 178.0, 200.0, 68.0, 200.0, 200.0, 189.0, 200.0, 200.0, -163.0, 68.0, 167.0, -1571.0, -1417.0, -1076.0, -240.0, 200.0, 112.0, 200.0, 112.0, -625.0, -152.0, 189.0, -86.0, -702.0, -405.0, -97.0, 2.0, -229.0, 145.0, 35.0, 145.0, -482.0, 200.0, -328.0, 112.0, 200.0, 101.0, -1252.0, 200.0, 90.0, 134.0, 167.0, -405.0, 189.0, 13.0, 200.0, 24.0, 145.0, 200.0, 134.0, 46.0, -427.0, 79.0, -108.0, -328.0, -9.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 167.0, 57.0, 90.0, 68.0, 90.0, 13.0, 200.0, 57.0, 200.0, -31.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 35.0, 200.0, -64.0, -515.0, -196.0, 90.0, -812.0, -9.0, -735.0, 90.0, 24.0, 200.0, 178.0, -97.0, 35.0, 134.0, 46.0, 35.0, 68.0, -86.0, 200.0, 200.0, 90.0, -1186.0, 200.0, 46.0, -9.0, -64.0, -31.0, -97.0, -53.0, 200.0, 35.0, -163.0, -31.0, 200.0, -482.0, -97.0, -218.0, -207.0, -218.0, -64.0, -1032.0, -64.0, -174.0, 68.0, 46.0, 200.0, 90.0, -9.0, -900.0, -581.0, 57.0, 200.0, 189.0, 200.0, 200.0, -416.0, 134.0, 200.0, 101.0, -31.0, -383.0, -262.0, 200.0, -9.0, 200.0, -240.0, 200.0, 200.0, 200.0, 101.0, 189.0, 200.0, 178.0, -394.0, 145.0, 13.0, -328.0, -284.0, 68.0, -614.0, 189.0, 156.0, 79.0, 13.0, -603.0, -977.0, -86.0, -207.0, 200.0, -317.0, 134.0, 68.0, 178.0, 200.0, -75.0, 200.0, 112.0, 112.0, -350.0, 46.0, 112.0, 167.0, 134.0, 79.0, -174.0, -405.0, 68.0, -53.0, 178.0, 90.0, -97.0, 200.0, 200.0, 24.0, -636.0, -966.0, -658.0, 145.0, 123.0, 112.0, 200.0, 145.0, 79.0, -691.0, -185.0, -801.0, 200.0, 178.0, 178.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1802.0, -1417.0, -1230.0, 200.0, 200.0, 200.0, 112.0, 200.0, 13.0, 200.0, 24.0, 189.0, -42.0, 57.0, 123.0, 101.0, 101.0, -42.0, -141.0, 200.0, 13.0, 112.0, 57.0, 200.0], "policy_predator_policy_reward": [35.0, 30.0, 30.0, 80.0, 95.0, 55.0, 75.0, 0.0, 25.0, 65.0, 215.0, 165.0, 75.0, 45.0, 0.0, 190.0, 185.0, 190.0, 495.0, 0.0, 135.0, 0.0, 185.0, 70.0, 0.0, 10.0, 0.0, 35.0, 40.0, 85.0, 160.0, 135.0, 0.0, 225.0, 220.0, 140.0, 255.0, 160.0, 95.0, 0.0, 20.0, 0.0, 80.0, 0.0, 105.0, 85.0, 100.0, 85.0, 75.0, 255.0, 100.0, 0.0, 0.0, 5.0, 0.0, 0.0, 65.0, 0.0, 55.0, 10.0, 0.0, 5.0, 0.0, 60.0, 0.0, 165.0, 140.0, 0.0, 950.0, 100.0, 40.0, 120.0, 205.0, 390.0, 70.0, 100.0, 130.0, 80.0, 130.0, 415.0, 0.0, 240.0, 40.0, 145.0, 180.0, 340.0, 30.0, 10.0, 40.0, 240.0, 545.0, 580.0, 605.0, 30.0, 0.0, 50.0, 275.0, 45.0, 95.0, 0.0, 85.0, 0.0, 25.0, 30.0, 0.0, 0.0, 85.0, 325.0, 205.0, 105.0, 170.0, 50.0, 35.0, 55.0, 0.0, 0.0, 0.0, 50.0, 65.0, 0.0, 40.0, 50.0, 85.0, 65.0, 25.0, 5.0, 25.0, 105.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 70.0, 55.0, 320.0, 195.0, 275.0, 380.0, 390.0, 160.0, 265.0, 355.0, 420.0, 10.0, 125.0, 135.0, 110.0, 30.0, 0.0, 120.0, 0.0, 120.0, 0.0, 50.0, 35.0, 145.0, 435.0, 230.0, 130.0, 100.0, 110.0, 135.0, 95.0, 40.0, 75.0, 165.0, 105.0, 280.0, 290.0, 220.0, 0.0, 285.0, 145.0, 85.0, 130.0, 600.0, 0.0, 190.0, 0.0, 25.0, 40.0, 75.0, 10.0, 20.0, 525.0, 0.0, 0.0, 5.0, 235.0, 220.0, 265.0, 60.0, 65.0, 0.0, 245.0, 245.0, 265.0, 185.0, 160.0, 165.0, 0.0, 0.0, 0.0, 0.0, 30.0, 20.0, 25.0, 215.0, 240.0, 130.0, 250.0, 240.0, 325.0, 245.0, 380.0, 35.0, 50.0, 85.0, 125.0, 590.0, 60.0, 300.0, 115.0, 0.0, 10.0, 45.0, 30.0, 125.0, 0.0, 0.0, 10.0, 250.0, 40.0, 65.0, 70.0, 45.0, 30.0, 225.0, 0.0, 250.0, 115.0, 50.0, 0.0, 135.0, 50.0, 80.0, 30.0, 40.0, 635.0, 45.0, 20.0, 45.0, 0.0, 0.0, 0.0, 55.0, 0.0, 425.0, 385.0, 355.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 995.0, 0.0, 65.0, 0.0, 0.0, 0.0, 65.0, 80.0, 35.0, 80.0, 0.0, 0.0, 95.0, 95.0, 0.0, 80.0, 85.0, 75.0, 95.0, 95.0, 40.0, 35.0, 75.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.950493413371604, "mean_inference_ms": 1.6006904489507503, "mean_action_processing_ms": 0.3630322250811981, "mean_env_wait_ms": 0.25418937014167986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004103541374206543, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.13821852207183838}, "num_episodes": 23, "episode_return_max": 779.0, "episode_return_min": -3389.0, "episode_return_mean": 238.25, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.96048715463519, "num_env_steps_trained_throughput_per_sec": 55.96048715463519, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 2088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2088000, "timers": {"training_iteration_time_ms": 71842.183, "restore_workers_time_ms": 0.015, "training_step_time_ms": 71842.136, "sample_time_ms": 1366.842, "learn_time_ms": 70456.723, "learn_throughput": 56.772, "synch_weights_time_ms": 13.829}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 2088000, "num_agent_steps_trained": 2088000}, "done": false, "training_iteration": 87, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-13-59", "timestamp": 1723493639, "time_this_iter_s": 71.51234316825867, "time_total_s": 7042.262299776077, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b21db8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7042.262299776077, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 18.769306930693073, "ram_util_percent": 82.37425742574258}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3190078230614357, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1793542889204431, "policy_loss": -0.006619832168022792, "vf_loss": 1.1854869033216584, "vf_explained_var": -6.072698755467192e-07, "kl": 0.0064954084630263476, "entropy": 0.5779544921525827, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 246750.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.53429654124358, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.449125898370506, "policy_loss": -0.02160165596114313, "vf_loss": 1.4699354265809905, "vf_explained_var": 0.017450549437644635, "kl": 0.007921281651053054, "entropy": 0.955677055995515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 246750.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 779.0, "episode_reward_min": -3635.0, "episode_reward_mean": 196.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1802.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -44.45666666666666, "predator_policy": 109.96666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [522.0, 533.0, 594.0, 297.0, -2974.0, 332.0, 352.0, 261.0, -659.0, 343.0, 248.0, 274.0, 779.0, 504.0, 366.0, 322.0, 534.0, 108.0, 35.0, 487.0, 600.0, 429.0, 346.0, 552.0, 444.0, 600.0, 600.0, 488.0, 15.0, 199.0, 419.0, 551.0, 355.0, 257.0, 575.0, -130.0, 236.0, 320.0, 186.0, 411.0, -213.0, -345.0, 130.0, 421.0, -869.0, 594.0, 638.0, 395.0, 310.0, 461.0, 600.0, 540.0, 409.0, 21.0, 593.0, 418.0, -891.0, 91.0, 465.0, 450.0, 174.0, 505.0, 294.0, 25.0, 356.0, 574.0, -1560.0, 425.0, 479.0, -512.0, 566.0, 600.0, 600.0, 600.0, -3389.0, 600.0, 505.0, 493.0, 328.0, 400.0, 302.0, 479.0, 570.0, -532.0, -915.0, 396.0, 600.0, 350.0, 522.0, -3635.0, 565.0, 545.0, 379.0, 330.0, 412.0, 593.0, 365.0, 495.0, 240.0, 600.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.0, 178.0, 200.0, 68.0, 200.0, 200.0, 189.0, 200.0, 200.0, -163.0, 68.0, 167.0, -1571.0, -1417.0, -1076.0, -240.0, 200.0, 112.0, 200.0, 112.0, -625.0, -152.0, 189.0, -86.0, -702.0, -405.0, -97.0, 2.0, -229.0, 145.0, 35.0, 145.0, -482.0, 200.0, -328.0, 112.0, 200.0, 101.0, -1252.0, 200.0, 90.0, 134.0, 167.0, -405.0, 189.0, 13.0, 200.0, 24.0, 145.0, 200.0, 134.0, 46.0, -427.0, 79.0, -108.0, -328.0, -9.0, 200.0, 200.0, -53.0, 200.0, 200.0, 200.0, 167.0, 57.0, 90.0, 68.0, 90.0, 13.0, 200.0, 57.0, 200.0, -31.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 35.0, 200.0, -64.0, -515.0, -196.0, 90.0, -812.0, -9.0, -735.0, 90.0, 24.0, 200.0, 178.0, -97.0, 35.0, 134.0, 46.0, 35.0, 68.0, -86.0, 200.0, 200.0, 90.0, -1186.0, 200.0, 46.0, -9.0, -64.0, -31.0, -97.0, -53.0, 200.0, 35.0, -163.0, -31.0, 200.0, -482.0, -97.0, -218.0, -207.0, -218.0, -64.0, -1032.0, -64.0, -174.0, 68.0, 46.0, 200.0, 90.0, -9.0, -900.0, -581.0, 57.0, 200.0, 189.0, 200.0, 200.0, -416.0, 134.0, 200.0, 101.0, -31.0, -383.0, -262.0, 200.0, -9.0, 200.0, -240.0, 200.0, 200.0, 200.0, 101.0, 189.0, 200.0, 178.0, -394.0, 145.0, 13.0, -328.0, -284.0, 68.0, -614.0, 189.0, 156.0, 79.0, 13.0, -603.0, -977.0, -86.0, -207.0, 200.0, -317.0, 134.0, 68.0, 178.0, 200.0, -75.0, 200.0, 112.0, 112.0, -350.0, 46.0, 112.0, 167.0, 134.0, 79.0, -174.0, -405.0, 68.0, -53.0, 178.0, 90.0, -97.0, 200.0, 200.0, 24.0, -636.0, -966.0, -658.0, 145.0, 123.0, 112.0, 200.0, 145.0, 79.0, -691.0, -185.0, -801.0, 200.0, 178.0, 178.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1802.0, -1417.0, -1230.0, 200.0, 200.0, 200.0, 112.0, 200.0, 13.0, 200.0, 24.0, 189.0, -42.0, 57.0, 123.0, 101.0, 101.0, -42.0, -141.0, 200.0, 13.0, 112.0, 57.0, 200.0, 167.0, 200.0, 178.0, -262.0, -262.0, -713.0, -339.0, -482.0, -614.0, -251.0, 2.0, 200.0, 200.0, 200.0, 200.0, 2.0, 178.0, -20.0, 167.0, 200.0, -20.0, -1736.0, -1692.0, -1417.0, 156.0, 189.0, 200.0, 200.0, 200.0, 90.0, 134.0, 112.0, -42.0, 200.0, -9.0, -86.0, -75.0, 57.0, 200.0, 123.0, 200.0, 200.0, 156.0, -163.0, 2.0, 200.0, 167.0, 68.0, 90.0, -130.0, -130.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 65.0, 0.0, 55.0, 10.0, 0.0, 5.0, 0.0, 60.0, 0.0, 165.0, 140.0, 0.0, 950.0, 100.0, 40.0, 120.0, 205.0, 390.0, 70.0, 100.0, 130.0, 80.0, 130.0, 415.0, 0.0, 240.0, 40.0, 145.0, 180.0, 340.0, 30.0, 10.0, 40.0, 240.0, 545.0, 580.0, 605.0, 30.0, 0.0, 50.0, 275.0, 45.0, 95.0, 0.0, 85.0, 0.0, 25.0, 30.0, 0.0, 0.0, 85.0, 325.0, 205.0, 105.0, 170.0, 50.0, 35.0, 55.0, 0.0, 0.0, 0.0, 50.0, 65.0, 0.0, 40.0, 50.0, 85.0, 65.0, 25.0, 5.0, 25.0, 105.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 70.0, 55.0, 320.0, 195.0, 275.0, 380.0, 390.0, 160.0, 265.0, 355.0, 420.0, 10.0, 125.0, 135.0, 110.0, 30.0, 0.0, 120.0, 0.0, 120.0, 0.0, 50.0, 35.0, 145.0, 435.0, 230.0, 130.0, 100.0, 110.0, 135.0, 95.0, 40.0, 75.0, 165.0, 105.0, 280.0, 290.0, 220.0, 0.0, 285.0, 145.0, 85.0, 130.0, 600.0, 0.0, 190.0, 0.0, 25.0, 40.0, 75.0, 10.0, 20.0, 525.0, 0.0, 0.0, 5.0, 235.0, 220.0, 265.0, 60.0, 65.0, 0.0, 245.0, 245.0, 265.0, 185.0, 160.0, 165.0, 0.0, 0.0, 0.0, 0.0, 30.0, 20.0, 25.0, 215.0, 240.0, 130.0, 250.0, 240.0, 325.0, 245.0, 380.0, 35.0, 50.0, 85.0, 125.0, 590.0, 60.0, 300.0, 115.0, 0.0, 10.0, 45.0, 30.0, 125.0, 0.0, 0.0, 10.0, 250.0, 40.0, 65.0, 70.0, 45.0, 30.0, 225.0, 0.0, 250.0, 115.0, 50.0, 0.0, 135.0, 50.0, 80.0, 30.0, 40.0, 635.0, 45.0, 20.0, 45.0, 0.0, 0.0, 0.0, 55.0, 0.0, 425.0, 385.0, 355.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 995.0, 0.0, 65.0, 0.0, 0.0, 0.0, 65.0, 80.0, 35.0, 80.0, 0.0, 0.0, 95.0, 95.0, 0.0, 80.0, 85.0, 75.0, 95.0, 95.0, 40.0, 35.0, 75.0, 0.0, 0.0, 0.0, 25.0, 415.0, 210.0, 80.0, 35.0, 0.0, 485.0, 170.0, 165.0, 110.0, 0.0, 0.0, 0.0, 100.0, 10.0, 80.0, 0.0, 75.0, 100.0, 1000.0, 160.0, 50.0, 20.0, 0.0, 0.0, 5.0, 0.0, 50.0, 80.0, 0.0, 95.0, 130.0, 50.0, 45.0, 95.0, 90.0, 45.0, 35.0, 15.0, 20.0, 115.0, 105.0, 150.0, 60.0, 0.0, 0.0, 130.0, 150.0, 130.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9487968667429237, "mean_inference_ms": 1.5976106555028564, "mean_action_processing_ms": 0.36249396196924755, "mean_env_wait_ms": 0.2537023285064416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003993391990661621, "StateBufferConnector_ms": 0.0038553476333618164, "ViewRequirementAgentConnector_ms": 0.128653883934021}, "num_episodes": 18, "episode_return_max": 779.0, "episode_return_min": -3635.0, "episode_return_mean": 196.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.37003122396527, "num_env_steps_trained_throughput_per_sec": 56.37003122396527, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 71812.467, "restore_workers_time_ms": 0.015, "training_step_time_ms": 71812.42, "sample_time_ms": 1365.839, "learn_time_ms": 70428.032, "learn_throughput": 56.796, "synch_weights_time_ms": 13.713}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 88, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-15-10", "timestamp": 1723493710, "time_this_iter_s": 70.99665594100952, "time_total_s": 7113.258955717087, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32f69ca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7113.258955717087, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 18.73267326732673, "ram_util_percent": 81.92871287128715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4392976762449488, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8924911338175443, "policy_loss": -0.006820554613360329, "vf_loss": 1.8984467696847644, "vf_explained_var": -7.409639392338746e-06, "kl": 0.011531396667533639, "entropy": 0.6088358794121032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 249570.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.679463098446528, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5881416711507115, "policy_loss": -0.021030825716220437, "vf_loss": 1.6082786012625863, "vf_explained_var": 0.0181132491387374, "kl": 0.008938965682829505, "entropy": 0.97597503218245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 249570.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "env_runners": {"episode_reward_max": 638.0, "episode_reward_min": -3635.0, "episode_reward_mean": 179.88, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -54.54, "predator_policy": 114.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [346.0, 552.0, 444.0, 600.0, 600.0, 488.0, 15.0, 199.0, 419.0, 551.0, 355.0, 257.0, 575.0, -130.0, 236.0, 320.0, 186.0, 411.0, -213.0, -345.0, 130.0, 421.0, -869.0, 594.0, 638.0, 395.0, 310.0, 461.0, 600.0, 540.0, 409.0, 21.0, 593.0, 418.0, -891.0, 91.0, 465.0, 450.0, 174.0, 505.0, 294.0, 25.0, 356.0, 574.0, -1560.0, 425.0, 479.0, -512.0, 566.0, 600.0, 600.0, 600.0, -3389.0, 600.0, 505.0, 493.0, 328.0, 400.0, 302.0, 479.0, 570.0, -532.0, -915.0, 396.0, 600.0, 350.0, 522.0, -3635.0, 565.0, 545.0, 379.0, 330.0, 412.0, 593.0, 365.0, 495.0, 240.0, 600.0, -526.0, -413.0, 274.0, -240.0, 124.0, 417.0, 264.0, -138.0, 504.0, 588.0, -600.0, 307.0, 467.0, -360.0, 199.0, 492.0, 370.0, 126.0, 121.0, 66.0, 251.0, 329.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [68.0, 90.0, 13.0, 200.0, 57.0, 200.0, -31.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 68.0, 35.0, 200.0, -64.0, -515.0, -196.0, 90.0, -812.0, -9.0, -735.0, 90.0, 24.0, 200.0, 178.0, -97.0, 35.0, 134.0, 46.0, 35.0, 68.0, -86.0, 200.0, 200.0, 90.0, -1186.0, 200.0, 46.0, -9.0, -64.0, -31.0, -97.0, -53.0, 200.0, 35.0, -163.0, -31.0, 200.0, -482.0, -97.0, -218.0, -207.0, -218.0, -64.0, -1032.0, -64.0, -174.0, 68.0, 46.0, 200.0, 90.0, -9.0, -900.0, -581.0, 57.0, 200.0, 189.0, 200.0, 200.0, -416.0, 134.0, 200.0, 101.0, -31.0, -383.0, -262.0, 200.0, -9.0, 200.0, -240.0, 200.0, 200.0, 200.0, 101.0, 189.0, 200.0, 178.0, -394.0, 145.0, 13.0, -328.0, -284.0, 68.0, -614.0, 189.0, 156.0, 79.0, 13.0, -603.0, -977.0, -86.0, -207.0, 200.0, -317.0, 134.0, 68.0, 178.0, 200.0, -75.0, 200.0, 112.0, 112.0, -350.0, 46.0, 112.0, 167.0, 134.0, 79.0, -174.0, -405.0, 68.0, -53.0, 178.0, 90.0, -97.0, 200.0, 200.0, 24.0, -636.0, -966.0, -658.0, 145.0, 123.0, 112.0, 200.0, 145.0, 79.0, -691.0, -185.0, -801.0, 200.0, 178.0, 178.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1802.0, -1417.0, -1230.0, 200.0, 200.0, 200.0, 112.0, 200.0, 13.0, 200.0, 24.0, 189.0, -42.0, 57.0, 123.0, 101.0, 101.0, -42.0, -141.0, 200.0, 13.0, 112.0, 57.0, 200.0, 167.0, 200.0, 178.0, -262.0, -262.0, -713.0, -339.0, -482.0, -614.0, -251.0, 2.0, 200.0, 200.0, 200.0, 200.0, 2.0, 178.0, -20.0, 167.0, 200.0, -20.0, -1736.0, -1692.0, -1417.0, 156.0, 189.0, 200.0, 200.0, 200.0, 90.0, 134.0, 112.0, -42.0, 200.0, -9.0, -86.0, -75.0, 57.0, 200.0, 123.0, 200.0, 200.0, 156.0, -163.0, 2.0, 200.0, 167.0, 68.0, 90.0, -130.0, -130.0, 200.0, 200.0, 200.0, -372.0, -284.0, -570.0, -174.0, -471.0, -328.0, 134.0, 90.0, -350.0, -229.0, -262.0, -174.0, 200.0, -273.0, -328.0, -438.0, 200.0, 200.0, 90.0, -306.0, 200.0, -218.0, 2.0, -537.0, 200.0, 24.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, -2000.0, 200.0, -581.0, 123.0, 167.0, -20.0, 200.0, -383.0, -548.0, -394.0, 156.0, 57.0, -394.0, 2.0, 200.0, 200.0, 200.0, -97.0, 57.0, -207.0, -141.0, 79.0, 46.0, -196.0, -119.0, -372.0, -53.0, 46.0, 57.0, -53.0, -163.0, -196.0, 2.0, 178.0], "policy_predator_policy_reward": [40.0, 50.0, 85.0, 65.0, 25.0, 5.0, 25.0, 105.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 60.0, 70.0, 55.0, 320.0, 195.0, 275.0, 380.0, 390.0, 160.0, 265.0, 355.0, 420.0, 10.0, 125.0, 135.0, 110.0, 30.0, 0.0, 120.0, 0.0, 120.0, 0.0, 50.0, 35.0, 145.0, 435.0, 230.0, 130.0, 100.0, 110.0, 135.0, 95.0, 40.0, 75.0, 165.0, 105.0, 280.0, 290.0, 220.0, 0.0, 285.0, 145.0, 85.0, 130.0, 600.0, 0.0, 190.0, 0.0, 25.0, 40.0, 75.0, 10.0, 20.0, 525.0, 0.0, 0.0, 5.0, 235.0, 220.0, 265.0, 60.0, 65.0, 0.0, 245.0, 245.0, 265.0, 185.0, 160.0, 165.0, 0.0, 0.0, 0.0, 0.0, 30.0, 20.0, 25.0, 215.0, 240.0, 130.0, 250.0, 240.0, 325.0, 245.0, 380.0, 35.0, 50.0, 85.0, 125.0, 590.0, 60.0, 300.0, 115.0, 0.0, 10.0, 45.0, 30.0, 125.0, 0.0, 0.0, 10.0, 250.0, 40.0, 65.0, 70.0, 45.0, 30.0, 225.0, 0.0, 250.0, 115.0, 50.0, 0.0, 135.0, 50.0, 80.0, 30.0, 40.0, 635.0, 45.0, 20.0, 45.0, 0.0, 0.0, 0.0, 55.0, 0.0, 425.0, 385.0, 355.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 995.0, 0.0, 65.0, 0.0, 0.0, 0.0, 65.0, 80.0, 35.0, 80.0, 0.0, 0.0, 95.0, 95.0, 0.0, 80.0, 85.0, 75.0, 95.0, 95.0, 40.0, 35.0, 75.0, 0.0, 0.0, 0.0, 25.0, 415.0, 210.0, 80.0, 35.0, 0.0, 485.0, 170.0, 165.0, 110.0, 0.0, 0.0, 0.0, 100.0, 10.0, 80.0, 0.0, 75.0, 100.0, 1000.0, 160.0, 50.0, 20.0, 0.0, 0.0, 5.0, 0.0, 50.0, 80.0, 0.0, 95.0, 130.0, 50.0, 45.0, 95.0, 90.0, 45.0, 35.0, 15.0, 20.0, 115.0, 105.0, 150.0, 60.0, 0.0, 0.0, 130.0, 150.0, 130.0, 0.0, 0.0, 0.0, 335.0, 50.0, 315.0, 345.0, 115.0, 100.0, 45.0, 195.0, 160.0, 65.0, 30.0, 330.0, 325.0, 0.0, 200.0, 290.0, 165.0, 0.0, 75.0, 15.0, 190.0, 245.0, 255.0, 115.0, 0.0, 25.0, 55.0, 10.0, 0.0, 0.0, 0.0, 1000.0, 0.0, 200.0, 35.0, 330.0, 100.0, 15.0, 5.0, 330.0, 240.0, 395.0, 0.0, 330.0, 50.0, 90.0, 0.0, 0.0, 15.0, 135.0, 60.0, 215.0, 45.0, 135.0, 115.0, 130.0, 145.0, 115.0, 260.0, 70.0, 230.0, 65.0, 115.0, 155.0, 80.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9470538263950516, "mean_inference_ms": 1.5936124153855553, "mean_action_processing_ms": 0.3619491280852813, "mean_env_wait_ms": 0.25300648483034505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003955841064453125, "StateBufferConnector_ms": 0.0038341283798217773, "ViewRequirementAgentConnector_ms": 0.12518727779388428}, "num_episodes": 22, "episode_return_max": 638.0, "episode_return_min": -3635.0, "episode_return_mean": 179.88, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.4689263328029, "num_env_steps_trained_throughput_per_sec": 56.4689263328029, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 2136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2136000, "timers": {"training_iteration_time_ms": 71669.261, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71669.215, "sample_time_ms": 1347.611, "learn_time_ms": 70303.195, "learn_throughput": 56.896, "synch_weights_time_ms": 13.721}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 2136000, "num_agent_steps_trained": 2136000}, "done": false, "training_iteration": 89, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-16-21", "timestamp": 1723493781, "time_this_iter_s": 70.87900876998901, "time_total_s": 7184.137964487076, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b21db9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7184.137964487076, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 18.380000000000003, "ram_util_percent": 81.638}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5531223132995005, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4452893493023324, "policy_loss": -0.0070553711113513365, "vf_loss": 1.4516659642576326, "vf_explained_var": -3.0043044834272237e-05, "kl": 0.009049324181230355, "entropy": 0.5751132006235157, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 252390.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3432847232471965, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2325043595323326, "policy_loss": -0.026591664844139724, "vf_loss": 1.2581399764680694, "vf_explained_var": 0.022007990200468834, "kl": 0.00956047563241047, "entropy": 0.919263438214647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 252390.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 638.0, "episode_reward_min": -3635.0, "episode_reward_mean": 169.49, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -56.336666666666666, "predator_policy": 112.83333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-213.0, -345.0, 130.0, 421.0, -869.0, 594.0, 638.0, 395.0, 310.0, 461.0, 600.0, 540.0, 409.0, 21.0, 593.0, 418.0, -891.0, 91.0, 465.0, 450.0, 174.0, 505.0, 294.0, 25.0, 356.0, 574.0, -1560.0, 425.0, 479.0, -512.0, 566.0, 600.0, 600.0, 600.0, -3389.0, 600.0, 505.0, 493.0, 328.0, 400.0, 302.0, 479.0, 570.0, -532.0, -915.0, 396.0, 600.0, 350.0, 522.0, -3635.0, 565.0, 545.0, 379.0, 330.0, 412.0, 593.0, 365.0, 495.0, 240.0, 600.0, -526.0, -413.0, 274.0, -240.0, 124.0, 417.0, 264.0, -138.0, 504.0, 588.0, -600.0, 307.0, 467.0, -360.0, 199.0, 492.0, 370.0, 126.0, 121.0, 66.0, 251.0, 329.0, 589.0, 424.0, 600.0, 166.0, 343.0, 510.0, 459.0, 39.0, -785.0, 367.0, 531.0, 570.0, -4.0, 273.0, 134.0, 288.0, 440.0, 441.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-218.0, -207.0, -218.0, -64.0, -1032.0, -64.0, -174.0, 68.0, 46.0, 200.0, 90.0, -9.0, -900.0, -581.0, 57.0, 200.0, 189.0, 200.0, 200.0, -416.0, 134.0, 200.0, 101.0, -31.0, -383.0, -262.0, 200.0, -9.0, 200.0, -240.0, 200.0, 200.0, 200.0, 101.0, 189.0, 200.0, 178.0, -394.0, 145.0, 13.0, -328.0, -284.0, 68.0, -614.0, 189.0, 156.0, 79.0, 13.0, -603.0, -977.0, -86.0, -207.0, 200.0, -317.0, 134.0, 68.0, 178.0, 200.0, -75.0, 200.0, 112.0, 112.0, -350.0, 46.0, 112.0, 167.0, 134.0, 79.0, -174.0, -405.0, 68.0, -53.0, 178.0, 90.0, -97.0, 200.0, 200.0, 24.0, -636.0, -966.0, -658.0, 145.0, 123.0, 112.0, 200.0, 145.0, 79.0, -691.0, -185.0, -801.0, 200.0, 178.0, 178.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1802.0, -1417.0, -1230.0, 200.0, 200.0, 200.0, 112.0, 200.0, 13.0, 200.0, 24.0, 189.0, -42.0, 57.0, 123.0, 101.0, 101.0, -42.0, -141.0, 200.0, 13.0, 112.0, 57.0, 200.0, 167.0, 200.0, 178.0, -262.0, -262.0, -713.0, -339.0, -482.0, -614.0, -251.0, 2.0, 200.0, 200.0, 200.0, 200.0, 2.0, 178.0, -20.0, 167.0, 200.0, -20.0, -1736.0, -1692.0, -1417.0, 156.0, 189.0, 200.0, 200.0, 200.0, 90.0, 134.0, 112.0, -42.0, 200.0, -9.0, -86.0, -75.0, 57.0, 200.0, 123.0, 200.0, 200.0, 156.0, -163.0, 2.0, 200.0, 167.0, 68.0, 90.0, -130.0, -130.0, 200.0, 200.0, 200.0, -372.0, -284.0, -570.0, -174.0, -471.0, -328.0, 134.0, 90.0, -350.0, -229.0, -262.0, -174.0, 200.0, -273.0, -328.0, -438.0, 200.0, 200.0, 90.0, -306.0, 200.0, -218.0, 2.0, -537.0, 200.0, 24.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, -2000.0, 200.0, -581.0, 123.0, 167.0, -20.0, 200.0, -383.0, -548.0, -394.0, 156.0, 57.0, -394.0, 2.0, 200.0, 200.0, 200.0, -97.0, 57.0, -207.0, -141.0, 79.0, 46.0, -196.0, -119.0, -372.0, -53.0, 46.0, 57.0, -53.0, -163.0, -196.0, 2.0, 178.0, 200.0, 200.0, 134.0, 123.0, 145.0, -119.0, 200.0, 200.0, 200.0, -328.0, -394.0, -97.0, 200.0, -53.0, -9.0, 200.0, 200.0, 35.0, -108.0, 167.0, 200.0, -185.0, 200.0, -306.0, -2000.0, 2.0, 123.0, 101.0, 200.0, -119.0, 79.0, 200.0, -713.0, 145.0, 200.0, 200.0, -559.0, -130.0, 200.0, 145.0, -394.0, 57.0, 167.0, -64.0, -119.0, 200.0, -9.0, -163.0, 90.0, -20.0, 200.0, 90.0, 79.0, 57.0], "policy_predator_policy_reward": [0.0, 285.0, 145.0, 85.0, 130.0, 600.0, 0.0, 190.0, 0.0, 25.0, 40.0, 75.0, 10.0, 20.0, 525.0, 0.0, 0.0, 5.0, 235.0, 220.0, 265.0, 60.0, 65.0, 0.0, 245.0, 245.0, 265.0, 185.0, 160.0, 165.0, 0.0, 0.0, 0.0, 0.0, 30.0, 20.0, 25.0, 215.0, 240.0, 130.0, 250.0, 240.0, 325.0, 245.0, 380.0, 35.0, 50.0, 85.0, 125.0, 590.0, 60.0, 300.0, 115.0, 0.0, 10.0, 45.0, 30.0, 125.0, 0.0, 0.0, 10.0, 250.0, 40.0, 65.0, 70.0, 45.0, 30.0, 225.0, 0.0, 250.0, 115.0, 50.0, 0.0, 135.0, 50.0, 80.0, 30.0, 40.0, 635.0, 45.0, 20.0, 45.0, 0.0, 0.0, 0.0, 55.0, 0.0, 425.0, 385.0, 355.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 995.0, 0.0, 65.0, 0.0, 0.0, 0.0, 65.0, 80.0, 35.0, 80.0, 0.0, 0.0, 95.0, 95.0, 0.0, 80.0, 85.0, 75.0, 95.0, 95.0, 40.0, 35.0, 75.0, 0.0, 0.0, 0.0, 25.0, 415.0, 210.0, 80.0, 35.0, 0.0, 485.0, 170.0, 165.0, 110.0, 0.0, 0.0, 0.0, 100.0, 10.0, 80.0, 0.0, 75.0, 100.0, 1000.0, 160.0, 50.0, 20.0, 0.0, 0.0, 5.0, 0.0, 50.0, 80.0, 0.0, 95.0, 130.0, 50.0, 45.0, 95.0, 90.0, 45.0, 35.0, 15.0, 20.0, 115.0, 105.0, 150.0, 60.0, 0.0, 0.0, 130.0, 150.0, 130.0, 0.0, 0.0, 0.0, 335.0, 50.0, 315.0, 345.0, 115.0, 100.0, 45.0, 195.0, 160.0, 65.0, 30.0, 330.0, 325.0, 0.0, 200.0, 290.0, 165.0, 0.0, 75.0, 15.0, 190.0, 245.0, 255.0, 115.0, 0.0, 25.0, 55.0, 10.0, 0.0, 0.0, 0.0, 1000.0, 0.0, 200.0, 35.0, 330.0, 100.0, 15.0, 5.0, 330.0, 240.0, 395.0, 0.0, 330.0, 50.0, 90.0, 0.0, 0.0, 15.0, 135.0, 60.0, 215.0, 45.0, 135.0, 115.0, 130.0, 145.0, 115.0, 260.0, 70.0, 230.0, 65.0, 115.0, 155.0, 80.0, 110.0, 25.0, 10.0, 20.0, 145.0, 35.0, 95.0, 0.0, 0.0, 0.0, 315.0, 405.0, 265.0, 115.0, 90.0, 0.0, 75.0, 0.0, 0.0, 140.0, 50.0, 10.0, 175.0, 35.0, 120.0, 80.0, 1000.0, 10.0, 0.0, 40.0, 145.0, 275.0, 290.0, 400.0, 0.0, 0.0, 25.0, 150.0, 40.0, 295.0, 65.0, 250.0, 150.0, 150.0, 0.0, 0.0, 0.0, 165.0, 95.0, 50.0, 50.0, 70.0, 90.0, 70.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9451371899101207, "mean_inference_ms": 1.5906398321319415, "mean_action_processing_ms": 0.3612721943884161, "mean_env_wait_ms": 0.2526302689915632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038830041885375977, "StateBufferConnector_ms": 0.00380706787109375, "ViewRequirementAgentConnector_ms": 0.12561964988708496}, "num_episodes": 18, "episode_return_max": 638.0, "episode_return_min": -3635.0, "episode_return_mean": 169.49, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.72313983777226, "num_env_steps_trained_throughput_per_sec": 55.72313983777226, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 71665.745, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71665.684, "sample_time_ms": 1314.757, "learn_time_ms": 70332.286, "learn_throughput": 56.873, "synch_weights_time_ms": 13.756}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 90, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-17-33", "timestamp": 1723493853, "time_this_iter_s": 71.81343007087708, "time_total_s": 7255.951394557953, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2332160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7255.951394557953, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 19.633333333333333, "ram_util_percent": 81.68235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3127992673651547, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.064901793626606, "policy_loss": -0.007941338024205356, "vf_loss": 1.0723349343589013, "vf_explained_var": -1.1509572360532504e-05, "kl": 0.006775339022586634, "entropy": 0.6015585062140268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 255210.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.385169893925917, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4457300975813088, "policy_loss": -0.02492761472289629, "vf_loss": 1.4697988913414326, "vf_explained_var": 0.026238227228746348, "kl": 0.008588229446333813, "entropy": 0.9221855287222152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 255210.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -3635.0, "episode_reward_mean": 159.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -53.513333333333335, "predator_policy": 106.61666666666666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, 356.0, 574.0, -1560.0, 425.0, 479.0, -512.0, 566.0, 600.0, 600.0, 600.0, -3389.0, 600.0, 505.0, 493.0, 328.0, 400.0, 302.0, 479.0, 570.0, -532.0, -915.0, 396.0, 600.0, 350.0, 522.0, -3635.0, 565.0, 545.0, 379.0, 330.0, 412.0, 593.0, 365.0, 495.0, 240.0, 600.0, -526.0, -413.0, 274.0, -240.0, 124.0, 417.0, 264.0, -138.0, 504.0, 588.0, -600.0, 307.0, 467.0, -360.0, 199.0, 492.0, 370.0, 126.0, 121.0, 66.0, 251.0, 329.0, 589.0, 424.0, 600.0, 166.0, 343.0, 510.0, 459.0, 39.0, -785.0, 367.0, 531.0, 570.0, -4.0, 273.0, 134.0, 288.0, 440.0, 441.0, 501.0, 494.0, 396.0, 139.0, 311.0, -214.0, 383.0, -1744.0, 546.0, 377.0, 246.0, -390.0, 486.0, 575.0, 181.0, -389.0, 306.0, 591.0, 499.0, 357.0, -474.0, 588.0, 408.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-405.0, 68.0, -53.0, 178.0, 90.0, -97.0, 200.0, 200.0, 24.0, -636.0, -966.0, -658.0, 145.0, 123.0, 112.0, 200.0, 145.0, 79.0, -691.0, -185.0, -801.0, 200.0, 178.0, 178.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1802.0, -1417.0, -1230.0, 200.0, 200.0, 200.0, 112.0, 200.0, 13.0, 200.0, 24.0, 189.0, -42.0, 57.0, 123.0, 101.0, 101.0, -42.0, -141.0, 200.0, 13.0, 112.0, 57.0, 200.0, 167.0, 200.0, 178.0, -262.0, -262.0, -713.0, -339.0, -482.0, -614.0, -251.0, 2.0, 200.0, 200.0, 200.0, 200.0, 2.0, 178.0, -20.0, 167.0, 200.0, -20.0, -1736.0, -1692.0, -1417.0, 156.0, 189.0, 200.0, 200.0, 200.0, 90.0, 134.0, 112.0, -42.0, 200.0, -9.0, -86.0, -75.0, 57.0, 200.0, 123.0, 200.0, 200.0, 156.0, -163.0, 2.0, 200.0, 167.0, 68.0, 90.0, -130.0, -130.0, 200.0, 200.0, 200.0, -372.0, -284.0, -570.0, -174.0, -471.0, -328.0, 134.0, 90.0, -350.0, -229.0, -262.0, -174.0, 200.0, -273.0, -328.0, -438.0, 200.0, 200.0, 90.0, -306.0, 200.0, -218.0, 2.0, -537.0, 200.0, 24.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, -2000.0, 200.0, -581.0, 123.0, 167.0, -20.0, 200.0, -383.0, -548.0, -394.0, 156.0, 57.0, -394.0, 2.0, 200.0, 200.0, 200.0, -97.0, 57.0, -207.0, -141.0, 79.0, 46.0, -196.0, -119.0, -372.0, -53.0, 46.0, 57.0, -53.0, -163.0, -196.0, 2.0, 178.0, 200.0, 200.0, 134.0, 123.0, 145.0, -119.0, 200.0, 200.0, 200.0, -328.0, -394.0, -97.0, 200.0, -53.0, -9.0, 200.0, 200.0, 35.0, -108.0, 167.0, 200.0, -185.0, 200.0, -306.0, -2000.0, 2.0, 123.0, 101.0, 200.0, -119.0, 79.0, 200.0, -713.0, 145.0, 200.0, 200.0, -559.0, -130.0, 200.0, 145.0, -394.0, 57.0, 167.0, -64.0, -119.0, 200.0, -9.0, -163.0, 90.0, -20.0, 200.0, 90.0, 79.0, 57.0, 189.0, -130.0, 112.0, 200.0, 134.0, 35.0, 123.0, -152.0, 200.0, -20.0, -53.0, -163.0, -64.0, 101.0, 79.0, 156.0, -724.0, -141.0, 68.0, 189.0, -64.0, -1252.0, -867.0, -845.0, 112.0, 200.0, 189.0, 79.0, 46.0, 112.0, 2.0, 2.0, -53.0, -185.0, -526.0, -504.0, 200.0, 200.0, -9.0, 90.0, 200.0, 200.0, 24.0, 13.0, -251.0, 68.0, -405.0, -372.0, -97.0, 35.0, 178.0, 200.0, 46.0, 200.0, 112.0, 200.0, 112.0, 90.0, -97.0, 189.0, -735.0, -427.0, 13.0, 178.0, 200.0, 200.0, 68.0, 123.0, 57.0], "policy_predator_policy_reward": [250.0, 115.0, 50.0, 0.0, 135.0, 50.0, 80.0, 30.0, 40.0, 635.0, 45.0, 20.0, 45.0, 0.0, 0.0, 0.0, 55.0, 0.0, 425.0, 385.0, 355.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 995.0, 0.0, 65.0, 0.0, 0.0, 0.0, 65.0, 80.0, 35.0, 80.0, 0.0, 0.0, 95.0, 95.0, 0.0, 80.0, 85.0, 75.0, 95.0, 95.0, 40.0, 35.0, 75.0, 0.0, 0.0, 0.0, 25.0, 415.0, 210.0, 80.0, 35.0, 0.0, 485.0, 170.0, 165.0, 110.0, 0.0, 0.0, 0.0, 100.0, 10.0, 80.0, 0.0, 75.0, 100.0, 1000.0, 160.0, 50.0, 20.0, 0.0, 0.0, 5.0, 0.0, 50.0, 80.0, 0.0, 95.0, 130.0, 50.0, 45.0, 95.0, 90.0, 45.0, 35.0, 15.0, 20.0, 115.0, 105.0, 150.0, 60.0, 0.0, 0.0, 130.0, 150.0, 130.0, 0.0, 0.0, 0.0, 335.0, 50.0, 315.0, 345.0, 115.0, 100.0, 45.0, 195.0, 160.0, 65.0, 30.0, 330.0, 325.0, 0.0, 200.0, 290.0, 165.0, 0.0, 75.0, 15.0, 190.0, 245.0, 255.0, 115.0, 0.0, 25.0, 55.0, 10.0, 0.0, 0.0, 0.0, 1000.0, 0.0, 200.0, 35.0, 330.0, 100.0, 15.0, 5.0, 330.0, 240.0, 395.0, 0.0, 330.0, 50.0, 90.0, 0.0, 0.0, 15.0, 135.0, 60.0, 215.0, 45.0, 135.0, 115.0, 130.0, 145.0, 115.0, 260.0, 70.0, 230.0, 65.0, 115.0, 155.0, 80.0, 110.0, 25.0, 10.0, 20.0, 145.0, 35.0, 95.0, 0.0, 0.0, 0.0, 315.0, 405.0, 265.0, 115.0, 90.0, 0.0, 75.0, 0.0, 0.0, 140.0, 50.0, 10.0, 175.0, 35.0, 120.0, 80.0, 1000.0, 10.0, 0.0, 40.0, 145.0, 275.0, 290.0, 400.0, 0.0, 0.0, 25.0, 150.0, 40.0, 295.0, 65.0, 250.0, 150.0, 150.0, 0.0, 0.0, 0.0, 165.0, 95.0, 50.0, 50.0, 70.0, 90.0, 70.0, 55.0, 115.0, 100.0, 115.0, 50.0, 0.0, 75.0, 55.0, 80.0, 90.0, 0.0, 265.0, 110.0, 120.0, 75.0, 0.0, 20.0, 70.0, 405.0, 120.0, 5.0, 65.0, 545.0, 0.0, 675.0, 5.0, 40.0, 0.0, 55.0, 70.0, 15.0, 115.0, 55.0, 125.0, 195.0, 385.0, 245.0, 0.0, 0.0, 95.0, 45.0, 35.0, 5.0, 205.0, 100.0, 90.0, 310.0, 10.0, 0.0, 30.0, 160.0, 0.0, 55.0, 45.0, 45.0, 40.0, 0.0, 35.0, 175.0, 0.0, 0.0, 210.0, 425.0, 40.0, 0.0, 10.0, 0.0, 95.0, 65.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.943460306989973, "mean_inference_ms": 1.5870323006371239, "mean_action_processing_ms": 0.36060780201925824, "mean_env_wait_ms": 0.2520442525305877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043991804122924805, "StateBufferConnector_ms": 0.003896355628967285, "ViewRequirementAgentConnector_ms": 0.12743544578552246}, "num_episodes": 23, "episode_return_max": 600.0, "episode_return_min": -3635.0, "episode_return_mean": 159.31, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.51681563654393, "num_env_steps_trained_throughput_per_sec": 56.51681563654393, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 2184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2184000, "timers": {"training_iteration_time_ms": 71606.103, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71606.042, "sample_time_ms": 1316.191, "learn_time_ms": 70271.64, "learn_throughput": 56.922, "synch_weights_time_ms": 13.581}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 2184000, "num_agent_steps_trained": 2184000}, "done": false, "training_iteration": 91, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-18-43", "timestamp": 1723493923, "time_this_iter_s": 70.87078404426575, "time_total_s": 7326.822178602219, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b21bb3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7326.822178602219, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 18.23, "ram_util_percent": 82.01000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1462308343949048, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3315040681801789, "policy_loss": -0.005721056207800647, "vf_loss": 1.3366486053411841, "vf_explained_var": -2.125882087869847e-05, "kl": 0.007686305032847385, "entropy": 0.5786689002251794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 258030.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2683752291380093, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4337172112170051, "policy_loss": -0.01783845451027188, "vf_loss": 1.4506920393477094, "vf_explained_var": 0.01298071414443618, "kl": 0.008636278311598631, "entropy": 0.902178721542054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 258030.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 600.0, "episode_reward_min": -3635.0, "episode_reward_mean": 168.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -55.97, "predator_policy": 112.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [479.0, 570.0, -532.0, -915.0, 396.0, 600.0, 350.0, 522.0, -3635.0, 565.0, 545.0, 379.0, 330.0, 412.0, 593.0, 365.0, 495.0, 240.0, 600.0, -526.0, -413.0, 274.0, -240.0, 124.0, 417.0, 264.0, -138.0, 504.0, 588.0, -600.0, 307.0, 467.0, -360.0, 199.0, 492.0, 370.0, 126.0, 121.0, 66.0, 251.0, 329.0, 589.0, 424.0, 600.0, 166.0, 343.0, 510.0, 459.0, 39.0, -785.0, 367.0, 531.0, 570.0, -4.0, 273.0, 134.0, 288.0, 440.0, 441.0, 501.0, 494.0, 396.0, 139.0, 311.0, -214.0, 383.0, -1744.0, 546.0, 377.0, 246.0, -390.0, 486.0, 575.0, 181.0, -389.0, 306.0, 591.0, 499.0, 357.0, -474.0, 588.0, 408.0, -606.0, 552.0, 435.0, 350.0, -986.0, 388.0, 414.0, 572.0, 528.0, 378.0, -2194.0, 402.0, 540.0, 292.0, 576.0, 189.0, 422.0, 78.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [112.0, 57.0, 200.0, 167.0, 200.0, 178.0, -262.0, -262.0, -713.0, -339.0, -482.0, -614.0, -251.0, 2.0, 200.0, 200.0, 200.0, 200.0, 2.0, 178.0, -20.0, 167.0, 200.0, -20.0, -1736.0, -1692.0, -1417.0, 156.0, 189.0, 200.0, 200.0, 200.0, 90.0, 134.0, 112.0, -42.0, 200.0, -9.0, -86.0, -75.0, 57.0, 200.0, 123.0, 200.0, 200.0, 156.0, -163.0, 2.0, 200.0, 167.0, 68.0, 90.0, -130.0, -130.0, 200.0, 200.0, 200.0, -372.0, -284.0, -570.0, -174.0, -471.0, -328.0, 134.0, 90.0, -350.0, -229.0, -262.0, -174.0, 200.0, -273.0, -328.0, -438.0, 200.0, 200.0, 90.0, -306.0, 200.0, -218.0, 2.0, -537.0, 200.0, 24.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, -2000.0, 200.0, -581.0, 123.0, 167.0, -20.0, 200.0, -383.0, -548.0, -394.0, 156.0, 57.0, -394.0, 2.0, 200.0, 200.0, 200.0, -97.0, 57.0, -207.0, -141.0, 79.0, 46.0, -196.0, -119.0, -372.0, -53.0, 46.0, 57.0, -53.0, -163.0, -196.0, 2.0, 178.0, 200.0, 200.0, 134.0, 123.0, 145.0, -119.0, 200.0, 200.0, 200.0, -328.0, -394.0, -97.0, 200.0, -53.0, -9.0, 200.0, 200.0, 35.0, -108.0, 167.0, 200.0, -185.0, 200.0, -306.0, -2000.0, 2.0, 123.0, 101.0, 200.0, -119.0, 79.0, 200.0, -713.0, 145.0, 200.0, 200.0, -559.0, -130.0, 200.0, 145.0, -394.0, 57.0, 167.0, -64.0, -119.0, 200.0, -9.0, -163.0, 90.0, -20.0, 200.0, 90.0, 79.0, 57.0, 189.0, -130.0, 112.0, 200.0, 134.0, 35.0, 123.0, -152.0, 200.0, -20.0, -53.0, -163.0, -64.0, 101.0, 79.0, 156.0, -724.0, -141.0, 68.0, 189.0, -64.0, -1252.0, -867.0, -845.0, 112.0, 200.0, 189.0, 79.0, 46.0, 112.0, 2.0, 2.0, -53.0, -185.0, -526.0, -504.0, 200.0, 200.0, -9.0, 90.0, 200.0, 200.0, 24.0, 13.0, -251.0, 68.0, -405.0, -372.0, -97.0, 35.0, 178.0, 200.0, 46.0, 200.0, 112.0, 200.0, 112.0, 90.0, -97.0, 189.0, -735.0, -427.0, 13.0, 178.0, 200.0, 200.0, 68.0, 123.0, 57.0, -119.0, -636.0, -801.0, 200.0, -163.0, 200.0, 134.0, 24.0, 112.0, 46.0, 57.0, 112.0, -581.0, -31.0, -1219.0, -9.0, -31.0, 178.0, 35.0, 200.0, 24.0, 2.0, 200.0, 200.0, 200.0, 101.0, 167.0, -31.0, 79.0, 90.0, -2000.0, 200.0, -1604.0, 13.0, 200.0, 24.0, 101.0, 200.0, 189.0, -482.0, 134.0, 200.0, 200.0, 200.0, 156.0, 189.0, -350.0, -240.0, 90.0, 167.0, -20.0, -449.0, 2.0, 90.0], "policy_predator_policy_reward": [35.0, 75.0, 0.0, 0.0, 0.0, 25.0, 415.0, 210.0, 80.0, 35.0, 0.0, 485.0, 170.0, 165.0, 110.0, 0.0, 0.0, 0.0, 100.0, 10.0, 80.0, 0.0, 75.0, 100.0, 1000.0, 160.0, 50.0, 20.0, 0.0, 0.0, 5.0, 0.0, 50.0, 80.0, 0.0, 95.0, 130.0, 50.0, 45.0, 95.0, 90.0, 45.0, 35.0, 15.0, 20.0, 115.0, 105.0, 150.0, 60.0, 0.0, 0.0, 130.0, 150.0, 130.0, 0.0, 0.0, 0.0, 335.0, 50.0, 315.0, 345.0, 115.0, 100.0, 45.0, 195.0, 160.0, 65.0, 30.0, 330.0, 325.0, 0.0, 200.0, 290.0, 165.0, 0.0, 75.0, 15.0, 190.0, 245.0, 255.0, 115.0, 0.0, 25.0, 55.0, 10.0, 0.0, 0.0, 0.0, 1000.0, 0.0, 200.0, 35.0, 330.0, 100.0, 15.0, 5.0, 330.0, 240.0, 395.0, 0.0, 330.0, 50.0, 90.0, 0.0, 0.0, 15.0, 135.0, 60.0, 215.0, 45.0, 135.0, 115.0, 130.0, 145.0, 115.0, 260.0, 70.0, 230.0, 65.0, 115.0, 155.0, 80.0, 110.0, 25.0, 10.0, 20.0, 145.0, 35.0, 95.0, 0.0, 0.0, 0.0, 315.0, 405.0, 265.0, 115.0, 90.0, 0.0, 75.0, 0.0, 0.0, 140.0, 50.0, 10.0, 175.0, 35.0, 120.0, 80.0, 1000.0, 10.0, 0.0, 40.0, 145.0, 275.0, 290.0, 400.0, 0.0, 0.0, 25.0, 150.0, 40.0, 295.0, 65.0, 250.0, 150.0, 150.0, 0.0, 0.0, 0.0, 165.0, 95.0, 50.0, 50.0, 70.0, 90.0, 70.0, 55.0, 115.0, 100.0, 115.0, 50.0, 0.0, 75.0, 55.0, 80.0, 90.0, 0.0, 265.0, 110.0, 120.0, 75.0, 0.0, 20.0, 70.0, 405.0, 120.0, 5.0, 65.0, 545.0, 0.0, 675.0, 5.0, 40.0, 0.0, 55.0, 70.0, 15.0, 115.0, 55.0, 125.0, 195.0, 385.0, 245.0, 0.0, 0.0, 95.0, 45.0, 35.0, 5.0, 205.0, 100.0, 90.0, 310.0, 10.0, 0.0, 30.0, 160.0, 0.0, 55.0, 45.0, 45.0, 40.0, 0.0, 35.0, 175.0, 0.0, 0.0, 210.0, 425.0, 40.0, 0.0, 10.0, 0.0, 95.0, 65.0, 0.0, 455.0, 75.0, 420.0, 85.0, 65.0, 165.0, 60.0, 55.0, 50.0, 0.0, 40.0, 95.0, 95.0, 645.0, 105.0, 80.0, 95.0, 75.0, 30.0, 45.0, 80.0, 85.0, 85.0, 0.0, 15.0, 45.0, 0.0, 115.0, 125.0, 0.0, 920.0, 215.0, 75.0, 0.0, 150.0, 15.0, 0.0, 0.0, 50.0, 50.0, 80.0, 310.0, 20.0, 0.0, 0.0, 250.0, 180.0, 160.0, 100.0, 50.0, 35.0, 50.0, 295.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9415079619225346, "mean_inference_ms": 1.5833788299112899, "mean_action_processing_ms": 0.3600529219525464, "mean_env_wait_ms": 0.251597064819644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004858732223510742, "StateBufferConnector_ms": 0.003714919090270996, "ViewRequirementAgentConnector_ms": 0.12784969806671143}, "num_episodes": 18, "episode_return_max": 600.0, "episode_return_min": -3635.0, "episode_return_mean": 168.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.093986700403, "num_env_steps_trained_throughput_per_sec": 56.093986700403, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 71583.391, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71583.33, "sample_time_ms": 1310.055, "learn_time_ms": 70255.578, "learn_throughput": 56.935, "synch_weights_time_ms": 13.554}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 92, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-19-55", "timestamp": 1723493995, "time_this_iter_s": 71.33586621284485, "time_total_s": 7398.1580448150635, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b231b790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7398.1580448150635, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 18.885148514851483, "ram_util_percent": 82.01386138613861}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.199002296625511, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8466705525597782, "policy_loss": -0.005856887951529591, "vf_loss": 0.8519873560584607, "vf_explained_var": -2.4353379898882926e-05, "kl": 0.007200488315886516, "entropy": 0.5897660228905949, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 260850.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1595971847996642, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8959620133227278, "policy_loss": -0.019890377405413315, "vf_loss": 0.915190331299677, "vf_explained_var": 0.0179064209156848, "kl": 0.006620583547160769, "entropy": 0.8838793691168441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 260850.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "env_runners": {"episode_reward_max": 626.0, "episode_reward_min": -2194.0, "episode_reward_mean": 202.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -42.77, "predator_policy": 110.33333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [600.0, -526.0, -413.0, 274.0, -240.0, 124.0, 417.0, 264.0, -138.0, 504.0, 588.0, -600.0, 307.0, 467.0, -360.0, 199.0, 492.0, 370.0, 126.0, 121.0, 66.0, 251.0, 329.0, 589.0, 424.0, 600.0, 166.0, 343.0, 510.0, 459.0, 39.0, -785.0, 367.0, 531.0, 570.0, -4.0, 273.0, 134.0, 288.0, 440.0, 441.0, 501.0, 494.0, 396.0, 139.0, 311.0, -214.0, 383.0, -1744.0, 546.0, 377.0, 246.0, -390.0, 486.0, 575.0, 181.0, -389.0, 306.0, 591.0, 499.0, 357.0, -474.0, 588.0, 408.0, -606.0, 552.0, 435.0, 350.0, -986.0, 388.0, 414.0, 572.0, 528.0, 378.0, -2194.0, 402.0, 540.0, 292.0, 576.0, 189.0, 422.0, 78.0, 252.0, 368.0, -759.0, 304.0, 424.0, 626.0, 467.0, -413.0, 313.0, 548.0, 504.0, 252.0, 430.0, 79.0, 354.0, 600.0, 312.0, 498.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, -372.0, -284.0, -570.0, -174.0, -471.0, -328.0, 134.0, 90.0, -350.0, -229.0, -262.0, -174.0, 200.0, -273.0, -328.0, -438.0, 200.0, 200.0, 90.0, -306.0, 200.0, -218.0, 2.0, -537.0, 200.0, 24.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, -2000.0, 200.0, -581.0, 123.0, 167.0, -20.0, 200.0, -383.0, -548.0, -394.0, 156.0, 57.0, -394.0, 2.0, 200.0, 200.0, 200.0, -97.0, 57.0, -207.0, -141.0, 79.0, 46.0, -196.0, -119.0, -372.0, -53.0, 46.0, 57.0, -53.0, -163.0, -196.0, 2.0, 178.0, 200.0, 200.0, 134.0, 123.0, 145.0, -119.0, 200.0, 200.0, 200.0, -328.0, -394.0, -97.0, 200.0, -53.0, -9.0, 200.0, 200.0, 35.0, -108.0, 167.0, 200.0, -185.0, 200.0, -306.0, -2000.0, 2.0, 123.0, 101.0, 200.0, -119.0, 79.0, 200.0, -713.0, 145.0, 200.0, 200.0, -559.0, -130.0, 200.0, 145.0, -394.0, 57.0, 167.0, -64.0, -119.0, 200.0, -9.0, -163.0, 90.0, -20.0, 200.0, 90.0, 79.0, 57.0, 189.0, -130.0, 112.0, 200.0, 134.0, 35.0, 123.0, -152.0, 200.0, -20.0, -53.0, -163.0, -64.0, 101.0, 79.0, 156.0, -724.0, -141.0, 68.0, 189.0, -64.0, -1252.0, -867.0, -845.0, 112.0, 200.0, 189.0, 79.0, 46.0, 112.0, 2.0, 2.0, -53.0, -185.0, -526.0, -504.0, 200.0, 200.0, -9.0, 90.0, 200.0, 200.0, 24.0, 13.0, -251.0, 68.0, -405.0, -372.0, -97.0, 35.0, 178.0, 200.0, 46.0, 200.0, 112.0, 200.0, 112.0, 90.0, -97.0, 189.0, -735.0, -427.0, 13.0, 178.0, 200.0, 200.0, 68.0, 123.0, 57.0, -119.0, -636.0, -801.0, 200.0, -163.0, 200.0, 134.0, 24.0, 112.0, 46.0, 57.0, 112.0, -581.0, -31.0, -1219.0, -9.0, -31.0, 178.0, 35.0, 200.0, 24.0, 2.0, 200.0, 200.0, 200.0, 101.0, 167.0, -31.0, 79.0, 90.0, -2000.0, 200.0, -1604.0, 13.0, 200.0, 24.0, 101.0, 200.0, 189.0, -482.0, 134.0, 200.0, 200.0, 200.0, 156.0, 189.0, -350.0, -240.0, 90.0, 167.0, -20.0, -449.0, 2.0, 90.0, -493.0, 145.0, 200.0, -196.0, 200.0, 24.0, -526.0, -471.0, -207.0, -20.0, -31.0, 200.0, 46.0, -20.0, 178.0, 200.0, 46.0, 200.0, 156.0, -53.0, 189.0, -196.0, -31.0, -746.0, 68.0, -328.0, 68.0, 200.0, 200.0, 68.0, 200.0, 200.0, 24.0, -438.0, 200.0, 200.0, -119.0, 134.0, 200.0, -31.0, 24.0, -229.0, -130.0, 79.0, 200.0, 200.0, 200.0, 200.0, 2.0, 46.0, 79.0, 200.0, 200.0, 13.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 335.0, 50.0, 315.0, 345.0, 115.0, 100.0, 45.0, 195.0, 160.0, 65.0, 30.0, 330.0, 325.0, 0.0, 200.0, 290.0, 165.0, 0.0, 75.0, 15.0, 190.0, 245.0, 255.0, 115.0, 0.0, 25.0, 55.0, 10.0, 0.0, 0.0, 0.0, 1000.0, 0.0, 200.0, 35.0, 330.0, 100.0, 15.0, 5.0, 330.0, 240.0, 395.0, 0.0, 330.0, 50.0, 90.0, 0.0, 0.0, 15.0, 135.0, 60.0, 215.0, 45.0, 135.0, 115.0, 130.0, 145.0, 115.0, 260.0, 70.0, 230.0, 65.0, 115.0, 155.0, 80.0, 110.0, 25.0, 10.0, 20.0, 145.0, 35.0, 95.0, 0.0, 0.0, 0.0, 315.0, 405.0, 265.0, 115.0, 90.0, 0.0, 75.0, 0.0, 0.0, 140.0, 50.0, 10.0, 175.0, 35.0, 120.0, 80.0, 1000.0, 10.0, 0.0, 40.0, 145.0, 275.0, 290.0, 400.0, 0.0, 0.0, 25.0, 150.0, 40.0, 295.0, 65.0, 250.0, 150.0, 150.0, 0.0, 0.0, 0.0, 165.0, 95.0, 50.0, 50.0, 70.0, 90.0, 70.0, 55.0, 115.0, 100.0, 115.0, 50.0, 0.0, 75.0, 55.0, 80.0, 90.0, 0.0, 265.0, 110.0, 120.0, 75.0, 0.0, 20.0, 70.0, 405.0, 120.0, 5.0, 65.0, 545.0, 0.0, 675.0, 5.0, 40.0, 0.0, 55.0, 70.0, 15.0, 115.0, 55.0, 125.0, 195.0, 385.0, 245.0, 0.0, 0.0, 95.0, 45.0, 35.0, 5.0, 205.0, 100.0, 90.0, 310.0, 10.0, 0.0, 30.0, 160.0, 0.0, 55.0, 45.0, 45.0, 40.0, 0.0, 35.0, 175.0, 0.0, 0.0, 210.0, 425.0, 40.0, 0.0, 10.0, 0.0, 95.0, 65.0, 0.0, 455.0, 75.0, 420.0, 85.0, 65.0, 165.0, 60.0, 55.0, 50.0, 0.0, 40.0, 95.0, 95.0, 645.0, 105.0, 80.0, 95.0, 75.0, 30.0, 45.0, 80.0, 85.0, 85.0, 0.0, 15.0, 45.0, 0.0, 115.0, 125.0, 0.0, 920.0, 215.0, 75.0, 0.0, 150.0, 15.0, 0.0, 0.0, 50.0, 50.0, 80.0, 310.0, 20.0, 0.0, 0.0, 250.0, 180.0, 160.0, 100.0, 50.0, 35.0, 50.0, 295.0, 90.0, 0.0, 315.0, 85.0, 5.0, 175.0, 160.0, 0.0, 95.0, 350.0, 95.0, 60.0, 0.0, 65.0, 90.0, 65.0, 70.0, 40.0, 70.0, 60.0, 35.0, 80.0, 50.0, 75.0, 435.0, 195.0, 180.0, 130.0, 0.0, 45.0, 35.0, 0.0, 80.0, 0.0, 0.0, 0.0, 290.0, 15.0, 60.0, 140.0, 80.0, 130.0, 105.0, 55.0, 0.0, 150.0, 0.0, 0.0, 0.0, 90.0, 85.0, 10.0, 85.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9399023160954578, "mean_inference_ms": 1.5802780516578718, "mean_action_processing_ms": 0.3595324178477098, "mean_env_wait_ms": 0.2511664653795172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005886435508728027, "StateBufferConnector_ms": 0.003774881362915039, "ViewRequirementAgentConnector_ms": 0.12836885452270508}, "num_episodes": 18, "episode_return_max": 626.0, "episode_return_min": -2194.0, "episode_return_mean": 202.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.069582870165895, "num_env_steps_trained_throughput_per_sec": 56.069582870165895, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 2232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2232000, "timers": {"training_iteration_time_ms": 71386.157, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71386.09, "sample_time_ms": 1254.282, "learn_time_ms": 70114.356, "learn_throughput": 57.05, "synch_weights_time_ms": 13.42}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 2232000, "num_agent_steps_trained": 2232000}, "done": false, "training_iteration": 93, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-21-06", "timestamp": 1723494066, "time_this_iter_s": 71.38413882255554, "time_total_s": 7469.542183637619, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b234a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7469.542183637619, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 18.735643564356437, "ram_util_percent": 82.0841584158416}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2927704423454636, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.70510079539414, "policy_loss": -0.00553433964062393, "vf_loss": 1.7100879838492007, "vf_explained_var": -1.0627952027828135e-05, "kl": 0.007294342458945047, "entropy": 0.5751604650143191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 263670.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.68526401340116, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.153155443072319, "policy_loss": -0.020922548413781963, "vf_loss": 2.1731144432057725, "vf_explained_var": 0.02698132262585011, "kl": 0.009635508396772007, "entropy": 0.9424079821887591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 263670.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": 626.0, "episode_reward_min": -2194.0, "episode_reward_mean": 226.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -29.423333333333332, "predator_policy": 104.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.0, 589.0, 424.0, 600.0, 166.0, 343.0, 510.0, 459.0, 39.0, -785.0, 367.0, 531.0, 570.0, -4.0, 273.0, 134.0, 288.0, 440.0, 441.0, 501.0, 494.0, 396.0, 139.0, 311.0, -214.0, 383.0, -1744.0, 546.0, 377.0, 246.0, -390.0, 486.0, 575.0, 181.0, -389.0, 306.0, 591.0, 499.0, 357.0, -474.0, 588.0, 408.0, -606.0, 552.0, 435.0, 350.0, -986.0, 388.0, 414.0, 572.0, 528.0, 378.0, -2194.0, 402.0, 540.0, 292.0, 576.0, 189.0, 422.0, 78.0, 252.0, 368.0, -759.0, 304.0, 424.0, 626.0, 467.0, -413.0, 313.0, 548.0, 504.0, 252.0, 430.0, 79.0, 354.0, 600.0, 312.0, 498.0, 468.0, 353.0, 1.0, 326.0, 544.0, 456.0, 396.0, 438.0, 17.0, 204.0, 401.0, 328.0, 161.0, 564.0, 500.0, -683.0, 391.0, 242.0, 451.0, 229.0, 600.0, -1105.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-196.0, 2.0, 178.0, 200.0, 200.0, 134.0, 123.0, 145.0, -119.0, 200.0, 200.0, 200.0, -328.0, -394.0, -97.0, 200.0, -53.0, -9.0, 200.0, 200.0, 35.0, -108.0, 167.0, 200.0, -185.0, 200.0, -306.0, -2000.0, 2.0, 123.0, 101.0, 200.0, -119.0, 79.0, 200.0, -713.0, 145.0, 200.0, 200.0, -559.0, -130.0, 200.0, 145.0, -394.0, 57.0, 167.0, -64.0, -119.0, 200.0, -9.0, -163.0, 90.0, -20.0, 200.0, 90.0, 79.0, 57.0, 189.0, -130.0, 112.0, 200.0, 134.0, 35.0, 123.0, -152.0, 200.0, -20.0, -53.0, -163.0, -64.0, 101.0, 79.0, 156.0, -724.0, -141.0, 68.0, 189.0, -64.0, -1252.0, -867.0, -845.0, 112.0, 200.0, 189.0, 79.0, 46.0, 112.0, 2.0, 2.0, -53.0, -185.0, -526.0, -504.0, 200.0, 200.0, -9.0, 90.0, 200.0, 200.0, 24.0, 13.0, -251.0, 68.0, -405.0, -372.0, -97.0, 35.0, 178.0, 200.0, 46.0, 200.0, 112.0, 200.0, 112.0, 90.0, -97.0, 189.0, -735.0, -427.0, 13.0, 178.0, 200.0, 200.0, 68.0, 123.0, 57.0, -119.0, -636.0, -801.0, 200.0, -163.0, 200.0, 134.0, 24.0, 112.0, 46.0, 57.0, 112.0, -581.0, -31.0, -1219.0, -9.0, -31.0, 178.0, 35.0, 200.0, 24.0, 2.0, 200.0, 200.0, 200.0, 101.0, 167.0, -31.0, 79.0, 90.0, -2000.0, 200.0, -1604.0, 13.0, 200.0, 24.0, 101.0, 200.0, 189.0, -482.0, 134.0, 200.0, 200.0, 200.0, 156.0, 189.0, -350.0, -240.0, 90.0, 167.0, -20.0, -449.0, 2.0, 90.0, -493.0, 145.0, 200.0, -196.0, 200.0, 24.0, -526.0, -471.0, -207.0, -20.0, -31.0, 200.0, 46.0, -20.0, 178.0, 200.0, 46.0, 200.0, 156.0, -53.0, 189.0, -196.0, -31.0, -746.0, 68.0, -328.0, 68.0, 200.0, 200.0, 68.0, 200.0, 200.0, 24.0, -438.0, 200.0, 200.0, -119.0, 134.0, 200.0, -31.0, 24.0, -229.0, -130.0, 79.0, 200.0, 200.0, 200.0, 200.0, 2.0, 46.0, 79.0, 200.0, 200.0, 13.0, 178.0, -20.0, 200.0, -31.0, 200.0, -31.0, -196.0, -229.0, 101.0, 145.0, -603.0, 79.0, 24.0, 200.0, 200.0, 90.0, 46.0, 200.0, 112.0, 200.0, -31.0, 200.0, -97.0, 200.0, 167.0, -372.0, -108.0, -42.0, 35.0, 101.0, 200.0, 2.0, -86.0, 145.0, -31.0, 24.0, 90.0, -251.0, -53.0, 200.0, -9.0, -647.0, 189.0, 101.0, 90.0, -768.0, -152.0, -658.0, 156.0, 101.0, -31.0, -141.0, -372.0, 200.0, 200.0, -119.0, 200.0, -53.0, 46.0, -9.0, 200.0, 200.0, 200.0, -482.0, -119.0, -1604.0], "policy_predator_policy_reward": [155.0, 80.0, 110.0, 25.0, 10.0, 20.0, 145.0, 35.0, 95.0, 0.0, 0.0, 0.0, 315.0, 405.0, 265.0, 115.0, 90.0, 0.0, 75.0, 0.0, 0.0, 140.0, 50.0, 10.0, 175.0, 35.0, 120.0, 80.0, 1000.0, 10.0, 0.0, 40.0, 145.0, 275.0, 290.0, 400.0, 0.0, 0.0, 25.0, 150.0, 40.0, 295.0, 65.0, 250.0, 150.0, 150.0, 0.0, 0.0, 0.0, 165.0, 95.0, 50.0, 50.0, 70.0, 90.0, 70.0, 55.0, 115.0, 100.0, 115.0, 50.0, 0.0, 75.0, 55.0, 80.0, 90.0, 0.0, 265.0, 110.0, 120.0, 75.0, 0.0, 20.0, 70.0, 405.0, 120.0, 5.0, 65.0, 545.0, 0.0, 675.0, 5.0, 40.0, 0.0, 55.0, 70.0, 15.0, 115.0, 55.0, 125.0, 195.0, 385.0, 245.0, 0.0, 0.0, 95.0, 45.0, 35.0, 5.0, 205.0, 100.0, 90.0, 310.0, 10.0, 0.0, 30.0, 160.0, 0.0, 55.0, 45.0, 45.0, 40.0, 0.0, 35.0, 175.0, 0.0, 0.0, 210.0, 425.0, 40.0, 0.0, 10.0, 0.0, 95.0, 65.0, 0.0, 455.0, 75.0, 420.0, 85.0, 65.0, 165.0, 60.0, 55.0, 50.0, 0.0, 40.0, 95.0, 95.0, 645.0, 105.0, 80.0, 95.0, 75.0, 30.0, 45.0, 80.0, 85.0, 85.0, 0.0, 15.0, 45.0, 0.0, 115.0, 125.0, 0.0, 920.0, 215.0, 75.0, 0.0, 150.0, 15.0, 0.0, 0.0, 50.0, 50.0, 80.0, 310.0, 20.0, 0.0, 0.0, 250.0, 180.0, 160.0, 100.0, 50.0, 35.0, 50.0, 295.0, 90.0, 0.0, 315.0, 85.0, 5.0, 175.0, 160.0, 0.0, 95.0, 350.0, 95.0, 60.0, 0.0, 65.0, 90.0, 65.0, 70.0, 40.0, 70.0, 60.0, 35.0, 80.0, 50.0, 75.0, 435.0, 195.0, 180.0, 130.0, 0.0, 45.0, 35.0, 0.0, 80.0, 0.0, 0.0, 0.0, 290.0, 15.0, 60.0, 140.0, 80.0, 130.0, 105.0, 55.0, 0.0, 150.0, 0.0, 0.0, 0.0, 90.0, 85.0, 10.0, 85.0, 0.0, 0.0, 100.0, 0.0, 10.0, 95.0, 35.0, 85.0, 180.0, 45.0, 100.0, 110.0, 350.0, 245.0, 80.0, 0.0, 40.0, 70.0, 0.0, 50.0, 30.0, 75.0, 10.0, 135.0, 0.0, 0.0, 230.0, 0.0, 100.0, 0.0, 110.0, 0.0, 130.0, 90.0, 65.0, 35.0, 105.0, 50.0, 30.0, 185.0, 160.0, 330.0, 350.0, 340.0, 5.0, 50.0, 65.0, 580.0, 225.0, 90.0, 40.0, 0.0, 125.0, 145.0, 150.0, 260.0, 115.0, 55.0, 0.0, 45.0, 110.0, 90.0, 0.0, 0.0, 0.0, 80.0, 135.0, 885.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9379788556931785, "mean_inference_ms": 1.57655581095, "mean_action_processing_ms": 0.35891561993435805, "mean_env_wait_ms": 0.2506765723145437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006636977195739746, "StateBufferConnector_ms": 0.0037958621978759766, "ViewRequirementAgentConnector_ms": 0.12725675106048584}, "num_episodes": 22, "episode_return_max": 626.0, "episode_return_min": -2194.0, "episode_return_mean": 226.58, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.05322406446421, "num_env_steps_trained_throughput_per_sec": 56.05322406446421, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 71386.22, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71386.153, "sample_time_ms": 1249.135, "learn_time_ms": 70119.591, "learn_throughput": 57.045, "synch_weights_time_ms": 13.45}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 94, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-22-18", "timestamp": 1723494138, "time_this_iter_s": 71.39593291282654, "time_total_s": 7540.938116550446, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32f69cd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7540.938116550446, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 18.525742574257425, "ram_util_percent": 81.94653465346535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.251287237845414, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7529717312848314, "policy_loss": -0.0072944093422951, "vf_loss": 1.7596132644736175, "vf_explained_var": -9.391324739929632e-07, "kl": 0.008704348903580109, "entropy": 0.6140995658352866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 266490.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4362654994142816, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.95418779727415, "policy_loss": -0.022593729637715148, "vf_loss": 1.9759870406160964, "vf_explained_var": 0.015388933310272, "kl": 0.00794489879088512, "entropy": 0.9332189049492491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 266490.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 626.0, "episode_reward_min": -2194.0, "episode_reward_mean": 178.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 940.0}, "policy_reward_mean": {"prey_policy": -49.663333333333334, "predator_policy": 109.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [441.0, 501.0, 494.0, 396.0, 139.0, 311.0, -214.0, 383.0, -1744.0, 546.0, 377.0, 246.0, -390.0, 486.0, 575.0, 181.0, -389.0, 306.0, 591.0, 499.0, 357.0, -474.0, 588.0, 408.0, -606.0, 552.0, 435.0, 350.0, -986.0, 388.0, 414.0, 572.0, 528.0, 378.0, -2194.0, 402.0, 540.0, 292.0, 576.0, 189.0, 422.0, 78.0, 252.0, 368.0, -759.0, 304.0, 424.0, 626.0, 467.0, -413.0, 313.0, 548.0, 504.0, 252.0, 430.0, 79.0, 354.0, 600.0, 312.0, 498.0, 468.0, 353.0, 1.0, 326.0, 544.0, 456.0, 396.0, 438.0, 17.0, 204.0, 401.0, 328.0, 161.0, 564.0, 500.0, -683.0, 391.0, 242.0, 451.0, 229.0, 600.0, -1105.0, 275.0, 188.0, -510.0, -825.0, 247.0, 295.0, -215.0, 482.0, 307.0, 188.0, -832.0, 228.0, -71.0, -185.0, 228.0, 520.0, -295.0, 421.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [90.0, 79.0, 57.0, 189.0, -130.0, 112.0, 200.0, 134.0, 35.0, 123.0, -152.0, 200.0, -20.0, -53.0, -163.0, -64.0, 101.0, 79.0, 156.0, -724.0, -141.0, 68.0, 189.0, -64.0, -1252.0, -867.0, -845.0, 112.0, 200.0, 189.0, 79.0, 46.0, 112.0, 2.0, 2.0, -53.0, -185.0, -526.0, -504.0, 200.0, 200.0, -9.0, 90.0, 200.0, 200.0, 24.0, 13.0, -251.0, 68.0, -405.0, -372.0, -97.0, 35.0, 178.0, 200.0, 46.0, 200.0, 112.0, 200.0, 112.0, 90.0, -97.0, 189.0, -735.0, -427.0, 13.0, 178.0, 200.0, 200.0, 68.0, 123.0, 57.0, -119.0, -636.0, -801.0, 200.0, -163.0, 200.0, 134.0, 24.0, 112.0, 46.0, 57.0, 112.0, -581.0, -31.0, -1219.0, -9.0, -31.0, 178.0, 35.0, 200.0, 24.0, 2.0, 200.0, 200.0, 200.0, 101.0, 167.0, -31.0, 79.0, 90.0, -2000.0, 200.0, -1604.0, 13.0, 200.0, 24.0, 101.0, 200.0, 189.0, -482.0, 134.0, 200.0, 200.0, 200.0, 156.0, 189.0, -350.0, -240.0, 90.0, 167.0, -20.0, -449.0, 2.0, 90.0, -493.0, 145.0, 200.0, -196.0, 200.0, 24.0, -526.0, -471.0, -207.0, -20.0, -31.0, 200.0, 46.0, -20.0, 178.0, 200.0, 46.0, 200.0, 156.0, -53.0, 189.0, -196.0, -31.0, -746.0, 68.0, -328.0, 68.0, 200.0, 200.0, 68.0, 200.0, 200.0, 24.0, -438.0, 200.0, 200.0, -119.0, 134.0, 200.0, -31.0, 24.0, -229.0, -130.0, 79.0, 200.0, 200.0, 200.0, 200.0, 2.0, 46.0, 79.0, 200.0, 200.0, 13.0, 178.0, -20.0, 200.0, -31.0, 200.0, -31.0, -196.0, -229.0, 101.0, 145.0, -603.0, 79.0, 24.0, 200.0, 200.0, 90.0, 46.0, 200.0, 112.0, 200.0, -31.0, 200.0, -97.0, 200.0, 167.0, -372.0, -108.0, -42.0, 35.0, 101.0, 200.0, 2.0, -86.0, 145.0, -31.0, 24.0, 90.0, -251.0, -53.0, 200.0, -9.0, -647.0, 189.0, 101.0, 90.0, -768.0, -152.0, -658.0, 156.0, 101.0, -31.0, -141.0, -372.0, 200.0, 200.0, -119.0, 200.0, -53.0, 46.0, -9.0, 200.0, 200.0, 200.0, -482.0, -119.0, -1604.0, 200.0, 2.0, -42.0, 57.0, -174.0, 35.0, -548.0, -185.0, -592.0, 101.0, -1868.0, -108.0, 35.0, 57.0, 35.0, 101.0, 123.0, -284.0, -361.0, -251.0, -108.0, 123.0, 200.0, -31.0, -306.0, 123.0, 200.0, 145.0, -471.0, 134.0, 57.0, -933.0, -911.0, 24.0, 68.0, -119.0, -405.0, -141.0, 200.0, -350.0, -31.0, -64.0, 156.0, -141.0, -97.0, 200.0, 134.0, -174.0, 57.0, -966.0, -31.0, 145.0, 200.0, -284.0], "policy_predator_policy_reward": [90.0, 70.0, 55.0, 115.0, 100.0, 115.0, 50.0, 0.0, 75.0, 55.0, 80.0, 90.0, 0.0, 265.0, 110.0, 120.0, 75.0, 0.0, 20.0, 70.0, 405.0, 120.0, 5.0, 65.0, 545.0, 0.0, 675.0, 5.0, 40.0, 0.0, 55.0, 70.0, 15.0, 115.0, 55.0, 125.0, 195.0, 385.0, 245.0, 0.0, 0.0, 95.0, 45.0, 35.0, 5.0, 205.0, 100.0, 90.0, 310.0, 10.0, 0.0, 30.0, 160.0, 0.0, 55.0, 45.0, 45.0, 40.0, 0.0, 35.0, 175.0, 0.0, 0.0, 210.0, 425.0, 40.0, 0.0, 10.0, 0.0, 95.0, 65.0, 0.0, 455.0, 75.0, 420.0, 85.0, 65.0, 165.0, 60.0, 55.0, 50.0, 0.0, 40.0, 95.0, 95.0, 645.0, 105.0, 80.0, 95.0, 75.0, 30.0, 45.0, 80.0, 85.0, 85.0, 0.0, 15.0, 45.0, 0.0, 115.0, 125.0, 0.0, 920.0, 215.0, 75.0, 0.0, 150.0, 15.0, 0.0, 0.0, 50.0, 50.0, 80.0, 310.0, 20.0, 0.0, 0.0, 250.0, 180.0, 160.0, 100.0, 50.0, 35.0, 50.0, 295.0, 90.0, 0.0, 315.0, 85.0, 5.0, 175.0, 160.0, 0.0, 95.0, 350.0, 95.0, 60.0, 0.0, 65.0, 90.0, 65.0, 70.0, 40.0, 70.0, 60.0, 35.0, 80.0, 50.0, 75.0, 435.0, 195.0, 180.0, 130.0, 0.0, 45.0, 35.0, 0.0, 80.0, 0.0, 0.0, 0.0, 290.0, 15.0, 60.0, 140.0, 80.0, 130.0, 105.0, 55.0, 0.0, 150.0, 0.0, 0.0, 0.0, 90.0, 85.0, 10.0, 85.0, 0.0, 0.0, 100.0, 0.0, 10.0, 95.0, 35.0, 85.0, 180.0, 45.0, 100.0, 110.0, 350.0, 245.0, 80.0, 0.0, 40.0, 70.0, 0.0, 50.0, 30.0, 75.0, 10.0, 135.0, 0.0, 0.0, 230.0, 0.0, 100.0, 0.0, 110.0, 0.0, 130.0, 90.0, 65.0, 35.0, 105.0, 50.0, 30.0, 185.0, 160.0, 330.0, 350.0, 340.0, 5.0, 50.0, 65.0, 580.0, 225.0, 90.0, 40.0, 0.0, 125.0, 145.0, 150.0, 260.0, 115.0, 55.0, 0.0, 45.0, 110.0, 90.0, 0.0, 0.0, 0.0, 80.0, 135.0, 885.0, 0.0, 0.0, 115.0, 120.0, 100.0, 50.0, 235.0, 80.0, 500.0, 65.0, 940.0, 45.0, 0.0, 0.0, 120.0, 135.0, 220.0, 0.0, 210.0, 295.0, 0.0, 55.0, 110.0, 25.0, 0.0, 60.0, 230.0, 30.0, 305.0, 45.0, 230.0, 600.0, 125.0, 140.0, 115.0, 0.0, 0.0, 0.0, 275.0, 260.0, 0.0, 0.0, 155.0, 20.0, 135.0, 140.0, 165.0, 55.0, 515.0, 40.0, 90.0, 145.0, 35.0, 180.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9364347708700084, "mean_inference_ms": 1.5737324243711734, "mean_action_processing_ms": 0.3584350184173721, "mean_env_wait_ms": 0.2502808800067095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006993889808654785, "StateBufferConnector_ms": 0.0037854909896850586, "ViewRequirementAgentConnector_ms": 0.1256018877029419}, "num_episodes": 18, "episode_return_max": 626.0, "episode_return_min": -2194.0, "episode_return_mean": 178.31, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 54.72602976282656, "num_env_steps_trained_throughput_per_sec": 54.72602976282656, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 71491.17, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71491.103, "sample_time_ms": 1251.089, "learn_time_ms": 70221.865, "learn_throughput": 56.962, "synch_weights_time_ms": 13.464}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 95, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-23-31", "timestamp": 1723494211, "time_this_iter_s": 73.1275053024292, "time_total_s": 7614.065621852875, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b234af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7614.065621852875, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 23.311650485436893, "ram_util_percent": 82.20291262135923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7636815769663938, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9611920599819075, "policy_loss": -0.007752629405825485, "vf_loss": 1.9683741381827822, "vf_explained_var": 0.0006937969872292052, "kl": 0.007607298147712233, "entropy": 0.5984451214049725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 269310.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.091014197204553, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.712829728308299, "policy_loss": -0.022648487322309868, "vf_loss": 1.7346092570123943, "vf_explained_var": 0.02097905142932919, "kl": 0.008689585721552436, "entropy": 0.9245325042846355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 269310.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 626.0, "episode_reward_min": -2194.0, "episode_reward_mean": 152.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 940.0}, "policy_reward_mean": {"prey_policy": -74.37666666666667, "predator_policy": 125.33333333333333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [408.0, -606.0, 552.0, 435.0, 350.0, -986.0, 388.0, 414.0, 572.0, 528.0, 378.0, -2194.0, 402.0, 540.0, 292.0, 576.0, 189.0, 422.0, 78.0, 252.0, 368.0, -759.0, 304.0, 424.0, 626.0, 467.0, -413.0, 313.0, 548.0, 504.0, 252.0, 430.0, 79.0, 354.0, 600.0, 312.0, 498.0, 468.0, 353.0, 1.0, 326.0, 544.0, 456.0, 396.0, 438.0, 17.0, 204.0, 401.0, 328.0, 161.0, 564.0, 500.0, -683.0, 391.0, 242.0, 451.0, 229.0, 600.0, -1105.0, 275.0, 188.0, -510.0, -825.0, 247.0, 295.0, -215.0, 482.0, 307.0, 188.0, -832.0, 228.0, -71.0, -185.0, 228.0, 520.0, -295.0, 421.0, 600.0, -27.0, 204.0, -591.0, -137.0, 188.0, 144.0, 388.0, -1540.0, 436.0, -240.0, 176.0, -226.0, 460.0, 382.0, 265.0, 485.0, 342.0, 115.0, -87.0, -518.0, 520.0, 323.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [68.0, 123.0, 57.0, -119.0, -636.0, -801.0, 200.0, -163.0, 200.0, 134.0, 24.0, 112.0, 46.0, 57.0, 112.0, -581.0, -31.0, -1219.0, -9.0, -31.0, 178.0, 35.0, 200.0, 24.0, 2.0, 200.0, 200.0, 200.0, 101.0, 167.0, -31.0, 79.0, 90.0, -2000.0, 200.0, -1604.0, 13.0, 200.0, 24.0, 101.0, 200.0, 189.0, -482.0, 134.0, 200.0, 200.0, 200.0, 156.0, 189.0, -350.0, -240.0, 90.0, 167.0, -20.0, -449.0, 2.0, 90.0, -493.0, 145.0, 200.0, -196.0, 200.0, 24.0, -526.0, -471.0, -207.0, -20.0, -31.0, 200.0, 46.0, -20.0, 178.0, 200.0, 46.0, 200.0, 156.0, -53.0, 189.0, -196.0, -31.0, -746.0, 68.0, -328.0, 68.0, 200.0, 200.0, 68.0, 200.0, 200.0, 24.0, -438.0, 200.0, 200.0, -119.0, 134.0, 200.0, -31.0, 24.0, -229.0, -130.0, 79.0, 200.0, 200.0, 200.0, 200.0, 2.0, 46.0, 79.0, 200.0, 200.0, 13.0, 178.0, -20.0, 200.0, -31.0, 200.0, -31.0, -196.0, -229.0, 101.0, 145.0, -603.0, 79.0, 24.0, 200.0, 200.0, 90.0, 46.0, 200.0, 112.0, 200.0, -31.0, 200.0, -97.0, 200.0, 167.0, -372.0, -108.0, -42.0, 35.0, 101.0, 200.0, 2.0, -86.0, 145.0, -31.0, 24.0, 90.0, -251.0, -53.0, 200.0, -9.0, -647.0, 189.0, 101.0, 90.0, -768.0, -152.0, -658.0, 156.0, 101.0, -31.0, -141.0, -372.0, 200.0, 200.0, -119.0, 200.0, -53.0, 46.0, -9.0, 200.0, 200.0, 200.0, -482.0, -119.0, -1604.0, 200.0, 2.0, -42.0, 57.0, -174.0, 35.0, -548.0, -185.0, -592.0, 101.0, -1868.0, -108.0, 35.0, 57.0, 35.0, 101.0, 123.0, -284.0, -361.0, -251.0, -108.0, 123.0, 200.0, -31.0, -306.0, 123.0, 200.0, 145.0, -471.0, 134.0, 57.0, -933.0, -911.0, 24.0, 68.0, -119.0, -405.0, -141.0, 200.0, -350.0, -31.0, -64.0, 156.0, -141.0, -97.0, 200.0, 134.0, -174.0, 57.0, -966.0, -31.0, 145.0, 200.0, -284.0, 200.0, 200.0, 200.0, -251.0, 167.0, -328.0, 79.0, 200.0, -405.0, -768.0, -702.0, -141.0, -42.0, -1494.0, -31.0, -163.0, 200.0, -119.0, -108.0, -108.0, 200.0, -75.0, 145.0, 68.0, -1142.0, -1780.0, -548.0, 200.0, -75.0, 46.0, -207.0, 79.0, -812.0, 123.0, 167.0, -449.0, -163.0, 24.0, -537.0, 200.0, 24.0, 101.0, -108.0, 46.0, 134.0, 123.0, 167.0, -350.0, 13.0, 200.0, 167.0, -42.0, 167.0, 2.0, -240.0, 68.0, -218.0, 189.0, -1285.0, 189.0, 24.0, -680.0, -537.0, -130.0, 200.0, 200.0, 2.0, -537.0, 13.0], "policy_predator_policy_reward": [95.0, 65.0, 0.0, 455.0, 75.0, 420.0, 85.0, 65.0, 165.0, 60.0, 55.0, 50.0, 0.0, 40.0, 95.0, 95.0, 645.0, 105.0, 80.0, 95.0, 75.0, 30.0, 45.0, 80.0, 85.0, 85.0, 0.0, 15.0, 45.0, 0.0, 115.0, 125.0, 0.0, 920.0, 215.0, 75.0, 0.0, 150.0, 15.0, 0.0, 0.0, 50.0, 50.0, 80.0, 310.0, 20.0, 0.0, 0.0, 250.0, 180.0, 160.0, 100.0, 50.0, 35.0, 50.0, 295.0, 90.0, 0.0, 315.0, 85.0, 5.0, 175.0, 160.0, 0.0, 95.0, 350.0, 95.0, 60.0, 0.0, 65.0, 90.0, 65.0, 70.0, 40.0, 70.0, 60.0, 35.0, 80.0, 50.0, 75.0, 435.0, 195.0, 180.0, 130.0, 0.0, 45.0, 35.0, 0.0, 80.0, 0.0, 0.0, 0.0, 290.0, 15.0, 60.0, 140.0, 80.0, 130.0, 105.0, 55.0, 0.0, 150.0, 0.0, 0.0, 0.0, 90.0, 85.0, 10.0, 85.0, 0.0, 0.0, 100.0, 0.0, 10.0, 95.0, 35.0, 85.0, 180.0, 45.0, 100.0, 110.0, 350.0, 245.0, 80.0, 0.0, 40.0, 70.0, 0.0, 50.0, 30.0, 75.0, 10.0, 135.0, 0.0, 0.0, 230.0, 0.0, 100.0, 0.0, 110.0, 0.0, 130.0, 90.0, 65.0, 35.0, 105.0, 50.0, 30.0, 185.0, 160.0, 330.0, 350.0, 340.0, 5.0, 50.0, 65.0, 580.0, 225.0, 90.0, 40.0, 0.0, 125.0, 145.0, 150.0, 260.0, 115.0, 55.0, 0.0, 45.0, 110.0, 90.0, 0.0, 0.0, 0.0, 80.0, 135.0, 885.0, 0.0, 0.0, 115.0, 120.0, 100.0, 50.0, 235.0, 80.0, 500.0, 65.0, 940.0, 45.0, 0.0, 0.0, 120.0, 135.0, 220.0, 0.0, 210.0, 295.0, 0.0, 55.0, 110.0, 25.0, 0.0, 60.0, 230.0, 30.0, 305.0, 45.0, 230.0, 600.0, 125.0, 140.0, 115.0, 0.0, 0.0, 0.0, 275.0, 260.0, 0.0, 0.0, 155.0, 20.0, 135.0, 140.0, 165.0, 55.0, 515.0, 40.0, 90.0, 145.0, 35.0, 180.0, 0.0, 0.0, 0.0, 250.0, 100.0, 35.0, 55.0, 0.0, 275.0, 165.0, 345.0, 510.0, 775.0, 415.0, 240.0, 0.0, 95.0, 175.0, 0.0, 0.0, 160.0, 55.0, 100.0, 95.0, 900.0, 875.0, 155.0, 75.0, 100.0, 90.0, 55.0, 55.0, 590.0, 5.0, 295.0, 35.0, 35.0, 335.0, 80.0, 0.0, 55.0, 80.0, 70.0, 120.0, 120.0, 60.0, 250.0, 15.0, 35.0, 5.0, 65.0, 45.0, 35.0, 135.0, 60.0, 270.0, 175.0, 560.0, 255.0, 5.0, 345.0, 15.0, 315.0, 50.0, 150.0, 50.0, 260.0, 260.0, 325.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9345067594891414, "mean_inference_ms": 1.5704089157212946, "mean_action_processing_ms": 0.3578369773629253, "mean_env_wait_ms": 0.24978830179718073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006579399108886719, "StateBufferConnector_ms": 0.0037807226181030273, "ViewRequirementAgentConnector_ms": 0.1271529197692871}, "num_episodes": 23, "episode_return_max": 626.0, "episode_return_min": -2194.0, "episode_return_mean": 152.87, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.553011620714585, "num_env_steps_trained_throughput_per_sec": 55.553011620714585, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 71493.727, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71493.66, "sample_time_ms": 1241.611, "learn_time_ms": 70233.873, "learn_throughput": 56.953, "synch_weights_time_ms": 13.329}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 96, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-24-43", "timestamp": 1723494283, "time_this_iter_s": 72.04659914970398, "time_total_s": 7686.112221002579, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32f69c940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7686.112221002579, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 27.437254901960785, "ram_util_percent": 82.36274509803923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.460105027733965, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1985209948204933, "policy_loss": -0.006340491089884007, "vf_loss": 2.2042308816250333, "vf_explained_var": -2.2033343078396845e-05, "kl": 0.008408030594273898, "entropy": 0.58207770978094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 272130.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.59791570143074, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2474706054790645, "policy_loss": -0.02311515029088812, "vf_loss": 2.269561934555676, "vf_explained_var": 0.019812732681314997, "kl": 0.010238212789613338, "entropy": 0.9706955746556005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 272130.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "env_runners": {"episode_reward_max": 626.0, "episode_reward_min": -2923.0, "episode_reward_mean": 117.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 940.0}, "policy_reward_mean": {"prey_policy": -97.95333333333333, "predator_policy": 136.98333333333332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [78.0, 252.0, 368.0, -759.0, 304.0, 424.0, 626.0, 467.0, -413.0, 313.0, 548.0, 504.0, 252.0, 430.0, 79.0, 354.0, 600.0, 312.0, 498.0, 468.0, 353.0, 1.0, 326.0, 544.0, 456.0, 396.0, 438.0, 17.0, 204.0, 401.0, 328.0, 161.0, 564.0, 500.0, -683.0, 391.0, 242.0, 451.0, 229.0, 600.0, -1105.0, 275.0, 188.0, -510.0, -825.0, 247.0, 295.0, -215.0, 482.0, 307.0, 188.0, -832.0, 228.0, -71.0, -185.0, 228.0, 520.0, -295.0, 421.0, 600.0, -27.0, 204.0, -591.0, -137.0, 188.0, 144.0, 388.0, -1540.0, 436.0, -240.0, 176.0, -226.0, 460.0, 382.0, 265.0, 485.0, 342.0, 115.0, -87.0, -518.0, 520.0, 323.0, -42.0, 600.0, 529.0, -424.0, 271.0, 331.0, 217.0, 606.0, 582.0, 194.0, -418.0, -2923.0, -1825.0, -162.0, 339.0, 597.0, 309.0, 301.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-449.0, 2.0, 90.0, -493.0, 145.0, 200.0, -196.0, 200.0, 24.0, -526.0, -471.0, -207.0, -20.0, -31.0, 200.0, 46.0, -20.0, 178.0, 200.0, 46.0, 200.0, 156.0, -53.0, 189.0, -196.0, -31.0, -746.0, 68.0, -328.0, 68.0, 200.0, 200.0, 68.0, 200.0, 200.0, 24.0, -438.0, 200.0, 200.0, -119.0, 134.0, 200.0, -31.0, 24.0, -229.0, -130.0, 79.0, 200.0, 200.0, 200.0, 200.0, 2.0, 46.0, 79.0, 200.0, 200.0, 13.0, 178.0, -20.0, 200.0, -31.0, 200.0, -31.0, -196.0, -229.0, 101.0, 145.0, -603.0, 79.0, 24.0, 200.0, 200.0, 90.0, 46.0, 200.0, 112.0, 200.0, -31.0, 200.0, -97.0, 200.0, 167.0, -372.0, -108.0, -42.0, 35.0, 101.0, 200.0, 2.0, -86.0, 145.0, -31.0, 24.0, 90.0, -251.0, -53.0, 200.0, -9.0, -647.0, 189.0, 101.0, 90.0, -768.0, -152.0, -658.0, 156.0, 101.0, -31.0, -141.0, -372.0, 200.0, 200.0, -119.0, 200.0, -53.0, 46.0, -9.0, 200.0, 200.0, 200.0, -482.0, -119.0, -1604.0, 200.0, 2.0, -42.0, 57.0, -174.0, 35.0, -548.0, -185.0, -592.0, 101.0, -1868.0, -108.0, 35.0, 57.0, 35.0, 101.0, 123.0, -284.0, -361.0, -251.0, -108.0, 123.0, 200.0, -31.0, -306.0, 123.0, 200.0, 145.0, -471.0, 134.0, 57.0, -933.0, -911.0, 24.0, 68.0, -119.0, -405.0, -141.0, 200.0, -350.0, -31.0, -64.0, 156.0, -141.0, -97.0, 200.0, 134.0, -174.0, 57.0, -966.0, -31.0, 145.0, 200.0, -284.0, 200.0, 200.0, 200.0, -251.0, 167.0, -328.0, 79.0, 200.0, -405.0, -768.0, -702.0, -141.0, -42.0, -1494.0, -31.0, -163.0, 200.0, -119.0, -108.0, -108.0, 200.0, -75.0, 145.0, 68.0, -1142.0, -1780.0, -548.0, 200.0, -75.0, 46.0, -207.0, 79.0, -812.0, 123.0, 167.0, -449.0, -163.0, 24.0, -537.0, 200.0, 24.0, 101.0, -108.0, 46.0, 134.0, 123.0, 167.0, -350.0, 13.0, 200.0, 167.0, -42.0, 167.0, 2.0, -240.0, 68.0, -218.0, 189.0, -1285.0, 189.0, 24.0, -680.0, -537.0, -130.0, 200.0, 200.0, 2.0, -537.0, 13.0, 2.0, -845.0, 101.0, 13.0, -493.0, 200.0, -86.0, 200.0, 200.0, -427.0, -284.0, -768.0, 134.0, 189.0, -262.0, 57.0, 200.0, -636.0, 2.0, -20.0, -75.0, 200.0, -284.0, 200.0, 189.0, 178.0, 200.0, 24.0, -229.0, 79.0, -1120.0, 178.0, -86.0, -1417.0, -1296.0, -1285.0, -1142.0, -1758.0, -405.0, -174.0, -108.0, -350.0, -9.0, -42.0, 200.0, 200.0, -53.0, 200.0, -306.0, 200.0, 35.0, -42.0, -53.0, 156.0], "policy_predator_policy_reward": [50.0, 295.0, 90.0, 0.0, 315.0, 85.0, 5.0, 175.0, 160.0, 0.0, 95.0, 350.0, 95.0, 60.0, 0.0, 65.0, 90.0, 65.0, 70.0, 40.0, 70.0, 60.0, 35.0, 80.0, 50.0, 75.0, 435.0, 195.0, 180.0, 130.0, 0.0, 45.0, 35.0, 0.0, 80.0, 0.0, 0.0, 0.0, 290.0, 15.0, 60.0, 140.0, 80.0, 130.0, 105.0, 55.0, 0.0, 150.0, 0.0, 0.0, 0.0, 90.0, 85.0, 10.0, 85.0, 0.0, 0.0, 100.0, 0.0, 10.0, 95.0, 35.0, 85.0, 180.0, 45.0, 100.0, 110.0, 350.0, 245.0, 80.0, 0.0, 40.0, 70.0, 0.0, 50.0, 30.0, 75.0, 10.0, 135.0, 0.0, 0.0, 230.0, 0.0, 100.0, 0.0, 110.0, 0.0, 130.0, 90.0, 65.0, 35.0, 105.0, 50.0, 30.0, 185.0, 160.0, 330.0, 350.0, 340.0, 5.0, 50.0, 65.0, 580.0, 225.0, 90.0, 40.0, 0.0, 125.0, 145.0, 150.0, 260.0, 115.0, 55.0, 0.0, 45.0, 110.0, 90.0, 0.0, 0.0, 0.0, 80.0, 135.0, 885.0, 0.0, 0.0, 115.0, 120.0, 100.0, 50.0, 235.0, 80.0, 500.0, 65.0, 940.0, 45.0, 0.0, 0.0, 120.0, 135.0, 220.0, 0.0, 210.0, 295.0, 0.0, 55.0, 110.0, 25.0, 0.0, 60.0, 230.0, 30.0, 305.0, 45.0, 230.0, 600.0, 125.0, 140.0, 115.0, 0.0, 0.0, 0.0, 275.0, 260.0, 0.0, 0.0, 155.0, 20.0, 135.0, 140.0, 165.0, 55.0, 515.0, 40.0, 90.0, 145.0, 35.0, 180.0, 0.0, 0.0, 0.0, 250.0, 100.0, 35.0, 55.0, 0.0, 275.0, 165.0, 345.0, 510.0, 775.0, 415.0, 240.0, 0.0, 95.0, 175.0, 0.0, 0.0, 160.0, 55.0, 100.0, 95.0, 900.0, 875.0, 155.0, 75.0, 100.0, 90.0, 55.0, 55.0, 590.0, 5.0, 295.0, 35.0, 35.0, 335.0, 80.0, 0.0, 55.0, 80.0, 70.0, 120.0, 120.0, 60.0, 250.0, 15.0, 35.0, 5.0, 65.0, 45.0, 35.0, 135.0, 60.0, 270.0, 175.0, 560.0, 255.0, 5.0, 345.0, 15.0, 315.0, 50.0, 150.0, 50.0, 260.0, 260.0, 325.0, 475.0, 130.0, 95.0, 305.0, 295.0, 280.0, 35.0, 85.0, 95.0, 390.0, 245.0, 420.0, 0.0, 210.0, 0.0, 240.0, 355.0, 115.0, 90.0, 100.0, 120.0, 220.0, 180.0, 90.0, 0.0, 0.0, 15.0, 25.0, 100.0, 195.0, 600.0, 0.0, 10.0, 475.0, 380.0, 220.0, 405.0, 360.0, 715.0, 160.0, 225.0, 85.0, 115.0, 75.0, 0.0, 95.0, 40.0, 115.0, 75.0, 230.0, 75.0, 175.0, 50.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9329816122298513, "mean_inference_ms": 1.5678412722661665, "mean_action_processing_ms": 0.35737136891540666, "mean_env_wait_ms": 0.24940980213174016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006747007369995117, "StateBufferConnector_ms": 0.00407254695892334, "ViewRequirementAgentConnector_ms": 0.12914276123046875}, "num_episodes": 18, "episode_return_max": 626.0, "episode_return_min": -2923.0, "episode_return_mean": 117.09, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.33498037297441, "num_env_steps_trained_throughput_per_sec": 55.33498037297441, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 2328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2328000, "timers": {"training_iteration_time_ms": 71574.527, "restore_workers_time_ms": 0.013, "training_step_time_ms": 71574.461, "sample_time_ms": 1239.749, "learn_time_ms": 70317.636, "learn_throughput": 56.885, "synch_weights_time_ms": 12.791}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 2328000, "num_agent_steps_trained": 2328000}, "done": false, "training_iteration": 97, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-25-55", "timestamp": 1723494355, "time_this_iter_s": 72.34311819076538, "time_total_s": 7758.455339193344, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2da73a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7758.455339193344, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 20.975490196078432, "ram_util_percent": 82.29215686274509}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7530395425063499, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8414503286282222, "policy_loss": -0.007752404346523793, "vf_loss": 1.8486571571294297, "vf_explained_var": -0.0003867923156589481, "kl": 0.007274345555991115, "entropy": 0.5892412248549732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 274950.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4531572331350744, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7432188504659538, "policy_loss": -0.023883101578920762, "vf_loss": 1.7661554011892766, "vf_explained_var": 0.017568095186923413, "kl": 0.009465506927408295, "entropy": 0.9741014587118271, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 274950.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": 606.0, "episode_reward_min": -2923.0, "episode_reward_mean": 79.27, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 940.0}, "policy_reward_mean": {"prey_policy": -124.06, "predator_policy": 150.48333333333332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [326.0, 544.0, 456.0, 396.0, 438.0, 17.0, 204.0, 401.0, 328.0, 161.0, 564.0, 500.0, -683.0, 391.0, 242.0, 451.0, 229.0, 600.0, -1105.0, 275.0, 188.0, -510.0, -825.0, 247.0, 295.0, -215.0, 482.0, 307.0, 188.0, -832.0, 228.0, -71.0, -185.0, 228.0, 520.0, -295.0, 421.0, 600.0, -27.0, 204.0, -591.0, -137.0, 188.0, 144.0, 388.0, -1540.0, 436.0, -240.0, 176.0, -226.0, 460.0, 382.0, 265.0, 485.0, 342.0, 115.0, -87.0, -518.0, 520.0, 323.0, -42.0, 600.0, 529.0, -424.0, 271.0, 331.0, 217.0, 606.0, 582.0, 194.0, -418.0, -2923.0, -1825.0, -162.0, 339.0, 597.0, 309.0, 301.0, -225.0, 421.0, 591.0, 311.0, 594.0, -462.0, 210.0, 367.0, 291.0, -145.0, 240.0, 211.0, 540.0, -40.0, -314.0, 4.0, 486.0, -1388.0, 309.0, -55.0, 228.0, 103.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [145.0, -603.0, 79.0, 24.0, 200.0, 200.0, 90.0, 46.0, 200.0, 112.0, 200.0, -31.0, 200.0, -97.0, 200.0, 167.0, -372.0, -108.0, -42.0, 35.0, 101.0, 200.0, 2.0, -86.0, 145.0, -31.0, 24.0, 90.0, -251.0, -53.0, 200.0, -9.0, -647.0, 189.0, 101.0, 90.0, -768.0, -152.0, -658.0, 156.0, 101.0, -31.0, -141.0, -372.0, 200.0, 200.0, -119.0, 200.0, -53.0, 46.0, -9.0, 200.0, 200.0, 200.0, -482.0, -119.0, -1604.0, 200.0, 2.0, -42.0, 57.0, -174.0, 35.0, -548.0, -185.0, -592.0, 101.0, -1868.0, -108.0, 35.0, 57.0, 35.0, 101.0, 123.0, -284.0, -361.0, -251.0, -108.0, 123.0, 200.0, -31.0, -306.0, 123.0, 200.0, 145.0, -471.0, 134.0, 57.0, -933.0, -911.0, 24.0, 68.0, -119.0, -405.0, -141.0, 200.0, -350.0, -31.0, -64.0, 156.0, -141.0, -97.0, 200.0, 134.0, -174.0, 57.0, -966.0, -31.0, 145.0, 200.0, -284.0, 200.0, 200.0, 200.0, -251.0, 167.0, -328.0, 79.0, 200.0, -405.0, -768.0, -702.0, -141.0, -42.0, -1494.0, -31.0, -163.0, 200.0, -119.0, -108.0, -108.0, 200.0, -75.0, 145.0, 68.0, -1142.0, -1780.0, -548.0, 200.0, -75.0, 46.0, -207.0, 79.0, -812.0, 123.0, 167.0, -449.0, -163.0, 24.0, -537.0, 200.0, 24.0, 101.0, -108.0, 46.0, 134.0, 123.0, 167.0, -350.0, 13.0, 200.0, 167.0, -42.0, 167.0, 2.0, -240.0, 68.0, -218.0, 189.0, -1285.0, 189.0, 24.0, -680.0, -537.0, -130.0, 200.0, 200.0, 2.0, -537.0, 13.0, 2.0, -845.0, 101.0, 13.0, -493.0, 200.0, -86.0, 200.0, 200.0, -427.0, -284.0, -768.0, 134.0, 189.0, -262.0, 57.0, 200.0, -636.0, 2.0, -20.0, -75.0, 200.0, -284.0, 200.0, 189.0, 178.0, 200.0, 24.0, -229.0, 79.0, -1120.0, 178.0, -86.0, -1417.0, -1296.0, -1285.0, -1142.0, -1758.0, -405.0, -174.0, -108.0, -350.0, -9.0, -42.0, 200.0, 200.0, -53.0, 200.0, -306.0, 200.0, 35.0, -42.0, -53.0, 156.0, -361.0, -559.0, 200.0, -790.0, 200.0, 46.0, 101.0, 200.0, -625.0, 134.0, -42.0, 24.0, 200.0, 189.0, 200.0, -262.0, -317.0, -603.0, -350.0, 35.0, 200.0, 35.0, 57.0, 200.0, 200.0, 46.0, -240.0, -449.0, -141.0, -75.0, 123.0, 46.0, -284.0, -75.0, -64.0, 90.0, 200.0, -185.0, 200.0, 112.0, -691.0, 79.0, -405.0, -86.0, -328.0, -108.0, -361.0, -262.0, -284.0, 200.0, 200.0, -592.0, -658.0, -658.0, -141.0, 156.0, 134.0, -504.0, -229.0, 68.0, 24.0, 167.0, -163.0, 24.0, -174.0, -317.0], "policy_predator_policy_reward": [110.0, 350.0, 245.0, 80.0, 0.0, 40.0, 70.0, 0.0, 50.0, 30.0, 75.0, 10.0, 135.0, 0.0, 0.0, 230.0, 0.0, 100.0, 0.0, 110.0, 0.0, 130.0, 90.0, 65.0, 35.0, 105.0, 50.0, 30.0, 185.0, 160.0, 330.0, 350.0, 340.0, 5.0, 50.0, 65.0, 580.0, 225.0, 90.0, 40.0, 0.0, 125.0, 145.0, 150.0, 260.0, 115.0, 55.0, 0.0, 45.0, 110.0, 90.0, 0.0, 0.0, 0.0, 80.0, 135.0, 885.0, 0.0, 0.0, 115.0, 120.0, 100.0, 50.0, 235.0, 80.0, 500.0, 65.0, 940.0, 45.0, 0.0, 0.0, 120.0, 135.0, 220.0, 0.0, 210.0, 295.0, 0.0, 55.0, 110.0, 25.0, 0.0, 60.0, 230.0, 30.0, 305.0, 45.0, 230.0, 600.0, 125.0, 140.0, 115.0, 0.0, 0.0, 0.0, 275.0, 260.0, 0.0, 0.0, 155.0, 20.0, 135.0, 140.0, 165.0, 55.0, 515.0, 40.0, 90.0, 145.0, 35.0, 180.0, 0.0, 0.0, 0.0, 250.0, 100.0, 35.0, 55.0, 0.0, 275.0, 165.0, 345.0, 510.0, 775.0, 415.0, 240.0, 0.0, 95.0, 175.0, 0.0, 0.0, 160.0, 55.0, 100.0, 95.0, 900.0, 875.0, 155.0, 75.0, 100.0, 90.0, 55.0, 55.0, 590.0, 5.0, 295.0, 35.0, 35.0, 335.0, 80.0, 0.0, 55.0, 80.0, 70.0, 120.0, 120.0, 60.0, 250.0, 15.0, 35.0, 5.0, 65.0, 45.0, 35.0, 135.0, 60.0, 270.0, 175.0, 560.0, 255.0, 5.0, 345.0, 15.0, 315.0, 50.0, 150.0, 50.0, 260.0, 260.0, 325.0, 475.0, 130.0, 95.0, 305.0, 295.0, 280.0, 35.0, 85.0, 95.0, 390.0, 245.0, 420.0, 0.0, 210.0, 0.0, 240.0, 355.0, 115.0, 90.0, 100.0, 120.0, 220.0, 180.0, 90.0, 0.0, 0.0, 15.0, 25.0, 100.0, 195.0, 600.0, 0.0, 10.0, 475.0, 380.0, 220.0, 405.0, 360.0, 715.0, 160.0, 225.0, 85.0, 115.0, 75.0, 0.0, 95.0, 40.0, 115.0, 75.0, 230.0, 75.0, 175.0, 50.0, 15.0, 155.0, 200.0, 140.0, 335.0, 450.0, 180.0, 215.0, 375.0, 325.0, 75.0, 40.0, 80.0, 0.0, 0.0, 5.0, 0.0, 370.0, 350.0, 250.0, 0.0, 75.0, 0.0, 75.0, 0.0, 55.0, 50.0, 180.0, 230.0, 0.0, 290.0, 70.0, 65.0, 220.0, 80.0, 180.0, 0.0, 155.0, 100.0, 70.0, 250.0, 55.0, 155.0, 105.0, 350.0, 50.0, 255.0, 230.0, 250.0, 210.0, 160.0, 0.0, 0.0, 390.0, 130.0, 0.0, 0.0, 160.0, 20.0, 320.0, 270.0, 10.0, 165.0, 25.0, 145.0, 130.0, 295.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9314774487764378, "mean_inference_ms": 1.5646929007287855, "mean_action_processing_ms": 0.35692237576023755, "mean_env_wait_ms": 0.24886377985128136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005662202835083008, "StateBufferConnector_ms": 0.004038810729980469, "ViewRequirementAgentConnector_ms": 0.12826323509216309}, "num_episodes": 22, "episode_return_max": 606.0, "episode_return_min": -2923.0, "episode_return_mean": 79.27, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.65368679532022, "num_env_steps_trained_throughput_per_sec": 55.65368679532022, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 71665.863, "restore_workers_time_ms": 0.013, "training_step_time_ms": 71665.788, "sample_time_ms": 1247.415, "learn_time_ms": 70400.612, "learn_throughput": 56.818, "synch_weights_time_ms": 13.146}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 98, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-27-07", "timestamp": 1723494427, "time_this_iter_s": 71.91283011436462, "time_total_s": 7830.368169307709, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e34e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7830.368169307709, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 19.23039215686274, "ram_util_percent": 81.92450980392157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6946442529136407, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.236661982071315, "policy_loss": -0.0067085060155032475, "vf_loss": 2.242845544747427, "vf_explained_var": -5.4102375152263236e-05, "kl": 0.0069992783373841036, "entropy": 0.5586319172424627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 277770.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4313267047946336, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.523765992589876, "policy_loss": -0.02506108638097314, "vf_loss": 1.5476905737996947, "vf_explained_var": 0.02673036456108093, "kl": 0.011365056629593558, "entropy": 0.9220991401807637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 277770.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "env_runners": {"episode_reward_max": 606.0, "episode_reward_min": -2923.0, "episode_reward_mean": 82.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1901.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -139.09333333333333, "predator_policy": 166.71666666666667}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1105.0, 275.0, 188.0, -510.0, -825.0, 247.0, 295.0, -215.0, 482.0, 307.0, 188.0, -832.0, 228.0, -71.0, -185.0, 228.0, 520.0, -295.0, 421.0, 600.0, -27.0, 204.0, -591.0, -137.0, 188.0, 144.0, 388.0, -1540.0, 436.0, -240.0, 176.0, -226.0, 460.0, 382.0, 265.0, 485.0, 342.0, 115.0, -87.0, -518.0, 520.0, 323.0, -42.0, 600.0, 529.0, -424.0, 271.0, 331.0, 217.0, 606.0, 582.0, 194.0, -418.0, -2923.0, -1825.0, -162.0, 339.0, 597.0, 309.0, 301.0, -225.0, 421.0, 591.0, 311.0, 594.0, -462.0, 210.0, 367.0, 291.0, -145.0, 240.0, 211.0, 540.0, -40.0, -314.0, 4.0, 486.0, -1388.0, 309.0, -55.0, 228.0, 103.0, 357.0, 407.0, 38.0, 367.0, 275.0, 432.0, 480.0, 563.0, 529.0, 369.0, 326.0, 140.0, 414.0, 474.0, -71.0, 150.0, 171.0, 504.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-482.0, -119.0, -1604.0, 200.0, 2.0, -42.0, 57.0, -174.0, 35.0, -548.0, -185.0, -592.0, 101.0, -1868.0, -108.0, 35.0, 57.0, 35.0, 101.0, 123.0, -284.0, -361.0, -251.0, -108.0, 123.0, 200.0, -31.0, -306.0, 123.0, 200.0, 145.0, -471.0, 134.0, 57.0, -933.0, -911.0, 24.0, 68.0, -119.0, -405.0, -141.0, 200.0, -350.0, -31.0, -64.0, 156.0, -141.0, -97.0, 200.0, 134.0, -174.0, 57.0, -966.0, -31.0, 145.0, 200.0, -284.0, 200.0, 200.0, 200.0, -251.0, 167.0, -328.0, 79.0, 200.0, -405.0, -768.0, -702.0, -141.0, -42.0, -1494.0, -31.0, -163.0, 200.0, -119.0, -108.0, -108.0, 200.0, -75.0, 145.0, 68.0, -1142.0, -1780.0, -548.0, 200.0, -75.0, 46.0, -207.0, 79.0, -812.0, 123.0, 167.0, -449.0, -163.0, 24.0, -537.0, 200.0, 24.0, 101.0, -108.0, 46.0, 134.0, 123.0, 167.0, -350.0, 13.0, 200.0, 167.0, -42.0, 167.0, 2.0, -240.0, 68.0, -218.0, 189.0, -1285.0, 189.0, 24.0, -680.0, -537.0, -130.0, 200.0, 200.0, 2.0, -537.0, 13.0, 2.0, -845.0, 101.0, 13.0, -493.0, 200.0, -86.0, 200.0, 200.0, -427.0, -284.0, -768.0, 134.0, 189.0, -262.0, 57.0, 200.0, -636.0, 2.0, -20.0, -75.0, 200.0, -284.0, 200.0, 189.0, 178.0, 200.0, 24.0, -229.0, 79.0, -1120.0, 178.0, -86.0, -1417.0, -1296.0, -1285.0, -1142.0, -1758.0, -405.0, -174.0, -108.0, -350.0, -9.0, -42.0, 200.0, 200.0, -53.0, 200.0, -306.0, 200.0, 35.0, -42.0, -53.0, 156.0, -361.0, -559.0, 200.0, -790.0, 200.0, 46.0, 101.0, 200.0, -625.0, 134.0, -42.0, 24.0, 200.0, 189.0, 200.0, -262.0, -317.0, -603.0, -350.0, 35.0, 200.0, 35.0, 57.0, 200.0, 200.0, 46.0, -240.0, -449.0, -141.0, -75.0, 123.0, 46.0, -284.0, -75.0, -64.0, 90.0, 200.0, -185.0, 200.0, 112.0, -691.0, 79.0, -405.0, -86.0, -328.0, -108.0, -361.0, -262.0, -284.0, 200.0, 200.0, -592.0, -658.0, -658.0, -141.0, 156.0, 134.0, -504.0, -229.0, 68.0, 24.0, 167.0, -163.0, 24.0, -174.0, -317.0, -152.0, -130.0, 189.0, 200.0, 200.0, -163.0, 2.0, 200.0, -669.0, 156.0, 200.0, -1549.0, -9.0, 46.0, 68.0, 13.0, -361.0, 200.0, 200.0, 167.0, 13.0, -1901.0, -196.0, 200.0, 156.0, -97.0, 200.0, 200.0, -9.0, 68.0, -119.0, -174.0, 189.0, 200.0, -372.0, -108.0, 200.0, -141.0, 200.0, 200.0, -31.0, 200.0, 13.0, -119.0, -515.0, 200.0, -273.0, -152.0, -196.0, -42.0, 24.0, 200.0, 24.0, -1450.0], "policy_predator_policy_reward": [80.0, 135.0, 885.0, 0.0, 0.0, 115.0, 120.0, 100.0, 50.0, 235.0, 80.0, 500.0, 65.0, 940.0, 45.0, 0.0, 0.0, 120.0, 135.0, 220.0, 0.0, 210.0, 295.0, 0.0, 55.0, 110.0, 25.0, 0.0, 60.0, 230.0, 30.0, 305.0, 45.0, 230.0, 600.0, 125.0, 140.0, 115.0, 0.0, 0.0, 0.0, 275.0, 260.0, 0.0, 0.0, 155.0, 20.0, 135.0, 140.0, 165.0, 55.0, 515.0, 40.0, 90.0, 145.0, 35.0, 180.0, 0.0, 0.0, 0.0, 250.0, 100.0, 35.0, 55.0, 0.0, 275.0, 165.0, 345.0, 510.0, 775.0, 415.0, 240.0, 0.0, 95.0, 175.0, 0.0, 0.0, 160.0, 55.0, 100.0, 95.0, 900.0, 875.0, 155.0, 75.0, 100.0, 90.0, 55.0, 55.0, 590.0, 5.0, 295.0, 35.0, 35.0, 335.0, 80.0, 0.0, 55.0, 80.0, 70.0, 120.0, 120.0, 60.0, 250.0, 15.0, 35.0, 5.0, 65.0, 45.0, 35.0, 135.0, 60.0, 270.0, 175.0, 560.0, 255.0, 5.0, 345.0, 15.0, 315.0, 50.0, 150.0, 50.0, 260.0, 260.0, 325.0, 475.0, 130.0, 95.0, 305.0, 295.0, 280.0, 35.0, 85.0, 95.0, 390.0, 245.0, 420.0, 0.0, 210.0, 0.0, 240.0, 355.0, 115.0, 90.0, 100.0, 120.0, 220.0, 180.0, 90.0, 0.0, 0.0, 15.0, 25.0, 100.0, 195.0, 600.0, 0.0, 10.0, 475.0, 380.0, 220.0, 405.0, 360.0, 715.0, 160.0, 225.0, 85.0, 115.0, 75.0, 0.0, 95.0, 40.0, 115.0, 75.0, 230.0, 75.0, 175.0, 50.0, 15.0, 155.0, 200.0, 140.0, 335.0, 450.0, 180.0, 215.0, 375.0, 325.0, 75.0, 40.0, 80.0, 0.0, 0.0, 5.0, 0.0, 370.0, 350.0, 250.0, 0.0, 75.0, 0.0, 75.0, 0.0, 55.0, 50.0, 180.0, 230.0, 0.0, 290.0, 70.0, 65.0, 220.0, 80.0, 180.0, 0.0, 155.0, 100.0, 70.0, 250.0, 55.0, 155.0, 105.0, 350.0, 50.0, 255.0, 230.0, 250.0, 210.0, 160.0, 0.0, 0.0, 390.0, 130.0, 0.0, 0.0, 160.0, 20.0, 320.0, 270.0, 10.0, 165.0, 25.0, 145.0, 130.0, 295.0, 150.0, 140.0, 160.0, 165.0, 0.0, 5.0, 175.0, 330.0, 0.0, 80.0, 695.0, 785.0, 60.0, 0.0, 110.0, 255.0, 80.0, 245.0, 0.0, 85.0, 15.0, 815.0, 690.0, 955.0, 85.0, 90.0, 95.0, 0.0, 0.0, 110.0, 140.0, 155.0, 135.0, 120.0, 80.0, 220.0, 155.0, 0.0, 0.0, 0.0, 0.0, 105.0, 100.0, 180.0, 270.0, 215.0, 160.0, 0.0, 70.0, 180.0, 135.0, 315.0, 705.0, 710.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9299082433758699, "mean_inference_ms": 1.5627741219819102, "mean_action_processing_ms": 0.35639103872614625, "mean_env_wait_ms": 0.2486164587853428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005040168762207031, "StateBufferConnector_ms": 0.0040416717529296875, "ViewRequirementAgentConnector_ms": 0.1306518316268921}, "num_episodes": 18, "episode_return_max": 606.0, "episode_return_min": -2923.0, "episode_return_mean": 82.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 56.183573311437705, "num_env_steps_trained_throughput_per_sec": 56.183573311437705, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 2376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2376000, "timers": {"training_iteration_time_ms": 71701.84, "restore_workers_time_ms": 0.013, "training_step_time_ms": 71701.765, "sample_time_ms": 1251.979, "learn_time_ms": 70432.017, "learn_throughput": 56.792, "synch_weights_time_ms": 13.184}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 2376000, "num_agent_steps_trained": 2376000}, "done": false, "training_iteration": 99, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-28-18", "timestamp": 1723494498, "time_this_iter_s": 71.22207379341125, "time_total_s": 7901.59024310112, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2da7280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7901.59024310112, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 18.26930693069307, "ram_util_percent": 82.0920792079208}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7770986076259443, "cur_kl_coeff": 0.075, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8689541131469374, "policy_loss": -0.007244629987535324, "vf_loss": 1.8756959645460682, "vf_explained_var": -0.00017534120285764653, "kl": 0.0067036949723170485, "entropy": 0.5653126155548062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 280590.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7980460047404816, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4849730699726031, "policy_loss": -0.025994511533294084, "vf_loss": 1.509920843653645, "vf_explained_var": 0.015633688243568367, "kl": 0.010467345682009997, "entropy": 0.9013071561113317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.65957446808511, "num_grad_updates_lifetime": 280590.5, "diff_num_grad_updates_vs_sampler_policy": 1409.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 619.0, "episode_reward_min": -2923.0, "episode_reward_mean": 129.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1956.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 980.0}, "policy_reward_mean": {"prey_policy": -123.58333333333333, "predator_policy": 166.66666666666666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-137.0, 188.0, 144.0, 388.0, -1540.0, 436.0, -240.0, 176.0, -226.0, 460.0, 382.0, 265.0, 485.0, 342.0, 115.0, -87.0, -518.0, 520.0, 323.0, -42.0, 600.0, 529.0, -424.0, 271.0, 331.0, 217.0, 606.0, 582.0, 194.0, -418.0, -2923.0, -1825.0, -162.0, 339.0, 597.0, 309.0, 301.0, -225.0, 421.0, 591.0, 311.0, 594.0, -462.0, 210.0, 367.0, 291.0, -145.0, 240.0, 211.0, 540.0, -40.0, -314.0, 4.0, 486.0, -1388.0, 309.0, -55.0, 228.0, 103.0, 357.0, 407.0, 38.0, 367.0, 275.0, 432.0, 480.0, 563.0, 529.0, 369.0, 326.0, 140.0, 414.0, 474.0, -71.0, 150.0, 171.0, 504.0, -189.0, 474.0, -55.0, 474.0, -348.0, -84.0, 600.0, 447.0, -46.0, 619.0, -1136.0, 538.0, 424.0, 259.0, 600.0, 600.0, -917.0, 498.0, 562.0, 173.0, 288.0, 18.0, 366.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-42.0, -1494.0, -31.0, -163.0, 200.0, -119.0, -108.0, -108.0, 200.0, -75.0, 145.0, 68.0, -1142.0, -1780.0, -548.0, 200.0, -75.0, 46.0, -207.0, 79.0, -812.0, 123.0, 167.0, -449.0, -163.0, 24.0, -537.0, 200.0, 24.0, 101.0, -108.0, 46.0, 134.0, 123.0, 167.0, -350.0, 13.0, 200.0, 167.0, -42.0, 167.0, 2.0, -240.0, 68.0, -218.0, 189.0, -1285.0, 189.0, 24.0, -680.0, -537.0, -130.0, 200.0, 200.0, 2.0, -537.0, 13.0, 2.0, -845.0, 101.0, 13.0, -493.0, 200.0, -86.0, 200.0, 200.0, -427.0, -284.0, -768.0, 134.0, 189.0, -262.0, 57.0, 200.0, -636.0, 2.0, -20.0, -75.0, 200.0, -284.0, 200.0, 189.0, 178.0, 200.0, 24.0, -229.0, 79.0, -1120.0, 178.0, -86.0, -1417.0, -1296.0, -1285.0, -1142.0, -1758.0, -405.0, -174.0, -108.0, -350.0, -9.0, -42.0, 200.0, 200.0, -53.0, 200.0, -306.0, 200.0, 35.0, -42.0, -53.0, 156.0, -361.0, -559.0, 200.0, -790.0, 200.0, 46.0, 101.0, 200.0, -625.0, 134.0, -42.0, 24.0, 200.0, 189.0, 200.0, -262.0, -317.0, -603.0, -350.0, 35.0, 200.0, 35.0, 57.0, 200.0, 200.0, 46.0, -240.0, -449.0, -141.0, -75.0, 123.0, 46.0, -284.0, -75.0, -64.0, 90.0, 200.0, -185.0, 200.0, 112.0, -691.0, 79.0, -405.0, -86.0, -328.0, -108.0, -361.0, -262.0, -284.0, 200.0, 200.0, -592.0, -658.0, -658.0, -141.0, 156.0, 134.0, -504.0, -229.0, 68.0, 24.0, 167.0, -163.0, 24.0, -174.0, -317.0, -152.0, -130.0, 189.0, 200.0, 200.0, -163.0, 2.0, 200.0, -669.0, 156.0, 200.0, -1549.0, -9.0, 46.0, 68.0, 13.0, -361.0, 200.0, 200.0, 167.0, 13.0, -1901.0, -196.0, 200.0, 156.0, -97.0, 200.0, 200.0, -9.0, 68.0, -119.0, -174.0, 189.0, 200.0, -372.0, -108.0, 200.0, -141.0, 200.0, 200.0, -31.0, 200.0, 13.0, -119.0, -515.0, 200.0, -273.0, -152.0, -196.0, -42.0, 24.0, 200.0, 24.0, -1450.0, -724.0, 178.0, -108.0, 200.0, 57.0, 112.0, -724.0, -284.0, 178.0, 200.0, 2.0, 57.0, -31.0, 200.0, -1307.0, -163.0, -581.0, 90.0, 200.0, 200.0, 200.0, -603.0, 35.0, 200.0, -64.0, -174.0, 2.0, 200.0, -1956.0, 200.0, -581.0, -416.0, -559.0, -20.0, 178.0, 200.0, 200.0, 112.0, -53.0, -295.0, 200.0, -86.0, 189.0, 189.0, 2.0, 200.0, 200.0, 200.0, -405.0, -1252.0, -185.0, 134.0, 200.0, 134.0, 57.0, 200.0, 200.0, -130.0, 79.0, -141.0, -9.0, 200.0, -658.0, -438.0, 112.0, -86.0, 68.0, -97.0, 200.0], "policy_predator_policy_reward": [775.0, 415.0, 240.0, 0.0, 95.0, 175.0, 0.0, 0.0, 160.0, 55.0, 100.0, 95.0, 900.0, 875.0, 155.0, 75.0, 100.0, 90.0, 55.0, 55.0, 590.0, 5.0, 295.0, 35.0, 35.0, 335.0, 80.0, 0.0, 55.0, 80.0, 70.0, 120.0, 120.0, 60.0, 250.0, 15.0, 35.0, 5.0, 65.0, 45.0, 35.0, 135.0, 60.0, 270.0, 175.0, 560.0, 255.0, 5.0, 345.0, 15.0, 315.0, 50.0, 150.0, 50.0, 260.0, 260.0, 325.0, 475.0, 130.0, 95.0, 305.0, 295.0, 280.0, 35.0, 85.0, 95.0, 390.0, 245.0, 420.0, 0.0, 210.0, 0.0, 240.0, 355.0, 115.0, 90.0, 100.0, 120.0, 220.0, 180.0, 90.0, 0.0, 0.0, 15.0, 25.0, 100.0, 195.0, 600.0, 0.0, 10.0, 475.0, 380.0, 220.0, 405.0, 360.0, 715.0, 160.0, 225.0, 85.0, 115.0, 75.0, 0.0, 95.0, 40.0, 115.0, 75.0, 230.0, 75.0, 175.0, 50.0, 15.0, 155.0, 200.0, 140.0, 335.0, 450.0, 180.0, 215.0, 375.0, 325.0, 75.0, 40.0, 80.0, 0.0, 0.0, 5.0, 0.0, 370.0, 350.0, 250.0, 0.0, 75.0, 0.0, 75.0, 0.0, 55.0, 50.0, 180.0, 230.0, 0.0, 290.0, 70.0, 65.0, 220.0, 80.0, 180.0, 0.0, 155.0, 100.0, 70.0, 250.0, 55.0, 155.0, 105.0, 350.0, 50.0, 255.0, 230.0, 250.0, 210.0, 160.0, 0.0, 0.0, 390.0, 130.0, 0.0, 0.0, 160.0, 20.0, 320.0, 270.0, 10.0, 165.0, 25.0, 145.0, 130.0, 295.0, 150.0, 140.0, 160.0, 165.0, 0.0, 5.0, 175.0, 330.0, 0.0, 80.0, 695.0, 785.0, 60.0, 0.0, 110.0, 255.0, 80.0, 245.0, 0.0, 85.0, 15.0, 815.0, 690.0, 955.0, 85.0, 90.0, 95.0, 0.0, 0.0, 110.0, 140.0, 155.0, 135.0, 120.0, 80.0, 220.0, 155.0, 0.0, 0.0, 0.0, 0.0, 105.0, 100.0, 180.0, 270.0, 215.0, 160.0, 0.0, 70.0, 180.0, 135.0, 315.0, 705.0, 710.0, 25.0, 20.0, 420.0, 0.0, 40.0, 65.0, 0.0, 365.0, 410.0, 65.0, 65.0, 85.0, 0.0, 685.0, 105.0, 90.0, 125.0, 355.0, 0.0, 0.0, 0.0, 175.0, 275.0, 365.0, 190.0, 0.0, 0.0, 450.0, 980.0, 745.0, 355.0, 10.0, 55.0, 0.0, 100.0, 80.0, 0.0, 50.0, 115.0, 95.0, 120.0, 225.0, 90.0, 40.0, 90.0, 0.0, 0.0, 0.0, 140.0, 590.0, 195.0, 30.0, 0.0, 0.0, 45.0, 60.0, 0.0, 150.0, 60.0, 155.0, 15.0, 350.0, 390.0, 290.0, 0.0, 140.0, 60.0, 0.0, 135.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9286215110823153, "mean_inference_ms": 1.5604571752836949, "mean_action_processing_ms": 0.355841565701739, "mean_env_wait_ms": 0.2481728869659896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004615426063537598, "StateBufferConnector_ms": 0.004039168357849121, "ViewRequirementAgentConnector_ms": 0.1297842264175415}, "num_episodes": 23, "episode_return_max": 619.0, "episode_return_min": -2923.0, "episode_return_mean": 129.25, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 55.899073900509656, "num_env_steps_trained_throughput_per_sec": 55.899073900509656, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 71679.247, "restore_workers_time_ms": 0.014, "training_step_time_ms": 71679.187, "sample_time_ms": 1256.264, "learn_time_ms": 70405.466, "learn_throughput": 56.814, "synch_weights_time_ms": 13.157}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": true, "training_iteration": 100, "trial_id": "f7bd5_00000", "date": "2024-08-12_16-29-30", "timestamp": 1723494570, "time_this_iter_s": 71.59395098686218, "time_total_s": 7973.184194087982, "pid": 52477, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 3, "num_predators": 3, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b21bb040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7973.184194087982, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 19.195049504950497, "ram_util_percent": 82.21980198019801}}
